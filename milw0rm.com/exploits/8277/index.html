<html><head><title>Free Arcade Script 1.0 Auth Bypass (SQL) / Upload Shell Vulnerabilities</title></head><pre>.--------------------------------------------------------------------------.
| Web Application : Free Arcade Script 1.0                                 |
| Homepage        : http://www.freearcadescript.net                        |
|--------------------------------------------------------------------------|
| Vulnerability   : SQL Injection + Remote PHP file upload                 |
| Author          : Mr.Skonnie                                             |
| Contact         : mr.skonnie@gmail.com                                   |
|__________________________________________________________________________|

Stage I - Login as administrator to the CMS:
--------------------------------------------
login.php authentication code :

if(isset($_POST['submit'])){
	$username = clean($_POST['username']);
	$password = md5($_POST['password']);
	
	$r = $db-&gt;query(sprintf('SELECT userid FROM dd_users WHERE username=\'%s\' AND password=\'%s\'', $username, $password));
	if(!$db-&gt;num_rows($r)){
		echo '&lt;div class=\'error\'&gt;User account does not exist.&lt;/div&gt;';
		include ('templates/'.$template.'/footer.php');
		exit;
	}else{
		$ir = $db-&gt;fetch_row($r);
		$_SESSION['username'] = $username;
		$_SESSION['userid']= $ir['userid'];
		echo '&lt;div class=\'msg\'&gt;You\'ve now logged on.&lt;/div&gt;';
		
The user name is not checked before being used in the sql query so we can inject ' or 1 or username=' as the user name and get in as admin.


Stage II - Uploading a php shell to the server:
-----------------------------------------------
Once logged in as admin, the Admin panel is enabled.
Add a new self hosted game and when asked for &quot;Thumb File&quot; and &quot;SWF Game File&quot;, choose your php shell file (or any other file you want to upload to the server).
The file you uploaded is now saved in the &quot;games directory&quot; and &quot;thumbs directory&quot;.
To find out where they are located, choose &quot;Site Settings&quot; from the Admin panel.

# milw0rm.com [2009-03-23]</pre></html>