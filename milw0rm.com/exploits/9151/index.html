<html><head><title>ILIAS LMS <= 3.9.9/3.10.7 Arbitrary Edition/Info Disclosure Vulns</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                           ME VOY A LA PLAYA!...QUE CALOoOoOoR!...Lo0oL                    **
**					Ä„PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	       MULTIPLE ARBITRARY INFORMATION DISCLOSURE AND EDITION       	     |
|--------------------------------------------------------------------------------------------|
|                              |    ILIAS LMS &lt;= 3.10.7/3.9.9      |                         |
|  CMS INFORMATION:	        -----------------------------------	                     |
|										             |
|--&gt;WEB: http://www.ilias.de/				          	                     |
|--&gt;DOWNLOAD: http://www.ilias.de/docu/goto.php?target=st_229_35&amp;client_id=docu		     |
|--&gt;DEMO: http://www.demo.ilias-support.com/  	     			                     |
|--&gt;CATEGORY: LMS/Education								     |
|--&gt;DESCRIPTION: ILIAS is a powerful web-based learning management system that allows you    |
|		to easily manage learning resources in an integrated system. 	     	     |
|--&gt;RELEASED: 2009-06-22								     |
|											     |
|  CMS VULNERABILITY:                                    	                             |
|											     |
|--&gt;TESTED ON: firefox 3								     |
|--&gt;DORK: &quot;powered by ILIAS&quot;	         				                     |
|--&gt;CATEGORY: ARBITRARY INFORMATION EDITION/DISCLOSURE		                             |
|--&gt;AFFECT VERSION: 3.10.7/3.9.9        		 			             |
|--&gt;Discovered Bug date: 2009-06-28							     |
|--&gt;Reported Bug date: 2009-06-28							     |
|--&gt;Fixed bug date: 2009-06-30								     |
|--&gt;Info patch (3.10.8/3.9.10): http://www.ilias.de/docu/goto.php?target=st_229_35           |
| &amp;client_id=docu                                                                            |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: YEnH4ckEr &lt;--&lt;3--&gt; Marijose.                                                    |
| I'm going to rest for some time...J. Enrique y Pedro...wtf!?...algo sobre ILIAS!! ^_^      |
----------------------------------------------------------------------------------------------



&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: registered user +++++++++++++++++---------&gt;&gt;&gt;&gt;



I used my own account in my university...sorry for testing :P



#################################
/////////////////////////////////

ARBITRARY INFORMATION DISCLOSURE

/////////////////////////////////
#################################



-------------------
-------------------

&quot;POST-ITS&quot; ISSUE:

-------------------
-------------------



When a user, teacher, admin, alumn, post a new post-its,
he could read all post-its in database.

The vuln link would be:

http://[HOST]/[PATH]/ilias.php?col_side=right&amp;block_type=pdnotes&amp;rel_obj=0&amp;note_id=1&amp;note_type=1&amp;cmd=showNote&amp;cmdClass=ilpdnotesblockgui&amp;cmdNode=50&amp;baseClass=ilPersonalDesktopGUI


Changing note_id=1 for other value, for ex. 100, we could
read this posts-it.

That seems a low risk vuln but, when i tested on-line, ie,
against my university and i've got a lot of sensitive information.



-------------------
-------------------

&quot;CMD&quot; ISSUE:

-------------------
-------------------



Course/group/... calendars:

This would be a normal link:


http://[HOST]/[PATH]/repository.php?cmd=frameset&amp;ref_id=50438


But if I change cmd=frameset for cmd=edit:


http://[HOST]/[PATH]/repository.php?ref_id=50438&amp;cmd=edit


I access to information about this group/course/..., and I tried to
change it, but i got permission denied...anyway, i
can get how it's configured this group/course/...



-------------------
-------------------

&quot;CALENDAR&quot; ISSUE:

-------------------
-------------------



http://[HOST]/[PATH]/ilias.php?seed=2009-06-28&amp;category_id=847&amp;calendar_mode=2&amp;cmd=edit&amp;cmdClass=ilcalendarcategorygui&amp;cmdNode=6&amp;baseClass=ilPersonalDesktopGUI


Changing category_id, it shows sensitive information about
any course/group/...

Personal and global calendars are secure.



#########################################
/////////////////////////////////////////

ARBITRARY INFORMATION DISCLOSURE/EDITION

/////////////////////////////////////////
#########################################



This module (favorite) allows to get a repository of favorite links



-------------------
-------------------

&quot;FAVORITE&quot; ISSUE:

-------------------
-------------------


This would be the vuln link:


http://[HOST]/[PATH]/ilias.php?bmf_id=1&amp;obj_id=926&amp;cmd=editFormBookmark&amp;cmdClass=ilbookmarkadministrationgui&amp;cmdNode=2&amp;baseClass=ilPersonalDesktopGUI


GET var 'obj_id' is the vuln var...changing for other value you can view and edit any favorite link.


User (victim) trusts in these links (He posts them)



############
////////////

VIDEOS DEMO

////////////
############



ARBITRARY INFORMATION DISCLOSURE AND EDITION (&quot;FAVORITES&quot;) --&gt; http://www.youtube.com/watch?v=i6D6UVR0358

ARBITRARY INFORMATION DISCLOSURE (&quot;POST-ITS&quot;) --&gt; http://www.youtube.com/watch?v=eSPp1dswe1E



####################
////////////////////

DISCLOSURE TIMELINE

////////////////////
####################




**2009-06-28**  ~~~~~&gt; FIRST VULNS DISCOVERED

**2009-06-29**  ~~~~~&gt; VULN REPORTED TO VENDOR

**2009-06-29**  ~~~~~&gt; OTHER SECURITY ISSUE DISCOVERED

**2009-06-29**  ~~~~~&gt; VULN REPORTED TO VENDOR WITH VIDEO AND REPORT

**2009-06-30**  ~~~~~&gt; VENDOR RESPONSED

**2009-06-30**  ~~~~~&gt; VENDOR CONFIRMED SECURITY ISSUES

**2009-06-30**  ~~~~~&gt; VENDOR FIXED SECURITY ISSUES IN SVN FOR 3.9/3.10/Trunk (AND CONFIRMS 3.9 AFFECTED)

**2009-06-30**  ~~~~~&gt; VENDOR CLARIFIED SECURITY ISSUES: &quot;Confirm that all your exploits work in the latest published official release&quot;

**2009-07-01**  ~~~~~&gt; VENDOR CONFIRMED NEXT RELEASE WILL CONTAIN THE FIXES

**2009-07-01**  ~~~~~&gt; I WILL WAIT NEXT RELEASE FOR FULL DISCLOSURE

**2009-07-08**  ~~~~~&gt; ILIAS LAUNCHED NEW STABLE RELEASE (3.10.8 / 3.9.10)

**2009-07-11**  ~~~~~&gt; I CONTACTED AGAIN TO SAY A DISCLOSURE DATE, STABLISHED FOR 2009-07-15 (WAIT ONE WEEK AFTER NEW RELEASE...)

**2009-07-12**  ~~~~~&gt; ILIAS AGREE WITH THIS DATE AND POSTED A LINK FOR CREDITS

**2009-07-15**  ~~~~~&gt; FULL DISCLOSURE...PUBLISHED ADVISORY.




&lt;&lt;&lt;-----------------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!




##############################################################################
##############################################################################
##**************************************************************************##
##         SPECIAL THANKS TO: MILW0RM FOREVER!!...STR0KE THE BEST!          ##
##**************************************************************************##
##--------------------------------------------------------------------------##
##**************************************************************************##
## GREETZ TO: JosS, Ulises2k, J.McCray, Evil1 and Spanish Hack3Rs community!##
##**************************************************************************##
##############################################################################
##############################################################################

# milw0rm.com [2009-07-15]</pre></html>