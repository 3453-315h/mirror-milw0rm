<html><head><title>LS simple guestbook (v1) Remote Code Execution Vulnerability</title></head><pre>########################################################
#   Special Greetings To - Timq,Warpboy,The-Maggot     #
########################################################

File: index.php
Affects: LS simple guestbook (v1)
Date: 15th April 2007

Issue Description:
===========================================================================
LS simple guestbook fails to sanitize user input that it writes to the
posts.txt file when the user leaves a message, this file is then included
causing any php code within it to be run.
===========================================================================

Scope:
===========================================================================
An attacker can inject arbitrary php code and potentially execute commands
on the system.
===========================================================================

Recommendation:
===========================================================================
Add the following line of code in index.php:

$message = strip_tags($message);

just above:

if ($message != &quot;&quot;) {$file = fopen(&quot;$dataf&quot;,&quot;a&quot;);
===========================================================================


Example:

name = Test
message = &lt;?php phpinfo(); ?&gt;


Discovered By: Gammarays

# milw0rm.com [2007-04-14]</pre></html>